[{"url": "https://api.github.com/repos/edgedb/edgedb/issues/5360", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/5360/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/5360/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/5360/events", "html_url": "https://github.com/edgedb/edgedb/issues/5360", "id": 1669018876, "node_id": "I_kwDOBbYNSM5jezT8", "number": 5360, "title": "InternalServerError: Calling new() on a context other than the current one / AssertionError", "user": {"login": "lu-zen", "id": 11050840, "node_id": "MDQ6VXNlcjExMDUwODQw", "avatar_url": "https://avatars.githubusercontent.com/u/11050840?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lu-zen", "html_url": "https://github.com/lu-zen", "followers_url": "https://api.github.com/users/lu-zen/followers", "following_url": "https://api.github.com/users/lu-zen/following{/other_user}", "gists_url": "https://api.github.com/users/lu-zen/gists{/gist_id}", "starred_url": "https://api.github.com/users/lu-zen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lu-zen/subscriptions", "organizations_url": "https://api.github.com/users/lu-zen/orgs", "repos_url": "https://api.github.com/users/lu-zen/repos", "events_url": "https://api.github.com/users/lu-zen/events{/privacy}", "received_events_url": "https://api.github.com/users/lu-zen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2023-04-14T22:29:44Z", "updated_at": "2023-04-22T13:54:54Z", "closed_at": "2023-04-22T13:54:54Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n\r\n<!--\r\nFor the EdgeDB Version: run `edgedb query 'select sys::get_version_as_str()'` from your project directory (or run `select sys::get_version_as_str();` in the EdgeDB interactive shell).\r\nFor the EdgeDB CLI Version: Run `edgedb --version` from anywhere\r\n-->\r\n\r\n- EdgeDB Version: 3.0-dev.7411+306d957\r\n- EdgeDB CLI Version: 3.0.0-dev.947+3c26302\r\n- OS Version: endeavouros linux-lts\r\n\r\nSteps to Reproduce:\r\n\r\n1. Apply migration\r\n2. Run this query: `update Avatar set {deleted_at:=datetime_of_statement()};`\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\n\r\n[Schema + migration](https://gist.github.com/lu-zen/315117d2c54ab5f50b1c0a23da95e789)\r\n\r\nError:\r\n```\r\nedgedb error: InternalServerError: Calling new() on a context other than the current one\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/server/compiler_pool/worker_proc.py\", line 55, in worker\r\n          res = meth(*args)\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/server/compiler_pool/worker.py\", line 161, in compile\r\n          units, cstate = COMPILER.compile(\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 742, in compile\r\n          unit_group = compile(ctx=ctx, source=source)\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1923, in compile\r\n          return _try_compile(ctx=ctx, source=source)\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1991, in _try_compile\r\n          comp, capabilities = _compile_dispatch_ql(\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1897, in _compile_dispatch_ql\r\n          query = _compile_ql_query(ctx, ql, script_info=script_info)\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1461, in _compile_ql_query\r\n          ir = qlcompiler.compile_ast_to_ir(\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/edgeql/compiler/__init__.py\", line 179, in wrapper\r\n          return func(*args, **kwargs)\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/edgeql/compiler/__init__.py\", line 237, in compile_ast_to_ir\r\n          ir_set = dispatch_mod.compile(tree, ctx=ctx)\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/edgeql/compiler/stmt.py\", line 616, in compile_UpdateQuery\r\n          stmt.subject = compile_query_subject(\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/edgeql/compiler/stmt.py\", line 1469, in compile_query_subject\r\n          view_scls, expr = viewgen.process_view(\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/edgeql/compiler/viewgen.py\", line 151, in process_view\r\n          view_scls, ir = _process_view(\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/edgeql/compiler/viewgen.py\", line 432, in _process_view\r\n          rewrites = _compile_rewrites(\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/edgeql/compiler/viewgen.py\", line 853, in _compile_rewrites\r\n          rewrites = _compile_rewrites_for_stype(\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/edgeql/compiler/viewgen.py\", line 1086, in _compile_rewrites_for_stype\r\n          pointer, ptr_set = _normalize_view_ptr_expr(\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/edgeql/compiler/viewgen.py\", line 1498, in _normalize_view_ptr_expr\r\n          irexpr, sub_view_rptr = _compile_qlexpr(\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/edgeql/compiler/viewgen.py\", line 1254, in _compile_qlexpr\r\n          source_set = setgen.fixup_computable_source_set(ir_source, ctx=ctx)\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/edgeql/compiler/setgen.py\", line 1341, in fixup_computable_source_set\r\n          source_set = new_set_from_set(\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/edgeql/compiler/setgen.py\", line 187, in new_set_from_set\r\n          return new_set(\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/edgeql/compiler/setgen.py\", line 103, in new_set\r\n          policies.try_type_rewrite(stype, skip_subtypes=skip_subtypes, ctx=ctx)\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/edgeql/compiler/policies.py\", line 310, in try_type_rewrite\r\n          with ctx.detached() as subctx:\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/common/compiler.py\", line 67, in __enter__\r\n          return self.context.push(self.mode, self.prevlevel)\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/common/compiler.py\", line 103, in push\r\n          return self._push(mode, prevlevel)\r\n        File \"/home/user/.local/share/edgedb/portable/3.0-dev.7411/lib/python3.10/site-packages/edb/common/compiler.py\", line 125, in _push\r\n          raise AssertionError(\r\n      AssertionError: Calling new() on a context other than the current one\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5360/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/5360/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5348", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/5348/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/5348/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/5348/events", "html_url": "https://github.com/edgedb/edgedb/issues/5348", "id": 1666957506, "node_id": "I_kwDOBbYNSM5jW8DC", "number": 5348, "title": "Recursive defaults with DML will cause ISE: recursion depth limit exceeded", "user": {"login": "zchenb", "id": 121908802, "node_id": "U_kgDOB0QuQg", "avatar_url": "https://avatars.githubusercontent.com/u/121908802?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zchenb", "html_url": "https://github.com/zchenb", "followers_url": "https://api.github.com/users/zchenb/followers", "following_url": "https://api.github.com/users/zchenb/following{/other_user}", "gists_url": "https://api.github.com/users/zchenb/gists{/gist_id}", "starred_url": "https://api.github.com/users/zchenb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zchenb/subscriptions", "organizations_url": "https://api.github.com/users/zchenb/orgs", "repos_url": "https://api.github.com/users/zchenb/repos", "events_url": "https://api.github.com/users/zchenb/events{/privacy}", "received_events_url": "https://api.github.com/users/zchenb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2023-04-13T18:46:29Z", "updated_at": "2023-04-18T15:28:31Z", "closed_at": "2023-04-18T15:28:30Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "EdgeDB 3.0-dev.7456+local (repl 3.0.0-dev)\r\n\r\n\r\nCreate a migration on the following schema, an infinite recursion will follow\r\n```\r\ntype Test3 {\r\n    d1 : str ;\r\n    d7 : Test3 {\r\n        default :=  (insert Test3 {\r\n            d1 := \"d1\"\r\n        })\r\n    }\r\n}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5348/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/5348/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5303", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/5303/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/5303/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/5303/events", "html_url": "https://github.com/edgedb/edgedb/issues/5303", "id": 1654527688, "node_id": "I_kwDOBbYNSM5inhbI", "number": 5303, "title": "Disallow using UNLESS CONFLICT on a rewritten pointer", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2023-04-04T20:22:18Z", "updated_at": "2023-04-07T09:26:03Z", "closed_at": "2023-04-07T09:26:03Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "See discussion at https://github.com/edgedb/edgedb/pull/5006#discussion_r1157717832\r\n\r\nRelevant code is `edgeql/compiler/conflicts.py`", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5303/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/5303/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5241", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/5241/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/5241/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/5241/events", "html_url": "https://github.com/edgedb/edgedb/issues/5241", "id": 1638386048, "node_id": "I_kwDOBbYNSM5hp8mA", "number": 5241, "title": "assert_single breaks returned update data", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2023-03-23T21:49:55Z", "updated_at": "2023-03-24T02:33:28Z", "closed_at": "2023-03-24T02:33:27Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This is a specific case of #3030, which is going to be a bear to solve in general but I think 95% of real world cases are covered by handling a handful of functions in `get_nearest_dml_statement`.\r\n\r\nI think this is actually already fixed on the dev branch, in passing while doing triggers, so split this out and cherry pick it to 2.x\r\n\r\n(And add a test for 3.0, I suppose)", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5241/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/5241/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5223", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/5223/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/5223/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/5223/events", "html_url": "https://github.com/edgedb/edgedb/issues/5223", "id": 1634755302, "node_id": "I_kwDOBbYNSM5hcGLm", "number": 5223, "title": "Consistently allow putting `global` in defaults", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2023-03-21T22:02:16Z", "updated_at": "2023-03-31T21:09:49Z", "closed_at": "2023-03-31T21:09:49Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Currently we technically allow globals inside pointer defaults, but in practice it will frequently fail if the migration thinks there might be data in the table already. This is because we try to populate all the objects with the default using the `set required using ...` machinery, which disallows globals.\r\n\r\nWe should be able to fix this by treating the globals as always being unset, in this context.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5223/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/5223/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5179", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/5179/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/5179/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/5179/events", "html_url": "https://github.com/edgedb/edgedb/issues/5179", "id": 1624095454, "node_id": "I_kwDOBbYNSM5gzbre", "number": 5179, "title": "linkprop + assert_exists totally busted", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2023-03-14T18:40:46Z", "updated_at": "2023-03-15T05:11:52Z", "closed_at": "2023-03-15T05:11:52Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "On the `cards` test database:\r\n```\r\nSELECT User {\r\n  cards := assert_exists((\r\n    WITH\r\n      Q := (\r\n        SELECT User.deck {\r\n          __count := User.deck@count\r\n        }\r\n      )\r\n    SELECT Q {\r\n      single @count := Q.__count\r\n    }\r\n  ))\r\n};\r\n```\r\n\r\nAs is typical for most of our \"more than one row\" type bugs, if you change the `single` to a `multi`, the query runs but gives back all of the counts for each user.\r\nThis might be (probably is?) the same bug as https://github.com/edgedb/edgedb/issues/3706", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5179/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/5179/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5174", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/5174/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/5174/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/5174/events", "html_url": "https://github.com/edgedb/edgedb/issues/5174", "id": 1622821586, "node_id": "I_kwDOBbYNSM5gukrS", "number": 5174, "title": "INTERSECT/EXCEPT on three builtin objects fails", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2023-03-14T06:33:40Z", "updated_at": "2023-03-17T23:24:39Z", "closed_at": "2023-03-17T23:24:38Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nselect std::BaseObject EXCEPT schema::Object INTERSECT schema::TupleElement;\r\n```\r\nand\r\n```\r\nselect std::BaseObject INTERSECT schema::Object INTERSECT schema::TupleElement;\r\n```\r\nfail at\r\n```\r\n        File \"/home/sully/src/e/edgedb/edb/pgsql/compiler/pathctx.py\", line 414, in _get_path_var_in_setop\r\n          assert counts == [counts[0]] * len(counts)\r\n```\r\nwhich is a good time. Seems to be access policy related.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5174/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/5174/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5172", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/5172/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/5172/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/5172/events", "html_url": "https://github.com/edgedb/edgedb/issues/5172", "id": 1622641349, "node_id": "I_kwDOBbYNSM5gt4rF", "number": 5172, "title": "Disallow passing insert/update objects to user-defined functions", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}, {"id": 4285243067, "node_id": "LA_kwDOBbYNSM7_a567", "url": "https://api.github.com/repos/edgedb/edgedb/labels/3.0", "name": "3.0", "color": "BFDADC", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2023-03-14T03:03:28Z", "updated_at": "2023-04-07T11:10:09Z", "closed_at": "2023-04-07T11:10:09Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "(I thought there was an issue for this but I couldn't find it)\r\n\r\nIf a function is implemented as a SQL function, it won't be able to use overlays to see newly created data. This can cause a bunch of problems, including breaking cardinality.\r\n\r\nI think that we don't have any stdlib functions that take object types that are implemented as functions, so this probably just affects user defined functions.\r\n\r\nThis will affect some access policy uses also", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5172/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/5172/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5164", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/5164/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/5164/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/5164/events", "html_url": "https://github.com/edgedb/edgedb/issues/5164", "id": 1619483165, "node_id": "I_kwDOBbYNSM5gh1od", "number": 5164, "title": "ISE when creating a recursive trigger", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}, {"id": 4285243067, "node_id": "LA_kwDOBbYNSM7_a567", "url": "https://api.github.com/repos/edgedb/edgedb/labels/3.0", "name": "3.0", "color": "BFDADC", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2023-03-10T19:04:56Z", "updated_at": "2023-03-30T01:28:57Z", "closed_at": "2023-03-30T01:28:57Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n\r\n<!--\r\nFor the EdgeDB Version: run `edgedb query 'select sys::get_version_as_str()'` from your project directory (or run `select sys::get_version_as_str();` in the EdgeDB interactive shell).\r\nFor the EdgeDB CLI Version: Run `edgedb --version` from anywhere\r\n-->\r\n\r\n- EdgeDB Version: EdgeDB 3.0-dev.7307+local (repl 3.0.0-dev) (current master 44928f0aa3854b3779073852d2ab1a6054285e47)\r\n- EdgeDB CLI Version: current master \r\n- OS Version: Ubuntu\r\n\r\nSteps to Reproduce:\r\n\r\nSetup:\r\n```\r\ncreate type Foo {\r\n  create required property val -> str;\r\n  create trigger t0 after insert for each do (\r\n    insert Foo {val := '!'}\r\n  );\r\n};\r\n```\r\nThis is already a problem because recursion should be detected at this stage, before any queries run.\r\n\r\nThen when we make an insert we get a ISE:\r\n```\r\nedgedb> insert Foo{val := 'test'};\r\nedgedb error: InternalServerError: syntax error at or near \"(\"\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: syntax error at or near \"(\"\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5164/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/5164/timeline", "performed_via_github_app": null, "state_reason": "not_planned"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5151", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/5151/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/5151/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/5151/events", "html_url": "https://github.com/edgedb/edgedb/issues/5151", "id": 1617101663, "node_id": "I_kwDOBbYNSM5gYwNf", "number": 5151, "title": "Annotations on migrations can't survive dump", "user": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}, {"id": 4285243067, "node_id": "LA_kwDOBbYNSM7_a567", "url": "https://api.github.com/repos/edgedb/edgedb/labels/3.0", "name": "3.0", "color": "BFDADC", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2023-03-09T12:12:21Z", "updated_at": "2023-03-15T00:06:19Z", "closed_at": "2023-03-15T00:06:19Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "\r\n- EdgeDB Version: EdgeDB 3.0-dev.7305+local\r\n- EdgeDB CLI Version: 3.0.0-dev\r\n\r\nSteps to Reproduce:\r\n\r\n1. Run `edgedb migrate --dev-mode` with any schema change\r\n2. Run `edgedb dump ./filename.dump`\r\n```\r\nedgedb error: EdgeQLSyntaxError: error receiving dump header: Unexpected 'generated_by' (on line 1, column 21)\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/work/edb/common/parsing.py\", line 419, in parse\r\n          self.parser.token(token)\r\n        File \"/usr/local/lib/python3.10/dist-packages/parsing/lrparser.py\", line 57, in token\r\n          self._act(token, tokenSpec)  # type: ignore\r\n        File \"/usr/local/lib/python3.10/dist-packages/parsing/lrparser.py\", line 81, in _act\r\n          raise UnexpectedToken(\"Unexpected token: %r\" % sym)\r\n      parsing.errors.UnexpectedToken: Unexpected token: <Token IDENT \"generated_by\">\r\n      \r\n      The above exception was the direct cause of the following exception:\r\n      \r\n      Traceback (most recent call last):\r\n        File \"/work/edb/server/compiler_pool/worker_proc.py\", line 55, in worker\r\n          res = meth(*args)\r\n        File \"/work/edb/server/compiler/compiler.py\", line 816, in describe_database_dump\r\n          schema_ddl = s_ddl.ddl_text_from_schema(\r\n        File \"/work/edb/schema/ddl.py\", line 867, in ddl_text_from_schema\r\n          return ddl_text_from_delta(None, schema, diff)\r\n        File \"/work/edb/schema/ddl.py\", line 785, in ddl_text_from_delta\r\n          return text_from_delta(schema_a, schema_b, delta, sdlmode=False)\r\n        File \"/work/edb/schema/ddl.py\", line 755, in text_from_delta\r\n          stmts = statements_from_delta(\r\n        File \"/work/edb/schema/ddl.py\", line 682, in statements_from_delta\r\n          stmts = ddlast_from_delta(\r\n        File \"/work/edb/schema/ddl.py\", line 663, in ddlast_from_delta\r\n          ql_ast = command.get_ast(schema, context)\r\n        File \"/work/edb/schema/delta.py\", line 2675, in get_ast\r\n          return self._get_ast(schema, context, parent_node=parent_node)\r\n        File \"/work/edb/schema/migrations.py\", line 210, in _get_ast\r\n          node = super()._get_ast(schema, context, parent_node=parent_node)\r\n        File \"/work/edb/schema/delta.py\", line 2993, in _get_ast\r\n          node = super()._get_ast(schema, context, parent_node=parent_node)\r\n        File \"/work/edb/schema/delta.py\", line 2229, in _get_ast\r\n          self._apply_fields_ast(schema, context, op)\r\n        File \"/work/edb/schema/delta.py\", line 2264, in _apply_fields_ast\r\n          self._apply_field_ast(schema, context, node, fop)\r\n        File \"/work/edb/schema/migrations.py\", line 227, in _apply_field_ast\r\n          qlparser.parse_block(op.new_value),\r\n        File \"/work/edb/edgeql/parser/__init__.py\", line 80, in parse_block\r\n          return parser.parse(source)\r\n        File \"/work/edb/common/parsing.py\", line 432, in parse\r\n          raise self.get_exception(\r\n      edb.errors.EdgeQLSyntaxError: Unexpected 'generated_by'\r\n```\r\n\r\nMigration looks like this:\r\n```\r\nedgedb> select schema::Migration {script} FILTER .name = 'm1d7wj3tklth5kvaxwvnqwvh57ir7b7xni5kkyvjfenlkyo5me2ugq';\r\n{\r\n  schema::Migration {\r\n    script: '                SET generated_by := schema::MigrationGeneratedBy.DevMode;\r\n                ALTER TYPE vSvnXEUmQu::atyyiNKARe {\r\n    CREATE REQUIRED PROPERTY newone: std::duration;\r\n};',\r\n  },\r\n}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5151/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/5151/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5070", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/5070/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/5070/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/5070/events", "html_url": "https://github.com/edgedb/edgedb/issues/5070", "id": 1593929307, "node_id": "I_kwDOBbYNSM5fAW5b", "number": 5070, "title": "`InvalidReferenceError` on group queries generated by ts querybuilder", "user": {"login": "jaclarke", "id": 2085287, "node_id": "MDQ6VXNlcjIwODUyODc=", "avatar_url": "https://avatars.githubusercontent.com/u/2085287?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaclarke", "html_url": "https://github.com/jaclarke", "followers_url": "https://api.github.com/users/jaclarke/followers", "following_url": "https://api.github.com/users/jaclarke/following{/other_user}", "gists_url": "https://api.github.com/users/jaclarke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaclarke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaclarke/subscriptions", "organizations_url": "https://api.github.com/users/jaclarke/orgs", "repos_url": "https://api.github.com/users/jaclarke/repos", "events_url": "https://api.github.com/users/jaclarke/events{/privacy}", "received_events_url": "https://api.github.com/users/jaclarke/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2023-02-21T18:28:00Z", "updated_at": "2023-02-21T19:41:00Z", "closed_at": "2023-02-21T19:41:00Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: EdgeDB 3.0-dev.7275+local\r\n\r\nSteps to Reproduce:\r\n\r\n```\r\n_example> WITH\r\n.........   __scope_0_defaultMovie := DETACHED default::Movie,\r\n.........   __scope_0_defaultMovie_groups := (\r\n.........     GROUP __scope_0_defaultMovie\r\n.........     USING\r\n.........       release_year := __scope_0_defaultMovie.release_year\r\n.........     BY release_year\r\n......... )\r\n......... SELECT __scope_0_defaultMovie_groups {\r\n.........   key: {release_year},\r\n.........   grouping,\r\n.........   elements: {\r\n.........     release_year,\r\n.........     title,\r\n.........     multi actors := (\r\n.........       WITH\r\n.........         __scope_1_defaultPerson := __scope_0_defaultMovie_groups.elements.actors\r\n.........       SELECT __scope_1_defaultPerson {\r\n.........         name\r\n.........       }\r\n.........     )\r\n.........   }\r\n......... };\r\nerror: InvalidReferenceError: object type or alias 'default::__scope_0_defaultMovie_groups' does not exist\r\n   \u250c\u2500 query:17:36\r\n   \u2502\r\n17 \u2502         __scope_1_defaultPerson := __scope_0_defaultMovie_groups.elements.actors\r\n   \u2502                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ error\r\n\r\n```\r\n\r\nSchema: UI `_example` schema", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5070/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/5070/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5068", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/5068/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/5068/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/5068/events", "html_url": "https://github.com/edgedb/edgedb/issues/5068", "id": 1592450572, "node_id": "I_kwDOBbYNSM5e6t4M", "number": 5068, "title": "No query results when optional tuple arg is not provided", "user": {"login": "jaclarke", "id": 2085287, "node_id": "MDQ6VXNlcjIwODUyODc=", "avatar_url": "https://avatars.githubusercontent.com/u/2085287?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaclarke", "html_url": "https://github.com/jaclarke", "followers_url": "https://api.github.com/users/jaclarke/followers", "following_url": "https://api.github.com/users/jaclarke/following{/other_user}", "gists_url": "https://api.github.com/users/jaclarke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaclarke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaclarke/subscriptions", "organizations_url": "https://api.github.com/users/jaclarke/orgs", "repos_url": "https://api.github.com/users/jaclarke/repos", "events_url": "https://api.github.com/users/jaclarke/events{/privacy}", "received_events_url": "https://api.github.com/users/jaclarke/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2023-02-20T21:12:03Z", "updated_at": "2023-02-22T18:56:37Z", "closed_at": "2023-02-22T18:56:37Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: EdgeDB 3.0-dev.7275+local\r\n- EdgeDB CLI Version: n/a\r\n\r\nSteps to Reproduce:\r\n\r\n```dart\r\nimport 'package:edgedb/edgedb.dart';\r\n\r\nfinal client = createClient(instanceName: '_localdev', database: '_example');\r\n\r\nvoid main() async {\r\n  print(await client.query(\r\n      r'''\r\n      select Movie {\r\n        title,\r\n        computed := <optional tuple<str, int64>>$test\r\n      } filter .actors.name = <str>$name\r\n      ''',\r\n      {\r\n        'name': 'Lee Pace',\r\n        'test': ['test str', 123]\r\n      }));\r\n  // => [{title: Guardians of the Galaxy, computed: [test str, 123]}]\r\n  // expected result\r\n\r\n  print(await client.query(\r\n      r'''\r\n      select Movie {\r\n        title,\r\n        computed := <optional tuple<str, int64>>$test\r\n      } filter .actors.name = <str>$name\r\n      ''',\r\n      {\r\n        'name': 'Lee Pace',\r\n      }));\r\n  // => []\r\n  // when optional tuple is not provided, no result at all\r\n  // expected result:\r\n  // [{title: Guardians of the Galaxy, computed: null}]\r\n\r\n  print(await client.query(\r\n      r'''\r\n      select Movie {\r\n        title,\r\n        computed := <optional str>$test\r\n      } filter .actors.name = <str>$name\r\n      ''',\r\n      {\r\n        'name': 'Lee Pace',\r\n      }));\r\n  // => [{title: Guardians of the Galaxy, computed: null}]\r\n  // appears to work correctly with simple optional scalar arg\r\n\r\n  client.close();\r\n}\r\n```\r\n\r\nSchema: UI '_example' schema\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5068/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/5068/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5060", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/5060/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/5060/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/5060/events", "html_url": "https://github.com/edgedb/edgedb/issues/5060", "id": 1590175318, "node_id": "I_kwDOBbYNSM5eyCZW", "number": 5060, "title": "`column source_...~1.id does not exist` when migration adds a link property to existing link on new database", "user": {"login": "jackfischer", "id": 6811459, "node_id": "MDQ6VXNlcjY4MTE0NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/6811459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jackfischer", "html_url": "https://github.com/jackfischer", "followers_url": "https://api.github.com/users/jackfischer/followers", "following_url": "https://api.github.com/users/jackfischer/following{/other_user}", "gists_url": "https://api.github.com/users/jackfischer/gists{/gist_id}", "starred_url": "https://api.github.com/users/jackfischer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jackfischer/subscriptions", "organizations_url": "https://api.github.com/users/jackfischer/orgs", "repos_url": "https://api.github.com/users/jackfischer/repos", "events_url": "https://api.github.com/users/jackfischer/events{/privacy}", "received_events_url": "https://api.github.com/users/jackfischer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2023-02-18T02:47:20Z", "updated_at": "2023-02-18T08:52:33Z", "closed_at": "2023-02-18T08:52:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n\r\n<!--\r\nFor the EdgeDB Version: run `edgedb query 'select sys::get_version_as_str()'` from your project directory (or run `select sys::get_version_as_str();` in the EdgeDB interactive shell).\r\nFor the EdgeDB CLI Version: Run `edgedb --version` from anywhere\r\n-->\r\n\r\n- EdgeDB Version: 2.10+66168b2\r\n- EdgeDB CLI Version: 2.2.6+7eabbf9\r\n- OS Version: macOS 13.1\r\n\r\nSteps to Reproduce:\r\n\r\n1. Create a fresh database via `edgedb project init`\r\n2. Create two objects with a link property between them\r\n3. Migrate to add a link property to the link\r\n\r\nNote that this does not occur when migrating an existing database with data in it\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\n\r\nExample migration\r\n\r\n```\r\nCREATE MIGRATION m1e5lg4zthhiwftctkhu42zk3an4wlckofxbbacknb6mvqucswr6tq\r\n    ONTO m145ubndj6w5mhlvoea2qdomtgvh6ziia43mvbwsuwu43d6h3nq4ua\r\n{\r\n  ALTER TYPE default::Survey {\r\n      ALTER LINK recipients {\r\n          CREATE PROPERTY destination -> std::str {\r\n              SET default := 'email';\r\n          };\r\n      };\r\n  };\r\n};\r\n```\r\n\r\n```\r\n$ edgedb migrate\r\nedgedb error: InternalServerError: column source_23dcd9ce-af36-11ed-b05e-69076c83b0e2~1.id does not exist\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: column source_23dcd9ce-af36-11ed-b05e-69076c83b0e2~1.id does not exist\r\n```\r\n\r\nSchema:\r\n\r\n```\r\nmodule default {\r\n    type Survey {\r\n        multi link recipients -> User;\r\n    }\r\n    type User{}\r\n}\r\n```\r\n\r\n```\r\nmodule default {\r\n    type Survey {\r\n        multi link recipients -> User {\r\n            property destination -> str {\r\n                default := \"email\";\r\n            }\r\n        }\r\n    }\r\n    type User{}\r\n}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5060/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/5060/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5029", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/5029/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/5029/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/5029/events", "html_url": "https://github.com/edgedb/edgedb/issues/5029", "id": 1583402971, "node_id": "I_kwDOBbYNSM5eYM_b", "number": 5029, "title": "`SET SINGLE USING` on a `required multi property` spuriously fails", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2023-02-14T02:58:27Z", "updated_at": "2023-02-14T16:21:26Z", "closed_at": "2023-02-14T16:21:26Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nedgedb> create type X { create required multi property foo -> str };\r\nOK: CREATE TYPE\r\nedgedb> insert X { foo := \"test\" };\r\n[{\"id\": \"e2b1ea82-ac12-11ed-8ac2-43e409d70c9b\"}]\r\n```\r\n\r\nTrying to `set single` the property fails:\r\n```\r\nedgedb> alter type X alter property foo set single using (assert_single(.foo));\r\nError: MissingRequiredError: missing value for required property 'foo' of object type 'default::X'\r\n```\r\n\r\nI also tried with a constant in the using, still fails:\r\n```\r\nedgedb> alter type X alter property foo set single using ('x');\r\nError: MissingRequiredError: missing value for required property 'foo' of object type 'default::X'\r\n```\r\n\r\nFails on 2.9 and on master. (I had thought maybe it was a regression introduced by #4873, but doesn't look like it)", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5029/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/5029/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5004", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/5004/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/5004/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/5004/events", "html_url": "https://github.com/edgedb/edgedb/issues/5004", "id": 1578299028, "node_id": "I_kwDOBbYNSM5eEu6U", "number": 5004, "title": "`InternalServerError` when creating migration with module name containing backtick", "user": {"login": "jaclarke", "id": 2085287, "node_id": "MDQ6VXNlcjIwODUyODc=", "avatar_url": "https://avatars.githubusercontent.com/u/2085287?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaclarke", "html_url": "https://github.com/jaclarke", "followers_url": "https://api.github.com/users/jaclarke/followers", "following_url": "https://api.github.com/users/jaclarke/following{/other_user}", "gists_url": "https://api.github.com/users/jaclarke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaclarke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaclarke/subscriptions", "organizations_url": "https://api.github.com/users/jaclarke/orgs", "repos_url": "https://api.github.com/users/jaclarke/repos", "events_url": "https://api.github.com/users/jaclarke/events{/privacy}", "received_events_url": "https://api.github.com/users/jaclarke/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-02-09T17:25:19Z", "updated_at": "2023-02-10T21:05:01Z", "closed_at": "2023-02-10T21:05:01Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: EdgeDB 3.0-dev.7232+local\r\n- EdgeDB CLI Version: 2.3.0\r\n\r\nSteps to Reproduce:\r\n\r\n1. Add a module with a name containing a backtick to schema file, eg:\r\n```\r\n  module default {\r\n    module nested {\r\n      type Test {}\r\n    }\r\n  \r\n+   module `back``ticked` {\r\n+     type Test {}\r\n+   }\r\n  }\r\n```\r\n2. Run `edgedb migration create`:\r\n```\r\n$ edgedb migration create\r\nedgedb error: InternalServerError: \r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/home/james/dev/edgedb/edb/server/compiler_pool/worker_proc.py\", line 55, in worker\r\n          res = meth(*args)\r\n        File \"/home/james/dev/edgedb/edb/server/compiler_pool/worker.py\", line 186, in compile_in_tx\r\n          units, cstate = COMPILER.compile_in_tx(cstate, *args, **kwargs)\r\n        File \"/home/james/dev/edgedb/edb/server/compiler/compiler.py\", line 782, in compile_in_tx\r\n          return compile(ctx=ctx, source=source), ctx.state\r\n        File \"/home/james/dev/edgedb/edb/server/compiler/compiler.py\", line 1742, in compile\r\n          return _try_compile(ctx=ctx, source=original)\r\n        File \"/home/james/dev/edgedb/edb/server/compiler/compiler.py\", line 1813, in _try_compile\r\n          comp, capabilities = _compile_dispatch_ql(\r\n        File \"/home/james/dev/edgedb/edb/server/compiler/compiler.py\", line 1667, in _compile_dispatch_ql\r\n          query = ddl.compile_dispatch_ql_migration(\r\n        File \"/home/james/dev/edgedb/edb/server/compiler/ddl.py\", line 386, in compile_dispatch_ql_migration\r\n          return _describe_current_migration(ctx, ql)\r\n        File \"/home/james/dev/edgedb/edb/server/compiler/ddl.py\", line 605, in _describe_current_migration\r\n          guided_diff = s_ddl.delta_schemas(\r\n        File \"/home/james/dev/edgedb/edb/schema/ddl.py\", line 369, in delta_schemas\r\n          assert mod is not None\r\n      AssertionError\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/5004/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/5004/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4999", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4999/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4999/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4999/events", "html_url": "https://github.com/edgedb/edgedb/issues/4999", "id": 1577459280, "node_id": "I_kwDOBbYNSM5eBh5Q", "number": 4999, "title": "Mangled `InvalidValueError` message when casting to `<uuid>`", "user": {"login": "gomain", "id": 4217249, "node_id": "MDQ6VXNlcjQyMTcyNDk=", "avatar_url": "https://avatars.githubusercontent.com/u/4217249?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gomain", "html_url": "https://github.com/gomain", "followers_url": "https://api.github.com/users/gomain/followers", "following_url": "https://api.github.com/users/gomain/following{/other_user}", "gists_url": "https://api.github.com/users/gomain/gists{/gist_id}", "starred_url": "https://api.github.com/users/gomain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gomain/subscriptions", "organizations_url": "https://api.github.com/users/gomain/orgs", "repos_url": "https://api.github.com/users/gomain/repos", "events_url": "https://api.github.com/users/gomain/events{/privacy}", "received_events_url": "https://api.github.com/users/gomain/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 2877515629, "node_id": "MDU6TGFiZWwyODc3NTE1NjI5", "url": "https://api.github.com/repos/edgedb/edgedb/labels/server", "name": "server", "color": "4023F4", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-02-09T08:31:37Z", "updated_at": "2023-02-10T14:49:13Z", "closed_at": "2023-02-10T14:49:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n\r\n<!--\r\nFor the EdgeDB Version: run `edgedb query 'select sys::get_version_as_str()'` from your project directory (or run `select sys::get_version_as_str();` in the EdgeDB interactive shell).\r\nFor the EdgeDB CLI Version: Run `edgedb --version` from anywhere\r\n-->\r\n\r\n- EdgeDB Version: 2.9+b1d697b\r\n- EdgeDB CLI Version: 2.2.6+b869667\r\n- OS Version: linux-nixos (local binary)\r\n\r\nSteps to Reproduce:\r\n\r\n1. Start `edgedb` command connecting to any instance.\r\n2. type query\r\n```bash\r\nedgedb>select <uuid>\"a-non-valid-string\";\r\nedgedb error: InvalidValueError: invalid input syntax for type std::uuid: \"a-non-valid-string\"\r\n```\r\nSo far so good. Things get wired when the invalid string contain the sequence \"uuid\" delimited with space or punctuations except underscore(\"_\"). The invalid value reported in the error message has the sequence \"uuid\" replaced with \"std::uuid\"\r\n```config\r\n# single occurrence\r\nedgedb> select <uuid>\"uuid\";\r\nedgedb error: InvalidValueError: invalid input syntax for type std::uuid: \"std::uuid\"\r\n# not exact sequence\r\nedgedb> select <uuid>\"xuuid\";\r\nedgedb error: InvalidValueError: invalid input syntax for type std::uuid: \"xuuid\"\r\nedgedb> select <uuid>\"uuidx\";\r\nedgedb error: InvalidValueError: invalid input syntax for type std::uuid: \"uuidx\"\r\nedgedb> select <uuid>\"uuiduuid\";\r\nedgedb error: InvalidValueError: invalid input syntax for type std::uuid: \"uuiduuid\"\r\n# delimited with punctuation\r\nedgedb> select <uuid>\"uuid-uuid\";\r\nedgedb error: InvalidValueError: invalid input syntax for type std::uuid: \"std::uuid-std::uuid\"\r\nedgedb> select <uuid>\"uuid uuid\";\r\nedgedb error: InvalidValueError: invalid input syntax for type std::uuid: \"std::uuid std::uuid\"\r\nedgedb> select <uuid>\"uuid  uuid\";\r\nedgedb error: InvalidValueError: invalid input syntax for type std::uuid: \"std::uuid  std::uuid\"\r\nedgedb> select <uuid>\"uuid|uuid@uuid#uuid$uuid%uuid^uuid&uuid*uuid(uuid)uuid[uuid]uuid{uuid}uuid'uuid\\\"uuid,uuid.uuid<uuid>uuid\";\r\nedgedb error: InvalidValueError: invalid input syntax for type std::uuid: \"std::uuid|std::uuid@std::uuid#std::uuid$std::uuid%std::uuid^std::uuid&std::uuid*std::uuid(std::uuid)std::uuid[std::uuid]std::uuid{std::uuid}std::uuid'std::uuid\"std::uuid,std::uuid.std::uuid<std::uuid>std::uuid\"\r\n# the sequence \"std::uuid\"\r\nedgedb> select <uuid>\"std::uuid\";\r\nedgedb error: InvalidValueError: invalid input syntax for type std::uuid: \"std::std::uuid\"\r\n# except for underscore\r\nedgedb> select <uuid>\"uuid_uuid\";\r\nedgedb error: InvalidValueError: invalid input syntax for type std::uuid: \"uuid_uuid\"\r\n```\r\nSimilar behaviour when the value contains these type words\r\n\r\n`bool` -> `std::bool`\r\n`bigint` -> `std::int64`\r\n\r\nThis is unexpected, inconsistent, and makes testing for expected errors difficult. E.g. in client libraries.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4999/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4999/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4996", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4996/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4996/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4996/events", "html_url": "https://github.com/edgedb/edgedb/issues/4996", "id": 1576537947, "node_id": "I_kwDOBbYNSM5d-A9b", "number": 4996, "title": "InternalServerError: maximum recursion depth exceeded while calling a Python object", "user": {"login": "mazeForGit", "id": 58429185, "node_id": "MDQ6VXNlcjU4NDI5MTg1", "avatar_url": "https://avatars.githubusercontent.com/u/58429185?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mazeForGit", "html_url": "https://github.com/mazeForGit", "followers_url": "https://api.github.com/users/mazeForGit/followers", "following_url": "https://api.github.com/users/mazeForGit/following{/other_user}", "gists_url": "https://api.github.com/users/mazeForGit/gists{/gist_id}", "starred_url": "https://api.github.com/users/mazeForGit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mazeForGit/subscriptions", "organizations_url": "https://api.github.com/users/mazeForGit/orgs", "repos_url": "https://api.github.com/users/mazeForGit/repos", "events_url": "https://api.github.com/users/mazeForGit/events{/privacy}", "received_events_url": "https://api.github.com/users/mazeForGit/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2023-02-08T17:37:18Z", "updated_at": "2023-02-10T15:20:32Z", "closed_at": "2023-02-10T14:48:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "- EdgeDB Version: \"2.9+b1d697b\"\r\n- EdgeDB CLI Version: EdgeDB CLI 2.2.6+af56767\r\n- OS Version: Windows 10\r\nSteps to Reproduce:\r\n\r\n1. default.esdl\r\n```\r\nmodule default {\r\n    type Requirement {\r\n\t\trequired property level -> str {\r\n\t\t\tdefault := '';\r\n\t\t}\r\n\t\trequired property function -> str {\r\n\t\t\tdefault := '';\r\n\t\t}\r\n\t\trequired property feature -> str {\r\n\t\t\tdefault := '';\r\n\t\t}\r\n\t\trequired property component -> str {\r\n\t\t\tdefault := '';\r\n\t\t}\r\n\t\trequired property name -> str {\r\n\t\t\tdefault := '';\r\n\t\t}\r\n\t\tmulti link children -> Requirement;\r\n\t}\r\n}\r\n```\r\n\r\n2. data are 7 requirements like linkedList via children, no loop. The last requirement within list has component = 'component 1'.\r\nThe goal is to query requirements where child requirement.component = 'component 1'.\r\n \r\n4. query\r\n\r\n```\r\nselect Requirement {\r\n  name,\r\n  level,\r\n  children: {name, level, component}\r\n}\r\nfilter .children[is Requirement].component = 'component 1';\r\n```\r\n\r\n5. results in InternalServerError: maximum recursion depth exceeded while calling a Python object\r\n\r\n- selecting all objects shows list of data:\r\n- query:\r\n```\r\nselect Requirement {\r\n  name,\r\n  level,\r\n  children: {\r\n    name, \r\n    level, \r\n    children: {\r\n      name, \r\n      level,\r\n      children: {\r\n        name, \r\n        level,\r\n        children: {\r\n          name, \r\n          level,\r\n          children: {\r\n            name, \r\n            level,\r\n            children: {\r\n              name, \r\n              level,\r\n              component\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\nfilter .level='SYS.1' and .name = 'requirement 1.1'\r\n```\r\n\r\n- result:\r\n```\r\n[\r\n  {\r\n    \"name\": \"requirement 1.1\",\r\n    \"level\": \"SYS.1\",\r\n    \"children\": [\r\n      {\r\n        \"name\": \"requirement 2.1\",\r\n        \"level\": \"SYS.2\",\r\n        \"children\": [\r\n          {\r\n            \"name\": \"requirement 3.1\",\r\n            \"level\": \"SYS.3\",\r\n            \"children\": [\r\n              {\r\n                \"name\": \"requirement 4.1\",\r\n                \"level\": \"SWE.1 CR\",\r\n                \"children\": [\r\n                  {\r\n                    \"name\": \"requirement 5.1\",\r\n                    \"level\": \"SWE.1 SR\",\r\n                    \"children\": [\r\n                      {\r\n                        \"name\": \"requirement 6.1\",\r\n                        \"level\": \"SWE.2\",\r\n                        \"children\": [\r\n                          {\r\n                            \"name\": \"requirement 7.1\",\r\n                            \"level\": \"SWE.3\",\r\n                            \"component\": \"component 1\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  }\r\n]\r\n```\r\n\r\n- query:\r\n```\r\nselect Requirement {\r\n  name,\r\n  level,\r\n}\r\nfilter .children.children.children.children.children.children.component = 'component 1'\r\n```\r\n\r\n- result:\r\n```\r\n[\r\n  {\r\n    \"name\": \"requirement 1.1\",\r\n    \"level\": \"SYS.1\"\r\n  }\r\n]\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4996/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4996/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4995", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4995/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4995/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4995/events", "html_url": "https://github.com/edgedb/edgedb/issues/4995", "id": 1575988533, "node_id": "I_kwDOBbYNSM5d7601", "number": 4995, "title": "error on alter module name {} back to module default {}", "user": {"login": "mazeForGit", "id": 58429185, "node_id": "MDQ6VXNlcjU4NDI5MTg1", "avatar_url": "https://avatars.githubusercontent.com/u/58429185?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mazeForGit", "html_url": "https://github.com/mazeForGit", "followers_url": "https://api.github.com/users/mazeForGit/followers", "following_url": "https://api.github.com/users/mazeForGit/following{/other_user}", "gists_url": "https://api.github.com/users/mazeForGit/gists{/gist_id}", "starred_url": "https://api.github.com/users/mazeForGit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mazeForGit/subscriptions", "organizations_url": "https://api.github.com/users/mazeForGit/orgs", "repos_url": "https://api.github.com/users/mazeForGit/repos", "events_url": "https://api.github.com/users/mazeForGit/events{/privacy}", "received_events_url": "https://api.github.com/users/mazeForGit/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}, {"id": 2295768861, "node_id": "MDU6TGFiZWwyMjk1NzY4ODYx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/need%20info", "name": "need info", "color": "77e5b0", "default": false, "description": "Need more information from submitter"}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2023-02-08T11:58:20Z", "updated_at": "2023-02-10T16:26:50Z", "closed_at": "2023-02-10T16:26:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "- EdgeDB Version: \"edgedb --version\"\r\nEdgeDB CLI 2.2.6+af56767\r\n- EdgeDB CLI Version: \"select sys::get_version_as_str()\"\r\n\"2.9+b1d697b\"\r\n- OS Version: Windows 10\r\n\r\nSteps to Reproduce:\r\n\r\n1. modify default.esdl\r\n\r\n```\r\nmodule cm {\r\n    type Requirement {\r\n\t\tproperty name -> str;\r\n\t\tmulti link parentOf -> Requirement;\r\n\t\tmulti link testedBy -> Test;\r\n\t}\t  \r\n\ttype Test {\r\n\t\tproperty name -> str;\r\n\t}  \r\n}\r\n```\r\n2. apply changes\r\n3. modify default.esdl : module cm --> module default\r\n\r\n```\r\nmodule default {\r\n    type Requirement {\r\n\t\tproperty name -> str;\r\n\t\tmulti link parentOf -> Requirement;\r\n\t\tmulti link testedBy -> Test;\r\n\t}\t  \r\n\ttype Test {\r\n\t\tproperty name -> str;\r\n\t}  \t\r\n}\r\n```\r\n\r\n4. apply changes\r\n\r\nedgedb migration create\r\n```\r\nConnecting to an EdgeDB instance at localhost:10700...\r\nedgedb error: InternalServerError: dependency cycle between ('alter', 'cm::Requirement') and ('rename', 'cm::__|testBy@cm|Requirement')\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.9/lib/python3.10/site-packages/edb/server/compiler_pool/worker_proc.py\", line 55, in worker\r\n          res = meth(*args)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.9/lib/python3.10/site-packages/edb/server/compiler_pool/worker.py\", line 185, in compile_in_tx\r\n          units, cstate = COMPILER.compile_in_tx(cstate, *args, **kwargs)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.9/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 2333, in compile_in_tx\r\n          return self._compile(ctx=ctx, source=source), ctx.state\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.9/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1804, in _compile\r\n          return self._try_compile(ctx=ctx, source=original)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.9/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1871, in _try_compile\r\n          comp, capabilities = self._compile_dispatch_ql(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.9/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1729, in _compile_dispatch_ql\r\n          query = self._compile_ql_migration(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.9/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1216, in _compile_ql_migration\r\n          guided_diff = s_ddl.delta_schemas(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.9/lib/python3.10/site-packages/edb/schema/ddl.py\", line 337, in delta_schemas\r\n          objects = s_ordering.linearize_delta(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.9/lib/python3.10/site-packages/edb/schema/ordering.py\", line 113, in linearize_delta\r\n          sortedlist = [i[1] for i in topological.sort_ex(depgraph)]\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.9/lib/python3.10/site-packages/edb/common/topological.py\", line 187, in sort_ex\r\n          visit(key)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.9/lib/python3.10/site-packages/edb/common/topological.py\", line 170, in visit\r\n          visit(n, weak_link=weak_link)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.9/lib/python3.10/site-packages/edb/common/topological.py\", line 170, in visit\r\n          visit(n, weak_link=weak_link)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.9/lib/python3.10/site-packages/edb/common/topological.py\", line 170, in visit\r\n          visit(n, weak_link=weak_link)\r\n        [Previous line repeated 1 more time]\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.9/lib/python3.10/site-packages/edb/common/topological.py\", line 149, in visit\r\n          raise CycleError(\r\n      edb.common.topological.CycleError: dependency cycle between ('alter', 'cm::Requirement') and ('rename', 'cm::__|testBy@cm|Requirement')\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4995/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4995/timeline", "performed_via_github_app": null, "state_reason": "not_planned"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4984", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4984/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4984/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4984/events", "html_url": "https://github.com/edgedb/edgedb/issues/4984", "id": 1570596089, "node_id": "I_kwDOBbYNSM5dnWT5", "number": 4984, "title": "Disallow `deferred restrict` on required links", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "efaust", "id": 1195281, "node_id": "MDQ6VXNlcjExOTUyODE=", "avatar_url": "https://avatars.githubusercontent.com/u/1195281?v=4", "gravatar_id": "", "url": "https://api.github.com/users/efaust", "html_url": "https://github.com/efaust", "followers_url": "https://api.github.com/users/efaust/followers", "following_url": "https://api.github.com/users/efaust/following{/other_user}", "gists_url": "https://api.github.com/users/efaust/gists{/gist_id}", "starred_url": "https://api.github.com/users/efaust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/efaust/subscriptions", "organizations_url": "https://api.github.com/users/efaust/orgs", "repos_url": "https://api.github.com/users/efaust/repos", "events_url": "https://api.github.com/users/efaust/events{/privacy}", "received_events_url": "https://api.github.com/users/efaust/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "efaust", "id": 1195281, "node_id": "MDQ6VXNlcjExOTUyODE=", "avatar_url": "https://avatars.githubusercontent.com/u/1195281?v=4", "gravatar_id": "", "url": "https://api.github.com/users/efaust", "html_url": "https://github.com/efaust", "followers_url": "https://api.github.com/users/efaust/followers", "following_url": "https://api.github.com/users/efaust/following{/other_user}", "gists_url": "https://api.github.com/users/efaust/gists{/gist_id}", "starred_url": "https://api.github.com/users/efaust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/efaust/subscriptions", "organizations_url": "https://api.github.com/users/efaust/orgs", "repos_url": "https://api.github.com/users/efaust/repos", "events_url": "https://api.github.com/users/efaust/events{/privacy}", "received_events_url": "https://api.github.com/users/efaust/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2023-02-03T23:02:08Z", "updated_at": "2023-03-15T21:16:38Z", "closed_at": "2023-03-15T21:16:37Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "If `on target delete deferred restrict` is specified on a required link and the target is deleted, the link will be empty in subsequent queries in the same transaction, which violates our model.\r\n\r\nI can think of two solutions:\r\n1. Disallow this combination\r\n2. Track what types may have had objects deleted by earlier queries in the transaction and insert `assert_exists` around accesses to them, like we do when something may be filtered by an access policy.\r\n\r\nI think option 1 seems clearly the right thing here", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4984/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4984/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4982", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4982/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4982/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4982/events", "html_url": "https://github.com/edgedb/edgedb/issues/4982", "id": 1570319397, "node_id": "I_kwDOBbYNSM5dmSwl", "number": 4982, "title": "User-defined functions with variadic+optional arguments have problems", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}, {"id": 4505522149, "node_id": "LA_kwDOBbYNSM8AAAABDIzP5Q", "url": "https://api.github.com/repos/edgedb/edgedb/labels/onboarding", "name": "onboarding", "color": "bfdadc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "efaust", "id": 1195281, "node_id": "MDQ6VXNlcjExOTUyODE=", "avatar_url": "https://avatars.githubusercontent.com/u/1195281?v=4", "gravatar_id": "", "url": "https://api.github.com/users/efaust", "html_url": "https://github.com/efaust", "followers_url": "https://api.github.com/users/efaust/followers", "following_url": "https://api.github.com/users/efaust/following{/other_user}", "gists_url": "https://api.github.com/users/efaust/gists{/gist_id}", "starred_url": "https://api.github.com/users/efaust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/efaust/subscriptions", "organizations_url": "https://api.github.com/users/efaust/orgs", "repos_url": "https://api.github.com/users/efaust/repos", "events_url": "https://api.github.com/users/efaust/events{/privacy}", "received_events_url": "https://api.github.com/users/efaust/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "efaust", "id": 1195281, "node_id": "MDQ6VXNlcjExOTUyODE=", "avatar_url": "https://avatars.githubusercontent.com/u/1195281?v=4", "gravatar_id": "", "url": "https://api.github.com/users/efaust", "html_url": "https://github.com/efaust", "followers_url": "https://api.github.com/users/efaust/followers", "following_url": "https://api.github.com/users/efaust/following{/other_user}", "gists_url": "https://api.github.com/users/efaust/gists{/gist_id}", "starred_url": "https://api.github.com/users/efaust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/efaust/subscriptions", "organizations_url": "https://api.github.com/users/efaust/orgs", "repos_url": "https://api.github.com/users/efaust/repos", "events_url": "https://api.github.com/users/efaust/events{/privacy}", "received_events_url": "https://api.github.com/users/efaust/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2023-02-03T19:13:30Z", "updated_at": "2023-02-28T21:23:06Z", "closed_at": "2023-02-28T21:23:06Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Variadic functions have all their variadic arguments packed into an array. If one of those arguments is `NULL`, the array will have a `NULL` in it, which is not legit in edgeql.\r\n\r\n```\r\nedgedb> create function foo(variadic doc: optional int64) -> array<int64> using (assert_exists(doc));\r\nOK: CREATE FUNCTION\r\nedgedb> select foo(1, <int64>{}, 3);\r\n[[1, null, 3]]\r\nedgedb> \\set output-format default\r\nedgedb> select foo(1, <int64>{}, 3);\r\nedgedb error: ProtocolEncodingError: ProtocolEncodingError: unexpected end of frame\r\nReconnecting...\r\n```\r\n\r\nI'm not sure that there is any sensible way to handle this in edgeql as it exists now, so we should probably just ban this.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4982/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4982/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4917", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4917/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4917/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4917/events", "html_url": "https://github.com/edgedb/edgedb/issues/4917", "id": 1555091618, "node_id": "I_kwDOBbYNSM5csNCi", "number": 4917, "title": "Selecting subtype property after update returns old data", "user": {"login": "llJochemll", "id": 7226748, "node_id": "MDQ6VXNlcjcyMjY3NDg=", "avatar_url": "https://avatars.githubusercontent.com/u/7226748?v=4", "gravatar_id": "", "url": "https://api.github.com/users/llJochemll", "html_url": "https://github.com/llJochemll", "followers_url": "https://api.github.com/users/llJochemll/followers", "following_url": "https://api.github.com/users/llJochemll/following{/other_user}", "gists_url": "https://api.github.com/users/llJochemll/gists{/gist_id}", "starred_url": "https://api.github.com/users/llJochemll/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/llJochemll/subscriptions", "organizations_url": "https://api.github.com/users/llJochemll/orgs", "repos_url": "https://api.github.com/users/llJochemll/repos", "events_url": "https://api.github.com/users/llJochemll/events{/privacy}", "received_events_url": "https://api.github.com/users/llJochemll/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-01-24T14:28:23Z", "updated_at": "2023-01-31T20:02:34Z", "closed_at": "2023-01-31T20:02:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n\r\n<!--\r\nFor the EdgeDB Version: run `edgedb query 'select sys::get_version_as_str()'` from your project directory (or run `select sys::get_version_as_str();` in the EdgeDB interactive shell).\r\nFor the EdgeDB CLI Version: Run `edgedb --version` from anywhere\r\n-->\r\n\r\n- EdgeDB Version: 2.9\r\n- EdgeDB CLI Version: 2.3.0\r\n- OS Version: WSL\r\n\r\nSteps to Reproduce:\r\n\r\n1. Insert a Dog with a name:\r\n```\r\ninsert Dog {\r\n  name := \"oldName\"\r\n}\r\n```\r\n\r\n2. Update Animal with a new name:\r\n```\r\nselect (update Animal set {\r\n  name := \"newName\"\r\n}) {\r\n  c1 := .name,\r\n  c2 := [is Animal].name,\r\n  c3 := [is Cat].name,\r\n  c4 := [is Dog].name\r\n}\r\n```\r\nthis returns:\r\n```json\r\n[\r\n  {\r\n    \"c1\": \"newName\",\r\n    \"c2\": \"newName\",\r\n    \"c3\": null,\r\n    \"c4\": \"oldName\"\r\n  }\r\n]\r\n```\r\n\r\nI would expect `c4` to also return `\"newName\"`\r\n\r\n<br/>\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\n\r\nSchema:\r\n```\r\nabstract type Animal {\r\n    required property name -> str;\r\n}\r\n\r\ntype Cat extending Animal {\r\n}\r\n\r\ntype Dog extending Animal {\r\n}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4917/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4917/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4908", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4908/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4908/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4908/events", "html_url": "https://github.com/edgedb/edgedb/issues/4908", "id": 1550241340, "node_id": "I_kwDOBbYNSM5cZs48", "number": 4908, "title": "array parameters don't work in HTTP mode", "user": {"login": "chuni-9999", "id": 121416080, "node_id": "U_kgDOBzypkA", "avatar_url": "https://avatars.githubusercontent.com/u/121416080?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chuni-9999", "html_url": "https://github.com/chuni-9999", "followers_url": "https://api.github.com/users/chuni-9999/followers", "following_url": "https://api.github.com/users/chuni-9999/following{/other_user}", "gists_url": "https://api.github.com/users/chuni-9999/gists{/gist_id}", "starred_url": "https://api.github.com/users/chuni-9999/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chuni-9999/subscriptions", "organizations_url": "https://api.github.com/users/chuni-9999/orgs", "repos_url": "https://api.github.com/users/chuni-9999/repos", "events_url": "https://api.github.com/users/chuni-9999/events{/privacy}", "received_events_url": "https://api.github.com/users/chuni-9999/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 2877515629, "node_id": "MDU6TGFiZWwyODc3NTE1NjI5", "url": "https://api.github.com/repos/edgedb/edgedb/labels/server", "name": "server", "color": "4023F4", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2023-01-20T02:58:46Z", "updated_at": "2023-01-31T03:24:09Z", "closed_at": "2023-01-31T03:24:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n\r\n<!--\r\nFor the EdgeDB Version: run `edgedb query 'select sys::get_version_as_str()'` from your project directory (or run `select sys::get_version_as_str();` in the EdgeDB interactive shell).\r\nFor the EdgeDB CLI Version: Run `edgedb --version` from anywhere\r\n-->\r\n\r\n\r\n- Used Java & Springboot\r\n- EdgeDB Version: 2.9+a3d80ef\r\n- EdgeDB CLI Version: EdgeDB CLI 2.2.6+7eabbf9\r\n- OS Version: macOS Monterey 12.5\r\n\r\nSteps to Reproduce:\r\n\r\n1. Use EdgeQL over HTTP\r\n2.  POST request with array property in variables.\r\n3.  unsupported array dimensions error occurred\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\n\r\nSchema:\r\n```sh\r\nusing extension edgeql_http;\r\nmodule default {\r\n\r\n    type Menu {\r\n        property name -> str;\r\n        property price -> int32;\r\n        property description -> str;\r\n        property is_displayed -> bool;\r\n        property is_soldout -> bool;\r\n        property sequence_number -> int32;\r\n\r\n        property category_id -> uuid;\r\n        property option_ids -> array<uuid>;\r\n\r\n        property is_deleted -> bool;\r\n        property created_at -> cal::local_datetime;\r\n        property updated_at -> cal::local_datetime;\r\n    }\r\n}\r\n```\r\n\r\nRequest Payload:\r\n```json\r\n{\r\n  \"variables\": {\r\n    \"id\": null,\r\n    \"isDeleted\": false,\r\n    \"createdAt\": null,\r\n    \"updatedAt\": null,\r\n    \"name\": \"test_2144f046f408\",\r\n    \"price\": 47,\r\n    \"description\": \"test_754e65b0cfca\",\r\n    \"isDisplayed\": true,\r\n    \"isSoldout\": true,\r\n    \"sequenceNumber\": 95,\r\n    \"categoryId\": \"84b49941-a894-43fc-bf24-4f9d76d0b4d8\",\r\n    \"optionIds\": [\r\n      \"0fb88d5a-cfd6-4f61-839c-6a84a799f162\",\r\n      \"4ab6b33e-b1a6-4b98-9299-3ad0ec7d49f4\"\r\n    ]\r\n  },\r\n  \"query\": \"insert Menu {\\nis_deleted := false,\\ncreated_at := cal::to_local_datetime(std::datetime_current(), 'Asia/Seoul'),\\nupdated_at := cal::to_local_datetime(std::datetime_current(), 'Asia/Seoul'),\\nname := <str>$name,\\nprice := <int32>$price,\\ndescription := <str>$description,\\nis_displayed := <bool>$isDisplayed,\\nis_soldout := <bool>$isSoldout,\\nsequence_number := <int32>$sequenceNumber,\\ncategory_id := <uuid>$categoryId,\\noption_ids := <array<uuid>>$optionIds\\n};\"\r\n}\r\n```\r\n\r\nError\r\n```sh\r\nerror={message=unsupported array dimensions, type=InputDataError, code=50462720}\r\n```\r\n\r\n\r\n### Opinion\r\n- Exclude the array element or enter a value directly into query and call it, it will perform normally.\r\n  - For exmaple\r\n    ```\r\n    {\"variables\":{\"id\":null,\"isDeleted\":false,\"createdAt\":null,\"updatedAt\":null,\"name\":\"test_2144f046f408\",\"price\":47,\"description\":\"test_754e65b0cfca\",\"isDisplayed\":true,\"isSoldout\":true,\"sequenceNumber\":95,\"categoryId\":\"84b49941-a894-43fc-bf24-4f9d76d0b4d8\",\"optionIds\":[\"0fb88d5a-cfd6-4f61-839c-6a84a799f162\",\"4ab6b33e-b1a6-4b98-9299-3ad0ec7d49f4\"],\"labelIds\":[\"581f3b5b-a82f-4228-8829-337381ad275f\",\"29775e52-8280-420d-b9a5-2bc6adef10b3\"]},\"query\":\"insert Menu {\\n\\tis_deleted := false,\\n\\tcreated_at := cal::to_local_datetime(std::datetime_current(), 'Asia/Seoul'),\\n\\tupdated_at := cal::to_local_datetime(std::datetime_current(), 'Asia/Seoul'),\\n\\tname := <str>$name,\\n\\tprice := <int32>$price,\\n\\tdescription := <str>$description,\\n\\tis_displayed := <bool>$isDisplayed,\\n\\tis_soldout := <bool>$isSoldout,\\n\\tsequence_number := <int32>$sequenceNumber,\\n\\tcategory_id := <uuid>$categoryId,\\n\\toption_ids := <array<uuid>>[\\\"0fb88d5a-cfd6-4f61-839c-6a84a799f162\\\",\\\"4ab6b33e-b1a6-4b98-9299-3ad0ec7d49f4\\\"]\\n}\"}\r\n    ```\r\n- Is the request payload the problem?  \r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4908/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4908/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4907", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4907/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4907/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4907/events", "html_url": "https://github.com/edgedb/edgedb/issues/4907", "id": 1550148519, "node_id": "I_kwDOBbYNSM5cZWOn", "number": 4907, "title": "Support `unless conflict on` on `multi` pointers", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 637054053, "node_id": "MDU6TGFiZWw2MzcwNTQwNTM=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2023-01-20T00:31:18Z", "updated_at": "2023-01-31T03:24:39Z", "closed_at": "2023-01-31T03:24:39Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I think it wasn't originally implemented because it couldn't just be done using `ON CONFLICT`.\r\nBut it turned out that a ton of stuff couldn't be implemented with just `ON CONFLICT`,\r\nand so we now have the \"conflict CTE\" mechanism that allows us to do unless conflict\r\nstyle behavior in very flexible ways.\r\n\r\nI think to make this work all we need to do is:\r\n * Remove the error\r\n * Make sure that we always use conflict CTEs if any of the pointers are multi\r\n\r\nLooking at this I found an existing bug when there is an exclusive multi pointer and `UNLESS CONFLICT` with no `ON` is specified: the query is allowed, but can spuriously raise a constraint violation, because it does not properly choose to use conflict CTEs. But if some modification to the query is made that *forces* the use of conflict CTEs (such as another insert to the same type), then it works properly!", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4907/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4907/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4884", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4884/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4884/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4884/events", "html_url": "https://github.com/edgedb/edgedb/issues/4884", "id": 1530780354, "node_id": "I_kwDOBbYNSM5bPdrC", "number": 4884, "title": "Converting `cal::local_time` from string can result into `24:00:00`", "user": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2023-01-12T14:09:42Z", "updated_at": "2023-01-31T23:52:07Z", "closed_at": "2023-01-31T23:52:07Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: 3.0-dev.7166+local\r\n\r\nSteps to Reproduce:\r\n```\r\nedgedb> SELECT cal::to_local_time('23:59:59.999999500');\r\nedgedb error: ProtocolEncodingError: ProtocolEncodingError: datetime is out of range\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4884/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4884/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4860", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4860/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4860/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4860/events", "html_url": "https://github.com/edgedb/edgedb/issues/4860", "id": 1513892775, "node_id": "I_kwDOBbYNSM5aPCun", "number": 4860, "title": "Custom access control policy fails for Insert operations (RBAC Implementation)", "user": {"login": "davidfries", "id": 12002376, "node_id": "MDQ6VXNlcjEyMDAyMzc2", "avatar_url": "https://avatars.githubusercontent.com/u/12002376?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidfries", "html_url": "https://github.com/davidfries", "followers_url": "https://api.github.com/users/davidfries/followers", "following_url": "https://api.github.com/users/davidfries/following{/other_user}", "gists_url": "https://api.github.com/users/davidfries/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidfries/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidfries/subscriptions", "organizations_url": "https://api.github.com/users/davidfries/orgs", "repos_url": "https://api.github.com/users/davidfries/repos", "events_url": "https://api.github.com/users/davidfries/events{/privacy}", "received_events_url": "https://api.github.com/users/davidfries/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-12-29T16:44:49Z", "updated_at": "2023-01-04T15:36:32Z", "closed_at": "2023-01-04T15:36:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n\r\n<!--\r\nFor the EdgeDB Version: run `edgedb query 'select sys::get_version_as_str()'` from your project directory (or run `select sys::get_version_as_str();` in the EdgeDB interactive shell).\r\nFor the EdgeDB CLI Version: Run `edgedb --version` from anywhere\r\n-->\r\nPosting this on behalf of spost on Discord as he's OOO currently. \r\n\r\n[Discord thread](https://discord.com/channels/841451783728529451/1055624003508776970/1055624008655183872) for context \r\n\r\n- EdgeDB Version: 2.8+afca054\r\n- EdgeDB CLI Version: EdgeDB CLI 2.2.6+b869667\r\n- OS Version: Pop!_OS 22.04 LTS x86_64\r\n\r\nSteps to Reproduce:\r\nAttached is a mostly-empty edgedb project with the RBAC schema, an Example type that extends RBAC::Controlled, and a setup.edgeql file\r\n\r\n1.  Use attached zip and run `edgedb query -f setup.edgeql`\r\n2. Try to add an Example that belongs to that organization while using that role\r\n\r\n\r\n[edgedb-rbac-repro.zip](https://github.com/edgedb/edgedb/files/10320540/edgedb-rbac-repro.zip)\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4860/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4860/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4836", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4836/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4836/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4836/events", "html_url": "https://github.com/edgedb/edgedb/issues/4836", "id": 1504881879, "node_id": "I_kwDOBbYNSM5ZsqzX", "number": 4836, "title": "Simultaneous total deletion of related objects fails in the presence of multi links", "user": {"login": "stealth-toucan", "id": 119894388, "node_id": "U_kgDOByVxdA", "avatar_url": "https://avatars.githubusercontent.com/u/119894388?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stealth-toucan", "html_url": "https://github.com/stealth-toucan", "followers_url": "https://api.github.com/users/stealth-toucan/followers", "following_url": "https://api.github.com/users/stealth-toucan/following{/other_user}", "gists_url": "https://api.github.com/users/stealth-toucan/gists{/gist_id}", "starred_url": "https://api.github.com/users/stealth-toucan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stealth-toucan/subscriptions", "organizations_url": "https://api.github.com/users/stealth-toucan/orgs", "repos_url": "https://api.github.com/users/stealth-toucan/repos", "events_url": "https://api.github.com/users/stealth-toucan/events{/privacy}", "received_events_url": "https://api.github.com/users/stealth-toucan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2022-12-20T16:46:30Z", "updated_at": "2023-03-17T17:46:50Z", "closed_at": "2023-03-17T17:46:50Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "- EdgeDB Version: `2.9`\r\n- EdgeDB CLI Version: Irrelevant\r\n- OS Version: Irrelevant\r\n\r\nSteps to Reproduce:\r\n\r\n1. Migrate to the schema below using `start migration to ...; populate migration; commit migration;`.\r\n2. Run query A below.\r\n3. Run query B below.\r\n4. Step 3 will fail with `ConstraintViolationError: deletion of default::B (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx) is prohibited by link target policy`\r\n\r\nIt's unclear to us if this is considered a bug (Query C succeeds), however a similar setup with single links succeeds regardless of the order of deletion. If this is not considered a bug, the burden of the topological sort falls to the end-user.\r\n\r\nSchema:\r\n\r\n```\r\nmodule default {\r\n  type A {\r\n    required multi link x -> B;\r\n  }\r\n  \r\n  type B;\r\n}\r\n```\r\n\r\nQuery A:\r\n\r\n```\r\nwith\r\n  a := (insert B),\r\n  b := (insert B),\r\n  c := (insert A {\r\n      x := {a, b}\r\n  })\r\nselect {\r\n  c := c\r\n}\r\n```\r\n\r\nQuery B:\r\n\r\n```\r\nwith\r\n  a := (DELETE B),\r\n  b := (DELETE A)\r\nselect {\r\n  a := a,\r\n  b := b\r\n}\r\n```\r\n\r\nQuery C:\r\n\r\n```\r\nwith\r\n  a := (DELETE A),\r\n  b := (DELETE B)\r\nselect {\r\n  a := a,\r\n  b := b\r\n}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4836/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4836/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4834", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4834/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4834/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4834/events", "html_url": "https://github.com/edgedb/edgedb/issues/4834", "id": 1503431199, "node_id": "I_kwDOBbYNSM5ZnIof", "number": 4834, "title": "single links with link properties can get into inconsistent states", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-12-19T19:05:05Z", "updated_at": "2023-03-29T23:33:59Z", "closed_at": "2023-03-29T23:33:58Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "single links with link properties get stored twice in the database:\r\n * Inline as a column in the table\r\n * In a link table, with the link properties\r\n\r\nIn updates and inserts, we duplicate the computation for each of those, and it's possible for them to skew:\r\n```\r\ncreate type N { create required property n -> int64; };\r\ninsert N { n := 1 };\r\ninsert N { n := 2 };\r\ncreate type L { create link foo -> N { create property x -> str; } };\r\n```\r\nThen we do some inserts to `L` that pick a random `N` (run this a few times):\r\n```\r\ninsert L { foo := (select N { @x := \"!\" } order by random() limit 1) };\r\n```\r\nAnd check the results:\r\n```\r\nedgedb> select L { foo: { n, @x } };\r\n[\r\n  {\"foo\": {\"@x\": \"!\", \"n\": 1}},\r\n  {\"foo\": {\"@x\": null, \"n\": 2}},\r\n  {\"foo\": {\"@x\": null, \"n\": 1}},\r\n  {\"foo\": {\"@x\": null, \"n\": 2}},\r\n  {\"foo\": {\"@x\": null, \"n\": 2}},\r\n  {\"foo\": {\"@x\": \"!\", \"n\": 1}}\r\n]\r\n```\r\nand we see `@x` is missing in a bunch of places because the link table target doesn't match.\r\n\r\nOn one hand, this is pretty bad, but on the other hand, using link properties on single links is a pointless exercise anyway.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4834/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4834/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4781", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4781/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4781/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4781/events", "html_url": "https://github.com/edgedb/edgedb/issues/4781", "id": 1480421512, "node_id": "I_kwDOBbYNSM5YPXCI", "number": 4781, "title": "Can't assign `.id` as body of computed", "user": {"login": "fmoor", "id": 8278635, "node_id": "MDQ6VXNlcjgyNzg2MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/8278635?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmoor", "html_url": "https://github.com/fmoor", "followers_url": "https://api.github.com/users/fmoor/followers", "following_url": "https://api.github.com/users/fmoor/following{/other_user}", "gists_url": "https://api.github.com/users/fmoor/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmoor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmoor/subscriptions", "organizations_url": "https://api.github.com/users/fmoor/orgs", "repos_url": "https://api.github.com/users/fmoor/repos", "events_url": "https://api.github.com/users/fmoor/events{/privacy}", "received_events_url": "https://api.github.com/users/fmoor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-12-06T23:06:56Z", "updated_at": "2022-12-14T00:26:21Z", "closed_at": "2022-12-14T00:26:21Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- OS Version: ubuntu 22.04\r\n\r\nSteps to Reproduce:\r\n```bash\r\n$ edgedb\r\nEdgeDB 2.7+81de4dd (repl 2.3.0-dev.895+cba06af)\r\nType \\help for help, \\quit to quit.\r\nedgedb> SELECT schema::Type {\r\n.......   XYZ := .id,\r\n....... };\r\nerror: QueryError: cannot assign to XYZ\r\n  \u250c\u2500 query:2:3\r\n  \u2502\r\n2 \u2502   XYZ := .id,\r\n  \u2502   ^^^^^^^^^^ consider enabling the \"allow_user_specified_id\" configuration parameter to allow setting custom object ids\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4781/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4781/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4770", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4770/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4770/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4770/events", "html_url": "https://github.com/edgedb/edgedb/issues/4770", "id": 1474140117, "node_id": "I_kwDOBbYNSM5X3ZfV", "number": 4770, "title": "InternalServerError: No method to generate code for TupleVar", "user": {"login": "jaclarke", "id": 2085287, "node_id": "MDQ6VXNlcjIwODUyODc=", "avatar_url": "https://avatars.githubusercontent.com/u/2085287?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaclarke", "html_url": "https://github.com/jaclarke", "followers_url": "https://api.github.com/users/jaclarke/followers", "following_url": "https://api.github.com/users/jaclarke/following{/other_user}", "gists_url": "https://api.github.com/users/jaclarke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaclarke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaclarke/subscriptions", "organizations_url": "https://api.github.com/users/jaclarke/orgs", "repos_url": "https://api.github.com/users/jaclarke/repos", "events_url": "https://api.github.com/users/jaclarke/events{/privacy}", "received_events_url": "https://api.github.com/users/jaclarke/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-12-03T16:05:12Z", "updated_at": "2022-12-13T02:05:21Z", "closed_at": "2022-12-13T02:05:21Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: 3.0-dev.7093+local\r\n- EdgeDB CLI Version: 2.3.0\r\n\r\nSteps to Reproduce:\r\n\r\n```\r\nwith items := {'a', 'b', 'c', 'd'}\r\ngroup enumerate(items)\r\nusing groupIndex := .0 // 2\r\nby groupIndex;\r\n```\r\n```\r\nInternalServerError: No method to generate code for TupleVar\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/home/james/dev/edgedb/edb/server/compiler_pool/worker_proc.py\", line 55, in worker\r\n          res = meth(*args)\r\n        File \"/home/james/dev/edgedb/edb/server/compiler_pool/worker.py\", line 161, in compile\r\n          units, cstate = COMPILER.compile(\r\n        File \"/home/james/dev/edgedb/edb/server/compiler/compiler.py\", line 552, in compile\r\n          unit_group = compile(ctx=ctx, source=source)\r\n        File \"/home/james/dev/edgedb/edb/server/compiler/compiler.py\", line 1604, in compile\r\n          return _try_compile(ctx=ctx, source=source)\r\n        File \"/home/james/dev/edgedb/edb/server/compiler/compiler.py\", line 1669, in _try_compile\r\n          comp, capabilities = _compile_dispatch_ql(\r\n        File \"/home/james/dev/edgedb/edb/server/compiler/compiler.py\", line 1578, in _compile_dispatch_ql\r\n          query = _compile_ql_query(ctx, ql, script_info=script_info)\r\n        File \"/home/james/dev/edgedb/edb/server/compiler/compiler.py\", line 1173, in _compile_ql_query\r\n          sql_text, argmap = pg_compiler.compile_ir_to_sql(\r\n        File \"/home/james/dev/edgedb/edb/pgsql/compiler/__init__.py\", line 176, in compile_ir_to_sql\r\n          sql_text = run_codegen(qtree, pretty=pretty)\r\n        File \"/home/james/dev/edgedb/edb/pgsql/compiler/__init__.py\", line 201, in run_codegen\r\n          codegen.visit(qtree)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/visitor.py\", line 160, in visit\r\n          return self.node_visit(node)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 53, in node_visit\r\n          return visitor(node)\r\n        File \"/home/james/dev/edgedb/edb/pgsql/codegen.py\", line 240, in visit_SelectStmt\r\n          self.visit_list(node.from_clause)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 97, in visit_list\r\n          self.visit(item, **kwargs)  # type: ignore\r\n        File \"/home/james/dev/edgedb/edb/common/ast/visitor.py\", line 160, in visit\r\n          return self.node_visit(node)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 53, in node_visit\r\n          return visitor(node)\r\n        File \"/home/james/dev/edgedb/edb/pgsql/codegen.py\", line 586, in visit_JoinExpr\r\n          self.visit(node.larg)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/visitor.py\", line 160, in visit\r\n          return self.node_visit(node)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 53, in node_visit\r\n          return visitor(node)\r\n        File \"/home/james/dev/edgedb/edb/pgsql/codegen.py\", line 530, in visit_RangeSubselect\r\n          self.visit(node.subquery)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/visitor.py\", line 160, in visit\r\n          return self.node_visit(node)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 53, in node_visit\r\n          return visitor(node)\r\n        File \"/home/james/dev/edgedb/edb/pgsql/codegen.py\", line 240, in visit_SelectStmt\r\n          self.visit_list(node.from_clause)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 97, in visit_list\r\n          self.visit(item, **kwargs)  # type: ignore\r\n        File \"/home/james/dev/edgedb/edb/common/ast/visitor.py\", line 160, in visit\r\n          return self.node_visit(node)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 53, in node_visit\r\n          return visitor(node)\r\n        File \"/home/james/dev/edgedb/edb/pgsql/codegen.py\", line 605, in visit_JoinExpr\r\n          self.visit(node.rarg)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/visitor.py\", line 160, in visit\r\n          return self.node_visit(node)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 53, in node_visit\r\n          return visitor(node)\r\n        File \"/home/james/dev/edgedb/edb/pgsql/codegen.py\", line 530, in visit_RangeSubselect\r\n          self.visit(node.subquery)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/visitor.py\", line 160, in visit\r\n          return self.node_visit(node)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 53, in node_visit\r\n          return visitor(node)\r\n        File \"/home/james/dev/edgedb/edb/pgsql/codegen.py\", line 240, in visit_SelectStmt\r\n          self.visit_list(node.from_clause)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 97, in visit_list\r\n          self.visit(item, **kwargs)  # type: ignore\r\n        File \"/home/james/dev/edgedb/edb/common/ast/visitor.py\", line 160, in visit\r\n          return self.node_visit(node)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 53, in node_visit\r\n          return visitor(node)\r\n        File \"/home/james/dev/edgedb/edb/pgsql/codegen.py\", line 586, in visit_JoinExpr\r\n          self.visit(node.larg)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/visitor.py\", line 160, in visit\r\n          return self.node_visit(node)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 53, in node_visit\r\n          return visitor(node)\r\n        File \"/home/james/dev/edgedb/edb/pgsql/codegen.py\", line 530, in visit_RangeSubselect\r\n          self.visit(node.subquery)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/visitor.py\", line 160, in visit\r\n          return self.node_visit(node)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 53, in node_visit\r\n          return visitor(node)\r\n        File \"/home/james/dev/edgedb/edb/pgsql/codegen.py\", line 227, in visit_SelectStmt\r\n          self.visit_list(node.target_list)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 97, in visit_list\r\n          self.visit(item, **kwargs)  # type: ignore\r\n        File \"/home/james/dev/edgedb/edb/common/ast/visitor.py\", line 160, in visit\r\n          return self.node_visit(node)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 53, in node_visit\r\n          return visitor(node)\r\n        File \"/home/james/dev/edgedb/edb/pgsql/codegen.py\", line 474, in visit_ResTarget\r\n          self.visit(node.val)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/visitor.py\", line 160, in visit\r\n          return self.node_visit(node)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 53, in node_visit\r\n          return visitor(node)\r\n        File \"/home/james/dev/edgedb/edb/pgsql/codegen.py\", line 240, in visit_SelectStmt\r\n          self.visit_list(node.from_clause)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 97, in visit_list\r\n          self.visit(item, **kwargs)  # type: ignore\r\n        File \"/home/james/dev/edgedb/edb/common/ast/visitor.py\", line 160, in visit\r\n          return self.node_visit(node)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 53, in node_visit\r\n          return visitor(node)\r\n        File \"/home/james/dev/edgedb/edb/pgsql/codegen.py\", line 543, in visit_RangeFunction\r\n          self.visit_list(node.functions)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 97, in visit_list\r\n          self.visit(item, **kwargs)  # type: ignore\r\n        File \"/home/james/dev/edgedb/edb/common/ast/visitor.py\", line 160, in visit\r\n          return self.node_visit(node)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 53, in node_visit\r\n          return visitor(node)\r\n        File \"/home/james/dev/edgedb/edb/pgsql/codegen.py\", line 692, in visit_FuncCall\r\n          self.visit_list(node.args, newlines=False)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 97, in visit_list\r\n          self.visit(item, **kwargs)  # type: ignore\r\n        File \"/home/james/dev/edgedb/edb/common/ast/visitor.py\", line 160, in visit\r\n          return self.node_visit(node)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 53, in node_visit\r\n          return visitor(node)\r\n        File \"/home/james/dev/edgedb/edb/pgsql/codegen.py\", line 674, in visit_ArrayExpr\r\n          self.visit_list(node.elements, newlines=False)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 97, in visit_list\r\n          self.visit(item, **kwargs)  # type: ignore\r\n        File \"/home/james/dev/edgedb/edb/common/ast/visitor.py\", line 160, in visit\r\n          return self.node_visit(node)\r\n        File \"/home/james/dev/edgedb/edb/common/ast/codegen.py\", line 53, in node_visit\r\n          return visitor(node)\r\n        File \"/home/james/dev/edgedb/edb/pgsql/codegen.py\", line 111, in generic_visit\r\n          raise SQLSourceGeneratorError(\r\n      edb.pgsql.codegen.SQLSourceGeneratorError: No method to generate code for TupleVar\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4770/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4770/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4766", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4766/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4766/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4766/events", "html_url": "https://github.com/edgedb/edgedb/issues/4766", "id": 1473652946, "node_id": "I_kwDOBbYNSM5X1ijS", "number": 4766, "title": "`RESET SCHEMA TO INITIAL` leaves database in broken state", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-12-03T01:53:52Z", "updated_at": "2022-12-06T13:04:31Z", "closed_at": "2022-12-06T13:04:31Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Somehow the schema version id (`__schema_version__`/`edgedb.\"_SchemaSchemaVersion\"`) stored in the database is getting fouled up after running `RESET SCHEMA TO INITIAL`, such that subsequent DDL commands produce\r\n```\r\nedgedb.errors.TransactionSerializationError: Cannot serialize DDL: 0f51bd2b-72aa-11ed-9fc6-61c4bb93e1e1\r\n```\r\n\r\nIt seems that `RESET SCHEMA TO INITIAL` leaves the database in a broken state where no DDL can be run successfully. This doesn't cause any problems in the normal testing mode because `test_edgeql_migration_reset_schema` happens to be the last test in that test suite that actually tries to modify the database.\r\n(I ran into this trying to debug the NOCREATEDB test mode, which needs to reuse the same database for everything and where this ends up as a huge problem)\r\n\r\nThis can be observed by adding a `await self.con.query('create module default')` to the end of `test_edgeql_migration_reset_schema`.\r\n\r\n(Related to that, reset schema should probably include an empty `module default` in the schema)", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4766/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4766/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4762", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4762/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4762/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4762/events", "html_url": "https://github.com/edgedb/edgedb/issues/4762", "id": 1473442961, "node_id": "I_kwDOBbYNSM5X0vSR", "number": 4762, "title": "Busted cardinality inference when filtering multisets", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-12-02T21:04:10Z", "updated_at": "2022-12-02T22:43:56Z", "closed_at": "2022-12-02T22:43:56Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "If we have a filter on an exclusive constraint on a set with duplicates, we can incorrectly infer a single cardinality.\r\n\r\n```\r\nwith X := {User, User},\r\nselect { alice := (select X filter .name = 'Alice') }; \r\n```\r\ngives the dreaded\r\n```\r\nedgedb error: InternalServerError: more than one row returned by a subquery used as an expression\r\n```\r\n\r\nConceptually the solution is to only apply the filter checks when multiplicity inference says it is a proper set, but we need to make sure there isn't a mutual recursion problem there.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4762/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4762/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4749", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4749/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4749/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4749/events", "html_url": "https://github.com/edgedb/edgedb/issues/4749", "id": 1471872604, "node_id": "I_kwDOBbYNSM5Xuv5c", "number": 4749, "title": "Don't use derived type names in \"function does not exist errors\"", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-12-01T19:56:43Z", "updated_at": "2022-12-05T13:47:55Z", "closed_at": "2022-12-05T13:47:54Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nedgedb> with x := 'a', select sum(x);\r\nerror: QueryError: function \"sum(arg0: __derived__::x)\" does not exist\r\n```\r\nThis is a bad error, we should say\r\n```\r\nedgedb> with x := 'a', select sum(x);\r\nerror: QueryError: function \"sum(arg0: std::str)\" does not exist\r\n```\r\n\r\nOperators get this right so fixing it is probably a simple matter:\r\n```\r\nedgedb> with x := 'a', select x ++ 1;\r\nerror: InvalidTypeError: operator '++' cannot be applied to operands of type 'std::str' and 'std::int64'\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4749/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4749/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4733", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4733/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4733/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4733/events", "html_url": "https://github.com/edgedb/edgedb/issues/4733", "id": 1467404536, "node_id": "I_kwDOBbYNSM5XdtD4", "number": 4733, "title": "__subject__ does not work inside insert access policies", "user": {"login": "aldentepasta", "id": 101300960, "node_id": "U_kgDOBgm64A", "avatar_url": "https://avatars.githubusercontent.com/u/101300960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aldentepasta", "html_url": "https://github.com/aldentepasta", "followers_url": "https://api.github.com/users/aldentepasta/followers", "following_url": "https://api.github.com/users/aldentepasta/following{/other_user}", "gists_url": "https://api.github.com/users/aldentepasta/gists{/gist_id}", "starred_url": "https://api.github.com/users/aldentepasta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aldentepasta/subscriptions", "organizations_url": "https://api.github.com/users/aldentepasta/orgs", "repos_url": "https://api.github.com/users/aldentepasta/repos", "events_url": "https://api.github.com/users/aldentepasta/events{/privacy}", "received_events_url": "https://api.github.com/users/aldentepasta/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-11-29T03:51:34Z", "updated_at": "2022-12-02T01:05:41Z", "closed_at": "2022-12-02T01:05:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "- EdgeDB Version: 2.7+5b16920\r\n- EdgeDB CLI Version: 2.2.6+af56767\r\n- OS Version: Ubuntu 22.04\r\n\r\nSteps to Reproduce:\r\n\r\n1. Declare a `User` object type, with no properties or links.\r\n1. Declare a computed `global current_user` that resolves to a `User` object instance.\r\n2. On the `User` type, create an `allow all` access policy such that `__subject__ ?= global current_user`.\r\n\r\nThis will fail with `there is no range var for ns~1@@(default::Redacted) value in <pg.SelectStmt at 0xDEADBEEF>`.\r\n\r\nSchema:\r\n\r\n```\r\nusing future nonrecursive_access_policies;\r\n\r\nmodule default {\r\n    global viewer_id -> uuid;\r\n    global viewer := (select User filter .id = global viewer_id);\r\n    \r\n    type User {\r\n        required property name -> str;\r\n\r\n        access policy allow_self\r\n            allow all\r\n            using (__subject__ ?= global viewer);\r\n    }\r\n}\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4733/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4733/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4722", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4722/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4722/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4722/events", "html_url": "https://github.com/edgedb/edgedb/issues/4722", "id": 1466876409, "node_id": "I_kwDOBbYNSM5XbsH5", "number": 4722, "title": "Cannot migrate after creating migration schema", "user": {"login": "Star3Lord", "id": 57606931, "node_id": "MDQ6VXNlcjU3NjA2OTMx", "avatar_url": "https://avatars.githubusercontent.com/u/57606931?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Star3Lord", "html_url": "https://github.com/Star3Lord", "followers_url": "https://api.github.com/users/Star3Lord/followers", "following_url": "https://api.github.com/users/Star3Lord/following{/other_user}", "gists_url": "https://api.github.com/users/Star3Lord/gists{/gist_id}", "starred_url": "https://api.github.com/users/Star3Lord/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Star3Lord/subscriptions", "organizations_url": "https://api.github.com/users/Star3Lord/orgs", "repos_url": "https://api.github.com/users/Star3Lord/repos", "events_url": "https://api.github.com/users/Star3Lord/events{/privacy}", "received_events_url": "https://api.github.com/users/Star3Lord/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-11-28T18:20:24Z", "updated_at": "2022-12-02T01:35:34Z", "closed_at": "2022-12-02T00:42:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n\r\n<!--\r\nFor the EdgeDB Version: run `edgedb query 'select sys::get_version_as_str()'` from your project directory (or run `select sys::get_version_as_str();` in the EdgeDB interactive shell).\r\nFor the EdgeDB CLI Version: Run `edgedb --version` from anywhere\r\n-->\r\n\r\n```\r\nedgedb error: InternalServerError: functions in index predicate must be marked IMMUTABLE\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: functions in index predicate must be marked IMMUTABLE\r\n```\r\n\r\n- EdgeDB Version: 2.7+5b16920\r\n- EdgeDB CLI Version: 2.2.1+36acd58\r\n- OS Version: official edgedb docker image\r\n\r\nSteps to Reproduce:\r\n\r\n1. run `edgedb migration create`\r\n2. run `edgedb migrate`\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\n\r\nSchema:\r\n```\r\n# using future nonrecursive_access_policies;\r\n\r\nmodule default {\r\n  global current_user_id -> uuid;\r\n  global current_user := (\r\n    select User filter .id = global current_user_id\r\n  );\r\n\r\n  abstract type Auditable {\r\n    required property created_at -> datetime {\r\n      readonly := true;\r\n      default := datetime_current();\r\n    };\r\n    required property modified_at -> datetime {\r\n      default := datetime_current();\r\n    };\r\n    link last_modified_by -> User;\r\n  }\r\n  \r\n  abstract type Stateful {\r\n    required property is_active -> bool {\r\n      default := true;\r\n    };\r\n    required property is_deleted -> bool {\r\n      default := false;\r\n    };\r\n    property deleted_at -> datetime;\r\n    link deleted_by -> User;\r\n\r\n    constraint expression on (\r\n      not exists .deleted_at if .is_deleted else true\r\n    ) {\r\n      errmessage := 'deleted_at must be set if is_deleted is true';\r\n    };\r\n  }\r\n\r\n  type User extending Auditable, Stateful, subscription::SubscriptionTarget {\r\n    required property username -> str {\r\n      # constraint exclusive {\r\n      #   errmessage := 'User with this username already exists';\r\n      # };\r\n      constraint max_len_value(255) {\r\n        errmessage := 'Username must be less than 255 characters';\r\n      };\r\n    };\r\n    required property password_hash -> str;\r\n    required property email -> str {\r\n      constraint max_len_value(255) {\r\n        errmessage := 'Email must be less than 255 characters';\r\n      };\r\n    };\r\n    required property is_verified -> bool {\r\n      default := false;\r\n    };\r\n    required property is_superuser -> bool {\r\n      default := false;\r\n    };\r\n    link profile := .<user[is Profile];\r\n    link dndy_account := .<user[is account::DndyAccount];\r\n    multi link oauth_accounts := .<user[is account::OAuthAccount];\r\n    multi link calendar_events := .<user[is event::CalendarEvent];\r\n    multi link subscriptions := .<subscriber[is subscription::Subscription];\r\n    multi link subscriptions_of := .<target[is subscription::Subscription];\r\n\r\n    constraint exclusive on (.email) except (.is_deleted) {\r\n      errmessage := 'User with this email already exists';\r\n    };\r\n\r\n    access policy other_users_cannot_change\r\n      deny update, delete\r\n      using ((global current_user_id ?!= .id) or (global current_user.is_superuser ?!= true));\r\n  }\r\n\r\n  type Profile extending Auditable, Stateful {\r\n    required property first_name -> str {\r\n      constraint max_len_value(255) {\r\n        errmessage := 'First name must be less than 255 characters';\r\n      };\r\n    };\r\n    required property last_name -> str {\r\n      constraint max_len_value(255) {\r\n        errmessage := 'Last name must be less than 255 characters';\r\n      };\r\n    };\r\n    property full_name := .first_name ++ ' ' ++ .last_name;\r\n    property phone_number -> str {\r\n      constraint max_len_value(20) {\r\n        errmessage := 'Phone number must be less than 20 characters';\r\n      };\r\n    };\r\n    link image -> Image;\r\n    required link user -> User {\r\n        constraint exclusive {\r\n            errmessage := 'User can only have one profile';\r\n        };\r\n    };\r\n\r\n    access policy other_users_cannot_change\r\n      deny update, delete\r\n      using ((global current_user_id ?!= .user.id) or (global current_user.is_superuser ?!= true));\r\n  }\r\n\r\n  type Image {\r\n    required property url -> str {\r\n      constraint regexp(r'%^(?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\x{00a1}-\\x{ffff}][a-z0-9\\x{00a1}-\\x{ffff}_-]{0,62})?[a-z0-9\\x{00a1}-\\x{ffff}]\\.)+(?:[a-z\\x{00a1}-\\x{ffff}]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?$%iuS');\r\n    }\r\n  }\r\n}\r\n\r\nmodule account {\r\n  scalar type AccountType extending enum<Dndy, OAuth>;\r\n\r\n  abstract type Account extending default::Auditable, default::Stateful {\r\n    required link user -> default::User;\r\n    required property type -> AccountType;\r\n  }\r\n\r\n  scalar type DndyStatus extending enum<`On`, Off>;\r\n\r\n  type DndyAccount extending Account {\r\n    annotation title := 'Dndy Account';\r\n    required property status -> DndyStatus {\r\n      default := DndyStatus.Off;\r\n    };\r\n\r\n    constraint expression on (\r\n      .type = AccountType.Dndy\r\n    ) {\r\n      errmessage := 'Account type must be Dndy';\r\n    };\r\n    constraint exclusive on ((.user, .type)) except (.is_deleted) {\r\n      errmessage := 'User can only have one Dndy account';\r\n    };\r\n  }\r\n\r\n  type OAuthAccount extending Account {\r\n    annotation title := 'OAuth Account';\r\n    required property provider -> str {\r\n      constraint max_len_value(255) {\r\n        errmessage := 'Provider must be less than 255 characters';\r\n      };\r\n    };\r\n    required property external_id -> str {\r\n      constraint max_len_value(255) {\r\n        errmessage := 'Provider ID must be less than 255 characters';\r\n      };\r\n    };\r\n    required property access_token -> str;\r\n    required property refresh_token -> str;\r\n    property id_token -> str;\r\n    property expires_at -> datetime;\r\n    property cache -> str;\r\n    property scopes -> array<str>;\r\n\r\n    constraint expression on (\r\n      .type = AccountType.OAuth\r\n    ) {\r\n      errmessage := 'Account type must be OAuth';\r\n    };\r\n    constraint exclusive on ((.user, .type, .provider, .external_id)) except (.is_deleted) {\r\n      errmessage := 'User can only have one OAuth account per provider';\r\n    };\r\n  }\r\n    \r\n}\r\n\r\nmodule event {\r\n  type Event extending default::Auditable, default::Stateful, subscription::SubscriptionTarget {\r\n    required link user -> default::User;\r\n    required property source -> str {\r\n      default := 'internal';\r\n    };\r\n    required property title -> str {\r\n      constraint max_len_value(255) {\r\n        errmessage := 'Event title must be less than 255 characters';\r\n      };\r\n    };\r\n    property description -> str;\r\n    property start_date -> cal::local_date;\r\n    property start_datetime -> cal::local_datetime;\r\n    property start_timezone -> str;\r\n    property end_date -> cal::local_date;\r\n    property end_datetime -> cal::local_datetime;\r\n    property end_timezone -> str;\r\n    property location -> str;\r\n\r\n    multi link subscriptions_of := .<target[is subscription::Subscription];\r\n\r\n    constraint expression on (\r\n      (exists .start_date or exists .start_datetime)\r\n      and not (exists .start_date and exists .start_datetime)\r\n    ) {\r\n      errmessage := 'Either start_date or start_datetime must be set';\r\n    };\r\n\r\n    constraint expression on (\r\n      (exists .end_date or exists .end_datetime)\r\n      and not (exists .end_date and exists .end_datetime)\r\n    ) {\r\n      errmessage := 'Either end_date or end_datetime must be set';\r\n    };\r\n  }\r\n\r\n  scalar type CalendarEventType extending enum<`Single`, Recurring, RecurringInstance>;\r\n\r\n  type CalendarEvent extending Event {\r\n    required property type -> CalendarEventType {\r\n      default := CalendarEventType.`Single`;\r\n    };\r\n    property show_as -> str;\r\n    property external_id -> str;\r\n    required property is_cancelled -> bool {\r\n      default := false;\r\n    };\r\n    required property is_public -> bool {\r\n      default := false;\r\n    };\r\n    required property is_all_day -> bool {\r\n      default := false;\r\n    };\r\n    property is_recurring := .type = CalendarEventType.Recurring;\r\n    property rrule -> str;\r\n    \r\n    constraint expression on (\r\n      not exists .rrule if .type = CalendarEventType.Recurring else true\r\n    ) {\r\n      errmessage := 'rrule must be set if is_recurring is true';\r\n    };\r\n\r\n    # only apply the constraint if the event is recurring instance\r\n    constraint exclusive on (\r\n      (.user, .source, .external_id)\r\n    ) except (\r\n      .is_deleted or .type != CalendarEventType.RecurringInstance or .type != CalendarEventType.Recurring\r\n    ) {\r\n      errmessage := 'User already has an event with this external_id';\r\n    };\r\n  }\r\n}\r\n\r\nmodule notification {\r\n  scalar type NotificationLevel extending enum<Low, Medium, High>;\r\n  scalar type NotificationType extending enum<App, Push, Email, SMS>;\r\n\r\n  type Notification extending default::Auditable, default::Stateful {\r\n    required link user -> default::User;\r\n    required property type -> NotificationType {\r\n      default := NotificationType.App;\r\n    };\r\n    required property is_seen -> bool {\r\n      default := false;\r\n    };\r\n    required property initiator -> str {\r\n      default := 'internal';\r\n      constraint max_len_value(255) {\r\n        errmessage := 'Initiator must be less than 255 characters';\r\n      };\r\n    };\r\n    required property title -> str {\r\n      constraint max_len_value(255) {\r\n        errmessage := 'Notification title must be less than 255 characters';\r\n      };\r\n    };\r\n    required property body -> str;\r\n    required property level -> NotificationLevel {\r\n      default := NotificationLevel.Medium;\r\n    };\r\n  }\r\n}\r\n\r\n\r\nmodule subscription {\r\n  abstract type SubscriptionTarget {\r\n  }\r\n\r\n  scalar type SubscriptionType extending enum<OneTime, Recurring>;\r\n\r\n  type Subscription extending default::Auditable, default::Stateful {\r\n    required link subscriber -> default::User;\r\n    link target -> SubscriptionTarget;\r\n    required property type -> SubscriptionType;\r\n    required property is_expired -> bool {\r\n      default := false;\r\n    };\r\n    multi link notifications -> notification::Notification;\r\n\r\n    constraint exclusive on ((.subscriber, .target, .type)) except (.is_deleted) {\r\n      errmessage := 'User already has a subscription to this target';\r\n    };\r\n  }\r\n}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4722/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4722/timeline", "performed_via_github_app": null, "state_reason": "not_planned"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4716", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4716/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4716/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4716/events", "html_url": "https://github.com/edgedb/edgedb/issues/4716", "id": 1463940702, "node_id": "I_kwDOBbYNSM5XQfZe", "number": 4716, "title": "run migrate create resulting bug hint", "user": {"login": "AnsonHwang86", "id": 16233397, "node_id": "MDQ6VXNlcjE2MjMzMzk3", "avatar_url": "https://avatars.githubusercontent.com/u/16233397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AnsonHwang86", "html_url": "https://github.com/AnsonHwang86", "followers_url": "https://api.github.com/users/AnsonHwang86/followers", "following_url": "https://api.github.com/users/AnsonHwang86/following{/other_user}", "gists_url": "https://api.github.com/users/AnsonHwang86/gists{/gist_id}", "starred_url": "https://api.github.com/users/AnsonHwang86/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AnsonHwang86/subscriptions", "organizations_url": "https://api.github.com/users/AnsonHwang86/orgs", "repos_url": "https://api.github.com/users/AnsonHwang86/repos", "events_url": "https://api.github.com/users/AnsonHwang86/events{/privacy}", "received_events_url": "https://api.github.com/users/AnsonHwang86/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-11-25T01:43:21Z", "updated_at": "2022-12-02T23:46:12Z", "closed_at": "2022-12-02T23:46:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n\r\n```\r\nC:\\Users\\as\\hello-world-edgedb>edgedb migrate\r\n[2022-11-25T01:36:39Z WARN  edgedb::version_check] Newer version of edgedb tool exists 2.2.6+af56767 (current 2.2.5+00d579a). To upgrade run `edgedb cli upgrade`\r\nConnecting to an EdgeDB instance at localhost:10703...\r\nedgedb error: InternalServerError:\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/server/compiler_pool/worker_proc.py\", line 55, in worker\r\n          res = meth(*args)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/server/compiler_pool/worker.py\", line 185, in compile_in_tx\r\n          units, cstate = COMPILER.compile_in_tx(cstate, *args, **kwargs)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 2333, in compile_in_tx\r\n          return self._compile(ctx=ctx, source=source), ctx.state\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1807, in _compile\r\n          return self._try_compile(ctx=ctx, source=source)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1871, in _try_compile\r\n          comp, capabilities = self._compile_dispatch_ql(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1729, in _compile_dispatch_ql\r\n          query = self._compile_ql_migration(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1055, in _compile_ql_migration\r\n          query = self._compile_and_apply_ddl_stmt(ctx, ql)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 951, in _compile_and_apply_ddl_stmt\r\n          block, new_types, config_ops = self._process_delta(ctx, delta)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 390, in _process_delta\r\n          schema = pgdelta.apply(schema, context)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 6494, in apply\r\n          schema = super().apply(schema, context)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/schema/delta.py\", line 1510, in apply\r\n          schema = self.apply_subcommands(schema, context)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 147, in apply_subcommands\r\n          schema = super().apply_subcommands(schema, context)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/schema/delta.py\", line 1537, in apply_subcommands\r\n          schema = objop.apply(schema, context)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/schema/delta.py\", line 2996, in apply\r\n          schema = self._create_innards(schema, context)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/schema/delta.py\", line 2964, in _create_innards\r\n          return self.apply_subcommands(schema, context)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 147, in apply_subcommands\r\n          schema = super().apply_subcommands(schema, context)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/schema/delta.py\", line 946, in apply_subcommands\r\n          schema = op.apply(schema, context=context)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 3341, in apply\r\n          self.apply_scheduled_inhview_updates(schema, context)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 3086, in apply_scheduled_inhview_updates\r\n          self.recreate_inhview(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 3053, in recreate_inhview\r\n          self.create_inhview(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.7/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 2999, in create_inhview\r\n          assert has_table(obj, schema)\r\n      AssertionError\r\n```\r\n\r\n- EdgeDB Version:2.7\r\n- EdgeDB CLI Version: 2.2.5+00d579a\r\n- OS Version: windows 10 with WSL\r\n\r\nSteps to Reproduce:\r\n\r\n1. run `edgedb migrate` from old schema\r\n2.\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\n\r\nSchema:\r\n```\r\nmodule default {\r\n    type Product {\r\n        property sku -> str;\r\n        multi link names := .<product[is MultiLanguage];\r\n    }\r\n\r\n    type MultiLanguage {\r\n        link product -> Product;\r\n        required property lanCode -> LanguageCode;\r\n        required property languageText -> str;\r\n        constraint exclusive on ((.product, .lanCode));\r\n    }\r\n\r\n    scalar type LanguageCode extending enum<en_US, zh_CN, fr_FR, zh_TW, da_DK>;\r\n}\r\n```\r\n\r\nHere is content of `00005.edgeql`\r\n\r\n```\r\nCREATE MIGRATION m1l4blcvfgdb4esqln5eoj5ldlia3fggea37wpql3untg2nuelllca\r\n    ONTO m1crkeakntw36dqzeyynk4tw4oyozr3rxaxoqppqhtqee3jvsoxkwa\r\n{\r\n  ALTER TYPE default::MultiLanguage {\r\n      ALTER LINK product {\r\n          RESET EXPRESSION;\r\n          RESET EXPRESSION;\r\n          RESET CARDINALITY USING (SELECT\r\n              default::Product \r\n          LIMIT\r\n              1\r\n          );\r\n          RESET OPTIONALITY;\r\n          SET TYPE default::Product;\r\n      };\r\n  };\r\n  ALTER TYPE default::MultiLanguage {\r\n      CREATE CONSTRAINT std::exclusive ON ((.product, .lanCode));\r\n  };\r\n  ALTER TYPE default::MultiLanguage {\r\n      DROP CONSTRAINT std::exclusive ON (.lanCode);\r\n  };\r\n  ALTER TYPE default::Product {\r\n      ALTER LINK names {\r\n          USING (.<product[IS default::MultiLanguage]);\r\n      };\r\n  };\r\n};\r\n```\r\ndbschema folder for your reference\r\n[dbschema.zip](https://github.com/edgedb/edgedb/files/10087999/dbschema.zip)\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4716/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4716/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4704", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4704/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4704/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4704/events", "html_url": "https://github.com/edgedb/edgedb/issues/4704", "id": 1461617367, "node_id": "I_kwDOBbYNSM5XHoLX", "number": 4704, "title": "Can't select link property via backlink", "user": {"login": "jamesbeck", "id": 1736909, "node_id": "MDQ6VXNlcjE3MzY5MDk=", "avatar_url": "https://avatars.githubusercontent.com/u/1736909?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jamesbeck", "html_url": "https://github.com/jamesbeck", "followers_url": "https://api.github.com/users/jamesbeck/followers", "following_url": "https://api.github.com/users/jamesbeck/following{/other_user}", "gists_url": "https://api.github.com/users/jamesbeck/gists{/gist_id}", "starred_url": "https://api.github.com/users/jamesbeck/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jamesbeck/subscriptions", "organizations_url": "https://api.github.com/users/jamesbeck/orgs", "repos_url": "https://api.github.com/users/jamesbeck/repos", "events_url": "https://api.github.com/users/jamesbeck/events{/privacy}", "received_events_url": "https://api.github.com/users/jamesbeck/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2022-11-23T11:52:15Z", "updated_at": "2022-12-08T01:26:16Z", "closed_at": "2022-12-08T01:26:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n- EdgeDB Version: 2.7+a86e274\r\n- EdgeDB CLI Version: 2.2.6+7eabbf9\r\n- OS Version: MacOS 13.0.1 (22A400)\r\n\r\nWhen trying to select a link property via a backlink the following error is returned:\r\n\r\n`InternalServerError: column actors~1.25ee9fda-6af9-11ed-af36-2b332b67fd94 does not exist\r\nHint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md`\r\n\r\nSteps to Reproduce:\r\n\r\n1. Run this query on the EdgeDB example database:\r\n`\r\nselect Person {\r\n    name,\r\n    roles := .<actors[is Movie] {\r\n        title,\r\n        @character_name\r\n    }\r\n}\r\nfilter .name = \"Samuel L. Jackson\"\r\n`\r\n\r\nUsing EdgeDB Example DB Schema\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4704/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4704/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4646", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4646/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4646/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4646/events", "html_url": "https://github.com/edgedb/edgedb/issues/4646", "id": 1440677568, "node_id": "I_kwDOBbYNSM5V3v7A", "number": 4646, "title": "operator does not exist: text = uuid", "user": {"login": "fmoor", "id": 8278635, "node_id": "MDQ6VXNlcjgyNzg2MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/8278635?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmoor", "html_url": "https://github.com/fmoor", "followers_url": "https://api.github.com/users/fmoor/followers", "following_url": "https://api.github.com/users/fmoor/following{/other_user}", "gists_url": "https://api.github.com/users/fmoor/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmoor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmoor/subscriptions", "organizations_url": "https://api.github.com/users/fmoor/orgs", "repos_url": "https://api.github.com/users/fmoor/repos", "events_url": "https://api.github.com/users/fmoor/events{/privacy}", "received_events_url": "https://api.github.com/users/fmoor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-11-08T18:10:06Z", "updated_at": "2022-11-16T18:56:23Z", "closed_at": "2022-11-16T18:56:23Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- OS Version: ubuntu 22.04\r\n\r\nSteps to Reproduce:\r\n```\r\n$ edgedb\r\nEdgeDB 2.6+ba1661b (repl 2.1.0-dev.865+40c556b)\r\nType \\help for help, \\quit to quit.\r\n\r\nedgedb> insert User;\r\n{default::User {id: 0890545c-5f90-11ed-b76c-cfa33c8c7cb7}}\r\n\r\nedgedb> insert User;\r\n{default::User {id: 0acb5a5a-5f90-11ed-b76c-93d2fb46bccc}}\r\n\r\nedgedb> insert Message;\r\nedgedb error: InternalServerError: operator does not exist: text = uuid\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: operator does not exist: text = uuid\r\n```\r\n\r\n## Schema\r\n```\r\nmodule default {\r\n  type User {}\r\n\r\n  type Message {\r\n    link sender -> User;\r\n    link recipient -> User;\r\n\r\n    access policy at_least_sender_or_recipient\r\n    allow all\r\n    using (count((.sender union .recipient)) > 0)\r\n  }\r\n};\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4646/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4646/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4633", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4633/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4633/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4633/events", "html_url": "https://github.com/edgedb/edgedb/issues/4633", "id": 1436776502, "node_id": "I_kwDOBbYNSM5Vo3g2", "number": 4633, "title": "cardinality is unknown", "user": {"login": "fmoor", "id": 8278635, "node_id": "MDQ6VXNlcjgyNzg2MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/8278635?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmoor", "html_url": "https://github.com/fmoor", "followers_url": "https://api.github.com/users/fmoor/followers", "following_url": "https://api.github.com/users/fmoor/following{/other_user}", "gists_url": "https://api.github.com/users/fmoor/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmoor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmoor/subscriptions", "organizations_url": "https://api.github.com/users/fmoor/orgs", "repos_url": "https://api.github.com/users/fmoor/repos", "events_url": "https://api.github.com/users/fmoor/events{/privacy}", "received_events_url": "https://api.github.com/users/fmoor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2022-11-05T02:23:29Z", "updated_at": "2022-11-15T15:22:04Z", "closed_at": "2022-11-15T15:22:03Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- OS Version: ubuntu 22.04\r\n\r\n```\r\n$ edgedb\r\nEdgeDB 3.0-dev.7018+de3aa47 (repl 2.1.0-dev.865+40c556b)\r\nType \\help for help, \\quit to quit.\r\n\r\nedgedb> select <json>{ a := 1 } union <json>{ a := 2 };\r\n\r\nedgedb error: InternalServerError: cardinality is unknown\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/server/compiler_pool/worker_proc.py\", line 55, in worker\r\n          res = meth(*args)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/server/compiler_pool/worker.py\", line 160, in compile\r\n          units, cstate = COMPILER.compile(\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 2543, in compile\r\n          unit_group = self._compile(ctx=ctx, source=source)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 2053, in _compile\r\n          return self._try_compile(ctx=ctx, source=source)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 2117, in _try_compile\r\n          comp, capabilities = self._compile_dispatch_ql(\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 2027, in _compile_dispatch_ql\r\n          query = self._compile_ql_query(ctx, ql, script_info=script_info)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 687, in _compile_ql_query\r\n          ir = qlcompiler.compile_ast_to_ir(\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/edgeql/compiler/__init__.py\", line 179, in wrapper\r\n          return func(*args, **kwargs)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/edgeql/compiler/__init__.py\", line 237, in compile_ast_to_ir\r\n          ir_set = dispatch_mod.compile(tree, ctx=ctx)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/edgeql/compiler/stmt.py\", line 127, in compile_SelectQuery\r\n          stmt.result = compile_result_clause(\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/edgeql/compiler/stmt.py\", line 1288, in compile_result_clause\r\n          expr = dispatch.compile(result_expr, ctx=ectx)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/edgeql/compiler/expr.py\", line 136, in compile_BinOp\r\n          folded = try_fold_binop(op_node.expr, ctx=ctx)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/edgeql/compiler/expr.py\", line 278, in try_fold_binop\r\n          const = ireval.evaluate(opcall, schema=ctx.env.schema)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/ir/staeval.py\", line 150, in evaluate_OperatorCall\r\n          return _evaluate_union(opcall, schema)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/ir/staeval.py\", line 192, in _evaluate_union\r\n          val = evaluate(arg.expr, schema=schema)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/ir/staeval.py\", line 125, in evaluate_Set\r\n          return evaluate(ir_set.expr, schema=schema)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/ir/staeval.py\", line 92, in evaluate_SelectStmt\r\n          return evaluate(ir_stmt.result, schema)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/ir/staeval.py\", line 125, in evaluate_Set\r\n          return evaluate(ir_set.expr, schema=schema)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/ir/staeval.py\", line 107, in evaluate_TypeCast\r\n          schema_type_to_python_type(from_type, schema)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/ir/staeval.py\", line 305, in schema_type_to_python_type\r\n          return object_type_to_python_type(stype, schema)\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/ir/staeval.py\", line 378, in object_type_to_python_type\r\n          is_multi = ptr_card.is_multi()\r\n        File \"/home/fmoor/.local/share/edgedb/portable/3.0-dev.7018/lib/python3.10/site-packages/edb/edgeql/qltypes.py\", line 92, in is_multi\r\n          raise ValueError('cardinality is unknown')\r\n      ValueError: cardinality is unknown\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4633/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4633/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4610", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4610/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4610/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4610/events", "html_url": "https://github.com/edgedb/edgedb/issues/4610", "id": 1432198835, "node_id": "I_kwDOBbYNSM5VXZ6z", "number": 4610, "title": "Directions for building documentation are broken", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 646632736, "node_id": "MDU6TGFiZWw2NDY2MzI3MzY=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/documentation", "name": "documentation", "color": "5319e7", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-11-01T22:44:34Z", "updated_at": "2022-11-02T20:35:34Z", "closed_at": "2022-11-02T20:35:34Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "When I run `make docs`, I get\r\n```\r\nWarning, treated as error:\r\n/home/sully/src/e/edgedb/docs/clients/index.rst:26:toctree contains reference to nonexisting document 'clients/js/index'\r\n```\r\n\r\nI think the disconnect here is that the production docbuild is part of the internal website, and so this flow doesn't get used. I think it is probably worth having a dev flow for doc changes, though.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4610/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4610/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4592", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4592/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4592/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4592/events", "html_url": "https://github.com/edgedb/edgedb/issues/4592", "id": 1427874967, "node_id": "I_kwDOBbYNSM5VG6SX", "number": 4592, "title": "Can't cast to enum in index/constraint", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2022-10-28T21:48:11Z", "updated_at": "2022-12-21T15:43:56Z", "closed_at": "2022-12-21T15:43:56Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nscalar type OrderStatus extending enum<open, submitted, processing, complete, canceled>;\r\n\r\ntype Order {\r\n  required property status -> OrderStatus;\r\n  constraint exclusive on ((OrderStatus.open in .status));\r\n}\r\n```\r\nproduces `InternalServerError: functions in index expression must be marked IMMUTABLE`\r\n\r\nIt looks the problem is that the actual postgres-side cast is not marked IMMUTABLE.\r\n\r\nEdgeQL creates casts to enums as immutable, even if they are legitimate casts that could fail. Even if we didn't, we would certain want this sort of *literal reference that cannot possibly fail* to be IMMUTABLE.\r\n\r\nNot sure if there is a good way to fix this, though? Introduce wrapper casting functions for enums that we explicitly mark as IMMUTABLE?", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4592/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4592/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4577", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4577/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4577/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4577/events", "html_url": "https://github.com/edgedb/edgedb/issues/4577", "id": 1422743169, "node_id": "I_kwDOBbYNSM5UzVaB", "number": 4577, "title": "edgedb error: InternalServerError: None", "user": {"login": "quinchs", "id": 49576606, "node_id": "MDQ6VXNlcjQ5NTc2NjA2", "avatar_url": "https://avatars.githubusercontent.com/u/49576606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/quinchs", "html_url": "https://github.com/quinchs", "followers_url": "https://api.github.com/users/quinchs/followers", "following_url": "https://api.github.com/users/quinchs/following{/other_user}", "gists_url": "https://api.github.com/users/quinchs/gists{/gist_id}", "starred_url": "https://api.github.com/users/quinchs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/quinchs/subscriptions", "organizations_url": "https://api.github.com/users/quinchs/orgs", "repos_url": "https://api.github.com/users/quinchs/repos", "events_url": "https://api.github.com/users/quinchs/events{/privacy}", "received_events_url": "https://api.github.com/users/quinchs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-10-25T16:21:08Z", "updated_at": "2022-11-07T23:02:45Z", "closed_at": "2022-11-07T23:02:45Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Instance version: 2.4+23aa420\r\nCLI version: EdgeDB CLI 2.0.5+da7c868\r\n\r\nRunning the following query:\r\n\r\n```\r\nwith EEFDMNGEOJHQ := (\r\n  insert Person { name := <str>$JUOINWQCNSEY, email := <str>$IIRMTAUFXGSH,} \r\n  unless conflict on .email else (\r\n    select Person\r\n  )\r\n) \r\ninsert Person { name := <str>$YBOAISGNETAX, email := <str>$VKGJTAQCSKAT, best_friend := EEFDMNGEOJHQ} \r\nunless conflict on .email else (\r\n  update Person set { name := <str>$TCIBXBHFSPMC, email := <str>$DKZXRGAVAAVV, best_friend := EEFDMNGEOJHQ }\r\n);\r\n```\r\n\r\nWith the following schema:\r\n\r\n```\r\n  type Person {\r\n    required property name -> str;\r\n    required property email -> str {\r\n      constraint exclusive;\r\n    }\r\n    link best_friend -> Person;\r\n    multi link friends -> Person;\r\n  }\r\n```\r\n\r\nTraceback:\r\n```\r\nedgedb error: InternalServerError: None\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/__init__.py\", line 120, in compile_ir_to_sql_tree\r\n          qtree = dispatch.compile(ir_expr, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 60, in compile_Set\r\n          _compile_set_impl(ir_set, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 114, in _compile_set_impl\r\n          _compile_set(ir_set, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 677, in _compile_set\r\n          relgen.get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 160, in get_set_rvar\r\n          return _process_toplevel_query(ir_set, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 263, in _process_toplevel_query\r\n          rvars = _get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 302, in _get_set_rvar\r\n          rvars = process_set_as_subquery(ir_set, stmt, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 1384, in process_set_as_subquery\r\n          dispatch.visit(expr, ctx=newctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/dispatch.py\", line 44, in visit\r\n          compile(ir, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/stmt.py\", line 165, in compile_InsertStmt\r\n          dml.process_insert_body(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/dml.py\", line 674, in process_insert_body\r\n          rel = compile_insert_shape_element(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/dml.py\", line 1207, in compile_insert_shape_element\r\n          dispatch.visit(shape_el, ctx=insvalctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 85, in visit_Set\r\n          _compile_set_impl(ir_set, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 110, in _compile_set_impl\r\n          _compile_set(ir_set, ctx=scopectx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 677, in _compile_set\r\n          relgen.get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 207, in get_set_rvar\r\n          rvars = _get_set_rvar(ir_set, ctx=subctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 302, in _get_set_rvar\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 1384, in process_set_as_subquery\r\n          dispatch.visit(expr, ctx=newctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/dispatch.py\", line 44, in visit\r\n          compile(ir, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/stmt.py\", line 97, in compile_SelectStmt\r\n          outvar = clauses.compile_output(stmt.result, ctx=ictx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/clauses.py\", line 212, in compile_output\r\n          dispatch.visit(ir_set, ctx=newctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 85, in visit_Set\r\n          _compile_set_impl(ir_set, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 110, in _compile_set_impl\r\n          _compile_set(ir_set, ctx=scopectx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 677, in _compile_set\r\n          relgen.get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 207, in get_set_rvar\r\n          rvars = _get_set_rvar(ir_set, ctx=subctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 302, in _get_set_rvar\r\n          rvars = process_set_as_subquery(ir_set, stmt, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 1382, in process_set_as_subquery\r\n          dml.wrap_dml_cte(expr, dml_cte, ctx=subrelctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/dml.py\", line 331, in wrap_dml_cte\r\n          relctx.include_rvar(wrapper, dml_rvar, ir_stmt.subject.path_id, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/relctx.py\", line 221, in include_rvar\r\n          return include_specific_rvar(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/relctx.py\", line 267, in include_specific_rvar\r\n          rel_join(stmt, rvar, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/relctx.py\", line 1252, in rel_join\r\n          _plain_join(query, right_rvar, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/relctx.py\", line 1264, in _plain_join\r\n          lref = maybe_get_path_var(query, path_id, aspect='identity', ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/relctx.py\", line 397, in maybe_get_path_var\r\n          return pathctx.get_rvar_path_var(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/pathctx.py\", line 716, in get_rvar_path_var\r\n          if (path_id, aspect) in (outs := rvar.query.get_path_outputs(flavor)):\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/ast.py\", line 245, in query\r\n          raise NotImplementedError\r\n      NotImplementedError\r\n\r\n      The above exception was the direct cause of the following exception:\r\n\r\n      Traceback (most recent call last):\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/server/compiler_pool/worker_proc.py\", line 55, in worker\r\n          res = meth(*args)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/server/compiler_pool/worker.py\", line 160, in compile\r\n          units, cstate = COMPILER.compile(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 2249, in compile\r\n          unit_group = self._compile(ctx=ctx, source=source)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1770, in _compile\r\n          return self._try_compile(ctx=ctx, source=source)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1834, in _try_compile\r\n          comp, capabilities = self._compile_dispatch_ql(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1744, in _compile_dispatch_ql\r\n          query = self._compile_ql_query(ctx, ql, script_info=script_info)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 643, in _compile_ql_query\r\n          sql_text, argmap = pg_compiler.compile_ir_to_sql(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/__init__.py\", line 152, in compile_ir_to_sql\r\n          qtree = compile_ir_to_sql_tree(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.4/lib/python3.10/site-packages/edb/pgsql/compiler/__init__.py\", line 135, in compile_ir_to_sql_tree\r\n          raise errors.InternalServerError(*args) from e\r\n      edb.errors.InternalServerError: None\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4577/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4577/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4564", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4564/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4564/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4564/events", "html_url": "https://github.com/edgedb/edgedb/issues/4564", "id": 1418456735, "node_id": "I_kwDOBbYNSM5Ui-6f", "number": 4564, "title": "\"too many range table entries\" on nested filtering in the presence of Access Policies", "user": {"login": "jackfischer", "id": 6811459, "node_id": "MDQ6VXNlcjY4MTE0NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/6811459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jackfischer", "html_url": "https://github.com/jackfischer", "followers_url": "https://api.github.com/users/jackfischer/followers", "following_url": "https://api.github.com/users/jackfischer/following{/other_user}", "gists_url": "https://api.github.com/users/jackfischer/gists{/gist_id}", "starred_url": "https://api.github.com/users/jackfischer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jackfischer/subscriptions", "organizations_url": "https://api.github.com/users/jackfischer/orgs", "repos_url": "https://api.github.com/users/jackfischer/repos", "events_url": "https://api.github.com/users/jackfischer/events{/privacy}", "received_events_url": "https://api.github.com/users/jackfischer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-10-21T14:49:35Z", "updated_at": "2022-11-03T19:17:53Z", "closed_at": "2022-11-03T19:17:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 3.0-dev.7000+58a0109 \r\n- OS Version: macOS 12.6\r\n\r\nSteps to Reproduce:\r\n\r\n1. Perform a highly nested select/filter with access policies enabled (example below). We are seeing this on other queries as well. No inserted data required.\r\n`edgedb error: InvalidValueError: too many range table entries`\r\n\r\nTo restore normal edgedb behavior, disable access policies via `configure session set apply_access_policies := false`\r\n\r\n\r\nQB\r\n\r\n```\r\ne.select(e.StrategyNode, node => ({\r\n    tiptapId: true,\r\n    metrics: metric => ({\r\n      predictions: e.select(metric.predictingQuestion.responses, response => ({\r\n        content: true,\r\n        createdDatetime: true,\r\n        limit: 1,\r\n        order_by: {\r\n          expression: response.createdDatetime,\r\n          direction: e.DESC,\r\n          empty: EMPTY_LAST,\r\n        },\r\n        target: e.select(metric.metricTargets, target => ({\r\n          id: true,\r\n          targetValue: true,\r\n          filter: e.op(target.strategyNode, \"=\", e.select(e.StrategyNode, node => ({\r\n            filter: e.op(node.tiptapId, \"=\", node.tiptapId),\r\n          }))),\r\n        })),\r\n        tiptapId: node.tiptapId,\r\n      })),\r\n    }),\r\n  }));\r\n```\r\n\r\nGenerated EdgeQL\r\n\r\n```\r\nWITH\r\n  __scope_0_defaultStrategyNode := DETACHED default::StrategyNode\r\nSELECT __scope_0_defaultStrategyNode {\r\n  tiptapId,\r\n  metrics := (\r\n    WITH\r\n      __scope_1_defaultMetric := __scope_0_defaultStrategyNode.metrics\r\n    SELECT __scope_1_defaultMetric {\r\n      multi predictions := (\r\n        WITH\r\n          __scope_2_defaultSignal := __scope_1_defaultMetric.predictingQuestion.responses\r\n        SELECT __scope_2_defaultSignal {\r\n          content,\r\n          createdDatetime,\r\n          multi target := (\r\n            WITH\r\n              __scope_3_defaultMetricTarget := __scope_1_defaultMetric.metricTargets\r\n            SELECT __scope_3_defaultMetricTarget {\r\n              id,\r\n              targetValue\r\n            }\r\n            FILTER (__scope_3_defaultMetricTarget.strategyNode = (WITH\r\n              __scope_4_defaultStrategyNode := DETACHED default::StrategyNode\r\n            SELECT __scope_4_defaultStrategyNode {\r\n              id\r\n            }\r\n            FILTER (__scope_4_defaultStrategyNode.tiptapId = __scope_0_defaultStrategyNode.tiptapId)))\r\n          ),\r\n          single tiptapId := __scope_0_defaultStrategyNode.tiptapId\r\n        }\r\n        ORDER BY __scope_2_defaultSignal.createdDatetime DESC EMPTY LAST\r\n        LIMIT 1\r\n      )\r\n    }\r\n  )\r\n}\r\n```\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n\r\n```\r\nmodule default {\r\n    global current_user -> uuid;\r\n\r\n    type ActivitySource {\r\n        required link strategyNode -> StrategyNode;\r\n        property sourceName -> str;\r\n        property sourceUrl -> str;\r\n        property timeLastPulled -> datetime {\r\n            default := datetime_current();\r\n        }\r\n\r\n        constraint exclusive on ((.sourceUrl, .strategyNode));\r\n    }\r\n\r\n    type DashboardConfig {\r\n        required link strategyNode -> StrategyNode;\r\n        required property dashboardSource -> str;\r\n        multi link metrics -> Metric;\r\n    }\r\n\r\n    type Document extending SignalSubject {\r\n        property unpublishedVersion -> json; # May eventually be some collaborative editing supportive representation, just a serialized document for now. #TODO make required\r\n        link mostRecentPublished := (\r\n            select .<parentDocument[is DocumentVersion] order by .createdDatetime desc limit 1\r\n        );\r\n        multi link history := (\r\n            select .<parentDocument[is DocumentVersion] order by .createdDatetime desc\r\n        );\r\n        required property ontology -> array<str>;\r\n        required link author -> User;\r\n        multi link viewers -> User;\r\n        multi link editors -> User;\r\n        multi link owners -> User;\r\n\r\n        constraint exclusive on (.author);\r\n\r\n        access policy author_has_full_access\r\n            allow all\r\n            using (global current_user ?= .author.id);\r\n\r\n        access policy owner_has_full_access\r\n            allow all\r\n            using ((global current_user in .owners.id) ?? false);\r\n\r\n        access policy allow_select_or_update_for_editor\r\n            allow select, update, update read, update write\r\n            using ((global current_user in .editors.id) ?? false);\r\n\r\n        access policy allow_select_for_viewer\r\n            allow select\r\n            using ((global current_user in .viewers.id) ?? false);\r\n\r\n        access policy allow_insert\r\n            allow insert\r\n            using (true);\r\n    }\r\n\r\n    type DocumentVersion {\r\n        required link parentDocument -> Document;\r\n        required property content -> json;\r\n        required property ontology -> array<str>;\r\n        required property createdDatetime -> datetime {\r\n            default := datetime_current();\r\n            readonly := true;\r\n        }\r\n        index on ((.parentDocument, .createdDatetime));\r\n\r\n        access policy author_has_full_access\r\n            allow all\r\n            using (global current_user ?= .parentDocument.author.id);\r\n\r\n        access policy owner_has_full_access\r\n            allow all\r\n            using ((global current_user in .parentDocument.owners.id) ?? false);\r\n\r\n        access policy allow_select_or_update_for_editor\r\n            allow select, update, update read, update write\r\n            using ((global current_user in .parentDocument.editors.id) ?? false);\r\n\r\n        access policy allow_select_for_viewer\r\n            allow select\r\n            using ((global current_user in .parentDocument.viewers.id) ?? false);\r\n\r\n        access policy allow_insert\r\n            allow insert\r\n            using (true);\r\n    }\r\n\r\n    type Event extending SignalSubject {\r\n        required property eventDatetime -> datetime {\r\n            default := datetime_current();\r\n        }\r\n        required property name -> str;\r\n        property type_ -> str;\r\n        required link author -> User;\r\n        multi link strategyNodes -> StrategyNode;\r\n    }\r\n\r\n\r\n    type Metric extending SignalSubject {\r\n        property name -> str {\r\n            annotation description := \"Optional, likely to be exactly the same as the SN and someday maybe a computed property, but may have an idiosyncratic name\"\r\n        }\r\n        property type_ -> str;\r\n        multi link strategyNodes -> StrategyNode {\r\n            property target_ -> float64; # Unused. Will be used instead of the target object when link properties are better supported\r\n        }\r\n        required property sourceMetadata -> json;\r\n        multi link metricTargets := .<metric[is MetricTarget];\r\n        link generatingQuestion := .<generatedMetric[is Question];\r\n        link predictingQuestion := .<predictedMetric[is Question];\r\n    }\r\n\r\n    type MetricTarget extending SignalSubject {\r\n        property name -> str;\r\n        property targetValue -> float64;\r\n        required link author -> User;\r\n        required link strategyNode -> StrategyNode;\r\n        required link metric -> Metric;\r\n        property score -> float64;\r\n        property scoringFunction -> json;\r\n        property targetCompletionDate -> datetime;\r\n    }\r\n\r\n    abstract type Principal extending SignalSubject {\r\n        required property name -> str;\r\n        link parentTeam -> Team;\r\n    }\r\n\r\n    type Question {\r\n        required property type_ -> str;\r\n        required property prompt -> str;\r\n        link predictedMetric -> Metric;\r\n        link generatedMetric -> Metric;\r\n        multi link positions := .<question[is QuestionPosition];\r\n        multi link responses := .<question[is Signal];\r\n    }\r\n\r\n    type QuestionPosition {\r\n        required property position -> int32;\r\n        required link question -> Question;\r\n        required link survey -> Survey;\r\n    }\r\n\r\n\r\n    type Signal extending SignalSubject { # Extends SignalSubject to enable conversation-style signal\r\n        required property content -> json;\r\n        required property type_ -> str;\r\n        link subject -> SignalSubject;\r\n        link strategyNode ->StrategyNode;\r\n        link survey -> Survey;\r\n        link question -> Question;\r\n\r\n        required link author -> User; # TODO make required when we have a auth and users live\r\n        multi link recipients -> Principal; # TODO new recipients permissions model\r\n\r\n        required property createdDatetime -> datetime {\r\n            default := datetime_current();\r\n            #readonly := true;\r\n        }\r\n        property modifiedDatetime -> datetime;\r\n        constraint exclusive on ((.subject, .author, .createdDatetime, .type_))\r\n    }\r\n\r\n    abstract type SignalSubject {\r\n        multi link signals := .<subject[is Signal];\r\n    }\r\n\r\n    type StrategyNode extending SignalSubject {\r\n        link parentNode -> StrategyNode;\r\n        multi link childNodes := .<parentNode[is StrategyNode];\r\n\r\n        required link documentVersion -> DocumentVersion; # Latest available document version for this node.\r\n\r\n        required property nodeType -> str; # This may eventually reference a node type as data with ontology customization\r\n        required property title -> str;\r\n        required property tiptapId -> str {\r\n            constraint exclusive;\r\n        };\r\n        property metadata -> json;\r\n\r\n        multi link metrics := .<strategyNodes[is Metric];\r\n\r\n        multi link responsibleParties -> User;\r\n        multi link defaultSignalViewers -> Principal;\r\n        multi link subscribers -> User;\r\n        property status -> str;\r\n        link team -> Team;\r\n        access policy author_has_full_access\r\n            allow all\r\n            using (global current_user ?= .documentVersion.parentDocument.author.id);\r\n\r\n        access policy owner_has_full_access\r\n            allow all\r\n            using ((global current_user in .documentVersion.parentDocument.owners.id) ?? false);\r\n\r\n        access policy allow_select_or_update_for_editor\r\n            allow select, update, update read, update write\r\n            using ((global current_user in .documentVersion.parentDocument.editors.id) ?? false);\r\n\r\n        access policy allow_select_for_viewer\r\n            allow select\r\n            using ((global current_user in .documentVersion.parentDocument.viewers.id) ?? false);\r\n\r\n        access policy allow_insert\r\n            allow insert\r\n            using (true);\r\n\r\n        index on (.tiptapId);\r\n\r\n    }\r\n\r\n    type StrategyNodeEdit extending SignalSubject {\r\n        property fromStatus -> str;\r\n        property toStatus -> str;\r\n        property fromTitle -> str;\r\n        property toTitle -> str;\r\n        property fromType -> str;\r\n        property toType -> str;\r\n        property oldNode -> json;\r\n        property newNode -> json;\r\n        required property editedFields -> array<str>;\r\n        property reason -> str;\r\n        multi link motivatingSignal -> Signal;\r\n        required link author -> User;\r\n        required property createdDatetime -> datetime {\r\n            default := datetime_current();\r\n            #readonly := true;\r\n        }\r\n        # access policy author_has_full_access\r\n        #     allow all\r\n        #     using (global current_user ?= .documentVersion.parentDocument.author.id);\r\n\r\n        # access policy owner_has_full_access\r\n        #     allow all\r\n        #     using ((global current_user in .documentVersion.parentDocument.owners.id) ?? false);\r\n\r\n        # access policy allow_select_or_update_for_editor\r\n        #     allow select, update, update read, update write\r\n        #     using ((global current_user in .documentVersion.parentDocument.editors.id) ?? false);\r\n\r\n        # access policy allow_select_for_viewer\r\n        #     allow select\r\n        #     using ((global current_user in .documentVersion.parentDocument.viewers.id) ?? false);\r\n\r\n        # access policy allow_insert\r\n        #     allow insert\r\n        #     using (true);\r\n    }\r\n\r\n    type Survey {\r\n        required property name -> str;\r\n        required property isRecurring -> str;\r\n        property reason -> str;\r\n        multi link recipients -> User;\r\n        required multi link questions -> Question {\r\n            property position -> int64; # Unused. Will be used instead of position object when link properties are better supported\r\n        }\r\n        required property subjectTypes -> array<str>;\r\n        required property subjects -> array<str>; # TO DO - should probably be a multi link to strategy node but want to require the prop for now since we are not yet populating strategy node\r\n        required link strategyNode -> StrategyNode;\r\n        required link author -> User;\r\n    }\r\n\r\n\r\n    type Team extending Principal {\r\n        required multi link leads -> User;  # TODO should probably be a property on the link\r\n        required multi link members -> User;\r\n        multi link subTeams -> Team;\r\n        multi link subscribers -> User;\r\n    }\r\n\r\n    type User extending Principal {\r\n        required property email -> str;\r\n        required property provider -> str;\r\n        property given_name -> str;\r\n        property family_name -> str;\r\n        property picture -> str;\r\n        property email_verified -> bool;\r\n        property locale -> str;\r\n        property provider_id -> str;\r\n        multi link canView := .<viewers[is Document];\r\n        multi link canEdit := .<editors[is Document];\r\n        multi link authored := .<author[is Document];\r\n\r\n        constraint exclusive on ((.email, .provider));\r\n    }\r\n\r\n}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4564/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4564/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4530", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4530/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4530/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4530/events", "html_url": "https://github.com/edgedb/edgedb/issues/4530", "id": 1409699650, "node_id": "I_kwDOBbYNSM5UBk9C", "number": 4530, "title": "ISE when casting result of `json_set`", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-10-14T18:20:05Z", "updated_at": "2022-10-14T22:26:02Z", "closed_at": "2022-10-14T22:26:02Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nedgedb> select <tuple<str>>json_set(to_json('[\"b\"]'), \"0\", value := <json>\"a\");\r\nedgedb error: InternalServerError: type \"edgedbpub.7f1aef75-4be4-11ed-a553-a70cebd6e089_domain\" does not exist\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: type \"edgedbpub.7f1aef75-4be4-11ed-a553-a70cebd6e089_domain\" does not exist\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4530/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4530/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4508", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4508/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4508/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4508/events", "html_url": "https://github.com/edgedb/edgedb/issues/4508", "id": 1405357837, "node_id": "I_kwDOBbYNSM5TxA8N", "number": 4508, "title": "enum label already exists on migration apply", "user": {"login": "fmoor", "id": 8278635, "node_id": "MDQ6VXNlcjgyNzg2MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/8278635?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmoor", "html_url": "https://github.com/fmoor", "followers_url": "https://api.github.com/users/fmoor/followers", "following_url": "https://api.github.com/users/fmoor/following{/other_user}", "gists_url": "https://api.github.com/users/fmoor/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmoor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmoor/subscriptions", "organizations_url": "https://api.github.com/users/fmoor/orgs", "repos_url": "https://api.github.com/users/fmoor/repos", "events_url": "https://api.github.com/users/fmoor/events{/privacy}", "received_events_url": "https://api.github.com/users/fmoor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 2295768861, "node_id": "MDU6TGFiZWwyMjk1NzY4ODYx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/need%20info", "name": "need info", "color": "77e5b0", "default": false, "description": "Need more information from submitter"}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-10-11T23:43:54Z", "updated_at": "2022-10-24T17:43:33Z", "closed_at": "2022-10-24T17:43:33Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 3.0-dev.6949+6681e5b\r\n- OS Version: ubuntu 22.04\r\n\r\n```bash\r\n$ edgedb migration apply\r\n\r\nConnecting to an EdgeDB instance at localhost:10713...\r\nedgedb error: InternalServerError: enum label \"Relay\" already exists\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: enum label \"Relay\" already exists\r\n```\r\n\r\nThe schema and migration files are in [project.tar.gz](https://github.com/edgedb/edgedb/files/9760336/project.tar.gz)", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4508/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4508/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4502", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4502/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4502/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4502/events", "html_url": "https://github.com/edgedb/edgedb/issues/4502", "id": 1404233559, "node_id": "I_kwDOBbYNSM5TsudX", "number": 4502, "title": "Fail to create migration with interface pulled up", "user": {"login": "Iczp", "id": 18003280, "node_id": "MDQ6VXNlcjE4MDAzMjgw", "avatar_url": "https://avatars.githubusercontent.com/u/18003280?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Iczp", "html_url": "https://github.com/Iczp", "followers_url": "https://api.github.com/users/Iczp/followers", "following_url": "https://api.github.com/users/Iczp/following{/other_user}", "gists_url": "https://api.github.com/users/Iczp/gists{/gist_id}", "starred_url": "https://api.github.com/users/Iczp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Iczp/subscriptions", "organizations_url": "https://api.github.com/users/Iczp/orgs", "repos_url": "https://api.github.com/users/Iczp/repos", "events_url": "https://api.github.com/users/Iczp/events{/privacy}", "received_events_url": "https://api.github.com/users/Iczp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-10-11T08:30:35Z", "updated_at": "2022-10-19T23:42:21Z", "closed_at": "2022-10-19T23:42:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: EdgeDB CLI 2.0.5+da7c868\r\n- OS Version:  win11\r\n\r\n```\r\n\u8bbe\u5907\u540d\u79f0\tIczpNet\r\n\u5904\u7406\u5668\tIntel(R) Core(TM) i5-10500 CPU @ 3.10GHz   3.10 GHz\r\n\u673a\u5e26 RAM\t32.0 GB (31.8 GB \u53ef\u7528)\r\n\u8bbe\u5907 ID\t23896D1D-266D-4756-BCC5-00AD4E2BB87F\r\n\u4ea7\u54c1 ID\t00342-36059-40878-AAOEM\r\n\u7cfb\u7edf\u7c7b\u578b\t64 \u4f4d\u64cd\u4f5c\u7cfb\u7edf, \u57fa\u4e8e x64 \u7684\u5904\u7406\u5668\r\n\u7b14\u548c\u89e6\u63a7\t\u6ca1\u6709\u53ef\u7528\u4e8e\u6b64\u663e\u793a\u5668\u7684\u7b14\u6216\u89e6\u63a7\u8f93\u5165\r\n\r\n\r\n\r\n\u7248\u672c\tWindows 11 \u5bb6\u5ead\u4e2d\u6587\u7248\r\n\u7248\u672c\t22H2\r\n\u5b89\u88c5\u65e5\u671f\t\u200e2022/\u200e10/\u200e8\r\n\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\t22621.521\r\n\u4f53\u9a8c\tWindows Feature Experience Pack 1000.22634.1000.0\r\n```\r\n\r\n\r\n\r\n\r\nSteps to Reproduce:\r\n\r\n1. modify:\r\n\r\n```diff\r\n  # \u5a92\u4f53\u62bd\u8c61\uff08\u4eba\u3001\u7fa4\u3001\u516c\u4f17\u53f7\u3001\u4e34\u65f6\u7ec4\uff09 abstract\r\n- abstract type IMediaEntity extending IFullAuditedObject{\r\n+ abstract type IMediaEntity extending IFullAuditedObject, IIsActive{\r\n      required property name ->str;\r\n      property picture ->str;\r\n   }\r\n\r\n  # \u7528\u6237\r\n- type User extending IMediaEntity, IIsActive{\r\n+ type User extending IMediaEntity{\r\n      required property account ->str;    \r\n  }\r\n```\r\n\r\n2. execute:\r\n\r\n```\r\nPS F:\\Dev\\edgedb\\quickstart> edgedb migration create\r\nConnecting to an EdgeDB instance at localhost:10701...\r\nedgedb error: InternalServerError: \r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/server/compiler_pool/worker_proc.py\", line 55, in worker\r\n          res = meth(*args)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/server/compiler_pool/worker.py\", line 185, in compile_in_tx\r\n          units, cstate = COMPILER.compile_in_tx(cstate, *args, **kwargs)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 2273, in compile_in_tx\r\n          return self._compile(ctx=ctx, source=source), ctx.state\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1745, in _compile\r\n          return self._try_compile(ctx=ctx, source=original)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1812, in _try_compile\r\n          comp, capabilities = self._compile_dispatch_ql(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1678, in _compile_dispatch_ql\r\n          query = self._compile_ql_migration(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1165, in _compile_ql_migration\r\n          guided_diff = s_ddl.delta_schemas(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/schema/ddl.py\", line 326, in delta_schemas\r\n          sd.delta_objects(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/schema/delta.py\", line 221, in delta_objects\r\n          alter = y.as_alter_delta(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/schema/objects.py\", line 3081, in as_alter_delta\r\n          delta = super().as_alter_delta(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/schema/objects.py\", line 1775, in as_alter_delta\r\n          sd.delta_objects(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/schema/delta.py\", line 221, in delta_objects\r\n          alter = y.as_alter_delta(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/schema/objects.py\", line 3123, in as_alter_delta\r\n          delta.discard(not_none(delta._get_attribute_set_cmd('ancestors')))\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/common/typeutils.py\", line 36, in not_none\r\n          assert x is not None\r\n      AssertionError\r\nPS F:\\Dev\\edgedb\\quickstart> edgedb migration create\r\nConnecting to an EdgeDB instance at localhost:10701...\r\nedgedb error: InternalServerError: \r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/server/compiler_pool/worker_proc.py\", line 55, in worker\r\n          res = meth(*args)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/server/compiler_pool/worker.py\", line 185, in compile_in_tx\r\n          units, cstate = COMPILER.compile_in_tx(cstate, *args, **kwargs)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 2273, in compile_in_tx\r\n          return self._compile(ctx=ctx, source=source), ctx.state\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1745, in _compile\r\n          return self._try_compile(ctx=ctx, source=original)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1812, in _try_compile\r\n          comp, capabilities = self._compile_dispatch_ql(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1678, in _compile_dispatch_ql\r\n          query = self._compile_ql_migration(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1165, in _compile_ql_migration\r\n          guided_diff = s_ddl.delta_schemas(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/schema/ddl.py\", line 326, in delta_schemas\r\n          sd.delta_objects(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/schema/delta.py\", line 221, in delta_objects\r\n          alter = y.as_alter_delta(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/schema/objects.py\", line 3081, in as_alter_delta\r\n          delta = super().as_alter_delta(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/schema/objects.py\", line 1775, in as_alter_delta\r\n          sd.delta_objects(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/schema/delta.py\", linta.py\", line 221, in delta_objects\r\n          alter = y.as_alter_delta(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/schema/objects.py\", line 3123, in as_alter_delta\r\n          delta.discard(not_none(delta._get_attribute_set_cmd('ancestors')))\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.3/lib/python3.10/site-packages/edb/common/typeutils.py\", line 36, in not_none\r\n          assert x is not None\r\n      AssertionError\r\n```\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n\r\n```\r\nmodule default {\r\n\r\n# =============================================================================\r\n  type Person {\r\n    required property name -> str;\r\n  }\r\n\r\n  type Movie {\r\n    # property title -> str;\r\n    required property title -> str;\r\n    multi link actors -> Person;\r\n  }\r\n\r\n# =============================================================================\r\n# \u516c\u5171\u5b9e\u4f53\r\n\r\n# \u8f6f\u5220\u9664\r\nabstract type ISoftDelete{\r\n    property is_deleted -> bool\r\n}\r\n\r\n# \u662f\u5426\u6d3b\u8dc3\r\nabstract type IIsActive{\r\n    property is_active -> bool\r\n}\r\n\r\n# -------------------------------------\r\n\r\n# \u521b\u5efa\u4eba\u63a5\u53e3\r\nabstract type IHasCreationTime{\r\n    property creation_time -> datetime\r\n}\r\n\r\n# \u521b\u5efa\u4eba\r\nabstract type IMayHaveCreator{\r\n    link creator -> User\r\n}\r\n\r\n# \u521b\u5efa\u5ba1\u8ba1\r\nabstract type ICreationAuditedObject extending IHasCreationTime, IMayHaveCreator{\r\n\r\n}\r\n# -------------------------------------\r\n\r\n# \u4fee\u6539\u65f6\u95f4\uff08\u6700\u540e\u4fee\u6539\u65f6\u95f4\uff09\r\nabstract type IHasModificationTime{\r\n    property last_modification_time -> datetime\r\n}\r\n\r\n# \u4fee\u6539\u4eba(\u6700\u540e\u4fee\u6539\u4eba)\r\nabstract type IMayHaveModifier{\r\n    link last_modifier -> User\r\n}\r\n\r\n# \u4fee\u6539\u5ba1\u8ba1\r\nabstract type IModificationAuditedObject extending IHasModificationTime, IMayHaveModifier{\r\n\r\n}\r\n\r\n# -------------------------------------\r\n\r\n# \u5220\u9664\u65f6\u95f4\r\nabstract type IHasDeletionTime{\r\n    property deletion_time -> datetime\r\n}\r\n\r\n# \u5220\u9664\u4eba\r\nabstract type IMayHaveDeleter{\r\n    link deleter -> User\r\n}\r\n\r\n# \u5220\u9664\u5ba1\u8ba1\r\nabstract type IDeletionAuditedObject extending IHasDeletionTime, IMayHaveDeleter, ISoftDelete{\r\n\r\n}\r\n\r\n# \u5168\u5ba1\u8ba1\r\nabstract type IFullAuditedObject extending ICreationAuditedObject, IModificationAuditedObject, IDeletionAuditedObject{\r\n\r\n}\r\n\r\n\r\n# =============================================================================\r\n# \u5a92\u4f53\u7c7b\u578b\r\nscalar type MediaTypeEnum extending enum<Person, Room, Ofifcal, OfficalGroup>;\r\n\r\n# \u7fa4 Room\r\nscalar type RoomTypeEnum extending enum<Free>;\r\n\r\n# \u5b98\u65b9 Offical\r\nscalar type OfficalTypeEnum extending enum<Services, Subscribe>;\r\n\r\n# \u5a92\u4f53\u62bd\u8c61\uff08\u4eba\u3001\u7fa4\u3001\u516c\u4f17\u53f7\u3001\u4e34\u65f6\u7ec4\uff09 abstract\r\n  abstract type IMediaEntity extending IFullAuditedObject{\r\n     required property name ->str;\r\n     property picture ->str;\r\n  }\r\n\r\n# \u7528\u6237\r\n  type User extending IMediaEntity, IIsActive{\r\n    required property account ->str;    \r\n  }\r\n\r\n# \u7fa4\r\n  type Room extending IMediaEntity{\r\n    property type -> RoomTypeEnum;\r\n    multi link members -> RoomMember;\r\n  }\r\n\r\n# \u7fa4.\u6210\u5458\r\n  type RoomMember extending IFullAuditedObject{\r\n    link room -> Room;\r\n    link member -> User;\r\n  }\r\n\r\n# \u516c\u4f17\u53f7\r\n  type Offical extending IMediaEntity{\r\n    property type -> OfficalTypeEnum;\r\n    multi link members -> OfficalMember;\r\n    multi link groups -> OfficalGroup;\r\n  }\r\n\r\n# \u516c\u4f17\u53f7.\u6210\u5458\r\n  type OfficalMember extending IFullAuditedObject{\r\n    link offical -> Offical;\r\n    link member -> User;\r\n  }\r\n\r\n# \u516c\u4f17\u53f7.\u670d\u52a1\u53f7\u4e34\u65f6\u7ec4\r\n  type OfficalGroup extending IMediaEntity{\r\n    link offical -> Offical;\r\n    multi link members -> OfficalGroupMember;\r\n  }\r\n\r\n# \u516c\u4f17\u53f7.\u670d\u52a1\u53f7\u4e34\u65f6\u7ec4.\u6210\u5458\r\n  type OfficalGroupMember extending IFullAuditedObject{\r\n    link offical_group -> OfficalGroup;\r\n    link member -> User;\r\n  }\r\n\r\n# \u6d88\u606f\r\n  type Message extending IFullAuditedObject{\r\n    required property logId -> int16;\r\n    required property sender -> str;\r\n    required property sender_type -> MediaTypeEnum;\r\n    required property receiver -> str;\r\n    required property receiver_type -> MediaTypeEnum;\r\n\r\n    # required property senderMedia -> IMediaEntity;\r\n\r\n    required property content -> str;\r\n\r\n    # links\r\n  }\r\n\r\n# \u6d88\u606f\u5185\u5bb9\r\nabstract type IContent extending IFullAuditedObject{\r\n    # abstract messageType;\r\n    multi link messages -> Message\r\n}\r\n\r\n\r\n# \u6587\u672c\u5185\u5bb9\r\ntype TextContent extending IContent{\r\n required property text -> str;\r\n\r\n}\r\n\r\n# cmd\u5185\u5bb9\r\ntype CmdContent extending IContent{\r\n required property text -> str;\r\nrequired property cmd -> str;\r\n\r\n}\r\n\r\n# \u56fe\u7247\u5185\u5bb9\r\ntype ImageContent extending IContent{\r\n    # image url\r\n required property url -> str;\r\n required property thumb -> str;\r\n property width -> int16;\r\n property height -> int16;\r\n}\r\n\r\n# \u89c6\u9891\u5185\u5bb9\r\ntype VideoContent extending IContent{\r\n    # video url\r\n required property url -> str;\r\n \r\n  property width -> int16;\r\n  property height -> int16;\r\n  property size -> int16;\r\n\r\n  property image -> str;\r\n  property image_width -> int16;\r\n  property image_height -> int16;\r\n  property image_size -> int16;\r\n}\r\n\r\n# \u8bed\u97f3\u5185\u5bb9\r\ntype SoundContent extending IContent{\r\n    # video url\r\n  required property url -> str;\r\n  property time -> int16;\r\n}\r\n\r\n# \u6587\u4ef6\u5185\u5bb9\r\ntype FileContent extending IContent{\r\n    # video url\r\n  required property url -> str;\r\n  property time -> int16;\r\n  required property file_name -> str;\r\n  property content_length -> str;\r\n  property content_type -> str;\r\n  property suffix -> str;\r\n}\r\n};\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4502/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4502/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4493", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4493/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4493/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4493/events", "html_url": "https://github.com/edgedb/edgedb/issues/4493", "id": 1401749006, "node_id": "I_kwDOBbYNSM5TjP4O", "number": 4493, "title": "ArrayExprAlias, TupleExprAlias, RangeExprAlias are missing from the public schema", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1590066979, "node_id": "MDU6TGFiZWwxNTkwMDY2OTc5", "url": "https://api.github.com/repos/edgedb/edgedb/labels/easy", "name": "easy", "color": "48ce9f", "default": false, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}, {"id": 4505522149, "node_id": "LA_kwDOBbYNSM8AAAABDIzP5Q", "url": "https://api.github.com/repos/edgedb/edgedb/labels/onboarding", "name": "onboarding", "color": "bfdadc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-10-07T23:43:37Z", "updated_at": "2022-10-18T08:18:53Z", "closed_at": "2022-10-18T08:18:53Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This would be pretty unimportant, except that it means that `__type__` on those elements is missing (filter out by access policy). This is bad, since `__type__` is `required` -- we actually have a special-case that opts `__type__` out from access policy induced `assert_exists` insertion, and so it returns invalid data instead of crashing, here.\r\n\r\nI think it should just be a matter of adding the types to `schema.edgeql`. The relevant schema type definitions are in `schema/types.py`\r\n\r\n```\r\nedgedb> CREATE ALIAS tuple_alias := ('foo', 10);\r\nOK: CREATE ALIAS\r\nedgedb> select schema::Tuple { name, __type__ } filter .name like 'default::%';\r\n{Object {name: 'default::tuple_alias', __type__: {}}}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4493/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4493/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4491", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4491/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4491/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4491/events", "html_url": "https://github.com/edgedb/edgedb/issues/4491", "id": 1401635528, "node_id": "I_kwDOBbYNSM5Ti0LI", "number": 4491, "title": "Objects in `cfg` and `sys` are in a somewhat busted state", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2022-10-07T20:25:56Z", "updated_at": "2023-03-07T20:28:15Z", "closed_at": "2023-03-07T20:28:15Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Most of types in `cfg` and `sys` are represented in the database as views that live in the `edgedbss` schema, and which are created in `metaschema.py`.\r\n\r\nHowever the knowledge that they should live in `edgedbss` is somewhat inconsistent.\r\nDuplicates of each of those types exist in `edgedbstd`, and those are used by `BaseObject`s views.\r\nSome of the abstract types in `cfg`/`sys` have views created explicitly in `metaschema`, but some don't.\r\n\r\n`cfg` and `sys` special cased in relctx to point at `edgedbss`.\r\n\r\nThis should all get rationalized, so that one version of each of these tables exists and is routed to in one place (pgsql/common.py, ideally).\r\n\r\nWhat is the reason why these views are in `edgedbss` instead of just `edgedbstd`? Is this important?\r\n\r\nHere are some of the bugs that result from this state:\r\n```\r\nedgedb> select cfg::ConfigObject;\r\nedgedb error: InternalServerError: relation \"edgedbss.734bd415-4670-11ed-88a5-6d9ebab1a5f7_t\" does not exist\r\n```\r\n\r\n```\r\nedgedb> select count(BaseObject[is cfg::AbstractConfig]);\r\n[0]\r\nedgedb> select count(cfg::AbstractConfig);\r\n[3]\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4491/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4491/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4483", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4483/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4483/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4483/events", "html_url": "https://github.com/edgedb/edgedb/issues/4483", "id": 1398527702, "node_id": "I_kwDOBbYNSM5TW9bW", "number": 4483, "title": "Hung schema state involving alias", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-10-06T00:08:51Z", "updated_at": "2022-10-13T00:12:16Z", "closed_at": "2022-10-13T00:12:16Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "If we migrate to\r\n```\r\nmodule default {\r\n\r\n  # XXX: If this is declared *after* User... it works??\r\n  alias UserAlias := User;\r\n\r\n  type User {\r\n    multi link ml -> Target {\r\n      property lp -> str;\r\n    };\r\n  }\r\n\r\n  type Target;\r\n\r\n}\r\n```\r\nAnd then try running another migration, it will fail.\r\nThe target schema it computes is missing `@lp` on the `UserAlias`.\r\nSomehow, sinking the UserAlias after User gets it unstuck?", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4483/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4483/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4481", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4481/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4481/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4481/events", "html_url": "https://github.com/edgedb/edgedb/issues/4481", "id": 1398238603, "node_id": "I_kwDOBbYNSM5TV22L", "number": 4481, "title": "InternalServerError: Can't compile ref to visible binding ns~2@ns~6@@(__derived__::g~1)", "user": {"login": "halindraprakoso", "id": 89775119, "node_id": "MDQ6VXNlcjg5Nzc1MTE5", "avatar_url": "https://avatars.githubusercontent.com/u/89775119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/halindraprakoso", "html_url": "https://github.com/halindraprakoso", "followers_url": "https://api.github.com/users/halindraprakoso/followers", "following_url": "https://api.github.com/users/halindraprakoso/following{/other_user}", "gists_url": "https://api.github.com/users/halindraprakoso/gists{/gist_id}", "starred_url": "https://api.github.com/users/halindraprakoso/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/halindraprakoso/subscriptions", "organizations_url": "https://api.github.com/users/halindraprakoso/orgs", "repos_url": "https://api.github.com/users/halindraprakoso/repos", "events_url": "https://api.github.com/users/halindraprakoso/events{/privacy}", "received_events_url": "https://api.github.com/users/halindraprakoso/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-10-05T18:46:37Z", "updated_at": "2022-10-19T05:06:19Z", "closed_at": "2022-10-19T05:06:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Code**\r\nThe code causing the error. Specifically on the second sum when doing select\r\n\r\n```typescript\r\nconst grouped = e.group(e.Bill, (b) => ({\r\n    by: {\r\n      category: b.PaymentType.PaymentCategory.name,\r\n    },\r\n  }));\r\n\r\n  const select = await e\r\n    .select(grouped, (g) => ({\r\n      sum: e.op(\r\n        e.sum(g.elements.amount),\r\n        \"-\",\r\n        e.sum(\r\n          e.select(g.elements[\"<Bill[is AssignedPayment]\"], (ap) => ({\r\n            filter: e.op(\"exists\", ap.Checker),\r\n          })).amount\r\n        )\r\n      ),\r\n    })).run(client)\r\n```\r\n\r\n**Schema**\r\n\r\nYour application schema. \r\n\r\n```\r\nmodule default {\r\n\r\n   type Bill {\r\n        required property updated_at -> datetime {default := std::datetime_current()}\r\n        required property amount -> int64;\r\n        required link PaymentType -> PaymentType;\r\n    }\r\n\r\n type AssignedPayment {\r\n        required property created_at -> datetime {default := std::datetime_current()}\r\n        required property amount -> int64;\r\n        required link Bill -> Bill;\r\n        link Checker -> User;\r\n    }\r\n\r\n}\r\n```\r\n\r\n**Generated EdgeQL**\r\n\r\n```js\r\nWITH\r\n  __scope_0_stdFreeObject := (\r\n    WITH\r\n      __scope_2_defaultBill := DETACHED default::Bill,\r\n      __scope_2_defaultBill_groups := (\r\n        GROUP __scope_2_defaultBill\r\n        USING\r\n          category := __scope_2_defaultBill.PaymentType.PaymentCategory.name\r\n        BY category\r\n    )\r\n    SELECT __scope_2_defaultBill_groups {\r\n      key: {category},\r\n      grouping,\r\n      elements: {\r\n        id\r\n      }\r\n    }\r\n  )\r\nSELECT __scope_0_stdFreeObject {\r\n  single sum := (\r\n    std::sum(__scope_0_stdFreeObject.elements.amount) - std::sum((WITH\r\n      __scope_1_defaultAssignedPayment := __scope_0_stdFreeObject.elements.<Bill[is AssignedPayment]\r\n    SELECT __scope_1_defaultAssignedPayment {\r\n      id\r\n    }\r\n    FILTER (exists __scope_1_defaultAssignedPayment.Checker)).amount)\r\n  )\r\n}\r\n```\r\n\r\n**Error or desired behavior**\r\n\r\n```\r\nInternalServerError: Can't compile ref to visible binding ns~1@ns~5@@(__derived__::g~1)\r\n    at RawConnection._parseErrorMessage (/Users/halindra/Documents/Projects/myProject/node_modules/.pnpm/edgedb@0.22.8/node_modules/edgedb/dist/baseConn.js:317:21)\r\n    at RawConnection._executeFlow (/Users/halindra/Documents/Projects/myProject/node_modules/.pnpm/edgedb@0.22.8/node_modules/edgedb/dist/baseConn.js:925:34)\r\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\r\n    at RawConnection.fetch (/Users/halindra/Documents/Projects/myProject/node_modules/.pnpm/edgedb@0.22.8/node_modules/edgedb/dist/baseConn.js:976:17)\r\n    at ClientConnectionHolder.retryingFetch (/Users/halindra/Documents/Projects/myProject/node_modules/.pnpm/edgedb@0.22.8/node_modules/edgedb/dist/client.js:183:26)\r\n    at Client.query (/Users/halindra/Documents/Projects/myProject/node_modules/.pnpm/edgedb@0.22.8/node_modules/edgedb/dist/client.js:485:20)\r\n    at loader11 (/Users/halindra/Documents/Projects/myProject/app/services/academicYearId.server.ts:22:11)\r\n    at Object.callRouteLoader (/Users/halindra/Documents/Projects/myProject/node_modules/.pnpm/@remix-run+server-runtime@1.7.2_biqbaboplfbrettd7655fr4n2y/node_modules/@remix-run/server-runtime/dist/data.js:77:14)\r\n    at handleResourceRequest (/Users/halindra/Documents/Projects/myProject/node_modules/.pnpm/@remix-run+server-runtime@1.7.2_biqbaboplfbrettd7655fr4n2y/node_modules/@remix-run/server-runtime/dist/server.js:448:14)\r\n    at requestHandler (/Users/halindra/Documents/Projects/myProject/node_modules/.pnpm/@remix-run+server-runtime@1.7.2_biqbaboplfbrettd7655fr4n2y/node_modules/@remix-run/server-runtime/dist/server.js:42:18) {\r\n  source: undefined\r\n}\r\n```\r\n\r\n**Versions (please complete the following information):**\r\n - OS: macOS Monterey\r\n - EdgeDB version: 2.1\r\n - `edgedb-js` version: `0.22.8`\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4481/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4481/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4391", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4391/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4391/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4391/events", "html_url": "https://github.com/edgedb/edgedb/issues/4391", "id": 1379725643, "node_id": "I_kwDOBbYNSM5SPPFL", "number": 4391, "title": "Slicing arrays of tuples doesn't work", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}, {"id": 4505522149, "node_id": "LA_kwDOBbYNSM8AAAABDIzP5Q", "url": "https://api.github.com/repos/edgedb/edgedb/labels/onboarding", "name": "onboarding", "color": "bfdadc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-09-20T16:59:36Z", "updated_at": "2022-09-23T19:35:33Z", "closed_at": "2022-09-23T19:35:33Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nselect [(1,'foo'), (2,'bar'), (3,'baz')][1:];\r\n```\r\ngives\r\n```\r\nedgedb error: InternalServerError: return type record[] is not supported for SQL functions\r\n```\r\n\r\nWe will need to essentially inline the array slicing code, at least for tuple types.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4391/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4391/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4388", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4388/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4388/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4388/events", "html_url": "https://github.com/edgedb/edgedb/issues/4388", "id": 1378656353, "node_id": "I_kwDOBbYNSM5SLKBh", "number": 4388, "title": "links off of global variables don't get semijoined", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-09-20T00:04:25Z", "updated_at": "2022-09-20T22:15:48Z", "closed_at": "2022-09-20T22:15:48Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nglobal_semi> create type X;\r\nOK: CREATE TYPE\r\nglobal_semi> create type Y { create link x -> X };\r\ninsert OK: CREATE TYPE\r\nglobal_semi> insert X;\r\n[{\"id\": \"2008da90-3877-11ed-9bb0-a773f2cf7623\"}]\r\nglobal_semi> insert Y { x := assert_single(X) };\r\n[{\"id\": \"24a14e52-3877-11ed-9bb0-fb0d250ace11\"}]\r\nglobal_semi> insert Y { x := assert_single(X) };\r\n[{\"id\": \"24a14e53-3877-11ed-9bb0-6fdc29f2a593\"}]\r\nglobal_semi> select Y.x;\r\n[{\"id\": \"2008da90-3877-11ed-9bb0-a773f2cf7623\"}]\r\nglobal_semi> create global Yg := Y;\r\nOK: CREATE GLOBAL\r\nglobal_semi> select (global Yg).x;\r\n[\r\n  {\"id\": \"2008da90-3877-11ed-9bb0-a773f2cf7623\"},\r\n  {\"id\": \"2008da90-3877-11ed-9bb0-a773f2cf7623\"}\r\n]\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4388/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4388/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4384", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4384/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4384/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4384/events", "html_url": "https://github.com/edgedb/edgedb/issues/4384", "id": 1378346140, "node_id": "I_kwDOBbYNSM5SJ-Sc", "number": 4384, "title": "Access policies incorrectly calculated when in globals", "user": {"login": "Sikarii", "id": 37634135, "node_id": "MDQ6VXNlcjM3NjM0MTM1", "avatar_url": "https://avatars.githubusercontent.com/u/37634135?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Sikarii", "html_url": "https://github.com/Sikarii", "followers_url": "https://api.github.com/users/Sikarii/followers", "following_url": "https://api.github.com/users/Sikarii/following{/other_user}", "gists_url": "https://api.github.com/users/Sikarii/gists{/gist_id}", "starred_url": "https://api.github.com/users/Sikarii/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Sikarii/subscriptions", "organizations_url": "https://api.github.com/users/Sikarii/orgs", "repos_url": "https://api.github.com/users/Sikarii/repos", "events_url": "https://api.github.com/users/Sikarii/events{/privacy}", "received_events_url": "https://api.github.com/users/Sikarii/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-09-19T18:18:52Z", "updated_at": "2022-09-22T23:50:39Z", "closed_at": "2022-09-22T23:50:39Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "- EdgeDB Version: 2.2@sha256:cf3499f2dacf740fee19d0a6758a5f725449da69cf9f3ba96d4e37258d20d503 (Docker)\r\n- OS Version: Windows 10 21H2 (build 19044.2006)\r\n\r\nInsert with `unless conflict`, has this error:\r\n`InternalServerError: missing FROM-clause entry for table \"Session~4\"`\r\n\r\nWhen no `unless conflict` exists, we get:\r\n`CardinalityViolationError: required link 'user' of object type 'default::Session' is hidden by access policy`.\r\n\r\nSteps to Reproduce:\r\n1. Apply initial migration (schema below)\r\n2. Attempt to run below queries with globals set to:\r\n    - `sessionToken: \"\"`\r\n    - `bypassAccessPolicies: true`\r\n3. Observe the queries erroring out, the generated SQL is below\r\n\r\n<details>\r\n  <summary>Queries (REPL)</summary>\r\n\r\n```\r\nedgedb> set global sessionToken := \"\";\r\nOK: SET GLOBAL\r\n\r\nedgedb> set global bypassAccessPolicies := true;\r\nOK: SET GLOBAL\r\n\r\nedgedb> insert User {\r\n.......   username := \"admin\"\r\n....... }\r\n....... unless conflict;\r\nedgedb error: InternalServerError: missing FROM-clause entry for table \"Session~4\"\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: missing FROM-clause entry for table \"Session~4\"\r\n\r\nedgedb> insert User {\r\n.......   username := \"admin\"\r\n....... };\r\nedgedb error: CardinalityViolationError: required link 'user' of object type 'default::Session' is hidden by access policy\r\n```\r\n</details>\r\n\r\n<details>\r\n  <summary>Generated SQL (unless conflict)</summary>\r\n\r\n```\r\n WITH\r\n      \"t~1\" AS NOT MATERIALIZED\r\n          (\r\n          (SELECT/*<pg.SelectStmt at 0x7fa17dbdfaf0>*/\r\n                  \"expr-14~2\".\"User_value~1\" AS \"expr~14_value~1\",\r\n                  \"expr-14~2\".\"username_value~7\" AS \"username_value~8\"\r\n              FROM\r\n                  LATERAL\r\n                  (SELECT/*<pg.SelectStmt at 0x7fa17dbdfd30>*/\r\n                          \"User~4\".id AS \"User_value~1\",\r\n                          \"User~4\".\"bad0197c-3848-11ed-a23b-d11e74d4ec60\" AS \"username_value~7\"\r\n                      FROM\r\n                          edgedbpub.\"bacc476b-3848-11ed-ae1d-2ddecba3d399_t\" AS \"User~4\"   \r\n                          CROSS JOIN LATERAL\r\n                          (SELECT/*<pg.SelectStmt at 0x7fa17dc64640>*/\r\n                                  (\"expr-11~2\".\"expr~11_value~1\" OR\r\n                                    \"expr-12~2\".\"expr~12_value~1\") AS \"expr~13_value~1\"    \r\n                              FROM\r\n                                  LATERAL\r\n                                  (SELECT/*<pg.SelectStmt at 0x7fa17dc64e80>*/\r\n                                          COALESCE(\"expr-1~2\".\"expr~1_value~1\", \"expr-3~2\".\"expr~2_value~1\") AS \"expr~4_value~1\"\r\n                                      FROM\r\n                                          LATERAL\r\n                                          (SELECT/*<pg.SelectStmt at 0x7fa17dc653c0>*/     \r\n                                                  ($2)::bool AS \"expr~1_value~1\"\r\n                                          ) AS \"expr-1~2\"\r\n                                          CROSS JOIN LATERAL\r\n                                          (SELECT/*<pg.SelectStmt at 0x7fa17dc65210>*/     \r\n                                                  (false)::bool AS \"expr~2_value~1\"        \r\n                                          ) AS \"expr-3~2\"\r\n                                  ) AS \"expr-4~2\"\r\n                                  CROSS JOIN LATERAL\r\n                                  (SELECT/*<pg.SelectStmt at 0x7fa17dc65e10>*/\r\n                                          (\"str_username~2\".\"username_value~6\" IS NOT DISTINCT FROM ('admin')::text) AS \"expr~10_value~1\"\r\n                                      FROM\r\n                                          LATERAL\r\n                                          (SELECT/*<pg.SelectStmt at 0x7fa17dc65b70>*/     \r\n                                                  \"q~8\".\"username_value~5\" AS \"username_value~6\"\r\n                                              FROM\r\n                                                  LATERAL\r\n                                                  (SELECT/*<pg.SelectStmt at 0x7fa17dc66170>*/\r\n                                                          (\"m~3\" = first_value(\"m~3\") OVER \r\n()) AS \"m~3\",\r\n                                                          \"q~7\".\"username_value~3\" AS \"username_value~5\"\r\n                                                      FROM\r\n                                                          LATERAL\r\n                                                          (\r\n                                                          (SELECT/*<pg.SelectStmt at 0x7fa17dc663e0>*/\r\n                                                                  1 AS \"m~3\",\r\n                                                                  \"q~6\".\"username_value~2\" \r\nAS \"username_value~3\"\r\n                                                              FROM\r\n                                                                  LATERAL\r\n                                                                  (SELECT/*<pg.SelectStmt at 0x7fa17dc66710>*/\r\n                                                                          \"q~5\".\"username_value~1\" AS \"username_value~2\"\r\n                                                                      FROM\r\n                                                                          LATERAL\r\n                                                                          (SELECT/*<pg.SelectStmt at 0x7fa17dc65c00>*/\r\n                                                                                  \"User~5\".\"bad0197c-3848-11ed-a23b-d11e74d4ec60\" AS \"username_value~1\"\r\n                                                                              FROM\r\n                                                                                  LATERAL  \r\n                                                                                  (SELECT/*<pg.SelectStmt at 0x7fa17dc67880>*/\r\n                                                                                          \"Session~4\".\"user_identity~6\" AS \"user_identity~7\"\r\n                                                                                  ) AS \"q~4\"\r\n                                                                                  INNER JOIN edgedbpub.\"bacc476b-3848-11ed-ae1d-2ddecba3d399_t\" AS \"User~5\"\r\n                                                                                      ON (\"q~4\".\"user_identity~7\" = \"User~5\".id)\r\n                                                                          ) AS \"q~5\"       \r\n                                                                  ) AS \"q~6\"\r\n                                                          ) UNION ALL\r\n                                                          (SELECT/*<pg.SelectStmt at 0x7fa17dc66530>*/\r\n                                                                  2 AS \"m~3\",\r\n                                                                  \"v~1\".\"bad0197c-3848-11ed-a23b-d11e74d4ec60~1\" AS \"username_value~4\"\r\n                                                              FROM\r\n                                                                  (SELECT (NULL)::text AS \"bad0197c-3848-11ed-a23b-d11e74d4ec60~1\") AS \"v~1\"\r\n                                                          )\r\n                                                          ) AS \"q~7\"\r\n                                                  ) AS \"q~8\"\r\n                                              WHERE\r\n                                                  \"q~8\".\"m~3\"\r\n                                          ) AS \"str_username~2\"\r\n                                  ) AS \"expr-10~2\"\r\n                                  CROSS JOIN LATERAL\r\n                                  (SELECT/*<pg.SelectStmt at 0x7fa17dc64760>*/\r\n                                          (\"expr-4~2\".\"expr~4_value~1\" OR\r\n                                            \"expr-10~2\".\"expr~10_value~1\") AS \"expr~11_value~1\"\r\n                                  ) AS \"expr-11~2\"\r\n                                  CROSS JOIN (SELECT (NULL)::uuid AS \"v~4\") AS \"v~3\"       \r\n                                  CROSS JOIN LATERAL\r\n                                  (SELECT/*<pg.SelectStmt at 0x7fa17dc64b80>*/\r\n                                          (\"User~4\".id IS NOT DISTINCT FROM \"v~3\".\"v~4\") AS \"expr~12_value~1\"\r\n                                  ) AS \"expr-12~2\"\r\n                          ) AS \"expr-13~2\"\r\n                      WHERE\r\n                          \"expr-13~2\".\"expr~13_value~1\"\r\n                  ) AS \"expr-14~2\"\r\n          )),\r\n      \"else~1\" AS\r\n          (\r\n          (SELECT/*<pg.SelectStmt at 0x7fa17dbde0b0>*/\r\n              FROM\r\n                  LATERAL\r\n                  (SELECT/*<pg.SelectStmt at 0x7fa17dbde3e0>*/\r\n                          \"expr-24~2\".\"expr~23_value~1\" AS \"expr~24_value~1\"\r\n                      FROM\r\n                          (SELECT/*<pg.SelectStmt at 0x7fa17dbdfb80>*/\r\n                                  \"t~2\".\"expr~14_value~1\" AS \"expr~14_value~2\",\r\n                                  \"t~2\".\"username_value~8\" AS \"username_value~9\"\r\n                              FROM\r\n                                  \"t~1\" AS \"t~2\"\r\n                          ) AS \"q~9\"\r\n                          CROSS JOIN LATERAL\r\n                          (SELECT/*<pg.SelectStmt at 0x7fa17dbdeb30>*/\r\n                                  \"expr-23~2\".\"User_value~2\" AS \"expr~23_value~1\"\r\n                              FROM\r\n                                  LATERAL\r\n                                  (SELECT/*<pg.SelectStmt at 0x7fa17dbdf2e0>*/\r\n                                          \"q~9\".\"expr~14_value~2\" AS \"User_value~2\"        \r\n                                      FROM\r\n                                          LATERAL\r\n                                          (SELECT/*<pg.SelectStmt at 0x7fa180ea7a60>*/     \r\n                                                  (\"expr-21~2\".\"expr~15_value~2\" = \"q~9\".\"username_value~9\") AS \"expr~22_value~1\"\r\n                                              FROM\r\n                                                  LATERAL\r\n                                                  (SELECT/*<pg.SelectStmt at 0x7fa17dc66fe0>*/\r\n                                                          \"expr-15~2\".\"expr~15_value~1\" AS \r\n\"expr~15_value~2\"\r\n                                                      FROM\r\n                                                          LATERAL\r\n                                                          (SELECT/*<pg.SelectStmt at 0x7fa17dc67100>*/\r\n                                                                  ($1)::text AS \"expr~15_value~1\"\r\n                                                          ) AS \"expr-15~2\"\r\n                                                  ) AS \"expr-21~2\"\r\n                                          ) AS \"expr-22~2\"\r\n                                      WHERE\r\n                                          \"expr-22~2\".\"expr~22_value~1\"\r\n                                  ) AS \"expr-23~2\"\r\n                          ) AS \"expr-24~2\"\r\n                  ) AS \"expr-25~2\"\r\n          )),\r\n      \"non_conflict~1\" AS\r\n          (\r\n          (SELECT/*<pg.SelectStmt at 0x7fa17dbde8f0>*/\r\n                  \"q~10\".\"dummy~1_identity~1\" AS \"dummy~1_identity~2\"\r\n              FROM\r\n                  LATERAL\r\n                  (SELECT/*<pg.SelectStmt at 0x7fa17dbde410>*/\r\n                          edgedbext.uuid_generate_v4() AS \"dummy~1_identity~1\"\r\n                  ) AS \"q~10\"\r\n              WHERE\r\n                  NOT EXISTS (\r\n                      (SELECT/*<pg.SelectStmt at 0x7fa17dbde6e0>*/\r\n                          FROM \r\n                              \"else~1\" AS \"else~2\"\r\n                      )\r\n                  )\r\n          )),\r\n      \"ins_contents~1\" AS\r\n          (\r\n          (SELECT/*<pg.SelectStmt at 0x7fa17dbddde0>*/\r\n                  ('bacc476b-3848-11ed-ae1d-2ddecba3d399')::uuid AS __type__,\r\n                  \"str_username~5\".\"expr~15_value~4\" AS \"bad0197c-3848-11ed-a23b-d11e74d4ec60\",\r\n                  \"uuid_id~3\".\"expr~19_value~1\" AS id\r\n              FROM\r\n                  \"non_conflict~1\" AS \"non_conflict~2\"\r\n                  CROSS JOIN LATERAL\r\n                  (SELECT/*<pg.SelectStmt at 0x7fa17dbdf340>*/\r\n                          \"expr-15~4\".\"expr~15_value~3\" AS \"expr~15_value~4\"\r\n                      FROM\r\n                          LATERAL\r\n                          (SELECT/*<pg.SelectStmt at 0x7fa17dbdfdf0>*/\r\n                                  ($1)::text AS \"expr~15_value~3\"\r\n                          ) AS \"expr-15~4\"\r\n                  ) AS \"str_username~5\"\r\n                  CROSS JOIN LATERAL\r\n                  (SELECT/*<pg.SelectStmt at 0x7fa17dbdf010>*/\r\n                          \"expr-19~2\".\"expr~18_value~1\" AS \"expr~19_value~1\"\r\n                      FROM\r\n                          LATERAL\r\n                          (SELECT/*<pg.SelectStmt at 0x7fa17dc66dd0>*/\r\n                                  \"expr-18~2\".\"expr~17_value~3\" AS \"expr~18_value~1\"       \r\n                              FROM\r\n                                  LATERAL\r\n                                  (SELECT/*<pg.SelectStmt at 0x7fa17dc644c0>*/\r\n                                          \"expr-17~2\".\"expr~17_value~2\" AS \"expr~17_value~3\"\r\n                                      FROM\r\n                                          LATERAL\r\n                                          (SELECT/*<pg.SelectStmt at 0x7fa17d7dd360>*/     \r\n                                                  \"q~11\".\"expr~17_value~1\" AS \"expr~17_value~2\"\r\n                                              FROM\r\n                                                  LATERAL\r\n                                                  (SELECT/*<pg.SelectStmt at 0x7fa17d7dc550>*/\r\n                                                          edgedbext.uuid_generate_v1mc() AS \"expr~17_value~1\"\r\n                                                      WHERE\r\n                                                          (\"non_conflict~2\".\"dummy~1_identity~2\" IS NOT NULL)\r\n                                                  ) AS \"q~11\"\r\n                                          ) AS \"expr-17~2\"\r\n                                  ) AS \"expr-18~2\"\r\n                          ) AS \"expr-19~2\"\r\n                  ) AS \"uuid_id~3\"\r\n          )),\r\n      \"policy~1\" AS MATERIALIZED\r\n          (\r\n          (SELECT/*<pg.SelectStmt at 0x7fa17dc676a0>*/\r\n                  edgedb.raise_on_null(nullif(EXISTS (\r\n                      (SELECT/*<pg.SelectStmt at 0x7fa17dc66b30>*/\r\n                          FROM\r\n                              LATERAL\r\n                              (SELECT/*<pg.SelectStmt at 0x7fa17dc64670>*/\r\n                                      (\"expr-29~2\".\"expr~29_value~2\" OR\r\n                                  FROM\r\n                                      LATERAL\r\n                                      (SELECT/*<pg.SelectStmt at 0x7fa17dc646a0>*/\r\n                                          FROM\r\n                                              LATERAL\r\n                                              (SELECT/*<pg.SelectStmt at 0x7fa17d7dc880>*/ \r\n                                                      (\"m~5\" = first_value(\"m~5\") OVER ()) \r\nAS \"m~5\",\r\n                                                      \"q~12\".\"expr~26_value~2\" AS \"expr~29_value~1\"\r\n                                                  FROM\r\n                                                      LATERAL\r\n                                                      (\r\n                                                      (SELECT/*<pg.SelectStmt at 0x7fa17d7dc4f0>*/\r\n                                                              1 AS \"m~5\",\r\n                                                              \"expr-26~2\".\"expr~26_value~1\" AS \"expr~26_value~2\"\r\n                                                          FROM\r\n                                                              LATERAL\r\n                                                              (SELECT/*<pg.SelectStmt at 0x7fa17d7ddbd0>*/\r\n                                                                      ($2)::bool AS \"expr~26_value~1\"\r\n                                                              ) AS \"expr-26~2\"\r\n                                                          WHERE\r\n                                                              (\"expr-26~2\".\"expr~26_value~1\" IS NOT NULL)\r\n                                                      ) UNION ALL\r\n                                                      (SELECT/*<pg.SelectStmt at 0x7fa17d7dc670>*/\r\n                                                              2 AS \"m~5\",\r\n                                                              \"expr-28~2\".\"expr~27_value~1\" AS \"expr~28_value~1\"\r\n                                                          FROM\r\n                                                              LATERAL\r\n                                                              (SELECT/*<pg.SelectStmt at 0x7fa17d7de290>*/\r\n                                                                      (false)::bool AS \"expr~27_value~1\"\r\n                                                              ) AS \"expr-28~2\"\r\n                                                      )\r\n                                                      ) AS \"q~12\"\r\n                                              ) AS \"q~13\"\r\n                                          WHERE\r\n                                              \"q~13\".\"m~5\"\r\n                                      ) AS \"expr-29~2\"\r\n                                      CROSS JOIN LATERAL\r\n                                      (SELECT/*<pg.SelectStmt at 0x7fa17d7de800>*/\r\n                                              (\"str_username~7\".\"username_value~15\" IS NOT \r\nDISTINCT FROM ('admin')::text) AS \"expr~37_value~1\"\r\n                                          FROM\r\n                                              LATERAL\r\n                                              (SELECT/*<pg.SelectStmt at 0x7fa17d7df160>*/ \r\n                                                      \"q~25\".\"username_value~14\" AS \"username_value~15\"\r\n                                                  FROM\r\n                                                      LATERAL\r\n                                                      (SELECT/*<pg.SelectStmt at 0x7fa17d7df460>*/\r\n                                                              (\"m~6\" = first_value(\"m~6\") OVER ()) AS \"m~6\",\r\n                                                              \"q~24\".\"username_value~12\" AS \"username_value~14\"\r\n                                                          FROM\r\n                                                              LATERAL\r\n                                                              (\r\n                                                              (SELECT/*<pg.SelectStmt at 0x7fa17d7df6a0>*/\r\n                                                                      1 AS \"m~6\",\r\n                                                                      \"q~23\".\"username_value~11\" AS \"username_value~12\"\r\n                                                                  FROM\r\n                                                                      LATERAL\r\n                                                                      (SELECT/*<pg.SelectStmt at 0x7fa17d7df850>*/\r\n                                                                              \"q~22\".\"username_value~10\" AS \"username_value~11\"\r\n                                                                          FROM\r\n                                                                              LATERAL      \r\n                                                                              (SELECT/*<pg.SelectStmt at 0x7fa17d7df1f0>*/\r\n                                                                                      \"User~7\".\"bad0197c-3848-11ed-a23b-d11e74d4ec60\" AS \"username_value~10\"\r\n                                                                                  FROM     \r\n                                                                                      LATERAL\r\n                                                                                      (SELECT/*<pg.SelectStmt at 0x7fa17d7dfc70>*/\r\n\r\n   \"expr-34~2\".\"expr~34_value~1\" AS \"expr~34_value~2\"\r\n                                                                                          FROM\r\n\r\n   LATERAL\r\n\r\n   (SELECT/*<pg.SelectStmt at 0x7fa17d7dff70>*/\r\n\r\n           \"q~16\".\"user_identity~12\" AS \"user_identity~13\"\r\n\r\n       FROM\r\n\r\n           LATERAL\r\n\r\n           (SELECT/*<pg.SelectStmt at 0x7fa17d87c250>*/\r\n\r\n                   (\"m~7\" = first_value(\"m~7\") OVER ()) AS \"m~7\",\r\n\r\n                   \"q~15\".\"user_identity~10\" AS \"user_identity~12\"\r\n\r\n               FROM\r\n\r\n                   LATERAL\r\n\r\n                   (\r\n\r\n                   (SELECT/*<pg.SelectStmt at 0x7fa17d87c610>*/\r\n\r\n                           1 AS \"m~7\",\r\n\r\n                           \"q~14\".\"user_identity~9\" AS \"user_identity~10\"\r\n\r\n                       FROM\r\n\r\n                           LATERAL\r\n\r\n                           (SELECT/*<pg.SelectStmt at 0x7fa17d87c760>*/\r\n\r\n                                   \"expr-7~4\".\"Session_value~2\" AS \"expr~7_value~2\",\r\n\r\n                                   \"expr-7~4\".\"user_identity~8\" AS \"user_identity~9\"\r\n\r\n                               FROM\r\n\r\n                                   LATERAL\r\n\r\n                                   (SELECT/*<pg.SelectStmt at 0x7fa17d87d0f0>*/\r\n\r\n                                           \"Session~7\".id AS \"Session_value~2\",\r\n\r\n                                           \"Session~7\".\"bad368e2-3848-11ed-b2b1-7351c44b074f\" AS \"user_identity~8\"\r\n\r\n                                       FROM\r\n\r\n                                           edgedbpub.\"bad136d5-3848-11ed-ba93-2596605b000b_t\" AS \"Session~7\"\r\n\r\n                                           CROSS JOIN LATERAL\r\n\r\n                                           (SELECT/*<pg.SelectStmt at 0x7fa17d87dc60>*/\r\n\r\n                                                   (\"Session~7\".\"bad34463-3848-11ed-adb3-edd33967dc15\" IS NOT DISTINCT FROM \"expr-5~4\".\"expr~5_value~2\") AS \"expr~6_value~2\"\r\n\r\n                                               FROM\r\n\r\n                                                   LATERAL\r\n\r\n                                                   (SELECT/*<pg.SelectStmt at 0x7fa17d87e620>*/\r\n\r\n                                                           ($3)::text AS \"expr~5_value~2\"\r\n\r\n                                                   ) AS \"expr-5~4\"\r\n\r\n                                           ) AS \"expr-6~4\"\r\n\r\n                                       WHERE\r\n\r\n                                           \"expr-6~4\".\"expr~6_value~2\"\r\n\r\n                                   ) AS \"expr-7~4\"\r\n\r\n                               LIMIT\r\n\r\n                               (SELECT/*<pg.SelectStmt at 0x7fa17d87cdc0>*/\r\n\r\n                                       (1)::int8 AS \"expr~8_value~2\"\r\n\r\n                               )\r\n\r\n                           ) AS \"q~14\"\r\n\r\n                   ) UNION ALL\r\n\r\n                   (SELECT/*<pg.SelectStmt at 0x7fa17d87c6d0>*/\r\n\r\n                           2 AS \"m~7\",\r\n\r\n                           \"v~6\".\"bad368e2-3848-11ed-b2b1-7351c44b074f~2\" AS \"user_identity~11\"\r\n\r\n                       FROM\r\n\r\n                           (SELECT (NULL)::uuid AS \"bad368e2-3848-11ed-b2b1-7351c44b074f~2\") AS \"v~6\"\r\n\r\n                   )\r\n\r\n                   ) AS \"q~15\"\r\n\r\n           ) AS \"q~16\"\r\n\r\n       WHERE\r\n\r\n           \"q~16\".\"m~7\"\r\n\r\n   ) AS \"Session~8\"\r\n\r\n   CROSS JOIN LATERAL\r\n\r\n   (SELECT/*<pg.SelectStmt at 0x7fa17d87d1e0>*/\r\n\r\n           \"q~21\".\"expr~32_value~5\" AS \"expr~34_value~1\"\r\n\r\n       FROM\r\n\r\n           LATERAL\r\n\r\n           (SELECT/*<pg.SelectStmt at 0x7fa17d87d570>*/\r\n\r\n                   edgedb.raise_on_null(\"expr-32~2\".\"expr~32_value~4\", 'cardinality_violation', msg => COALESCE(('required link ''user'' of object type ''default::Session'' is hidden by access policy')::text, 'assert_exists violation: expression returned an empty set'), \"constraint\" => 'std::assert_exists') AS \"expr~32_value~5\"\r\n\r\n               FROM\r\n\r\n                   LATERAL\r\n\r\n                   (SELECT/*<pg.SelectStmt at 0x7fa17d87db70>*/\r\n\r\n                           \"q~20\".\"expr~32_value~3\" AS \"expr~32_value~4\"\r\n\r\n                       FROM\r\n\r\n                           LATERAL\r\n\r\n                           (SELECT/*<pg.SelectStmt at 0x7fa17d87e560>*/\r\n\r\n                                   (\"m~8\" = first_value(\"m~8\") OVER ()) AS \"m~8\",\r\n\r\n                                   \"q~19\".\"expr~32_value~1\" AS \"expr~32_value~3\"\r\n\r\n                               FROM\r\n\r\n                                   LATERAL\r\n\r\n                                   (\r\n\r\n                                   (SELECT/*<pg.SelectStmt at 0x7fa17d87e410>*/\r\n\r\n                                           1 AS \"m~8\",\r\n\r\n                                           \"q~18\".\"expr~31_value~1\" AS \"expr~32_value~1\"\r\n\r\n                                       FROM\r\n\r\n                                           LATERAL\r\n\r\n                                           (SELECT/*<pg.SelectStmt at 0x7fa17d87ec50>*/\r\n\r\n                                                   \"expr-31~2\".\"user_value~1\" AS \"expr~31_value~1\"\r\n\r\n                                               FROM\r\n\r\n                                                   LATERAL\r\n\r\n                                                   (SELECT/*<pg.SelectStmt at 0x7fa17d87f640>*/\r\n\r\n                                                           \"User~6\".id AS \"user_value~1\"\r\n\r\n                                                       FROM\r\n\r\n                                                           LATERAL\r\n\r\n                                                           (SELECT/*<pg.SelectStmt at 0x7fa17d87feb0>*/\r\n\r\n                                                                   \"Session~8\".\"user_identity~13\" AS \"user_identity~14\"\r\n\r\n                                                           ) AS \"q~17\"\r\n\r\n                                                           INNER JOIN edgedbpub.\"bacc476b-3848-11ed-ae1d-2ddecba3d399_t\" AS \"User~6\" \r\n\r\n                                                               ON (\"q~17\".\"user_identity~14\" = \"User~6\".id)\r\n\r\n                                                       WHERE\r\n\r\n                                                           EXISTS (\r\n\r\n                                                               (SELECT/*<pg.SelectStmt at 0x7fa17d87fe20>*/\r\n\r\n                                                                   WHERE\r\n\r\n                                                                       (true)::bool\r\n\r\n                                                               )\r\n\r\n                                                           )\r\n\r\n                                                   ) AS \"expr-31~2\"\r\n\r\n                                           ) AS \"q~18\"\r\n\r\n                                   ) UNION ALL\r\n\r\n                                   (SELECT/*<pg.SelectStmt at 0x7fa17d87e4d0>*/\r\n\r\n                                           2 AS \"m~8\",\r\n\r\n                                           \"v~7\".\"id~1\" AS \"expr~32_value~2\"\r\n\r\n                                       FROM\r\n\r\n                                           (SELECT (NULL)::uuid AS \"id~1\") AS \"v~7\"\r\n\r\n                                   )\r\n\r\n                                   ) AS \"q~19\"\r\n\r\n                           ) AS \"q~20\"\r\n\r\n                       WHERE\r\n\r\n                           \"q~20\".\"m~8\"\r\n\r\n                   ) AS \"expr-32~2\"\r\n\r\n           ) AS \"q~21\"\r\n\r\n   ) AS \"expr-34~2\"\r\n                                                                                      ) AS \r\n\"User_user~4\"\r\n                                                                                      INNER JOIN edgedbpub.\"bacc476b-3848-11ed-ae1d-2ddecba3d399_t\" AS \"User~7\"\r\n                                                                                          ON (\"User_user~4\".\"expr~34_value~2\" = \"User~7\".id)\r\n                                                                              ) AS \"q~22\"  \r\n                                                                      ) AS \"q~23\"\r\n                                                              ) UNION ALL\r\n                                                              (SELECT/*<pg.SelectStmt at 0x7fa17d7df760>*/\r\n                                                                      2 AS \"m~6\",\r\n                                                                      \"v~5\".\"bad0197c-3848-11ed-a23b-d11e74d4ec60~2\" AS \"username_value~13\"\r\n                                                                  FROM\r\n                                                                      (SELECT (NULL)::text \r\nAS \"bad0197c-3848-11ed-a23b-d11e74d4ec60~2\") AS \"v~5\"\r\n                                                              )\r\n                                                              ) AS \"q~24\"\r\n                                                      ) AS \"q~25\"\r\n                                                  WHERE\r\n                                                      \"q~25\".\"m~6\"\r\n                                              ) AS \"str_username~7\"\r\n                                      ) AS \"expr-37~2\"\r\n                                  WHERE\r\n                                      ((\"expr-29~2\".\"expr~29_value~2\" IS NOT NULL) AND     \r\n                                        (\"expr-37~2\".\"expr~37_value~1\" IS NOT NULL))       \r\n                              ) AS \"expr-38~2\"\r\n                          WHERE\r\n                              \"expr-38~2\".\"expr~38_value~1\"\r\n                      )\r\n                  ), false), 'insufficient_privilege', msg => 'access policy violation on insert of default::User', \"table\" => 'bacc476b-3848-11ed-ae1d-2ddecba3d399') AS error\r\n              FROM\r\n                  \"ins_contents~1\" AS \"ins_contents~3\"\r\n          )),\r\n      \"ins~1\" AS\r\n          (INSERT INTO edgedbpub.\"bacc476b-3848-11ed-ae1d-2ddecba3d399\" AS \"User~1\"        \r\n              (__type__, \"bad0197c-3848-11ed-a23b-d11e74d4ec60\", id)\r\n              (\r\n              (SELECT/*<pg.SelectStmt at 0x7fa17dbdeda0>*/\r\n                      __type__,\r\n                      \"bad0197c-3848-11ed-a23b-d11e74d4ec60\",\r\n                      id\r\n                  FROM\r\n                      \"ins_contents~1\" AS \"ins_contents~2\"\r\n                  WHERE\r\n                      (\r\n                      (SELECT/*<pg.SelectStmt at 0x7fa17d87da50>*/\r\n                              count(*)\r\n                          FROM\r\n                              \"policy~1\" AS \"policy~2\"\r\n                      ) > -1)\r\n              ))\r\n              RETURNING\r\n                  \"User~1\".id AS \"User_identity~1\"),\r\n      \"m~1\" AS\r\n          (\r\n          (SELECT/*<pg.SelectStmt at 0x7fa17dbdf760>*/\r\n                  \"ins~2\".\"User_identity~1\" AS \"User_value~3\"\r\n              FROM\r\n                  \"ins~1\" AS \"ins~2\"\r\n                  INNER JOIN \"ins_contents~1\" AS \"ins_contents~2\"\r\n                      ON (\"ins~2\".\"User_identity~1\" = \"ins_contents~2\".id)\r\n          ))\r\n      SELECT/*<pg.SelectStmt at 0x7fa17d636440>*/\r\n              ROW(\"m~2\".\"User_value~3\") AS \"User_serialized~1\"\r\n          FROM\r\n              \"m~1\" AS \"m~2\"\r\n```\r\n</details>\r\n\r\nSchema:\r\n```\r\nmodule default {\r\n    global sessionToken -> str;\r\n    global bypassAccessPolicies -> bool;\r\n\r\n    global session := (select Session filter .token ?= global sessionToken LIMIT 1);\r\n\r\n    type User {\r\n      required property username -> str {\r\n        constraint exclusive;\r\n      };\r\n\r\n      access policy admin_has_full_access\r\n        allow all using (\r\n          (global session).user.username ?= \"admin\"\r\n        );\r\n\r\n      access policy bypass_access_policies\r\n        allow all using (\r\n          (global bypassAccessPolicies) ?? false\r\n        );\r\n    };\r\n\r\n    type Session {\r\n      required link user -> User;\r\n      required property token -> str; # Exclusivity left out for clarity\r\n    };\r\n};\r\n```\r\n\r\n`admin_has_full_access` can be modified to the following to make it work:\r\n```\r\naccess policy admin_has_full_access\r\n  allow all using (\r\n    exists (\r\n      select global session filter .user.username = \"admin\"\r\n    )\r\n  );\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4384/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4384/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4382", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4382/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4382/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4382/events", "html_url": "https://github.com/edgedb/edgedb/issues/4382", "id": 1378266069, "node_id": "I_kwDOBbYNSM5SJqvV", "number": 4382, "title": "Migration applying fails when global depends on an altered type", "user": {"login": "Sikarii", "id": 37634135, "node_id": "MDQ6VXNlcjM3NjM0MTM1", "avatar_url": "https://avatars.githubusercontent.com/u/37634135?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Sikarii", "html_url": "https://github.com/Sikarii", "followers_url": "https://api.github.com/users/Sikarii/followers", "following_url": "https://api.github.com/users/Sikarii/following{/other_user}", "gists_url": "https://api.github.com/users/Sikarii/gists{/gist_id}", "starred_url": "https://api.github.com/users/Sikarii/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Sikarii/subscriptions", "organizations_url": "https://api.github.com/users/Sikarii/orgs", "repos_url": "https://api.github.com/users/Sikarii/repos", "events_url": "https://api.github.com/users/Sikarii/events{/privacy}", "received_events_url": "https://api.github.com/users/Sikarii/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-09-19T17:07:35Z", "updated_at": "2022-10-12T23:33:47Z", "closed_at": "2022-10-12T23:33:47Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "- EdgeDB Version: 2.2@sha256:cf3499f2dacf740fee19d0a6758a5f725449da69cf9f3ba96d4e37258d20d503 (Docker)\r\n- OS Version: Windows 10 21H2 (build 19044.2006)\r\n\r\nError:\r\n```\r\nedgedb error: InternalServerError: relation \"edgedbpub.e93a7d31-383c-11ed-9af0-912f6f0aae4b\" does not exist\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: relation \"edgedbpub.e93a7d31-383c-11ed-9af0-912f6f0aae4b\" does not exist\r\n```\r\n\r\nSteps to Reproduce:\r\n1. Create and apply initial migration (listed below without + fields)\r\n2. Add the `password` field (or any other) to the `User` type\r\n3. Create and try to apply migration with the new schema\r\n\r\nSchema:\r\n```diff\r\nmodule default {\r\n    global userId -> uuid;\r\n    global currentUser := (select User filter .id ?= global userId);\r\n\r\n    type User {\r\n      required property username -> str;\r\n+     required property password -> str;\r\n    };\r\n};\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4382/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4382/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4379", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4379/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4379/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4379/events", "html_url": "https://github.com/edgedb/edgedb/issues/4379", "id": 1376821065, "node_id": "I_kwDOBbYNSM5SEJ9J", "number": 4379, "title": "Bug in constraint inheritance", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-09-17T16:52:56Z", "updated_at": "2022-09-19T20:56:12Z", "closed_at": "2022-09-19T20:56:12Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nSTART TRANSACTION;\r\nCREATE ABSTRACT TYPE default::T;\r\nCREATE ABSTRACT TYPE default::Sub1 EXTENDING default::T;\r\nCREATE TYPE default::Sub2 EXTENDING default::Sub1, default::T;\r\nALTER TYPE default::T {\r\n    CREATE PROPERTY foo -> std::str {\r\n        CREATE CONSTRAINT std::exclusive;\r\n    };\r\n};\r\nROLLBACK;\r\n```\r\n\r\nResults in:\r\n\r\n```\r\nedgedb error: InternalServerError: column old.10370c55-36a9-11ed-89f4-638cbd27bcf9 does not exist\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4379/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4379/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4372", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4372/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4372/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4372/events", "html_url": "https://github.com/edgedb/edgedb/issues/4372", "id": 1376359707, "node_id": "I_kwDOBbYNSM5SCZUb", "number": 4372, "title": "Confusing error when using insert as conversion expression", "user": {"login": "fmoor", "id": 8278635, "node_id": "MDQ6VXNlcjgyNzg2MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/8278635?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmoor", "html_url": "https://github.com/fmoor", "followers_url": "https://api.github.com/users/fmoor/followers", "following_url": "https://api.github.com/users/fmoor/following{/other_user}", "gists_url": "https://api.github.com/users/fmoor/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmoor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmoor/subscriptions", "organizations_url": "https://api.github.com/users/fmoor/orgs", "repos_url": "https://api.github.com/users/fmoor/repos", "events_url": "https://api.github.com/users/fmoor/events{/privacy}", "received_events_url": "https://api.github.com/users/fmoor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1590066979, "node_id": "MDU6TGFiZWwxNTkwMDY2OTc5", "url": "https://api.github.com/repos/edgedb/edgedb/labels/easy", "name": "easy", "color": "48ce9f", "default": false, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}, {"id": 4505522149, "node_id": "LA_kwDOBbYNSM8AAAABDIzP5Q", "url": "https://api.github.com/repos/edgedb/edgedb/labels/onboarding", "name": "onboarding", "color": "bfdadc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2022-09-16T19:01:19Z", "updated_at": "2022-11-23T20:56:17Z", "closed_at": "2022-11-23T20:56:17Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 2.2 (dgeDB CLI 2.0.5+f78cf34)\r\n- OS Version: ubuntu 22.04\r\n\r\nWhen applying a migration that uses an `insert` as a conversion expression I get an obscure error that seems to complain about the generated migration.\r\n\r\n```bash\r\n$ edgedb migration create\r\ndid you create link 'org' of object type 'default::Department'? [y,n,l,c,b,s,q,?]\r\n> y\r\nPlease specify an expression to populate existing objects in order to make link 'org' of object type 'default::Department' required:\r\nfill_expr> insert Organization { name := \"default\" }\r\n$ edgedb migration apply\r\nedgedb error: UnsupportedBackendFeatureError: WITH clause containing a data-modifying statement must be at the top level\r\n```\r\n\r\n### Schema 1\r\n```\r\nmodule default {\r\n\ttype Organization {\r\n\t\trequired property name -> str;\r\n\t}\r\n\r\n\ttype Department {\r\n\t\trequired property name -> str;\r\n\t}\r\n}\r\n```\r\n\r\n### Schema 2\r\n```\r\nmodule default {\r\n\ttype Organization {\r\n\t\trequired property name -> str;\r\n\t}\r\n\r\n\ttype Department {\r\n\t\trequired property name -> str;\r\n\t\trequired link org -> Organization;\r\n\t}\r\n}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4372/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4372/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4362", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4362/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4362/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4362/events", "html_url": "https://github.com/edgedb/edgedb/issues/4362", "id": 1374866760, "node_id": "I_kwDOBbYNSM5R8s1I", "number": 4362, "title": "Access Policy Internal Server Error", "user": {"login": "ElijahJohnson5", "id": 22087836, "node_id": "MDQ6VXNlcjIyMDg3ODM2", "avatar_url": "https://avatars.githubusercontent.com/u/22087836?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ElijahJohnson5", "html_url": "https://github.com/ElijahJohnson5", "followers_url": "https://api.github.com/users/ElijahJohnson5/followers", "following_url": "https://api.github.com/users/ElijahJohnson5/following{/other_user}", "gists_url": "https://api.github.com/users/ElijahJohnson5/gists{/gist_id}", "starred_url": "https://api.github.com/users/ElijahJohnson5/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ElijahJohnson5/subscriptions", "organizations_url": "https://api.github.com/users/ElijahJohnson5/orgs", "repos_url": "https://api.github.com/users/ElijahJohnson5/repos", "events_url": "https://api.github.com/users/ElijahJohnson5/events{/privacy}", "received_events_url": "https://api.github.com/users/ElijahJohnson5/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2022-09-15T17:36:40Z", "updated_at": "2022-10-20T01:56:18Z", "closed_at": "2022-10-20T01:56:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 2.1\r\n- OS Version: Windows 10\r\n\r\nSteps to Reproduce:\r\n\r\n1. Create schema like the one below\r\n2. Create a migration and migrate the database\r\n3. Try to `select Organization` \r\n4. See error same as below\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema: \r\n```\r\n  type User {\r\n    multi link organizations := .<users[is Organization];\r\n\r\n    multi link roles -> Role {\r\n      on target delete allow;\r\n      property itemId -> uuid;\r\n    }\r\n  }\r\n  type Role {\r\n    required property description -> str;\r\n\r\n    multi link permissions -> Permission;\r\n  }\r\n\r\n  type Permission {\r\n    required property slug -> str;\r\n\r\n    required property allow -> bool {\r\n      default := true;\r\n    };\r\n\r\n    index on (.slug);\r\n    index on ((.slug, .allow));\r\n\r\n    constraint exclusive on ((.slug, .allow))\r\n  }\r\n\r\n  type Organization {\r\n    multi link users -> User {\r\n      on target delete allow;\r\n    };\r\n\r\n    access policy read_allow_org\r\n      allow select \r\n      using \r\n      (\r\n        exists\r\n        (\r\n          select .users\r\n          { \r\n            roles:\r\n            { \r\n              permissions filter .slug = 'READ_ORG' and .allow = true\r\n            }\r\n          } filter\r\n              .id ?= global currentUserId\r\n              and .roles@itemId = Organization.id\r\n        )\r\n      )\r\n  }\r\n```\r\n\r\nError: Can provide more of the stack trace if needed \r\n```\r\nedgedb error: InternalServerError: None\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.1/lib/python3.10/site-packages/edb/pgsql/compiler/__init__.py\", line 120, in compile_ir_to_sql_tree\r\n          qtree = dispatch.compile(ir_expr, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/2.1/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4362/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4362/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4358", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4358/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4358/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4358/events", "html_url": "https://github.com/edgedb/edgedb/issues/4358", "id": 1373649498, "node_id": "I_kwDOBbYNSM5R4Dpa", "number": 4358, "title": "Spurious correlated set error with nested unless conflicts", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-09-14T22:20:25Z", "updated_at": "2022-09-14T22:58:16Z", "closed_at": "2022-09-14T22:58:16Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Schema:\r\n```\r\ncreate type X {\r\n    create required property n -> str {\r\n        create constraint exclusive;\r\n    }\r\n};\r\ncreate type Y {\r\n    create required link l -> X {\r\n        create constraint exclusive;\r\n    }\r\n};\r\n```\r\n\r\n```\r\nINSERT Y {                                                                  \r\n  l := (INSERT X { n := \"foo\" })                                            \r\n}                                                                           \r\nUNLESS CONFLICT ON (.l);\r\n```\r\ngives the error `cannot reference correlated set 'Y.l' here`\r\nwhile\r\n```\r\nINSERT Y {                                                                  \r\n  l := (INSERT X { n := \"foo\" })                                            \r\n}                                                                           \r\nUNLESS CONFLICT ON (Y.l);\r\n```\r\nsomehow works! (Though it requires #4357 to actually work)\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4358/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4358/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4354", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4354/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4354/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4354/events", "html_url": "https://github.com/edgedb/edgedb/issues/4354", "id": 1372215499, "node_id": "I_kwDOBbYNSM5RyljL", "number": 4354, "title": "Migration error: cannot create a union of enum scalar type", "user": {"login": "mrmntte", "id": 49642108, "node_id": "MDQ6VXNlcjQ5NjQyMTA4", "avatar_url": "https://avatars.githubusercontent.com/u/49642108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrmntte", "html_url": "https://github.com/mrmntte", "followers_url": "https://api.github.com/users/mrmntte/followers", "following_url": "https://api.github.com/users/mrmntte/following{/other_user}", "gists_url": "https://api.github.com/users/mrmntte/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrmntte/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrmntte/subscriptions", "organizations_url": "https://api.github.com/users/mrmntte/orgs", "repos_url": "https://api.github.com/users/mrmntte/repos", "events_url": "https://api.github.com/users/mrmntte/events{/privacy}", "received_events_url": "https://api.github.com/users/mrmntte/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-09-14T01:53:01Z", "updated_at": "2022-09-28T23:52:27Z", "closed_at": "2022-09-28T23:52:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n - OS: Ubuntu 20.04 LTS (WSL)\r\n - EdgeDB version: 2.1+c73716f\r\n\r\nGot this error when I run `edgedb migration apply` on a clean db:\r\n`edgedb error: SchemaError: cannot create a union of default::ClipType, default::RecordingType`\r\n\r\nBut if I add each `_type` property in separate migrations, it seems to work.\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n```sql\r\nmodule default {\r\n  scalar type ClipType extending enum<Test1, Test2>;\r\n  scalar type RecordingType extending enum<Test3, Test4>;\r\n\r\n  type LiveClass {\r\n    link _clips := .<_class[is Clip];\r\n    link _recordings := .<_class[is Recording];\r\n  }\r\n\r\n  type Clip {\r\n    required property _type -> ClipType;\r\n    link _class -> LiveClass;\r\n  }\r\n\r\n  type Recording {\r\n    required property _type -> RecordingType;\r\n    # \u2b07\ufe0f changing _type to another name works.\r\n    # required property _typexyz -> RecordingType;\r\n    link _class -> LiveClass;\r\n  }\r\n}\r\n```\r\n\r\nGenerated migration:\r\n```sql\r\nCREATE MIGRATION m1qv6cqu3zdfyh5jbknm5jjmhvv6eeyepqyjdzkmxcts2hc2xtz7yq\r\n    ONTO initial\r\n{\r\n  CREATE SCALAR TYPE default::ClipType EXTENDING enum<Test1, Test2>;\r\n  CREATE TYPE default::Clip {\r\n      CREATE REQUIRED PROPERTY _type -> default::ClipType;\r\n  };\r\n  CREATE TYPE default::LiveClass;\r\n  ALTER TYPE default::Clip {\r\n      CREATE LINK _class -> default::LiveClass;\r\n  };\r\n  ALTER TYPE default::LiveClass {\r\n      CREATE LINK _clips := (.<_class[IS default::Clip]);\r\n  };\r\n  CREATE SCALAR TYPE default::RecordingType EXTENDING enum<Test3, Test4>;\r\n  CREATE TYPE default::Recording {\r\n      CREATE LINK _class -> default::LiveClass;\r\n      CREATE REQUIRED PROPERTY _type -> default::RecordingType;\r\n  };\r\n  ALTER TYPE default::LiveClass {\r\n      CREATE LINK _recordings := (.<_class[IS default::Recording]);\r\n  };\r\n};\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4354/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4354/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4350", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4350/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4350/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4350/events", "html_url": "https://github.com/edgedb/edgedb/issues/4350", "id": 1371669839, "node_id": "I_kwDOBbYNSM5RwgVP", "number": 4350, "title": "Error when running a sequence of queries and returning multiple variables", "user": {"login": "dotlouis", "id": 1891109, "node_id": "MDQ6VXNlcjE4OTExMDk=", "avatar_url": "https://avatars.githubusercontent.com/u/1891109?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dotlouis", "html_url": "https://github.com/dotlouis", "followers_url": "https://api.github.com/users/dotlouis/followers", "following_url": "https://api.github.com/users/dotlouis/following{/other_user}", "gists_url": "https://api.github.com/users/dotlouis/gists{/gist_id}", "starred_url": "https://api.github.com/users/dotlouis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dotlouis/subscriptions", "organizations_url": "https://api.github.com/users/dotlouis/orgs", "repos_url": "https://api.github.com/users/dotlouis/repos", "events_url": "https://api.github.com/users/dotlouis/events{/privacy}", "received_events_url": "https://api.github.com/users/dotlouis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 2295768861, "node_id": "MDU6TGFiZWwyMjk1NzY4ODYx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/need%20info", "name": "need info", "color": "77e5b0", "default": false, "description": "Need more information from submitter"}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2022-09-13T15:51:36Z", "updated_at": "2023-02-10T01:19:43Z", "closed_at": "2023-02-10T01:19:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 2.1+52c90a7\r\n- OS Version: macOS 12.5.1 (M1)\r\n\r\nHi all,\r\n\r\nGiven a schema that looks like this (simplified for readability):\r\n\r\n```GraphQL\r\nmodule default {\r\n  type Submission {\r\n    required link account -> auth::Account\r\n    required link contact -> default::Contact\r\n  }\r\n  type Contact {\r\n    required link account -> auth::Account\r\n    required link sharedContact -> shared::Contact\r\n    link submission := .<contact[is Submission];\r\n  }\r\n}\r\n\r\nmodule shared {\r\n  type Contact {\r\n    property name -> str;\r\n    multi link accountContacts := .<sharedContact[is default::Contact];\r\n    multi link employments := .<contact[is shared::Employment];\r\n  }\r\n\r\n  type Employment {\r\n      required link contact -> shared::Contact;\r\n      required link company -> shared::Company\r\n  }\r\n\r\n  type Company {\r\n      property name -> str;\r\n      multi link employments := .<company[is shared::Employment];\r\n  }\r\n}\r\n```\r\n\r\nI have this query that uses WITH block to create nested objects once, and reuse them in subsequent queries:\r\n\r\n```GraphQL\r\nWITH\r\n  account := (global currentAccount),\r\n  sharedContact := (\r\n    INSERT shared::Contact {\r\n      name := \"Colin\"\r\n    } \r\n    UNLESS CONFLICT ON shared::Contact.linkedinUrl\r\n    ELSE (shared::Contact)\r\n  ),\r\n  contact := (\r\n    INSERT default::Contact {\r\n      account := account,\r\n      sharedContact := sharedContact\r\n    }\r\n  ),\r\n  submission := (\r\n    INSERT default::Submission {\r\n      account := account,\r\n      contact := contact,\r\n    }\r\n  ),\r\n  sharedCompany := (\r\n    INSERT shared::Company {\r\n      name := \"EdgeDB\"\r\n    } \r\n    UNLESS CONFLICT ON shared::Company.linkedinUrl\r\n    ELSE (shared::Company)\r\n  ),\r\n  sharedEmployment := (\r\n    INSERT shared::Employment {\r\n      contact := sharedContact,\r\n      company := sharedCompany\r\n    } \r\n    UNLESS CONFLICT ON shared::Employment.email\r\n    ELSE (shared::Employment)\r\n  )\r\nselect (submission, sharedEmployment)\r\n```\r\n\r\nHowever, this throws a rather obscure:\r\n\r\n`InternalServerError: None`\r\n\r\nI initially wanted to return only the submission (from the select)\r\n```\r\nselect submission\r\n```\r\n\r\nBut it throws a `QueryError: unused alias definition: 'sharedEmployment'`\r\n\r\nSo I've tried returning both to work around it with a tuple:\r\n```\r\nselect (submission, sharedEmployment)\r\n```\r\nor with a free object:\r\n```\r\nselect {\r\n  submission := submission,\r\n  sharedEmployment := sharedEmployement\r\n}\r\n```\r\nBoth of these methods throws: `InternalServerError: None`\r\n\r\nThere is a similar discussion around how to sequence queries and return only parts of them in the response:\r\nhttps://github.com/edgedb/edgedb/discussions/3906\r\n\r\nAppreciate any recommendation or feedback. Thanks", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4350/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4350/timeline", "performed_via_github_app": null, "state_reason": "not_planned"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4344", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4344/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4344/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4344/events", "html_url": "https://github.com/edgedb/edgedb/issues/4344", "id": 1369828845, "node_id": "I_kwDOBbYNSM5Rpe3t", "number": 4344, "title": "Dump fails on schemas with quoted properties", "user": {"login": "jaclarke", "id": 2085287, "node_id": "MDQ6VXNlcjIwODUyODc=", "avatar_url": "https://avatars.githubusercontent.com/u/2085287?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaclarke", "html_url": "https://github.com/jaclarke", "followers_url": "https://api.github.com/users/jaclarke/followers", "following_url": "https://api.github.com/users/jaclarke/following{/other_user}", "gists_url": "https://api.github.com/users/jaclarke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaclarke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaclarke/subscriptions", "organizations_url": "https://api.github.com/users/jaclarke/orgs", "repos_url": "https://api.github.com/users/jaclarke/repos", "events_url": "https://api.github.com/users/jaclarke/events{/privacy}", "received_events_url": "https://api.github.com/users/jaclarke/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-09-12T12:30:19Z", "updated_at": "2022-09-19T20:57:07Z", "closed_at": "2022-09-19T20:57:07Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: 3.0-dev.6872+local\r\n\r\nSteps to Reproduce:\r\n\r\n1. Create type with quoted property:\r\n```\r\ndumpbug> create type Test {\r\n........   create property `123` -> str;\r\n........ };\r\nOK: CREATE TYPE\r\n```\r\n2. Try to dump database:\r\n```\r\n$ edb cli -d dumpbug dump dumpbug\r\nedgedb error: EdgeQLSyntaxError: error receiving dump header: Unexpected '123'\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/home/james/dev/edgedb/edb/common/parsing.py\", line 420, in parse\r\n          self.parser.token(token)\r\n        File \"/home/james/dev/edgedb-dev/lib/python3.10/site-packages/parsing/lrparser.py\", line 57, in token\r\n          self._act(token, tokenSpec)  # type: ignore\r\n        File \"/home/james/dev/edgedb-dev/lib/python3.10/site-packages/parsing/lrparser.py\", line 81, in _act\r\n          raise UnexpectedToken(\"Unexpected token: %r\" % sym)\r\n      parsing.errors.UnexpectedToken: Unexpected token: <Token ICONST \"123\">\r\n\r\n      The above exception was the direct cause of the following exception:\r\n\r\n      Traceback (most recent call last):\r\n        File \"/home/james/dev/edgedb/edb/server/compiler_pool/worker_proc.py\", line 55, in worker\r\n          res = meth(*args)\r\n        File \"/home/james/dev/edgedb/edb/server/compiler/compiler.py\", line 2280, in describe_database_dump\r\n          schema_ddl = s_ddl.ddl_text_from_schema(\r\n        File \"/home/james/dev/edgedb/edb/schema/ddl.py\", line 899, in ddl_text_from_schema\r\n          return ddl_text_from_delta(None, schema, diff)\r\n        File \"/home/james/dev/edgedb/edb/schema/ddl.py\", line 817, in ddl_text_from_delta\r\n          return text_from_delta(schema_a, schema_b, delta, sdlmode=False)\r\n        File \"/home/james/dev/edgedb/edb/schema/ddl.py\", line 787, in text_from_delta\r\n          stmts = statements_from_delta(\r\n        File \"/home/james/dev/edgedb/edb/schema/ddl.py\", line 714, in statements_from_delta\r\n          stmts = ddlast_from_delta(\r\n        File \"/home/james/dev/edgedb/edb/schema/ddl.py\", line 695, in ddlast_from_delta\r\n          ql_ast = command.get_ast(schema, context)\r\n        File \"/home/james/dev/edgedb/edb/schema/delta.py\", line 2628, in get_ast\r\n          return self._get_ast(schema, context, parent_node=parent_node)\r\n        File \"/home/james/dev/edgedb/edb/schema/migrations.py\", line 196, in _get_ast\r\n          node = super()._get_ast(schema, context, parent_node=parent_node)\r\n        File \"/home/james/dev/edgedb/edb/schema/delta.py\", line 2945, in _get_ast\r\n          node = super()._get_ast(schema, context, parent_node=parent_node)\r\n        File \"/home/james/dev/edgedb/edb/schema/delta.py\", line 2188, in _get_ast\r\n          self._apply_fields_ast(schema, context, op)\r\n        File \"/home/james/dev/edgedb/edb/schema/delta.py\", line 2223, in _apply_fields_ast\r\n          self._apply_field_ast(schema, context, node, fop)\r\n        File \"/home/james/dev/edgedb/edb/schema/migrations.py\", line 213, in _apply_field_ast\r\n          qlparser.parse_block(op.new_value),\r\n        File \"/home/james/dev/edgedb/edb/edgeql/parser/__init__.py\", line 77, in parse_block\r\n          return parser.parse(source)\r\n        File \"/home/james/dev/edgedb/edb/common/parsing.py\", line 433, in parse\r\n          raise self.get_exception(\r\n      edb.errors.EdgeQLSyntaxError: Unexpected '123'\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4344/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4344/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4335", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4335/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4335/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4335/events", "html_url": "https://github.com/edgedb/edgedb/issues/4335", "id": 1366815103, "node_id": "I_kwDOBbYNSM5Rd_F_", "number": 4335, "title": "Slicing empty array produces empty set", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}, {"id": 4505522149, "node_id": "LA_kwDOBbYNSM8AAAABDIzP5Q", "url": "https://api.github.com/repos/edgedb/edgedb/labels/onboarding", "name": "onboarding", "color": "bfdadc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-09-08T18:33:51Z", "updated_at": "2022-09-23T11:03:59Z", "closed_at": "2022-09-23T11:03:59Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nedgedb> select (<array<str>>[])[0:];\r\n{}\r\n```\r\nCorrect behavior would be to produce `{[]}`.\r\n\r\nStrings and bytes work correct. json strings work but json arrays are broken.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4335/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4335/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4327", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4327/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4327/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4327/events", "html_url": "https://github.com/edgedb/edgedb/issues/4327", "id": 1365081517, "node_id": "I_kwDOBbYNSM5RXX2t", "number": 4327, "title": "Slicing behaves incorrectly on NULL empty sets", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}, {"id": 4505522149, "node_id": "LA_kwDOBbYNSM8AAAABDIzP5Q", "url": "https://api.github.com/repos/edgedb/edgedb/labels/onboarding", "name": "onboarding", "color": "bfdadc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-09-07T19:13:03Z", "updated_at": "2022-09-23T09:52:26Z", "closed_at": "2022-09-23T09:52:26Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Another instance of a classic edgedb bug.\r\n\r\nSlicing is a regular (non-optional) operation, and so empty set inputs should result in an empty set output, like such:\r\n```\r\nedgedb> select [1,2,3][1:<int64>{}];\r\n[]\r\n```\r\n\r\nBut empty sets that get represented as NULL produce output as if the argument was omitted:\r\n```\r\nedgedb> select [1,2,3][1:<optional int64>$0];\r\nParameter <int64>$0 (Ctrl+D for empty set `{}`): \r\n[[2, 3]]\r\n```\r\n\r\nThe root of the issue is that all slicing (missing arguments or not) is done by calling a `_slice` function, and we represent missing bounds as NULL.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4327/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4327/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4268", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4268/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4268/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4268/events", "html_url": "https://github.com/edgedb/edgedb/issues/4268", "id": 1341821709, "node_id": "I_kwDOBbYNSM5P-pMN", "number": 4268, "title": "InternalServerError when trying to create an exclusive constraint at base type", "user": {"login": "fikisipi", "id": 8115972, "node_id": "MDQ6VXNlcjgxMTU5NzI=", "avatar_url": "https://avatars.githubusercontent.com/u/8115972?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fikisipi", "html_url": "https://github.com/fikisipi", "followers_url": "https://api.github.com/users/fikisipi/followers", "following_url": "https://api.github.com/users/fikisipi/following{/other_user}", "gists_url": "https://api.github.com/users/fikisipi/gists{/gist_id}", "starred_url": "https://api.github.com/users/fikisipi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fikisipi/subscriptions", "organizations_url": "https://api.github.com/users/fikisipi/orgs", "repos_url": "https://api.github.com/users/fikisipi/repos", "events_url": "https://api.github.com/users/fikisipi/events{/privacy}", "received_events_url": "https://api.github.com/users/fikisipi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-08-17T14:06:03Z", "updated_at": "2022-09-07T20:43:39Z", "closed_at": "2022-09-07T20:43:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 2.1+52c90a7 (repl 2.1.0-dev.837+77d7d80)\r\n- OS Version: Mac m1 Kernel Version 21.6.0\r\n\r\nRun this: \r\n```sql\r\nCREATE MIGRATION m1tnwlplgljiafydd3xfu7ks7syxrmp6pwyzigtxv3n4ssseibzfla\r\n    ONTO initial\r\n{\r\n  CREATE TYPE default::MenuItem {\r\n      CREATE MULTI LINK children -> default::MenuItem;\r\n      CREATE REQUIRED PROPERTY name -> std::str;\r\n      CREATE PROPERTY page -> std::str;\r\n  };\r\n  CREATE TYPE default::Menu {\r\n      CREATE CONSTRAINT std::exclusive;\r\n      CREATE REQUIRED LINK item -> default::MenuItem;\r\n  };\r\n};\r\n```\r\n\r\nOutput:\r\n```bash\r\nError: InternalServerError: syntax error at or near \".\"\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4268/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4268/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4257", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4257/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4257/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4257/events", "html_url": "https://github.com/edgedb/edgedb/issues/4257", "id": 1338320842, "node_id": "I_kwDOBbYNSM5PxSfK", "number": 4257, "title": "Filter and ordering does not work on calculated properties with group by", "user": {"login": "TheHyphen", "id": 10869488, "node_id": "MDQ6VXNlcjEwODY5NDg4", "avatar_url": "https://avatars.githubusercontent.com/u/10869488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TheHyphen", "html_url": "https://github.com/TheHyphen", "followers_url": "https://api.github.com/users/TheHyphen/followers", "following_url": "https://api.github.com/users/TheHyphen/following{/other_user}", "gists_url": "https://api.github.com/users/TheHyphen/gists{/gist_id}", "starred_url": "https://api.github.com/users/TheHyphen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TheHyphen/subscriptions", "organizations_url": "https://api.github.com/users/TheHyphen/orgs", "repos_url": "https://api.github.com/users/TheHyphen/repos", "events_url": "https://api.github.com/users/TheHyphen/events{/privacy}", "received_events_url": "https://api.github.com/users/TheHyphen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2022-08-14T18:38:03Z", "updated_at": "2022-10-18T20:31:22Z", "closed_at": "2022-10-18T20:31:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 2.1+c73716f\r\n- OS Version: WSL 2\r\n\r\nSteps to Reproduce:\r\n\r\nRun this query in the EdgeDB UI:\r\n```\r\nwith\r\n  M := (select Shipments),\r\n  groups := (\r\n    group M\r\n    using\r\n     grouping := .client.name\r\n    by grouping\r\n  ) \r\nselect groups {\r\n  name := .key.grouping,\r\n  value := count(.elements)\r\n} filter .value > 30\r\n```\r\nthrows an error:\r\n> InternalServerError: Can't find materialized set ns~24@ns~25@@(__derived__::groups@w~2).>elements[IS default::Shipments]\r\n\r\nBut if I change the filter to \r\n```\r\nfilter count(.elements) > 30\r\n```\r\nthen, it works as expected.\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n```\r\nmodule default {\r\n    type Client {\r\n        required property name -> str;\r\n        property email -> str;\r\n    }\r\n    type Shipments {\r\n        required link client -> Client;\r\n        required property date -> cal::local_datetime;\r\n    }\r\n}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4257/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4257/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4241", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4241/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4241/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4241/events", "html_url": "https://github.com/edgedb/edgedb/issues/4241", "id": 1333835557, "node_id": "I_kwDOBbYNSM5PgLcl", "number": 4241, "title": "GROUP - Can't compile ref to visible binding", "user": {"login": "jhwz", "id": 52683873, "node_id": "MDQ6VXNlcjUyNjgzODcz", "avatar_url": "https://avatars.githubusercontent.com/u/52683873?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jhwz", "html_url": "https://github.com/jhwz", "followers_url": "https://api.github.com/users/jhwz/followers", "following_url": "https://api.github.com/users/jhwz/following{/other_user}", "gists_url": "https://api.github.com/users/jhwz/gists{/gist_id}", "starred_url": "https://api.github.com/users/jhwz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jhwz/subscriptions", "organizations_url": "https://api.github.com/users/jhwz/orgs", "repos_url": "https://api.github.com/users/jhwz/repos", "events_url": "https://api.github.com/users/jhwz/events{/privacy}", "received_events_url": "https://api.github.com/users/jhwz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2022-08-09T22:06:49Z", "updated_at": "2022-09-29T20:51:58Z", "closed_at": "2022-09-29T20:51:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "- EdgeDB Version: `2.1.0-dev.827+ea32987`\r\n- OS Version: `20.04.1-Ubuntu`\r\n\r\nUsing example database, the query:\r\n```\r\nwith grouped := (group Movie by .release_year)\r\nfor item in grouped union (select item.elements { title } )\r\n```\r\n\r\ngives\r\n```\r\nInternalServerError: Can't compile ref to visible binding ns~1@@(__derived__::g~1)\r\nHint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n```\r\n\r\nnote that if you simply remove the reference to `title`, it works.\r\n```\r\nwith grouped := (group Movie by .release_year)\r\nfor item in grouped union (select item.elements )\r\n```\r\n\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4241/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4241/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4240", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4240/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4240/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4240/events", "html_url": "https://github.com/edgedb/edgedb/issues/4240", "id": 1333602588, "node_id": "I_kwDOBbYNSM5PfSkc", "number": 4240, "title": "\"InternalServerError: Can't find materialized set\" on group by / filter query", "user": {"login": "againagainst", "id": 654455, "node_id": "MDQ6VXNlcjY1NDQ1NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/654455?v=4", "gravatar_id": "", "url": "https://api.github.com/users/againagainst", "html_url": "https://github.com/againagainst", "followers_url": "https://api.github.com/users/againagainst/followers", "following_url": "https://api.github.com/users/againagainst/following{/other_user}", "gists_url": "https://api.github.com/users/againagainst/gists{/gist_id}", "starred_url": "https://api.github.com/users/againagainst/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/againagainst/subscriptions", "organizations_url": "https://api.github.com/users/againagainst/orgs", "repos_url": "https://api.github.com/users/againagainst/repos", "events_url": "https://api.github.com/users/againagainst/events{/privacy}", "received_events_url": "https://api.github.com/users/againagainst/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2022-08-09T18:01:00Z", "updated_at": "2023-01-03T23:44:12Z", "closed_at": "2022-10-19T05:06:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "- EdgeDB Version: 2.1+52c90a7\r\n- OS Version: MacOS 12.3.1\r\n- EdgeDB CLI Version : 2.0.4+a7fc49b\r\n\r\nSteps to Reproduce:\r\n\r\nI am trying to find records with duplicated emails. The following query\r\n```\r\nedgedb> \r\nwith usersByEmail := (\r\n  group User by .email\r\n)\r\nselect usersByEmail {\r\n  key := .key,\r\n  count := count(.elements),\r\n} filter .count > 1;\r\n```\r\nleads to a server error:\r\n```\r\nServer traceback:      \r\n    Traceback (most recent call last):\r\n    File \".../site-packages/edb/server/compiler_pool/worker_proc.py\", line 55, in worker\r\n        res = meth(*args)\r\n    File \".../site-packages/edb/server/compiler_pool/worker.py\", line 160, in compile\r\n        units, cstate = COMPILER.compile(\r\n    File \".../site-packages/edb/server/compiler/compiler.py\", line 2207, in compile\r\n        unit_group = self._compile(ctx=ctx, source=source)\r\n    File \".../site-packages/edb/server/compiler/compiler.py\", line 1738, in _compile\r\n        return self._try_compile(ctx=ctx, source=source)\r\n    File \".../site-packages/edb/server/compiler/compiler.py\", line 1802, in _try_compile\r\n        comp, capabilities = self._compile_dispatch_ql(\r\n    File \".../site-packages/edb/server/compiler/compiler.py\", line 1712, in _compile_dispatch_ql\r\n        query = self._compile_ql_query(ctx, ql, script_info=script_info)\r\n    File \".../site-packages/edb/server/compiler/compiler.py\", line 637, in _compile_ql_query\r\n        sql_text, argmap = pg_compiler.compile_ir_to_sql(\r\n    File \".../site-packages/edb/pgsql/compiler/__init__.py\", line 152, in compile_ir_to_sql\r\n        qtree = compile_ir_to_sql_tree(\r\n    File \".../site-packages/edb/pgsql/compiler/__init__.py\", line 135, in compile_ir_to_sql_tree\r\n        raise errors.InternalServerError(*args) from e\r\n    edb.errors.InternalServerError: Can't find materialized set ns~20@ns~21@@(__derived__::usersByEmail@w~1).>elements[IS default::User]\r\n```\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n```\r\nmodule default {\r\n    type User {\r\n        property name -> str;\r\n        property email -> str;\r\n        property bio -> str;\r\n        property password -> str;\r\n        multi link native -> Language;\r\n        multi link learning -> Language;\r\n    };\r\n\r\n    type Language {\r\n        required property code -> str;\r\n        required property name -> str;\r\n        required property flag -> str;\r\n    }\r\n};\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4240/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4240/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4237", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4237/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4237/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4237/events", "html_url": "https://github.com/edgedb/edgedb/issues/4237", "id": 1333267803, "node_id": "I_kwDOBbYNSM5PeA1b", "number": 4237, "title": "Create Index in abstract Link crashes Migration", "user": {"login": "Hazealign", "id": 1115741, "node_id": "MDQ6VXNlcjExMTU3NDE=", "avatar_url": "https://avatars.githubusercontent.com/u/1115741?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Hazealign", "html_url": "https://github.com/Hazealign", "followers_url": "https://api.github.com/users/Hazealign/followers", "following_url": "https://api.github.com/users/Hazealign/following{/other_user}", "gists_url": "https://api.github.com/users/Hazealign/gists{/gist_id}", "starred_url": "https://api.github.com/users/Hazealign/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Hazealign/subscriptions", "organizations_url": "https://api.github.com/users/Hazealign/orgs", "repos_url": "https://api.github.com/users/Hazealign/repos", "events_url": "https://api.github.com/users/Hazealign/events{/privacy}", "received_events_url": "https://api.github.com/users/Hazealign/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2022-08-09T13:33:45Z", "updated_at": "2022-10-13T02:35:11Z", "closed_at": "2022-10-13T02:35:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 2.1\r\n- OS Version: macOS 12.5 (M1 Pro, Also Checked in Docker Image with `amd64` architecture)\r\n\r\nSteps to Reproduce:\r\n\r\n1. Create Previous Schema (Works well!)\r\n2. Add Index in Abstract Link\r\n3. Create Migration and Apply, It Crashes.\r\n\r\n```\r\nedgedb error: InternalServerError: relation \"edgedbpub.f6cc2eae-17e5-11ed-8e92-83df59ae4c33\" does not exist\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: relation \"edgedbpub.f6cc2eae-17e5-11ed-8e92-83df59ae4c33\" does not exist\r\n```\r\n\r\np.s. I'm new with EdgeDB, so It can be schema error. If my schema is wrong, Just Tell me please. :) I think this error message can be contain more information. \r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n\r\n```\r\nmodule default {\r\n  # Base Model for Define Essential Values\r\n  abstract type BaseModel {\r\n    overloaded required property id -> uuid {\r\n      constraint exclusive;\r\n      readonly := true;\r\n      default := uuid_generate_v1mc();\r\n    };\r\n\r\n    required property created_at -> datetime;\r\n    required property updated_at -> datetime;\r\n    property deleted_at -> datetime;\r\n    required property deleted -> bool {\r\n      default := false;\r\n    };\r\n\r\n    index on (.created_at) {\r\n      annotation title := \"CreatedAt Index\";\r\n    };\r\n  }\r\n\r\n  # Define User Model\r\n  type User extending BaseModel {\r\n    # Email is unique.\r\n    required property email -> str {\r\n      constraint exclusive;\r\n    };\r\n\r\n    required property password -> str;\r\n\r\n    required property name -> str {\r\n      constraint min_len_value(3);\r\n    };\r\n\r\n    index on (.email) {\r\n      annotation title := \"Email Index\";\r\n    };\r\n  }\r\n\r\n  abstract link IdIndex {\r\n    property id -> uuid;\r\n    # ----------------------------------\r\n    # here is the problem!!\r\n    index on (__subject__@id);\r\n    # ----------------------------------\r\n  }\r\n\r\n  # Define Memo and Comment Model\r\n  type Memo extending BaseModel {\r\n    required link created_by extending IdIndex -> User;\r\n    multi link accessable_users extending IdIndex -> User;\r\n\r\n    required property title -> str;\r\n    required property content -> str;\r\n    required property tags -> array<str> {\r\n      default := <array<str>>[];\r\n    };\r\n  }\r\n\r\n  type Comment extending BaseModel {\r\n    required link created_by extending IdIndex -> User;\r\n    required link memo extending IdIndex -> Memo;\r\n    required property content -> str;\r\n  }\r\n}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4237/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4237/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4219", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4219/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4219/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4219/events", "html_url": "https://github.com/edgedb/edgedb/issues/4219", "id": 1330510713, "node_id": "I_kwDOBbYNSM5PTft5", "number": 4219, "title": "Access policy dislikes omitted fields", "user": {"login": "fantix", "id": 1751601, "node_id": "MDQ6VXNlcjE3NTE2MDE=", "avatar_url": "https://avatars.githubusercontent.com/u/1751601?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fantix", "html_url": "https://github.com/fantix", "followers_url": "https://api.github.com/users/fantix/followers", "following_url": "https://api.github.com/users/fantix/following{/other_user}", "gists_url": "https://api.github.com/users/fantix/gists{/gist_id}", "starred_url": "https://api.github.com/users/fantix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fantix/subscriptions", "organizations_url": "https://api.github.com/users/fantix/orgs", "repos_url": "https://api.github.com/users/fantix/repos", "events_url": "https://api.github.com/users/fantix/events{/privacy}", "received_events_url": "https://api.github.com/users/fantix/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-08-05T22:16:05Z", "updated_at": "2022-09-08T01:03:19Z", "closed_at": "2022-09-08T01:03:19Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: 2.0+88c1706, 2.1+52c90a7\r\n- Schema:\r\n\r\n    ```\r\n    type A {\r\n        access policy soft_delete\r\n            allow select, update read, insert using (NOT (EXISTS (.ts)));\r\n        access policy update_write\r\n            allow update write ;\r\n        property ts -> std::datetime;\r\n    };\r\n    ```\r\n\r\nSteps to Reproduce:\r\n\r\n1. Insert with `ts` field works:\r\n\r\n    ```\r\n    edgedb> insert A { ts := {} };\r\n    {default::A {id: ccd0f2da-1509-11ed-af6c-ef6982b67324}}\r\n    ```\r\n\r\n2. Insert without `ts` field doesn't:\r\n\r\n   ```\r\n   edgedb> insert A;\r\n   edgedb error: InternalServerError: there is no range var for (default::A) source in <pg.SelectStmt at 0x1157ece20>\r\n     Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n     Server traceback:\r\n         Traceback (most recent call last):\r\n           File \"edb/pgsql/compiler/__init__.py\", line 120, in compile_ir_to_sql_tree\r\n             qtree = dispatch.compile(ir_expr, ctx=ctx)\r\n           File \"python3.10/functools.py\", line 889, in wrapper\r\n             return dispatch(args[0].__class__)(*args, **kw)\r\n           File \"edb/pgsql/compiler/expr.py\", line 60, in compile_Set\r\n             _compile_set_impl(ir_set, ctx=ctx)\r\n           File \"edb/pgsql/compiler/expr.py\", line 114, in _compile_set_impl\r\n             _compile_set(ir_set, ctx=ctx)\r\n           File \"edb/pgsql/compiler/expr.py\", line 633, in _compile_set\r\n             relgen.get_set_rvar(ir_set, ctx=ctx)\r\n           File \"edb/pgsql/compiler/relgen.py\", line 160, in get_set_rvar\r\n             return _process_toplevel_query(ir_set, ctx=ctx)\r\n           File \"edb/pgsql/compiler/relgen.py\", line 263, in _process_toplevel_query\r\n             rvars = _get_set_rvar(ir_set, ctx=ctx)\r\n           File \"edb/pgsql/compiler/relgen.py\", line 302, in _get_set_rvar\r\n             rvars = process_set_as_subquery(ir_set, stmt, ctx=ctx)\r\n           File \"edb/pgsql/compiler/relgen.py\", line 1349, in process_set_as_subquery\r\n             dispatch.visit(expr, ctx=newctx)\r\n           File \"python3.10/functools.py\", line 889, in wrapper\r\n             return dispatch(args[0].__class__)(*args, **kw)\r\n           File \"edb/pgsql/compiler/dispatch.py\", line 44, in visit\r\n             compile(ir, ctx=ctx)\r\n           File \"python3.10/functools.py\", line 889, in wrapper\r\n             return dispatch(args[0].__class__)(*args, **kw)\r\n           File \"edb/pgsql/compiler/stmt.py\", line 165, in compile_InsertStmt\r\n             dml.process_insert_body(\r\n           File \"edb/pgsql/compiler/dml.py\", line 796, in process_insert_body\r\n             policy_cte = compile_policy_check(\r\n           File \"edb/pgsql/compiler/dml.py\", line 842, in compile_policy_check\r\n             cond_ref = clauses.compile_filter_clause(\r\n           File \"edb/pgsql/compiler/clauses.py\", line 240, in compile_filter_clause\r\n             dispatch.visit(ir_set, ctx=subctx)\r\n           File \"python3.10/functools.py\", line 889, in wrapper\r\n             return dispatch(args[0].__class__)(*args, **kw)\r\n           File \"edb/pgsql/compiler/expr.py\", line 85, in visit_Set\r\n             _compile_set_impl(ir_set, ctx=ctx)\r\n           File \"edb/pgsql/compiler/expr.py\", line 114, in _compile_set_impl\r\n             _compile_set(ir_set, ctx=ctx)\r\n           File \"edb/pgsql/compiler/expr.py\", line 633, in _compile_set\r\n             relgen.get_set_rvar(ir_set, ctx=ctx)\r\n           File \"edb/pgsql/compiler/relgen.py\", line 207, in get_set_rvar\r\n             rvars = _get_set_rvar(ir_set, ctx=subctx)\r\n           File \"edb/pgsql/compiler/relgen.py\", line 412, in _get_set_rvar\r\n             rvars = process_set_as_oper_expr(ir_set, stmt, ctx=ctx)\r\n           File \"edb/pgsql/compiler/relgen.py\", line 2117, in process_set_as_oper_expr\r\n             args = _compile_call_args(ir_set, ctx=newctx)\r\n           File \"edb/pgsql/compiler/relgen.py\", line 3001, in _compile_call_args\r\n             arg_ref = dispatch.compile(ir_arg.expr, ctx=ctx)\r\n           File \"python3.10/functools.py\", line 889, in wrapper\r\n             return dispatch(args[0].__class__)(*args, **kw)\r\n           File \"edb/pgsql/compiler/expr.py\", line 60, in compile_Set\r\n             _compile_set_impl(ir_set, ctx=ctx)\r\n           File \"edb/pgsql/compiler/expr.py\", line 114, in _compile_set_impl\r\n             _compile_set(ir_set, ctx=ctx)\r\n           File \"edb/pgsql/compiler/expr.py\", line 633, in _compile_set\r\n             relgen.get_set_rvar(ir_set, ctx=ctx)\r\n           File \"edb/pgsql/compiler/relgen.py\", line 207, in get_set_rvar\r\n             rvars = _get_set_rvar(ir_set, ctx=subctx)\r\n           File \"edb/pgsql/compiler/relgen.py\", line 393, in _get_set_rvar\r\n             rvars = process_set_as_exists_expr(ir_set, stmt, ctx=ctx)\r\n           File \"edb/pgsql/compiler/relgen.py\", line 3410, in process_set_as_exists_expr\r\n             set_ref = dispatch.compile(ir_expr, ctx=subctx)\r\n           File \"python3.10/functools.py\", line 889, in wrapper\r\n             return dispatch(args[0].__class__)(*args, **kw)\r\n           File \"edb/pgsql/compiler/expr.py\", line 60, in compile_Set\r\n             _compile_set_impl(ir_set, ctx=ctx)\r\n           File \"edb/pgsql/compiler/expr.py\", line 110, in _compile_set_impl\r\n             _compile_set(ir_set, ctx=scopectx)\r\n           File \"edb/pgsql/compiler/expr.py\", line 633, in _compile_set\r\n             relgen.get_set_rvar(ir_set, ctx=ctx)\r\n           File \"edb/pgsql/compiler/relgen.py\", line 207, in get_set_rvar\r\n             rvars = _get_set_rvar(ir_set, ctx=subctx)\r\n           File \"edb/pgsql/compiler/relgen.py\", line 302, in _get_set_rvar\r\n             rvars = process_set_as_subquery(ir_set, stmt, ctx=ctx)\r\n           File \"edb/pgsql/compiler/relgen.py\", line 1349, in process_set_as_subquery\r\n             dispatch.visit(expr, ctx=newctx)\r\n           File \"python3.10/functools.py\", line 889, in wrapper\r\n             return dispatch(args[0].__class__)(*args, **kw)\r\n           File \"edb/pgsql/compiler/dispatch.py\", line 44, in visit\r\n             compile(ir, ctx=ctx)\r\n           File \"python3.10/functools.py\", line 889, in wrapper\r\n             return dispatch(args[0].__class__)(*args, **kw)\r\n           File \"edb/pgsql/compiler/stmt.py\", line 97, in compile_SelectStmt\r\n             outvar = clauses.compile_output(stmt.result, ctx=ictx)\r\n           File \"edb/pgsql/compiler/clauses.py\", line 219, in compile_output\r\n             val = pathctx.get_path_value_output(\r\n           File \"edb/pgsql/compiler/pathctx.py\", line 1273, in get_path_value_output\r\n             return get_path_output(rel, path_id, aspect='value', env=env)\r\n           File \"edb/pgsql/compiler/pathctx.py\", line 1079, in get_path_output\r\n             return _get_path_output(rel, path_id=path_id, aspect=aspect,\r\n           File \"edb/pgsql/compiler/pathctx.py\", line 1139, in _get_path_output\r\n             ref = get_path_var(rel, path_id, aspect=aspect, flavor=flavor, env=env)\r\n           File \"edb/pgsql/compiler/pathctx.py\", line 290, in get_path_var\r\n             outvar = get_path_output(\r\n           File \"edb/pgsql/compiler/pathctx.py\", line 1079, in get_path_output\r\n             return _get_path_output(rel, path_id=path_id, aspect=aspect,\r\n           File \"edb/pgsql/compiler/pathctx.py\", line 1139, in _get_path_output\r\n             ref = get_path_var(rel, path_id, aspect=aspect, flavor=flavor, env=env)\r\n           File \"edb/pgsql/compiler/pathctx.py\", line 260, in get_path_var\r\n             raise LookupError(\r\n         LookupError: there is no range var for (default::A) source in <pg.SelectStmt at 0x1157ece20>\r\n    \r\n         The above exception was the direct cause of the following exception:\r\n    \r\n         Traceback (most recent call last):\r\n           File \"edb/server/compiler_pool/worker_proc.py\", line 55, in worker\r\n             res = meth(*args)\r\n           File \"edb/server/compiler_pool/worker.py\", line 160, in compile\r\n             units, cstate = COMPILER.compile(\r\n           File \"edb/server/compiler/compiler.py\", line 2207, in compile\r\n             unit_group = self._compile(ctx=ctx, source=source)\r\n           File \"edb/server/compiler/compiler.py\", line 1738, in _compile\r\n             return self._try_compile(ctx=ctx, source=source)\r\n           File \"edb/server/compiler/compiler.py\", line 1802, in _try_compile\r\n             comp, capabilities = self._compile_dispatch_ql(\r\n           File \"edb/server/compiler/compiler.py\", line 1712, in _compile_dispatch_ql\r\n             query = self._compile_ql_query(ctx, ql, script_info=script_info)\r\n           File \"edb/server/compiler/compiler.py\", line 637, in _compile_ql_query\r\n             sql_text, argmap = pg_compiler.compile_ir_to_sql(\r\n           File \"edb/pgsql/compiler/__init__.py\", line 152, in compile_ir_to_sql\r\n             qtree = compile_ir_to_sql_tree(\r\n           File \"edb/pgsql/compiler/__init__.py\", line 135, in compile_ir_to_sql_tree\r\n             raise errors.InternalServerError(*args) from e\r\n         edb.errors.InternalServerError: there is no range var for (default::A) source in <pg.SelectStmt at 0x1157ece20>\r\n   ```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4219/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4219/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4107", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4107/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4107/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4107/events", "html_url": "https://github.com/edgedb/edgedb/issues/4107", "id": 1310107173, "node_id": "I_kwDOBbYNSM5OFqYl", "number": 4107, "title": "Properties or type `array<uuid>` are broken", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2022-07-19T22:22:39Z", "updated_at": "2022-07-22T04:45:41Z", "closed_at": "2022-07-22T04:45:41Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nedgedb> start migration to {\r\n....... module default {\r\n....... type Foo {\r\n....... property myArray -> array<uuid>;\r\n....... }; }; };\r\nOK: START MIGRATION\r\nedgedb[tx]> populate migration;\r\nedgedb error: SchemaError: Array ('d2a2fc36-29e2-20f2-9861-9f2633371c73') is already present in the schema <FlatSchema gen:1 at 0x7fd2da28fee0>\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4107/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4107/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4080", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/4080/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/4080/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/4080/events", "html_url": "https://github.com/edgedb/edgedb/issues/4080", "id": 1305731202, "node_id": "I_kwDOBbYNSM5N0-CC", "number": 4080, "title": "name field: expected <class 'edb.schema.name.QualName'> but got <UnqualName array<default|MultiLinkPerson>>", "user": {"login": "quinchs", "id": 49576606, "node_id": "MDQ6VXNlcjQ5NTc2NjA2", "avatar_url": "https://avatars.githubusercontent.com/u/49576606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/quinchs", "html_url": "https://github.com/quinchs", "followers_url": "https://api.github.com/users/quinchs/followers", "following_url": "https://api.github.com/users/quinchs/following{/other_user}", "gists_url": "https://api.github.com/users/quinchs/gists{/gist_id}", "starred_url": "https://api.github.com/users/quinchs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/quinchs/subscriptions", "organizations_url": "https://api.github.com/users/quinchs/orgs", "repos_url": "https://api.github.com/users/quinchs/repos", "events_url": "https://api.github.com/users/quinchs/events{/privacy}", "received_events_url": "https://api.github.com/users/quinchs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-07-15T08:18:55Z", "updated_at": "2022-09-19T20:56:40Z", "closed_at": "2022-09-19T20:56:40Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Summary\r\nWhile working on my query builder, I've encounter this exception thrown by the server\r\n\r\n### Versions\r\nEdgeDB running in WSL:\r\n- EdgeDB CLI 1.1.2+f38a6e0\r\n- Instance: 1.4+5ffe34b\r\n\r\n### OS\r\nWindows 10 21H2\r\n\r\n<details>\r\n<summary>Server stack trace</summary>\r\n\r\n```\r\nedgedb error: InternalServerError: name field: expected <class 'edb.schema.name.QualName'> but got <UnqualName array<default|MultiLinkPerson>>\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/server/compiler_pool/worker.py\", line 309, in worker\r\n          res = meth(*args)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/server/compiler_pool/worker.py\", line 177, in compile\r\n          units, cstate = COMPILER.compile(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 2105, in compile\r\n          units = self._compile(ctx=ctx, source=source)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1667, in _compile\r\n          return self._try_compile(ctx=ctx, source=source)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1720, in _try_compile\r\n          comp, capabilities = self._compile_dispatch_ql(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1641, in _compile_dispatch_ql\r\n          query = self._compile_ql_query(ctx, ql)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 568, in _compile_ql_query\r\n          ir = qlcompiler.compile_ast_to_ir(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/edgeql/compiler/__init__.py\", line 179, in wrapper\r\n          return func(*args, **kwargs)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/edgeql/compiler/__init__.py\", line 231, in compile_ast_to_ir\r\n          ir_set = dispatch_mod.compile(tree, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/edgeql/compiler/stmt.py\", line 212, in compile_ForQuery\r\n          compile_result_clause(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/edgeql/compiler/stmt.py\", line 1083, in compile_result_clause\r\n          expr = dispatch.compile(result_expr, ctx=ectx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/edgeql/compiler/stmt.py\", line 303, in compile_InsertQuery\r\n          stmt.subject = compile_query_subject(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/edgeql/compiler/stmt.py\", line 1219, in compile_query_subject\r\n          view_scls, expr = viewgen.process_view(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/edgeql/compiler/viewgen.py\", line 93, in process_view\r\n          view_scls, ir = _process_view(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/edgeql/compiler/viewgen.py\", line 178, in _process_view\r\n          pointer, ptr_set = _normalize_view_ptr_expr(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/edgeql/compiler/viewgen.py\", line 728, in _normalize_view_ptr_expr\r\n          irexpr, sub_view_rptr = _compile_qlexpr(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/edgeql/compiler/viewgen.py\", line 459, in _compile_qlexpr\r\n          irexpr = dispatch.compile(qlexpr, ctx=shape_expr_ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/edgeql/compiler/stmt.py\", line 110, in compile_SelectQuery\r\n          stmt.result = compile_result_clause(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/edgeql/compiler/stmt.py\", line 1083, in compile_result_clause\r\n          expr = dispatch.compile(result_expr, ctx=ectx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/edgeql/compiler/expr.py\", line 411, in compile_IfElse\r\n          return func.compile_operator(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/edgeql/compiler/func.py\", line 434, in compile_operator\r\n          matched = polyres.find_callable(opers, args=args, kwargs={}, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/edgeql/compiler/polyres.py\", line 88, in find_callable\r\n          call = try_bind_call_args(args, kwargs, candidate, ctx=ctx)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/edgeql/compiler/polyres.py\", line 333, in try_bind_call_args\r\n          cd = _get_cast_distance(arg_val, arg_type, param_type)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/edgeql/compiler/polyres.py\", line 185, in _get_cast_distance\r\n          resolved_poly_base_type.find_common_implicitly_castable_type(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/schema/types.py\", line 1258, in find_common_implicitly_castable_type\r\n          return type(self).from_subtypes(schema, [subtype])\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/schema/types.py\", line 1310, in from_subtypes\r\n          return cls.create(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/schema/types.py\", line 1150, in create\r\n          schema, result = super().create_in_schema(\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/schema/objects.py\", line 1125, in create_in_schema\r\n          value = field.coerce_value(schema, value)\r\n        File \"/home/edgedb/.local/share/edgedb/portable/1.4/lib/python3.10/site-packages/edb/schema/objects.py\", line 383, in coerce_value\r\n          raise TypeError(\r\n      TypeError: name field: expected <class 'edb.schema.name.QualName'> but got <UnqualName array<default|MultiLinkPerson>>\r\n```\r\n</details>\r\n\r\nQuery (its a bit messy)\r\n\r\n```sql\r\nwith JWRDXTXIRIIP_d1 := array_agg((for MLLRWMMHUGAF in json_array_unpack(<json>$OHUETNLZEXWG) union (insert MultiLinkPerson { name := <str>json_get(MLLRWMMHUGAF, 'Name'), email := <str>jso\r\nn_get(MLLRWMMHUGAF, 'Email'), best_friends := {} } unless conflict on .email else (select MultiLinkPerson)))) for x in json_array_unpack(<json>$WINVJKUCXDIV) union (insert MultiLinkPerson { name :\r\n= <str>json_get(x, 'Name'), email := <str>json_get(x, 'Email'), best_friends := JWRDXTXIRIIP_d1[<int64>json_get(x, 'BestFriends', 'JWRDXTXIRIIP_depth_from'):<int64>json_get(x, 'BestFriends', 'JWRD\r\nXTXIRIIP_depth_to')] if json_typeof(json_get(x, 'BestFriends')) != 'null' else <array<MultiLinkPerson>>[] });\r\n```\r\n\r\nType used within the query\r\n```\r\n  type MultiLinkPerson {\r\n    required property name -> str;\r\n    required property email -> str {\r\n      constraint exclusive;\r\n    }\r\n    multi link best_friends -> MultiLinkPerson;\r\n  }\r\n```\r\n\r\nThe error gets thrown by the `x if y else z` clause. Replacing the value with an empty set `{}` causes `InvalidTypeError: operator 'std::IF' cannot be applied to operands of type 'array<default::MultiLinkPerson>', 'std::bool', 'array<anytype>'`. Casting the empty set to `array<default::MultiLinkPerson>` causes the server exception to be thrown.\r\n\r\nSimple query to reproduce\r\n```\r\nwith test := [<MultiLinkPerson>{}]\r\nselect test if false else <array<MultiLinkPerson>>[];\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/4080/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/4080/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3955", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3955/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3955/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3955/events", "html_url": "https://github.com/edgedb/edgedb/issues/3955", "id": 1266720591, "node_id": "I_kwDOBbYNSM5LgJ9P", "number": 3955, "title": "Adding `order by` to `group` statement causes duplication", "user": {"login": "colinhacks", "id": 3084745, "node_id": "MDQ6VXNlcjMwODQ3NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/3084745?v=4", "gravatar_id": "", "url": "https://api.github.com/users/colinhacks", "html_url": "https://github.com/colinhacks", "followers_url": "https://api.github.com/users/colinhacks/followers", "following_url": "https://api.github.com/users/colinhacks/following{/other_user}", "gists_url": "https://api.github.com/users/colinhacks/gists{/gist_id}", "starred_url": "https://api.github.com/users/colinhacks/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/colinhacks/subscriptions", "organizations_url": "https://api.github.com/users/colinhacks/orgs", "repos_url": "https://api.github.com/users/colinhacks/repos", "events_url": "https://api.github.com/users/colinhacks/events{/privacy}", "received_events_url": "https://api.github.com/users/colinhacks/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-06-09T22:08:05Z", "updated_at": "2022-06-22T20:53:32Z", "closed_at": "2022-06-22T20:53:32Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: nightly\r\n- OS Version: macOS Catalina\r\n\r\nFirst query is identical to second except for inclusion of order by clause\r\n\r\n```\r\nedgedb> with groups := (\r\n.......   group Movie \r\n.......   by .release_year \r\n....... ) \r\n....... select groups {\r\n.......   key: {release_year},\r\n.......   grouping,\r\n.......   elements: {title}\r\n....... };\r\n{\r\n  {\r\n    key: {release_year: 2012},\r\n    grouping: {'release_year'},\r\n    elements: {default::Movie {title: 'The Avengers'}},\r\n  },\r\n  {\r\n    key: {release_year: 2016},\r\n    grouping: {'release_year'},\r\n    elements: {default::Movie {title: 'Captain America: Civil War'}},\r\n  },\r\n}\r\nedgedb> with groups := (\r\n.......   group Movie \r\n.......   by .release_year \r\n....... ) \r\n....... select groups {\r\n.......   key: {release_year},\r\n.......   grouping,\r\n.......   elements: {title}\r\n....... }\r\n....... order by .key.release_year;\r\n{\r\n  {\r\n    key: {release_year: 2012},\r\n    grouping: {'release_year'},\r\n    elements: {default::Movie {title: 'The Avengers'}},\r\n  },\r\n  {\r\n    key: {release_year: 2012},\r\n    grouping: {'release_year'},\r\n    elements: {default::Movie {title: 'Captain America: Civil War'}},\r\n  },\r\n  {\r\n    key: {release_year: 2016},\r\n    grouping: {'release_year'},\r\n    elements: {default::Movie {title: 'The Avengers'}},\r\n  },\r\n  {\r\n    key: {release_year: 2016},\r\n    grouping: {'release_year'},\r\n    elements: {default::Movie {title: 'Captain America: Civil War'}},\r\n  },\r\n}\r\n```\r\n\r\nThis behavior doesn't occur unless a shape is added:\r\n\r\n```\r\nedgedb> with groups := (\r\n.......   group Movie \r\n.......   by .release_year \r\n....... ) \r\n....... select groups\r\n....... order by .key.release_year;\r\n{{id: 7488f50b-3514-427c-ac4e-489e0de8cd2b}, {id: 4afaab18-062b-4b90-ad0f-0afde0b47116}}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3955/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3955/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3951", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3951/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3951/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3951/events", "html_url": "https://github.com/edgedb/edgedb/issues/3951", "id": 1265510433, "node_id": "I_kwDOBbYNSM5Lbigh", "number": 3951, "title": "ISE on `elements` subquery in `group`", "user": {"login": "colinhacks", "id": 3084745, "node_id": "MDQ6VXNlcjMwODQ3NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/3084745?v=4", "gravatar_id": "", "url": "https://api.github.com/users/colinhacks", "html_url": "https://github.com/colinhacks", "followers_url": "https://api.github.com/users/colinhacks/followers", "following_url": "https://api.github.com/users/colinhacks/following{/other_user}", "gists_url": "https://api.github.com/users/colinhacks/gists{/gist_id}", "starred_url": "https://api.github.com/users/colinhacks/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/colinhacks/subscriptions", "organizations_url": "https://api.github.com/users/colinhacks/orgs", "repos_url": "https://api.github.com/users/colinhacks/repos", "events_url": "https://api.github.com/users/colinhacks/events{/privacy}", "received_events_url": "https://api.github.com/users/colinhacks/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2022-06-09T02:29:37Z", "updated_at": "2022-10-19T05:06:18Z", "closed_at": "2022-10-19T05:06:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "A simple `group` statement implemented with the query builder may look like this:\r\n\r\n```ts\r\nconst group = e.group(e.Movie, movie => ({\r\n  ry: movie.release_year,\r\n}));\r\n```\r\n\r\nTo customize the shape of `elements`, users must wrap this in an outer select:\r\n\r\n```ts\r\nconst query = e.select(group, () => ({\r\n    key: true,\r\n    grouping: true,\r\n    elements: {\r\n      title: true,\r\n      release_year: true,\r\n    }\r\n  }));\r\n```\r\n\r\nThis produces the following query, which throws an `ISE: None`:\r\n\r\n```\r\nWITH\r\n  __scope_0_GroupResult := (\r\n    WITH\r\n      __scope_2_Movie := DETACHED default::Movie\r\n    GROUP __scope_2_Movie\r\n    USING\r\n      ry := __scope_2_Movie.release_year\r\n    BY ry\r\n  )\r\nSELECT __scope_0_GroupResult {\r\n  key,\r\n  grouping,\r\n  multi elements := (\r\n    WITH\r\n      __scope_1_Movie := __scope_0_GroupResult.elements\r\n    SELECT __scope_1_Movie {\r\n      title,\r\n      release_year\r\n    }\r\n  )\r\n};\r\n```\r\n\r\nA similar approach (where nested shapes are compiled to subqueries) works elsewhere. Full traceback:\r\n\r\n```\r\nedgedb error: InternalServerError: None\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/__init__.py\", line 118, in compile_ir_to_sql_tree\r\n          qtree = dispatch.compile(ir_expr, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 60, in compile_Set\r\n          _compile_set_impl(ir_set, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 114, in _compile_set_impl\r\n          _compile_set(ir_set, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 633, in _compile_set\r\n          relgen.get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 160, in get_set_rvar\r\n          return _process_toplevel_query(ir_set, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 263, in _process_toplevel_query\r\n          rvars = _get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 302, in _get_set_rvar\r\n          rvars = process_set_as_subquery(ir_set, stmt, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 1334, in process_set_as_subquery\r\n          dispatch.visit(expr, ctx=newctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/dispatch.py\", line 44, in visit\r\n          compile(ir, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/stmt.py\", line 97, in compile_SelectStmt\r\n          outvar = clauses.compile_output(stmt.result, ctx=ictx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/clauses.py\", line 204, in compile_output\r\n          dispatch.visit(ir_set, ctx=newctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 85, in visit_Set\r\n          _compile_set_impl(ir_set, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 110, in _compile_set_impl\r\n          _compile_set(ir_set, ctx=scopectx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 637, in _compile_set\r\n          _compile_shape(ir_set, ir_set.shape, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 656, in _compile_shape\r\n          result = shapecomp.compile_shape(ir_set, shape, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/shapecomp.py\", line 100, in compile_shape\r\n          wrapper = relgen.set_as_subquery(\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 482, in set_as_subquery\r\n          dispatch.visit(ir_set, ctx=subctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 85, in visit_Set\r\n          _compile_set_impl(ir_set, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 110, in _compile_set_impl\r\n          _compile_set(ir_set, ctx=scopectx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 633, in _compile_set\r\n          relgen.get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 207, in get_set_rvar\r\n          rvars = _get_set_rvar(ir_set, ctx=subctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 302, in _get_set_rvar\r\n          rvars = process_set_as_subquery(ir_set, stmt, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 1334, in process_set_as_subquery\r\n          dispatch.visit(expr, ctx=newctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/dispatch.py\", line 44, in visit\r\n          compile(ir, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/stmt.py\", line 97, in compile_SelectStmt\r\n          outvar = clauses.compile_output(stmt.result, ctx=ictx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/clauses.py\", line 204, in compile_output\r\n          dispatch.visit(ir_set, ctx=newctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 85, in visit_Set\r\n          _compile_set_impl(ir_set, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 110, in _compile_set_impl\r\n          _compile_set(ir_set, ctx=scopectx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 633, in _compile_set\r\n          relgen.get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 207, in get_set_rvar\r\n          rvars = _get_set_rvar(ir_set, ctx=subctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 302, in _get_set_rvar\r\n          rvars = process_set_as_subquery(ir_set, stmt, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 1334, in process_set_as_subquery\r\n          dispatch.visit(expr, ctx=newctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/dispatch.py\", line 44, in visit\r\n          compile(ir, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/stmt.py\", line 97, in compile_SelectStmt\r\n          outvar = clauses.compile_output(stmt.result, ctx=ictx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/clauses.py\", line 204, in compile_output\r\n          dispatch.visit(ir_set, ctx=newctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 85, in visit_Set\r\n          _compile_set_impl(ir_set, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 110, in _compile_set_impl\r\n          _compile_set(ir_set, ctx=scopectx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 633, in _compile_set\r\n          relgen.get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 207, in get_set_rvar\r\n          rvars = _get_set_rvar(ir_set, ctx=subctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 302, in _get_set_rvar\r\n          rvars = process_set_as_subquery(ir_set, stmt, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 1334, in process_set_as_subquery\r\n          dispatch.visit(expr, ctx=newctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/dispatch.py\", line 44, in visit\r\n          compile(ir, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/stmt.py\", line 97, in compile_SelectStmt\r\n          outvar = clauses.compile_output(stmt.result, ctx=ictx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/clauses.py\", line 204, in compile_output\r\n          dispatch.visit(ir_set, ctx=newctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/functools.py\", line 889, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 85, in visit_Set\r\n          _compile_set_impl(ir_set, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 110, in _compile_set_impl\r\n          _compile_set(ir_set, ctx=scopectx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/expr.py\", line 633, in _compile_set\r\n          relgen.get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 207, in get_set_rvar\r\n          rvars = _get_set_rvar(ir_set, ctx=subctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 296, in _get_set_rvar\r\n          rvars = process_set_as_subquery(ir_set, stmt, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 1301, in process_set_as_subquery\r\n          or _lookup_set_rvar_in_source(ir_set, source_set_rvar, ctx=ctx)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/relgen.py\", line 1205, in _lookup_set_rvar_in_source\r\n          if packed_ref := pathctx.maybe_get_rvar_path_var(\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/pathctx.py\", line 752, in maybe_get_rvar_path_var\r\n          return get_rvar_path_var(\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/pathctx.py\", line 735, in get_rvar_path_var\r\n          outvar = get_path_output(\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/pathctx.py\", line 1068, in get_path_output\r\n          return _get_path_output(rel, path_id=path_id, aspect=aspect,\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/pathctx.py\", line 1128, in _get_path_output\r\n          ref = get_path_var(rel, path_id, aspect=aspect, flavor=flavor, env=env)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/pathctx.py\", line 232, in get_path_var\r\n          src_aspect, rel_rvar, found_path_var = _find_rel_rvar(\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/pathctx.py\", line 352, in _find_rel_rvar\r\n          assert flavor == 'normal'\r\n      AssertionError\r\n      \r\n      The above exception was the direct cause of the following exception:\r\n      \r\n      Traceback (most recent call last):\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/server/compiler_pool/worker_proc.py\", line 55, in worker\r\n          res = meth(*args)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/server/compiler_pool/worker.py\", line 158, in compile\r\n          units, cstate = COMPILER.compile(\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 2142, in compile\r\n          units = self._compile(ctx=ctx, source=source)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1694, in _compile\r\n          return self._try_compile(ctx=ctx, source=source)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1747, in _try_compile\r\n          comp, capabilities = self._compile_dispatch_ql(\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1668, in _compile_dispatch_ql\r\n          query = self._compile_ql_query(ctx, ql)\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 614, in _compile_ql_query\r\n          sql_text, argmap = pg_compiler.compile_ir_to_sql(\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/__init__.py\", line 150, in compile_ir_to_sql\r\n          qtree = compile_ir_to_sql_tree(\r\n        File \"/Users/colinmcd94/Library/Application Support/edgedb/portable/2.0-dev.6625/lib/python3.10/site-packages/edb/pgsql/compiler/__init__.py\", line 133, in compile_ir_to_sql_tree\r\n          raise errors.InternalServerError(*args) from e\r\n      edb.errors.InternalServerError: None\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3951/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3951/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3898", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3898/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3898/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3898/events", "html_url": "https://github.com/edgedb/edgedb/issues/3898", "id": 1248389965, "node_id": "I_kwDOBbYNSM5KaOtN", "number": 3898, "title": "Incorrect result when joining on a property of a computed link", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2022-05-25T16:46:09Z", "updated_at": "2022-05-27T01:58:47Z", "closed_at": "2022-05-27T01:58:47Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Discussed in https://github.com/edgedb/edgedb/discussions/3897\r\n\r\n<div type='discussions-op-text'>\r\n\r\n<sup>Originally posted by **stregouet** May 25, 2022</sup>\r\nHi,\r\nI'm trying to query some of my data but I find strange behavior probably with `filter` clause which seems not so obvious to me.\r\n\r\nHere is my schema:\r\n\r\n```edgeql\r\nmodule default {\r\n  scalar type EventType extending str {\r\n    constraint one_of ('wall', 'water', 'electrity', 'other');\r\n  }\r\n\r\n  type Building {\r\n    required property number -> str {\r\n      constraint exclusive;\r\n    };\r\n\r\n    link last_wall := ( select .events filter .evtype = <EventType>'wall' order by .datetime desc limit 1 );\r\n    multi link events := .<building[is Event];\r\n  }\r\n\r\n  type Event {\r\n    required property datetime -> datetime;\r\n    property evtype -> EventType;\r\n    link building -> Building;\r\n  }\r\n}\r\n```\r\nwith some data\r\n\r\n```\r\nwith \r\n  b1 := (insert Building {\r\n    number := 'aa1',\r\n  })\r\ninsert Event {\r\n  datetime := <datetime>'2020-12-27T23:00:00Z',\r\n  evtype := <EventType>'wall',\r\n  building := b1,\r\n};\r\n\r\n\r\nwith b1 := (select Building filter .number = 'aa1')\r\ninsert Event {\r\n  datetime := <datetime>'2022-01-18T23:00:00Z',\r\n  evtype := <EventType>'wall',\r\n  building := b1,\r\n};\r\nwith b1 := (select Building filter .number = 'aa1')\r\ninsert Event {\r\n  datetime := <datetime>'2022-02-18T23:00:00Z',\r\n  evtype := <EventType>'water',\r\n  building := b1,\r\n};\r\n```\r\n\r\nand here is my query\r\n\r\n```edgeql\r\nselect Building { \r\n  number,\r\n  last_wall: { datetime }, \r\n  w := (with lw := .last_wall select .events  filter .datetime = lw.datetime) };\r\n```\r\nI expect to get one element in `w` field (because there is only one event with `last_wall` datetime). But I got 2 (the 2 with `evtype` of `wall`). To get only 1 I need to modify query as follow:\r\n\r\n```edgeql\r\nselect Building { \r\n  number,\r\n  last_wall: { datetime }, \r\n  w := (with lw := .last_wall select (.events.datetime,)  filter .0 = lw.datetime) };\r\n```\r\n\r\nI suppose I miss something but I can't find what, could you help please?</div>", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3898/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3898/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3888", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3888/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3888/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3888/events", "html_url": "https://github.com/edgedb/edgedb/issues/3888", "id": 1243771942, "node_id": "I_kwDOBbYNSM5KInQm", "number": 3888, "title": "`assert_exists` fails to trigger on single properties", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-05-20T23:03:58Z", "updated_at": "2022-05-27T01:12:52Z", "closed_at": "2022-05-27T01:12:52Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nedgedb> create type Foo { create property a -> str };\r\nOK: CREATE TYPE\r\nedgedb> insert Foo;\r\n{default::Foo {id: 03be41f4-d891-11ec-aa0a-07e61661297e}}\r\nedgedb> select Foo { a := assert_exists(.a) };\r\n{default::Foo {a: {}}}\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3888/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3888/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3859", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3859/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3859/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3859/events", "html_url": "https://github.com/edgedb/edgedb/issues/3859", "id": 1235719733, "node_id": "I_kwDOBbYNSM5Jp5Y1", "number": 3859, "title": "InternalServerError: maximum recursion depth exceeded in comparison", "user": {"login": "jaclarke", "id": 2085287, "node_id": "MDQ6VXNlcjIwODUyODc=", "avatar_url": "https://avatars.githubusercontent.com/u/2085287?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaclarke", "html_url": "https://github.com/jaclarke", "followers_url": "https://api.github.com/users/jaclarke/followers", "following_url": "https://api.github.com/users/jaclarke/following{/other_user}", "gists_url": "https://api.github.com/users/jaclarke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaclarke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaclarke/subscriptions", "organizations_url": "https://api.github.com/users/jaclarke/orgs", "repos_url": "https://api.github.com/users/jaclarke/repos", "events_url": "https://api.github.com/users/jaclarke/events{/privacy}", "received_events_url": "https://api.github.com/users/jaclarke/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2022-05-13T21:13:17Z", "updated_at": "2022-05-19T23:30:16Z", "closed_at": "2022-05-19T23:30:16Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: 2.0-dev.6578+local\r\n\r\nSteps to Reproduce:\r\n\r\n```edgeql\r\nSELECT default::Comment {\r\n  issue := assert_exists((SELECT .issue {\r\n    references := (SELECT .references LIMIT 1),\r\n    priority := (SELECT .priority LIMIT 1),\r\n    related_to := (SELECT .related_to LIMIT 1),\r\n    status := (SELECT .status LIMIT 1),\r\n    owner := (SELECT .owner LIMIT 1),\r\n    time_spent_log := (SELECT .time_spent_log LIMIT 1),\r\n    watchers := (SELECT .watchers LIMIT 1),\r\n  } LIMIT 10)),\r\n}\r\n\r\n# InternalServerError: maximum recursion depth exceeded in comparison\r\n```\r\n\r\nSchema: https://github.com/edgedb/edgedb/blob/master/tests/schemas/issues.esdl\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3859/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3859/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3844", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3844/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3844/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3844/events", "html_url": "https://github.com/edgedb/edgedb/issues/3844", "id": 1230327123, "node_id": "I_kwDOBbYNSM5JVU1T", "number": 3844, "title": "ISE on group", "user": {"login": "colinhacks", "id": 3084745, "node_id": "MDQ6VXNlcjMwODQ3NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/3084745?v=4", "gravatar_id": "", "url": "https://api.github.com/users/colinhacks", "html_url": "https://github.com/colinhacks", "followers_url": "https://api.github.com/users/colinhacks/followers", "following_url": "https://api.github.com/users/colinhacks/following{/other_user}", "gists_url": "https://api.github.com/users/colinhacks/gists{/gist_id}", "starred_url": "https://api.github.com/users/colinhacks/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/colinhacks/subscriptions", "organizations_url": "https://api.github.com/users/colinhacks/orgs", "repos_url": "https://api.github.com/users/colinhacks/repos", "events_url": "https://api.github.com/users/colinhacks/events{/privacy}", "received_events_url": "https://api.github.com/users/colinhacks/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2022-05-09T22:44:16Z", "updated_at": "2022-05-10T01:02:58Z", "closed_at": "2022-05-10T01:02:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 2.0-dev+6573\r\n- OS Version: macOS Catalina\r\n\r\nSteps to Reproduce:\r\n\r\nUsing Netflix schema: https://github.com/colinhacks/edgedb-movies\r\n\r\n```\r\nedgedb> group Movie\r\n....... using \r\n.......   cast_size := count(.actors)\r\n....... by cast_size, .release_year;\r\nedgedb error: InternalServerError: plan should not reference subplan's variable\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: plan should not reference subplan's variable\r\n```\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3844/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3844/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3819", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3819/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3819/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3819/events", "html_url": "https://github.com/edgedb/edgedb/issues/3819", "id": 1224665474, "node_id": "I_kwDOBbYNSM5I_umC", "number": 3819, "title": "ISE if index expression has a cast", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2022-05-03T21:16:48Z", "updated_at": "2022-05-09T18:37:01Z", "closed_at": "2022-05-04T17:56:34Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nedgedb> create type Artist { create property oid -> bigint; create index on (<str>.oid) };\r\nError: InternalServerError: syntax error at or near \"::\"\r\n```\r\n\r\nThis is because the underlying `CREATE INDEX` is generated as follows:\r\n\r\n```\r\nCREATE INDEX \"b6GKl3sIRH/PYIKyIki7qQ:11ec-9ea6-4df84086378a_index\" ON edgedbpub.\"9790a99b-cb25-11ec-9c22-c31f3cc13b16\" ((\"97935a4f-cb25-11ec-9573-010d1def5538\")::text NULLS FIRST);\r\nERROR:  syntax error at or near \"::\"\r\n```\r\n\r\nThis is fixed by adding a set of paretheses around the index expression.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3819/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3819/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3817", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3817/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3817/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3817/events", "html_url": "https://github.com/edgedb/edgedb/issues/3817", "id": 1224186850, "node_id": "I_kwDOBbYNSM5I95vi", "number": 3817, "title": "ISE in `foo IN array_unpack(<double-array-cast>)`", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-05-03T14:32:38Z", "updated_at": "2022-05-03T23:37:32Z", "closed_at": "2022-05-03T23:37:32Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nedgedb> select 1n in array_unpack(<array<bigint>><array<str>>to_json('[\"1\"]'));\r\nedgedb error: InternalServerError: syntax error at or near \"ANY\"\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: syntax error at or near \"ANY\"\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3817/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3817/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3794", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3794/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3794/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3794/events", "html_url": "https://github.com/edgedb/edgedb/issues/3794", "id": 1214740200, "node_id": "I_kwDOBbYNSM5IZ3bo", "number": 3794, "title": "`assert_single` causes nested `select`s to return wrong results", "user": {"login": "jaclarke", "id": 2085287, "node_id": "MDQ6VXNlcjIwODUyODc=", "avatar_url": "https://avatars.githubusercontent.com/u/2085287?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaclarke", "html_url": "https://github.com/jaclarke", "followers_url": "https://api.github.com/users/jaclarke/followers", "following_url": "https://api.github.com/users/jaclarke/following{/other_user}", "gists_url": "https://api.github.com/users/jaclarke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaclarke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaclarke/subscriptions", "organizations_url": "https://api.github.com/users/jaclarke/orgs", "repos_url": "https://api.github.com/users/jaclarke/repos", "events_url": "https://api.github.com/users/jaclarke/events{/privacy}", "received_events_url": "https://api.github.com/users/jaclarke/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2022-04-25T16:11:30Z", "updated_at": "2022-06-09T02:42:52Z", "closed_at": "2022-06-09T02:42:52Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: 1.3+5d0197d\r\n\r\nInvestigating this issue: https://github.com/edgedb/edgedb-js/issues/330\r\n\r\nThe query the querybuilder generates looks correct:\r\n```edgeql\r\nSELECT std::assert_single((WITH\r\n  __scope_0_teams := DETACHED default::teams\r\nSELECT __scope_0_teams {\r\n  id,\r\n  name,\r\n  slug,\r\n  team_users := (\r\n    WITH\r\n      __scope_1_team_users := __scope_0_teams.team_users\r\n    SELECT __scope_1_team_users {\r\n      id,\r\n      role,\r\n      user := (\r\n        WITH\r\n          __scope_2_users := __scope_1_team_users.user\r\n        SELECT __scope_2_users {\r\n          id,\r\n          name,\r\n          email\r\n        }\r\n        LIMIT 1\r\n      )\r\n    }\r\n  )\r\n}))\r\n```\r\nbut the result indeed has the wrong user for the second `team_users`:\r\n```json\r\n{\r\n  \"id\": \"4580ad20c4aa11ec8df6970388680a9f\",\r\n  \"name\": \"The A Team\",\r\n  \"slug\": \"team_a\",\r\n  \"team_users\": [\r\n    {\r\n      \"id\": \"0b42d696c4ab11ec991c1f2f1fdc585f\",\r\n      \"role\": \"Owner\",\r\n      \"user\": {\r\n        \"id\": \"9eb3c06cc4aa11ec8df6af1e7a7a74b3\",\r\n        \"name\": \"User a\",\r\n        \"email\": \"usera@example.com\"\r\n      }\r\n    },\r\n    {\r\n      \"id\": \"12876b42c4ab11ec991c632dd3ae1049\",\r\n      \"role\": \"Editor\",\r\n      \"user\": {\r\n        \"id\": \"9eb3c06cc4aa11ec8df6af1e7a7a74b3\",\r\n        \"name\": \"User a\",\r\n        \"email\": \"usera@example.com\"\r\n      }\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nWeirdly running the same query in repl returns the correct result:\r\n```\r\nedgedb> SELECT std::assert_single((WITH\r\n.......   __scope_0_teams := DETACHED default::teams\r\n....... SELECT __scope_0_teams {\r\n.......   id,\r\n.......   name,\r\n.......   slug,\r\n.......   team_users := (\r\n.......     WITH\r\n.......       __scope_1_team_users := __scope_0_teams.team_users\r\n.......     SELECT __scope_1_team_users {\r\n.......       id,\r\n.......       role,\r\n.......       user := (\r\n.......         WITH\r\n.......           __scope_2_users := __scope_1_team_users.user\r\n.......         SELECT __scope_2_users {\r\n.......           id,\r\n.......           name,\r\n.......           email\r\n.......         }\r\n.......         LIMIT 1\r\n.......       )\r\n.......     }\r\n.......   )\r\n....... }));\r\n{\r\n  default::teams {\r\n    id: 4580ad20-c4aa-11ec-8df6-970388680a9f,\r\n    name: 'The A Team',\r\n    slug: 'team_a',\r\n    team_users: {\r\n      default::team_users {\r\n        id: 0b42d696-c4ab-11ec-991c-1f2f1fdc585f,\r\n        role: Owner,\r\n        user: default::users {id: 9eb3c06c-c4aa-11ec-8df6-af1e7a7a74b3, name: 'User a', email: 'usera@example.com'},\r\n      },\r\n      default::team_users {\r\n        id: 12876b42-c4ab-11ec-991c-632dd3ae1049,\r\n        role: Editor,\r\n        user: default::users {id: 9eb3cb7a-c4aa-11ec-8df6-d3bbffd81bce, name: 'User b', email: 'userb@example.com'},\r\n      },\r\n    },\r\n  },\r\n}\r\n```\r\n\r\nBoth the js client/querybuilder and repl return the expected result if the wrapping `assert_single` is removed:\r\n```edgeql\r\nSELECT (WITH\r\n  __scope_0_teams := DETACHED default::teams\r\nSELECT __scope_0_teams {\r\n  id,\r\n  name,\r\n  slug,\r\n  team_users := (\r\n    WITH\r\n      __scope_1_team_users := __scope_0_teams.team_users\r\n    SELECT __scope_1_team_users {\r\n      id,\r\n      role,\r\n      user := (\r\n        WITH\r\n          __scope_2_users := __scope_1_team_users.user\r\n        SELECT __scope_2_users {\r\n          id,\r\n          name,\r\n          email\r\n        }\r\n        LIMIT 1\r\n      )\r\n    }\r\n  )\r\n})\r\n```\r\n```json\r\n[\r\n  {\r\n    \"id\": \"4580ad20c4aa11ec8df6970388680a9f\",\r\n    \"name\": \"The A Team\",\r\n    \"slug\": \"team_a\",\r\n    \"team_users\": [\r\n      {\r\n        \"id\": \"0b42d696c4ab11ec991c1f2f1fdc585f\",\r\n        \"role\": \"Owner\",\r\n        \"user\": {\r\n          \"id\": \"9eb3c06cc4aa11ec8df6af1e7a7a74b3\",\r\n          \"name\": \"User a\",\r\n          \"email\": \"usera@example.com\"\r\n        }\r\n      },\r\n      {\r\n        \"id\": \"12876b42c4ab11ec991c632dd3ae1049\",\r\n        \"role\": \"Editor\",\r\n        \"user\": {\r\n          \"id\": \"9eb3cb7ac4aa11ec8df6d3bbffd81bce\",\r\n          \"name\": \"User b\",\r\n          \"email\": \"userb@example.com\"\r\n        }\r\n      }\r\n    ]\r\n  }\r\n]\r\n```\r\n\r\nSchema:\r\n```edgeql\r\nCREATE MIGRATION m1twuydatkvh42y4fyomu6szyonvhcdtclydxvbzpzbv32ttkrvh3a\r\n    ONTO initial\r\n{\r\n  CREATE SCALAR TYPE default::TeamRole EXTENDING enum<Owner, Editor>;\r\n  CREATE TYPE default::team_users {\r\n      CREATE REQUIRED PROPERTY role -> default::TeamRole;\r\n  };\r\n  CREATE TYPE default::teams {\r\n      CREATE REQUIRED PROPERTY name -> std::str;\r\n      CREATE REQUIRED PROPERTY slug -> std::str {\r\n          CREATE CONSTRAINT std::exclusive;\r\n      };\r\n  };\r\n  ALTER TYPE default::team_users {\r\n      CREATE REQUIRED LINK team -> default::teams {\r\n          ON TARGET DELETE  DELETE SOURCE;\r\n      };\r\n  };\r\n  ALTER TYPE default::teams {\r\n      CREATE MULTI LINK team_users := (.<team[IS default::team_users]);\r\n  };\r\n  CREATE TYPE default::users {\r\n      CREATE REQUIRED PROPERTY email -> std::str {\r\n          CREATE CONSTRAINT std::exclusive;\r\n      };\r\n      CREATE REQUIRED PROPERTY name -> std::str;\r\n  };\r\n  ALTER TYPE default::team_users {\r\n      CREATE LINK user -> default::users {\r\n          ON TARGET DELETE  DELETE SOURCE;\r\n      };\r\n  };\r\n  ALTER TYPE default::users {\r\n      CREATE MULTI LINK team_memberships := (.<user[IS default::team_users]);\r\n  };\r\n\r\n  insert teams {\r\n    name := 'The A Team',\r\n    slug := 'team_a'\r\n  };\r\n\r\n  for x in {'a', 'b'} union (\r\n    insert users {\r\n      email := 'user' ++ x ++ '@example.com',\r\n      name := 'User ' ++ x\r\n    }\r\n  );\r\n\r\n  insert team_users {\r\n    user := (select users filter .email = 'usera@example.com'),\r\n    team := (select teams limit 1),\r\n    role := TeamRole.Owner\r\n  };\r\n  \r\n  insert team_users {\r\n    user := (select users filter .email = 'userb@example.com'),\r\n    team := (select teams limit 1),\r\n    role := TeamRole.Editor\r\n  };\r\n};\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3794/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3794/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3793", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3793/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3793/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3793/events", "html_url": "https://github.com/edgedb/edgedb/issues/3793", "id": 1213674862, "node_id": "I_kwDOBbYNSM5IVzVu", "number": 3793, "title": "ISE when casting a \"null\" JSON value to `std::bigint`.", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-04-24T14:47:09Z", "updated_at": "2022-05-05T21:08:14Z", "closed_at": "2022-05-05T21:08:14Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nselect <bigint>to_json('null');\r\n```\r\n\r\n```\r\nedgedb error: InternalServerError: RAISE statement option cannot be null\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: RAISE statement option cannot be null\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3793/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3793/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3789", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3789/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3789/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3789/events", "html_url": "https://github.com/edgedb/edgedb/issues/3789", "id": 1213560073, "node_id": "I_kwDOBbYNSM5IVXUJ", "number": 3789, "title": "Guaranteed ISE on nested insert on a `required multi link`", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2022-04-24T06:22:05Z", "updated_at": "2022-04-26T02:50:17Z", "closed_at": "2022-04-26T02:50:17Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Schema:\r\n\r\n```\r\nmodule default {\r\n    type B {\r\n        required multi link c -> default::C;\r\n    };\r\n    type C {\r\n        required property x -> std::int64;\r\n    };\r\n};\r\n```\r\n\r\nQuery:\r\n\r\n```\r\ninsert B {\r\n  c := (\r\n    for i in {(x := 90), (x := 240)}\r\n    union (\r\n      insert C {\r\n        x := i.x,\r\n      }\r\n    )\r\n  ),\r\n};\r\n```\r\n\r\nResult:\r\n\r\n```\r\nedgedb error: InternalServerError: duplicate key value violates unique constraint \"96db17f1-c393-11ec-81bf-b3f038f3cc4b_source_target_key\"\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: duplicate key value violates unique constraint \"96db17f1-c393-11ec-81bf-b3f038f3cc4b_source_target_key\"\r\n```\r\n\r\nContext in #3786 ", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3789/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3789/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3782", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3782/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3782/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3782/events", "html_url": "https://github.com/edgedb/edgedb/issues/3782", "id": 1212393040, "node_id": "I_kwDOBbYNSM5IQ6ZQ", "number": 3782, "title": "Query hangs with no error", "user": {"login": "haikyuu", "id": 8558836, "node_id": "MDQ6VXNlcjg1NTg4MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/8558836?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haikyuu", "html_url": "https://github.com/haikyuu", "followers_url": "https://api.github.com/users/haikyuu/followers", "following_url": "https://api.github.com/users/haikyuu/following{/other_user}", "gists_url": "https://api.github.com/users/haikyuu/gists{/gist_id}", "starred_url": "https://api.github.com/users/haikyuu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haikyuu/subscriptions", "organizations_url": "https://api.github.com/users/haikyuu/orgs", "repos_url": "https://api.github.com/users/haikyuu/repos", "events_url": "https://api.github.com/users/haikyuu/events{/privacy}", "received_events_url": "https://api.github.com/users/haikyuu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2022-04-22T13:50:14Z", "updated_at": "2022-06-24T04:02:36Z", "closed_at": "2022-06-24T04:02:35Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: `EdgeDB 1.3+804c096 (repl 1.1.1-dev.760+ee2c023)`\r\n- OS Version: latest Mac\r\n\r\nSteps to Reproduce:\r\n\r\n1. Run this (simplified) query (to access link annotations from a backlink)\r\n```\r\nwith module schema select Type {\r\n[IS ObjectType].links: {\r\n      indexes :{ name, id },\r\n      annotations :{ name, id },\r\n      ancestors :{ name, id },\r\n      bases :{ \r\n         name, id, __type__:{name},\r\n         [IS Link].annotations:{name, @value}\r\n      }\r\n   }\r\n} \r\n```\r\n\r\nIt just hangs, but it works with a smaller limit 10-20 and hangs with a limit 100 or no limit.\r\n\r\nHere are the logs I could get. These are probably from a previous run of the full query\r\n```\r\ncould not send data to client: Broken pipe\r\nINFO 53024 2022-04-22T15:30:48.943 postgres: WITH \"t~1\" AS NOT MATERIALIZED  ( (SELECT \"expr-4~2\".\"InheritingObject_value~1\" AS \"expr~4_value~1\", \"expr-4~2\".\"name_value~1\" AS \"name_value~2\", \"expr-4~2\".\"abstract_value~1\" AS \"abstract_value~2\", \"expr-4~2\".\"__type___identity~1\" AS \"__type___identity~2\" FROM LATERAL  (SELECT \"InheritingObject~3\".id AS \"InheritingObject_value~1\", \"InheritingObject~3\".\"f3e2ba1c-bda6-11ec-a933-7db634894ef6\" AS \"name_value~1\", \"InheritingObject~3\".\"f3e40e30-bda6-11ec-b69c-4574eb1d3317\" AS \"abstract_value~1\", \"InheritingObject~3\".__type__ AS \"__type___identity~1\" FROM edgedbstd.\"f3e0e55c-bda6-11ec-8415-f95288fe02a3_t\" AS \"InheritingObject~3\" CROSS JOIN LATERAL  (SELECT \"expr-2~2\".\"expr~2_value~1\" AS \"expr~2_value~2\" FROM LATERAL  (SELECT (NOT \"InheritingObject~3\".\"f3e2f89c-bda6-11ec-b734-f576b7f3ab84\") AS \"expr~2_value~1\" ) AS \"expr-2~2\" ) AS \"expr-3~2\" WHERE \"expr-3~2\".\"expr~2_value~2\" ) AS \"expr-4~2\" )), \"t~5\" AS NOT MATERIALIZED  ( (SELECT \"expr-34~2\".\"Type_value~1\" AS \"expr~34_identity~1\", \"expr-34~2\".\"name_value~6\" AS \"name_value~7\" FROM LATERAL  (SELECT \"Type~2\".id AS \"Type_value~1\", \"Type~2\".\"f28e4dfc-bda6-11ec-aca4-2141ab93c4c8\" AS \"name_value~6\" FROM edgedbstd.\"f28c6226-bda6-11ec-8630-914bc003340d_t\" AS \"Type~2\" CROSS JOIN LATERAL  (SELECT \"expr-32~2\".\"expr~32_value~1\" AS \"expr~32_value~2\" FROM LATERAL  (SELECT (NOT \"Type~2\".\"f28e86fa-bda6-11ec-abfb-c396f9a6653b\") AS \"expr~32_value~1\" ) AS \"expr-32~2\" ) AS \"expr-33~2\" WHERE \"expr-33~2\".\"expr~32_value~2\" ) AS \"expr-34~2\" )), \"t~10\" AS NOT MATERIALIZED  ( (SELECT \"expr-12~2\".\"ScalarType_value~1\" AS \"expr~12_identity~1\", \"expr-12~2\".\"enum_values_value~1\" AS \"enum_values_value~2\" FROM LATERAL  (SELECT \"ScalarType~2\".id AS \"ScalarType_value~1\", \"ScalarType~2\".\"f5ce0f0c-bda6-11ec-b697-fb7a98e4d909\" AS \"enum_values_value~1\" FROM edgedbstd.\"f5bbd986-bda6-11ec-b8dc-f97457aa9573_t\" AS \"ScalarType~2\" CROSS JOIN LATERAL  (SELECT \"expr-10~2\".\"expr~10_value~1\" AS \"expr~10_value~2\" FROM LATERAL  (SELECT (NOT \"ScalarType~2\".\"f5bf197a-bda6-11ec-836c-6171c0025d19\") AS \"expr~10_value~1\" ) AS \"expr-10~2\" ) AS \"expr-11~2\" WHERE \"expr-11~2\".\"expr~10_value~2\" ) AS \"expr-12~2\" )), \"t~12\" AS NOT MATERIALIZED  ( (SELECT \"expr-16~2\".\"Constraint_value~1\" AS \"expr~16_identity~1\", \"expr-16~2\".\"name_value~14\" AS \"name_value~15\", \"expr-16~2\".\"expr_serialized~1\" AS \"expr_serialized~2\", \"expr-16~2\".\"subject_identity~1\" AS \"subject_identity~2\", \"expr-16~2\".\"return_typemod_serialized~1\" AS \"return_typemod_serialized~2\", \"expr-16~2\".\"return_type_identity~1\" AS \"return_type_identity~2\", \"expr-16~2\".\"errmessage_serialized~1\" AS \"errmessage_serialized~2\" FROM LATERAL  (SELECT \"Constraint~2\".id AS \"Constraint_value~1\", \"Constraint~2\".\"f497f512-bda6-11ec-905a-5d55be18f4f5\" AS \"name_value~14\", \"Constraint~2\".\"f4a2ca14-bda6-11ec-a231-6bfdad7ffce0\" AS \"expr_serialized~1\", \"Constraint~2\".\"f4fc9756-bda6-11ec-a849-9b4f6e084269\" AS \"subject_identity~1\", \"Constraint~2\".\"f49d9ba2-bda6-11ec-86ce-4903a7e63962\" AS \"return_typemod_serialized~1\", \"Constraint~2\".\"f49cea7c-bda6-11ec-8e07-81bcfd0a8ae6\" AS \"return_type_identity~1\", \"Constraint~2\".\"f4a36ea6-bda6-11ec-9575-7b150fa5a82b\" AS \"errmessage_serialized~1\" FROM edgedbstd.\"f49572ba-bda6-11ec-ac29-ef9c0a94eee0_t\" AS \"Constraint~2\" CROSS JOIN LATERAL  (SELECT \"expr-14~2\".\"expr~14_value~1\" AS \"expr~14_value~2\" FROM LATERAL  (SELECT (NOT \"Constraint~2\".\"f4983e32-bda6-11ec-90e0-1fc6a34d0c48\") AS \"expr~14_value~1\" ) AS \"expr-14~2\" ) AS \"expr-15~2\" WHERE \"expr-15~2\".\"expr~14_value~2\" ) AS \"expr-16~2\" )), \"t~14\" AS NOT MATERIALIZED  ( (SELECT \"expr-20~2\".\"Annotation_value~1\" AS \"expr~20_identity~1\", \"expr-20~2\".\"name_value~18\" AS \"name_value~19\" FROM LATERAL  (SELECT \"Annotation~2\".id AS \"Annotation_value~1\", \"Annotation~2\".\"f3b0e44c-bda6-11ec-bffd-27dec7ca0819\" AS \"name_value~18\" FROM edgedbstd.\"f3af283c-bda6-11ec-9b14-998c69285076_t\" AS \"Annotation~2\" CROSS JOIN LATERAL  (SELECT \"expr-18~2\".\"expr~18_value~1\" AS \"expr~18_value~2\" FROM LATERAL  (SELECT (NOT \"Annotation~2\".\"f3b11872-bda6-11ec-8d49-650265303d0c\") AS \"expr~18_value~1\" ) AS \"expr-18~2\" ) AS \"expr-19~2\" WHERE \"expr-19~2\".\"expr~18_value~2\" ) AS \"expr-20~2\" )), \"t~16\" AS NOT MATERIALIZED  ( (SELECT \"expr-25~2\".\"ConsistencySubject_value~1\" AS \"expr~25_identity~1\", \"expr-25~2\".\"name_value~21\" AS \"name_value~22\" FROM LATERAL  (SELECT \"ConsistencySubject~2\".id AS \"ConsistencySubject_value~1\", \"ConsistencySubject~2\".\"f4dd5bfc-bda6-11ec-96d8-073148e8c55a\" AS \"name_value~21\" FROM edgedbstd.\"f4db97e0-bda6-11ec-8030-6b127f9e3775_t\" AS \"ConsistencySubject~2\" CROSS JOIN LATERAL  (SELECT \"expr-23~2\".\"expr~23_value~1\" AS \"expr~23_value~2\" FROM LATERAL  (SELECT (NOT \"ConsistencySubject~2\".\"f4dd8e2e-bda6-11ec-a337-2ded16291c6c\") AS \"expr~23_value~1\" ) AS \"expr-23~2\" ) AS \"expr-24~2\" WHERE \"expr-24~2\".\"expr~23_value~2\" ) AS \"expr-25~2\" )), \"t~18\" AS NOT MATERIALIZED  ( (SELECT \"expr-30~2\".\"Parameter_value~1\" AS \"expr~30_identity~1\", \"expr-30~2\".\"name_value~24\" AS \"name_value~25\", \"expr-30~2\".\"type_identity~1\" AS \"type_identity~2\" FROM LATERAL  (SELECT \"Parameter~2\".id AS \"Parameter_value~1\", \"Parameter~2\".\"f40a0fc2-bda6-11ec-b6a0-f1d5258f5bbe\" AS \"name_value~24\", \"Parameter~2\".\"f40bdb7c-bda6-11ec-962f-dbd5d60bcf66\" AS \"type_identity~1\" FROM edgedbstd.\"f4084fc0-bda6-11ec-bc15-7f963fbda5ef_t\" AS \"Parameter~2\" CROSS JOIN LATERAL  (SELECT \"expr-28~2\".\"expr~28_value~1\" AS \"expr~28_value~2\" FROM LATERAL  (SELECT (NOT \"Parameter~2\".\"f40a4474-bda6-11ec-b1cf-43822180c69a\") AS \"expr~28_value~1\" ) AS \"expr-28~2\" ) AS \"expr-29~2\" WHERE \"expr-29~2\".\"expr~28_value~2\" ) AS \"expr-30~2\" )) SELECT COALESCE(json_agg(\"InheritingObject_serialized~1\"), '[]') FROM (SELECT to_json(json_build_object('id', \"q~1\".\"expr~4_value~2\", 'name', \"q~1\".\"name_value~3\", 'is_abstract',  (SELECT to_json(\"bool_is_abstract~2\".\"expr~49_serialized~1\") AS \"is_abstract_serialized~1\" FROM LATERAL  (SELECT \"expr-49~2\".\"abstract_value~12\" AS \"expr~49_value~1\", \"expr-49~2\".\"abstract_serialized~5\" AS \"expr~49_serialized~1\" FROM LATERAL  (SELECT \"bool_abstract~4\".\"abstract_value~11\" AS \"abstract_value~12\", \"bool_abstract~4\".\"abstract_serialized~4\" AS \"abstract_serialized~5\" FROM LATERAL  (SELECT \"q~7\".\"abstract_value~10\" AS \"abstract_value~11\", \"q~7\".\"abstract_serialized~3\" AS \"abstract_serialized~4\" FROM LATERAL  (SELECT (\"m~1\" = first_value(\"m~1\") OVER ()) AS \"m~1\", \"q~6\".\"abstract_value~8\" AS \"abstract_value~10\", \"q~6\".\"abstract_serialized~1\" AS \"abstract_serialized~3\" FROM LATERAL  ( (SELECT 1 AS \"m~1\", \"q~5\".\"expr~47_value~2\" AS \"abstract_value~8\", \"q~5\".\"expr~47_value~2\" AS \"abstract_serialized~1\" FROM LATERAL  (SELECT \"expr-47~2\".\"expr~47_value~1\" AS \"expr~47_value~2\" FROM LATERAL  (SELECT \"q~3\".\"abstract_value~6\" AS \"abstract_value~7\" FROM LATERAL  (SELECT (\"m~2\" = first_value(\"m~2\") OVER ()) AS \"m~2\", \"q~2\".\"abstract_value~4\" AS \"abstract_value~6\" FROM LATERAL  ( (SELECT 1 AS \"m~2\", \"q~1\".\"abstract_value~3\" AS \"abstract_value~4\" WHERE (\"q~1\".\"abstract_value~3\" IS NOT NULL) ) UNION ALL  (SELECT 2 AS \"m~2\", \"v~2\".\"f3e40e30-bda6-11ec-b69c-4574eb1d3317~1\" AS \"abstract_value~5\" FROM (SELECT (NULL)::bool AS \"f3e40e30-bda6-11ec-b69c-4574eb1d3317~1\") AS \"v~2\" ) ) AS \"q~2\" ) AS \"q~3\" WHERE \"q~3\".\"m~2\" ) AS \"bool_abstract~3\" CROSS JOIN LATERAL  (SELECT COALESCE(\"bool_abstract~3\".\"abstract_value~7\", \"expr-46~2\".\"expr~45_value~2\") AS \"expr~47_value~1\" FROM LATERAL  (SELECT \"expr-45~2\".\"expr~45_value~1\" AS \"expr~45_value~2\" FROM LATERAL  (SELECT edgedbstd.\"std|cast@std|json@std|bool_f\"(\"expr-44~2\".\"expr~44_value~2\") AS \"expr~45_value~1\" FROM LATERAL  (SELECT \"q~4\".\"expr~44_value~1\" AS \"expr~44_value~2\" FROM LATERAL  (SELECT edgedbstd.\"f23327a6-bda6-11ec-bb3c-210187bb839c\"(('false')::text) AS \"expr~44_value~1\" ) AS \"q~4\" ) AS \"expr-44~2\" ) AS \"expr-45~2\" ) AS \"expr-46~2\" ) AS \"expr-47~2\" ) AS \"q~5\" WHERE (\"q~5\".\"expr~47_value~2\" IS NOT NULL) ) UNION ALL  (SELECT 2 AS \"m~1\", \"v~1\".\"f3e40e30-bda6-11ec-b69c-4574eb1d3317~2\" AS \"abstract_value~9\", \"v~1\".\"f3e40e30-bda6-11ec-b69c-4574eb1d3317~2\" AS \"abstract_serialized~2\" FROM (SELECT (NULL)::bool AS \"f3e40e30-bda6-11ec-b69c-4574eb1d3317~2\") AS \"v~1\" ) ) AS \"q~6\" ) AS \"q~7\" WHERE \"q~7\".\"m~1\" ) AS \"bool_abstract~4\" ) AS \"expr-49~2\" ) AS \"bool_is_abstract~2\" ), 'bases',  (SELECT COALESCE(array_agg(\"aggw~1\".\"bases_serialized~2\"), (ARRAY[])::json[]) AS \"v~3\" FROM (SELECT to_json(\"InheritingObject_bases~3\".\"bases_serialized~1\") AS \"bases_serialized~2\" FROM LATERAL  (SELECT \"q~8\".\"expr~4_identity~1\" AS \"bases_value~1\", json_build_object('id', \"q~8\".\"expr~4_identity~1\", 'name', \"q~8\".\"name_value~4\") AS \"bases_serialized~1\" FROM edgedbstd.\"f3e70a86-bda6-11ec-93bf-b95ed62a59ec_t\" AS \"bases~1\" INNER JOIN LATERAL  (SELECT \"t~3\".\"expr~4_value~1\" AS \"expr~4_identity~1\", \"t~3\".\"name_value~2\" AS \"name_value~4\" FROM \"t~1\" AS \"t~3\" ) AS \"q~8\" ON (\"bases~1\".target = \"q~8\".\"expr~4_identity~1\") WHERE (\"q~1\".\"expr~4_value~2\" = \"bases~1\".source) ) AS \"InheritingObject_bases~3\" ) AS \"aggw~1\" ), 'ancestors',  (SELECT COALESCE(array_agg(\"aggw~2\".\"ancestors_serialized~2\"), (ARRAY[])::json[]) AS \"v~4\" FROM (SELECT to_json(\"InheritingObject_ancestors~3\".\"ancestors_serialized~1\") AS \"ancestors_serialized~2\" FROM LATERAL  (SELECT \"q~9\".\"expr~4_identity~2\" AS \"ancestors_value~1\", json_build_object('id', \"q~9\".\"expr~4_identity~2\", 'name', \"q~9\".\"name_value~5\") AS \"ancestors_serialized~1\" FROM edgedbstd.\"f3e7dd62-bda6-11ec-9505-352d4814691e_t\" AS \"ancestors~1\" INNER JOIN LATERAL  (SELECT \"t~4\".\"expr~4_value~1\" AS \"expr~4_identity~2\", \"t~4\".\"name_value~2\" AS \"name_value~5\" FROM \"t~1\" AS \"t~4\" ) AS \"q~9\" ON (\"ancestors~1\".target = \"q~9\".\"expr~4_identity~2\") WHERE (\"q~1\".\"expr~4_value~2\" = \"ancestors~1\".source) ) AS \"InheritingObject_ancestors~3\" ) AS \"aggw~2\" ), 'children',  (SELECT COALESCE(array_agg(\"aggw~3\".\"children_serialized~1\"), (ARRAY[])::json[]) AS \"v~5\" FROM (SELECT to_json(\"J+C32mHmZBQMsyiU69F2uQ:t) & schema:Type)_children~1\".\"indirection_serialized~1\") AS \"children_serialized~1\" FROM LATERAL  (SELECT \"3dvufKQE6OPIGuOn31W3HQ:& schema:Type)_indirection~1\".\"bases_value~2\" AS \"indirection_value~1\", json_build_object('id', \"3dvufKQE6OPIGuOn31W3HQ:& schema:Type)_indirection~1\".\"bases_value~2\", 'name', \"3dvufKQE6OPIGuOn31W3HQ:& schema:Type)_indirection~1\".\"name_value~10\") AS \"indirection_serialized~1\" FROM LATERAL  (SELECT \"q~12\".\"bases_identity~1\" AS \"bases_value~2\", \"q~12\".\"name_value~9\" AS \"name_value~10\" FROM edgedbstd.\"f3e70a86-bda6-11ec-93bf-b95ed62a59ec_t\" AS \"bases~2\" INNER JOIN LATERAL  (SELECT \"q~11\".\"expr~4_identity~3\" AS \"bases_identity~1\", \"q~10\".\"name_value~8\" AS \"name_value~9\" FROM LATERAL  (SELECT \"t~6\".\"expr~34_identity~1\" AS \"expr~34_identity~2\", \"t~6\".\"name_value~7\" AS \"name_value~8\" FROM \"t~5\" AS \"t~6\" ) AS \"q~10\" INNER JOIN  (SELECT \"t~7\".\"expr~4_value~1\" AS \"expr~4_identity~3\" FROM \"t~1\" AS \"t~7\" ) AS \"q~11\" ON (\"q~10\".\"expr~34_identity~2\" = \"q~11\".\"expr~4_identity~3\") ) AS \"q~12\" ON (\"bases~2\".source = \"q~12\".\"bases_identity~1\") WHERE (\"q~1\".\"expr~4_value~2\" = \"bases~2\".target) ) AS \"3dvufKQE6OPIGuOn31W3HQ:& schema:Type)_indirection~1\" ) AS \"J+C32mHmZBQMsyiU69F2uQ:t) & schema:Type)_children~1\" ) AS \"aggw~3\" ), 'descendants',  (SELECT COALESCE(array_agg(\"aggw~4\".\"descendants_serialized~1\"), (ARRAY[])::json[]) AS \"v~6\" FROM (SELECT to_json(\"aCPq+F2wD6CXODNZ384Vmw:& schema:Type)_descendants~1\".\"indirection_serialized~2\") AS \"descendants_serialized~1\" FROM LATERAL  (SELECT \"N07HXWjb75ZYuajOdy+G3A:& schema:Type)_indirection~1\".\"ancestors_value~2\" AS \"indirection_value~2\", json_build_object('id', \"N07HXWjb75ZYuajOdy+G3A:& schema:Type)_indirection~1\".\"ancestors_value~2\", 'name', \"N07HXWjb75ZYuajOdy+G3A:& schema:Type)_indirection~1\".\"name_value~13\") AS \"indirection_serialized~2\" FROM LATERAL  (SELECT \"q~15\".\"ancestors_identity~1\" AS \"ancestors_value~2\", \"q~15\".\"name_value~12\" AS \"name_value~13\" FROM edgedbstd.\"f3e7dd62-bda6-11ec-9505-352d4814691e_t\" AS \"ancestors~2\" INNER JOIN LATERAL  (SELECT \"q~14\".\"expr~4_identity~4\" AS \"ancestors_identity~1\", \"q~13\".\"name_value~11\" AS \"name_value~12\" FROM LATERAL  (SELECT \"t~8\".\"expr~34_identity~1\" AS \"expr~34_identity~3\", \"t~8\".\"name_value~7\" AS \"name_value~11\" FROM \"t~5\" AS \"t~8\" ) AS \"q~13\" INNER JOIN  (SELECT \"t~9\".\"expr~4_value~1\" AS \"expr~4_identity~4\" FROM \"t~1\" AS \"t~9\" ) AS \"q~14\" ON (\"q~13\".\"expr~34_identity~3\" = \"q~14\".\"expr~4_identity~4\") ) AS \"q~15\" ON (\"ancestors~2\".source = \"q~15\".\"ancestors_identity~1\") WHERE (\"q~1\".\"expr~4_value~2\" = \"ancestors~2\".target) ) AS \"N07HXWjb75ZYuajOdy+G3A:& schema:Type)_indirection~1\" ) AS \"aCPq+F2wD6CXODNZ384Vmw:& schema:Type)_descendants~1\" ) AS \"aggw~4\" ), 'constraints',  (SELECT COALESCE(array_agg(\"aggw~7\".\"constraints_serialized~2\"), (ARRAY[])::json[]) AS \"v~9\" FROM (SELECT to_json(\"Constraint_constraints~4\".\"constraints_serialized~1\") AS \"constraints_serialized~2\" FROM LATERAL  (SELECT \"Constraint_constraints~3\".\"constraints_value~1\" AS \"constraints_value~2\", json_build_object('name', \"Constraint_constraints~3\".\"name_value~17\", 'expr',  (SELECT to_json(\"Constraint_constraints~3\".\"expr_serialized~4\") AS \"expr_serialized~5\" ), 'annotations',  (SELECT COALESCE(array_agg(\"aggw~5\".\"annotations_serialized~2\"), (ARRAY[])::json[]) AS \"v~7\" FROM (SELECT to_json(\"Annotation_annotations~3\".\"annotations_serialized~1\") AS \"annotations_serialized~2\" FROM LATERAL  (SELECT \"q~18\".\"expr~20_identity~2\" AS \"annotations_value~1\", json_build_object('name', \"q~18\".\"name_value~20\", '@value',  (SELECT to_json(\"annotations~1\".\"f49bcc1e-bda6-11ec-a8ed-43fc92edca27\") AS \"value_serialized~1\" )) AS \"annotations_serialized~1\" FROM edgedbstd.\"f49a2f58-bda6-11ec-97ba-b18dd943a597_t\" AS \"annotations~1\" INNER JOIN LATERAL  (SELECT \"t~15\".\"expr~20_identity~1\" AS \"expr~20_identity~2\", \"t~15\".\"name_value~19\" AS \"name_value~20\" FROM \"t~14\" AS \"t~15\" ) AS \"q~18\" ON (\"annotations~1\".target = \"q~18\".\"expr~20_identity~2\") WHERE (\"Constraint_constraints~3\".\"constraints_value~1\" = \"annotations~1\".source) ) AS \"Annotation_annotations~3\" ) AS \"aggw~5\" ), 'subject',  (SELECT to_json(\"ConsistencySubject_subject~3\".\"subject_serialized~1\") AS \"subject_serialized~2\" FROM LATERAL  (SELECT \"q~20\".\"expr~25_identity~2\" AS \"subject_value~1\", json_build_object('name', \"q~20\".\"name_value~23\", 'id', \"Constraint_constraints~3\".\"subject_identity~4\") AS \"subject_serialized~1\" FROM LATERAL  (SELECT \"Constraint_constraints~3\".\"subject_identity~4\" AS \"subject_identity~5\" ) AS \"q~19\" INNER JOIN LATERAL  (SELECT \"t~17\".\"expr~25_identity~1\" AS \"expr~25_identity~2\", \"t~17\".\"name_value~22\" AS \"name_value~23\" FROM \"t~16\" AS \"t~17\" ) AS \"q~20\" ON (\"q~19\".\"subject_identity~5\" = \"q~20\".\"expr~25_identity~2\") ) AS \"ConsistencySubject_subject~3\" ), 'params',  (SELECT COALESCE(array_agg(\"aggw~6\".\"params_serialized~2\"), (ARRAY[])::json[]) AS \"v~8\" FROM (SELECT to_json(\"Parameter_params~3\".\"params_serialized~1\") AS \"params_serialized~2\" FROM LATERAL  (SELECT \"q~21\".\"expr~30_identity~2\" AS \"params_value~1\", json_build_object('name', \"q~21\".\"name_value~26\", 'type',  (SELECT to_json(\"Type_type~3\".\"type_serialized~1\") AS \"type_serialized~2\" FROM LATERAL  (SELECT \"q~23\".\"expr~34_identity~4\" AS \"type_value~1\", json_build_object('name', \"q~23\".\"name_value~27\") AS \"type_serialized~1\" FROM LATERAL  (SELECT \"q~21\".\"type_identity~3\" AS \"type_identity~4\" ) AS \"q~22\" INNER JOIN LATERAL  (SELECT \"t~20\".\"expr~34_identity~1\" AS \"expr~34_identity~4\", \"t~20\".\"name_value~7\" AS \"name_value~27\" FROM \"t~5\" AS \"t~20\" ) AS \"q~23\" ON (\"q~22\".\"type_identity~4\" = \"q~23\".\"expr~34_identity~4\") ) AS \"Type_type~3\" ), '@value',  (SELECT to_json(\"params~1\".\"f4a285d6-bda6-11ec-a8de-b7c1c1abcd22\") AS \"value_serialized~2\" )) AS \"params_serialized~1\" FROM edgedbstd.\"f49c0800-bda6-11ec-92eb-512807bbd815_t\" AS \"params~1\" INNER JOIN LATERAL  (SELECT \"t~19\".\"expr~30_identity~1\" AS \"expr~30_identity~2\", \"t~19\".\"name_value~25\" AS \"name_value~26\", \"t~19\".\"type_identity~2\" AS \"type_identity~3\" FROM \"t~18\" AS \"t~19\" ) AS \"q~21\" ON (\"params~1\".target = \"q~21\".\"expr~30_identity~2\") WHERE (\"Constraint_constraints~3\".\"constraints_value~1\" = \"params~1\".source) ) AS \"Parameter_params~3\" ) AS \"aggw~6\" ), 'return_typemod',  (SELECT to_json(\"Constraint_constraints~3\".\"return_typemod_serialized~4\") AS \"return_typemod_serialized~5\" ), 'return_type',  (SELECT to_json(\"Type_return_type~3\".\"return_type_serialized~1\") AS \"return_type_serialized~2\" FROM LATERAL  (SELECT \"q~25\".\"expr~34_identity~5\" AS \"return_type_value~1\", json_build_object('name', \"q~25\".\"name_value~28\") AS \"return_type_serialized~1\" FROM LATERAL  (SELECT \"Constraint_constraints~3\".\"return_type_identity~4\" AS \"return_type_identity~5\" ) AS \"q~24\" INNER JOIN LATERAL  (SELECT \"t~21\".\"expr~34_identity~1\" AS \"expr~34_identity~5\", \"t~21\".\"name_value~7\" AS \"name_value~28\" FROM \"t~5\" AS \"t~21\" ) AS \"q~25\" ON (\"q~24\".\"return_type_identity~5\" = \"q~25\".\"expr~34_identity~5\") ) AS \"Type_return_type~3\" ), 'errmessage',  (SELECT to_json(\"Constraint_constraints~3\".\"errmessage_serialized~4\") AS \"errmessage_serialized~5\" )) AS \"constraints_serialized~1\" FROM LATERAL  (SELECT \"q~17\".\"expr~16_identity~2\" AS \"constraints_value~1\", \"q~17\".\"name_value~16\" AS \"name_value~17\", \"q~17\".\"expr_serialized~3\" AS \"expr_serialized~4\", \"q~17\".\"subject_identity~3\" AS \"subject_identity~4\", \"q~17\".\"return_typemod_serialized~3\" AS \"return_typemod_serialized~4\", \"q~17\".\"return_type_identity~3\" AS \"return_type_identity~4\", \"q~17\".\"errmessage_serialized~3\" AS \"errmessage_serialized~4\" FROM LATERAL  (SELECT \"t~13\".\"expr~16_identity~1\" AS \"expr~16_identity~2\", \"t~13\".\"name_value~15\" AS \"name_value~16\", \"t~13\".\"expr_serialized~2\" AS \"expr_serialized~3\", \"t~13\".\"subject_identity~2\" AS \"subject_identity~3\", \"t~13\".\"return_typemod_serialized~2\" AS \"return_typemod_serialized~3\", \"t~13\".\"return_type_identity~2\" AS \"return_type_identity~3\", \"t~13\".\"errmessage_serialized~2\" AS \"errmessage_serialized~3\" FROM \"t~12\" AS \"t~13\" ) AS \"q~17\" WHERE (\"q~17\".\"expr~16_identity~2\" IN  (SELECT \"constraints~1\".target AS \"constraints_identity~1\" FROM LATERAL  (SELECT \"q~16\".\"expr~12_identity~2\" AS \"indirection_identity~1\" FROM LATERAL  (SELECT \"t~11\".\"expr~12_identity~1\" AS \"expr~12_identity~2\" FROM \"t~10\" AS \"t~11\" ) AS \"q~16\" WHERE (\"q~1\".\"expr~4_value~2\" = \"q~16\".\"expr~12_identity~2\") ) AS \"ScalarType_indirection~2\" INNER JOIN edgedbstd.\"f5c63dd6-bda6-11ec-8068-510c8c7ce91c_t\" AS \"constraints~1\" ON (\"ScalarType_indirection~2\".\"indirection_identity~1\" = \"constraints~1\".source) )) ) AS \"Constraint_constraints~3\" ) AS \"Constraint_constraints~4\" ) AS \"aggw~7\" ), 'annotations',  (SELECT COALESCE(array_agg(\"aggw~8\".\"annotations_serialized~4\"), (ARRAY[])::json[]) AS \"v~10\" FROM (SELECT to_json(\"Annotation_annotations~7\".\"annotations_serialized~3\") AS \"annotations_serialized~4\" FROM LATERAL  (SELECT \"Annotation_annotations~6\".\"annotations_value~2\" AS \"annotations_value~3\", json_build_object('name', \"Annotation_annotations~6\".\"name_value~30\", '@value',  (SELECT to_json(\"annotations~3\".\"f5cb54c4-bda6-11ec-a51d-ad403d1c1791\") AS \"value_serialized~3\" FROM edgedbstd.\"f5c9abce-bda6-11ec-b32b-81f9f3f59a0f_t\" AS \"annotations~3\" WHERE (\"Annotation_annotations~6\".\"annotations_value~2\" = \"annotations~3\".target) )) AS \"annotations_serialized~3\" FROM LATERAL  (SELECT \"q~27\".\"expr~20_identity~3\" AS \"annotations_value~2\", \"q~27\".\"name_value~29\" AS \"name_value~30\" FROM LATERAL  (SELECT \"t~23\".\"expr~20_identity~1\" AS \"expr~20_identity~3\", \"t~23\".\"name_value~19\" AS \"name_value~29\" FROM \"t~14\" AS \"t~23\" ) AS \"q~27\" WHERE (\"q~27\".\"expr~20_identity~3\" IN  (SELECT \"annotations~2\".target AS \"annotations_identity~1\" FROM LATERAL  (SELECT \"q~26\".\"expr~12_identity~3\" AS \"indirection_identity~2\" FROM LATERAL  (SELECT \"t~22\".\"expr~12_identity~1\" AS \"expr~12_identity~3\" FROM \"t~10\" AS \"t~22\" ) AS \"q~26\" WHERE (\"q~1\".\"expr~4_value~2\" = \"q~26\".\"expr~12_identity~3\") ) AS \"ScalarType_indirection~4\" INNER JOIN edgedbstd.\"f5c9abce-bda6-11ec-b32b-81f9f3f59a0f_t\" AS \"annotations~2\" ON (\"ScalarType_indirection~4\".\"indirection_identity~2\" = \"annotations~2\".source) )) ) AS \"Annotation_annotations~6\" ) AS \"Annotation_annotations~7\" ) AS \"aggw~8\" ), 'enum_values',  (SELECT to_json(\"array<std|str>_enum_values~4\".\"enum_values_value~7\") AS \"enum_values_serialized~1\" FROM LATERAL  (SELECT \"array<std|str>_enum_values~3\".\"enum_values_value~6\" AS \"enum_values_value~7\" FROM LATERAL  (SELECT \"q~29\".\"enum_values_value~5\" AS \"enum_values_value~6\" FROM LATERAL  (SELECT \"ScalarType_indirection~6\".\"enum_values_value~4\" AS \"enum_values_value~5\" FROM LATERAL  (SELECT \"q~28\".\"enum_values_value~3\" AS \"enum_values_value~4\" FROM LATERAL  (SELECT \"t~24\".\"expr~12_identity~1\" AS \"expr~12_identity~4\", \"t~24\".\"enum_values_value~2\" AS \"enum_values_value~3\" FROM \"t~10\" AS \"t~24\" ) AS \"q~28\" WHERE (\"q~1\".\"expr~4_value~2\" = \"q~28\".\"expr~12_identity~4\") ) AS \"ScalarType_indirection~6\" WHERE (\"ScalarType_indirection~6\".\"enum_values_value~4\" IS NOT NULL) ) AS \"q~29\" ) AS \"array<std|str>_enum_values~3\" ) AS \"array<std|str>_enum_values~4\" ))) AS \"InheritingObject_serialized~1\" FROM (SELECT \"t~2\".\"expr~4_value~1\" AS \"expr~4_value~2\", \"t~2\".\"name_value~2\" AS \"name_value~3\", \"t~2\".\"abstract_value~2\" AS \"abstract_value~3\", \"t~2\".\"__type___identity~2\" AS \"__type___identity~3\" FROM \"t~1\" AS \"t~2\" ) AS \"q~1\" CROSS JOIN LATERAL  (SELECT (\"expr-51~2\".\"expr~51_value~1\" OR  \"expr-53~2\".\"expr~53_value~1\") AS \"expr~55_value~1\" FROM LATERAL  (SELECT \"q~1\".\"__type___identity~3\" AS \"__type___identity~4\" ) AS \"q~30\" INNER JOIN LATERAL  (SELECT \"t~25\".\"expr~34_identity~1\" AS \"expr~34_identity~6\" FROM \"t~5\" AS \"t~25\" ) AS \"q~31\" ON (\"q~30\".\"__type___identity~4\" = \"q~31\".\"expr~34_identity~6\") CROSS JOIN LATERAL  (SELECT edgedb.issubclass(\"q~31\".\"expr~34_identity~6\", ('f5bbd986-bda6-11ec-b8dc-f97457aa9573')::uuid) AS \"expr~51_value~1\" ) AS \"expr-51~2\" CROSS JOIN LATERAL  (SELECT edgedb.issubclass(\"q~31\".\"expr~34_identity~6\", ('f612acca-bda6-11ec-8e5f-3563f6b3294c')::uuid) AS \"expr~53_value~1\" ) AS \"expr-53~2\" ) AS \"expr-55~2\" WHERE \"expr-55~2\".\"expr~55_value~1\" ) AS \"aggw~9\"\r\nCRITICAL 53024 2022-04-22T15:30:48.944 postgres: connection to client lost\r\nINFO 53013 2022-04-22T15:30:49.938 edb.server: Backend connections to database edgedb: 3 were discarded, 3 were established in at least the last 1.0 seconds.\r\nERROR 53024 2022-04-22T15:31:21.663 postgres: more than one row returned by a subquery used as an expression\r\n```\r\n\r\nHere is the full query. The error does occur with the simplified one as well. But I'm including it for reference. The query is a slightly modified version of the first query in `getTypes` in the typescript query builder.\r\n\r\n```\r\nWITH\r\n      MODULE schema,\r\n\r\n      material_scalars := (\r\n        SELECT ScalarType\r\n        FILTER\r\n          (.name LIKE 'std::%' OR .name LIKE 'cal::%')\r\n          AND NOT .is_abstract\r\n      )\r\n\r\n    SELECT Type {\r\n      id,\r\n      name,\r\n      is_abstract,\r\n\r\n      kind := 'object' IF Type IS ObjectType ELSE\r\n              'scalar' IF Type IS ScalarType ELSE\r\n              'array' IF Type IS Array ELSE\r\n              'tuple' IF Type IS Tuple ELSE\r\n              'unknown',\r\n      [IS ScalarType].constraints: {\r\n        name,\r\n        expr,\r\n        annotations: { name, @value },\r\n        subject: { name, id },\r\n        params: { name, @value, type: { name } },\r\n        return_typemod,\r\n        return_type: { name },\r\n        errmessage,\r\n      },\r\n      [IS ObjectType].properties: {\r\n        name, default, required, is_abstract, abstract, builtin, is_final,\r\n        expr, inherited_fields , final, readonly,\r\n        computed_fields , id,\r\n        annotations:{ name, @value },\r\n        target:{name, id}\r\n      } Filter .internal = false,\r\n      [IS ScalarType].enum_values,\r\n      is_seq := 'std::sequence' in [IS ScalarType].ancestors.name,\r\n      # for sequence (abstract type that has non-abstract ancestor)\r\n      single material_id := (\r\n        SELECT x := Type[IS ScalarType].ancestors\r\n        FILTER x IN material_scalars\r\n        LIMIT 1\r\n      ).id,\r\n\r\n      [IS InheritingObject].bases: {\r\n        id\r\n      } ORDER BY @index ASC,\r\n      [IS ObjectType].links: {\r\n        indexes :{ name, id },\r\n        annotations :{ name, id },\r\n        ancestors :{ name, id },\r\n        bases :{ name, id, __type__:{name}\r\n        #, [IS Link].annotations:{name, @value} \r\n      },\r\n        properties :{\r\n          name, default, required, is_abstract, abstract, builtin, is_final,\r\n          expr, inherited_fields , final, readonly,\r\n          computed_fields , id,\r\n          annotations:{ name, @value },\r\n          target:{name, id}, constraints :{ name, id }\r\n        },\r\n        constraints :{ name, id },\r\n        pointers :{ name, id },\r\n        target :{ name, id },\r\n\r\n        is_final,\r\n        abstract,\r\n        computed_fields,\r\n        name,\r\n        final,\r\n        inherited_fields,\r\n        builtin,\r\n        internal,\r\n        expr,\r\n        required,\r\n        id,\r\n        is_abstract,\r\n        readonly,\r\n        cardinality,\r\n        on_target_delete,\r\n        default\r\n    },\r\n      [IS ObjectType].union_of,\r\n      [IS ObjectType].intersection_of,\r\n      [IS ObjectType].pointers: {\r\n        real_cardinality := (\"One\" IF .required ELSE \"AtMostOne\") IF <str>.cardinality = \"One\" ELSE (\"AtLeastOne\" IF .required ELSE \"Many\"),\r\n        name,\r\n        target_id := .target.id,\r\n        kind := 'link' IF .__type__.name = 'schema::Link' ELSE 'property',\r\n        is_exclusive := exists (select .constraints filter .name = 'std::exclusive'),\r\n        is_computed := len(.computed_fields) != 0,\r\n        is_readonly := .readonly,\r\n        has_default := EXISTS .default or (\"std::sequence\" in .target[IS ScalarType].ancestors.name),\r\n        [IS Link].pointers: {\r\n          real_cardinality := (\"One\" IF .required ELSE \"AtMostOne\") IF <str>.cardinality = \"One\" ELSE (\"AtLeastOne\" IF .required ELSE \"Many\"),\r\n          name := '@' ++ .name,\r\n          target_id := .target.id,\r\n          kind := 'link' IF .__type__.name = 'schema::Link' ELSE 'property',\r\n          is_computed := len(.computed_fields) != 0,\r\n          is_readonly := .readonly\r\n        } filter .name != '@source' and .name != '@target',\r\n      } FILTER @is_owned,\r\n      backlinks := (SELECT DETACHED Link FILTER .target = Type) {\r\n        real_cardinality := \"AtMostOne\"\r\n          IF\r\n          EXISTS (select .constraints filter .name = 'std::exclusive')\r\n          ELSE\r\n          \"Many\",\r\n        name := '<' ++ .name ++ '[is ' ++ std::assert_exists(\r\n          .source.name if .source.name[:9] != 'default::' else .source.name[9:]\r\n        ) ++ ']',\r\n        stub := .name,\r\n        target_id := .source.id,\r\n        target_name := .source.name,\r\n        indexes :{ name, id },\r\n        annotations :{ name, @value },\r\n        ancestors :{ name, id },\r\n        bases :{ \r\n          name, id, __type__:{name}\r\n          #,[IS Link].annotations:{name, @value}\r\n      },\r\n        properties :{\r\n          name, default, required, is_abstract, abstract, builtin, is_final,\r\n          expr, inherited_fields , final, readonly,\r\n          computed_fields , id,\r\n          annotations:{ name, @value },\r\n          target:{name, id}\r\n        },\r\n        constraints :{ name, id },\r\n        pointers :{ name, id },\r\n        target :{ name, id },\r\n        is_computed := len(.computed_fields) != 0,\r\n        is_final,\r\n        abstract,\r\n        computed_fields,\r\n        final,\r\n        inherited_fields,\r\n        builtin,\r\n        internal,\r\n        expr,\r\n        required,\r\n        id,\r\n        is_abstract,\r\n        readonly,\r\n        cardinality,\r\n        on_target_delete,\r\n        default,\r\n        kind := 'link',\r\n        is_exclusive := (EXISTS (select .constraints filter .name = 'std::exclusive')) AND <str>.cardinality = \"One\",\r\n      },\r\n      backlink_stubs := array_agg((\r\n        WITH\r\n          stubs := DISTINCT (SELECT DETACHED Link FILTER .target = Type).name,\r\n          baseObjectId := (SELECT DETACHED ObjectType FILTER .name = 'std::BaseObject' LIMIT 1).id\r\n        FOR stub in { stubs }\r\n        UNION (\r\n          SELECT {\r\n            real_cardinality := \"Many\",\r\n            name := '<' ++ stub,\r\n            target_id := baseObjectId,\r\n            kind := 'link',\r\n            is_exclusive := false,\r\n          }\r\n        )\r\n      )),\r\n      array_element_id := [IS Array].element_type.id,\r\n\r\n      tuple_elements := (SELECT [IS Tuple].element_types {\r\n        target_id := .type.id,\r\n        name\r\n      } ORDER BY @index ASC),\r\n    }\r\n    ORDER BY .name;\r\n  `\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3782/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3782/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3730", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3730/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3730/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3730/events", "html_url": "https://github.com/edgedb/edgedb/issues/3730", "id": 1194119469, "node_id": "I_kwDOBbYNSM5HLNEt", "number": 3730, "title": "Changing the type of an abstract link property errors", "user": {"login": "haikyuu", "id": 8558836, "node_id": "MDQ6VXNlcjg1NTg4MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/8558836?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haikyuu", "html_url": "https://github.com/haikyuu", "followers_url": "https://api.github.com/users/haikyuu/followers", "following_url": "https://api.github.com/users/haikyuu/following{/other_user}", "gists_url": "https://api.github.com/users/haikyuu/gists{/gist_id}", "starred_url": "https://api.github.com/users/haikyuu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haikyuu/subscriptions", "organizations_url": "https://api.github.com/users/haikyuu/orgs", "repos_url": "https://api.github.com/users/haikyuu/repos", "events_url": "https://api.github.com/users/haikyuu/events{/privacy}", "received_events_url": "https://api.github.com/users/haikyuu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2022-04-06T06:38:41Z", "updated_at": "2022-05-17T18:13:55Z", "closed_at": "2022-05-17T18:13:55Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.2\r\n- OS Version: Mac Monterray\r\n\r\nSteps to Reproduce:\r\n\r\n1. Change orderVal to `decimal`\r\n2. migrate\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n```\r\nabstract type Entity{}\r\nabstract link orderable {\r\n    property orderVal -> str { delegated constraint exclusive };\r\n }\r\n    type Topic extending Entity {\r\n      multi link videos extends orderable -> Video;\r\n   }\r\ntype Video extends Entity {}\r\n```\r\n\r\nError\r\n```\r\n InternalServerError: invalid PathId: <Link 6594eb62-b4ec-11ec-bd14-f709fa69babe at 0x0x113d8dfc0> is not concrete\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/server/compiler_pool/worker.py\", line 309, in worker\r\n          res = meth(*args)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/server/compiler_pool/worker.py\", line 202, in compile_in_tx\r\n          units, cstate = COMPILER.compile_in_tx(cstate, *args, **kwargs)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 2148, in compile_in_tx\r\n          return self._compile(ctx=ctx, source=source), ctx.state\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1669, in _compile\r\n          return self._try_compile(ctx=ctx, source=source)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1722, in _try_compile\r\n          comp, capabilities = self._compile_dispatch_ql(\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1605, in _compile_dispatch_ql\r\n          query = self._compile_ql_migration(ctx, ql)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 944, in _compile_ql_migration\r\n          query = self._compile_and_apply_ddl_stmt(ctx, ql)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 861, in _compile_and_apply_ddl_stmt\r\n          block, new_types = self._process_delta(ctx, delta)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 342, in _process_delta\r\n          schema = pgdelta.apply(schema, context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 5963, in apply\r\n          schema = super().apply(schema, context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/schema/delta.py\", line 1519, in apply\r\n          schema = self.apply_subcommands(schema, context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 143, in apply_subcommands\r\n          schema = super().apply_subcommands(schema, context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/schema/delta.py\", line 1546, in apply_subcommands\r\n          schema = objop.apply(schema, context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/schema/delta.py\", line 2977, in apply\r\n          schema = self._create_innards(schema, context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/schema/delta.py\", line 2945, in _create_innards\r\n          return self.apply_subcommands(schema, context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 143, in apply_subcommands\r\n          schema = super().apply_subcommands(schema, context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/schema/delta.py\", line 946, in apply_subcommands\r\n          schema = op.apply(schema, context=context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/schema/delta.py\", line 3445, in apply\r\n          schema = self._alter_innards(schema, context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 4410, in _alter_innards\r\n          schema = super()._alter_innards(schema, context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/schema/delta.py\", line 3074, in _alter_innards\r\n          return self.apply_subcommands(schema, context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 143, in apply_subcommands\r\n          schema = super().apply_subcommands(schema, context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/schema/delta.py\", line 946, in apply_subcommands\r\n          schema = op.apply(schema, context=context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/schema/delta.py\", line 3445, in apply\r\n          schema = self._alter_innards(schema, context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 4826, in _alter_innards\r\n          schema = super()._alter_innards(schema, context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/schema/delta.py\", line 3074, in _alter_innards\r\n          return self.apply_subcommands(schema, context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 143, in apply_subcommands\r\n          schema = super().apply_subcommands(schema, context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/schema/delta.py\", line 946, in apply_subcommands\r\n          schema = op.apply(schema, context=context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/schema/delta.py\", line 3127, in apply\r\n          schema = self._alter_begin(schema, context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 4739, in _alter_begin\r\n          self._alter_pointer_type(self.scls, schema, orig_schema, context)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 3683, in _alter_pointer_type\r\n          self._compile_conversion_expr(\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 3959, in _compile_conversion_expr\r\n          tgt_path_id = irpathid.PathId.from_pointer(\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/ir/pathid.py\", line 201, in from_pointer\r\n          prefix = cls.from_pointer(schema, source, namespace=namespace)\r\n        File \"/Users/abdellah/Library/Application Support/edgedb/portable/1.2/lib/python3.10/site-packages/edb/ir/pathid.py\", line 197, in from_pointer\r\n          raise ValueError(f'invalid PathId: {pointer} is not concrete')\r\n      ValueError: invalid PathId: <Link 6594eb62-b4ec-11ec-bd14-f709fa69babe at 0x0x113d8dfc0> is not concrete\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3730/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3730/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3720", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3720/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3720/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3720/events", "html_url": "https://github.com/edgedb/edgedb/issues/3720", "id": 1193532734, "node_id": "I_kwDOBbYNSM5HI90-", "number": 3720, "title": "ISE on type intersection in `FILTER`", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-04-05T17:56:34Z", "updated_at": "2022-05-17T00:09:26Z", "closed_at": "2022-05-17T00:09:26Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nedgedb> SELECT default::Account.watchlist FILTER [is Movie].actors.name like '%Kyle%';\r\nedgedb error: InternalServerError: relation \"edgedbpub.35e64b74-b509-11ec-849a-1be4997fc70c_t\" does not exist\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: relation \"edgedbpub.35e64b74-b509-11ec-849a-1be4997fc70c_t\" does not exist\r\n```\r\n\r\n<details><summary>Schema</summary>\r\n\r\n\r\n\r\n```\r\nmodule default {\r\n  type Account {\r\n    required property username -> str {\r\n      constraint exclusive;\r\n    };\r\n    multi link watchlist -> Content;\r\n  }\r\n\r\n  type Person {\r\n    required property name -> str;\r\n    link filmography := .<actors[is Content];\r\n  }\r\n\r\n  abstract type Content {\r\n    required property title -> str;\r\n    multi link actors -> Person {\r\n      property character_name -> str;\r\n    };\r\n  }\r\n\r\n  type Movie extending Content {\r\n    property release_year -> int32;\r\n  }\r\n\r\n  type Show extending Content {\r\n    property num_seasons := count(.<show[is Season]);\r\n  }\r\n\r\n  type Season {\r\n    required property number -> int32;\r\n    required link show -> Show;\r\n  }\r\n};\r\n```\r\n\r\n</details>", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3720/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3720/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3681", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3681/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3681/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3681/events", "html_url": "https://github.com/edgedb/edgedb/issues/3681", "id": 1182700879, "node_id": "I_kwDOBbYNSM5GfpVP", "number": 3681, "title": "ISE: there is no range var for (__derived__::expr~2) source in <pg.SelectStmt at ...>", "user": {"login": "das7pad", "id": 17931887, "node_id": "MDQ6VXNlcjE3OTMxODg3", "avatar_url": "https://avatars.githubusercontent.com/u/17931887?v=4", "gravatar_id": "", "url": "https://api.github.com/users/das7pad", "html_url": "https://github.com/das7pad", "followers_url": "https://api.github.com/users/das7pad/followers", "following_url": "https://api.github.com/users/das7pad/following{/other_user}", "gists_url": "https://api.github.com/users/das7pad/gists{/gist_id}", "starred_url": "https://api.github.com/users/das7pad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/das7pad/subscriptions", "organizations_url": "https://api.github.com/users/das7pad/orgs", "repos_url": "https://api.github.com/users/das7pad/repos", "events_url": "https://api.github.com/users/das7pad/events{/privacy}", "received_events_url": "https://api.github.com/users/das7pad/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2022-03-27T23:28:24Z", "updated_at": "2022-03-31T21:22:26Z", "closed_at": "2022-03-29T21:24:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: `1.2+85bef76`\r\n- OS Version: running in docker, `latest` / `sha256:91770f634b4dbcd9466fdc7d5b52f1a966a78f81cb37b2f3a1e0ea3acb683cd1`\r\n\r\nSteps to Reproduce:\r\n\r\n1. I wrote a reproducer using the Go driver: https://github.com/das7pad/edgedb-go/commit/b500bd62e231b3b141ad367c56acdc8177c990b7\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n\r\n```\r\nmodule default {\r\n\tabstract type Node {\r\n\t\trequired property path -> str;\r\n\t}\r\n\ttype RootNode extending Node {}\r\n\ttype VisibleNode extending Node {\r\n\t\trequired link parent -> Node;\r\n\t\tmulti link children := .<parent[is VisibleNode];\r\n\t}\r\n}\r\n```\r\n\r\nMinimal query that triggers this ISE:\r\n```\r\nselect (update VisibleNode set { }) { children }\r\n```\r\n\r\n\r\nThe full schema has more levels of inheritance and I can query another computed back-link on the same level as _VisibleNode.children_ that points at a different implementation of _Node_ just fine. So it's not computed back-links per-se that do not work in a filter from an update. Could this be caused by type self-reference?", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3681/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3681/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3671", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3671/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3671/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3671/events", "html_url": "https://github.com/edgedb/edgedb/issues/3671", "id": 1180152380, "node_id": "I_kwDOBbYNSM5GV7I8", "number": 3671, "title": "Casting arrays or tuples from JSON `null` is broken", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2022-03-24T23:15:02Z", "updated_at": "2022-03-25T22:01:47Z", "closed_at": "2022-03-25T22:01:47Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nfoo> select <array<str>>to_json('null');\r\nedgedb error: InvalidValueError: cannot extract elements from a scalar\r\n```\r\n\r\nExpected result: cast should return an appropriately typed empty set.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3671/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3671/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3641", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3641/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3641/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3641/events", "html_url": "https://github.com/edgedb/edgedb/issues/3641", "id": 1175780490, "node_id": "I_kwDOBbYNSM5GFPyK", "number": 3641, "title": "Incorrect error message hint for InvalidValueError of std::duration", "user": {"login": "tdolsen", "id": 180510, "node_id": "MDQ6VXNlcjE4MDUxMA==", "avatar_url": "https://avatars.githubusercontent.com/u/180510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tdolsen", "html_url": "https://github.com/tdolsen", "followers_url": "https://api.github.com/users/tdolsen/followers", "following_url": "https://api.github.com/users/tdolsen/following{/other_user}", "gists_url": "https://api.github.com/users/tdolsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/tdolsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tdolsen/subscriptions", "organizations_url": "https://api.github.com/users/tdolsen/orgs", "repos_url": "https://api.github.com/users/tdolsen/repos", "events_url": "https://api.github.com/users/tdolsen/events{/privacy}", "received_events_url": "https://api.github.com/users/tdolsen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}, {"id": 4505522149, "node_id": "LA_kwDOBbYNSM8AAAABDIzP5Q", "url": "https://api.github.com/repos/edgedb/edgedb/labels/onboarding", "name": "onboarding", "color": "bfdadc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2022-03-21T18:28:54Z", "updated_at": "2022-10-17T18:08:10Z", "closed_at": "2022-10-17T18:08:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\nedgedb> select <duration>\"1 day\";\r\nedgedb error: InvalidValueError: invalid input syntax for type std::duration: '1 day'\r\n  Hint: Units bigger than days cannot be used for std::duration.\r\n```\r\n\r\n**Expected**: Hint should say \"hours\", not \"days\".", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3641/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3641/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3611", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3611/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3611/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3611/events", "html_url": "https://github.com/edgedb/edgedb/issues/3611", "id": 1168903057, "node_id": "I_kwDOBbYNSM5FrAuR", "number": 3611, "title": "ISE: 'NoneType' object has no attribute 'to_edgeql'", "user": {"login": "smstromb", "id": 750499, "node_id": "MDQ6VXNlcjc1MDQ5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/750499?v=4", "gravatar_id": "", "url": "https://api.github.com/users/smstromb", "html_url": "https://github.com/smstromb", "followers_url": "https://api.github.com/users/smstromb/followers", "following_url": "https://api.github.com/users/smstromb/following{/other_user}", "gists_url": "https://api.github.com/users/smstromb/gists{/gist_id}", "starred_url": "https://api.github.com/users/smstromb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/smstromb/subscriptions", "organizations_url": "https://api.github.com/users/smstromb/orgs", "repos_url": "https://api.github.com/users/smstromb/repos", "events_url": "https://api.github.com/users/smstromb/events{/privacy}", "received_events_url": "https://api.github.com/users/smstromb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-03-14T21:05:31Z", "updated_at": "2022-03-15T22:22:57Z", "closed_at": "2022-03-15T22:22:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: EdgeDB CLI 1.1.0+8bc2c20 w/ instance version 1.1+ab7d5a1\r\n- OS Version: macOS 12.1\r\n\r\nSteps to Reproduce:\r\n\r\n1. Assuming this existing schema:\r\n\r\n```\r\n  type User {\r\n      multi link workspaces -> Workspace {\r\n          property title -> str;\r\n          on target delete allow;\r\n      }\r\n  }\r\n\r\n  type Workspace {\r\n      multi link users := .<workspaces[is User];\r\n  }\r\n```\r\n\r\n2. Swap the link direction:\r\n\r\n```\r\n  type User {\r\n      multi link workspaces := .<users[is Workspace];\r\n  }\r\n\r\n  type Workspace {\r\n      multi link users -> User {\r\n          property title -> str;\r\n          on target delete allow;\r\n      }\r\n  }\r\n```\r\n\r\n3. `edgedb migration create`:\r\n\r\n```\r\nedgedb error: InternalServerError: 'NoneType' object has no attribute 'to_edgeql'\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/server/compiler_pool/worker.py\", line 309, in worker\r\n          res = meth(*args)\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/server/compiler_pool/worker.py\", line 202, in compile_in_tx\r\n          units, cstate = COMPILER.compile_in_tx(cstate, *args, **kwargs)\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 2149, in compile_in_tx\r\n          return self._compile(ctx=ctx, source=source), ctx.state\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1666, in _compile\r\n          return self._try_compile(ctx=ctx, source=original)\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1722, in _try_compile\r\n          comp, capabilities = self._compile_dispatch_ql(\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1605, in _compile_dispatch_ql\r\n          query = self._compile_ql_migration(ctx, ql)\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1092, in _compile_ql_migration\r\n          proposed_ddl = s_ddl.statements_from_delta(\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/schema/ddl.py\", line 759, in statements_from_delta\r\n          stmt_text = edgeql.generate_source(\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/edgeql/codegen.py\", line 2116, in to_source\r\n          return super().to_source(\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/common/ast/codegen.py\", line 122, in to_source\r\n          generator.visit(node)\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/edgeql/codegen.py\", line 118, in visit\r\n          visitor(node, **kwargs)\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/edgeql/codegen.py\", line 1664, in visit_AlterObjectType\r\n          self._visit_AlterObject(node, 'TYPE')\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/edgeql/codegen.py\", line 930, in _visit_AlterObject\r\n          self._ddl_visit_body(\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/edgeql/codegen.py\", line 859, in _ddl_visit_body\r\n          self.visit_list(list(commands), terminator=';')\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/common/ast/codegen.py\", line 97, in visit_list\r\n          self.visit(item, **kwargs)  # type: ignore\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/edgeql/codegen.py\", line 118, in visit\r\n          visitor(node, **kwargs)\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/edgeql/codegen.py\", line 1600, in visit_AlterConcreteLink\r\n          self._visit_AlterObject(\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/edgeql/codegen.py\", line 930, in _visit_AlterObject\r\n          self._ddl_visit_body(\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/edgeql/codegen.py\", line 859, in _ddl_visit_body\r\n          self.visit_list(list(commands), terminator=';')\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/common/ast/codegen.py\", line 97, in visit_list\r\n          self.visit(item, **kwargs)  # type: ignore\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/edgeql/codegen.py\", line 118, in visit\r\n          visitor(node, **kwargs)\r\n        File \"/Users/smstromb/Library/Application Support/edgedb/portable/1.1/lib/python3.10/site-packages/edb/edgeql/codegen.py\", line 1650, in visit_OnTargetDelete\r\n          self._write_keywords('ON TARGET DELETE ', node.cascade.to_edgeql())\r\n      AttributeError: 'NoneType' object has no attribute 'to_edgeql'\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3611/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3611/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3592", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3592/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3592/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3592/events", "html_url": "https://github.com/edgedb/edgedb/issues/3592", "id": 1163293738, "node_id": "I_kwDOBbYNSM5FVnQq", "number": 3592, "title": "Inserting in fill_expr (and sometimes default) doesn't work", "user": {"login": "vonkoff", "id": 16548992, "node_id": "MDQ6VXNlcjE2NTQ4OTky", "avatar_url": "https://avatars.githubusercontent.com/u/16548992?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vonkoff", "html_url": "https://github.com/vonkoff", "followers_url": "https://api.github.com/users/vonkoff/followers", "following_url": "https://api.github.com/users/vonkoff/following{/other_user}", "gists_url": "https://api.github.com/users/vonkoff/gists{/gist_id}", "starred_url": "https://api.github.com/users/vonkoff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vonkoff/subscriptions", "organizations_url": "https://api.github.com/users/vonkoff/orgs", "repos_url": "https://api.github.com/users/vonkoff/repos", "events_url": "https://api.github.com/users/vonkoff/events{/privacy}", "received_events_url": "https://api.github.com/users/vonkoff/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aljazerzen", "id": 11072061, "node_id": "MDQ6VXNlcjExMDcyMDYx", "avatar_url": "https://avatars.githubusercontent.com/u/11072061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aljazerzen", "html_url": "https://github.com/aljazerzen", "followers_url": "https://api.github.com/users/aljazerzen/followers", "following_url": "https://api.github.com/users/aljazerzen/following{/other_user}", "gists_url": "https://api.github.com/users/aljazerzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/aljazerzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aljazerzen/subscriptions", "organizations_url": "https://api.github.com/users/aljazerzen/orgs", "repos_url": "https://api.github.com/users/aljazerzen/repos", "events_url": "https://api.github.com/users/aljazerzen/events{/privacy}", "received_events_url": "https://api.github.com/users/aljazerzen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2022-03-08T23:22:20Z", "updated_at": "2023-02-22T18:32:43Z", "closed_at": "2023-02-16T23:29:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: EdgeDB CLI 1.1.0+8bc2c20\r\n- OS Version: Mac OS Monterey version 12.1\r\n\r\nSteps to Reproduce:\r\n\r\n1. Updated default.esdl to include new table, Union_labor_name, and put in a link to that table into \"Labor_union\" table. \r\n\r\n```\r\nPlease specify an expression to populate existing objects in order to make link 'union_name' of object type 'default::Labor_union' required:\r\nfill_expr> insert Union_labor_name { name:= \"AAA\" }\r\nCreated ./dbschema/migrations/00004.edgeql, id: m1f2ufyzoqfpfypfweuk5bwp2q7fuhuwgsvgq7rzsyqrdcove3pvlq\r\n```\r\n\r\nI did the following and then tried to edgedb migrate'and got the error:\r\n\r\n```\r\nedgedb migrate\r\nedgedb error: UnsupportedBackendFeatureError: WITH clause containing a data-modifying statement must be at the top level \r\nI tried to just destroy the database and re-run it, but that didn't even work\r\nedgedb instance destroy edgedb \r\nDo you really want to delete instance \"edgedb\"? (type Yes)\r\ny\r\nedgedb error: Canceled.\r\n```\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n```\r\n  abstract type Named {\r\n    required property name -> str {\r\n      delegated constraint exclusive;\r\n    }\r\n  }\r\n  type Labor_union {\r\n    required link union_name -> Union_labor_name;\r\n    link abbrev -> Abbreviation;\r\n\r\n  } \r\n  type Union_labor_name extending Named {}\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3592/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3592/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3559", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3559/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3559/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3559/events", "html_url": "https://github.com/edgedb/edgedb/issues/3559", "id": 1151692916, "node_id": "I_kwDOBbYNSM5EpXB0", "number": 3559, "title": "Can't create exclusive constraint on tuple properties", "user": {"login": "johanbrook", "id": 437261, "node_id": "MDQ6VXNlcjQzNzI2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/437261?v=4", "gravatar_id": "", "url": "https://api.github.com/users/johanbrook", "html_url": "https://github.com/johanbrook", "followers_url": "https://api.github.com/users/johanbrook/followers", "following_url": "https://api.github.com/users/johanbrook/following{/other_user}", "gists_url": "https://api.github.com/users/johanbrook/gists{/gist_id}", "starred_url": "https://api.github.com/users/johanbrook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/johanbrook/subscriptions", "organizations_url": "https://api.github.com/users/johanbrook/orgs", "repos_url": "https://api.github.com/users/johanbrook/repos", "events_url": "https://api.github.com/users/johanbrook/events{/privacy}", "received_events_url": "https://api.github.com/users/johanbrook/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2022-02-26T11:24:07Z", "updated_at": "2022-03-02T21:35:43Z", "closed_at": "2022-03-02T21:35:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "I got this crash when applying a migration from a schema change I just made. I'm not sure I typed invalid EdgeQL code somehow, or if the code simply triggered a bug code path in the CLI tool.\r\n\r\n<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: EdgeDB CLI 1.1.0+8bc2c20\r\n- OS Version: macOS 10.14.6.\r\n\r\nRelated issues:\r\n\r\n- https://github.com/edgedb/edgedb/issues/3521. This one was fixed some days ago, but my bug is still crashing on the same line of code (line 309, in `worker.py`).\r\n\r\nSteps to Reproduce:\r\n\r\n1. Apply a certain migration.\r\n2. Get crash: `InternalServerError: 'ColumnRef' object has no attribute 'args'`.\r\n\r\n<details>\r\n<summary>Full error</summary >\r\n\r\n```\r\nedgedb error: InternalServerError: 'ColumnRef' object has no attribute 'args'\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/server/compiler_pool/worker.py\", line 309, in worker\r\n          res = meth(*args)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/server/compiler_pool/worker.py\", line 202, in compile_in_tx\r\n          units, cstate = COMPILER.compile_in_tx(cstate, *args, **kwargs)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 2137, in compile_in_tx\r\n          return self._compile(ctx=ctx, source=source), ctx.state\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1657, in _compile\r\n          return self._try_compile(ctx=ctx, source=source)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1710, in _try_compile\r\n          comp, capabilities = self._compile_dispatch_ql(\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1593, in _compile_dispatch_ql\r\n          query = self._compile_ql_migration(ctx, ql)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 943, in _compile_ql_migration\r\n          query = self._compile_and_apply_ddl_stmt(ctx, ql)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 860, in _compile_and_apply_ddl_stmt\r\n          block, new_types = self._process_delta(ctx, delta)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 341, in _process_delta\r\n          schema = pgdelta.apply(schema, context)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 5791, in apply\r\n          schema = super().apply(schema, context)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/delta.py\", line 1506, in apply\r\n          schema = self.apply_subcommands(schema, context)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 143, in apply_subcommands\r\n          schema = super().apply_subcommands(schema, context)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/delta.py\", line 1533, in apply_subcommands\r\n          schema = objop.apply(schema, context)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/delta.py\", line 2953, in apply\r\n          schema = self._create_innards(schema, context)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/delta.py\", line 2921, in _create_innards\r\n          return self.apply_subcommands(schema, context)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 143, in apply_subcommands\r\n          schema = super().apply_subcommands(schema, context)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/delta.py\", line 946, in apply_subcommands\r\n          schema = op.apply(schema, context=context)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 2956, in apply\r\n          schema = super().apply(schema, context=context)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/delta.py\", line 3421, in apply\r\n          schema = self._alter_innards(schema, context)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/delta.py\", line 3050, in _alter_innards\r\n          return self.apply_subcommands(schema, context)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 143, in apply_subcommands\r\n          schema = super().apply_subcommands(schema, context)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/delta.py\", line 946, in apply_subcommands\r\n          schema = op.apply(schema, context=context)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/delta.py\", line 2953, in apply\r\n          schema = self._create_innards(schema, context)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/referencing.py\", line 1105, in _create_innards\r\n          return super()._create_innards(schema, context)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/inheriting.py\", line 711, in _create_innards\r\n          return super()._create_innards(schema, context)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/delta.py\", line 2921, in _create_innards\r\n          return self.apply_subcommands(schema, context)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 143, in apply_subcommands\r\n          schema = super().apply_subcommands(schema, context)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/delta.py\", line 946, in apply_subcommands\r\n          schema = op.apply(schema, context=context)\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 1767, in apply\r\n          op = self.create_constraint(\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/pgsql/delta.py\", line 1730, in create_constraint\r\n          bconstr = schemac_to_backendc(\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/pgsql/schemamech.py\", line 249, in schema_constraint_to_backend_constraint\r\n          exprdata = cls._edgeql_ref_to_pg_constr(\r\n        File \"/Users/Johan/Library/Application Support/edgedb/portable/1.0/lib/python3.10/site-packages/edb/pgsql/schemamech.py\", line 128, in _edgeql_ref_to_pg_constr\r\n          for elem in sql_expr.args:\r\n      AttributeError: 'ColumnRef' object has no attribute 'args'\r\n```\r\n\r\n</details>\r\n\r\nThis is the migration applied:\r\n\r\n```edgeql\r\nCREATE MIGRATION m1vnhv5wflmooetol65tflzojfs4suaorwvezlqmp2ozbgde5xrrxa\r\n    ONTO m1fse57hjkh43rvap24cfduz5b4uzxm5zqjcm364ryhzqihcjloehq\r\n{\r\n  ALTER TYPE default::Grp {\r\n      DROP PROPERTY label;\r\n  };\r\n  CREATE SCALAR TYPE default::Label EXTENDING std::str {\r\n      CREATE CONSTRAINT std::max_len_value(1);\r\n      CREATE CONSTRAINT std::regexp('[A-Z]');\r\n  };\r\n  ALTER TYPE default::Grp {\r\n      CREATE REQUIRED PROPERTY meta -> tuple<label: default::Label, recurr: default::Recurr> {\r\n          SET REQUIRED USING (SELECT\r\n              ('A', 'Daily')\r\n          );\r\n          CREATE CONSTRAINT std::exclusive;\r\n      };\r\n  };\r\n  ALTER TYPE default::Grp {\r\n      CREATE PROPERTY label := (.meta.label);\r\n      ALTER PROPERTY recurr {\r\n          DROP CONSTRAINT std::exclusive;\r\n      };\r\n      ALTER PROPERTY recurr {\r\n          USING (.meta.recurr);\r\n          RESET OPTIONALITY;\r\n      };\r\n  };\r\n};\r\n```\r\n\r\n<details>\r\n<summary>Full schema (which triggered the migration)</summary>\r\n\r\n```\r\nmodule default {\r\n    scalar type Recurr extending enum<Daily, Weekly, Monthly, HalfYearly, Yearly>;\r\n\r\n    # A, B, C, ...\r\n    scalar type Label extending str {\r\n        constraint max_len_value(1);\r\n        constraint regexp(r'[A-Z]');\r\n    }\r\n\r\n    type Contact {\r\n        required property name -> str;\r\n        required link grp -> Grp;\r\n    }\r\n\r\n    # \"Group\" is a reserved word, so \"Grp\" it is\r\n    type Grp {\r\n        required property meta -> tuple<label: Label, recurr: Recurr> {\r\n            constraint exclusive;\r\n        };\r\n\r\n        # Computed\r\n        property label := .meta.label;\r\n        property recurr := .meta.recurr;\r\n        multi link contacts := .< grp[is Contact]\r\n    }\r\n}\r\n```\r\n\r\n</details>", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3559/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3559/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3544", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3544/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3544/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3544/events", "html_url": "https://github.com/edgedb/edgedb/issues/3544", "id": 1147776036, "node_id": "I_kwDOBbYNSM5Eaawk", "number": 3544, "title": "Unable to create migration to add default value for `multi link`", "user": {"login": "haphamdev", "id": 6322508, "node_id": "MDQ6VXNlcjYzMjI1MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/6322508?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haphamdev", "html_url": "https://github.com/haphamdev", "followers_url": "https://api.github.com/users/haphamdev/followers", "following_url": "https://api.github.com/users/haphamdev/following{/other_user}", "gists_url": "https://api.github.com/users/haphamdev/gists{/gist_id}", "starred_url": "https://api.github.com/users/haphamdev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haphamdev/subscriptions", "organizations_url": "https://api.github.com/users/haphamdev/orgs", "repos_url": "https://api.github.com/users/haphamdev/repos", "events_url": "https://api.github.com/users/haphamdev/events{/privacy}", "received_events_url": "https://api.github.com/users/haphamdev/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2022-02-23T08:06:57Z", "updated_at": "2022-02-23T23:17:25Z", "closed_at": "2022-02-23T23:17:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: `EdgeDB CLI 1.1.0+8bc2c20`\r\n- OS Version: `MacOS Catalina 10.15.7`\r\n\r\nSteps to Reproduce:\r\n\r\n1. Create a default EdgeDB project with `default` module with below schema, then migrate the database\r\n```\r\nmodule default {\r\n    abstract type Person {\r\n        multi link visited_places -> Place;\r\n    }\r\n\r\n    type Firefighter extending Person {}\r\n    \r\n    type Place {\r\n        required property name -> str {\r\n            constraint exclusive;\r\n        }\r\n    }\r\n}\r\n\r\n```\r\n\r\n2. Update the schema to add default value for `default::Person::visited_places` as below\r\n```\r\nmodule default {\r\n    abstract type Person {\r\n        multi link visited_places -> Place { default := ( select Place filter .name = 'London' ) };\r\n    }\r\n\r\n    type Firefighter extending Person {}\r\n    \r\n    type Place {\r\n        required property name -> str {\r\n            constraint exclusive;\r\n        }\r\n    }\r\n}\r\n```\r\n3. Try to create new migration and error will show `EdgeDB could not resolve migration with the provided answers. Please retry with different answers.`\r\n```\r\nuser@local> edgedb migration create\r\ndid you alter link 'visited_places' of object type 'default::Person'? [y,n,l,c,b,s,q,?]\r\n> y\r\nedgedb error: EdgeDB could not resolve migration with the provided answers. Please retry with different answers.\r\n\r\n```\r\n\r\n**Notice**: \r\nThe step 3 can be done without error if \r\n- `default::Place::name` does not have `exclusive` constraint.\r\nOR\r\n- type `default::Firefighter` does not exists\r\n\r\nIs it a bug?", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3544/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3544/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3542", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3542/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3542/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3542/events", "html_url": "https://github.com/edgedb/edgedb/issues/3542", "id": 1147559374, "node_id": "I_kwDOBbYNSM5EZl3O", "number": 3542, "title": "Unable to create migration altering a property from required to optional", "user": {"login": "haphamdev", "id": 6322508, "node_id": "MDQ6VXNlcjYzMjI1MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/6322508?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haphamdev", "html_url": "https://github.com/haphamdev", "followers_url": "https://api.github.com/users/haphamdev/followers", "following_url": "https://api.github.com/users/haphamdev/following{/other_user}", "gists_url": "https://api.github.com/users/haphamdev/gists{/gist_id}", "starred_url": "https://api.github.com/users/haphamdev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haphamdev/subscriptions", "organizations_url": "https://api.github.com/users/haphamdev/orgs", "repos_url": "https://api.github.com/users/haphamdev/repos", "events_url": "https://api.github.com/users/haphamdev/events{/privacy}", "received_events_url": "https://api.github.com/users/haphamdev/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-02-23T02:17:22Z", "updated_at": "2022-02-23T22:49:01Z", "closed_at": "2022-02-23T22:49:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: EdgeDB CLI 1.1.0+8bc2c20\r\n- OS Version: MacOS Catalina 10.15.7\r\n\r\nSteps to Reproduce:\r\n\r\n1. Create a new EdgeDB project (version 1.0) with `default` module as below:\r\n```\r\nmodule default {\r\n    abstract type Person {\r\n        required property name -> str;\r\n    }\r\n\r\n    type PC extending Person {\r\n    }\r\n}\r\n```\r\n2. Create and apply migration\r\n```\r\nuser@local> edgedb migration create\r\ndid you create object type 'default::Person'? [y,n,l,c,b,s,q,?]\r\n> y\r\ndid you create object type 'default::PC'? [y,n,l,c,b,s,q,?]\r\n> y\r\nCreated ./dbschema/migrations/00001.edgeql, id: m1clwlsejlohyzkgrc234l4etgml2mnq6ttpfvvpaykmrfujj5lzaq\r\n\r\nuser@local> edgedb migrate\r\nApplied m1clwlsejlohyzkgrc234l4etgml2mnq6ttpfvvpaykmrfujj5lzaq (00001.edgeql)\r\nNote: adding first migration disables DDL. More info: https://edgedb.com/p/bare_ddl\r\n\r\n```\r\n3. Remove `required` from `default::Person::name` property and create new migration.\r\n```\r\nuser@local> edgedb migration create\r\ndid you make property 'name' of object type 'default::Person' optional? [y,n,l,c,b,s,q,?]\r\n> y\r\nedgedb error: EdgeDB could not resolve migration with the provided answers. Please retry with different answers.\r\n\r\n```\r\n\r\nAs you see from the terminal output above, the migration to make property `default::Person::name` optional could not be created. The error message is quite confusing `EdgeDB could not resolve migration with the provided answers. Please retry with different answers`.\r\n\r\n\r\nHow can I fix it?\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3542/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3542/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3535", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3535/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3535/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3535/events", "html_url": "https://github.com/edgedb/edgedb/issues/3535", "id": 1147409131, "node_id": "I_kwDOBbYNSM5EZBLr", "number": 3535, "title": "GraphQL Introspection Queries Not returning type on fields", "user": {"login": "cancan101", "id": 51059, "node_id": "MDQ6VXNlcjUxMDU5", "avatar_url": "https://avatars.githubusercontent.com/u/51059?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cancan101", "html_url": "https://github.com/cancan101", "followers_url": "https://api.github.com/users/cancan101/followers", "following_url": "https://api.github.com/users/cancan101/following{/other_user}", "gists_url": "https://api.github.com/users/cancan101/gists{/gist_id}", "starred_url": "https://api.github.com/users/cancan101/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cancan101/subscriptions", "organizations_url": "https://api.github.com/users/cancan101/orgs", "repos_url": "https://api.github.com/users/cancan101/repos", "events_url": "https://api.github.com/users/cancan101/events{/privacy}", "received_events_url": "https://api.github.com/users/cancan101/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1284200502, "node_id": "MDU6TGFiZWwxMjg0MjAwNTAy", "url": "https://api.github.com/repos/edgedb/edgedb/labels/graphql", "name": "graphql", "color": "c2b0f4", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2022-02-22T21:56:16Z", "updated_at": "2022-02-25T20:53:03Z", "closed_at": "2022-02-25T20:53:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0.0\r\n- OS Version: MacOs\r\n\r\nSteps to Reproduce:\r\n\r\n1. Setup the DB from the quick start: https://www.edgedb.com/docs/guides/quickstart\r\n2. query using:\r\n```gql\r\nquery {\r\n  __schema {\r\n    queryType {\r\n      kind\r\n      name\r\n      description\r\n      fields {\r\n        name\r\n        args {\r\n          name\r\n        }\r\n        type {\r\n          name\r\n          fields {\r\n            name\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\nnotice type is coming back as null:\r\n```json\r\n{\r\n  \"data\": {\r\n    \"__schema\": {\r\n      \"queryType\": {\r\n        \"kind\": \"OBJECT\",\r\n        \"name\": \"Query\",\r\n        \"fields\": [\r\n          {\r\n            \"args\": [\r\n              {\r\n                \"name\": \"filter\"\r\n              },\r\n              {\r\n                \"name\": \"order\"\r\n              },\r\n              {\r\n                \"name\": \"first\"\r\n              },\r\n              {\r\n                \"name\": \"last\"\r\n              },\r\n              {\r\n                \"name\": \"before\"\r\n              },\r\n              {\r\n                \"name\": \"after\"\r\n              }\r\n            ],\r\n            \"name\": \"BaseObject\",\r\n            \"type\": {\r\n              \"name\": null,\r\n              \"fields\": null\r\n            }\r\n          },\r\n          {\r\n            \"args\": [\r\n              {\r\n                \"name\": \"filter\"\r\n              },\r\n              {\r\n                \"name\": \"order\"\r\n              },\r\n              {\r\n                \"name\": \"first\"\r\n              },\r\n              {\r\n                \"name\": \"last\"\r\n              },\r\n              {\r\n                \"name\": \"before\"\r\n              },\r\n              {\r\n                \"name\": \"after\"\r\n              }\r\n            ],\r\n            \"name\": \"Movie\",\r\n            \"type\": {\r\n              \"name\": null,\r\n              \"fields\": null\r\n            }\r\n          },\r\n          {\r\n            \"args\": [\r\n              {\r\n                \"name\": \"filter\"\r\n              },\r\n              {\r\n                \"name\": \"order\"\r\n              },\r\n              {\r\n                \"name\": \"first\"\r\n              },\r\n              {\r\n                \"name\": \"last\"\r\n              },\r\n              {\r\n                \"name\": \"before\"\r\n              },\r\n              {\r\n                \"name\": \"after\"\r\n              }\r\n            ],\r\n            \"name\": \"Object\",\r\n            \"type\": {\r\n              \"name\": null,\r\n              \"fields\": null\r\n            }\r\n          },\r\n          {\r\n            \"args\": [\r\n              {\r\n                \"name\": \"filter\"\r\n              },\r\n              {\r\n                \"name\": \"order\"\r\n              },\r\n              {\r\n                \"name\": \"first\"\r\n              },\r\n              {\r\n                \"name\": \"last\"\r\n              },\r\n              {\r\n                \"name\": \"before\"\r\n              },\r\n              {\r\n                \"name\": \"after\"\r\n              }\r\n            ],\r\n            \"name\": \"Person\",\r\n            \"type\": {\r\n              \"name\": null,\r\n              \"fields\": null\r\n            }\r\n          }\r\n        ],\r\n        \"description\": null\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n```\r\nusing extension graphql;\r\n\r\nmodule default {\r\n    type Person {\r\n        required property first_name -> str;\r\n        property last_name -> str;\r\n\r\n        property full_name :=\r\n        .first_name ++ ' ' ++ .last_name\r\n        if exists .last_name\r\n        else .first_name;\r\n    }\r\n\r\n    type Movie {\r\n        required property title -> str;\r\n        property year -> int64;\r\n        link director -> Person;\r\n        multi link actors -> Person;\r\n    }\r\n}\r\n```\r\nthis might be partially related to: https://github.com/edgedb/edgedb/issues/3514\r\n*UPDAE*\r\nAdding \r\n```gql\r\n          ofType{\r\n            name\r\n          }\r\n```\r\nDoesn't work either. Still get `null`s", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3535/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3535/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3525", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3525/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3525/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3525/events", "html_url": "https://github.com/edgedb/edgedb/issues/3525", "id": 1146157873, "node_id": "I_kwDOBbYNSM5EUPsx", "number": 3525, "title": "Some sort of scoping error with a non-object binding", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-02-21T19:28:35Z", "updated_at": "2022-03-03T20:30:53Z", "closed_at": "2022-03-03T20:30:53Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This query works properly:\r\n```\r\nwith\r\n  options := {'aneuploid', 'balkanize', 'defenestrate', 'sanguine'},\r\n  pairs := (select Pair filter .word1 = 'hatch' and .similarity = <float64>$sim),\r\nselect options filter (\r\n    with opt_pair := (\r\n        select Pair filter .word1 = options and .word2 in pairs.word2),\r\n    select count(opt_pair) = count(distinct opt_pair.similarity)\r\n) limit 1;\r\n```\r\nbut this should-be-equivalent query runs for a long time and then returns no data\r\n```\r\nwith\r\n  options := {'aneuploid', 'balkanize', 'defenestrate', 'sanguine'},\r\n  word2 := (select Pair filter .word1 = 'hatch' and .similarity = <float64>$sim).word2,\r\nselect options filter (\r\n    with opt_pair := (\r\n        select Pair filter .word1 = options and .word2 in word2),\r\n    select count(opt_pair) = count(distinct opt_pair.similarity)\r\n) limit 1;\r\n```\r\n\r\nwrapping the reference to `word2` in the filter clause with a select fixes it.\r\n\r\nSchema is \r\n```\r\nmodule default {\r\n    type Pair {\r\n        required property word1 -> str;\r\n        required property word2 -> str;\r\n        required property similarity -> float64;\r\n        constraint exclusive on ((.word1, .word2));\r\n        index on ((.word1, .word2));\r\n        index on ((.word1, .similarity));\r\n    }\r\n}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3525/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3525/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3521", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3521/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3521/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3521/events", "html_url": "https://github.com/edgedb/edgedb/issues/3521", "id": 1144994723, "node_id": "I_kwDOBbYNSM5EPzuj", "number": 3521, "title": "Trying to drop a type with `edb migration create` causes a crash", "user": {"login": "iiian", "id": 32170975, "node_id": "MDQ6VXNlcjMyMTcwOTc1", "avatar_url": "https://avatars.githubusercontent.com/u/32170975?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iiian", "html_url": "https://github.com/iiian", "followers_url": "https://api.github.com/users/iiian/followers", "following_url": "https://api.github.com/users/iiian/following{/other_user}", "gists_url": "https://api.github.com/users/iiian/gists{/gist_id}", "starred_url": "https://api.github.com/users/iiian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iiian/subscriptions", "organizations_url": "https://api.github.com/users/iiian/orgs", "repos_url": "https://api.github.com/users/iiian/repos", "events_url": "https://api.github.com/users/iiian/events{/privacy}", "received_events_url": "https://api.github.com/users/iiian/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2022-02-20T11:37:32Z", "updated_at": "2022-02-23T00:37:37Z", "closed_at": "2022-02-23T00:37:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: `EdgeDB CLI 1.0.0+5724c50`, `1.0+9ecadfc`\r\n- OS Version: Windows 10 running WSL w/ Ubuntu 20.04 \ud83d\ude2c \r\n\r\nSteps to Reproduce:\r\n\r\n1. Initialize a project with the following schema definition:\r\n```\r\nmodule default {\r\n  type Document {\r\n    multi link entries -> Entry {\r\n      constraint exclusive;\r\n    }\r\n    multi link fields := .entries.field;\r\n    required link form -> Form;\r\n  }\r\n\r\n  type Entry {\r\n    required link field -> Field;\r\n    required property value -> str;\r\n    link form := .field.form; \r\n  }\r\n\r\n  type Field {\r\n    required property name -> str;\r\n\r\n    link form := .<fields[IS Form];\r\n  }\r\n\r\n  type Form {\r\n    required property name -> str {\r\n      constraint exclusive;\r\n    }\r\n\r\n    multi link fields -> Field;\r\n  }\r\n}\r\n```\r\n2. `edb migration create; edb migrate;`\r\n3. delete the `Document` type\r\n4. `edb migration create`\r\n5. crash\r\n```\r\nedgedb error: InternalServerError: \r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md      \r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/home/ianch/.local/share/edgedb/portable/1.0/lib/python3.10/site-packages/edb/server/compiler_pool/worker.py\", line 309, in worker\r\n          res = meth(*args)\r\n        File \"/home/ianch/.local/share/edgedb/portable/1.0/lib/python3.10/site-packages/edb/server/compiler_pool/worker.py\", line 202, in compile_in_tx\r\n          units, cstate = COMPILER.compile_in_tx(cstate, *args, **kwargs)       \r\n        File \"/home/ianch/.local/share/edgedb/portable/1.0/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 2137, in compile_in_tx\r\n          return self._compile(ctx=ctx, source=source), ctx.state\r\n        File \"/home/ianch/.local/share/edgedb/portable/1.0/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1654, in _compile\r\n          return self._try_compile(ctx=ctx, source=original)\r\n        File \"/home/ianch/.local/share/edgedb/portable/1.0/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1710, in _try_compile\r\n          comp, capabilities = self._compile_dispatch_ql(\r\n        File \"/home/ianch/.local/share/edgedb/portable/1.0/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1593, in _compile_dispatch_ql    \r\n          query = self._compile_ql_migration(ctx, ql)\r\n        File \"/home/ianch/.local/share/edgedb/portable/1.0/lib/python3.10/site-packages/edb/server/compiler/compiler.py\", line 1091, in _compile_ql_migration   \r\n          proposed_ddl = s_ddl.statements_from_delta(\r\n        File \"/home/ianch/.local/share/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/ddl.py\", line 707, in statements_from_delta\r\n          stmts = ddlast_from_delta(\r\n        File \"/home/ianch/.local/share/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/ddl.py\", line 688, in ddlast_from_delta\r\n          ql_ast = command.get_ast(schema, context)\r\n        File \"/home/ianch/.local/share/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/types.py\", line 2173, in get_ast\r\n          return super().get_ast(schema, context, parent_node=parent_node)      \r\n        File \"/home/ianch/.local/share/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/delta.py\", line 2593, in get_ast\r\n          return self._get_ast(schema, context, parent_node=parent_node)        \r\n        File \"/home/ianch/.local/share/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/objtypes.py\", line 567, in _get_ast\r\n          return super()._get_ast(schema, context, parent_node=parent_node)     \r\n        File \"/home/ianch/.local/share/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/types.py\", line 779, in _get_ast\r\n          return super()._get_ast(schema, context, parent_node=parent_node)     \r\n        File \"/home/ianch/.local/share/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/delta.py\", line 2159, in _get_ast\r\n          self._apply_fields_ast(schema, context, op)\r\n        File \"/home/ianch/.local/share/edgedb/portable/1.0/lib/python3.10/site-packages/edb/schema/delta.py\", line 2240, in _apply_fields_ast\r\n          assert all(\r\n      AssertionError\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3521/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3521/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3499", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3499/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3499/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3499/events", "html_url": "https://github.com/edgedb/edgedb/issues/3499", "id": 1139301667, "node_id": "I_kwDOBbYNSM5D6F0j", "number": 3499, "title": "Filter on computed link on computed link", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-02-15T23:02:07Z", "updated_at": "2022-03-08T18:14:24Z", "closed_at": "2022-03-08T18:14:24Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Discussed in https://github.com/edgedb/edgedb/discussions/3498\r\n\r\n<div type='discussions-op-text'>\r\n\r\n<sup>Originally posted by **tchak** February 15, 2022</sup>\r\nI have the following schema:\r\n\r\n```\r\nmodule default {\r\n  type Version {\r\n    multi link fields -> Field {\r\n      property position -> int32 {\r\n        default := 0;\r\n      }\r\n    }\r\n    multi link ordered_fields := (select .fields order by @position);\r\n    multi link sections := (select .ordered_fields filter .type = 'section');\r\n  }\r\n\r\n  type Field {\r\n    required property name -> str;\r\n    required property type -> str;\r\n    multi link versions := .<fields[is Version];\r\n  }\r\n}\r\n```\r\n\r\nI am getting the following error on migrate:\r\n\r\n```\r\nerror: object type 'default::Field' has no link or property 'type'\r\n    \u250c\u2500 ./dbschema/default.esdl:174:59\r\n    \u2502\r\n174 \u2502     multi link sections := (select .ordered_fields filter .type = 'section');\r\n    \u2502                                                           ^^^^^ error\r\n```\r\n\r\nI don't know if I am doing something wrong or if this is a bug. I have the same issue with a filter on an already filtered computed. I am also pretty sure I have something similar working on single computed links.</div>", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3499/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3499/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3494", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3494/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3494/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3494/events", "html_url": "https://github.com/edgedb/edgedb/issues/3494", "id": 1139012839, "node_id": "I_kwDOBbYNSM5D4_Tn", "number": 3494, "title": "Sequence default fails in migration", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2022-02-15T17:40:44Z", "updated_at": "2022-02-21T21:00:25Z", "closed_at": "2022-02-21T21:00:25Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Discussed in https://github.com/edgedb/edgedb/discussions/3493\r\n\r\n<div type='discussions-op-text'>\r\n\r\n<sup>Originally posted by **tchak** February 15, 2022</sup>\r\nI have the following schema:\r\n\r\n```\r\nmodule default {\r\n  scalar type ProjectNumber extending sequence;\r\n\r\n  type Project {\r\n    required property number -> ProjectNumber {\r\n      constraint exclusive;\r\n    }\r\n    required property name -> str;\r\n  }\r\n}\r\n```\r\n\r\nI expect `number` to be autofilled. But when I use this schema from TypeScript driver type signature refuses to let me create a Project without specifying a `number` property. I tried the following schema but it failed on migration:\r\n\r\n```\r\nmodule default {\r\n  scalar type ProjectNumber extending sequence;\r\n\r\n  type Project {\r\n    required property number -> ProjectNumber {\r\n      constraint exclusive;\r\n      default := sequence_next(introspect ProjectNumber);\r\n    }\r\n    required property name -> str;\r\n  }\r\n}\r\n```\r\n\r\nIs this is a bug or intended behaviour ?</div>", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3494/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3494/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3454", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3454/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3454/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3454/events", "html_url": "https://github.com/edgedb/edgedb/issues/3454", "id": 1132918891, "node_id": "I_kwDOBbYNSM5Dhvhr", "number": 3454, "title": "Error on initial deployment to Google Cloud", "user": {"login": "bondo", "id": 815615, "node_id": "MDQ6VXNlcjgxNTYxNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/815615?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bondo", "html_url": "https://github.com/bondo", "followers_url": "https://api.github.com/users/bondo/followers", "following_url": "https://api.github.com/users/bondo/following{/other_user}", "gists_url": "https://api.github.com/users/bondo/gists{/gist_id}", "starred_url": "https://api.github.com/users/bondo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bondo/subscriptions", "organizations_url": "https://api.github.com/users/bondo/orgs", "repos_url": "https://api.github.com/users/bondo/repos", "events_url": "https://api.github.com/users/bondo/events{/privacy}", "received_events_url": "https://api.github.com/users/bondo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 2783301016, "node_id": "MDU6TGFiZWwyNzgzMzAxMDE2", "url": "https://api.github.com/repos/edgedb/edgedb/labels/integration", "name": "integration", "color": "B4AD1E", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "fmoor", "id": 8278635, "node_id": "MDQ6VXNlcjgyNzg2MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/8278635?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmoor", "html_url": "https://github.com/fmoor", "followers_url": "https://api.github.com/users/fmoor/followers", "following_url": "https://api.github.com/users/fmoor/following{/other_user}", "gists_url": "https://api.github.com/users/fmoor/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmoor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmoor/subscriptions", "organizations_url": "https://api.github.com/users/fmoor/orgs", "repos_url": "https://api.github.com/users/fmoor/repos", "events_url": "https://api.github.com/users/fmoor/events{/privacy}", "received_events_url": "https://api.github.com/users/fmoor/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fmoor", "id": 8278635, "node_id": "MDQ6VXNlcjgyNzg2MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/8278635?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmoor", "html_url": "https://github.com/fmoor", "followers_url": "https://api.github.com/users/fmoor/followers", "following_url": "https://api.github.com/users/fmoor/following{/other_user}", "gists_url": "https://api.github.com/users/fmoor/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmoor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmoor/subscriptions", "organizations_url": "https://api.github.com/users/fmoor/orgs", "repos_url": "https://api.github.com/users/fmoor/repos", "events_url": "https://api.github.com/users/fmoor/events{/privacy}", "received_events_url": "https://api.github.com/users/fmoor/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2022-02-11T17:57:23Z", "updated_at": "2022-02-22T17:55:28Z", "closed_at": "2022-02-14T20:40:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0+08d3e21\r\n- OS Version: Google cloud node version 1.21.6-gke.1500, local OS Ubuntu 20.04.3\r\n\r\nSteps to Reproduce:\r\n\r\n1. Follow the guide https://www.edgedb.com/docs/guides/deployment/gcp\r\n2. Replace the region with europe-north1\r\n3. In the \"Deploy EdgeDB\" section the pods never get ready\r\n\r\nThe logs says:\r\n```\r\n$ kubectl logs deployment/edgedb --container edgedb\r\nBootstrapping EdgeDB instance on remote Postgres cluster...\r\nINFO 35 2022-02-11T17:32:14.977 edb.server: starting EdgeDB server 1.0+08d3e21, built on 2022-02-10T00:04Z from revision e16e60d1e (2022-02-09T01:08Z) for x86_64-unknown-linux-gnu\r\n---- Exception occurred: invalid literal for int() with base 10: 'suik52Q' ----\r\n\r\n1. ValueError: invalid literal for int() with base 10: 'suik52Q'\r\n\r\n---- Traceback ----\r\n\r\n    /usr/bin/edgedb-server, line 8, in <module>\r\n        > sys.exit(main())\r\n    /usr/lib/x86_64-linux-gnu/edgedb-server-1/lib/python3.10/site-packages/click/core.py, line 829, in __call__\r\n        > return self.main(*args, **kwargs)\r\n    /usr/lib/x86_64-linux-gnu/edgedb-server-1/lib/python3.10/site-packages/click/core.py, line 782, in main\r\n        > rv = self.invoke(ctx)\r\n    /usr/lib/x86_64-linux-gnu/edgedb-server-1/lib/python3.10/site-packages/click/core.py, line 1066, in invoke\r\n        > return ctx.invoke(self.callback, **ctx.params)\r\n    /usr/lib/x86_64-linux-gnu/edgedb-server-1/lib/python3.10/site-packages/click/core.py, line 610, in invoke\r\n        > return callback(*args, **kwargs)\r\n    /usr/lib/x86_64-linux-gnu/edgedb-server-1/lib/python3.10/site-packages/edb/server/main.py, line 615, in main\r\n        > server_main(**kwargs)\r\n    /usr/lib/x86_64-linux-gnu/edgedb-server-1/lib/python3.10/site-packages/edb/server/main.py, line 604, in server_main\r\n        > asyncio.run(run_server(server_args))\r\n    /usr/lib/x86_64-linux-gnu/edgedb-server-1/lib/python3.10/asyncio/runners.py, line 44, in run\r\n        > return loop.run_until_complete(main)\r\n    uvloop/loop.pyx, line 1501, in uvloop.loop.Loop.run_until_complete\r\n        \r\n    /usr/lib/x86_64-linux-gnu/edgedb-server-1/lib/python3.10/site-packages/edb/server/main.py, line 465, in run_server\r\n        > cluster, args = await _get_remote_pgcluster(args, tenant_id)\r\n    /usr/lib/x86_64-linux-gnu/edgedb-server-1/lib/python3.10/site-packages/edb/server/main.py, line 349, in _get_remote_pgcluster\r\n        > cluster = await pgcluster.get_remote_pg_cluster(\r\n    /usr/lib/x86_64-linux-gnu/edgedb-server-1/lib/python3.10/site-packages/edb/server/pgcluster.py, line 845, in get_remote_pg_cluster\r\n        > addrs, params = pgconnparams.parse_dsn(dsn)\r\n    /usr/lib/x86_64-linux-gnu/edgedb-server-1/lib/python3.10/site-packages/edb/server/pgconnparams.py, line 308, in parse_dsn\r\n        > host, port = _parse_hostlist(dsn_hostspec, [], unquote=True)\r\n    /usr/lib/x86_64-linux-gnu/edgedb-server-1/lib/python3.10/site-packages/edb/server/pgconnparams.py, line 234, in _parse_hostlist\r\n        > hostlist_ports.append(int(hostspec_port))\r\n\r\nValueError: invalid literal for int() with base 10: 'suik52Q'\r\n/usr/local/bin/docker-entrypoint-funcs.sh: line 858: EDGEDB_SERVER_DATADIR: unbound variable\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3454/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3454/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3392", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3392/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3392/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3392/events", "html_url": "https://github.com/edgedb/edgedb/issues/3392", "id": 1120220610, "node_id": "I_kwDOBbYNSM5CxTXC", "number": 3392, "title": "InternalServerError (relation does not exist) when going from single link to multi link in abstract type", "user": {"login": "krt-z", "id": 80636916, "node_id": "MDQ6VXNlcjgwNjM2OTE2", "avatar_url": "https://avatars.githubusercontent.com/u/80636916?v=4", "gravatar_id": "", "url": "https://api.github.com/users/krt-z", "html_url": "https://github.com/krt-z", "followers_url": "https://api.github.com/users/krt-z/followers", "following_url": "https://api.github.com/users/krt-z/following{/other_user}", "gists_url": "https://api.github.com/users/krt-z/gists{/gist_id}", "starred_url": "https://api.github.com/users/krt-z/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/krt-z/subscriptions", "organizations_url": "https://api.github.com/users/krt-z/orgs", "repos_url": "https://api.github.com/users/krt-z/repos", "events_url": "https://api.github.com/users/krt-z/events{/privacy}", "received_events_url": "https://api.github.com/users/krt-z/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-02-01T04:23:47Z", "updated_at": "2022-02-03T22:20:39Z", "closed_at": "2022-02-03T22:20:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "- EdgeDB Version: 1.0-rc.5\r\n- OS Version: wsl2 under windows 10\r\n\r\nSteps to Reproduce:\r\n\r\n```\r\ncreate abstract type Person { create link lover -> Person; };\r\ncreate type NPC extending Person; # there's no issue when there is no subtype\r\nalter type Person { alter link lover { set multi; }; };\r\n```\r\n\r\nRan into this in chapter 9 of edgedb easy. Possibly related to #3309?", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3392/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3392/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3371", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3371/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3371/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3371/events", "html_url": "https://github.com/edgedb/edgedb/issues/3371", "id": 1114189248, "node_id": "I_kwDOBbYNSM5CaS3A", "number": 3371, "title": "InvalidReferenceError when migrating to a schema with a nested alias", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2022-01-25T17:48:05Z", "updated_at": "2022-05-18T00:08:25Z", "closed_at": "2022-05-18T00:08:24Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: rc4 (current master)\r\n- OS Version: linux\r\n\r\nTry migrating to this schema:\r\n```\r\ntype Bar;\r\ntype Foo;\r\nalias DeepAlias := (\r\n    select Foo {\r\n        bars := (\r\n            select Bar {\r\n                extra_data := 'only in alias'\r\n            }\r\n        ),\r\n    } limit 2\r\n);\r\n```\r\nGet the following error: `edgedb error: InvalidReferenceError: object type '__default::Foo' does not exist`\r\n\r\nUnlike #3369 this only happens in SDL mode, while breaking down the schema into 3 DDL commands works just fine. So this is much more likely to be an ordering issue.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3371/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3371/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3369", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3369/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3369/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3369/events", "html_url": "https://github.com/edgedb/edgedb/issues/3369", "id": 1114175215, "node_id": "I_kwDOBbYNSM5CaPbv", "number": 3369, "title": "InvalidReferenceError when creating an alias", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-01-25T17:33:16Z", "updated_at": "2022-07-02T01:20:12Z", "closed_at": "2022-07-02T01:20:12Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: rc4 (current master)\r\n- OS Version: linux\r\n\r\nSteps to Reproduce:\r\n\r\n```\r\nedgedb> create type Foo;\r\nOK: CREATE TYPE\r\nedgedb> create type Bar;\r\nOK: CREATE TYPE\r\nedgedb> alter type Foo create link bar := Bar{val := 42};\r\nerror: InvalidReferenceError: object type 'default::Bar' does not exist\r\n  \u250c\u2500 query:1:35\r\n  \u2502\r\n1 \u2502 alter type Foo create link bar := Bar{val := 42};\r\n  \u2502                                   ^^^^^^^^^^^^^^ error\r\n```\r\n\r\nNotice that this is achieved in DDL, so it doesn't look like a typical case of SDL ordering that prevents visibility.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3369/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3369/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3347", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3347/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3347/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3347/events", "html_url": "https://github.com/edgedb/edgedb/issues/3347", "id": 1108377471, "node_id": "I_kwDOBbYNSM5CEH9_", "number": 3347, "title": "InternalServerError: object type <QualName default::default|XXX@view~1> already exists", "user": {"login": "metmirr", "id": 11671753, "node_id": "MDQ6VXNlcjExNjcxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/11671753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/metmirr", "html_url": "https://github.com/metmirr", "followers_url": "https://api.github.com/users/metmirr/followers", "following_url": "https://api.github.com/users/metmirr/following{/other_user}", "gists_url": "https://api.github.com/users/metmirr/gists{/gist_id}", "starred_url": "https://api.github.com/users/metmirr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/metmirr/subscriptions", "organizations_url": "https://api.github.com/users/metmirr/orgs", "repos_url": "https://api.github.com/users/metmirr/repos", "events_url": "https://api.github.com/users/metmirr/events{/privacy}", "received_events_url": "https://api.github.com/users/metmirr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1284200502, "node_id": "MDU6TGFiZWwxMjg0MjAwNTAy", "url": "https://api.github.com/repos/edgedb/edgedb/labels/graphql", "name": "graphql", "color": "c2b0f4", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-01-19T17:36:23Z", "updated_at": "2022-05-20T21:59:25Z", "closed_at": "2022-05-20T21:59:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0-rc.4+1850eff\r\n- OS Version: MacOS 12.1\r\n\r\nSteps to Reproduce:\r\n\r\n1. `edgedb project init` \u2705 \r\n2. `edgedb instance create sample` \u2705 \r\n3. `edgedb -I sample migration create` \u2705 \r\n4. `edgedb -I sample migrate` \u2705 \r\n5. Go to graphiql playground\r\n\r\nError shown in the graphiql:\r\n```json\r\n{\r\n  \"errors\": [\r\n    {\r\n      \"message\": \"TypeError: Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but 'Filterdefault|ProcessedEventsLog@view~1' does not.\\n\\nNames must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but 'default|ProcessedEventsLog@view~1' does not.\\n\\nNames must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but 'default|ProcessedEventsLog@view~1' does not.\\n\\nNames must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but 'Orderdefault|ProcessedEventsLog@view~1' does not.\\n\\nNames must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but 'delete_default|ProcessedEventsLog@view~1' does not.\"\r\n    }\r\n  ]\r\n}\r\n``` \r\n\r\nNote: There are no errors during steps.\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n```\r\nusing extension graphql;\r\n\r\nmodule default {\r\n  type ProcessedEventsLog {\r\n    required property event_id -> bigint;\r\n    required property indexer_head -> int64;\r\n    required property chain_head -> int64;\r\n    required property last_scanned_block -> int64;\r\n    required property updated_at -> datetime;\r\n  }\r\n\r\n  type Transfer {\r\n    required property from -> str;\r\n    required property to -> str;\r\n    required property amount -> float64;\r\n    required property happened_in_block -> int64;\r\n  }\r\n\r\n  alias ProcessorStatus := (\r\n    select ProcessedEventsLog {\r\n      indexer_head,\r\n      last_scanned_block,\r\n      in_sync:= .last_scanned_block >= .indexer_head\r\n    }\r\n    order by .last_scanned_block DESC\r\n    limit 1\r\n  )\r\n}\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3347/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3347/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3324", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3324/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3324/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3324/events", "html_url": "https://github.com/edgedb/edgedb/issues/3324", "id": 1096612416, "node_id": "I_kwDOBbYNSM5BXPpA", "number": 3324, "title": "array_agg and enumerate can produce nulls in output", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-01-07T19:37:55Z", "updated_at": "2022-01-07T20:57:26Z", "closed_at": "2022-01-07T20:57:26Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nselect> SELECT Issue { te := array_agg(.time_estimate) };\r\n[{\"te\": [3000]}, {\"te\": [null]}, {\"te\": [null]}, {\"te\": [null]}]\r\n```\r\nand\r\n```\r\nselect> SELECT Issue { te := enumerate(.time_estimate) };\r\n[{\"te\": [0, 3000]}, {\"te\": [0, null]}, {\"te\": [0, null]}, {\"te\": [0, null]}]\r\n```\r\n\r\nThis is in json mode. In native mode, it is a protocol encoding error", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3324/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3324/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3323", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3323/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3323/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3323/events", "html_url": "https://github.com/edgedb/edgedb/issues/3323", "id": 1096607111, "node_id": "I_kwDOBbYNSM5BXOWH", "number": 3323, "title": "Another bad for-loop/computable/with interaction", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-01-07T19:29:19Z", "updated_at": "2022-01-11T01:07:37Z", "closed_at": "2022-01-11T01:07:37Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nwith props := (                                                           \r\n  for h in User union (                                                   \r\n    select h {namelen := len(h.name)}                                     \r\n  )                                                                       \r\n)                                                                         \r\nselect props {                                                            \r\n  name,                                                                   \r\n  namelen # <- adding this property causes cartesian product              \r\n};\r\n```\r\n\r\nproduces a cartesian product. Defining the computable with just `.name` instead of `h.name` works.\r\n\r\nI thought it was related to https://github.com/edgedb/edgedb/pull/2947 but who knows.\r\n\r\nreported by @jaclarke ", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3323/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3323/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3280", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3280/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3280/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3280/events", "html_url": "https://github.com/edgedb/edgedb/issues/3280", "id": 1081624885, "node_id": "I_kwDOBbYNSM5AeEk1", "number": 3280, "title": "Populate migration to empty fails", "user": {"login": "fantix", "id": 1751601, "node_id": "MDQ6VXNlcjE3NTE2MDE=", "avatar_url": "https://avatars.githubusercontent.com/u/1751601?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fantix", "html_url": "https://github.com/fantix", "followers_url": "https://api.github.com/users/fantix/followers", "following_url": "https://api.github.com/users/fantix/following{/other_user}", "gists_url": "https://api.github.com/users/fantix/gists{/gist_id}", "starred_url": "https://api.github.com/users/fantix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fantix/subscriptions", "organizations_url": "https://api.github.com/users/fantix/orgs", "repos_url": "https://api.github.com/users/fantix/repos", "events_url": "https://api.github.com/users/fantix/events{/privacy}", "received_events_url": "https://api.github.com/users/fantix/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2021-12-16T00:01:32Z", "updated_at": "2021-12-17T00:36:56Z", "closed_at": "2021-12-17T00:36:56Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0-rc.3+2b303d3\r\n- OS Version: macOS\r\n\r\nSteps to Reproduce:\r\n\r\n1. Apply the schema.\r\n2. Run the following:\r\n\r\n```\r\nedgedb> start migration to {}; populate migration; DESCRIBE CURRENT MIGRATION; commit migration;\r\nOK: START MIGRATION\r\nedgedb error: SchemaDefinitionError: cannot alter property 'name' of object type 'default::Card' because this affects expression of property 'tag' of link 'avatar' of object type 'default::User'\r\n  Detail: reference to a non-existent schema item e1e49cd0-5e02-11ec-9a87-c58a1362ecd1 in schema <FlatSchema gen:1 at 0x11856ae60>\r\n```\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n\r\nhttps://github.com/edgedb/edgedb/blob/5a1d973772ef9c116249a52fd04e595a6121d805/tests/schemas/cards.esdl", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3280/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3280/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3276", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3276/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3276/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3276/events", "html_url": "https://github.com/edgedb/edgedb/issues/3276", "id": 1080385238, "node_id": "I_kwDOBbYNSM5AZV7W", "number": 3276, "title": "Cannot drop multi link in parent type", "user": {"login": "fantix", "id": 1751601, "node_id": "MDQ6VXNlcjE3NTE2MDE=", "avatar_url": "https://avatars.githubusercontent.com/u/1751601?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fantix", "html_url": "https://github.com/fantix", "followers_url": "https://api.github.com/users/fantix/followers", "following_url": "https://api.github.com/users/fantix/following{/other_user}", "gists_url": "https://api.github.com/users/fantix/gists{/gist_id}", "starred_url": "https://api.github.com/users/fantix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fantix/subscriptions", "organizations_url": "https://api.github.com/users/fantix/orgs", "repos_url": "https://api.github.com/users/fantix/repos", "events_url": "https://api.github.com/users/fantix/events{/privacy}", "received_events_url": "https://api.github.com/users/fantix/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-12-14T23:13:27Z", "updated_at": "2021-12-16T19:00:30Z", "closed_at": "2021-12-16T19:00:30Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: `1.0-rc.3+2b303d3`, `1.0-rc.2+7f1c22d`\r\n- OS Version: macOS\r\n\r\nSteps to Reproduce:\r\n\r\n```\r\nedgedb> ALTER TYPE D {\r\n.......     DROP LINK multi_link;\r\n....... };\r\nError: InternalServerError: relation \"edgedbpub.d504948c-5d32-11ec-b73c-a7c895ab6088\" does not exist\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n```\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n\r\n```\r\n    type C;\r\n    type D {\r\n        multi link multi_link -> C;\r\n    };\r\n    type E extending default::D;\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3276/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3276/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3275", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3275/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3275/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3275/events", "html_url": "https://github.com/edgedb/edgedb/issues/3275", "id": 1080366988, "node_id": "I_kwDOBbYNSM5AZReM", "number": 3275, "title": "Migration with cardinality dependency in default", "user": {"login": "fantix", "id": 1751601, "node_id": "MDQ6VXNlcjE3NTE2MDE=", "avatar_url": "https://avatars.githubusercontent.com/u/1751601?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fantix", "html_url": "https://github.com/fantix", "followers_url": "https://api.github.com/users/fantix/followers", "following_url": "https://api.github.com/users/fantix/following{/other_user}", "gists_url": "https://api.github.com/users/fantix/gists{/gist_id}", "starred_url": "https://api.github.com/users/fantix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fantix/subscriptions", "organizations_url": "https://api.github.com/users/fantix/orgs", "repos_url": "https://api.github.com/users/fantix/repos", "events_url": "https://api.github.com/users/fantix/events{/privacy}", "received_events_url": "https://api.github.com/users/fantix/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-12-14T22:43:35Z", "updated_at": "2021-12-20T17:56:11Z", "closed_at": "2021-12-20T17:56:11Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "With schema:\r\n\r\n```\r\ntype C {\r\n    required property val -> str {\r\n        constraint exclusive;\r\n    }\r\n}\r\n\r\ntype ROLinksA {\r\n    required link rol1 -> C {\r\n        readonly := True;\r\n        default := (SELECT C FILTER .val = 'D00');\r\n    }\r\n}\r\n```\r\n\r\nMigration fails:\r\n\r\n```\r\nedgedb> start migration to { module default {} }; populate migration; DESCRIBE CURRENT MIGRATION; commit migration;\r\nOK: START MIGRATION\r\nOK: POPULATE MIGRATION\r\n{\r\n  'ALTER TYPE default::C {\r\n    ALTER PROPERTY val {\r\n        DROP CONSTRAINT std::exclusive;\r\n    };\r\n};\r\nDROP TYPE default::ROLinksA;\r\nDROP TYPE default::C;\r\nDROP MODULE test;',\r\n}\r\nedgedb error: SchemaDefinitionError: cannot alter property 'val' of object type 'default::C' because this affects default expression of link 'rol1' of object type 'default::ROLinksA'\r\n  Detail: possibly more than one element returned by the default expression for link 'rol1' declared as 'single'\r\n```\r\n\r\nIt would be nice if the populated migration could handle similar situations.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3275/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3275/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3260", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3260/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3260/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3260/events", "html_url": "https://github.com/edgedb/edgedb/issues/3260", "id": 1074917965, "node_id": "I_kwDOBbYNSM5AEfJN", "number": 3260, "title": "Link props in shapes on type-intersected pointers ISE", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-12-08T23:00:15Z", "updated_at": "2022-07-19T23:13:33Z", "closed_at": "2022-07-19T23:13:32Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nSELECT Issue {                                                            \r\n  name,                                                                   \r\n  references[IS File]: {@list_order}                                      \r\n}; \r\n```\r\ngives `more than one row returned by a subquery used as an expression`", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3260/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3260/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3254", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3254/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3254/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3254/events", "html_url": "https://github.com/edgedb/edgedb/issues/3254", "id": 1073724093, "node_id": "I_kwDOBbYNSM4__7q9", "number": 3254, "title": "Problem applying shape to aliased union type", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-12-07T20:18:36Z", "updated_at": "2022-07-19T22:06:37Z", "closed_at": "2022-07-19T22:06:36Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "In the `issues` test schema, where `Issue.references` is a union type\r\n```\r\nWITH C := Issue.references SELECT C {id}\r\n```\r\nproduces\r\n`InvalidReferenceError: object type '__derived__::(default:File | default:Publication | default:URL)' does not exist`", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3254/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3254/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3247", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3247/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3247/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3247/events", "html_url": "https://github.com/edgedb/edgedb/issues/3247", "id": 1071083357, "node_id": "I_kwDOBbYNSM4_129d", "number": 3247, "title": "The ad-hoc alias doesn't work in `UPDATE`", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-12-04T01:22:53Z", "updated_at": "2021-12-06T23:59:37Z", "closed_at": "2021-12-06T23:59:37Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0-dev.6247+local\r\n- OS Version: Linux\r\n\r\nSteps to Reproduce:\r\n\r\n```\r\nedgedb> create type Foo {\r\n.......   create required property val -> int64;\r\n.......   create multi link links -> Foo;\r\n....... };\r\nOK: CREATE TYPE\r\nedgedb> insert Foo {val := 0};\r\n{default::Foo {id: cc70e034-5498-11ec-aee6-bf59b6053270}}\r\nedgedb> insert Foo {val := 1};\r\n{default::Foo {id: cd67a0a4-5498-11ec-aee6-df4da97e50c3}}\r\nedgedb> insert Foo {val := 2};\r\n{default::Foo {id: ce7f44ba-5498-11ec-aee6-07558083522c}}\r\n```\r\nFirst, just run a baseline using the ad-hoc alias to achieve different scoping of `Foo` in the `filter`:\r\n```\r\nedgedb> select _ := Foo\r\n....... filter _.val = 0;\r\n{default::Foo {id: cc70e034-5498-11ec-aee6-bf59b6053270}}\r\nedgedb> select _ := Foo\r\n....... filter Foo.val = 0;\r\n{\r\n  default::Foo {id: cc70e034-5498-11ec-aee6-bf59b6053270},\r\n  default::Foo {id: cd67a0a4-5498-11ec-aee6-df4da97e50c3},\r\n  default::Foo {id: ce7f44ba-5498-11ec-aee6-07558083522c},\r\n}\r\n```\r\nNow lets try the same with the `update` and `filter`:\r\n```\r\nedgedb> update x := Foo\r\n....... filter x.val = 0\r\n....... set{links := {}};\r\nerror: InvalidReferenceError: object type or alias 'default::x' does not exist\r\n  \u250c\u2500 query:2:8\r\n  \u2502\r\n2 \u2502 filter x.val = 0\r\n  \u2502        ^ error\r\n```\r\nThat's already a bug, the `fitler` should see `x` in its scope. But it gets worse for the `set` clause:\r\n```\r\nedgedb> update x := Foo\r\n....... filter .val = 0\r\n....... set{links := (select Foo filter .val = 2)};\r\n{default::Foo {id: cc70e034-5498-11ec-aee6-bf59b6053270}}\r\nedgedb> with x := Foo\r\n....... update x\r\n....... filter .val = 1\r\n....... set{links := (select Foo filter .val = 2)};\r\n{default::Foo {id: cd67a0a4-5498-11ec-aee6-df4da97e50c3}}\r\n```\r\nThe above should have produced the same effect, because the ad-hoc alias usually can be moved into the `with` block without any change in semantics. However, because of the broken scope we see the following:\r\n```\r\nedgedb> select Foo{val, links:{val}};\r\n{\r\n  default::Foo {val: 0, links: {}},\r\n  default::Foo {val: 1, links: {default::Foo {val: 2}}},\r\n  default::Foo {val: 2, links: {}},\r\n}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3247/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3247/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3245", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3245/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3245/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3245/events", "html_url": "https://github.com/edgedb/edgedb/issues/3245", "id": 1070998783, "node_id": "I_kwDOBbYNSM4_1iT_", "number": 3245, "title": "InternalServerError when selecting computed property created from link property", "user": {"login": "jaclarke", "id": 2085287, "node_id": "MDQ6VXNlcjIwODUyODc=", "avatar_url": "https://avatars.githubusercontent.com/u/2085287?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaclarke", "html_url": "https://github.com/jaclarke", "followers_url": "https://api.github.com/users/jaclarke/followers", "following_url": "https://api.github.com/users/jaclarke/following{/other_user}", "gists_url": "https://api.github.com/users/jaclarke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaclarke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaclarke/subscriptions", "organizations_url": "https://api.github.com/users/jaclarke/orgs", "repos_url": "https://api.github.com/users/jaclarke/repos", "events_url": "https://api.github.com/users/jaclarke/events{/privacy}", "received_events_url": "https://api.github.com/users/jaclarke/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-12-03T21:54:27Z", "updated_at": "2021-12-09T05:31:50Z", "closed_at": "2021-12-09T05:31:50Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: 1.0-dev.6184+1833814\r\n\r\nSteps to Reproduce:\r\n```\r\nedgedb> WITH\r\n.......   __scope_0_Movie := (DETACHED default::Movie)\r\n....... SELECT (__scope_0_Movie) {\r\n.......   id,\r\n.......   characters := (\r\n.......     WITH\r\n.......       __scope_1_Person := (\r\n.......         SELECT __scope_0_Movie.characters {\r\n.......           __linkprop_character_name := __scope_0_Movie.characters@character_name\r\n.......         }\r\n.......       )\r\n.......     SELECT (__scope_1_Person) {\r\n.......       name,\r\n.......       single @character_name := (__scope_1_Person.__linkprop_character_name)\r\n.......     }\r\n.......   )\r\n....... };\r\nedgedb error: InternalServerError: more than one row returned by a subquery used as an expression\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: more than one row returned by a subquery used as an expression\r\n```\r\n\r\nSchema: https://github.com/edgedb/edgedb-js/blob/a410b1630214db8dc2c19b71b94d26e6b348a917/qb/dbschema/default.esdl (with data inserted in test setup: https://github.com/edgedb/edgedb-js/blob/a410b1630214db8dc2c19b71b94d26e6b348a917/qb/test/setupTeardown.ts#L37)\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3245/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3245/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3208", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3208/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3208/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3208/events", "html_url": "https://github.com/edgedb/edgedb/issues/3208", "id": 1060529946, "node_id": "I_kwDOBbYNSM4_Nmca", "number": 3208, "title": "Migration creation fails despite no questions asked", "user": {"login": "colinhacks", "id": 3084745, "node_id": "MDQ6VXNlcjMwODQ3NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/3084745?v=4", "gravatar_id": "", "url": "https://api.github.com/users/colinhacks", "html_url": "https://github.com/colinhacks", "followers_url": "https://api.github.com/users/colinhacks/followers", "following_url": "https://api.github.com/users/colinhacks/following{/other_user}", "gists_url": "https://api.github.com/users/colinhacks/gists{/gist_id}", "starred_url": "https://api.github.com/users/colinhacks/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/colinhacks/subscriptions", "organizations_url": "https://api.github.com/users/colinhacks/orgs", "repos_url": "https://api.github.com/users/colinhacks/repos", "events_url": "https://api.github.com/users/colinhacks/events{/privacy}", "received_events_url": "https://api.github.com/users/colinhacks/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-11-22T19:45:55Z", "updated_at": "2021-11-30T13:34:37Z", "closed_at": "2021-11-29T22:16:01Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "In a project with lots of migrations, I'm no longer able to create new migrations. The `edgedb migration create` command fails without asking any questions.\r\n\r\n```\r\n$ edgedb migration create\r\nedgedb error: EdgeDB could not resolve migration with the provided answers. Please retry with different answers.\r\n```\r\n\r\nThis is a path-dependent problem - when I deleted the existing migrations and \u201csquashed\u201d them into a single new migration this went away. \r\n\r\nRepro\r\n\r\n```\r\ngit clone git@github.com:colinhacks/lotsa-migrations.git\r\ncd lotsa-migrations\r\nedgedb project init\r\nedgedb migration create\r\n```\r\n\r\n\r\n[lotsa-migrations.zip](https://github.com/edgedb/edgedb/files/7584266/lotsa-migrations.zip)\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3208/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3208/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3195", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3195/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3195/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3195/events", "html_url": "https://github.com/edgedb/edgedb/issues/3195", "id": 1056698610, "node_id": "I_kwDOBbYNSM4--_Dy", "number": 3195, "title": "Functions don't always have correct strictness behavior with empty sets", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-11-17T22:33:12Z", "updated_at": "2021-11-19T18:09:58Z", "closed_at": "2021-11-19T18:09:58Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Consider, in our `issues` test repo:\r\n```\r\ncreate function foo(x: str, y: int64) -> str USING (x);\r\n\r\nSELECT BooleanTest { name, val, x := foo(.name, .val) };\r\n```\r\n\r\nHere, we'll incorrectly output `.name`, even when `.val` is empty.\r\n\r\nThis only happens downstream of something actually being represented as `NULL` in SQL, like when it comes from a table; `SELECT foo(\"test\", (SELECT 1 FILTER false))` behaves correctly", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3195/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3195/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3183", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3183/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3183/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3183/events", "html_url": "https://github.com/edgedb/edgedb/issues/3183", "id": 1052746816, "node_id": "I_kwDOBbYNSM4-v6RA", "number": 3183, "title": "Changing type of overloaded link leads to weird errors during migration creation", "user": {"login": "CodesInChaos", "id": 320473, "node_id": "MDQ6VXNlcjMyMDQ3Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/320473?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CodesInChaos", "html_url": "https://github.com/CodesInChaos", "followers_url": "https://api.github.com/users/CodesInChaos/followers", "following_url": "https://api.github.com/users/CodesInChaos/following{/other_user}", "gists_url": "https://api.github.com/users/CodesInChaos/gists{/gist_id}", "starred_url": "https://api.github.com/users/CodesInChaos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CodesInChaos/subscriptions", "organizations_url": "https://api.github.com/users/CodesInChaos/orgs", "repos_url": "https://api.github.com/users/CodesInChaos/repos", "events_url": "https://api.github.com/users/CodesInChaos/events{/privacy}", "received_events_url": "https://api.github.com/users/CodesInChaos/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2021-11-13T18:56:15Z", "updated_at": "2021-11-17T19:31:13Z", "closed_at": "2021-11-17T19:31:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "- EdgeDB Version: 1-rc2\r\n- OS Version: xubuntu 20.04.3\r\n\r\nSteps to Reproduce:\r\n\r\nRunning `edgedb migration create --non-interactive --allow-unsafe` using the schema below returns the following error:\r\n\r\n> edgedb error: SchemaError: link 'entity' of object type 'default::DogVersion' cannot be cast automatically from object type 'default::Versioned' to object type 'default::Dog'\r\n  Hint: You might need to specify a conversion expression in a USING clause\r\n  Server traceback: [...]\r\n\r\nThe interactive version is even worse, it gets stuck in an endless loop attempting to roll back a step.\r\n\r\nSchema:\r\n```\r\nmodule default {\r\n\tabstract type Version {\r\n\t\trequired link entity -> Versioned {\r\n\t\t\treadonly := true;\r\n\t\t}\r\n\t}\r\n\r\n\tabstract type Barks {\r\n\t}\r\n\r\n\tabstract type Versioned {\r\n\t}\r\n\r\n\ttype DogVersion extending Version, Barks {\r\n\t\toverloaded required link entity -> Dog;\r\n\t}\r\n\r\n\ttype Dog extending Versioned {\r\n\t\tmulti link versions := (SELECT Dog.<entity[IS DogVersion]);\r\n\t}\r\n\r\n\ttype CatVersion extending Version {\r\n\t\toverloaded required link entity -> Cat;\r\n\t}\r\n\r\n\ttype Cat extending Versioned {\r\n\t}\r\n}\r\n```\r\n\r\nThis example is very fragile, even apparently unrelated changes like removing `Barks` from `Dog` or renaming types can lead to it successfully creating a migration.\r\n\r\nThe migration it produces when I remove `Barks` from `Dog`:\r\n\r\n```\r\nCREATE MIGRATION m1qqz546xpyqxoha4ipcw3upqbnzzudphdkihdojuu6bbui4r53gwq\r\n    ONTO initial\r\n{\r\n  CREATE ABSTRACT TYPE default::Barks;\r\n  CREATE ABSTRACT TYPE default::Versioned;\r\n  CREATE TYPE default::Cat EXTENDING default::Versioned;\r\n  CREATE ABSTRACT TYPE default::Version {\r\n      CREATE REQUIRED LINK entity -> default::Versioned {\r\n          SET readonly := true;\r\n      };\r\n  };\r\n  CREATE TYPE default::CatVersion EXTENDING default::Version {\r\n      ALTER LINK entity {\r\n          SET OWNED;\r\n          SET REQUIRED;\r\n          SET TYPE default::Cat;\r\n      };\r\n  };\r\n  CREATE TYPE default::Dog EXTENDING default::Versioned;\r\n  CREATE TYPE default::DogVersion EXTENDING default::Version {\r\n      ALTER LINK entity {\r\n          SET OWNED;\r\n          SET REQUIRED;\r\n          SET TYPE default::Dog;\r\n      };\r\n  };\r\n  ALTER TYPE default::Dog {\r\n      CREATE MULTI LINK versions := (SELECT\r\n          default::Dog.<entity[IS default::DogVersion]\r\n      );\r\n  };\r\n};\r\n```\r\n\r\nI also had a variant where interactive mode asked for a conversion expression for such a link.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3183/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3183/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3160", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3160/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3160/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3160/events", "html_url": "https://github.com/edgedb/edgedb/issues/3160", "id": 1049006734, "node_id": "I_kwDOBbYNSM4-hpKO", "number": 3160, "title": "`__typename__` injection on queries in std modules raises `SchemaDefinitionError`", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-11-09T19:29:55Z", "updated_at": "2021-11-09T22:44:32Z", "closed_at": "2021-11-09T22:44:32Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nedgedb> SELECT INTROSPECT TYPEOF schema::ObjectType.properties.target;\r\nedgedb error: SchemaDefinitionError: cannot alter object type 'schema::ObjectType': module schema is read-only\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3160/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3160/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3120", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3120/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3120/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3120/events", "html_url": "https://github.com/edgedb/edgedb/issues/3120", "id": 1042880742, "node_id": "I_kwDOBbYNSM4-KRjm", "number": 3120, "title": "InternalServerError: failed to lookup transaction or savepoint", "user": {"login": "jaclarke", "id": 2085287, "node_id": "MDQ6VXNlcjIwODUyODc=", "avatar_url": "https://avatars.githubusercontent.com/u/2085287?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaclarke", "html_url": "https://github.com/jaclarke", "followers_url": "https://api.github.com/users/jaclarke/followers", "following_url": "https://api.github.com/users/jaclarke/following{/other_user}", "gists_url": "https://api.github.com/users/jaclarke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaclarke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaclarke/subscriptions", "organizations_url": "https://api.github.com/users/jaclarke/orgs", "repos_url": "https://api.github.com/users/jaclarke/repos", "events_url": "https://api.github.com/users/jaclarke/events{/privacy}", "received_events_url": "https://api.github.com/users/jaclarke/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-11-02T21:45:00Z", "updated_at": "2023-01-26T22:54:30Z", "closed_at": "2023-01-26T22:54:30Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: 1.0-rc.2+dev6135.d2021110220.ga97561df3.cv202111010000\r\n\r\nSteps to Reproduce:\r\n\r\n```python\r\nimport edgedb\r\n\r\ndef main():\r\n    conn = edgedb.connect('_localdev')\r\n\r\n    conn.query('start transaction')\r\n\r\n    try:\r\n        conn.query_single('rollback')\r\n    except edgedb.InterfaceError:\r\n        # ignore 'query cannot be executed with query_single() as it does not return any data' error\r\n        pass\r\n\r\n    conn.query('rollback')\r\n\r\n    conn.close()\r\n\r\nif __name__ == '__main__':\r\n    main()\r\n```\r\n```\r\n$ python test.py\r\nTraceback (most recent call last):\r\n  File \"/home/james/dev/edgedb-python/test.py\", line 19, in <module>\r\n    main()\r\n  File \"/home/james/dev/edgedb-python/test.py\", line 14, in main\r\n    conn.query('rollback')\r\n  File \"/home/james/dev/edgedb-python/edgedb/blocking_con.py\", line 346, in query\r\n    return self._execute(\r\n  File \"/home/james/dev/edgedb-python/edgedb/blocking_con.py\", line 325, in _execute\r\n    raise e\r\n  File \"/home/james/dev/edgedb-python/edgedb/blocking_con.py\", line 314, in _execute\r\n    return self._get_protocol().sync_execute_anonymous(\r\n  File \"edgedb/protocol/blocking_proto.pyx\", line 105, in edgedb.protocol.blocking_proto.BlockingIOProtocol.sync_execute_anonymous\r\n    result, _headers = self._iter_coroutine(\r\n  File \"edgedb/protocol/blocking_proto.pyx\", line 91, in edgedb.protocol.blocking_proto.BlockingIOProtocol._iter_coroutine\r\n    coro.send(None)\r\n  File \"edgedb/protocol/protocol.pyx\", line 617, in execute_anonymous\r\n    codecs = await self._parse(\r\n  File \"edgedb/protocol/protocol.pyx\", line 283, in _parse\r\n    raise exc\r\nedgedb.errors.InternalServerError: failed to lookup transaction or savepoint with id=35938955293271\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3120/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3120/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3118", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3118/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3118/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3118/events", "html_url": "https://github.com/edgedb/edgedb/issues/3118", "id": 1042790307, "node_id": "I_kwDOBbYNSM4-J7ej", "number": 3118, "title": "Dependent objects (like indexes) not handled when property is deleted/recreated", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-11-02T20:38:28Z", "updated_at": "2021-11-03T07:07:06Z", "closed_at": "2021-11-03T07:07:06Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "As an example, see test `test_schema_migrations_equivalence_54`:\r\nWe wish to migrate from\r\n```\r\ntype User {\r\n      required property name -> str;\r\n      index on (__subject__.name);\r\n};\r\n```\r\nto\r\n```\r\nscalar type Slug extending str;\r\nabstract type Named {\r\n    required property name -> Slug;\r\n    index on (__subject__.name);\r\n};\r\ntype User extending Named;\r\n```\r\n\r\nFor better or worse (... likely worse), the initially inferred migration path is to delete the property `name` and let it get recreated when we inherit it. We produce this migration:\r\n```\r\nALTER TYPE default::User {\r\n    DROP PROPERTY name;\r\n    EXTENDING default::Named LAST;\r\n};\r\nALTER TYPE default::User {\r\n    ALTER INDEX ON (__subject__.name) DROP OWNED;\r\n};\r\n```\r\nThe problem is that the index becomes invalid when we drop name; if we are dropping `name`, we need to also drop the index on it, and let it get recreated.\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3118/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3118/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3022", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3022/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3022/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3022/events", "html_url": "https://github.com/edgedb/edgedb/issues/3022", "id": 1023010285, "node_id": "I_kwDOBbYNSM48-eXt", "number": 3022, "title": "Cross-type same-query conflict checker can miss conflicting inserts", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-10-11T18:43:17Z", "updated_at": "2021-10-11T23:25:50Z", "closed_at": "2021-10-11T23:25:50Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Somehow we screw this one up:\r\n```\r\nWITH name := 'Madeline Hatch',                                            \r\n     B := (INSERT Person {name := name}),                                 \r\n     F := (INSERT DerivedPerson {name := name}),                          \r\n     Z := (B, F),                                                         \r\nSELECT Z\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3022/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3022/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3003", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/3003/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/3003/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/3003/events", "html_url": "https://github.com/edgedb/edgedb/issues/3003", "id": 1015628347, "node_id": "I_kwDOBbYNSM48iUI7", "number": 3003, "title": "Migrations have problems with computed links changing cardinality.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-10-04T20:59:30Z", "updated_at": "2021-11-02T23:36:42Z", "closed_at": "2021-11-02T23:36:42Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: RC1\r\n- OS Version: linux\r\n\r\nSee #3002, tests `test_schema_migrations_equivalence_constraint_06`, `test_schema_migrations_equivalence_constraint_07`, `test_schema_migrations_equivalence_constraint_08`.\r\n\r\n```\r\ntype Cell {\r\n    link right -> Cell;\r\n    link left := .<right[IS Cell];\r\n}\r\n```\r\n\r\nThe setup is that a many-to-one link (`right`) gets an exclusive constraint to become one-to-one, the corresponding computed link (`left`) based on the backlink should become one-to-one as well. This fails in a variety of ways depending on the particular migration path. All of the individual schemas appear to have correct cardinality inference when taken separately, though.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/3003/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/3003/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2979", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2979/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2979/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2979/events", "html_url": "https://github.com/edgedb/edgedb/issues/2979", "id": 1010103984, "node_id": "I_kwDOBbYNSM48NPaw", "number": 2979, "title": "Computables of shapes inside arrays have problems", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-09-28T19:02:58Z", "updated_at": "2021-10-30T01:34:10Z", "closed_at": "2021-10-30T01:34:10Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Computables inside shapes in arrays tend to behave pretty weirdly.\r\n* If the computable needs materialization, we will not properly extract things\r\n* `SELECT array_agg((SELECT User {m := 10}))[1000].m` returns `10` instead of failing\r\n\r\nOne thing I considered is to discard views when using array elimination forms (indexing, array_unpack, array_get), which would solve these problems by disallowing them, but among other things that would break casting an array with a shape to json (since we compile that using an array_unpack).", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2979/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2979/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2953", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2953/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2953/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2953/events", "html_url": "https://github.com/edgedb/edgedb/issues/2953", "id": 1004390134, "node_id": "I_kwDOBbYNSM473cb2", "number": 2953, "title": "Cannt determine backend storage parameters in sub query", "user": {"login": "clmnin", "id": 17064666, "node_id": "MDQ6VXNlcjE3MDY0NjY2", "avatar_url": "https://avatars.githubusercontent.com/u/17064666?v=4", "gravatar_id": "", "url": "https://api.github.com/users/clmnin", "html_url": "https://github.com/clmnin", "followers_url": "https://api.github.com/users/clmnin/followers", "following_url": "https://api.github.com/users/clmnin/following{/other_user}", "gists_url": "https://api.github.com/users/clmnin/gists{/gist_id}", "starred_url": "https://api.github.com/users/clmnin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/clmnin/subscriptions", "organizations_url": "https://api.github.com/users/clmnin/orgs", "repos_url": "https://api.github.com/users/clmnin/repos", "events_url": "https://api.github.com/users/clmnin/events{/privacy}", "received_events_url": "https://api.github.com/users/clmnin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-09-22T14:48:33Z", "updated_at": "2021-09-23T02:41:18Z", "closed_at": "2021-09-23T02:41:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "* EdgeDB 1.0-beta.3+g8ab4a7be0.cv202108020000 (repl 1.0.0-beta.3)\r\n* Ubuntu\r\n\r\n```sql\r\nSTART MIGRATION TO {\r\n    module default {\r\n        type Company {\r\n            required property name -> str {\r\n                constraint exclusive;\r\n            }\r\n        }\r\n        type Product {\r\n            required property name -> str;\r\n            required link company -> Company;\r\n        }\r\n        type User {\r\n            required property name -> str;\r\n            multi link company -> Company;\r\n        }\r\n    }\r\n};\r\nPOPULATE MIGRATION;\r\nCOMMIT MIGRATION;\r\n\r\nINSERT Company {name := \"ABC\"};\r\nINSERT Company {name := \"XYZ\"};\r\n# Alice linked to Company=ABC and XYZ\r\nINSERT User {name := \"Alice\", company := {\r\n    (SELECT Company FILTER .name = \"ABC\"),\r\n    (SELECT Company FILTER .name = \"XYZ\")\r\n    }\r\n};\r\n\r\n# this query fails\r\nSELECT (\r\n    UPDATE User FILTER .name = <str>\"Alice\" SET {\r\n        company -= (SELECT Company FILTER .name = <str>\"ABC\")\r\n    }\r\n) {\r\n    company : {\r\n        members := .<company[IS User].name\r\n    }\r\n};\r\n```\r\n\r\n**Exception**\r\n> edb.errors.InternalServerError: cannot determine backend storage parameters for the __derived__::__|company@__derived__|(opaque: default:Product || default:User) pointer: unexpected characteristics\r\n\r\nSimilar to \r\n* #2360 \r\n* which was closed in #2385 \r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2953/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2953/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2928", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2928/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2928/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2928/events", "html_url": "https://github.com/edgedb/edgedb/issues/2928", "id": 992547723, "node_id": "MDU6SXNzdWU5OTI1NDc3MjM=", "number": 2928, "title": "Materialization busted inside nested aliases", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-09-09T19:15:38Z", "updated_at": "2021-09-21T17:40:38Z", "closed_at": "2021-09-21T17:14:33Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "See `test_edgeql_for_in_computable_02b` and `test_edgeql_for_in_computable_02c`, in #2915.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2928/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2928/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2926", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2926/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2926/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2926/events", "html_url": "https://github.com/edgedb/edgedb/issues/2926", "id": 991723363, "node_id": "MDU6SXNzdWU5OTE3MjMzNjM=", "number": 2926, "title": "Overloaded function cannot be deleted", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-09-09T03:41:24Z", "updated_at": "2021-09-09T20:45:29Z", "closed_at": "2021-09-09T20:45:29Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: EdgeDB 1.0-beta.4+dev5960.d2021090721.gdac3f0c40.cv202109030000\r\n- OS Version: linux\r\n\r\nIt used to work in `1-beta3`, so it must be a recent regression.\r\n\r\nSteps to Reproduce:\r\n\r\n```\r\ndb> create type Person {\r\n...     create property name -> str;\r\n...     create property strength -> int16;\r\n... };\r\nOK: CREATE TYPE\r\ndb> create function fight(one: Person, two: Person) -> str \r\n... using (one.name ++ two.name);\r\nOK: CREATE FUNCTION\r\ndb> create function fight(names: str, one: int16, two: str) -> str\r\n... using (names ++ <str>one ++ two);\r\nOK: CREATE FUNCTION\r\ndb> drop function fight(one: Person, two: Person);\r\nedgedb error: InternalServerError: unexpected overload on multiple parameters in object-taking function\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler_pool/worker.py\", line 308, in worker\r\n          res = meth(*args)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler_pool/worker.py\", line 176, in compile\r\n          units, cstate = COMPILER.compile(\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 2059, in compile\r\n          units = self._compile(ctx=ctx, source=source)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 1621, in _compile\r\n          return self._try_compile(ctx=ctx, source=source)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 1674, in _try_compile\r\n          comp, capabilities = self._compile_dispatch_ql(ctx, stmt)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 1568, in _compile_dispatch_ql\r\n          self._compile_and_apply_ddl_stmt(ctx, ql),\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 769, in _compile_and_apply_ddl_stmt\r\n          return self._compile_and_apply_ddl_stmt(ctx, cm)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 842, in _compile_and_apply_ddl_stmt\r\n          block, new_types = self._process_delta(ctx, delta)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 341, in _process_delta\r\n          schema = pgdelta.apply(schema, context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/delta.py\", line 5685, in apply\r\n          schema = sd.DeltaRoot.apply(self, schema, context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/schema/delta.py\", line 1401, in apply\r\n          schema = objop.apply(schema, context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/delta.py\", line 229, in apply\r\n          schema = self.__class__.get_adaptee().apply(self, schema, context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/schema/delta.py\", line 2826, in apply\r\n          schema = self._create_innards(schema, context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/schema/delta.py\", line 2793, in _create_innards\r\n          schema = op.apply(schema, context=context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/delta.py\", line 1252, in apply\r\n          dbf, overload_replace = self.compile_edgeql_function(\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/delta.py\", line 1065, in compile_edgeql_function\r\n          body = self.compile_edgeql_overloaded_function_body(\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/delta.py\", line 945, in compile_edgeql_overloaded_function_body\r\n          raise AssertionError(\r\n      AssertionError: unexpected overload on multiple parameters in object-taking function\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2926/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2926/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2925", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2925/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2925/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2925/events", "html_url": "https://github.com/edgedb/edgedb/issues/2925", "id": 991716288, "node_id": "MDU6SXNzdWU5OTE3MTYyODg=", "number": 2925, "title": "Compiler error when a regular link and backlink are present", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-09-09T03:22:12Z", "updated_at": "2021-09-21T22:25:58Z", "closed_at": "2021-09-21T22:25:58Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: EdgeDB 1.0-beta.4+dev5960.d2021090721.gdac3f0c40.cv202109030000\r\n- OS Version: linux\r\n\r\nThis is used as an example in easy-edgedb and it used to work in `1-beta3`, so it must be a recent regression.\r\n\r\nSteps to Reproduce:\r\n\r\n```\r\ndb> START MIGRATION TO {\r\n...   module default {\r\n...     abstract type HasName {\r\n...       required property name -> str {\r\n...         constraint exclusive;\r\n...       }\r\n...     }\r\n... \r\n...     type Place extending HasName;\r\n...     \r\n...     type Ship extending HasName;\r\n... \r\n...     type Visit {\r\n...       link ship -> Ship;\r\n...       link place -> Place;\r\n...     }\r\n...   }\r\n... };\r\n... POPULATE MIGRATION;\r\n... COMMIT MIGRATION;\r\nOK: START MIGRATION\r\nOK: POPULATE MIGRATION\r\nOK: COMMIT MIGRATION\r\ndb> INSERT Ship {\r\n...   name := 'Czarina Catherine',\r\n... };\r\n{default::Ship {id: 79a5b358-111c-11ec-a6bf-efc7460a3767}}\r\ndb> FOR city in {'London', 'Varna', 'Galatz'}\r\n... UNION (INSERT Place {name := city});\r\n{\r\n  default::Place {id: 87676734-111c-11ec-a6bf-bbc97c3d1eb1},\r\n  default::Place {id: 87676b3a-111c-11ec-a6bf-432547651615},\r\n  default::Place {id: 87676c5c-111c-11ec-a6bf-53dcf2e74935},\r\n}\r\ndb> FOR visit in {\r\n...     ('Czarina Catherine', 'London'),\r\n...     ('Czarina Catherine', 'Galatz')}\r\n... UNION (\r\n...   INSERT Visit {\r\n...     ship := (SELECT Ship FILTER .name = visit.0),\r\n...     place := (SELECT Place FILTER .name = visit.1),\r\n...   }\r\n... );\r\n{\r\n  default::Visit {id: 8b8b3cfa-111c-11ec-a6bf-2f4e99499ffa},\r\n  default::Visit {id: 8b8b4aba-111c-11ec-a6bf-576af7bf0305},\r\n}\r\n```\r\n\r\nSo far so good, now here's one way to see `Visit`:\r\n```\r\ndb> select Visit {\r\n...   place: {name},\r\n...   ship: {name},\r\n... };\r\n{\r\n  default::Visit {\r\n    place: default::Place {name: 'London'},\r\n    ship: default::Ship {name: 'Czarina Catherine'},\r\n  },\r\n  default::Visit {\r\n    place: default::Place {name: 'Galatz'},\r\n    ship: default::Ship {name: 'Czarina Catherine'},\r\n  },\r\n}\r\n```\r\n\r\nAnd here's a way that fails:\r\n```\r\ndb> select Ship.<ship[IS Visit] {\r\n...   place: {name},\r\n...   ship: {name},\r\n... };\r\nInternalServerError: missing FROM-clause entry for table \"Ship~4\"\r\n```\r\n\r\n...but it works fine if we don't refer to `ship` in the shape:\r\n\r\n```\r\ndb> select Ship.<ship[IS Visit] {\r\n...   place: {name},\r\n... };\r\n{\r\n  default::Visit {place: default::Place {name: 'London'}},\r\n  default::Visit {place: default::Place {name: 'Galatz'}},\r\n}\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2925/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2925/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2924", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2924/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2924/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2924/events", "html_url": "https://github.com/edgedb/edgedb/issues/2924", "id": 991702754, "node_id": "MDU6SXNzdWU5OTE3MDI3NTQ=", "number": 2924, "title": "Function doesn't work when its arguments are unpacked from a tuple", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-09-09T02:54:57Z", "updated_at": "2021-09-14T16:01:48Z", "closed_at": "2021-09-14T16:01:48Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: EdgeDB 1.0-beta.4+dev5960.d2021090721.gdac3f0c40.cv202109030000\r\n- OS Version: linux\r\n\r\nThis is used as an example in `easy-edgedb` and it used to work in `1-beta3`, so it must be a recent regression.\r\n\r\nSteps to Reproduce:\r\n\r\n```\r\ndb> create type Foo {create required property name -> str};\r\n... create function pair(a: Foo, b: Foo) -> str using (a.name ++ ', ' ++ b.name);\r\n... insert Foo {name := 'q'};\r\n... insert Foo {name := 'w'};\r\nOK: CREATE TYPE\r\nOK: CREATE FUNCTION\r\n{default::Foo {id: 0a310742-1118-11ec-87c7-ff19e2de9a72}}\r\n{default::Foo {id: 0a321e48-1118-11ec-87c7-5ff3def6f4c8}}\r\ndb> select pair(Foo, detached Foo);\r\n{'q, q', 'q, w', 'w, q', 'w, w'}\r\ndb> with data := (Foo, detached Foo),\r\n... select [data.1, data.0];\r\n{\r\n  [default::Foo {id: 0a310742-1118-11ec-87c7-ff19e2de9a72}, default::Foo {id: 0a310742-1118-11ec-87c7-ff19e2de9a72}],\r\n  [default::Foo {id: 0a310742-1118-11ec-87c7-ff19e2de9a72}, default::Foo {id: 0a321e48-1118-11ec-87c7-5ff3def6f4c8}],\r\n  [default::Foo {id: 0a321e48-1118-11ec-87c7-5ff3def6f4c8}, default::Foo {id: 0a310742-1118-11ec-87c7-ff19e2de9a72}],\r\n  [default::Foo {id: 0a321e48-1118-11ec-87c7-5ff3def6f4c8}, default::Foo {id: 0a321e48-1118-11ec-87c7-5ff3def6f4c8}],\r\n}\r\n```\r\nSo far so good, but now I want to prepare data as tuples and then call the function on them:\r\n```\r\ndb> with data := (Foo, detached Foo),\r\n... select pair(data.0, data.1);\r\nedgedb error: InternalServerError: there is no range var for (__derived__::data@w~1).>0[IS default::Foo].>__type__[IS schema::Type] in <pg.SelectStmt at 0x7fc8e100a370>\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/__init__.py\", line 101, in compile_ir_to_sql_tree\r\n          qtree = dispatch.compile(ir_expr, ctx=ctx)\r\n        File \"/usr/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/expr.py\", line 60, in compile_Set\r\n          _compile_set_impl(ir_set, ctx=ctx)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/expr.py\", line 114, in _compile_set_impl\r\n          _compile_set(ir_set, ctx=ctx)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/expr.py\", line 592, in _compile_set\r\n          relgen.get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/relgen.py\", line 160, in get_set_rvar\r\n          return _process_toplevel_query(ir_set, ctx=ctx)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/relgen.py\", line 270, in _process_toplevel_query\r\n          rvars = _get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/relgen.py\", line 304, in _get_set_rvar\r\n          rvars = process_set_as_subquery(ir_set, stmt, ctx=ctx)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/relgen.py\", line 1193, in process_set_as_subquery\r\n          dispatch.visit(ir_set.expr, ctx=newctx)\r\n        File \"/usr/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/dispatch.py\", line 44, in visit\r\n          compile(ir, ctx=ctx)\r\n        File \"/usr/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/stmt.py\", line 98, in compile_SelectStmt\r\n          outvar = clauses.compile_output(stmt.result, ctx=ictx)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/clauses.py\", line 237, in compile_output\r\n          dispatch.visit(ir_set, ctx=newctx)\r\n        File \"/usr/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/expr.py\", line 85, in visit_Set\r\n          _compile_set_impl(ir_set, ctx=ctx)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/expr.py\", line 114, in _compile_set_impl\r\n          _compile_set(ir_set, ctx=ctx)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/expr.py\", line 592, in _compile_set\r\n          relgen.get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/relgen.py\", line 214, in get_set_rvar\r\n          rvars = _get_set_rvar(ir_set, ctx=subctx)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/relgen.py\", line 376, in _get_set_rvar\r\n          rvars = process_set_as_func_expr(ir_set, stmt, ctx=ctx)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/relgen.py\", line 2453, in process_set_as_func_expr\r\n          args = _compile_func_args(ir_set, ctx=newctx)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/relgen.py\", line 2382, in _compile_func_args\r\n          type_ref = relctx.get_path_var(\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/relctx.py\", line 372, in get_path_var\r\n          rvar, path_id = _get_path_rvar(stmt, path_id, aspect=aspect, ctx=ctx)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/relctx.py\", line 351, in _get_path_rvar\r\n          raise LookupError(f'there is no range var for {path_id} in {stmt}')\r\n      LookupError: there is no range var for (__derived__::data@w~1).>0[IS default::Foo].>__type__[IS schema::Type] in <pg.SelectStmt at 0x7fc8e100a370>\r\n      \r\n      The above exception was the direct cause of the following exception:\r\n      \r\n      Traceback (most recent call last):\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler_pool/worker.py\", line 308, in worker\r\n          res = meth(*args)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler_pool/worker.py\", line 176, in compile\r\n          units, cstate = COMPILER.compile(\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 2059, in compile\r\n          units = self._compile(ctx=ctx, source=source)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 1621, in _compile\r\n          return self._try_compile(ctx=ctx, source=source)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 1674, in _try_compile\r\n          comp, capabilities = self._compile_dispatch_ql(ctx, stmt)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 1595, in _compile_dispatch_ql\r\n          query = self._compile_ql_query(ctx, ql)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 601, in _compile_ql_query\r\n          sql_text, argmap = pg_compiler.compile_ir_to_sql(\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/__init__.py\", line 123, in compile_ir_to_sql\r\n          qtree = compile_ir_to_sql_tree(\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/compiler/__init__.py\", line 108, in compile_ir_to_sql_tree\r\n          raise errors.InternalServerError(*args) from e\r\n      edb.errors.InternalServerError: there is no range var for (__derived__::data@w~1).>0[IS default::Foo].>__type__[IS schema::Type] in <pg.SelectStmt at 0x7fc8e100a370>\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2924/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2924/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2923", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2923/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2923/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2923/events", "html_url": "https://github.com/edgedb/edgedb/issues/2923", "id": 991695771, "node_id": "MDU6SXNzdWU5OTE2OTU3NzE=", "number": 2923, "title": "Migration fails when a function is introduced.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-09-09T02:36:25Z", "updated_at": "2021-09-23T02:29:47Z", "closed_at": "2021-09-23T02:29:47Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: EdgeDB 1.0-beta.4+dev5960.d2021090721.gdac3f0c40.cv202109030000\r\n- OS Version: linux\r\n\r\nSteps to Reproduce:\r\n\r\n```\r\ndb> START MIGRATION TO {\r\n...   module default {\r\n...     type Person {\r\n...       required property name -> str {\r\n...         constraint exclusive;\r\n...       }\r\n...       multi link places_visited -> Place;\r\n...     }\r\n... \r\n...     type Place {\r\n...       required property name -> str {\r\n...         constraint exclusive;\r\n...       }\r\n...     }\r\n... \r\n...     function visited(person: str, city: str) -> bool\r\n...       using (\r\n...         WITH person := (SELECT Person FILTER .name = person),\r\n...         SELECT city IN person.places_visited.name\r\n...       );\r\n...   }\r\n... };\r\n... \r\n... POPULATE MIGRATION;\r\n... COMMIT MIGRATION;\r\nOK: START MIGRATION\r\nOK: POPULATE MIGRATION\r\nError: InternalServerError: relation \"edgedbpub.0a453fb8-1114-11ec-a573-35cf066c07db_t\" does not exist\r\ndb[tx:failed]>\r\n```\r\n\r\nThe above issue is also reproducible via the `edgedb migration` commands.\r\n\r\nThe error is not present if the function is defined in a separate migration.\r\n\r\nThis is causing issues for the `easy-edgedb` schemas.\r\n\r\nIt appears to be similar to #2834", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2923/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2923/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2916", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2916/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2916/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2916/events", "html_url": "https://github.com/edgedb/edgedb/issues/2916", "id": 990923750, "node_id": "MDU6SXNzdWU5OTA5MjM3NTA=", "number": 2916, "title": "Duplicate INSERTS when using CTE", "user": {"login": "clmnin", "id": 17064666, "node_id": "MDQ6VXNlcjE3MDY0NjY2", "avatar_url": "https://avatars.githubusercontent.com/u/17064666?v=4", "gravatar_id": "", "url": "https://api.github.com/users/clmnin", "html_url": "https://github.com/clmnin", "followers_url": "https://api.github.com/users/clmnin/followers", "following_url": "https://api.github.com/users/clmnin/following{/other_user}", "gists_url": "https://api.github.com/users/clmnin/gists{/gist_id}", "starred_url": "https://api.github.com/users/clmnin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/clmnin/subscriptions", "organizations_url": "https://api.github.com/users/clmnin/orgs", "repos_url": "https://api.github.com/users/clmnin/repos", "events_url": "https://api.github.com/users/clmnin/events{/privacy}", "received_events_url": "https://api.github.com/users/clmnin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2021-09-08T09:20:24Z", "updated_at": "2021-10-26T23:26:13Z", "closed_at": "2021-10-26T23:26:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "- EdgeDB Version: EdgeDB 1.0-beta.3+g8ab4a7be0.cv202108020000 (repl 1.0.0-beta.3)\r\n- OS Version: Ubuntu 20.4\r\n\r\nSteps to Reproduce:\r\n\r\n1. Run these EdgeQL statements\r\n\r\n    ```sql\r\n    START MIGRATION TO {\r\n        module default {\r\n            scalar type OrderNo extending sequence;\r\n            type User {\r\n                required property name -> str {\r\n                    constraint exclusive;\r\n                }\r\n            }\r\n            type Product {\r\n                required property name -> str;\r\n                required link user -> User;\r\n                constraint exclusive on ( (.user, .name) );\r\n            }\r\n            type SaleOrder {\r\n                required property order_num -> OrderNo;\r\n                multi link lines -> OrderLine;\r\n                required link customer -> User;\r\n                required link merchant -> User;\r\n                property create_date -> datetime {\r\n                    default := datetime_current();\r\n                }\r\n            }\r\n            type OrderLine {\r\n                required link product -> Product;\r\n                required property qty -> int32;\r\n            }\r\n            type SMS {\r\n                required property body -> str;\r\n                required link so -> SaleOrder;\r\n            }\r\n        }\r\n    };\r\n    POPULATE MIGRATION;\r\n    COMMIT MIGRATION;\r\n\r\n    INSERT User {name := \"Alice\"};\r\n    INSERT User {name := \"Bob\"};\r\n    INSERT Product {name := \"Product 1\", user := (SELECT User FILTER .name = \"Alice\")};\r\n    INSERT Product {name := \"Product 1\", user := (SELECT User FILTER .name = \"Bob\")};\r\n    \r\n    # Insert SMS and SaleOrder in a single query (https://github.com/edgedb/edgedb/discussions/2750)\r\n    WITH\r\n        NewOrder := (\r\n            INSERT SaleOrder {\r\n            customer := (SELECT User FILTER .name = <str>\"Alice\"), \r\n            merchant := (SELECT User FILTER .name = <str>\"Bob\"), \r\n            lines := {(\r\n                INSERT OrderLine { \r\n                    product := (SELECT Product FILTER .name = <str>\"Product 1\" AND .user.name = <str>\"Bob\"), \r\n                    qty := <int32>1\r\n                    }\r\n                )}\r\n        }\r\n    )\r\n    SELECT (\r\n        INSERT SMS {\r\n            body := \"Your order #\" ++ <str>NewOrder.order_num ++ \"was placed successfully\",\r\n            so := NewOrder,\r\n        }\r\n    ) {\r\n        body,\r\n        so : {\r\n            customer,\r\n            merchant,\r\n            lines : {\r\n                product,\r\n                qty\r\n            }\r\n        }\r\n    };\r\n    ```\r\n2. This creates duplicate links at `so.line`.\r\n    \r\n    ```\r\n        {\r\n    default::SMS {\r\n        body: 'Your order #1was placed successfully',\r\n        so: default::SaleOrder {\r\n        customer: default::User {id: c607024a-1083-11ec-acae-af746e748347},\r\n        merchant: default::User {id: c608bdba-1083-11ec-acae-dfb9e5e30284},\r\n        lines: {\r\n            default::OrderLine {product: default::Product {id: c619b62e-1083-11ec-acae-53a9bd4857a5}, qty: 1},\r\n            default::OrderLine {product: default::Product {id: c619b62e-1083-11ec-acae-53a9bd4857a5}, qty: 1},\r\n        },\r\n        },\r\n    },\r\n    }\r\n\r\n    ```\r\n    \r\n3.  But if I try creating an order directly, intead of a CTE I don't get duplicates\r\n    \r\n    ```\r\n    SELECT (\r\n        INSERT SaleOrder {\r\n            customer := (SELECT User FILTER .name = <str>\"Alice\"), \r\n            merchant := (SELECT User FILTER .name = <str>\"Bob\"), \r\n            lines := {\r\n                (\r\n                    INSERT OrderLine { \r\n                        product := (SELECT Product FILTER .name = <str>\"Product 1\" AND .user.name = <str>\"Bob\"), \r\n                        qty := <int32>1\r\n                    }\r\n                )\r\n            }\r\n        }\r\n    ) {\r\n        lines : {id, product}\r\n    }\r\n    ```\r\n    Which results in no duplicates\r\n    ```\r\n    {\r\n        default::SaleOrder {\r\n            lines: {\r\n                default::OrderLine {id: 7245802c-1084-11ec-9ebb-b38ae45012bc, product: default::Product {id: c619b62e-1083-11ec-acae-53a9bd4857a5}}\r\n            }\r\n        }\r\n    }\r\n    ```\r\n\r\n\r\nLooks like @msullivan is already working on this at https://github.com/edgedb/edgedb/issues/2809", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2916/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2916/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2883", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2883/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2883/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2883/events", "html_url": "https://github.com/edgedb/edgedb/issues/2883", "id": 984222467, "node_id": "MDU6SXNzdWU5ODQyMjI0Njc=", "number": 2883, "title": "DELETE doesn't remove entries from property link tables", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-08-31T19:31:11Z", "updated_at": "2021-09-01T17:09:31Z", "closed_at": "2021-09-01T17:09:31Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "DELETE doesn't remove entries from link tables. In addition to leaking space, this causes trouble for exclusive constraints on multi pointers, for example (from the `insert` schema):\r\n```\r\nINSERT Person { name := \"asdf\", multi_prop := \"a\" };\r\nDELETE Person;\r\nINSERT Person { name := \"asdf\", multi_prop := \"a\" };\r\n```\r\nraises a constraint error", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2883/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2883/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2876", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2876/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2876/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2876/events", "html_url": "https://github.com/edgedb/edgedb/issues/2876", "id": 981480739, "node_id": "MDU6SXNzdWU5ODE0ODA3Mzk=", "number": 2876, "title": "Concurrent complex `UNLESS CONFLICT` queries can spuriously raise ConstraintViolationError", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-08-27T18:12:11Z", "updated_at": "2021-09-02T21:29:04Z", "closed_at": "2021-09-02T21:29:04Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "If we, in two concurrent transactions, do:\r\n```\r\nFOR name IN {'name'} UNION (\r\n    SELECT (\r\n        INSERT Counter {\r\n            name := name,\r\n            value := 1,\r\n        } UNLESS CONFLICT ON .name\r\n        ELSE (\r\n            UPDATE Counter\r\n            SET { value := .value + 1 }\r\n        )\r\n    ).value\r\n)\r\n```\r\nwe spuriously generate a `ConstraintViolationError`, instead of a `TransactionSerializationError` (which can be automatically retried).\r\n\r\nThe issue is with `UNLESS CONFLICT`s that use \"conflict CTEs\" to determine whether to suppress the INSERT, rather than relying on `ON CONFLICT` to do it. Both queries start with a snapshot of an empty table, and so both try to do the INSERT; without there being an `ON CONFLICT`, postgres raises a constraint violation instead of failing to serialize the transaction.\r\n\r\nUnfortunately, it is necessary in cases like this to not specify `ON CONFLICT`, because we depend on the lack of `ON CONFLICT` to cause an error if a single query tries to insert two conflicting objects (for example, if the query above because `FOR name IN {'foo', 'foo'}`). See https://github.com/edgedb/edgedb/issues/2193 for a detailed discussion of this issue.\r\n\r\nSome possible approaches to this issue include:\r\n 1. Implement the \"FILTER\" strategy discussed in #2193 \r\n 2. Stick with the \"ERROR\" approach, but implement it by explicitly detecting and raising an error on constraint violations. This will probably be able to build on some of the machinery being built for https://github.com/edgedb/edgedb/issues/2845\r\n 3. Retry on (some?) `ConstraintViolationError`s", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2876/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2876/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2848", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2848/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2848/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2848/events", "html_url": "https://github.com/edgedb/edgedb/issues/2848", "id": 976394631, "node_id": "MDU6SXNzdWU5NzYzOTQ2MzE=", "number": 2848, "title": "ISE: `unimplemented auth method: NoneType` when inserting new user on clean instance", "user": {"login": "nsidnev", "id": 22559461, "node_id": "MDQ6VXNlcjIyNTU5NDYx", "avatar_url": "https://avatars.githubusercontent.com/u/22559461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nsidnev", "html_url": "https://github.com/nsidnev", "followers_url": "https://api.github.com/users/nsidnev/followers", "following_url": "https://api.github.com/users/nsidnev/following{/other_user}", "gists_url": "https://api.github.com/users/nsidnev/gists{/gist_id}", "starred_url": "https://api.github.com/users/nsidnev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nsidnev/subscriptions", "organizations_url": "https://api.github.com/users/nsidnev/orgs", "repos_url": "https://api.github.com/users/nsidnev/repos", "events_url": "https://api.github.com/users/nsidnev/events{/privacy}", "received_events_url": "https://api.github.com/users/nsidnev/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-08-22T14:48:07Z", "updated_at": "2021-08-27T04:06:21Z", "closed_at": "2021-08-27T04:06:11Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1-beta3-451baf4\r\n- OS Version: ubuntu 18.04\r\n\r\nSteps to Reproduce:\r\n\r\n1. initialize new project with new `EdgeDB` instance in docker with `edgedb project init`\r\n2. login into EdgeDB shell using `edgedb` command and create new user with password:\r\n```\r\nCREATE SUPERUSER ROLE edgedb_scram {\r\n    SET password := 'edgedb_scram_password'\r\n};\r\n\r\nCONFIGURE INSTANCE INSERT Auth {\r\n    user := 'edgedb_scram',\r\n    method := (INSERT SCRAM),\r\n    priority := 2\r\n};\r\n```\r\n3. exit current shell session and try running `edgedb` command again to login into shell\r\n```\r\n$ edgedb\r\nedgedb error: Error authenticating: ERROR: InternalServerError: unimplemented auth method: NoneType\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"edb/server/protocol/binary.pyx\", line 1689, in edb.server.protocol.binary.EdgeConnection.main\r\n        File \"edb/server/protocol/binary.pyx\", line 445, in auth\r\n      edb.errors.InternalServerError: unimplemented auth method: NoneType\r\n```\r\n\r\nAs I understand it, this is because the default user (`edgedb`) created by the EdgeDB bootstrap process is not being added to `cfg::Auth`. This can be verified by selecting the existing `cfg::Auth` objects before inserting a new one:\r\n```\r\nSELECT cfg::Auth {\r\n    user,\r\n    method,\r\n    priority\r\n};\r\n```\r\nThe output will be an empty set (`{}`).\r\n\r\nBut in any case, user should not receive such error from the EdgeDB server in case of authentication failure. I would rather expect something like `AuthenticationError: no authentication method configured for the \"edgedb\" role` or something similar.\r\n\r\nIt's possible I missed something about roles configuration, but that part of EdgeDB is poorly documented right now, IMO.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2848/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2848/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2845", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2845/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2845/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2845/events", "html_url": "https://github.com/edgedb/edgedb/issues/2845", "id": 976027524, "node_id": "MDU6SXNzdWU5NzYwMjc1MjQ=", "number": 2845, "title": "Exclusive constraint doesn't trigger in repeated DML to another type", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2021-08-21T03:17:32Z", "updated_at": "2021-09-03T00:07:30Z", "closed_at": "2021-09-03T00:07:30Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: EdgeDB 1.0-beta.4+dev5910.d2021082020.gfa96e3ffc.cv202108020000\r\n- OS Version: linux\r\n\r\nSteps to Reproduce:\r\n\r\n```\r\ntest> START MIGRATION TO {\r\n.....     module default {\r\n.....         type Foo {\r\n.....             required property name -> str {\r\n.....                 constraint exclusive;\r\n.....             }\r\n.....             link foo -> Foo;\r\n.....         }\r\n..... \r\n.....         type Bar extending Foo;\r\n.....     }\r\n..... };\r\n..... POPULATE MIGRATION;\r\n..... COMMIT MIGRATION;\r\nOK: START MIGRATION\r\nOK: POPULATE MIGRATION\r\nOK: COMMIT MIGRATION\r\ntest> WITH name := 'Alice'\r\n..... INSERT Foo {\r\n.....     name := name,\r\n.....     foo := (\r\n.....         INSERT Bar {\r\n.....             name := name,\r\n.....         }\r\n.....     )\r\n..... };\r\n{default::Foo {id: 868ff1f8-022d-11ec-8da0-773572bc9714}}\r\ntest> select Foo {name, foo: {name}};\r\n{\r\n  default::Foo {name: 'Alice', foo: default::Bar {name: 'Alice'}},\r\n  default::Bar {name: 'Alice', foo: {}},\r\n}\r\n```\r\n\r\nThe `exclusive` constraint on `Foo` is not deferred, so it should apply to `Bar`, therefore inserting `Alice` as both `Foo` and `Bar` should be impossible.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2845/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2845/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2834", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2834/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2834/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2834/events", "html_url": "https://github.com/edgedb/edgedb/issues/2834", "id": 973967191, "node_id": "MDU6SXNzdWU5NzM5NjcxOTE=", "number": 2834, "title": "Migration fails when an object-handling function is introduced.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-08-18T19:00:02Z", "updated_at": "2021-09-03T01:56:34Z", "closed_at": "2021-09-03T01:56:34Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1-beta3 (docker)\r\n- OS Version: linux\r\n\r\nSteps to Reproduce:\r\n\r\n1. Setup a project.\r\n2. Use the following schema:\r\n   ```\r\n    module default {\r\n        type Person {\r\n            property name -> str;\r\n        }\r\n        function get_name(p: Person) -> str using (p.name);\r\n    }\r\n   ```\r\n3. Run `edgedb migration create` and then `edgedb migrate`\r\n   ```\r\n    $ edgedb migration create\r\n    did you create object type 'default::Person'? [y,n,l,c,b,s,q,?]\r\n    > y\r\n    did you create function 'default::get_name'? [y,n,l,c,b,s,q,?]\r\n    > y\r\n    Created ./dbschema/migrations/00001.edgeql, id: m1jgp4q5mu7e44wqupbm2znfhnuef7picezzz77acazp5wpyqkbjaa\r\n    $ edgedb migrate\r\n    edgedb error: ERROR: InternalServerError: relation \"edgedbpub.2ee91729-0052-11ec-bc00-95d4256e2ffc_t\" does not exist\r\n      Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n      Server traceback:\r\n          edb.errors.InternalServerError: relation \"edgedbpub.2ee91729-0052-11ec-bc00-95d4256e2ffc_t\" does not exist   \r\n   ```\r\n\r\nThis also fails in REPL:\r\n```\r\nEdgeDB 1.0-beta.3+g8ab4a7be0.cv202108020000 (repl 1.0.0-beta.3)\r\nType \\help for help, \\quit to quit.\r\nedgedb> START MIGRATION TO {\r\n.......   module default {\r\n.......     type Person {\r\n.......       property name -> str;\r\n.......     }\r\n.......     function get_name(p: Person) -> str using (p.name);\r\n.......   }\r\n....... };\r\n....... \r\n....... POPULATE MIGRATION;\r\n....... COMMIT MIGRATION;\r\nOK: START MIGRATION\r\nOK: POPULATE MIGRATION\r\nError: ERROR: InternalServerError: relation \"edgedbpub.4e6d4a01-0052-11ec-b910-3958c99cb3e5_t\" does not exist\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: relation \"edgedbpub.4e6d4a01-0052-11ec-b910-3958c99cb3e5_t\" does not exist\r\n```\r\n\r\nBut weirdly, it succeeds if the auto-generated migration DDL commands are used directly without the `CREATE MIGRATION` wrapper:\r\n```\r\nedgedb>   CREATE TYPE default::Person {\r\n.......       CREATE PROPERTY name -> std::str;\r\n.......   };\r\n.......   CREATE FUNCTION default::get_name(p: default::Person) ->  std::str USING (p.name);\r\nOK: CREATE TYPE\r\nOK: CREATE FUNCTION\r\n```\r\n\r\nSo it appears to only cause issues if the object-handling function and the object type it works with are defined in the same migration.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2834/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2834/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2827", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2827/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2827/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2827/events", "html_url": "https://github.com/edgedb/edgedb/issues/2827", "id": 973149986, "node_id": "MDU6SXNzdWU5NzMxNDk5ODY=", "number": 2827, "title": "Cardinality violation is not detected", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-08-18T00:03:01Z", "updated_at": "2021-08-18T16:22:14Z", "closed_at": "2021-08-18T16:22:14Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1-beta3 (docker)\r\n- OS Version: linux\r\n\r\nSteps to Reproduce:\r\n\r\n```\r\ntest> create type Foo;\r\nOK: CREATE TYPE\r\ntest> create type Bar {create required single link foo -> Foo};\r\nOK: CREATE TYPE\r\ntest> insert Foo;\r\n{default::Foo {id: 33ba1e22-ffb7-11eb-a3f3-0f3f7e1586b7}}\r\ntest> insert Bar {foo := Foo};\r\n{default::Bar {id: 367723c6-ffb7-11eb-a3f3-1fd1c76544b5}}\r\ntest> insert Foo;\r\n{default::Foo {id: 382e27a0-ffb7-11eb-a3f3-079f3251eb68}}\r\ntest> insert Bar {foo := Foo};\r\nERROR: InternalServerError: duplicate key value violates unique constraint \"2dbcc6bd-ffb7-11eb-9cd5-bd146c902983_pkey\"\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: duplicate key value violates unique constraint \"2dbcc6bd-ffb7-11eb-9cd5-bd146c902983_pkey\"\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2827/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2827/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2778", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2778/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2778/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2778/events", "html_url": "https://github.com/edgedb/edgedb/issues/2778", "id": 962332795, "node_id": "MDU6SXNzdWU5NjIzMzI3OTU=", "number": 2778, "title": "Migrating from link to multi link -> ERROR: MissingRequiredError", "user": {"login": "clmnin", "id": 17064666, "node_id": "MDQ6VXNlcjE3MDY0NjY2", "avatar_url": "https://avatars.githubusercontent.com/u/17064666?v=4", "gravatar_id": "", "url": "https://api.github.com/users/clmnin", "html_url": "https://github.com/clmnin", "followers_url": "https://api.github.com/users/clmnin/followers", "following_url": "https://api.github.com/users/clmnin/following{/other_user}", "gists_url": "https://api.github.com/users/clmnin/gists{/gist_id}", "starred_url": "https://api.github.com/users/clmnin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/clmnin/subscriptions", "organizations_url": "https://api.github.com/users/clmnin/orgs", "repos_url": "https://api.github.com/users/clmnin/repos", "events_url": "https://api.github.com/users/clmnin/events{/privacy}", "received_events_url": "https://api.github.com/users/clmnin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-08-06T02:10:50Z", "updated_at": "2021-09-03T22:54:14Z", "closed_at": "2021-09-03T22:54:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Discussed in https://github.com/edgedb/edgedb/discussions/2777\r\n\r\n<div type='discussions-op-text'>\r\n\r\n<sup>Originally posted by **clmno** August  6, 2021</sup>\r\nEdgeDB Version: EdgeDB 1.0-beta.2+ga7130d5c7.cv202104290000 (repl 1.0.0-beta.2)\r\n\r\n```sql\r\nSTART MIGRATION TO {\r\n    module default {\r\n        type Company {\r\n            required property name -> str {\r\n                constraint exclusive;\r\n            }\r\n            link admin -> User;\r\n        }\r\n        type User {\r\n            required property name -> str {\r\n                constraint exclusive;\r\n            }\r\n            link company -> Company;\r\n        }\r\n    }\r\n};\r\nPOPULATE MIGRATION;\r\nCOMMIT MIGRATION;\r\n\r\nINSERT Company {name := \"ABC Company\"};\r\nINSERT Company {name := \"XYZ Company\"};\r\nINSERT Company {name := \"123 Company\"};\r\n\r\nINSERT User {name := \"Alice\", company := (SELECT Company FILTER .name = \"ABC Company\")};\r\nINSERT User {name := \"Bob\", company := (SELECT Company FILTER .name = \"XYZ Company\")};\r\nINSERT User {name := \"Cathy\", company := (SELECT Company FILTER .name = \"ABC Company\")};\r\n\r\nUPDATE Company FILTER .name = \"ABC Company\" SET {admin := (SELECT User Filter .name = \"Alice\")};\r\nUPDATE Company FILTER .name = \"XYZ Company\" SET {admin := (SELECT User Filter .name = \"Bob\")};\r\n```\r\n\r\nHere Company `123 Company` as no link for `admin`. Which is acceptable according to the schema.\r\n\r\nBut when I try changing `link admin` to `multi link admin` I get this error\r\n> Error: ERROR: MissingRequiredError: missing value for required link 'admin' of object type 'default::Company'\r\n\r\n<details>\r\n  <summary>View migration </summary>\r\n\r\n  ```sql\r\n    START MIGRATION TO {\r\n      module default {\r\n          type Company {\r\n              required property name -> str {\r\n                  constraint exclusive;\r\n              }\r\n              multi link admin -> User; # multi link\r\n          }\r\n          type User {\r\n              required property name -> str {\r\n                  constraint exclusive;\r\n              }\r\n              link company -> Company;\r\n          }\r\n      }\r\n  };\r\n  POPULATE MIGRATION;\r\n  COMMIT MIGRATION;\r\n  ```\r\n\r\n</details></div>", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2778/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2778/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2726", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2726/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2726/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2726/events", "html_url": "https://github.com/edgedb/edgedb/issues/2726", "id": 952909202, "node_id": "MDU6SXNzdWU5NTI5MDkyMDI=", "number": 2726, "title": "InternalServerError: function return row and query-specified return row do not match", "user": {"login": "jaclarke", "id": 2085287, "node_id": "MDQ6VXNlcjIwODUyODc=", "avatar_url": "https://avatars.githubusercontent.com/u/2085287?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaclarke", "html_url": "https://github.com/jaclarke", "followers_url": "https://api.github.com/users/jaclarke/followers", "following_url": "https://api.github.com/users/jaclarke/following{/other_user}", "gists_url": "https://api.github.com/users/jaclarke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaclarke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaclarke/subscriptions", "organizations_url": "https://api.github.com/users/jaclarke/orgs", "repos_url": "https://api.github.com/users/jaclarke/repos", "events_url": "https://api.github.com/users/jaclarke/events{/privacy}", "received_events_url": "https://api.github.com/users/jaclarke/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-07-26T13:31:32Z", "updated_at": "2021-08-12T17:38:07Z", "closed_at": "2021-08-12T17:38:07Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: 1.0-beta.3+dev5810.d2021072613.g5c1408a6c.cv202107231400\r\n\r\nSteps to Reproduce:\r\n\r\n```edgeql\r\nWITH MODULE schema\r\nSELECT ObjectType {\r\n  links: {\r\n    targetNames := (\r\n      WITH target := .target[IS ObjectType]\r\n      SELECT std::array_agg(\r\n        target.name\r\n      )\r\n    ),\r\n    default,\r\n  }\r\n}\r\nORDER BY count(.links);\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2726/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2726/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2719", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2719/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2719/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2719/events", "html_url": "https://github.com/edgedb/edgedb/issues/2719", "id": 951960118, "node_id": "MDU6SXNzdWU5NTE5NjAxMTg=", "number": 2719, "title": "Inconsistent allowance of annotation keyword with properties", "user": {"login": "omnunum", "id": 3474285, "node_id": "MDQ6VXNlcjM0NzQyODU=", "avatar_url": "https://avatars.githubusercontent.com/u/3474285?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omnunum", "html_url": "https://github.com/omnunum", "followers_url": "https://api.github.com/users/omnunum/followers", "following_url": "https://api.github.com/users/omnunum/following{/other_user}", "gists_url": "https://api.github.com/users/omnunum/gists{/gist_id}", "starred_url": "https://api.github.com/users/omnunum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omnunum/subscriptions", "organizations_url": "https://api.github.com/users/omnunum/orgs", "repos_url": "https://api.github.com/users/omnunum/repos", "events_url": "https://api.github.com/users/omnunum/events{/privacy}", "received_events_url": "https://api.github.com/users/omnunum/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 2295768861, "node_id": "MDU6TGFiZWwyMjk1NzY4ODYx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/need%20info", "name": "need info", "color": "77e5b0", "default": false, "description": "Need more information from submitter"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-07-24T00:07:27Z", "updated_at": "2021-10-22T23:13:48Z", "closed_at": "2021-10-22T23:13:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0.0-beta.2\r\n- OS Version: macOS 11.4 (20F71)\r\n\r\nSteps to Reproduce:\r\nUse a schema example below then run: `edgedb create-migration --non-interactive`\r\n\r\nWhile adding an annotation to a static property, I can get a valid schema by both specifying an annotation using the keyword or by leaving it out. \r\n\r\n```\r\ntype Test {\r\n        required property pass -> bool {\r\n            annotation description := \"this passes\"\r\n        };\r\n    }\r\n```\r\nas well as \r\n```\r\ntype Test {\r\n        required property pass -> bool {\r\n            description := \"this also passes\"\r\n        };\r\n    }\r\n```\r\n\r\nWhen adding an annotation to a computed property however, only the schema where I leave out the annotation keyword passes.\r\n```\r\n    type Test {\r\n        required property fail := ( true ) {\r\n            annotation description := \"this fails\"\r\n        };\r\n    }\r\n```\r\nreturns me \r\n```\r\nerror: Unexpected token: <Token IDENT \"description\">\r\n  \u250c\u2500 ./dbschema/data.esdl:5:24\r\n  \u2502\r\n5 \u2502             annotation description := \r\n  \u2502                        ^^^^^^^^^^^ It appears that a ',' is missing in a shape before 'description'\r\n```\r\nwhereas\r\n```\r\n    type Test {\r\n        required property pass := ( true ) {\r\n             description := \"this passes\"\r\n        };\r\n    }\r\n```\r\nis good to go.\r\n\r\nWith links, both styles pass (just like static properties).  ", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2719/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2719/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2708", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2708/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2708/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2708/events", "html_url": "https://github.com/edgedb/edgedb/issues/2708", "id": 949051481, "node_id": "MDU6SXNzdWU5NDkwNTE0ODE=", "number": 2708, "title": "Wrong results for a combination of shape, path and multiple inheritance.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-07-20T20:22:00Z", "updated_at": "2021-07-23T20:04:29Z", "closed_at": "2021-07-23T20:04:29Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "See [test_edgeql_computable_nested_02](https://github.com/edgedb/edgedb/blob/46bd8847158e84c2ae9b82c0e86697ed631e531a/tests/test_edgeql_expr_aliases.py#L375-L405) and [test_edgeql_computable_nested_03](https://github.com/edgedb/edgedb/blob/46bd8847158e84c2ae9b82c0e86697ed631e531a/tests/test_edgeql_expr_aliases.py#L407-L440).\r\n\r\nThe following query is producing wrong results for `typename`: \r\n```\r\nWITH C := Card { ava_owners := .<avatar }\r\nSELECT C {\r\n    name,\r\n    ava_owners: {\r\n        multi typename := (\r\n            WITH name := C.ava_owners.__type__.name\r\n            SELECT name\r\n        )\r\n    }\r\n}\r\nFILTER EXISTS .ava_owners\r\nORDER BY .name;\r\n```\r\n\r\nThe `typename` as specified should fairly trivially always be a `singe` result for any given `ava_owner`, however, it produces multiple results when the \"owners\" can be of different (related) types.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2708/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2708/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2707", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2707/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2707/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2707/events", "html_url": "https://github.com/edgedb/edgedb/issues/2707", "id": 949041308, "node_id": "MDU6SXNzdWU5NDkwNDEzMDg=", "number": 2707, "title": "Anonymous shapes cardinality", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-07-20T20:11:56Z", "updated_at": "2021-07-20T23:49:21Z", "closed_at": "2021-07-20T23:49:21Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "See [test_edgeql_ir_card_inference_67](https://github.com/edgedb/edgedb/blob/46bd8847158e84c2ae9b82c0e86697ed631e531a/tests/test_edgeql_ir_card_inference.py#L617-L625) and [test_edgeql_ir_card_inference_72](https://github.com/edgedb/edgedb/blob/46bd8847158e84c2ae9b82c0e86697ed631e531a/tests/test_edgeql_ir_card_inference.py#L655-L663).\r\n\r\nThe anonymous shape construct should always be of cardinality `ONE`.\r\n\r\nThis can be changed by a `UNION` (probably resulting in losing all the useful data stored in the computed links/properties as we currently can't mix them). The `FOR` query is probably the only way of creating a union of several anonymous shapes that's currently legal and that would result in a set of anonymous shapes with cardinality `MANY`.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2707/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2707/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2704", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2704/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2704/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2704/events", "html_url": "https://github.com/edgedb/edgedb/issues/2704", "id": 948664437, "node_id": "MDU6SXNzdWU5NDg2NjQ0Mzc=", "number": 2704, "title": "Confusing migration error thrown due to multiline annotation", "user": {"login": "omnunum", "id": 3474285, "node_id": "MDQ6VXNlcjM0NzQyODU=", "avatar_url": "https://avatars.githubusercontent.com/u/3474285?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omnunum", "html_url": "https://github.com/omnunum", "followers_url": "https://api.github.com/users/omnunum/followers", "following_url": "https://api.github.com/users/omnunum/following{/other_user}", "gists_url": "https://api.github.com/users/omnunum/gists{/gist_id}", "starred_url": "https://api.github.com/users/omnunum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omnunum/subscriptions", "organizations_url": "https://api.github.com/users/omnunum/orgs", "repos_url": "https://api.github.com/users/omnunum/repos", "events_url": "https://api.github.com/users/omnunum/events{/privacy}", "received_events_url": "https://api.github.com/users/omnunum/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2021-07-20T13:38:42Z", "updated_at": "2021-09-03T21:07:49Z", "closed_at": "2021-09-03T21:07:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0.0-beta.2\r\n- OS Version: macOS 11.4 (20F71)\r\n\r\nSteps to Reproduce:\r\n\r\n1. run `edgedb project init`\r\n2. set default module to \ud83d\udc47 \r\n```\r\nmodule default {\r\n\tabstract type Recording {\r\n\t\trequired property version -> int16 {\r\n            annotation description := \r\n                \"Version is incremented anytime a change\r\n                in the data is registered\";\r\n        }\r\n\t}\r\n}\r\n```\r\n3.  run `edgedb create-migration --non-interactive ; edgedb migrate`\r\n\r\nThis results in the message\r\n```\r\nedgedb error: could not read migrations in ./dbschema/migrations: could not read migration file ./dbschema/migrations/00001.edgeql: migration name should be `m1ydgjz533k6jnuknvkm3ybiofk2depc4s7a2pggecsf4pzcjsba5a` but `m1axn3wsnysm6hnnpijljgjv6ybyldbfvrajgvgdq7qdve7ky2adfa` is used instead.\r\nMigration names are computed from the hash of the migration contents. To proceed you must fix the statement to read as:\r\n  CREATE MIGRATION m1ydgjz533k6jnuknvkm3ybiofk2depc4s7a2pggecsf4pzcjsba5a ONTO ...\r\nif this migration is not applied to any database. Alternatively, revert the changes to the file.\r\n```\r\n\r\nat this state, the migration 00001.edgeql is \r\n```\r\nCREATE MIGRATION m1ydgjz533k6jnuknvkm3ybiofk2depc4s7a2pggecsf4pzcjsba5a\r\n    ONTO initial\r\n{\r\n  CREATE ABSTRACT TYPE default::Recording {\r\n      CREATE REQUIRED PROPERTY version -> std::int16 {\r\n          CREATE ANNOTATION std::description := 'Version is incremented anytime a change\r\n                  in the data is registered';\r\n      };\r\n  };\r\n};\r\n```\r\n\r\nWhen we follow this instruction and swap the hash values, running `edgedb migrate` again results in \r\n\r\n```\r\nedgedb error: ERROR: SchemaDefinitionError: specified migration name does not match the name derived from the migration contents: 'm1ydgjz533k6jnuknvkm3ybiofk2depc4s7a2pggecsf4pzcjsba5a', expected 'm1axn3wsnysm6hnnpijljgjv6ybyldbfvrajgvgdq7qdve7ky2adfa'\r\n```\r\n\r\nwhich is the previous hash that we were instructed to change.  This chain of errors can be resolved by setting the default module to \r\n```\r\nmodule default {\r\n\tabstract type Recording {\r\n\t\trequired property version -> int16 {\r\n            annotation description := \r\n                \"Version is incremented anytime a change  in the data is registered\";\r\n        }\r\n\t}\r\n}\r\n```\r\nthen running `edgedb create-migration --non-interactive ; edgedb migrate`\r\n\r\nwill result in \r\n```\r\nApplied m1gci5naybrifrngsk2537zjerqk2zqxnmbdqslgamqcnm7vzknpmq (00001.edgeql)\r\n```\r\n\r\nI'm not quite sure if its specified anywhere that annotations or strings in general cannot span multiple lines.  As a brand new user (yesterday was my first schema setup attempt) I had a bax UX with this.  The suggestion from the error that was reported did not resolve my issue when followed, nor did it help me diagnose what the root cause was.  \r\n\r\nI think a better UX would be to either have some parser functionality to remove newlines from annotation strings (during migration creation) if they are not supported in the DDL.  If this can't be the case, then having a more specific error message in regards to this limitation would be very valuable.\r\n\r\nThank you in advance for all the work being put into EdgeDB!  I have had an otherwise great experience learning about this tool.  The documentation on the website is superb.\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2704/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2704/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2698", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2698/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2698/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2698/events", "html_url": "https://github.com/edgedb/edgedb/issues/2698", "id": 946930380, "node_id": "MDU6SXNzdWU5NDY5MzAzODA=", "number": 2698, "title": "Can't use backlinks if a link with the same name is computed", "user": {"login": "kafein", "id": 12200104, "node_id": "MDQ6VXNlcjEyMjAwMTA0", "avatar_url": "https://avatars.githubusercontent.com/u/12200104?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kafein", "html_url": "https://github.com/kafein", "followers_url": "https://api.github.com/users/kafein/followers", "following_url": "https://api.github.com/users/kafein/following{/other_user}", "gists_url": "https://api.github.com/users/kafein/gists{/gist_id}", "starred_url": "https://api.github.com/users/kafein/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kafein/subscriptions", "organizations_url": "https://api.github.com/users/kafein/orgs", "repos_url": "https://api.github.com/users/kafein/repos", "events_url": "https://api.github.com/users/kafein/events{/privacy}", "received_events_url": "https://api.github.com/users/kafein/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2021-07-18T01:23:52Z", "updated_at": "2021-09-07T21:59:37Z", "closed_at": "2021-09-07T21:54:36Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0b2+ga7130d5c7.cv202104290000  \r\n- OS Version: macOS Big Sur / MacBook Air (M1, 2020) /  Memory: 8 GB \r\n\r\nSteps to Reproduce:\r\n\r\nSimplified Schema;\r\n\r\n```\r\nusing extension graphql;\r\n\r\nmodule default {\r\n    type User {\r\n        required property email -> str {\r\n            constraint exclusive;\r\n        }\r\n        multi link entries := .<author[IS Entry]; \r\n    }\r\n\r\n    type Entry {\r\n        link author -> User; \r\n        link topic := .<entries[IS Topic];\r\n    }\r\n\r\n    type Topic {\r\n        multi link entries -> Entry; \r\n    }\r\n};\r\n```\r\nGraphQL Query;\r\n```\r\nUser {\r\n      email\r\n      entries {\r\n        topic {\r\n          id\r\n        }\r\n      }\r\n}\r\n```\r\n\r\nWhen trying to use this query I am getting **\"QueryError: relation \\\"edgedbpub.718fcee6-e765-11eb-9572-8bb96a65cb68_t\\\" does not exist\"** error\r\n\r\nWith the following schema change it's working well. I think this is a name collision issue. I wonder if this is a bug or am I doing something wrong?\r\n\r\n```\r\nusing extension graphql;\r\n\r\nmodule default {\r\n    type User {\r\n        required property email -> str {\r\n            constraint exclusive;\r\n        }\r\n        multi link entries := .<author[IS Entry]; \r\n    }\r\n\r\n    type Entry {\r\n        link author -> User; \r\n        link topic := .<topic_entries[IS Topic];\r\n    }\r\n\r\n    type Topic {\r\n        multi link topic_entries -> Entry; \r\n    }\r\n};\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2698/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2698/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2696", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2696/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2696/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2696/events", "html_url": "https://github.com/edgedb/edgedb/issues/2696", "id": 946860049, "node_id": "MDU6SXNzdWU5NDY4NjAwNDk=", "number": 2696, "title": "Trying to update listen_addresses triggers ISE: address already in use", "user": {"login": "Fogapod", "id": 22667809, "node_id": "MDQ6VXNlcjIyNjY3ODA5", "avatar_url": "https://avatars.githubusercontent.com/u/22667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Fogapod", "html_url": "https://github.com/Fogapod", "followers_url": "https://api.github.com/users/Fogapod/followers", "following_url": "https://api.github.com/users/Fogapod/following{/other_user}", "gists_url": "https://api.github.com/users/Fogapod/gists{/gist_id}", "starred_url": "https://api.github.com/users/Fogapod/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Fogapod/subscriptions", "organizations_url": "https://api.github.com/users/Fogapod/orgs", "repos_url": "https://api.github.com/users/Fogapod/repos", "events_url": "https://api.github.com/users/Fogapod/events{/privacy}", "received_events_url": "https://api.github.com/users/Fogapod/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "fantix", "id": 1751601, "node_id": "MDQ6VXNlcjE3NTE2MDE=", "avatar_url": "https://avatars.githubusercontent.com/u/1751601?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fantix", "html_url": "https://github.com/fantix", "followers_url": "https://api.github.com/users/fantix/followers", "following_url": "https://api.github.com/users/fantix/following{/other_user}", "gists_url": "https://api.github.com/users/fantix/gists{/gist_id}", "starred_url": "https://api.github.com/users/fantix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fantix/subscriptions", "organizations_url": "https://api.github.com/users/fantix/orgs", "repos_url": "https://api.github.com/users/fantix/repos", "events_url": "https://api.github.com/users/fantix/events{/privacy}", "received_events_url": "https://api.github.com/users/fantix/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fantix", "id": 1751601, "node_id": "MDQ6VXNlcjE3NTE2MDE=", "avatar_url": "https://avatars.githubusercontent.com/u/1751601?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fantix", "html_url": "https://github.com/fantix", "followers_url": "https://api.github.com/users/fantix/followers", "following_url": "https://api.github.com/users/fantix/following{/other_user}", "gists_url": "https://api.github.com/users/fantix/gists{/gist_id}", "starred_url": "https://api.github.com/users/fantix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fantix/subscriptions", "organizations_url": "https://api.github.com/users/fantix/orgs", "repos_url": "https://api.github.com/users/fantix/repos", "events_url": "https://api.github.com/users/fantix/events{/privacy}", "received_events_url": "https://api.github.com/users/fantix/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 13, "created_at": "2021-07-17T16:55:29Z", "updated_at": "2021-07-29T18:49:44Z", "closed_at": "2021-07-29T18:49:44Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0-beta.2+ga7130d5c7.cv202104290000 \r\n- OS Version: Ubuntu 20.04\r\n\r\nSteps to Reproduce:\r\n\r\n1. create server instance\r\n2. edgedb -I SERVER_NAME configure set listen_addresses 127.0.0.1 ::1 0.0.0.0\r\n\r\n```python\r\n\r\nedgedb error: ERROR: InternalServerError: [Errno 98] error while attempting to bind on address ('0.0.0.0', 10700): address already in use\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"edb/server/protocol/binary.pyx\", line 1694, in edb.server.protocol.binary.EdgeConnection.main\r\n        File \"edb/server/protocol/binary.pyx\", line 950, in simple_query\r\n        File \"edb/server/protocol/binary.pyx\", line 1045, in _simple_query\r\n        File \"edb/server/protocol/binary.pyx\", line 1002, in edb.server.protocol.binary.EdgeConnection._simple_query\r\n        File \"edb/server/protocol/binary.pyx\", line 1405, in _execute_system_config\r\n        File \"edb/server/dbview/dbview.pyx\", line 515, in apply_config_ops\r\n        File \"edb/server/dbview/dbview.pyx\", line 649, in apply_system_config_op\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta2/lib/python3.9/site-packages/edb/server/server.py\", line 629, in _on_system_config_set\r\n          await self._restart_servers_new_addr(value, self._listen_port)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta2/lib/python3.9/site-packages/edb/server/server.py\", line 573, in _restart_servers_new_addr\r\n          self._servers, _ = await self._start_servers(nethost, netport)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta2/lib/python3.9/site-packages/edb/server/server.py\", line 786, in _start_servers\r\n          tcp_srv = await self._loop.create_server(\r\n        File \"uvloop/loop.pyx\", line 1768, in create_server\r\n      OSError: [Errno 98] error while attempting to bind on address ('0.0.0.0', 10700): address already in use\r\n```\r\n\r\nDespite the error, value is changed in config:\r\n```\r\nedgedb> SELECT cfg::DatabaseConfig.listen_addresses;\r\n{'0.0.0.0', '127.0.0.1', '::1'}\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2696/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2696/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2652", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2652/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2652/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2652/events", "html_url": "https://github.com/edgedb/edgedb/issues/2652", "id": 937990656, "node_id": "MDU6SXNzdWU5Mzc5OTA2NTY=", "number": 2652, "title": "Computable property fails in polymorphic query with `WITH` block", "user": {"login": "jaclarke", "id": 2085287, "node_id": "MDQ6VXNlcjIwODUyODc=", "avatar_url": "https://avatars.githubusercontent.com/u/2085287?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaclarke", "html_url": "https://github.com/jaclarke", "followers_url": "https://api.github.com/users/jaclarke/followers", "following_url": "https://api.github.com/users/jaclarke/following{/other_user}", "gists_url": "https://api.github.com/users/jaclarke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaclarke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaclarke/subscriptions", "organizations_url": "https://api.github.com/users/jaclarke/orgs", "repos_url": "https://api.github.com/users/jaclarke/repos", "events_url": "https://api.github.com/users/jaclarke/events{/privacy}", "received_events_url": "https://api.github.com/users/jaclarke/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-07-06T15:01:02Z", "updated_at": "2021-07-06T19:55:17Z", "closed_at": "2021-07-06T19:55:17Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: 1.0-beta.3+dev5706.d2021070612.gbeb025efc.cv202107020000\r\n\r\nSteps to Reproduce:\r\n\r\n```\r\nedgedb> select HasImage {\r\n.......   avg_rating := [is Movie].avg_rating\r\n....... };\r\n{}\r\n\r\nedgedb> with rows := (select HasImage)\r\n....... select rows {\r\n.......   avg_rating := [is Movie].avg_rating\r\n....... };\r\nerror: 'default::Movie & default::HasImage.<movie' does not resolve to any known path\r\n```\r\n\r\nSchema:\r\n```\r\nmodule default {\r\n  abstract type HasImage {\r\n    required property image -> str;\r\n  };\r\n\r\n  type Movie extending HasImage {\r\n    property avg_rating := (math::mean(.<movie[is Review].rating));\r\n  };\r\n\r\n  type Review {\r\n    required link movie -> Movie;\r\n    required property rating -> int64;\r\n  }\r\n}\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2652/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2652/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2617", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2617/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2617/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2617/events", "html_url": "https://github.com/edgedb/edgedb/issues/2617", "id": 929208160, "node_id": "MDU6SXNzdWU5MjkyMDgxNjA=", "number": 2617, "title": "InternalServerError: operator is not unique: timestamp with time zone `-` duration_t", "user": {"login": "jaclarke", "id": 2085287, "node_id": "MDQ6VXNlcjIwODUyODc=", "avatar_url": "https://avatars.githubusercontent.com/u/2085287?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaclarke", "html_url": "https://github.com/jaclarke", "followers_url": "https://api.github.com/users/jaclarke/followers", "following_url": "https://api.github.com/users/jaclarke/following{/other_user}", "gists_url": "https://api.github.com/users/jaclarke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaclarke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaclarke/subscriptions", "organizations_url": "https://api.github.com/users/jaclarke/orgs", "repos_url": "https://api.github.com/users/jaclarke/repos", "events_url": "https://api.github.com/users/jaclarke/events{/privacy}", "received_events_url": "https://api.github.com/users/jaclarke/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-06-24T13:03:49Z", "updated_at": "2021-07-02T23:53:11Z", "closed_at": "2021-07-02T23:53:11Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: 1.0-beta.3+dev5686.d2021062412.g99e1f5eec.cv202106090000\r\n\r\nSteps to Reproduce:\r\n\r\n```edgeql\r\nselect datetime_current() - <duration>'10s';\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2617/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2617/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2605", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2605/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2605/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2605/events", "html_url": "https://github.com/edgedb/edgedb/issues/2605", "id": 925281201, "node_id": "MDU6SXNzdWU5MjUyODEyMDE=", "number": 2605, "title": "Bare backlinks causing problems in queries", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-06-19T00:53:54Z", "updated_at": "2021-09-07T21:33:44Z", "closed_at": "2021-09-07T21:33:44Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: EdgeDB 1.0-beta.3+dev5677.d2021061821.g63abb394e.cv202105190000\r\n- OS Version: linux\r\n\r\nSteps to Reproduce:\r\n\r\n```\r\nedgedb> insert User;\r\n{default::User {id: 4675d496-d098-11eb-82da-5f571df8c8d3}}\r\nedgedb> insert Post{user := (select User limit 1)};\r\n{default::Post {id: 4e0a6a32-d098-11eb-82da-3bc279c6aa72}}\r\nedgedb> select User{posts:{id}};\r\n{default::User {posts: {default::Post {id: 4e0a6a32-d098-11eb-82da-3bc279c6aa72}}}}\r\nedgedb> \\set limit 0\r\nedgedb> select User{posts:{id}};\r\nERROR: InternalServerError: column BaseObject~1.6fdec65c-d08d-11eb-abf3-41362b4f4947 does not exist\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: column BaseObject~1.6fdec65c-d08d-11eb-abf3-41362b4f4947 does not exist\r\n```\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n```\r\ntype User {\r\n    link posts := .<user;\r\n}   \r\n\r\nabstract type Action {\r\n    required link user -> User;\r\n}\r\n\r\ntype Post extending Action;\r\n```\r\n\r\nThis is what happens in the `test_edgeql_migration_backlink_01` in https://github.com/edgedb/edgedb/pull/2604", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2605/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2605/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2602", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2602/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2602/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2602/events", "html_url": "https://github.com/edgedb/edgedb/issues/2602", "id": 924360246, "node_id": "MDU6SXNzdWU5MjQzNjAyNDY=", "number": 2602, "title": "Optional arguments seem broken for tuples", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-06-17T21:40:34Z", "updated_at": "2021-06-22T22:49:05Z", "closed_at": "2021-06-22T22:49:05Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "~`SELECT (User.name, User.avatar.name) ?? ('hm', 'n/a');` returns only a row for Alice instead of one for every user~\r\n\r\n`SELECT (User.name, User.avatar.name) ?? (User.name, 'n/a')` gives an ISE, subquery must return only one column\r\n\r\n`SELECT (SELECT ('no', 'no') FILTER false) ?? ('a', 'b');` returns no rows\r\nthough `SELECT <tuple<str, str>>{} ?? ('a', 'b')` does\r\n\r\n... and `WITH X := (User.name, User.avatar.name), SELECT X ?? ('hm', 'n/a');` generates a silly ISE when trying to compute an implicit cast for a TupleExprAlias, but when I fix that, it produces\r\n```\r\n{\r\n  ('Alice', 'Dragon'),\r\n  ('Bob', 'Dragon'),\r\n  ('Carol', 'Dragon'),\r\n  ('Dave', 'Dragon'),\r\n}\r\n```\r\nwhich is pretty frighteningly wrong!", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2602/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2602/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2599", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2599/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2599/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2599/events", "html_url": "https://github.com/edgedb/edgedb/issues/2599", "id": 923039062, "node_id": "MDU6SXNzdWU5MjMwMzkwNjI=", "number": 2599, "title": "ISE on introspection query", "user": {"login": "colinhacks", "id": 3084745, "node_id": "MDQ6VXNlcjMwODQ3NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/3084745?v=4", "gravatar_id": "", "url": "https://api.github.com/users/colinhacks", "html_url": "https://github.com/colinhacks", "followers_url": "https://api.github.com/users/colinhacks/followers", "following_url": "https://api.github.com/users/colinhacks/following{/other_user}", "gists_url": "https://api.github.com/users/colinhacks/gists{/gist_id}", "starred_url": "https://api.github.com/users/colinhacks/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/colinhacks/subscriptions", "organizations_url": "https://api.github.com/users/colinhacks/orgs", "repos_url": "https://api.github.com/users/colinhacks/repos", "events_url": "https://api.github.com/users/colinhacks/events{/privacy}", "received_events_url": "https://api.github.com/users/colinhacks/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-06-16T20:01:56Z", "updated_at": "2021-08-20T02:30:12Z", "closed_at": "2021-08-20T02:30:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: beta-1\r\n- OS Version: macOS Big Sur\r\n\r\nSteps to Reproduce:\r\n\r\n```\r\nwith module schema \r\n select Type { \r\n   id, \r\n   name, \r\n   from_casts := .<from_type[IS Cast] { allow_implicit } \r\n };\r\n```\r\n \r\nResult: \r\n\r\n```\r\nERROR: InternalServerError: cannot find 'a8aaa4d4-ce3b-11eb-b9f7-85bc9f63d0a6' in <pg.RangeSubselect alias=q~6 at 0x7ff0e011b130> output\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/__init__.py\", line 94, in compile_ir_to_sql_tree\r\n          qtree = dispatch.compile(ir_expr, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 60, in compile_Set\r\n          _compile_set_impl(ir_set, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 114, in _compile_set_impl\r\n          _compile_set(ir_set, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 589, in _compile_set\r\n          relgen.get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 136, in get_set_rvar\r\n          return _process_toplevel_query(ir_set, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 243, in _process_toplevel_query\r\n          rvars = _get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 277, in _get_set_rvar\r\n          rvars = process_set_as_subquery(ir_set, stmt, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 1218, in process_set_as_subquery\r\n          dispatch.visit(ir_set.expr, ctx=newctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/dispatch.py\", line 44, in visit\r\n          compile(ir, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/stmt.py\", line 95, in compile_SelectStmt\r\n          outvar = clauses.compile_output(stmt.result, ctx=ictx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/clauses.py\", line 174, in compile_output\r\n          dispatch.visit(ir_set, ctx=newctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 85, in visit_Set\r\n          _compile_set_impl(ir_set, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 114, in _compile_set_impl\r\n          _compile_set(ir_set, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 593, in _compile_set\r\n          _compile_shape(ir_set, ir_set.shape, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 612, in _compile_shape\r\n          result = shapecomp.compile_shape(ir_set, shape, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/shapecomp.py\", line 79, in compile_shape\r\n          wrapper = relgen.set_as_subquery(\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 422, in set_as_subquery\r\n          dispatch.visit(ir_set, ctx=subctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 85, in visit_Set\r\n          _compile_set_impl(ir_set, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 110, in _compile_set_impl\r\n          _compile_set(ir_set, ctx=scopectx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 589, in _compile_set\r\n          relgen.get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 189, in get_set_rvar\r\n          rvars = _get_set_rvar(ir_set, ctx=subctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 277, in _get_set_rvar\r\n          rvars = process_set_as_subquery(ir_set, stmt, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 1218, in process_set_as_subquery\r\n          dispatch.visit(ir_set.expr, ctx=newctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/dispatch.py\", line 44, in visit\r\n          compile(ir, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/stmt.py\", line 95, in compile_SelectStmt\r\n          outvar = clauses.compile_output(stmt.result, ctx=ictx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/clauses.py\", line 174, in compile_output\r\n          dispatch.visit(ir_set, ctx=newctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 85, in visit_Set\r\n          _compile_set_impl(ir_set, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 114, in _compile_set_impl\r\n          _compile_set(ir_set, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 589, in _compile_set\r\n          relgen.get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 189, in get_set_rvar\r\n          rvars = _get_set_rvar(ir_set, ctx=subctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 371, in _get_set_rvar\r\n          rvars = process_set_as_path(ir_set, stmt, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 945, in process_set_as_path\r\n          return process_set_as_path_type_intersection(\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 854, in process_set_as_path_type_intersection\r\n          source_rvar = get_set_rvar(ir_source, ctx=subctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 198, in get_set_rvar\r\n          result_rvar = _include_rvars(rvars, scope_stmt=scope_stmt, ctx=subctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 224, in _include_rvars\r\n          relctx.include_specific_rvar(\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/relctx.py\", line 219, in include_specific_rvar\r\n          rel_join(stmt, rvar, ctx=ctx)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/relctx.py\", line 763, in rel_join\r\n          rref = pathctx.get_rvar_path_identity_var(\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/pathctx.py\", line 561, in get_rvar_path_identity_var\r\n          return get_rvar_path_var(rvar, path_id, aspect='identity', env=env)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/pathctx.py\", line 549, in get_rvar_path_var\r\n          return astutils.get_rvar_var(rvar, outvar)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/astutils.py\", line 333, in get_rvar_var\r\n          fieldref = get_column(rvar, var)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/astutils.py\", line 279, in get_column\r\n          col_idx = find_column_in_subselect_rvar(rvar, colname)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/astutils.py\", line 255, in find_column_in_subselect_rvar\r\n          raise RuntimeError(f'cannot find {name!r} in {rvar} output')\r\n      RuntimeError: cannot find 'a8aaa4d4-ce3b-11eb-b9f7-85bc9f63d0a6' in <pg.RangeSubselect alias=q~6 at 0x7ff0e011b130> output\r\n      \r\n      The above exception was the direct cause of the following exception:\r\n      \r\n      Traceback (most recent call last):\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/server/compiler_pool/worker.py\", line 311, in worker\r\n          res = meth(*args)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/server/compiler_pool/worker.py\", line 180, in compile\r\n          units, cstate = COMPILER.compile(\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 2005, in compile\r\n          units = self._compile(ctx=ctx, source=source)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1584, in _compile\r\n          return self._try_compile(ctx=ctx, source=source)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1637, in _try_compile\r\n          comp, capabilities = self._compile_dispatch_ql(ctx, stmt)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1558, in _compile_dispatch_ql\r\n          query = self._compile_ql_query(ctx, ql)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 597, in _compile_ql_query\r\n          sql_text, argmap = pg_compiler.compile_ir_to_sql(\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/__init__.py\", line 116, in compile_ir_to_sql\r\n          qtree = compile_ir_to_sql_tree(\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta3-dev202105190000/lib/edgedb-server-1-beta3-dev202105190000/lib/python3.9/site-packages/edb/pgsql/compiler/__init__.py\", line 101, in compile_ir_to_sql_tree\r\n          raise errors.InternalServerError(*args) from e\r\n      edb.errors.InternalServerError: cannot find 'a8aaa4d4-ce3b-11eb-b9f7-85bc9f63d0a6' in <pg.RangeSubselect alias=q~6 at 0x7ff0e011b130> output\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2599/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2599/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2575", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2575/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2575/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2575/events", "html_url": "https://github.com/edgedb/edgedb/issues/2575", "id": 910890241, "node_id": "MDU6SXNzdWU5MTA4OTAyNDE=", "number": 2575, "title": "The cfg::AbstractConfig queries seem to be broken", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-06-03T21:52:50Z", "updated_at": "2021-11-09T23:41:22Z", "closed_at": "2021-11-09T23:41:22Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0-beta.3+dev5660.d2021060321.g3110366b9.cv202105190000\r\n- OS Version: Linux\r\n\r\nSteps to Reproduce:\r\n\r\n```\r\nedgedb> SELECT cfg::AbstractConfig {__type__: {name}, listen_port, listen_addresses};\r\nERROR: InternalServerError: relation \"edgedbss.a6336df0-c4b1-11eb-a571-43dbd2e0040f_t\" does not exist\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: relation \"edgedbss.a6336df0-c4b1-11eb-a571-43dbd2e0040f_t\" does not exist\r\n```\r\n\r\nAlso, the results for the specific configs are suspicious as they all claim to be `cfg::Config` by type name:\r\n```\r\nedgedb> SELECT cfg::DatabaseConfig {__type__: {name}, listen_port, listen_addresses};\r\n{cfg::Config {__type__: schema::ObjectType {name: 'cfg::Config'}, listen_port: 5656, listen_addresses: {}}}\r\nedgedb> SELECT cfg::SystemConfig {__type__: {name}, listen_port, listen_addresses};\r\n{cfg::Config {__type__: schema::ObjectType {name: 'cfg::Config'}, listen_port: 5656, listen_addresses: {}}}\r\nedgedb> SELECT cfg::Config {__type__: {name}, listen_port, listen_addresses};\r\n{cfg::Config {__type__: schema::ObjectType {name: 'cfg::Config'}, listen_port: 5656, listen_addresses: {}}}\r\n```\r\n...and by `IS` check:\r\n```\r\nedgedb> SELECT cfg::SystemConfig IS cfg::SystemConfig;\r\n{false}\r\nedgedb> SELECT cfg::SystemConfig IS cfg::Config;\r\n{true}\r\n```\r\n\r\nWhile in the schema they are supposed to be siblings extending `AbstractConfig`.\r\n\r\nThese config types seem to work OK with `INTROSPECT` though.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2575/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2575/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2556", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2556/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2556/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2556/events", "html_url": "https://github.com/edgedb/edgedb/issues/2556", "id": 899325544, "node_id": "MDU6SXNzdWU4OTkzMjU1NDQ=", "number": 2556, "title": "Inheriting from enum throws UnresolvedReferenceError stack", "user": {"login": "limx0", "id": 4816153, "node_id": "MDQ6VXNlcjQ4MTYxNTM=", "avatar_url": "https://avatars.githubusercontent.com/u/4816153?v=4", "gravatar_id": "", "url": "https://api.github.com/users/limx0", "html_url": "https://github.com/limx0", "followers_url": "https://api.github.com/users/limx0/followers", "following_url": "https://api.github.com/users/limx0/following{/other_user}", "gists_url": "https://api.github.com/users/limx0/gists{/gist_id}", "starred_url": "https://api.github.com/users/limx0/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/limx0/subscriptions", "organizations_url": "https://api.github.com/users/limx0/orgs", "repos_url": "https://api.github.com/users/limx0/repos", "events_url": "https://api.github.com/users/limx0/events{/privacy}", "received_events_url": "https://api.github.com/users/limx0/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2021-05-24T06:39:48Z", "updated_at": "2021-09-03T20:42:46Z", "closed_at": "2021-09-03T20:42:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "I accidentally inherited from an enum type instead of my abstract type, which threw the following stacktrace.\r\n\r\n```\r\n\u276f edgedb create-migration\r\nERROR: InternalServerError: reference to an undefined item default::AnEnum in default::SubType\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta2/lib/edgedb-server-1-beta2/lib/python3.9/site-packages/edb/server/compiler_pool/worker.py\", line 312, in worker\r\n          res = meth(*args)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta2/lib/edgedb-server-1-beta2/lib/python3.9/site-packages/edb/server/compiler_pool/worker.py\", line 173, in compile\r\n          units, cstate = COMPILER.compile(\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta2/lib/edgedb-server-1-beta2/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1986, in compile\r\n          units = self._compile(ctx=ctx, source=source)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta2/lib/edgedb-server-1-beta2/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1565, in _compile\r\n          return self._try_compile(ctx=ctx, source=source)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta2/lib/edgedb-server-1-beta2/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1618, in _try_compile\r\n          comp, capabilities = self._compile_dispatch_ql(ctx, stmt)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta2/lib/edgedb-server-1-beta2/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1501, in _compile_dispatch_ql\r\n          query = self._compile_ql_migration(ctx, ql)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta2/lib/edgedb-server-1-beta2/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 915, in _compile_ql_migration\r\n          target_schema = s_ddl.apply_sdl(\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta2/lib/edgedb-server-1-beta2/lib/python3.9/site-packages/edb/schema/ddl.py\", line 479, in apply_sdl\r\n          ddl_stmts = s_decl.sdl_to_ddl(current_schema, documents)\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta2/lib/edgedb-server-1-beta2/lib/python3.9/site-packages/edb/edgeql/declarative.py\", line 337, in sdl_to_ddl\r\n          topological.normalize(\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta2/lib/edgedb-server-1-beta2/lib/python3.9/site-packages/edb/common/topological.py\", line 210, in normalize\r\n          for name, item in sort_ex(graph):\r\n        File \"/Library/Frameworks/EdgeDB.framework/Versions/1-beta2/lib/edgedb-server-1-beta2/lib/python3.9/site-packages/edb/common/topological.py\", line 106, in sort_ex\r\n          raise UnresolvedReferenceError(\r\n      edb.common.topological.UnresolvedReferenceError: reference to an undefined item default::AnEnum in default::SubType\r\nedgedb error: cannot proceed until .esdl files are fixed\r\n``` \r\n\r\n<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0b2+ga7130d5c7.cv202104290000\r\n- OS Version: macOS Big Sur (11.3.1)\r\n\r\nSteps to Reproduce:\r\n1. Add schema\r\n2. create-migration\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n```\r\nscalar type AnEnum extending enum<TEST>;\r\ntype SubType extending AnEnum {}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2556/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2556/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2542", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2542/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2542/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2542/events", "html_url": "https://github.com/edgedb/edgedb/issues/2542", "id": 888978441, "node_id": "MDU6SXNzdWU4ODg5Nzg0NDE=", "number": 2542, "title": "Nested mutation with same object type errors out", "user": {"login": "colinhacks", "id": 3084745, "node_id": "MDQ6VXNlcjMwODQ3NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/3084745?v=4", "gravatar_id": "", "url": "https://api.github.com/users/colinhacks", "html_url": "https://github.com/colinhacks", "followers_url": "https://api.github.com/users/colinhacks/followers", "following_url": "https://api.github.com/users/colinhacks/following{/other_user}", "gists_url": "https://api.github.com/users/colinhacks/gists{/gist_id}", "starred_url": "https://api.github.com/users/colinhacks/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/colinhacks/subscriptions", "organizations_url": "https://api.github.com/users/colinhacks/orgs", "repos_url": "https://api.github.com/users/colinhacks/repos", "events_url": "https://api.github.com/users/colinhacks/events{/privacy}", "received_events_url": "https://api.github.com/users/colinhacks/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2021-05-11T22:45:24Z", "updated_at": "2021-09-03T22:50:20Z", "closed_at": "2021-09-03T22:50:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "\r\n<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: beta 2\r\n- OS Version: macOS Big Sure\r\n\r\nSteps to Reproduce:\r\n\r\nReproduction repo: https://github.com/colinhacks/edgedb-update-insert-bug\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2542/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2542/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2540", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2540/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2540/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2540/events", "html_url": "https://github.com/edgedb/edgedb/issues/2540", "id": 885351099, "node_id": "MDU6SXNzdWU4ODUzNTEwOTk=", "number": 2540, "title": "Invalid serialization for DISTINCT/shape/collection combo", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-05-10T23:26:32Z", "updated_at": "2021-05-26T00:39:39Z", "closed_at": "2021-05-26T00:39:39Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nWITH MODULE test,\r\nSELECT DISTINCT ((SELECT Card), 1)\r\n```\r\nproduces json output that contains bare IDs instead of shapes and native output that crashes the decoder.\r\nSame issue with\r\n```\r\nWITH MODULE test,\r\nSELECT DISTINCT [(SELECT Card {name})];\r\n```\r\n\r\nThis is probably a pretty similar issue to that fixed in #2274.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2540/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2540/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2522", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2522/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2522/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2522/events", "html_url": "https://github.com/edgedb/edgedb/issues/2522", "id": 875322586, "node_id": "MDU6SXNzdWU4NzUzMjI1ODY=", "number": 2522, "title": "ISE when running `describe schema as sdl` if an extension is enabled", "user": {"login": "jaclarke", "id": 2085287, "node_id": "MDQ6VXNlcjIwODUyODc=", "avatar_url": "https://avatars.githubusercontent.com/u/2085287?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaclarke", "html_url": "https://github.com/jaclarke", "followers_url": "https://api.github.com/users/jaclarke/followers", "following_url": "https://api.github.com/users/jaclarke/following{/other_user}", "gists_url": "https://api.github.com/users/jaclarke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaclarke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaclarke/subscriptions", "organizations_url": "https://api.github.com/users/jaclarke/orgs", "repos_url": "https://api.github.com/users/jaclarke/repos", "events_url": "https://api.github.com/users/jaclarke/events{/privacy}", "received_events_url": "https://api.github.com/users/jaclarke/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-05-04T10:25:58Z", "updated_at": "2021-05-04T17:22:37Z", "closed_at": "2021-05-04T17:22:37Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: 1.0-beta.2+dev5631.d2021050409.gec3bd1e8f.cv202104290000\r\n\r\n@colinhacks reported in slack that `describe schema as sdl` fails on the tutorial schema. It seems that it's specifically having the notebook extension (or any extension) enabled that causes the error.\r\n\r\nSteps to Reproduce:\r\n```\r\nedgedb> describe schema as sdl;\r\n{'module default{};'}\r\nedgedb> create extension graphql;\r\nOK: CREATE EXTENSION\r\nedgedb> describe schema as sdl;\r\nERROR: InternalServerError: ''\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/home/james/dev/edgedb/edb/server/compiler_pool/worker.py\", line 312, in worker\r\n          res = meth(*args)\r\n        File \"/home/james/dev/edgedb/edb/server/compiler_pool/worker.py\", line 173, in compile\r\n          units, cstate = COMPILER.compile(\r\n        File \"/home/james/dev/edgedb/edb/server/compiler/compiler.py\", line 1986, in compile\r\n          units = self._compile(ctx=ctx, source=source)\r\n        File \"/home/james/dev/edgedb/edb/server/compiler/compiler.py\", line 1565, in _compile\r\n          return self._try_compile(ctx=ctx, source=source)\r\n        File \"/home/james/dev/edgedb/edb/server/compiler/compiler.py\", line 1618, in _try_compile\r\n          comp, capabilities = self._compile_dispatch_ql(ctx, stmt)\r\n        File \"/home/james/dev/edgedb/edb/server/compiler/compiler.py\", line 1539, in _compile_dispatch_ql\r\n          query = self._compile_ql_query(ctx, ql)\r\n        File \"/home/james/dev/edgedb/edb/server/compiler/compiler.py\", line 563, in _compile_ql_query\r\n          ir = qlcompiler.compile_ast_to_ir(\r\n        File \"/home/james/dev/edgedb/edb/edgeql/compiler/__init__.py\", line 177, in wrapper\r\n          return func(*args, **kwargs)\r\n        File \"/home/james/dev/edgedb/edb/edgeql/compiler/__init__.py\", line 225, in compile_ast_to_ir\r\n          ir_set = dispatch_mod.compile(tree, ctx=ctx)\r\n        File \"/usr/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/james/dev/edgedb/edb/edgeql/compiler/stmt.py\", line 796, in compile_DescribeStmt\r\n          text = s_ddl.sdl_text_from_schema(\r\n        File \"/home/james/dev/edgedb/edb/schema/ddl.py\", line 906, in sdl_text_from_schema\r\n          return sdl_text_from_delta(None, schema, diff)\r\n        File \"/home/james/dev/edgedb/edb/schema/ddl.py\", line 821, in sdl_text_from_delta\r\n          return text_from_delta(schema_a, schema_b, delta, sdlmode=True)\r\n        File \"/home/james/dev/edgedb/edb/schema/ddl.py\", line 769, in text_from_delta\r\n          stmts = statements_from_delta(\r\n        File \"/home/james/dev/edgedb/edb/schema/ddl.py\", line 735, in statements_from_delta\r\n          module = modules[stmt_ast.name.module]\r\n      KeyError: ''\r\n```\r\n\r\nThere's also a related bug that the exension sdl/ddl appears in all the `describe module ...` outputs, which I think is incorrect behaviour, since the extension isn't really part of any module:\r\n```\r\nedgedb> describe module default as sdl;\r\n{'using extension graphql VERSION \\'1.0\\';'}\r\nedgedb> describe module math as sdl;\r\n... removed rest of output\r\nfunction math::lg(x: std::decimal) ->  std::decimal {\r\n    volatility := \\'Immutable\\';\r\n    annotation std::description := \\'Return the base 10 logarithm of the input value.\\';\r\n    using sql function \\'log\\'\r\n;};\r\nusing extension graphql VERSION \\'1.0\\';',\r\n}\r\nedgedb> describe module ... etc.\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2522/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2522/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2505", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2505/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2505/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2505/events", "html_url": "https://github.com/edgedb/edgedb/issues/2505", "id": 869265836, "node_id": "MDU6SXNzdWU4NjkyNjU4MzY=", "number": 2505, "title": "No enforcement of newly created required multi pointers", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-04-27T21:08:05Z", "updated_at": "2021-04-30T20:51:30Z", "closed_at": "2021-04-30T20:51:30Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nedgedb> create type Foo { create multi property tags -> str; };\r\nOK: CREATE TYPE\r\nedgedb> insert Foo;\r\n[{\"id\": \"290bb6ac-a79c-11eb-9b61-b7d69260fef9\"}]\r\nedgedb> alter type Foo alter property tags set required;\r\nOK: ALTER TYPE\r\nedgedb> alter type Foo create required multi property tags2 -> str;\r\nOK: ALTER TYPE\r\nedgedb> select Foo {tags, tags2};\r\n[{\"tags\": [], \"tags2\": []}]\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2505/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2505/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2460", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2460/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2460/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2460/events", "html_url": "https://github.com/edgedb/edgedb/issues/2460", "id": 860070050, "node_id": "MDU6SXNzdWU4NjAwNzAwNTA=", "number": 2460, "title": "Inconsistent handling of `{}` by the `IF` operator", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-04-16T18:27:37Z", "updated_at": "2021-04-20T20:59:23Z", "closed_at": "2021-04-20T20:59:23Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0-beta.2+dev.5580.ge5414991c \r\n- OS Version: Linux\r\n\r\nSteps to Reproduce:\r\n\r\n```\r\ndb> CREATE TYPE Foo { CREATE PROPERTY opt -> int64; CREATE REQUIRED PROPERTY val -> str; };\r\nOK: CREATE TYPE\r\ndb> INSERT Foo {val := 'a'};\r\n{default::Foo {id: da4de6e0-9ede-11eb-bbd8-f7d69321c5d6}}\r\ndb> INSERT Foo {val := 'b', opt := 111};\r\n{default::Foo {id: e1d0fef2-9ede-11eb-bbd8-1fcfa95ddf34}}\r\ndb> SELECT Foo.val;\r\n{'a', 'b'}\r\ndb> SELECT Foo.opt;\r\n{111}\r\ndb> WITH \r\n...   a := (SELECT Foo FILTER .val = 'a'),\r\n...   b := (SELECT Foo FILTER .val = 'b'),\r\n... SELECT a.opt < b.opt;\r\n{}\r\ndb> WITH \r\n...   a := (SELECT Foo FILTER .val = 'a'),\r\n...   b := (SELECT Foo FILTER .val = 'b'),\r\n... SELECT a.val IF a.opt < b.opt ELSE b.val;\r\n{'b'}\r\ndb> WITH \r\n...   a := (SELECT Foo FILTER .val = 'a'),\r\n...   b := (SELECT Foo FILTER .val = 'b'),\r\n... SELECT a.val IF <int64>{} < 111 ELSE b.val;\r\n{}\r\ndb> WITH \r\n...   a := (SELECT Foo FILTER .val = 'a'),\r\n...   b := (SELECT Foo FILTER .val = 'b'),\r\n...   c := <int64>{},\r\n...   d := 111,\r\n... SELECT a.val IF c < d ELSE b.val;\r\n{}\r\n```\r\nThe problem is that the query `SELECT a.val IF a.opt < b.opt ELSE b.val;` should be returning `{}` by our rules, but does not, while very similar expressions (involving the same values) correctly return `{}`.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2460/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2460/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2459", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2459/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2459/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2459/events", "html_url": "https://github.com/edgedb/edgedb/issues/2459", "id": 860017214, "node_id": "MDU6SXNzdWU4NjAwMTcyMTQ=", "number": 2459, "title": "Inconsistent casting of `bytes`", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 932934397, "node_id": "MDU6TGFiZWw5MzI5MzQzOTc=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/edgeql", "name": "edgeql", "color": "0052cc", "default": false, "description": ""}, {"id": 1706980018, "node_id": "MDU6TGFiZWwxNzA2OTgwMDE4", "url": "https://api.github.com/repos/edgedb/edgedb/labels/usability", "name": "usability", "color": "5e02d6", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-04-16T17:24:52Z", "updated_at": "2021-11-08T19:57:57Z", "closed_at": "2021-11-08T19:57:57Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Weird thing about `<json>` casts is that `bytes` can be cast when part of a shape, but not directly.\r\n\r\n```\r\ndb> SELECT <json>Foo{z := b'abc'};\r\n{\"{\\\"z\\\": \\\"\\\\\\\\x616263\\\"}\"}\r\ndb> SELECT <json>b'abc';\r\nerror: cannot cast 'std::bytes' to 'std::json'\r\n  \u250c\u2500 query:1:14\r\n  \u2502\r\n1 \u2502 SELECT <json>b'abc';\r\n  \u2502              ^^^^^^ error\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2459/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2459/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2455", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2455/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2455/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2455/events", "html_url": "https://github.com/edgedb/edgedb/issues/2455", "id": 859205394, "node_id": "MDU6SXNzdWU4NTkyMDUzOTQ=", "number": 2455, "title": "Duplicate links in SELECT when using `+=` to `UPDATE` a multi link", "user": {"login": "clmnin", "id": 17064666, "node_id": "MDQ6VXNlcjE3MDY0NjY2", "avatar_url": "https://avatars.githubusercontent.com/u/17064666?v=4", "gravatar_id": "", "url": "https://api.github.com/users/clmnin", "html_url": "https://github.com/clmnin", "followers_url": "https://api.github.com/users/clmnin/followers", "following_url": "https://api.github.com/users/clmnin/following{/other_user}", "gists_url": "https://api.github.com/users/clmnin/gists{/gist_id}", "starred_url": "https://api.github.com/users/clmnin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/clmnin/subscriptions", "organizations_url": "https://api.github.com/users/clmnin/orgs", "repos_url": "https://api.github.com/users/clmnin/repos", "events_url": "https://api.github.com/users/clmnin/events{/privacy}", "received_events_url": "https://api.github.com/users/clmnin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-04-15T19:58:59Z", "updated_at": "2021-04-20T05:28:11Z", "closed_at": "2021-04-20T04:42:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0-beta.2+dev.5560.g9e95b0fa7\r\n- OS Version: Ubtunu 20.04 LTS\r\n\r\nSteps to Reproduce:\r\n\r\n1. Create schema and populate the database\r\n    <details><summary>Initialize (Schema + populate)</summary>\r\n    <p>\r\n\r\n    ```sql\r\n    START MIGRATION TO {\r\n        module default {\r\n            scalar type OrderNo extending sequence;\r\n            type User {\r\n                required property name -> str {\r\n                    constraint exclusive;\r\n                }\r\n            }\r\n            type Product {\r\n                required property name -> str {\r\n                    constraint exclusive;\r\n                }\r\n                property description -> str;\r\n            }\r\n            type SaleOrder {\r\n                required property order_num -> OrderNo;\r\n                multi link lines -> OrderLine;\r\n                required link customer -> User;\r\n                required link merchant -> User;\r\n                property create_date -> datetime {\r\n                    default := datetime_current();\r\n                }\r\n            }\r\n            type OrderLine {\r\n                required link product -> Product;\r\n                required property ordered -> int32;\r\n                required property accepted -> int32 {\r\n                    default := 0;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    POPULATE MIGRATION;\r\n    COMMIT MIGRATION;\r\n\r\n    INSERT User {name := \"Alice\"};\r\n    INSERT User {name := \"Bob\"};\r\n    INSERT Product {name := \"Product 1\", description := \"Product 1\"};\r\n    INSERT Product {name := \"Product 2\", description := \"Product 2\"};\r\n    INSERT Product {name := \"Product 3\", description := \"Product 3\"};\r\n    INSERT SaleOrder {\r\n        customer := (SELECT User FILTER .name = <str>\"Alice\"), \r\n        merchant := (SELECT User FILTER .name = <str>\"Bob\"), \r\n        lines := {\r\n            (INSERT OrderLine { product := (SELECT Product FILTER .name = <str>\"Product 1\"), ordered := 1}),\r\n            (INSERT OrderLine { product := (SELECT Product FILTER .name = <str>\"Product 2\"), ordered := 2})\r\n        }\r\n    };\r\n    INSERT SaleOrder {\r\n        customer := (SELECT User FILTER .name = <str>\"Alice\"), \r\n        merchant := (SELECT User FILTER .name = <str>\"Bob\"), \r\n        lines := {\r\n            (INSERT OrderLine { product := (SELECT Product FILTER .name = <str>\"Product 3\"), ordered := 3})\r\n        }\r\n    };\r\n    ```\r\n    </p>\r\n    </details>\r\n2. SELECT and UPDATE an Entity using a single query\r\n    ```sql\r\n    SELECT (\r\n        UPDATE SaleOrder\r\n        FILTER .order_num = 1\r\n        SET {\r\n            lines += {\r\n                (UPDATE OrderLine FILTER .ordered = 1 SET { accepted := 1 }),\r\n                (UPDATE OrderLine FILTER .ordered = 2 SET { accepted := 2 })\r\n            }\r\n        }\r\n    ){\r\n        order_num,\r\n        lines : { product, ordered, accepted }\r\n    };\r\n    ```\r\n3. It returns duplicate links\r\n    ```\r\n    {\r\n    default::SaleOrder {\r\n        order_num: 1,\r\n        lines: {\r\n        default::OrderLine {product: default::Product {id: 625e1d8a-9e22-11eb-9e20-6f36d2ecd851}, ordered: 1, accepted: 1},\r\n        default::OrderLine {product: default::Product {id: 625e1d8a-9e22-11eb-9e20-6f36d2ecd851}, ordered: 1, accepted: 1},\r\n        default::OrderLine {product: default::Product {id: 625e1d8b-9e22-11eb-9e20-4f1c77ef3b1b}, ordered: 2, accepted: 2},\r\n        default::OrderLine {product: default::Product {id: 625e1d8b-9e22-11eb-9e20-4f1c77ef3b1b}, ordered: 2, accepted: 2},\r\n        },\r\n    },\r\n    }\r\n    ```\r\n4. But if you read that entity again then we don't have duplicates (an expected behaviour)\r\n    ```sql\r\n    SELECT SaleOrder {\r\n        order_num,\r\n        lines : { product, ordered, accepted }\r\n    } FILTER .order_num = 1;\r\n    ```\r\n    Which returns\r\n    ```\r\n    {\r\n    default::SaleOrder {\r\n        order_num: 1,\r\n        lines: {\r\n        default::OrderLine {product: default::Product {id: 625e1d8a-9e22-11eb-9e20-6f36d2ecd851}, ordered: 1, accepted: 1},\r\n        default::OrderLine {product: default::Product {id: 625e1d8b-9e22-11eb-9e20-4f1c77ef3b1b}, ordered: 2, accepted: 2},\r\n        },\r\n    },\r\n    }\r\n    ```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2455/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2455/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2441", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2441/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2441/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2441/events", "html_url": "https://github.com/edgedb/edgedb/issues/2441", "id": 852704074, "node_id": "MDU6SXNzdWU4NTI3MDQwNzQ=", "number": 2441, "title": "Restoring a sequence type from a dump resets the counter.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-04-07T18:41:02Z", "updated_at": "2021-04-28T20:45:46Z", "closed_at": "2021-04-28T20:45:46Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: EdgeDB 1.0-beta.2+dev.5562.g64ae7622e\r\n- OS Version: Linux\r\n\r\nSteps to Reproduce:\r\n\r\n1. Create a database with the schema\r\n    ```\r\n    scalar type MySeq extending sequence;\r\n    type Foo {\r\n        required property num -> MySeq;\r\n    };\r\n    ```\r\n2. Insert a few objects: `FOR x IN {1, 2, 3, 4} UNION (INSERT Foo);`\r\n3. Dump the database.\r\n4. Drop/create the database (or in any other way prepare a blank database to restore to).\r\n5. Restore the database.\r\n6. Run `INSERT Foo`.\r\n7. Observe that the `MySeq` sequence was reset:\r\n    ```\r\n    db> select Foo.num;\r\n    {1, 2, 3, 4, 1}\r\n    ```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2441/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2441/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2428", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2428/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2428/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2428/events", "html_url": "https://github.com/edgedb/edgedb/issues/2428", "id": 848922796, "node_id": "MDU6SXNzdWU4NDg5MjI3OTY=", "number": 2428, "title": "DatabaseConnectionView object has no attribute 'name'", "user": {"login": "Mulugruntz", "id": 13810199, "node_id": "MDQ6VXNlcjEzODEwMTk5", "avatar_url": "https://avatars.githubusercontent.com/u/13810199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mulugruntz", "html_url": "https://github.com/Mulugruntz", "followers_url": "https://api.github.com/users/Mulugruntz/followers", "following_url": "https://api.github.com/users/Mulugruntz/following{/other_user}", "gists_url": "https://api.github.com/users/Mulugruntz/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mulugruntz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mulugruntz/subscriptions", "organizations_url": "https://api.github.com/users/Mulugruntz/orgs", "repos_url": "https://api.github.com/users/Mulugruntz/repos", "events_url": "https://api.github.com/users/Mulugruntz/events{/privacy}", "received_events_url": "https://api.github.com/users/Mulugruntz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 2877515629, "node_id": "MDU6TGFiZWwyODc3NTE1NjI5", "url": "https://api.github.com/repos/edgedb/edgedb/labels/server", "name": "server", "color": "4023F4", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "fantix", "id": 1751601, "node_id": "MDQ6VXNlcjE3NTE2MDE=", "avatar_url": "https://avatars.githubusercontent.com/u/1751601?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fantix", "html_url": "https://github.com/fantix", "followers_url": "https://api.github.com/users/fantix/followers", "following_url": "https://api.github.com/users/fantix/following{/other_user}", "gists_url": "https://api.github.com/users/fantix/gists{/gist_id}", "starred_url": "https://api.github.com/users/fantix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fantix/subscriptions", "organizations_url": "https://api.github.com/users/fantix/orgs", "repos_url": "https://api.github.com/users/fantix/repos", "events_url": "https://api.github.com/users/fantix/events{/privacy}", "received_events_url": "https://api.github.com/users/fantix/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fantix", "id": 1751601, "node_id": "MDQ6VXNlcjE3NTE2MDE=", "avatar_url": "https://avatars.githubusercontent.com/u/1751601?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fantix", "html_url": "https://github.com/fantix", "followers_url": "https://api.github.com/users/fantix/followers", "following_url": "https://api.github.com/users/fantix/following{/other_user}", "gists_url": "https://api.github.com/users/fantix/gists{/gist_id}", "starred_url": "https://api.github.com/users/fantix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fantix/subscriptions", "organizations_url": "https://api.github.com/users/fantix/orgs", "repos_url": "https://api.github.com/users/fantix/repos", "events_url": "https://api.github.com/users/fantix/events{/privacy}", "received_events_url": "https://api.github.com/users/fantix/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2021-04-02T03:01:58Z", "updated_at": "2021-04-18T21:29:05Z", "closed_at": "2021-04-18T21:29:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: Docker image: edgedb/edgedb:1-beta1\r\n- OS Version:\r\n\r\nI'm finding out that the server crashes with this error quite a lot.\r\nI already had something similar https://github.com/edgedb/edgedb/issues/2316\r\nI'm giving most of my dev machine's resource to EdgeDB (so everything else is pretty slow). Therefore, trying to give more resource is not an option (sadly).\r\n\r\nTo be noted: Even though the error message is indeed different (or maybe not, after re-reading the debug logs, not sure anymore...), it sometimes still results in the famous \"recovery mode\". Then, I have to manually kill the container, restart it.\r\n\r\n<details>\r\n\r\n    INFO 1 2021-04-02 01:57:30,516 edb.server: EdgeDB server (1.0-beta.1+g2eee1afe4.d20210301) starting.\r\n    INFO 1 2021-04-02 01:57:50,088 edb.server: Serving on 0.0.0.0:5656\r\n    INFO 1 2021-04-02 01:57:50,090 edb.server: Serving on /run/edgedb/.s.EDGEDB.5656\r\n    INFO 1 2021-04-02 01:57:50,091 edb.server: Serving admin on /run/edgedb/.s.EDGEDB.admin.5656\r\n    ---- Exception occurred: 'edb.server.dbview.dbview.DatabaseConnectionView' object has no attribute 'name' ----\r\n\r\n    1. AttributeError: 'edb.server.dbview.dbview.DatabaseConnectionView' object has no attribute 'name'\r\n\r\n    ---- Traceback ----\r\n\r\n        uvloop/cbhandles.pyx, line 69, in uvloop.loop.Handle._run\r\n            > trimmed = Field(bool, default=False)\r\n        uvloop/handles/basetransport.pyx, line 169, in uvloop.loop.UVBaseTransport._call_connection_lost\r\n            > ExceptionContextList = checked.CheckedList[ExceptionContext]\r\n        edb/server/protocol/binary.pyx, line 2081, in edb.server.protocol.binary.EdgeConnection.connection_lost\r\n            \r\n\r\n    AttributeError: 'edb.server.dbview.dbview.DatabaseConnectionView' object has no attribute 'name'\r\n    ERROR 1 2021-04-02 02:20:14,437 asyncio: Exception in callback UVTransport._call_connection_lost\r\n    handle: <Handle UVTransport._call_connection_lost>\r\n    ---- Exception occurred: 'edb.server.dbview.dbview.DatabaseConnectionView' object has no attribute 'name' ----\r\n\r\n    1. AttributeError: 'edb.server.dbview.dbview.DatabaseConnectionView' object has no attribute 'name'\r\n\r\n    ---- Traceback ----\r\n\r\n        uvloop/cbhandles.pyx, line 69, in uvloop.loop.Handle._run\r\n            > trimmed = Field(bool, default=False)\r\n        uvloop/handles/basetransport.pyx, line 169, in uvloop.loop.UVBaseTransport._call_connection_lost\r\n            > ExceptionContextList = checked.CheckedList[ExceptionContext]\r\n        edb/server/protocol/binary.pyx, line 2081, in edb.server.protocol.binary.EdgeConnection.connection_lost\r\n            \r\n\r\n    AttributeError: 'edb.server.dbview.dbview.DatabaseConnectionView' object has no attribute 'name'\r\n    ERROR 1 2021-04-02 02:20:15,745 asyncio: Exception in callback UVTransport._call_connection_lost\r\n    handle: <Handle UVTransport._call_connection_lost>\r\n    ---- Exception occurred: unable to perform operation on <TCPTransport closed=True reading=False 0x556b0faf7330>; the handler is closed ----\r\n\r\n    2. RuntimeError: unable to perform operation on <TCPTransport closed=True reading=False 0x556b0faf7330>; the handler is closed\r\n\r\n    ---- Traceback ----\r\n\r\n        edb/server/protocol/binary.pyx, line 1666, in edb.server.protocol.binary.EdgeConnection.main\r\n            \r\n        edb/server/protocol/binary.pyx, line 1597, in optimistic_execute\r\n            \r\n        edb/server/protocol/binary.pyx, line 1478, in _execute\r\n            \r\n        edb/server/protocol/binary.pyx, line 1444, in edb.server.protocol.binary.EdgeConnection._execute\r\n            \r\n        edb/server/pgcon/pgcon.pyx, line 771, in parse_execute\r\n            \r\n        edb/server/pgcon/pgcon.pyx, line 706, in _parse_execute\r\n            \r\n        edb/server/protocol/binary.pyx, line 289, in edb.server.protocol.binary.EdgeConnection.write\r\n            \r\n        edb/server/protocol/binary.pyx, line 324, in edb.server.protocol.binary.EdgeConnection.flush\r\n            \r\n        uvloop/handles/stream.pyx, line 673, in uvloop.loop.UVStream.write\r\n            \r\n        uvloop/handles/handle.pyx, line 159, in uvloop.loop.UVHandle._ensure_alive\r\n            \r\n\r\n    RuntimeError: unable to perform operation on <TCPTransport closed=True reading=False 0x556b0faf7330>; the handler is closed\r\n\r\n    ---- During handling of the above exception, another exception occurred ----\r\n\r\n    1. RuntimeError: unable to perform operation on <TCPTransport closed=True reading=False 0x556b0faf7330>; the handler is closed\r\n\r\n    ---- Traceback ----\r\n\r\n        edb/server/protocol/binary.pyx, line 1719, in edb.server.protocol.binary.EdgeConnection.main\r\n            \r\n        edb/server/protocol/binary.pyx, line 324, in edb.server.protocol.binary.EdgeConnection.flush\r\n            \r\n        uvloop/handles/stream.pyx, line 673, in uvloop.loop.UVStream.write\r\n            \r\n        uvloop/handles/handle.pyx, line 159, in uvloop.loop.UVHandle._ensure_alive\r\n            \r\n\r\n    RuntimeError: unable to perform operation on <TCPTransport closed=True reading=False 0x556b0faf7330>; the handler is closed\r\n    ERROR 1 2021-04-02 02:22:12,023 asyncio: unhandled error in edgedb protocol while handling an error\r\n    protocol: <edb.server.protocol.binary.EdgeConnection object at 0x7fd06b366120>\r\n    task: <Task pending name='Task-35' coro=<EdgeConnection.main() running>>\r\n    transport: <TCPTransport closed=True reading=False 0x556b0faf7330>\r\n    ---- Exception occurred: unable to perform operation on <TCPTransport closed=True reading=False 0x556b0fe517a0>; the handler is closed ----\r\n\r\n    2. RuntimeError: unable to perform operation on <TCPTransport closed=True reading=False 0x556b0fe517a0>; the handler is closed\r\n\r\n    ---- Traceback ----\r\n\r\n        edb/server/protocol/binary.pyx, line 1666, in edb.server.protocol.binary.EdgeConnection.main\r\n            \r\n        edb/server/protocol/binary.pyx, line 1597, in optimistic_execute\r\n            \r\n        edb/server/protocol/binary.pyx, line 1478, in _execute\r\n            \r\n        edb/server/protocol/binary.pyx, line 1444, in edb.server.protocol.binary.EdgeConnection._execute\r\n            \r\n        edb/server/pgcon/pgcon.pyx, line 771, in parse_execute\r\n            \r\n        edb/server/pgcon/pgcon.pyx, line 706, in _parse_execute\r\n            \r\n        edb/server/protocol/binary.pyx, line 289, in edb.server.protocol.binary.EdgeConnection.write\r\n            \r\n        edb/server/protocol/binary.pyx, line 324, in edb.server.protocol.binary.EdgeConnection.flush\r\n            \r\n        uvloop/handles/stream.pyx, line 673, in uvloop.loop.UVStream.write\r\n            \r\n        uvloop/handles/handle.pyx, line 159, in uvloop.loop.UVHandle._ensure_alive\r\n            \r\n\r\n    RuntimeError: unable to perform operation on <TCPTransport closed=True reading=False 0x556b0fe517a0>; the handler is closed\r\n\r\n    ---- During handling of the above exception, another exception occurred ----\r\n\r\n    1. RuntimeError: unable to perform operation on <TCPTransport closed=True reading=False 0x556b0fe517a0>; the handler is closed\r\n\r\n    ---- Traceback ----\r\n\r\n        edb/server/protocol/binary.pyx, line 1719, in edb.server.protocol.binary.EdgeConnection.main\r\n            \r\n        edb/server/protocol/binary.pyx, line 324, in edb.server.protocol.binary.EdgeConnection.flush\r\n            \r\n        uvloop/handles/stream.pyx, line 673, in uvloop.loop.UVStream.write\r\n            \r\n        uvloop/handles/handle.pyx, line 159, in uvloop.loop.UVHandle._ensure_alive\r\n            \r\n\r\n    RuntimeError: unable to perform operation on <TCPTransport closed=True reading=False 0x556b0fe517a0>; the handler is closed\r\n    ERROR 1 2021-04-02 02:22:31,701 asyncio: unhandled error in edgedb protocol while handling an error\r\n    protocol: <edb.server.protocol.binary.EdgeConnection object at 0x7fd06b366040>\r\n    task: <Task pending name='Task-34' coro=<EdgeConnection.main() running>>\r\n    transport: <TCPTransport closed=True reading=False 0x556b0fe517a0>\r\n</details>\r\n\r\nWhat I'm currently doing: adding millions of rows into the DB, about a few tens of thousands at a time. I have 2 async connections open that I acquire from a pool (min=2). I now added a sleep of 1 seconds after each batch.\r\nIt looks a bit like:\r\n\r\n```python\r\n@asynccontextmanager\r\nasync def db_connect() -> AsyncContextManager:\r\n    async with await edgedb.create_async_pool(\r\n        min_size=2, **DB_CONNECTION_PROPS\r\n    ) as pool:\r\n        yield pool\r\n\r\nasync def save_data(pool, data):\r\n    async for tx in pool.retrying_transaction():\r\n        async with tx:\r\n            await delete_data_if_needed(tx, data)\r\n            await insert_data(tx, data)\r\n            metadata = get_metadata(data)\r\n            await insert_or_update_metadata(tx, metadata)\r\n\r\nasync def func_in_worker(queue: asyncio.Queue):\r\n    async with db_connect() as pool:\r\n        while True:\r\n            await save_data(pool, await queue.get())\r\n            queue.task_done()\r\n            await asyncio.sleep(1.0)\r\n\r\nasync def get_workers_its_magic(workers, func):\r\n    # just some black magic here\r\n    pass\r\n\r\nasync def run_client():\r\n    workers = await get_workers_its_magic(workers=2, func=func_in_worker):\r\n    workers.start()\r\n    await workers.join()\r\n\r\nif __name__ == \"__main__\":\r\n    asyncio.get_event_loop().run_until_complete(run_client())\r\n```\r\n\r\nObviously, my code is a bit different but you'll understand the gist of it. I'll make public the lib I developed for making async pools (not related to Edge pools) some time in the future (need to cleanup and add more pytest, only 4 for now) but for now, you'll just have to trust me that it works *\"roughly\"* like that (at least, should be an understandable equivalent).\r\n\r\nAccording to my code, I should have only 2 workers concurrently accessing the DB. And they only reuse the `tx` Retrying Transaction inside each working iteration. They don't create new connections. At the next batch, it's a new transaction they get from the pool. They only share the same pool and input queue. Nothing else. So there shouldn't be any long-lived Edge items, except for the `AsyncIOPool`.\r\n\r\nAm I reaching the limits of EdgeDB? Or is my machine not powerful enough to run EdgeDB? Or am I misusing EdgeDB? Or bad settings?\r\n\r\nThanks for your time and dedicated work, as always.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2428/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2428/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2415", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2415/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2415/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2415/events", "html_url": "https://github.com/edgedb/edgedb/issues/2415", "id": 845380341, "node_id": "MDU6SXNzdWU4NDUzODAzNDE=", "number": 2415, "title": "Enums aren't accepted as input variables in GraphQL", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1284200502, "node_id": "MDU6TGFiZWwxMjg0MjAwNTAy", "url": "https://api.github.com/repos/edgedb/edgedb/labels/graphql", "name": "graphql", "color": "c2b0f4", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-03-30T22:27:25Z", "updated_at": "2021-04-16T17:21:48Z", "closed_at": "2021-04-16T17:21:48Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This is in response to https://github.com/edgedb/edgedb/discussions/2413\r\n\r\nThe issue is that although enums should behave like scalars, they aren't accepted as inputs. So a query like:\r\n\r\n```graphql\r\nmutation updateItem($category: Category) {\r\n  update_Item(data: {category: {set: $category}}) {\r\n    category\r\n  }\r\n}\r\n```\r\nresults in an error like:\r\n`QueryError: Only scalar input variables are allowed. Variable 'category' has non-scalar value.`", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2415/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2415/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2411", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2411/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2411/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2411/events", "html_url": "https://github.com/edgedb/edgedb/issues/2411", "id": 844957104, "node_id": "MDU6SXNzdWU4NDQ5NTcxMDQ=", "number": 2411, "title": "Migrating from regular to computable property causes error", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-03-30T17:44:14Z", "updated_at": "2021-10-26T23:54:05Z", "closed_at": "2021-10-26T23:54:05Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: EdgeDB 1.0-beta.2+dev.5560.g9e95b0fa7\r\n- OS Version: Linux\r\n\r\nSteps to Reproduce:\r\n\r\n```\r\ndb> CREATE TYPE Foo { CREATE PROPERTY val -> str };\r\nOK: CREATE TYPE\r\ndb> INSERT Foo;\r\n{default::Foo {id: f77a5a0e-917e-11eb-9f06-cf7e35cf858e}}\r\ndb> ALTER TYPE Foo { ALTER PROPERTY val { USING ('qqq') } };\r\nError: ERROR: MissingRequiredError: missing value for required property 'val' of object type 'default::Foo'\r\n```\r\nThe error is translated from: `edb.server.pgcon.errors.BackendError: column \"f503b0bb-917e-11eb-9ead-8b9abd0d17fd\" contains null values`\r\n\r\nA different way of arriving at the same bug:\r\n```\r\ndb> CREATE TYPE Foo { CREATE PROPERTY val -> str };\r\nOK: CREATE TYPE\r\ndb> ALTER TYPE Foo { ALTER PROPERTY val { USING ('qqq') } };\r\nOK: ALTER TYPE\r\ndb> INSERT Foo;\r\nERROR: MissingRequiredError: missing value for required property 'val' of object type 'default::Foo'\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2411/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2411/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2399", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2399/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2399/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2399/events", "html_url": "https://github.com/edgedb/edgedb/issues/2399", "id": 839868537, "node_id": "MDU6SXNzdWU4Mzk4Njg1Mzc=", "number": 2399, "title": "Unable to 'create-migration',  edb.common.topological.CycleError", "user": {"login": "Maffels", "id": 12531389, "node_id": "MDQ6VXNlcjEyNTMxMzg5", "avatar_url": "https://avatars.githubusercontent.com/u/12531389?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Maffels", "html_url": "https://github.com/Maffels", "followers_url": "https://api.github.com/users/Maffels/followers", "following_url": "https://api.github.com/users/Maffels/following{/other_user}", "gists_url": "https://api.github.com/users/Maffels/gists{/gist_id}", "starred_url": "https://api.github.com/users/Maffels/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Maffels/subscriptions", "organizations_url": "https://api.github.com/users/Maffels/orgs", "repos_url": "https://api.github.com/users/Maffels/repos", "events_url": "https://api.github.com/users/Maffels/events{/privacy}", "received_events_url": "https://api.github.com/users/Maffels/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2021-03-24T15:50:58Z", "updated_at": "2021-11-02T20:43:28Z", "closed_at": "2021-11-02T20:43:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "- EdgeDB Version: 1.0-beta.1+g2eee1afe4.d2021030\r\n- OS Version: Windows 10, running EdgeDB in docker\r\n\r\nWhile working through the new EdgeDB asyncio tutorial; calling \"edgedb -Icommonplace create-migration\" returns an error. \r\nIt happens when I try to migrate from an earlier scheme to the final one as seen in the commonplace github repository.\r\nIt furthermore tells me this is probably a bug with EdgeDB and that I should report it. \r\n\r\n```\r\nServer traceback:\r\n      Traceback (most recent call last):\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler_pool/worker.py\", line 312, in worker\r\n          res = meth(*args)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler_pool/worker.py\", line 198, in compile_in_tx\r\n          units, cstate = COMPILER.compile_in_tx(cstate, *args, **kwargs)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 2004, in compile_in_tx\r\n          return self._compile(ctx=ctx, source=source), ctx.state\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1545, in _compile\r\n          return self._try_compile(ctx=ctx, source=original)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1602, in _try_compile\r\n          comp, capabilities = self._compile_dispatch_ql(ctx, stmt)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1484, in _compile_dispatch_ql\r\n          query = self._compile_ql_migration(ctx, ql)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1001, in _compile_ql_migration\r\n          guided_diff = s_ddl.delta_schemas(\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/schema/ddl.py\", line 331, in delta_schemas\r\n          objects = s_ordering.linearize_delta(\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/schema/ordering.py\", line 110, in linearize_delta\r\n          sortedlist = [i[1] for i in topological.sort_ex(depgraph)]\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/common/topological.py\", line 176, in sort_ex\r\n          visit(key)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/common/topological.py\", line 159, in visit\r\n          visit(n, weak_link=weak_link)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/common/topological.py\", line 159, in visit\r\n          visit(n, weak_link=weak_link)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/common/topological.py\", line 159, in visit\r\n          visit(n, weak_link=weak_link)\r\n        [Previous line repeated 1 more time]\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/common/topological.py\", line 139, in visit\r\n          raise CycleError(\r\n      edb.common.topological.CycleError: dependency cycle between ('rebase', 'commonplace::__|idx@commonplace|User@9d90cf377a2f853658647aee44bf0af75bcc1e3a@name') and ('rebase', 'commonplace::__|idx@commonplace|User@9d90cf377a2f853658647aee44bf0af75bcc1e3a@name')\r\n```\r\n\r\n\r\nKind regards and my apologies in advance if I missed something obvious.\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2399/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2399/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2387", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2387/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2387/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2387/events", "html_url": "https://github.com/edgedb/edgedb/issues/2387", "id": 836283816, "node_id": "MDU6SXNzdWU4MzYyODM4MTY=", "number": 2387, "title": "Using __typenames__ with a built-in type causes error", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2021-03-19T19:10:06Z", "updated_at": "2021-11-08T23:55:33Z", "closed_at": "2021-11-08T23:55:33Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0-beta.2+dev.5540.g4142fc6c9.d20210319\r\n- OS Version: Linux\r\n\r\nSteps to Reproduce:\r\n\r\n1. In REPL:\r\n    ```\r\n    edgedb> select [Object];\r\n    ERROR: SchemaDefinitionError: cannot alter object type 'std::Object': module std is read-only\r\n    ```\r\n\r\nSee `test_edgeql_select_array_common_type_02` in #2386 \r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2387/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2387/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2380", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2380/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2380/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2380/events", "html_url": "https://github.com/edgedb/edgedb/issues/2380", "id": 834890527, "node_id": "MDU6SXNzdWU4MzQ4OTA1Mjc=", "number": 2380, "title": "create-migration fails when a property was moved to an abstract base type", "user": {"login": "ambv", "id": 55281, "node_id": "MDQ6VXNlcjU1Mjgx", "avatar_url": "https://avatars.githubusercontent.com/u/55281?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ambv", "html_url": "https://github.com/ambv", "followers_url": "https://api.github.com/users/ambv/followers", "following_url": "https://api.github.com/users/ambv/following{/other_user}", "gists_url": "https://api.github.com/users/ambv/gists{/gist_id}", "starred_url": "https://api.github.com/users/ambv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ambv/subscriptions", "organizations_url": "https://api.github.com/users/ambv/orgs", "repos_url": "https://api.github.com/users/ambv/repos", "events_url": "https://api.github.com/users/ambv/events{/privacy}", "received_events_url": "https://api.github.com/users/ambv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2021-03-18T14:35:31Z", "updated_at": "2021-03-20T13:08:48Z", "closed_at": "2021-03-19T20:41:30Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "- EdgeDB Version: 1.0b1\r\n- OS Version: macOS 10.15.7\r\n\r\nSchema before:\r\n```esdl\r\nmodule commonplace {\r\n    type User {\r\n        required property name -> util::Slug {\r\n            constraint exclusive;\r\n        };\r\n        index on (__subject__.name);\r\n    };\r\n};\r\n```\r\n\r\nSchema after:\r\n```esdl\r\nmodule commonplace {\r\n    type User extending\r\n        Named;\r\n\r\n    type Content extending\r\n        Named;\r\n\r\n    abstract type Named {\r\n        required property name -> util::Slug {\r\n            constraint exclusive;\r\n        };\r\n        index on (__subject__.name);\r\n    };\r\n};\r\n```\r\n\r\ncreate-migration failing:\r\n![2021-03-18 15 29 59](https://user-images.githubusercontent.com/55281/111643823-8ef89c80-87ff-11eb-80ee-7987f7544ff6.gif)\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2380/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2380/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2360", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2360/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2360/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2360/events", "html_url": "https://github.com/edgedb/edgedb/issues/2360", "id": 830829589, "node_id": "MDU6SXNzdWU4MzA4Mjk1ODk=", "number": 2360, "title": "Backward-links fail when multiple types with the same link name exist", "user": {"login": "clmnin", "id": 17064666, "node_id": "MDQ6VXNlcjE3MDY0NjY2", "avatar_url": "https://avatars.githubusercontent.com/u/17064666?v=4", "gravatar_id": "", "url": "https://api.github.com/users/clmnin", "html_url": "https://github.com/clmnin", "followers_url": "https://api.github.com/users/clmnin/followers", "following_url": "https://api.github.com/users/clmnin/following{/other_user}", "gists_url": "https://api.github.com/users/clmnin/gists{/gist_id}", "starred_url": "https://api.github.com/users/clmnin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/clmnin/subscriptions", "organizations_url": "https://api.github.com/users/clmnin/orgs", "repos_url": "https://api.github.com/users/clmnin/repos", "events_url": "https://api.github.com/users/clmnin/events{/privacy}", "received_events_url": "https://api.github.com/users/clmnin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2021-03-13T07:06:32Z", "updated_at": "2021-03-19T18:34:59Z", "closed_at": "2021-03-19T18:34:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "- EdgeDB Version: 1.0-beta.1+g2eee1afe4.d20210301\r\n- OS Version: Ubuntu 20.04.2 LTS\r\n- CLI Version: repl 1.0.0-beta.1\r\n\r\nSteps to Reproduce:\r\n\r\n1. Create a new schema and populate the DB. I used the cli\r\n```sql\r\nSTART MIGRATION TO {\r\n    module default {\r\n        type Company {\r\n            required property name -> str {\r\n                constraint exclusive;\r\n            }\r\n        }\r\n        type Product {\r\n            required property name -> str;\r\n            multi link category -> Category;\r\n            link company -> Company;\r\n        }\r\n        type Category {\r\n            required property name -> str {\r\n                constraint exclusive;\r\n            }\r\n            link company -> Company;\r\n        }\r\n        type User {\r\n            required property name -> str;\r\n            required multi link company -> Company;\r\n        }\r\n    }\r\n};\r\nPOPULATE MIGRATION;\r\nCOMMIT MIGRATION;\r\n\r\nINSERT Company {name := \"ABC Company\"};\r\nINSERT User {name := \"Alice\", company := (SELECT Company FILTER .name = <str>\"ABC Company\")};\r\nINSERT Category {name := \"Category 1\", company := (SELECT Company FILTER .name = <str>\"ABC Company\")};\r\nINSERT Product {name := \"Product 1\", company := (SELECT Company FILTER .name = <str>\"ABC Company\"), category := (SELECT Category FILTER .name = <str>\"Category 1\")};\r\nINSERT Product {name := \"Product 2\", company := (SELECT Company FILTER .name = <str>\"ABC Company\"), category := (SELECT Category FILTER .name = <str>\"Category 1\")};\r\n```\r\n2. Execute a backward link query\r\n```sql\r\nSelect Company {id, name, users := Company.<company[IS User].name};\r\n```\r\n\r\n## Observation\r\n\r\n1. The query is looking for `company` in the type `User`. But there are other types with the same name linking to `Company`.\r\n2. The error says\r\n    ```\r\n    ERROR: InternalServerError: cannot determine backend storage parameters for the __derived__::__|company@__derived__|(opaque: default:Category || default:Product || default:User) pointer: unexpected characteristics\r\n    ```\r\n\r\n<details><summary>view error log</summary>\r\n<p>\r\n\r\n```\r\nERROR: InternalServerError: cannot determine backend storage parameters for the __derived__::__|company@__derived__|(opaque: default:Category || default:Product || default:User) pointer: unexpected characteristics\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/__init__.py\", line 93, in compile_ir_to_sql_tree\r\n          qtree = dispatch.compile(ir_expr, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 60, in compile_Set\r\n          _compile_set_impl(ir_set, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 118, in _compile_set_impl\r\n          _compile_set(ir_set, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 593, in _compile_set\r\n          relgen.get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 136, in get_set_rvar\r\n          return _process_toplevel_query(ir_set, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 236, in _process_toplevel_query\r\n          rvars = _get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 270, in _get_set_rvar\r\n          rvars = process_set_as_subquery(ir_set, stmt, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 1195, in process_set_as_subquery\r\n          dispatch.visit(ir_set.expr, ctx=newctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/dispatch.py\", line 44, in visit\r\n          compile(ir, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/stmt.py\", line 95, in compile_SelectStmt\r\n          outvar = clauses.compile_output(stmt.result, ctx=ictx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/clauses.py\", line 176, in compile_output\r\n          dispatch.visit(ir_set, ctx=newctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 85, in visit_Set\r\n          _compile_set_impl(ir_set, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 118, in _compile_set_impl\r\n          _compile_set(ir_set, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 597, in _compile_set\r\n          _compile_shape(\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 608, in _compile_shape\r\n          result = shapecomp.compile_shape(ir_set, shape, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/shapecomp.py\", line 76, in compile_shape\r\n          wrapper = relgen.set_as_subquery(\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 406, in set_as_subquery\r\n          dispatch.visit(ir_set, ctx=subctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 85, in visit_Set\r\n          _compile_set_impl(ir_set, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 114, in _compile_set_impl\r\n          _compile_set(ir_set, ctx=scopectx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 593, in _compile_set\r\n          relgen.get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 182, in get_set_rvar\r\n          rvars = _get_set_rvar(ir_set, ctx=subctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 270, in _get_set_rvar\r\n          rvars = process_set_as_subquery(ir_set, stmt, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 1195, in process_set_as_subquery\r\n          dispatch.visit(ir_set.expr, ctx=newctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/dispatch.py\", line 44, in visit\r\n          compile(ir, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/stmt.py\", line 95, in compile_SelectStmt\r\n          outvar = clauses.compile_output(stmt.result, ctx=ictx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/clauses.py\", line 176, in compile_output\r\n          dispatch.visit(ir_set, ctx=newctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/functools.py\", line 877, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 85, in visit_Set\r\n          _compile_set_impl(ir_set, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 118, in _compile_set_impl\r\n          _compile_set(ir_set, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/expr.py\", line 593, in _compile_set\r\n          relgen.get_set_rvar(ir_set, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 182, in get_set_rvar\r\n          rvars = _get_set_rvar(ir_set, ctx=subctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 355, in _get_set_rvar\r\n          rvars = process_set_as_path(ir_set, stmt, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 1008, in process_set_as_path\r\n          get_set_rvar(ir_source, ctx=srcctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 182, in get_set_rvar\r\n          rvars = _get_set_rvar(ir_set, ctx=subctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 355, in _get_set_rvar\r\n          rvars = process_set_as_path(ir_set, stmt, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 929, in process_set_as_path\r\n          return process_set_as_path_type_intersection(\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 838, in process_set_as_path_type_intersection\r\n          source_rvar = get_set_rvar(ir_source, ctx=subctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 182, in get_set_rvar\r\n          rvars = _get_set_rvar(ir_set, ctx=subctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 355, in _get_set_rvar\r\n          rvars = process_set_as_path(ir_set, stmt, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/relgen.py\", line 933, in process_set_as_path\r\n          ptr_info = pg_types.get_ptrref_storage_info(\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/types.py\", line 459, in get_ptrref_storage_info\r\n          raise RuntimeError(\r\n      RuntimeError: cannot determine backend storage parameters for the __derived__::__|company@__derived__|(opaque: default:Category || default:Product || default:User) pointer: unexpected characteristics\r\n      \r\n      The above exception was the direct cause of the following exception:\r\n      \r\n      Traceback (most recent call last):\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler_pool/worker.py\", line 312, in worker\r\n          res = meth(*args)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler_pool/worker.py\", line 173, in compile\r\n          units, cstate = COMPILER.compile(\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1967, in compile\r\n          units = self._compile(ctx=ctx, source=source)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1548, in _compile\r\n          return self._try_compile(ctx=ctx, source=source)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1602, in _try_compile\r\n          comp, capabilities = self._compile_dispatch_ql(ctx, stmt)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1522, in _compile_dispatch_ql\r\n          query = self._compile_ql_query(ctx, ql)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 593, in _compile_ql_query\r\n          sql_text, argmap = pg_compiler.compile_ir_to_sql(\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/__init__.py\", line 115, in compile_ir_to_sql\r\n          qtree = compile_ir_to_sql_tree(\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/pgsql/compiler/__init__.py\", line 100, in compile_ir_to_sql_tree\r\n          raise errors.InternalServerError(*args) from e\r\n      edb.errors.InternalServerError: cannot determine backend storage parameters for the __derived__::__|company@__derived__|(opaque: default:Category || default:Product || default:User) pointer: unexpected characteristics\r\n```\r\n</p>\r\n</details>\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2360/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2360/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2343", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2343/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2343/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2343/events", "html_url": "https://github.com/edgedb/edgedb/issues/2343", "id": 826363448, "node_id": "MDU6SXNzdWU4MjYzNjM0NDg=", "number": 2343, "title": "AssertionError: Normalized and non-normalized query errors differ", "user": {"login": "Fogapod", "id": 22667809, "node_id": "MDQ6VXNlcjIyNjY3ODA5", "avatar_url": "https://avatars.githubusercontent.com/u/22667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Fogapod", "html_url": "https://github.com/Fogapod", "followers_url": "https://api.github.com/users/Fogapod/followers", "following_url": "https://api.github.com/users/Fogapod/following{/other_user}", "gists_url": "https://api.github.com/users/Fogapod/gists{/gist_id}", "starred_url": "https://api.github.com/users/Fogapod/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Fogapod/subscriptions", "organizations_url": "https://api.github.com/users/Fogapod/orgs", "repos_url": "https://api.github.com/users/Fogapod/repos", "events_url": "https://api.github.com/users/Fogapod/events{/privacy}", "received_events_url": "https://api.github.com/users/Fogapod/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2021-03-09T17:49:01Z", "updated_at": "2021-04-20T23:16:13Z", "closed_at": "2021-04-20T23:16:13Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: `1-beta1`\r\n\r\nSteps to Reproduce:\r\n\r\n1. `select <tuple<\"\">>1;`\r\n<details>\r\n  <summary>Traceback</summary>\r\n\r\n  ```python\r\n  ERROR: InternalServerError: Normalized and non-normalized query errors differ\r\n    Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n    Server traceback:\r\n        Traceback (most recent call last):\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/common/parsing.py\", line 403, in parse\r\n            self.parser.token(token)\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/parsing/__init__.py\", line 209, in token\r\n            self._act(token, tokenSpec)\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/parsing/__init__.py\", line 233, in _act\r\n            raise UnexpectedToken(\"Unexpected token: %r\" % sym)\r\n        parsing.errors.UnexpectedToken: Unexpected token: <Token LANGBRACKET \"<\">\r\n  \r\n        The above exception was the direct cause of the following exception:\r\n  \r\n        Traceback (most recent call last):\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1548, in _compile\r\n            return self._try_compile(ctx=ctx, source=source)\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1580, in _try_compile\r\n            statements = edgeql.parse_block(source)\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/edgeql/parser/__init__.py\", line 69, in parse_block\r\n            return parser.parse(source)\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/common/parsing.py\", line 416, in parse\r\n            raise self.get_exception(\r\n        edb.errors.EdgeQLSyntaxError: Unexpected '<'\r\n  \r\n        During handling of the above exception, another exception occurred:\r\n  \r\n        Traceback (most recent call last):\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1555, in _compile\r\n            self._try_compile(ctx=ctx, source=original)\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1602, in _try_compile\r\n            comp, capabilities = self._compile_dispatch_ql(ctx, stmt)\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1522, in _compile_dispatch_ql\r\n            query = self._compile_ql_query(ctx, ql)\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 561, in _compile_ql_query\r\n            ir = qlcompiler.compile_ast_to_ir(\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/edgeql/compiler/__init__.py\", line 177, in wrapper\r\n            return func(*args, **kwargs)\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/edgeql/compiler/__init__.py\", line 225, in compile_ast_to_ir\r\n            ir_set = dispatch_mod.compile(tree, ctx=ctx)\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/functools.py\", line 877, in wrapper\r\n            return dispatch(args[0].__class__)(*args, **kw)\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/edgeql/compiler/stmt.py\", line 85, in compile_SelectQuery\r\n            stmt.result = compile_result_clause(\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/edgeql/compiler/stmt.py\", line 1231, in compile_result_clause\r\n            dispatch.compile(result_expr, ctx=sctx), ctx=sctx)\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/functools.py\", line 877, in wrapper\r\n            return dispatch(args[0].__class__)(*args, **kw)\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/edgeql/compiler/expr.py\", line 408, in compile_TypeCast\r\n            target_stype = typegen.ql_typeexpr_to_type(expr.type, ctx=ctx)\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/edgeql/compiler/typegen.py\", line 73, in ql_typeexpr_to_type\r\n            types = _ql_typeexpr_to_type(ql_t, ctx=ctx)\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/edgeql/compiler/typegen.py\", line 102, in _ql_typeexpr_to_type\r\n            return [_ql_typename_to_type(ql_t, ctx=ctx)]\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/edgeql/compiler/typegen.py\", line 126, in _ql_typename_to_type\r\n            t_subtypes[type_name] = ql_typeexpr_to_type(st, ctx=ctx)\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/edgeql/compiler/typegen.py\", line 73, in ql_typeexpr_to_type\r\n            types = _ql_typeexpr_to_type(ql_t, ctx=ctx)\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/edgeql/compiler/typegen.py\", line 105, in _ql_typeexpr_to_type\r\n            raise errors.InternalServerError(f'unexpected TypeExpr: {ql_t!r}')\r\n        edb.errors.InternalServerError: unexpected TypeExpr: <edb.edgeql.ast.TypeExprLiteral object at 0x7f47f5a39310>\r\n  \r\n        During handling of the above exception, another exception occurred:\r\n  \r\n        Traceback (most recent call last):\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler_pool/worker.py\", line 312, in worker\r\n            res = meth(*args)\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler_pool/worker.py\", line 173, in compile\r\n            units, cstate = COMPILER.compile(\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1967, in compile\r\n            units = self._compile(ctx=ctx, source=source)\r\n          File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-beta1/lib/python3.9/site-packages/edb/server/compiler/compiler.py\", line 1559, in _compile\r\n            raise AssertionError(\r\n        AssertionError: Normalized and non-normalized query errors differ\r\n  ```\r\n\r\n</details>\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2343/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2343/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2328", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2328/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2328/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2328/events", "html_url": "https://github.com/edgedb/edgedb/issues/2328", "id": 823504959, "node_id": "MDU6SXNzdWU4MjM1MDQ5NTk=", "number": 2328, "title": "Alteration of enums doesn't work at all in migraitons", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-03-06T00:11:01Z", "updated_at": "2021-03-06T02:43:02Z", "closed_at": "2021-03-06T02:43:02Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\ncreate scalar type MyEnum extending enum<Foo, Bar>;\r\n```\r\n\r\nAnd then\r\n\r\n```\r\nstart migration to { module default {\r\n  scalar type MyEnum extending enum<Foo, Bar, Baz>;\r\n}; }; populate migration; commit migration;\r\n```\r\n\r\ndoesn't crash but doesn't actually modify the enum either.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2328/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2328/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2324", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2324/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2324/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2324/events", "html_url": "https://github.com/edgedb/edgedb/issues/2324", "id": 823435805, "node_id": "MDU6SXNzdWU4MjM0MzU4MDU=", "number": 2324, "title": "Prevent illegal UPDATEs to covariantly overloaded link types", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-03-05T21:31:25Z", "updated_at": "2021-05-05T20:38:13Z", "closed_at": "2021-05-05T20:38:13Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "If we have a schema like\r\n```\r\ntype Tgt;\r\ntype SubTgt extending Tgt {\r\n    required property foo -> str;\r\n};\r\n\r\ntype Foo {\r\n    property name -> str;\r\n    required link x -> Tgt;\r\n};\r\ntype Bar extending Foo {\r\n    overloaded required link x -> SubTgt;\r\n};\r\n```\r\n\r\nwe can do `UPDATE Foo FILTER .name = \"whatever\" SET { x := (INSERT Tgt) }`\r\nand we will wind up in an illegal state.\r\n\r\nThis is because we allow covariant overloading of pointer types but that is unsound since they are mutable.\r\n\r\nOptions:\r\n1. Statically disallow UPDATEs that SET pointers that have their types overridden in subclasses.\r\n2. Disallow these illegal UPDATEs with run-time checks.\r\n\r\nMy gut reaction is prefer static checks, and I think most cases wouldn't be inconvenienced. But @elprans argued for dynamic checks, suggesting the case of an API endpoint where \"you only get an id of an object to update and an id of a new link target\", and I find this reasonably compelling.\r\n\r\nThere will be a runtime cost, but it shouldn't be that bad, and we only need to pay the cost in situations that would be prohibited if we went the static route.\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2324/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2324/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2323", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2323/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2323/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2323/events", "html_url": "https://github.com/edgedb/edgedb/issues/2323", "id": 823367743, "node_id": "MDU6SXNzdWU4MjMzNjc3NDM=", "number": 2323, "title": "Using [IS Type] in a shape on a computable link fails.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-03-05T19:49:59Z", "updated_at": "2021-11-10T22:28:04Z", "closed_at": "2021-11-10T22:28:04Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0.0-beta.1\r\n- OS Version: Linux\r\n\r\nSteps to Reproduce:\r\n\r\nSchema:\r\n```\r\nmodule default {\r\n    abstract type Exercise {\r\n        property description -> str;\r\n        property num -> int64;\r\n        link sheet -> MathSheet;\r\n    }\r\n\r\n    type MathEx extending Exercise {\r\n        property answer -> int64;\r\n    }\r\n\r\n    type MathSheet {\r\n        required property serial -> int64;\r\n        link exercises := .<sheet[IS Exercise];\r\n    }\r\n};\r\n```\r\n\r\nThis query causes an error:\r\n```\r\nedgedb> SELECT MathSheet{exercises[IS MathEx]: {num, answer}};\r\nERROR: InternalServerError: column Exercise~1.477e284c-7deb-11eb-a3cc-0b4fca5304c1 does not exist\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: column Exercise~1.477e284c-7deb-11eb-a3cc-0b4fca5304c1 does not exist\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2323/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2323/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2322", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2322/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2322/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2322/events", "html_url": "https://github.com/edgedb/edgedb/issues/2322", "id": 823303875, "node_id": "MDU6SXNzdWU4MjMzMDM4NzU=", "number": 2322, "title": "Problem with generating migration", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-03-05T18:02:45Z", "updated_at": "2021-10-23T01:32:18Z", "closed_at": "2021-10-23T01:32:18Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0.0-beta.1\r\n- OS Version: Linux\r\n\r\nSteps to Reproduce:\r\n\r\n1. Use the following schema:\r\n```\r\nmodule default {\r\n    # Base types, exercises are organized into sheets\r\n    abstract type Exercise {\r\n        property description -> str;\r\n    }\r\n\r\n    abstract type Sheet {\r\n        multi link exercises -> Exercise {\r\n            constraint exclusive;\r\n        }\r\n        property description -> str;\r\n        property completed_on -> cal::local_date;\r\n    }\r\n\r\n    type MathEx extending Exercise {\r\n        link sheet := .<exercises[IS MathSheet];\r\n\r\n        required property num0 -> int64;\r\n        required property num1 -> int64;\r\n        required property op -> str;\r\n\r\n        property answer -> int64;\r\n        property correct_answer :=\r\n            (.num0 + .num1) IF .op = '+' ELSE (.num0 - .num1);\r\n\r\n        property is_completed := EXISTS .answer;\r\n        property is_correct := .answer ?= .correct_answer;\r\n    }\r\n\r\n    type MathSheet extending Sheet {\r\n        overloaded multi link exercises -> MathEx;\r\n\r\n        property is_completed :=\r\n            EXISTS .completed_on AND all(.exercises.is_completed);\r\n        property num_correct := count((\r\n            SELECT .exercises FILTER .is_correct));\r\n    }\r\n};\r\n```\r\n2. run `create-migration` (which should be OK)\r\n3. run `migrate`, which causes the following error:\r\n\r\n```\r\nedgedb error: ERROR: InternalServerError: 'NoneType' object has no attribute 'irast'\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler_pool/worker.py\", line 312, in worker\r\n          res = meth(*args)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler_pool/worker.py\", line 198, in compile_in_tx\r\n          units, cstate = COMPILER.compile_in_tx(cstate, *args, **kwargs)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 2004, in compile_in_tx\r\n          return self._compile(ctx=ctx, source=source), ctx.state\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 1548, in _compile\r\n          return self._try_compile(ctx=ctx, source=source)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 1602, in _try_compile\r\n          comp, capabilities = self._compile_dispatch_ql(ctx, stmt)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 1484, in _compile_dispatch_ql\r\n          query = self._compile_ql_migration(ctx, ql)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 880, in _compile_ql_migration\r\n          query = self._compile_and_apply_ddl_stmt(ctx, ql)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 800, in _compile_and_apply_ddl_stmt\r\n          block, new_types = self._process_delta(ctx, delta)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 336, in _process_delta\r\n          schema = pgdelta.apply(schema, context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/delta.py\", line 5129, in apply\r\n          schema = sd.DeltaRoot.apply(self, schema, context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/schema/delta.py\", line 1372, in apply\r\n          schema = objop.apply(schema, context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/delta.py\", line 205, in apply\r\n          schema = self.__class__.get_adaptee().apply(self, schema, context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/schema/delta.py\", line 2872, in apply\r\n          schema = self._create_innards(schema, context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/schema/delta.py\", line 2841, in _create_innards\r\n          schema = op.apply(schema, context=context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/delta.py\", line 2131, in apply\r\n          schema = s_objtypes.CreateObjectType.apply(self, schema, context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/schema/delta.py\", line 2872, in apply\r\n          schema = self._create_innards(schema, context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/schema/inheriting.py\", line 735, in _create_innards\r\n          return super()._create_innards(schema, context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/schema/delta.py\", line 2841, in _create_innards\r\n          schema = op.apply(schema, context=context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/delta.py\", line 3552, in apply\r\n          schema = s_links.AlterLink.apply(self, schema, context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/schema/delta.py\", line 3321, in apply\r\n          schema = self._alter_innards(schema, context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/schema/delta.py\", line 2978, in _alter_innards\r\n          schema = op.apply(schema, context=context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/delta.py\", line 3478, in apply\r\n          self._alter_pointer_type(self.scls, schema, orig_schema, context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/delta.py\", line 2872, in _alter_pointer_type\r\n          self._compile_conversion_expr(\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/pgsql/delta.py\", line 3078, in _compile_conversion_expr\r\n          if conv_expr.irast is not None:\r\n      AttributeError: 'NoneType' object has no attribute 'irast'\r\n```\r\n\r\nHere's the generated DDL:\r\n```\r\nCREATE MIGRATION m1i6vw5no7747rw642ju5zjxkwklseny6k6wfbenvlfghkjnuvccoa\r\n    ONTO initial\r\n{\r\n  CREATE ABSTRACT TYPE default::Exercise {\r\n      CREATE PROPERTY description -> std::str;\r\n  };\r\n  CREATE ABSTRACT TYPE default::Sheet {\r\n      CREATE MULTI LINK exercises -> default::Exercise {\r\n          CREATE CONSTRAINT std::exclusive;\r\n      };\r\n      CREATE PROPERTY completed_on -> cal::local_date;\r\n      CREATE PROPERTY description -> std::str;\r\n  };\r\n  CREATE TYPE default::MathEx EXTENDING default::Exercise {\r\n      CREATE PROPERTY answer -> std::int64;\r\n      CREATE REQUIRED PROPERTY num0 -> std::int64;\r\n      CREATE REQUIRED PROPERTY num1 -> std::int64;\r\n      CREATE REQUIRED PROPERTY op -> std::str;\r\n      CREATE PROPERTY correct_answer := (((.num0 + .num1) IF (.op = '+') ELSE (.num0 - .num1)));\r\n      CREATE PROPERTY is_completed := (EXISTS (.answer));\r\n      CREATE PROPERTY is_correct := ((.answer ?= .correct_answer));\r\n  };\r\n  CREATE TYPE default::MathSheet EXTENDING default::Sheet {\r\n      ALTER LINK exercises {\r\n          SET MULTI;\r\n          SET OWNED;\r\n          SET TYPE default::MathEx;\r\n      };\r\n      CREATE PROPERTY is_completed := ((EXISTS (.completed_on) AND std::all(.exercises.is_completed)));\r\n      CREATE PROPERTY num_correct := (std::count((SELECT\r\n          .exercises\r\n      FILTER\r\n          .is_correct\r\n      )));\r\n  };\r\n  ALTER TYPE default::MathEx {\r\n      CREATE LINK sheet := (.<exercises[IS default::MathSheet]);\r\n  };\r\n};\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2322/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2322/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2321", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2321/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2321/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2321/events", "html_url": "https://github.com/edgedb/edgedb/issues/2321", "id": 823303811, "node_id": "MDU6SXNzdWU4MjMzMDM4MTE=", "number": 2321, "title": "Backward link expressions in computables result in overly broad cross-reference record, blocking deletions", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-03-05T18:02:39Z", "updated_at": "2021-03-16T00:51:34Z", "closed_at": "2021-03-16T00:51:34Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Here's a test:\r\n\r\n```\r\n    def test_schema_migrations_equivalence_49(self):\r\n        self._assert_migration_equivalence([r\"\"\"\r\n            type Foo {\r\n                link bars := .<foo[IS Bar];\r\n                link spam := .<foo[IS Spam];\r\n            };\r\n\r\n            type Bar {\r\n                link foo -> Foo;\r\n            };\r\n\r\n            type Spam {\r\n                link foo -> Foo;\r\n            };\r\n        \"\"\", r\"\"\"\r\n            type Foo {\r\n                link spam := .<foo[IS Spam];\r\n            };\r\n\r\n            type Spam {\r\n                link foo -> Foo;\r\n            };\r\n        \"\"\"])\r\n\r\n```\r\n\r\nIt crashes with:\r\n\r\n```\r\nedb.errors.SchemaError: cannot drop link 'foo' of object type 'default::Bar' because other objects in the schema depend on it\r\nDetail: link 'spam' of object type 'default::Foo' depends on foo\r\n```\r\n\r\nAnd this happens because the schema reference tracking code, upon seeing `.<foo` in the definition of the `Foo.spam` computable, records **all** `foo` links pointing to `Foo` in the schema, despite an explicit type intersection narrowing that follows.  The offending bits are in `setgen.resolve_ptr()`.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2321/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2321/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2320", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2320/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2320/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2320/events", "html_url": "https://github.com/edgedb/edgedb/issues/2320", "id": 823297704, "node_id": "MDU6SXNzdWU4MjMyOTc3MDQ=", "number": 2320, "title": "Problems using a symbol defined in a WITH block in SDL.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-03-05T17:53:02Z", "updated_at": "2021-03-12T19:27:30Z", "closed_at": "2021-03-12T19:27:30Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0.0-beta.1\r\n- OS Version: Linux\r\n\r\nSteps to Reproduce:\r\n\r\nThe following schema fails to create a migration:\r\n```\r\nmodule default {\r\n    type Foo {\r\n        property val -> str;\r\n        property comp := count((\r\n            WITH x := .val\r\n            SELECT y := Bar FILTER x = y.val\r\n        ))\r\n    }\r\n\r\n    type Bar {\r\n        property val -> str;\r\n    }\r\n};\r\n```\r\nThe error message is:\r\n```\r\nERROR: InvalidReferenceError: schema item 'std::x' does not exist\r\nedgedb error: cannot proceed until .esdl files are fixed\r\n```\r\n\r\nIt appears that validation during tracing is at fault.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2320/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2320/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2300", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2300/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2300/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2300/events", "html_url": "https://github.com/edgedb/edgedb/issues/2300", "id": 820457112, "node_id": "MDU6SXNzdWU4MjA0NTcxMTI=", "number": 2300, "title": "Migrations don't work with multiple indexes", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-03-02T22:52:38Z", "updated_at": "2021-03-03T00:03:39Z", "closed_at": "2021-03-03T00:03:39Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "When running this:\r\n```\r\nstart migration to {                                                      \r\nmodule default {                                                          \r\ntype Message {                                                            \r\n    required property text -> str;                                        \r\n    required property ts -> datetime;                                     \r\n    index on (.ts);                                                       \r\n    index on (.text);                                                     \r\n};                                                                        \r\n                                                                          \r\n}                                                                         \r\n};                                                                        \r\nPOPULATE MIGRATION; DESCRIBE CURRENT MIGRATION; COMMIT MIGRATION;\r\n```\r\n\r\nWe get back:\r\n```\r\nCREATE TYPE default::Message {\r\n    CREATE REQUIRED PROPERTY text -> std::str;\r\n    CREATE INDEX ON (.text);\r\n    CREATE REQUIRED PROPERTY ts -> std::datetime;\r\n};\r\n```\r\nwhich is missing one of the indexes!", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2300/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2300/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2299", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2299/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2299/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2299/events", "html_url": "https://github.com/edgedb/edgedb/issues/2299", "id": 820317218, "node_id": "MDU6SXNzdWU4MjAzMTcyMTg=", "number": 2299, "title": "cannot alter type of a column used in a trigger definition", "user": {"login": "fmoor", "id": 8278635, "node_id": "MDQ6VXNlcjgyNzg2MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/8278635?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmoor", "html_url": "https://github.com/fmoor", "followers_url": "https://api.github.com/users/fmoor/followers", "following_url": "https://api.github.com/users/fmoor/following{/other_user}", "gists_url": "https://api.github.com/users/fmoor/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmoor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmoor/subscriptions", "organizations_url": "https://api.github.com/users/fmoor/orgs", "repos_url": "https://api.github.com/users/fmoor/repos", "events_url": "https://api.github.com/users/fmoor/events{/privacy}", "received_events_url": "https://api.github.com/users/fmoor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-03-02T19:28:20Z", "updated_at": "2021-03-03T20:39:36Z", "closed_at": "2021-03-03T20:39:36Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nedgedb error: ERROR: InternalServerError: cannot alter type of a column used in a trigger definition\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: cannot alter type of a column used in a trigger definition\r\n```\r\nI discovered this while trying to reproduce https://github.com/edgedb/edgedb/issues/2298 not sure if they are related.\r\n\r\n<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0b2.dev5500+g2f67186c8-2021030200~focal.nightly\r\n- OS Version: Linux 5.8.0-44-generic #50~20.04.1-Ubuntu SMP Wed Feb 10 21:07:30 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\nSteps to Reproduce:\r\n```bash\r\n#!/usr/bin/env bash\r\n\r\nset -ex\r\n\r\ncd `mktemp --directory`\r\nmkdir -p dbschema/migrations\r\n\r\nedgedb server init --nightly bug\r\necho 'module default {\r\n\ttype MyObject {\r\n\t\trequired property number -> int16 {\r\n\t\t\tconstraint exclusive;\r\n\t\t}\r\n\t}\r\n};' > dbschema/schema.esdl\r\nyes | edgedb -I bug create-migration\r\nedgedb -I bug migrate\r\necho 'module default {\r\n\tscalar type MySequence extending sequence;\r\n\r\n\ttype MyObject {\r\n\t\trequired property number -> MySequence {\r\n\t\t\tconstraint exclusive;\r\n\t\t}\r\n\t}\r\n};' > dbschema/schema.esdl\r\nyes | edgedb -I bug create-migration\r\nedgedb -I bug migrate\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2299/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2299/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2287", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2287/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2287/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2287/events", "html_url": "https://github.com/edgedb/edgedb/issues/2287", "id": 818319719, "node_id": "MDU6SXNzdWU4MTgzMTk3MTk=", "number": 2287, "title": "What changed between alpha-8-5340 and beta-1 regarding arrays", "user": {"login": "isidentical", "id": 47358913, "node_id": "MDQ6VXNlcjQ3MzU4OTEz", "avatar_url": "https://avatars.githubusercontent.com/u/47358913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/isidentical", "html_url": "https://github.com/isidentical", "followers_url": "https://api.github.com/users/isidentical/followers", "following_url": "https://api.github.com/users/isidentical/following{/other_user}", "gists_url": "https://api.github.com/users/isidentical/gists{/gist_id}", "starred_url": "https://api.github.com/users/isidentical/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/isidentical/subscriptions", "organizations_url": "https://api.github.com/users/isidentical/orgs", "repos_url": "https://api.github.com/users/isidentical/repos", "events_url": "https://api.github.com/users/isidentical/events{/privacy}", "received_events_url": "https://api.github.com/users/isidentical/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-02-28T21:45:51Z", "updated_at": "2021-03-01T02:40:05Z", "closed_at": "2021-03-01T02:40:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "I was trying to upgrade [reiz](https://github.com/reizio/reiz.io/) to use edgedb beta-1/2 in the weekend though I guess I burnt a lot of time while investigating some queries resulting in an empty set instead of what is expected from them. This only happened when running under the `1.0-beta.1+gc654bc4cd.d20210222` but not `1.0-alpha.8+dev.5340.g76e0688b`. Here is a reproducer;\r\n```\r\nCREATE DATABASE test_reiz;\r\n\\c test_reiz;\r\n\r\nSTART MIGRATION TO {\r\n    module ast {\r\n        type arguments {\r\n            multi link posonlyargs -> arg;\r\n            multi link args -> arg;\r\n        }\r\n        type arg {\r\n            required property arg -> str;\r\n        }\r\n    }\r\n};\r\n\r\nPOPULATE MIGRATION;\r\nCOMMIT MIGRATION;\r\n\r\nINSERT ast::arguments {\r\n    posonlyargs := {\r\n        (INSERT ast::arg { arg := 'bar' })\r\n    },\r\n    args := {\r\n        (INSERT ast::arg { arg := 'baz' })\r\n    }\r\n};\r\n\r\n\r\nSELECT ast::arguments\r\nFILTER (\r\n    WITH\r\n        sequence_50150f83 := array_agg(.posonlyargs),\r\n        sequence_12faedad := array_agg(.args)\r\n    SELECT (\r\n        len(sequence_50150f83) = 1\r\n        AND len(sequence_12faedad) = 1\r\n        AND sequence_50150f83[0].arg = 'bar'\r\n        AND sequence_12faedad[0].arg = 'baz'\r\n    )\r\n);\r\n```\r\n\r\nExpected screenshot;\r\n![image](https://user-images.githubusercontent.com/47358913/109434635-4aab8500-7a27-11eb-8859-17a6d0de69d5.png)\r\n\r\nCurrent result;\r\n![image](https://user-images.githubusercontent.com/47358913/109434625-3ebfc300-7a27-11eb-942e-55f517d198d4.png)\r\n\r\n\r\nAs it can be seen, the select returns the proper value under alpha-8 but returns an empty under beta-1. This seems like a really weird behavior, but I don't know when exactly it got broken. (OS: ubuntu 20)", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2287/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2287/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2285", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2285/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2285/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2285/events", "html_url": "https://github.com/edgedb/edgedb/issues/2285", "id": 818284189, "node_id": "MDU6SXNzdWU4MTgyODQxODk=", "number": 2285, "title": "1-beta1 is slow compared to 1-alpha7", "user": {"login": "unmade", "id": 9870176, "node_id": "MDQ6VXNlcjk4NzAxNzY=", "avatar_url": "https://avatars.githubusercontent.com/u/9870176?v=4", "gravatar_id": "", "url": "https://api.github.com/users/unmade", "html_url": "https://github.com/unmade", "followers_url": "https://api.github.com/users/unmade/followers", "following_url": "https://api.github.com/users/unmade/following{/other_user}", "gists_url": "https://api.github.com/users/unmade/gists{/gist_id}", "starred_url": "https://api.github.com/users/unmade/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/unmade/subscriptions", "organizations_url": "https://api.github.com/users/unmade/orgs", "repos_url": "https://api.github.com/users/unmade/repos", "events_url": "https://api.github.com/users/unmade/events{/privacy}", "received_events_url": "https://api.github.com/users/unmade/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}, {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2021-02-28T13:04:22Z", "updated_at": "2021-03-01T00:04:57Z", "closed_at": "2021-03-01T00:04:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "### The Problem\r\n\r\nAfter upgrading to `1-beta1` my tests run very slow - almost 3 minutes. With `1-alpha7` test suit runs in 30 seconds.\r\n\r\nDo you know what could be the problem or how can I trace what causes this slowdown?\r\n\r\n### My Setup:\r\n\r\n- Test suit is running on macOS BigSur (rMBP 15 early 2013) and also in GitHub Actions\r\n- The [project](https://github.com/unmade/shelf-back) is in Python with latest at the moment (0.13.0) `edgedb-python`\r\n- EdgeDB run with [docker-compose](https://github.com/unmade/shelf-back/blob/master/docker-compose.yml) and with [services in GitHub Actions](https://github.com/unmade/shelf-back/blob/master/.github/workflows/test.yml#L18)\r\n- Test suit includes:\r\n    - [creating test database](https://github.com/unmade/shelf-back/blob/master/tests/conftest.py#L75-L90) - (runs once)\r\n    - [creating connection pool](https://github.com/unmade/shelf-back/blob/master/tests/conftest.py#L93-L101) (runs once)\r\n    - [migration](https://github.com/unmade/shelf-back/blob/master/tests/conftest.py#L104-L110) (runs once)\r\n    - [tables clean up](https://github.com/unmade/shelf-back/blob/master/tests/conftest.py#L119-L123) (runs after each test)\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2285/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2285/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2256", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2256/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2256/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2256/events", "html_url": "https://github.com/edgedb/edgedb/issues/2256", "id": 812684322, "node_id": "MDU6SXNzdWU4MTI2ODQzMjI=", "number": 2256, "title": "Array of common type objects", "user": {"login": "isidentical", "id": 47358913, "node_id": "MDQ6VXNlcjQ3MzU4OTEz", "avatar_url": "https://avatars.githubusercontent.com/u/47358913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/isidentical", "html_url": "https://github.com/isidentical", "followers_url": "https://api.github.com/users/isidentical/followers", "following_url": "https://api.github.com/users/isidentical/following{/other_user}", "gists_url": "https://api.github.com/users/isidentical/gists{/gist_id}", "starred_url": "https://api.github.com/users/isidentical/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/isidentical/subscriptions", "organizations_url": "https://api.github.com/users/isidentical/orgs", "repos_url": "https://api.github.com/users/isidentical/repos", "events_url": "https://api.github.com/users/isidentical/events{/privacy}", "received_events_url": "https://api.github.com/users/isidentical/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 932934397, "node_id": "MDU6TGFiZWw5MzI5MzQzOTc=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/edgeql", "name": "edgeql", "color": "0052cc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2021-02-20T18:56:49Z", "updated_at": "2021-10-14T18:19:07Z", "closed_at": "2021-10-14T18:19:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "I don't know whether this is a bug or a featuree, though following the suggestion @elprans (originates from this issue https://github.com/edgedb/edgedb/discussions/2144#discussioncomment-306759) here is the little reproducer;\r\n\r\n> I also stumbled (I think) something relevant with this during my experiments while trying to create an array with array constructor (like if I do [(SELECT type1 LIMIT 1), (SELECT type2 LIMIT 1)] it doesn't allow me, throws an error regarding their size differ. But if they all extend from a common base, like basetype, then I can do this [(SELECT basetype FILTER .id = <uuid>\"test\"), SELECT basetype FILTER .id = <uuid>\"test2\")], just a [possibly] irrelevant finding)\r\n\r\nReproducer;\r\n```\r\nSTART MIGRATION TO {\r\n    module default {\r\n        abstract type Person {}\r\n        type Person1 extending Person {\r\n            required property name -> str;\r\n        }\r\n        type Person2 extending Person {\r\n            required property name2 -> str;\r\n            required property age -> int64;\r\n        }\r\n    }\r\n};\r\n\r\nPOPULATE MIGRATION;\r\nCOMMIT MIGRATION;\r\n\r\nINSERT Person1 {\r\n    name := 'Foo'\r\n};\r\n\r\n\r\nINSERT Person2 {\r\n    name2 := 'Spam',\r\n    age := 17\r\n};\r\n\r\n\r\nINSERT Person2 {\r\n    name2 := 'Egg',\r\n    age := 34\r\n};\r\n```\r\n\r\nThis is how it reacts when testing it under the `Person` type (base class)\r\n```\r\ntest> SELECT [(SELECT Person FILTER .id = (SELECT Person1 LIMIT 1).id), (SELECT Person FILTER .id = (SELECT Person2 LIMIT 1).id)];\r\n{[default::Person1 {id: 750b31fa-73ac-11eb-9a16-d30525e2b895}, default::Person2 {id: 83f41b6e-73ac-11eb-9a16-331b7ec13b11}]}\r\n```\r\n\r\nand this is how it reacts when trying to select them individually\r\n```\r\ntest> SELECT [(SELECT Person1 LIMIT 1), (SELECT Person2 LIMIT 2)];\r\nStreamErr {\r\n    source: DecodeErr {\r\n        source: ObjectSizeMismatch {\r\n            backtrace: Backtrace(\r\n                   0:           0x49ae95 - backtrace::backtrace::libunwind::trace::hf32c45174b1b466a\r\n                                               at /usr/local/cargo/registry/src/github.com-1ecc6299db9ec823/backtrace-0.3.50/src/backtrace/libunwind.rs:95\r\n                                           backtrace::backtrace::trace_unsynchronized::he5ebd2bc3457bd3d\r\n                                               at /usr/local/cargo/registry/src/github.com-1ecc6299db9ec823/backtrace-0.3.50/src/backtrace/mod.rs:66\r\n                                           backtrace::backtrace::trace::h2e14159a955434fb\r\n                                               at /usr/local/cargo/registry/src/github.com-1ecc6299db9ec823/backtrace-0.3.50/src/backtrace/mod.rs:53\r\n                                           backtrace::capture::Backtrace::create::h4f40144c497eab8d\r\n                                               at /usr/local/cargo/registry/src/github.com-1ecc6299db9ec823/backtrace-0.3.50/src/capture.rs:164\r\n...\r\n```\r\n\r\n\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2256/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2256/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2255", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2255/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2255/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2255/events", "html_url": "https://github.com/edgedb/edgedb/issues/2255", "id": 812655434, "node_id": "MDU6SXNzdWU4MTI2NTU0MzQ=", "number": 2255, "title": "edb.errors.InternalServerError: column \"target\" is of type edgedbpub.\"71637d60-9aed-6158-3c48-7316b93c0197_t\" but expression is of type bigint", "user": {"login": "isidentical", "id": 47358913, "node_id": "MDQ6VXNlcjQ3MzU4OTEz", "avatar_url": "https://avatars.githubusercontent.com/u/47358913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/isidentical", "html_url": "https://github.com/isidentical", "followers_url": "https://api.github.com/users/isidentical/followers", "following_url": "https://api.github.com/users/isidentical/following{/other_user}", "gists_url": "https://api.github.com/users/isidentical/gists{/gist_id}", "starred_url": "https://api.github.com/users/isidentical/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/isidentical/subscriptions", "organizations_url": "https://api.github.com/users/isidentical/orgs", "repos_url": "https://api.github.com/users/isidentical/repos", "events_url": "https://api.github.com/users/isidentical/events{/privacy}", "received_events_url": "https://api.github.com/users/isidentical/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2021-02-20T16:28:22Z", "updated_at": "2021-03-06T11:07:12Z", "closed_at": "2021-03-06T01:44:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0a8.dev5340+g76e0688b-2021012101~focal.nightly\r\n- OS Version: Ubuntu\r\n\r\n```\r\nSTART MIGRATION TO {\r\n    module default {\r\n        type Movie {\r\n            required property title -> str;\r\n            multi property tags -> tuple<int64, str>;\r\n        }\r\n    }\r\n}\r\n```\r\n```\r\nINSERT Movie {title := 'hey', tags := {(10, 'foo'), (20, 'bar')}};\r\n```\r\n```\r\nERROR: InternalServerError: column \"target\" is of type edgedbpub.\"71637d60-9aed-6158-3c48-7316b93c0197_t\" but expression is of type bigint\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: column \"target\" is of type edgedbpub.\"71637d60-9aed-6158-3c48-7316b93c0197_t\" but expression is of type bigint\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2255/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2255/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2246", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2246/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2246/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2246/events", "html_url": "https://github.com/edgedb/edgedb/issues/2246", "id": 810396893, "node_id": "MDU6SXNzdWU4MTAzOTY4OTM=", "number": 2246, "title": "CI triggered an intermittent bug", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-02-17T17:41:10Z", "updated_at": "2021-02-21T03:51:06Z", "closed_at": "2021-02-21T03:51:06Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "CI triggered this intermittent bug:\r\n```\r\nERROR: tearDownClass (test_server_proto.TestServerProtoDDL)\r\n--------------------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/runner/work/edgedb/edgedb/edb/testbase/server.py\", line 1011, in tearDownClass\r\n    cls.loop.run_until_complete(drop_db())\r\n  File \"/opt/hostedtoolcache/Python/3.9.1/x64/lib/python3.9/asyncio/base_events.py\", line 642, in run_until_complete\r\n    return future.result()\r\n  File \"/home/runner/work/edgedb/edgedb/edb/testbase/server.py\", line 1007, in drop_db\r\n    await cls.admin_conn.execute(\r\n  File \"/opt/hostedtoolcache/Python/3.9.1/x64/lib/python3.9/site-packages/edgedb/asyncio_con.py\", line 378, in execute\r\n    await self._impl._protocol.simple_query(query)\r\n  File \"edgedb/protocol/protocol.pyx\", line 567, in simple_query\r\nedgedb.errors.ExecutionError: database \"serverprotoddl_5003\" is being accessed by other users\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2246/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2246/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2235", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2235/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2235/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2235/events", "html_url": "https://github.com/edgedb/edgedb/issues/2235", "id": 808952732, "node_id": "MDU6SXNzdWU4MDg5NTI3MzI=", "number": 2235, "title": "ISE: 'NoneType' object has no attribute 'write'", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-02-16T03:24:50Z", "updated_at": "2021-10-22T22:55:20Z", "closed_at": "2021-10-22T22:55:20Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "A scheduled test run resulted in this intermittent failure:\r\n\r\n```\r\n ================================================================================\r\nERROR: test_server_proto_concurrent_global_ddl (test_server_proto.TestServerProtoConcurrentGlobalDDL)\r\n--------------------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/runner/work/edgedb/edgedb/edb/testbase/server.py\", line 910, in tearDown\r\n    self.loop.run_until_complete(\r\n  File \"/opt/hostedtoolcache/Python/3.9.1/x64/lib/python3.9/asyncio/base_events.py\", line 642, in run_until_complete\r\n    return future.result()\r\n  File \"/opt/hostedtoolcache/Python/3.9.1/x64/lib/python3.9/site-packages/edgedb/asyncio_con.py\", line 378, in execute\r\n    await self._impl._protocol.simple_query(query)\r\n  File \"edgedb/protocol/protocol.pyx\", line 567, in simple_query\r\nedgedb.errors.InternalServerError: 'NoneType' object has no attribute 'write'\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2235/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2235/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2207", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2207/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2207/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2207/events", "html_url": "https://github.com/edgedb/edgedb/issues/2207", "id": 805072636, "node_id": "MDU6SXNzdWU4MDUwNzI2MzY=", "number": 2207, "title": "Constraint expressions with backlinks give ISE", "user": {"login": "holmesmr", "id": 706183, "node_id": "MDQ6VXNlcjcwNjE4Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/706183?v=4", "gravatar_id": "", "url": "https://api.github.com/users/holmesmr", "html_url": "https://github.com/holmesmr", "followers_url": "https://api.github.com/users/holmesmr/followers", "following_url": "https://api.github.com/users/holmesmr/following{/other_user}", "gists_url": "https://api.github.com/users/holmesmr/gists{/gist_id}", "starred_url": "https://api.github.com/users/holmesmr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/holmesmr/subscriptions", "organizations_url": "https://api.github.com/users/holmesmr/orgs", "repos_url": "https://api.github.com/users/holmesmr/repos", "events_url": "https://api.github.com/users/holmesmr/events{/privacy}", "received_events_url": "https://api.github.com/users/holmesmr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-02-10T01:36:30Z", "updated_at": "2021-02-21T18:11:45Z", "closed_at": "2021-02-21T18:11:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0a7-2021011304\r\n- OS Version: macOS 11.2\r\n\r\nA type with a constraint expression containing a backlink causes an `edb.errors.InternalServerError: unexpectedly long path in simple expr` to be raised. SDL that reproduces is provided, but from testing, equivalent DDL statements cause the same issue, so it's not purely an issue with SDLs.\r\n\r\nSteps to Reproduce:\r\n\r\n1. Prepare the schema for migration.\r\n\r\n2. Populate and commit the transaction.\r\n\r\nSchema:\r\n```\r\nmodule default {\r\n    abstract type User {\r\n        required property name -> str;\r\n        multi link groups -> MemberGroup;\r\n    }\r\n\r\n    type MemberGroup {\r\n        required property name -> str;\r\n\r\n        # Only Bob can have groups.\r\n        constraint expression on (\r\n            __subject__.<groups[IS User].name = \"Bob\"\r\n        );\r\n    }\r\n}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2207/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2207/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2204", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2204/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2204/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2204/events", "html_url": "https://github.com/edgedb/edgedb/issues/2204", "id": 804700413, "node_id": "MDU6SXNzdWU4MDQ3MDA0MTM=", "number": 2204, "title": "Migrations aren't propagated to existing connections", "user": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2021-02-09T16:18:33Z", "updated_at": "2021-03-01T17:24:15Z", "closed_at": "2021-03-01T17:24:15Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version:1.0-alpha.8+dev.5386.g6933b454f\r\nSteps to Reproduce:\r\n\r\n1. Start `edgedb` (repl) and do a query:\r\n```\r\nedgedb> SELECT Counter;\r\nerror: object type or alias 'default::Counter' does not exist\r\n  \u250c\u2500 query:1:8\r\n  \u2502\r\n1 \u2502 SELECT Counter;\r\n  \u2502        ^^^^^^^ error\r\n```\r\n2. Then in another shell do `edgedb migrate` to create the type\r\n3. Then return back to this shell and confirm that error still there (while it shouldn't be):\r\n```\r\nedgedb> SELECT Counter;\r\nerror: object type or alias 'default::Counter' does not exist\r\n  \u250c\u2500 query:1:8\r\n  \u2502\r\n1 \u2502 SELECT Counter;\r\n  \u2502        ^^^^^^^ error\r\n\r\n```\r\n4. Also try and confirm that it works in a new connection:\r\n```\r\nedgedb> SELECT Counter;\r\n{}\r\n```\r\n\r\n**Note:** this doesn't reproduce with `CREATE TYPE` only with migrations.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2204/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2204/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2179", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2179/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2179/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2179/events", "html_url": "https://github.com/edgedb/edgedb/issues/2179", "id": 799773880, "node_id": "MDU6SXNzdWU3OTk3NzM4ODA=", "number": 2179, "title": "Bogus names and references in migrations are reported as ISEs", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-02-02T22:38:08Z", "updated_at": "2021-02-08T19:01:59Z", "closed_at": "2021-02-08T19:01:59Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nstart migration to {\r\nmodule test {\r\ntype Foo extending Bar;\r\n}\r\n};\r\n```\r\nis reported as `edb.common.topological.UnresolvedReferenceError: reference to an undefined item test::Bar in test::Foo`\r\n\r\nand \r\n```\r\nstart migration to {\r\nmodule test {\r\ntype Foo extending Foo;\r\n}\r\n};\r\n```\r\nis reported as a RecursionError", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2179/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2179/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2174", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2174/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2174/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2174/events", "html_url": "https://github.com/edgedb/edgedb/issues/2174", "id": 798658729, "node_id": "MDU6SXNzdWU3OTg2NTg3Mjk=", "number": 2174, "title": "Migration tools required filler expression when it is not needed.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-02-01T19:51:39Z", "updated_at": "2021-02-04T02:43:29Z", "closed_at": "2021-02-04T02:43:29Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0-alpha.8+dev.5361.g1528f3342.d20210201\r\n- OS Version: Linux\r\n\r\nSteps to Reproduce:\r\n\r\nUsing the following `schema.esdl`\r\n```\r\nmodule default {\r\n    type User;\r\n\r\n    type Message {\r\n        required link author -> User;\r\n        required property body -> str;\r\n    }\r\n};\r\n```\r\n\r\n```sh\r\n$ edgedb -d db create-migration --schema-dir db_schema\r\ndid you create object type 'default::User'? [y,n,l,c,b,s,q,?]\r\ny\r\ndid you create object type 'default::Message'? [y,n,l,c,b,s,q,?]\r\ny\r\nCreated db_schema/migrations/00001.edgeql, id: m1nujm6huttwt4ocbkkmjdqhm2um3qj7micyf6bmpha2cdvzv6ajya\r\n$ edgedb -d db migrate --schema-dir db_schema\r\nApplied m1nujm6huttwt4ocbkkmjdqhm2um3qj7micyf6bmpha2cdvzv6ajya (00001.edgeql)\r\n```\r\n\r\nChanging the `schema.esdl`\r\n```\r\nmodule default {\r\n    type User;\r\n\r\n    type BaseMessage {\r\n        required link author -> User;\r\n        required property body -> str;\r\n    }\r\n\r\n    type Message extending BaseMessage;\r\n};\r\n```\r\n\r\n```sh\r\n$ edgedb -d db create-migration --schema-dir db_schema\r\ndid you create object type 'default::BaseMessage'? [y,n,l,c,b,s,q,?]\r\ny\r\ndid you alter object type 'default::Message'? [y,n,l,c,b,s,q,?]\r\ny\r\nPlease specify an expression to populate existing objects in order to make link 'author' required:\r\nfill_expr_2> \r\n```\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2174/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2174/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2173", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2173/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2173/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2173/events", "html_url": "https://github.com/edgedb/edgedb/issues/2173", "id": 798653051, "node_id": "MDU6SXNzdWU3OTg2NTMwNTE=", "number": 2173, "title": "Return cardinality is not validated in some cases", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 932934397, "node_id": "MDU6TGFiZWw5MzI5MzQzOTc=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/edgeql", "name": "edgeql", "color": "0052cc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-02-01T19:42:40Z", "updated_at": "2021-12-09T01:02:22Z", "closed_at": "2021-12-09T01:02:22Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0-alpha.8+dev.5361.g1528f3342.d20210201\r\n- OS Version: Linux\r\n\r\nSteps to Reproduce:\r\n\r\n1. `create function foo() -> str using ('a' if random() > 0.5 else <str>{});`\r\n\r\nThe function can return an empty set, so the return type should instead be `optional str` and the current definition should be disallowed.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2173/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2173/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2161", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2161/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2161/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2161/events", "html_url": "https://github.com/edgedb/edgedb/pull/2161", "id": 796109348, "node_id": "MDExOlB1bGxSZXF1ZXN0NTYzMzQ0MDk5", "number": 2161, "title": "Refactor handling of context/error span handling", "user": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2021-01-28T15:29:23Z", "updated_at": "2021-02-10T11:48:51Z", "closed_at": "2021-02-10T11:47:57Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/edgedb/edgedb/pulls/2161", "html_url": "https://github.com/edgedb/edgedb/pull/2161", "diff_url": "https://github.com/edgedb/edgedb/pull/2161.diff", "patch_url": "https://github.com/edgedb/edgedb/pull/2161.patch", "merged_at": "2021-02-10T11:47:57Z"}, "body": "1. Track integer byte offsets thorough code\r\n2. Only convert when error must be printed or sent to the client\r\n3. Use Rust for position conversion\r\n\r\nNotes:\r\n1. It looks like `rebase_context` is unused anymore, right?\r\n2. No test has failed when `as_markup` was broken. Where is it used?\r\n3. We still use strings for queries internally, using bytes instead will be in a separate PR\r\n4. We send byte offsets to the client (there are probably two users of these offsets currently: Rust client, which is fine, and Javascript tutorial, which is unreleased yet).\r\n5. `column` is now calculated using [unicode-width](https://crates.io/crates/unicode-width) previously was in terms of unicode codepoints. But it is unused in Rust for rendering anyway (only may show up in errors that don't show snippet), so should not break anything.\r\n6. utf16column and char_offset are currently unused. The former is intended for language server protocol (LSP) support and the latter we might consider sending to the client so that slicing string in python is easier.\r\n\r\nAlso I think that https://github.com/edgedb/ui/commit/4b97505abeffaf909346d5ffa4f7dc407edc0573 does it wrong: it uses byte offsets sent from server as a utf-16 offsets that JS expects. @jaclarke, should we also have `utf16offset` sent from server? Or should you overlay just target line(s) and use `utf16column` for slicing?", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2161/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2161/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2154", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2154/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2154/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2154/events", "html_url": "https://github.com/edgedb/edgedb/issues/2154", "id": 794629386, "node_id": "MDU6SXNzdWU3OTQ2MjkzODY=", "number": 2154, "title": "ISE on empty set within set literal", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-01-26T23:09:47Z", "updated_at": "2021-03-09T02:51:18Z", "closed_at": "2021-03-09T02:51:18Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: `1.0-alpha.8+dev.5351.g93a3c34c4.d20210126`\r\n\r\nRepro:\r\n\r\n```\r\nSELECT {False, <bool>{}};\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2154/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2154/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2135", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2135/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2135/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2135/events", "html_url": "https://github.com/edgedb/edgedb/issues/2135", "id": 790019586, "node_id": "MDU6SXNzdWU3OTAwMTk1ODY=", "number": 2135, "title": "Better syntax errors for substitution tokens", "user": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-01-20T14:20:24Z", "updated_at": "2021-01-25T12:03:58Z", "closed_at": "2021-01-25T12:03:58Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Currently as of 1.0-alpha.8+dev.5341.g66ec73494 it fails with InternalServerError:\r\n```\r\nedgedb> SELECT \\(x);\r\nERROR: InternalServerError: (<class 'edb.edgeql.parser.grammar.tokens.TokenMeta'>, 'SUBSTITUTION')\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/work/edb/server/procpool/worker.py\", line 75, in worker\r\n          res = await meth(*args)\r\n        File \"/work/edb/server/compiler/compiler.py\", line 1935, in compile\r\n          return self._compile(ctx=ctx, source=source)\r\n        File \"/work/edb/server/compiler/compiler.py\", line 1487, in _compile\r\n          return self._try_compile(ctx=ctx, source=source)\r\n        File \"/work/edb/server/compiler/compiler.py\", line 1519, in _try_compile\r\n          statements = edgeql.parse_block(source)\r\n        File \"/work/edb/edgeql/parser/__init__.py\", line 69, in parse_block\r\n          return parser.parse(source)\r\n        File \"/work/edb/common/parsing.py\", line 401, in parse\r\n          token = self.process_lex_token(mod, tok)\r\n        File \"/work/edb/common/parsing.py\", line 390, in process_lex_token\r\n          return mod.TokenMeta.for_lex_token(tok.kind())(\r\n        File \"/work/edb/common/parsing.py\", line 100, in for_lex_token\r\n          return mcls.token_map[mcls, token]\r\n      KeyError: (<class 'edb.edgeql.parser.grammar.tokens.TokenMeta'>, 'SUBSTITUTION')\r\n```\r\nThis bug appeared after #2131 ", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2135/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2135/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2104", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2104/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2104/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2104/events", "html_url": "https://github.com/edgedb/edgedb/issues/2104", "id": 780794387, "node_id": "MDU6SXNzdWU3ODA3OTQzODc=", "number": 2104, "title": "Recursive function DDL results in an infinite loop", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710370487, "node_id": "MDU6TGFiZWwxNzEwMzcwNDg3", "url": "https://api.github.com/repos/edgedb/edgedb/labels/low%20priority", "name": "low priority", "color": "3bbf81", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2021-01-06T19:31:31Z", "updated_at": "2022-01-26T02:55:31Z", "closed_at": "2021-10-25T19:42:13Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\ncreate type SomeThing {\r\n   create link child -> SomeThing;\r\n};\r\n\r\ncreate function get_all_children_ordered(parent: SomeThing) -> SET OF SomeThing \r\nUsing (SELECT SomeThing);\r\n\r\nALTER FUNCTION get_all_children_ordered(parent: SomeThing) USING ( SELECT parent.child UNION get_all_children_ordered(parent) );\r\n```\r\n\r\nresults in \r\n\r\n```\r\nERROR: InternalServerError: maximum recursion depth exceeded\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2104/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2104/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2057", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2057/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2057/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2057/events", "html_url": "https://github.com/edgedb/edgedb/issues/2057", "id": 767682333, "node_id": "MDU6SXNzdWU3Njc2ODIzMzM=", "number": 2057, "title": "Dump crashes", "user": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-12-15T15:00:45Z", "updated_at": "2020-12-23T03:14:37Z", "closed_at": "2020-12-23T03:14:36Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: 1-alpha.6, 1-alpha.7, ec7a0e609\r\n\r\nApplied migration:\r\n```\r\nCREATE MIGRATION m1u4jg4u3dkb737rpbwe4jeb6q735ptn65qgb2zd6p3ep2zl4nickq\r\n    ONTO initial\r\n{\r\n  CREATE TYPE default::A;\r\n  CREATE TYPE default::B {\r\n      CREATE REQUIRED SINGLE LINK link_a -> default::A;\r\n  };\r\n  ALTER TYPE default::A {\r\n      CREATE OPTIONAL MULTI LINK link_b := (.<link_a[IS default::B]);\r\n  };\r\n};\r\n```\r\nGot this:\r\n```\r\nedgedb error: WARNING: unsolicited message ErrorResponse(ErrorResponse { severity: Error, code: 16777216, message: \"unhandled errors in a TaskGroup; 1 sub errors: (BackendError)\\n + BackendError: relation \\\"edgedbpub.b33c7457-3ee5-11eb-ada4-4716c5d2f104\\\" does not exist\\n |   File \\\"edb/server/pgcon/pgcon.pyx\\\", line 867, in dump\\n |     await self._dump(block, output_queue, fragment_suggested_size)\\n |   File \\\"edb/server/pgcon/pgcon.pyx\\\", line 855, in _dump\\n |     raise pgerror.BackendError(fields=er)\\n\\n\", attributes: {1: b\"This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\", 257: b\"Traceback (most recent call last):\\n  File \\\"edb/server/mng_port/edgecon.pyx\\\", line 1635, in edb.server.mng_port.edgecon.EdgeConnection.main\\n    await self.dump()\\n  File \\\"edb/server/mng_port/edgecon.pyx\\\", line 2090, in dump\\n    async with taskgroup.TaskGroup() as g:\\n  File \\\"/work/edb/common/taskgroup.py\\\", line 169, in __aexit__\\n    raise me from None\\nedb.common.taskgroup.TaskGroupError: unhandled errors in a TaskGroup; 1 sub errors: (BackendError)\\n + BackendError: relation \\\"edgedbpub.b33c7457-3ee5-11eb-ada4-4716c5d2f104\\\" does not exist\\n |   File \\\"edb/server/pgcon/pgcon.pyx\\\", line 867, in dump\\n |     await self._dump(block, output_queue, fragment_suggested_size)\\n |   File \\\"edb/server/pgcon/pgcon.pyx\\\", line 855, in _dump\\n |     raise pgerror.BackendError(fields=er)\\n\\n\\n\"} })\r\n```\r\n\r\n**Update:** crash happens when receiving data blocks (even if they are empty), header block (i.e. schema) is received without an error and looks fine at a glance.\r\n\r\nApart from fixing the bug, we need:\r\n1. Log dump errors in the server log (currently only logged with `EDGEDB_DEBUG_SERVER_PROTO` which is not intended for production`\r\n2. Print dump errors in a nicer way in CLI tools (edgedb/edgedb-cli#210)", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2057/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2057/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2019", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2019/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2019/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2019/events", "html_url": "https://github.com/edgedb/edgedb/pull/2019", "id": 756163779, "node_id": "MDExOlB1bGxSZXF1ZXN0NTMxNzUyNjI4", "number": 2019, "title": "Assume inline_typeids for protocol <= 0.8", "user": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-12-03T12:45:31Z", "updated_at": "2020-12-03T17:18:24Z", "closed_at": "2020-12-03T17:18:23Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/edgedb/edgedb/pulls/2019", "html_url": "https://github.com/edgedb/edgedb/pull/2019", "diff_url": "https://github.com/edgedb/edgedb/pull/2019.diff", "patch_url": "https://github.com/edgedb/edgedb/pull/2019.patch", "merged_at": "2020-12-03T17:18:23Z"}, "body": "Was broken in d7b08f7b281144a20f9ca0c559a457037fa38b6e\r\nIn particular, JavaScript tests are broken because of this.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2019/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2019/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2010", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2010/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2010/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2010/events", "html_url": "https://github.com/edgedb/edgedb/issues/2010", "id": 754004462, "node_id": "MDU6SXNzdWU3NTQwMDQ0NjI=", "number": 2010, "title": "Compiler bug not allowing functions to return sets of tuples", "user": {"login": "Dhghomon", "id": 56599343, "node_id": "MDQ6VXNlcjU2NTk5MzQz", "avatar_url": "https://avatars.githubusercontent.com/u/56599343?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dhghomon", "html_url": "https://github.com/Dhghomon", "followers_url": "https://api.github.com/users/Dhghomon/followers", "following_url": "https://api.github.com/users/Dhghomon/following{/other_user}", "gists_url": "https://api.github.com/users/Dhghomon/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dhghomon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dhghomon/subscriptions", "organizations_url": "https://api.github.com/users/Dhghomon/orgs", "repos_url": "https://api.github.com/users/Dhghomon/repos", "events_url": "https://api.github.com/users/Dhghomon/events{/privacy}", "received_events_url": "https://api.github.com/users/Dhghomon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-12-01T04:48:04Z", "updated_at": "2020-12-02T18:47:33Z", "closed_at": "2020-12-02T18:47:33Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: Alpha 6\r\n- OS Version: Windows 10 (Ubuntu Windows 10 subsystem)\r\n\r\nI discovered this when experimenting with creating my own functions that return sets.\r\n\r\nSteps to Reproduce:\r\n\r\nCreate any function of this sort:\r\n\r\n```\r\ncreate function find_string(input: str) -> SET OF tuple<str, int64>\r\n  using(\r\n    SELECT(Person.name, find(Person.name, input))\r\n);\r\n```\r\n\r\nHere's the output: `ERROR: InternalServerError: a column definition list is only allowed for functions returning \"record\".`\r\n\r\n@elprans mentioned the following on the error:\r\n\r\n```\r\nIt's a compiler bug\r\n\r\nIt compiles the body query as if it was an anonymous tuple, but it isn't in this context and so Postgres complains.  SQL arcana.\r\n```\r\n\r\nI think it was during Chapter 12 when the schema looked [like this](https://github.com/edgedb/easy-edgedb/blob/master/chapter12/code.md).", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2010/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2010/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2003", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2003/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2003/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2003/events", "html_url": "https://github.com/edgedb/edgedb/issues/2003", "id": 753106802, "node_id": "MDU6SXNzdWU3NTMxMDY4MDI=", "number": 2003, "title": "Can't set computable property for abstract links", "user": {"login": "adriangb", "id": 1755071, "node_id": "MDQ6VXNlcjE3NTUwNzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1755071?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adriangb", "html_url": "https://github.com/adriangb", "followers_url": "https://api.github.com/users/adriangb/followers", "following_url": "https://api.github.com/users/adriangb/following{/other_user}", "gists_url": "https://api.github.com/users/adriangb/gists{/gist_id}", "starred_url": "https://api.github.com/users/adriangb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adriangb/subscriptions", "organizations_url": "https://api.github.com/users/adriangb/orgs", "repos_url": "https://api.github.com/users/adriangb/repos", "events_url": "https://api.github.com/users/adriangb/events{/privacy}", "received_events_url": "https://api.github.com/users/adriangb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-11-30T03:17:07Z", "updated_at": "2020-12-21T20:39:30Z", "closed_at": "2020-12-21T20:37:57Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "- EdgeDB Version: Alpha 6\r\n- OS Version: Official docker container\r\n\r\nIt seems that computables that refer to other link properties do not work in SDL:\r\n```\r\nSTART MIGRATION TO {\r\n    module default {\r\n        abstract link my_link {\r\n            property prop := (\r\n                1\r\n            );\r\n        }\r\n    }\r\n};\r\n```\r\nThe equivalent for types works just fine:\r\n```\r\nSTART MIGRATION TO {\r\n    module default {\r\n        type MyType {\r\n            property prop := (\r\n                1\r\n            );\r\n        }\r\n    }\r\n};\r\n```\r\n\r\nAll testing done on a fresh (DROP -> CREATE) database.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2003/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2003/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2002", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2002/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2002/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2002/events", "html_url": "https://github.com/edgedb/edgedb/issues/2002", "id": 752075157, "node_id": "MDU6SXNzdWU3NTIwNzUxNTc=", "number": 2002, "title": "Computable property fails for union type properties", "user": {"login": "adriangb", "id": 1755071, "node_id": "MDQ6VXNlcjE3NTUwNzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1755071?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adriangb", "html_url": "https://github.com/adriangb", "followers_url": "https://api.github.com/users/adriangb/followers", "following_url": "https://api.github.com/users/adriangb/following{/other_user}", "gists_url": "https://api.github.com/users/adriangb/gists{/gist_id}", "starred_url": "https://api.github.com/users/adriangb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adriangb/subscriptions", "organizations_url": "https://api.github.com/users/adriangb/orgs", "repos_url": "https://api.github.com/users/adriangb/repos", "events_url": "https://api.github.com/users/adriangb/events{/privacy}", "received_events_url": "https://api.github.com/users/adriangb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-11-27T08:32:38Z", "updated_at": "2021-01-27T00:49:50Z", "closed_at": "2021-01-27T00:49:50Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "- EdgeDB Version: Alpha 6\r\n- OS Version: Docker image\r\n\r\nThis works (as expected):\r\n```\r\ntype Type1;\r\ntype Type2;\r\ntype Type3 {\r\n    link prop1 -> (Type1 | Type2);\r\n}\r\n```\r\nSo does this:\r\n```\r\ntype Type1;\r\ntype Type2;\r\ntype Type3 {\r\n    link prop1 -> Type1;\r\n    link prop2 := (\r\n        SELECT .prop1\r\n    );\r\n}\r\n```\r\nThus I expected this to work, but it fails:\r\n```\r\ntype Type1;\r\ntype Type2;\r\ntype Type3 {\r\n    link prop1 -> (Type1 | Type2);\r\n    link prop2 := (\r\n        SELECT .prop1\r\n    );\r\n}\r\n```\r\nWith:\r\n```\r\nAttributeError: 'UnionType' object has no attribute 'get_name'\r\n```\r\n<details><summary>Traceback</summary>\r\n\r\n```\r\nERROR: InternalServerError: 'UnionType' object has no attribute 'get_name'\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha6/lib/python3.8/site-packages/edb/server/procpool/worker.py\", line 75, in worker\r\n          res = await meth(*args)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha6/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 1808, in compile_eql_tokens\r\n          return self._compile(ctx=ctx, tokens=eql_tokens)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha6/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 1442, in _compile\r\n          comp: dbstate.BaseQuery = self._compile_dispatch_ql(ctx, stmt)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha6/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 1365, in _compile_dispatch_ql\r\n          return self._compile_ql_migration(ctx, ql)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha6/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 794, in _compile_ql_migration\r\n          target_schema = s_ddl.apply_sdl(\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha6/lib/python3.8/site-packages/edb/schema/ddl.py\", line 371, in apply_sdl\r\n          ddl_stmts = s_decl.sdl_to_ddl(current_schema, documents)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha6/lib/python3.8/site-packages/edb/edgeql/declarative.py\", line 230, in sdl_to_ddl\r\n          trace_dependencies(decl_ast, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha6/lib/python3.8/functools.py\", line 875, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha6/lib/python3.8/site-packages/edb/edgeql/declarative.py\", line 499, in trace_default\r\n          _register_item(node, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha6/lib/python3.8/site-packages/edb/edgeql/declarative.py\", line 623, in _register_item\r\n          trace_dependencies(cmd, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha6/lib/python3.8/functools.py\", line 875, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha6/lib/python3.8/site-packages/edb/edgeql/declarative.py\", line 443, in trace_ConcretePointer\r\n          _register_item(\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha6/lib/python3.8/site-packages/edb/edgeql/declarative.py\", line 638, in _register_item\r\n          tdeps = qltracer.trace_refs(\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha6/lib/python3.8/site-packages/edb/edgeql/tracer.py\", line 162, in trace_refs\r\n          trace(qltree, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha6/lib/python3.8/functools.py\", line 875, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha6/lib/python3.8/site-packages/edb/edgeql/tracer.py\", line 653, in trace_Select\r\n          ctx.path_prefix = tip.get_name(ctx.schema)\r\n      AttributeError: 'UnionType' object has no attribute 'get_name'\r\n```\r\n\r\n</details>\r\n\r\nI'm just learning EdgeQL SDL so sorry if this is just user error!", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2002/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2002/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2001", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2001/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2001/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2001/events", "html_url": "https://github.com/edgedb/edgedb/issues/2001", "id": 751712197, "node_id": "MDU6SXNzdWU3NTE3MTIxOTc=", "number": 2001, "title": "Cardinality inference for computable properties", "user": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-11-26T16:23:58Z", "updated_at": "2020-12-03T21:57:39Z", "closed_at": "2020-12-03T21:57:39Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: 1-alpha6\r\n\r\nCould not create a required computable property:\r\n```\r\nrequired property deleted := EXISTS(.<element[IS DeletionRecord]);\r\n```\r\nThe error is:\r\n```\r\npossibly an empty set returned by an expression for the computable 'deleted' declared as 'required'\r\n```\r\nSince `EXISTS` never returns empty set I expect this to work.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2001/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2001/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2000", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/2000/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/2000/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/2000/events", "html_url": "https://github.com/edgedb/edgedb/issues/2000", "id": 751710955, "node_id": "MDU6SXNzdWU3NTE3MTA5NTU=", "number": 2000, "title": "Reverse link traversal doesn't work with links to unions", "user": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-11-26T16:21:59Z", "updated_at": "2020-12-03T21:57:22Z", "closed_at": "2020-12-03T21:57:21Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: 1-alpha.6\r\n\r\nMy schema:\r\n```\r\nmodule default {\r\n    type Category;\r\n    type Article {\r\n        property deleted := EXISTS(.<element[IS DeletionRecord]);\r\n    };\r\n    type DeletionRecord {\r\n        required link element -> Article | Category {\r\n            on target delete delete source;\r\n            constraint exclusive;\r\n        }\r\n    };\r\n};\r\n```\r\nThe error produced when reading chema:\r\n```\r\nerror: 'default::Article.<element' does not resolve to any known path\r\n   \u250c\u2500 ./dbschema/default.esdl:10:36\r\n   \u2502\r\n10 \u2502         property deleted := EXISTS(.<element[IS DeletionRecord]);\r\n   \u2502                                    ^^^^^^^^^^ error\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/2000/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/2000/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1989", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1989/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1989/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1989/events", "html_url": "https://github.com/edgedb/edgedb/issues/1989", "id": 747805658, "node_id": "MDU6SXNzdWU3NDc4MDU2NTg=", "number": 1989, "title": "DROP MODULE doesn't delete the module contents", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-11-20T21:29:20Z", "updated_at": "2021-04-28T22:22:45Z", "closed_at": "2021-04-28T22:22:45Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nx3> create module test; create type test::foo;\r\nOK: CREATE\r\nOK: CREATE\r\nx3> drop module test;\r\nOK: DROP\r\nx3> describe schema;\r\n{\r\n  'CREATE MODULE default IF NOT EXISTS;\r\nCREATE TYPE test::foo;',\r\n}\r\nx3> create module test; create type test::foo;\r\nOK: CREATE\r\nERROR: SchemaError: ObjectType <QualName test::foo> is already present in the schema <FlatSchema gen:1 at 0x7f738eabdcd0>\r\n```\r\n\r\nThe objects are inaccessible while the module is gone, but will appear in `describe schema` and in introspection tables and if the module is recreated, all the objects in it are already there.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1989/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1989/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1986", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1986/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1986/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1986/events", "html_url": "https://github.com/edgedb/edgedb/issues/1986", "id": 746886220, "node_id": "MDU6SXNzdWU3NDY4ODYyMjA=", "number": 1986, "title": "ISE with some type-filtered reverse pointers", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-11-19T20:08:17Z", "updated_at": "2022-09-27T19:34:39Z", "closed_at": "2022-09-27T19:34:39Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "`SELECT schema::Array {name, incoming := schema::Array.<target[IS schema::Link]};`\r\ncrashes with\r\n```\r\n        File \"/home/sully/src/e/edgedb/edb/pgsql/compiler/astutils.py\", line 253, in find_column_in_subselect_rvar\r\n          raise RuntimeError(f'cannot find {name!r} in {rvar} output')\r\n      RuntimeError: cannot find 'c9a357e0-2aa0-11eb-8146-1b095e5df57b' in <pg.RangeSubselect at 0x7f1e82f79af0> output\r\n```\r\n\r\n`SELECT schema::Array {name, incoming := .<type[IS schema::TupleElement]};` works, but\r\n`SELECT schema::Array {name, incoming := .<type[IS schema::Parameter]};` doesn't.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1986/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1986/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1943", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1943/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1943/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1943/events", "html_url": "https://github.com/edgedb/edgedb/issues/1943", "id": 733979560, "node_id": "MDU6SXNzdWU3MzM5Nzk1NjA=", "number": 1943, "title": "Enum migrations don't work", "user": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-11-01T14:27:04Z", "updated_at": "2021-03-08T21:07:55Z", "closed_at": "2021-03-08T21:07:54Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Even simple change like:\r\n```\r\n    scalar type Enum1 extending enum<Opt1, Opt2>;\r\n```\r\n->\r\n```\r\n    scalar type Enum1 extending enum<Opt1, Opt2, Opt3>;\r\n```\r\nGives me (at `create-migration`):\r\n```\r\nError: Server could not figure out migration with your answers. Please retry with different answers\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1943/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1943/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1941", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1941/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1941/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1941/events", "html_url": "https://github.com/edgedb/edgedb/issues/1941", "id": 733764295, "node_id": "MDU6SXNzdWU3MzM3NjQyOTU=", "number": 1941, "title": "Position dependent schema error", "user": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-10-31T17:04:37Z", "updated_at": "2020-11-13T22:31:49Z", "closed_at": "2020-11-13T22:31:49Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This schema errors on `create-migration`:\r\n```\r\nmodule default {\r\n    type Owner {\r\n        multi link professional_skills := .<user[IS Thing][IS Pencil];\r\n    };\r\n    type Color {\r\n    };\r\n    abstract type Thing {\r\n        required link user -> Owner;\r\n        required link color -> Color;\r\n        required property enabled -> bool;\r\n    };\r\n    type Pencil extending Thing {\r\n        constraint exclusive on ((.user, .color));\r\n    };\r\n};\r\n```\r\nError is:\r\n```\r\nerror: object type 'default::Pencil' has no link or property 'user'\r\n   \u250c\u2500 ./dbschema/default.esdl:13:35\r\n   \u2502\r\n13 \u2502         constraint exclusive on ((.user, .color));\r\n   \u2502                                   ^^^^^^ error\r\n\r\nError: cannot proceed until .esdl files are fixed\r\n```\r\n\r\nWhile this shema works fine (moved `Owner`):\r\n```\r\nmodule default {\r\n    type Color {\r\n    };\r\n    abstract type Thing {\r\n        required link user -> Owner;\r\n        required link color -> Color;\r\n        required property enabled -> bool;\r\n    };\r\n    type Pencil extending Thing {\r\n        constraint exclusive on ((.user, .color));\r\n    };\r\n    type Owner {\r\n        multi link professional_skills := .<user[IS Thing][IS Pencil];\r\n    };\r\n};\r\n```\r\n\r\nEdgedb is e23a21d60.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1941/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1941/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1938", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1938/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1938/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1938/events", "html_url": "https://github.com/edgedb/edgedb/issues/1938", "id": 733690701, "node_id": "MDU6SXNzdWU3MzM2OTA3MDE=", "number": 1938, "title": "Unique constraint on abstract type doesn't work?", "user": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-10-31T10:41:30Z", "updated_at": "2020-11-07T23:05:55Z", "closed_at": "2020-11-07T23:05:54Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Here is the error:\r\n```\r\nedgedb> CREATE ABSTRACT TYPE Base { create property test1 -> str; create property test2 -> str; create constraint exclusive on ((.test1, .test2));};\r\nOK: CREATE\r\nedgedb> CREATE TYPE Test2 EXTENDING Base;\r\nerror: could not resolve partial path\r\n  \u250c\u2500 query:1:28\r\n  \u2502\r\n1 \u2502 CREATE TYPE Test2 EXTENDING Base;\r\n  \u2502                            ^^^^^^^ error\r\n\r\nedgedb> CREATE TYPE Test2 EXTENDING default::Base;\r\nerror: could not resolve partial path\r\n  \u250c\u2500 query:1:28\r\n  \u2502\r\n1 \u2502 CREATE TYPE Test2 EXTENDING default::Base;\r\n  \u2502                            ^^^^^^^ error\r\n```\r\nAlso note that error message is a way off, so I guess it refers to a constraint definition rather than the DDL here.\r\n\r\nThere are three possible action points:\r\n1. Fix constraint to work\r\n2. Or disable some kinds of constraints in abstract types (at least temporarily)\r\n3. And figure out what's wrong with the error position and how we can fix that (I think we need to ship actual source code of the expression via error message to correctly point to the error).\r\n\r\n**Update:** when using `create-migration` error pops up only on `migrate` the migration is created without errors.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1938/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1938/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1936", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1936/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1936/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1936/events", "html_url": "https://github.com/edgedb/edgedb/issues/1936", "id": 733538116, "node_id": "MDU6SXNzdWU3MzM1MzgxMTY=", "number": 1936, "title": "ISE when doing `SET` on an invalid proprety", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-10-30T21:51:48Z", "updated_at": "2021-01-11T18:02:58Z", "closed_at": "2021-01-11T18:02:58Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "`CREATE TYPE Lol { SET ha := \"crash\"; };`\r\nproduces\r\n```\r\nERROR: InternalServerError: schema class 'ObjectType' has no field 'ha'\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n```\r\nSame story with migrations;\r\n\r\nThe error does, tbh, make it pretty clear what the problem is, but we ought to produce a real error.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1936/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1936/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1920", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1920/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1920/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1920/events", "html_url": "https://github.com/edgedb/edgedb/issues/1920", "id": 730962847, "node_id": "MDU6SXNzdWU3MzA5NjI4NDc=", "number": 1920, "title": "min/max trigger ISE when used on unsupported types", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-10-28T00:06:24Z", "updated_at": "2021-03-25T17:02:34Z", "closed_at": "2021-03-25T17:02:34Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "`std::min`/`std::max` nominally take `anytype` but the backing SQL function doesn't support `uuids` or tuples, among other things;\r\n\r\n`SELECT min(Object.id);`, `SELECT min(Object)` and `SELECT min({(1,2), (3,4)});` all produce ISEs.\r\n\r\nWe should at least properly disallow the unsupported ones but since they have working less than operators it would be best if we could support it actually. (But I'm not sure if that is plausible.)\r\n\r\n(I think there might be other similar things, but I couldn't find more at a quick glance.)", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1920/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1920/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1919", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1919/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1919/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1919/events", "html_url": "https://github.com/edgedb/edgedb/issues/1919", "id": 730956399, "node_id": "MDU6SXNzdWU3MzA5NTYzOTk=", "number": 1919, "title": "ISE when LIMIT/OFFSET correlated with query", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-10-27T23:54:38Z", "updated_at": "2020-11-03T17:17:37Z", "closed_at": "2020-11-03T17:17:37Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nsully> SELECT Object LIMIT len(<str>.id);\r\nERROR: InternalServerError: argument of LIMIT must not contain variables\r\n```\r\n\r\n```\r\nsully> SELECT Object OFFSET len(<str>.id);\r\nERROR: InternalServerError: argument of OFFSET must not contain variables\r\n```\r\n\r\nRejecting these is correct but we want a real error.\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1919/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1919/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1887", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1887/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1887/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1887/events", "html_url": "https://github.com/edgedb/edgedb/issues/1887", "id": 723396410, "node_id": "MDU6SXNzdWU3MjMzOTY0MTA=", "number": 1887, "title": "edb.errors.InternalServerError: there is no range var for (__derived__::expr~15) source in <pg.SelectStmt at 0x7f9393526e80>", "user": {"login": "isidentical", "id": 47358913, "node_id": "MDQ6VXNlcjQ3MzU4OTEz", "avatar_url": "https://avatars.githubusercontent.com/u/47358913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/isidentical", "html_url": "https://github.com/isidentical", "followers_url": "https://api.github.com/users/isidentical/followers", "following_url": "https://api.github.com/users/isidentical/following{/other_user}", "gists_url": "https://api.github.com/users/isidentical/gists{/gist_id}", "starred_url": "https://api.github.com/users/isidentical/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/isidentical/subscriptions", "organizations_url": "https://api.github.com/users/isidentical/orgs", "repos_url": "https://api.github.com/users/isidentical/repos", "events_url": "https://api.github.com/users/isidentical/events{/privacy}", "received_events_url": "https://api.github.com/users/isidentical/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-10-16T17:17:14Z", "updated_at": "2020-12-13T10:35:50Z", "closed_at": "2020-12-12T06:05:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\nSELECT\r\n    ast::Expr\r\nFILTER\r\n    count (.value[IS ast::Call].args) = 2\r\n    AND (\r\n        WITH\r\n            items := array_agg(\r\n                (\r\n                    FOR _singleton\r\n                    IN {.value[IS ast::Call]}\r\n                    UNION (SELECT _singleton.args ORDER BY @index)\r\n                )\r\n            )\r\n        SELECT\r\n            items[0] IS ast::Name\r\n    )\r\nLIMIT 10;\r\n```\r\n\r\nwhile playing with the edgeql, I noticed this throws an `edb.errors.InternalServerError`, so reporting it. Here is the [schema](https://github.com/reizio/reiz.io/blob/master/static/Python-reiz.edgeql)", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1887/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1887/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1880", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1880/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1880/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1880/events", "html_url": "https://github.com/edgedb/edgedb/issues/1880", "id": 721580825, "node_id": "MDU6SXNzdWU3MjE1ODA4MjU=", "number": 1880, "title": "BaseObject.__type__ has to be required", "user": {"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-10-14T15:54:18Z", "updated_at": "2020-11-26T02:16:26Z", "closed_at": "2020-11-26T02:16:26Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Currently `BaseObject.__type__` isn't a required link but it should be.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1880/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1880/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1848", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1848/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1848/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1848/events", "html_url": "https://github.com/edgedb/edgedb/issues/1848", "id": 712288689, "node_id": "MDU6SXNzdWU3MTIyODg2ODk=", "number": 1848, "title": "1_0a4.dump fails to restore on master (1.0a6.dev5102)", "user": {"login": "ambv", "id": 55281, "node_id": "MDQ6VXNlcjU1Mjgx", "avatar_url": "https://avatars.githubusercontent.com/u/55281?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ambv", "html_url": "https://github.com/ambv", "followers_url": "https://api.github.com/users/ambv/followers", "following_url": "https://api.github.com/users/ambv/following{/other_user}", "gists_url": "https://api.github.com/users/ambv/gists{/gist_id}", "starred_url": "https://api.github.com/users/ambv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ambv/subscriptions", "organizations_url": "https://api.github.com/users/ambv/orgs", "repos_url": "https://api.github.com/users/ambv/repos", "events_url": "https://api.github.com/users/ambv/events{/privacy}", "received_events_url": "https://api.github.com/users/ambv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "ambv", "id": 55281, "node_id": "MDQ6VXNlcjU1Mjgx", "avatar_url": "https://avatars.githubusercontent.com/u/55281?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ambv", "html_url": "https://github.com/ambv", "followers_url": "https://api.github.com/users/ambv/followers", "following_url": "https://api.github.com/users/ambv/following{/other_user}", "gists_url": "https://api.github.com/users/ambv/gists{/gist_id}", "starred_url": "https://api.github.com/users/ambv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ambv/subscriptions", "organizations_url": "https://api.github.com/users/ambv/orgs", "repos_url": "https://api.github.com/users/ambv/repos", "events_url": "https://api.github.com/users/ambv/events{/privacy}", "received_events_url": "https://api.github.com/users/ambv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ambv", "id": 55281, "node_id": "MDQ6VXNlcjU1Mjgx", "avatar_url": "https://avatars.githubusercontent.com/u/55281?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ambv", "html_url": "https://github.com/ambv", "followers_url": "https://api.github.com/users/ambv/followers", "following_url": "https://api.github.com/users/ambv/following{/other_user}", "gists_url": "https://api.github.com/users/ambv/gists{/gist_id}", "starred_url": "https://api.github.com/users/ambv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ambv/subscriptions", "organizations_url": "https://api.github.com/users/ambv/orgs", "repos_url": "https://api.github.com/users/ambv/repos", "events_url": "https://api.github.com/users/ambv/events{/privacy}", "received_events_url": "https://api.github.com/users/ambv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-09-30T21:20:13Z", "updated_at": "2020-10-03T12:09:13Z", "closed_at": "2020-10-03T12:09:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "File edgedb/tests/dumps/dump01/1_0a4.dump added in #1846 (generated from the `releases/1.0a4` branch) fails to restore on 1.0a6.dev5102 with a fairly black box error:\r\n```\r\nsubprocess.CalledProcessError: Command '['edgedb', '--host', 'localhost', '--port', '58556', '--user', 'edgedb', '--password-from-stdin', '-d', 'TestDump01_1_0a4', 'restore', '/Users/ambv/Dropbox/Python/edgedb/tests/dumps/dump01/1_0a4.dump']' returned non-zero exit status 1\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1848/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1848/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1845", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1845/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1845/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1845/events", "html_url": "https://github.com/edgedb/edgedb/issues/1845", "id": 711749038, "node_id": "MDU6SXNzdWU3MTE3NDkwMzg=", "number": 1845, "title": "Various errors when using local_time, local_date, and others", "user": {"login": "Dhghomon", "id": 56599343, "node_id": "MDQ6VXNlcjU2NTk5MzQz", "avatar_url": "https://avatars.githubusercontent.com/u/56599343?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dhghomon", "html_url": "https://github.com/Dhghomon", "followers_url": "https://api.github.com/users/Dhghomon/followers", "following_url": "https://api.github.com/users/Dhghomon/following{/other_user}", "gists_url": "https://api.github.com/users/Dhghomon/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dhghomon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dhghomon/subscriptions", "organizations_url": "https://api.github.com/users/Dhghomon/orgs", "repos_url": "https://api.github.com/users/Dhghomon/repos", "events_url": "https://api.github.com/users/Dhghomon/events{/privacy}", "received_events_url": "https://api.github.com/users/Dhghomon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-09-30T08:35:41Z", "updated_at": "2022-03-22T23:49:54Z", "closed_at": "2020-10-07T15:13:50Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: Alpha 5\r\n- OS Version: Windows 10 (Ubuntu Windows subsystem)\r\n\r\nI originally assumed that local_time and local_date couldn't be subtracted to get a <datetime> (because it didn't work for me) but noticed that the documentation says it should work:\r\n\r\nhttps://www.edgedb.com/docs/edgeql/funcops/datetime\r\n\r\nSELECT <cal::local_date>'2020-09-09' - <cal::local_date>'2020-09-01';\r\nerror: operator '-' cannot be applied to operands of type 'cal::local_date' and 'cal::local_date'\r\n\r\nSELECT <cal::local_time>'12:09:09' - <cal::local_time>'10:09:09';\r\nerror: operator '-' cannot be applied to operands of type 'cal::local_time' and 'cal::local_time'\r\n\r\n\r\nOn top of this, a large number of code samples from the same page generate errors even when copied and pasted unchanged.\r\n\r\n**- ISO8601 format errors** \r\n\r\nThe first one is fixed by changing the format to ISO8601 but `1 day` is generates `Units bigger than days cannot be used for std::duration.`:\r\nSELECT <datetime>'January 01 2019 UTC' -\r\n  <duration>'1 day';\r\nERROR: InvalidValueError: invalid input syntax for type std::datetime: 'January 01 2019 UTC'\r\n  Hint: Please use ISO8601 format. Alternatively \"to_datetime\" function provides custom formatting options.\r\n\r\nSELECT <datetime>'January 01 2019 UTC' -\r\n <datetime>'January 02 2019 UTC';\r\nERROR: InvalidValueError: invalid input syntax for type std::datetime: 'January 01 2019 UTC'\r\n  Hint: Please use ISO8601 format. Alternatively \"to_datetime\" function provides custom formatting options.\r\nedgedb>                 \r\n\r\nSELECT to_datetime(\r\n  <cal::local_datetime>'January 1, 2019 12:00AM', 'HKT');\r\nERROR: InvalidValueError: invalid input syntax for type cal::local_datetime: 'January 1, 2019 12:00AM'\r\n  Hint: Please use ISO8601 format. Alternatively \"to_local_datetime\" function provides custom formatting options.\r\n\r\n SELECT cal::to_local_time(\r\n  <datetime>'December 31, 2018 10:00PM GMT+8', 'US/Pacific');\r\nERROR: InvalidValueError: invalid input syntax for type std::datetime: 'December 31, 2018 10:00PM GMT+8'\r\n  Hint: Please use ISO8601 format. Alternatively \"to_datetime\" function provides custom formatting options.\r\n\r\nSELECT cal::to_local_datetime(\r\n<datetime>'December 31, 2018 10:00PM GMT+8', 'US/Central');\r\nERROR: InvalidValueError: invalid input syntax for type std::datetime: 'December 31, 2018 10:00PM GMT+8'\r\n  Hint: Please use ISO8601 format. Alternatively \"to_datetime\" function provides custom formatting options.\r\n\r\n\r\n\r\n\r\n\r\n**- Say function does not exist but solved by adding `cal::`**\r\n\r\nSELECT time_get(\r\n  <cal::local_time>'15:01:22.306916', 'minutes');\r\nERROR: InvalidReferenceError: function 'time_get' does not exist\r\n(works as cal::time_get)\r\n\r\nSELECT to_local_date('2018-05-07');\r\n\r\nSELECT to_local_date('May 7th, 2018', 'Mon DDth, YYYY');\r\n\r\nSELECT to_local_date(2018, 5, 7);\r\n\r\n\r\n\r\n**- Say function does not exist, then generate ISO error after adding `cal::`**\r\n\r\n\r\nSELECT date_get(\r\n    <cal::local_date>'2018-05-07T15:01:22.306916',\r\n    'century');\r\nSELECT date_get(\r\n    <cal::local_date>'2018-05-07T15:01:22.306916',\r\n    'year');\r\nSELECT date_get(\r\n    <cal::local_date>'2018-05-07T15:01:22.306916',\r\n    'month');\r\nSELECT date_get(\r\n    <cal::local_date>'2018-05-07T15:01:22.306916',\r\n    'doy');\r\nSELECT to_local_date(\r\n  <datetime>'December 31, 2018 10:00PM GMT+8',\r\n  'US/Central');\r\n\r\n\r\n\r\n**Other errors:**\r\n\r\nSELECT to_datetime('May 7th, 2018 15:01:22 +00',\r\n               'Mon DDth, YYYY HH24:MI:SS, TZM');\r\nERROR: InvalidValueError: missing required time zone in format: 'Mon DDth, YYYY HH24:MI:SS, TZM'\r\n  Hint: Use one or both of the following: 'TZH', 'TZM'\r\n\r\n\r\nSELECT duration_to_seconds(<duration>'10 second 100 millis');\r\nERROR: InvalidValueError: invalid input syntax for type std::duration: \"10 second 100 millis\"", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1845/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1845/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1830", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1830/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1830/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1830/events", "html_url": "https://github.com/edgedb/edgedb/issues/1830", "id": 709775567, "node_id": "MDU6SXNzdWU3MDk3NzU1Njc=", "number": 1830, "title": "Opaque unions produced by naked backlinks aren't handled correctly in the schema", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-09-27T16:57:51Z", "updated_at": "2020-10-03T18:39:55Z", "closed_at": "2020-10-03T18:39:55Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Per report in #1824, the following schema produces `SchemaError: cannot get 'name' value: item '<uuid>' is not present in the schema`:\r\n\r\n```\r\nabstract type Action {\r\n   required link user -> User;\r\n}\r\n\r\ntype Post extending Action;\r\n\r\ntype User {\r\n  posts := .<user;\r\n}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1830/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1830/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1824", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1824/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1824/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1824/events", "html_url": "https://github.com/edgedb/edgedb/issues/1824", "id": 709517072, "node_id": "MDU6SXNzdWU3MDk1MTcwNzI=", "number": 1824, "title": "Backlinks don't work in computables when the link is defined in an abstract class", "user": {"login": "jonaird", "id": 2141154, "node_id": "MDQ6VXNlcjIxNDExNTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2141154?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonaird", "html_url": "https://github.com/jonaird", "followers_url": "https://api.github.com/users/jonaird/followers", "following_url": "https://api.github.com/users/jonaird/following{/other_user}", "gists_url": "https://api.github.com/users/jonaird/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonaird/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonaird/subscriptions", "organizations_url": "https://api.github.com/users/jonaird/orgs", "repos_url": "https://api.github.com/users/jonaird/repos", "events_url": "https://api.github.com/users/jonaird/events{/privacy}", "received_events_url": "https://api.github.com/users/jonaird/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-09-26T11:02:05Z", "updated_at": "2021-06-24T23:39:37Z", "closed_at": "2021-06-24T23:39:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: Alpha 5\r\n- OS Version: Mac OS 10.15.6\r\n\r\nSteps to Reproduce:\r\n\r\nCreate a schema where a computable link uses a backlink for a link defined in an abstract class\r\n\r\nFor example the following schema:\r\n```\r\nabstract type Action{\r\n    required property txid -> str{\r\n        constraint exclusive;\r\n    }\r\n    required property timestamp -> int32;\r\n    \r\n        required link user -> User;\r\n\r\n    \r\n}\r\n\r\ntype Post extending Action{\r\n  ...\r\n}\r\n\r\ntype User {\r\n  ...\r\n  posts := .<user[IS Post];\r\n}\r\n```\r\nproduces the error: `InternalServerError: reference to an undefined item default::Post@user in default::User@posts`\r\n\r\nIf I don't include the IS intersect, i.e.:\r\n```\r\ntype User {\r\n  ...\r\n  posts := .<user;\r\n}\r\n```\r\nI get the following error: `SchemaError: cannot get 'name' value: item '3b64a89d-50f4-e418-acaa-c19c327e41d9' is not present in the schema <Schema gen:4106 at 0x7f857a0be820>`\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1824/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1824/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1822", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1822/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1822/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1822/events", "html_url": "https://github.com/edgedb/edgedb/issues/1822", "id": 709359600, "node_id": "MDU6SXNzdWU3MDkzNTk2MDA=", "number": 1822, "title": "Incorrect factoring fence in a link property + type interesection case", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-09-25T23:57:08Z", "updated_at": "2021-08-12T17:39:57Z", "closed_at": "2021-08-12T17:39:57Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Currently, the following query would fail to compile:\r\n\r\n```\r\n    WITH\r\n      MODULE schema\r\n    SELECT Type {\r\n      multi bases_list :=\r\n        (SELECT Type[IS InheritingObject].bases {\r\n          id\r\n        } ORDER BY @index ASC).id\r\n\r\n    };\r\n```\r\n\r\nType intersections (`[IS Type]`) have `AT_MOST_ONE` cardinality, so we should forgo the refactoring fence enforcement on such paths if the immediate prefix of the intersection is visible above in the scope tree.\r\n\r\nI made an attempt to fix this earlier in 4495543a496c75d92f8b3a411df1510e7751964c, but evidently when the expression is a path prefix it's still present.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1822/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1822/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1820", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1820/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1820/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1820/events", "html_url": "https://github.com/edgedb/edgedb/issues/1820", "id": 708634908, "node_id": "MDU6SXNzdWU3MDg2MzQ5MDg=", "number": 1820, "title": "Path mismatch in shapes with prefix type intersection", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-09-25T04:39:51Z", "updated_at": "2021-10-22T23:59:15Z", "closed_at": "2021-10-22T23:59:14Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "In the following query, the `kind` computable turns into a set of _all_ `pointers` of a `Type` instead of a singleton matching the current pointer.\r\n\r\n```\r\nWITH\r\n  MODULE schema,\r\nSELECT Type {\r\n  name,\r\n  [IS ObjectType].pointers: {\r\n    name,\r\n    kind := 'link' IF Type[IS ObjectType].pointers IS Link\r\n            ELSE 'property',\r\n  },\r\n}\r\nFILTER .name = 'schema::Object';\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1820/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1820/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1812", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1812/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1812/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1812/events", "html_url": "https://github.com/edgedb/edgedb/issues/1812", "id": 708251496, "node_id": "MDU6SXNzdWU3MDgyNTE0OTY=", "number": 1812, "title": "InternalServerError: <Link 48b8eb51-fe77-11ea-bb24-0de48e5974e3 at 0x0x7ff9d977dc10>", "user": {"login": "isidentical", "id": 47358913, "node_id": "MDQ6VXNlcjQ3MzU4OTEz", "avatar_url": "https://avatars.githubusercontent.com/u/47358913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/isidentical", "html_url": "https://github.com/isidentical", "followers_url": "https://api.github.com/users/isidentical/followers", "following_url": "https://api.github.com/users/isidentical/following{/other_user}", "gists_url": "https://api.github.com/users/isidentical/gists{/gist_id}", "starred_url": "https://api.github.com/users/isidentical/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/isidentical/subscriptions", "organizations_url": "https://api.github.com/users/isidentical/orgs", "repos_url": "https://api.github.com/users/isidentical/repos", "events_url": "https://api.github.com/users/isidentical/events{/privacy}", "received_events_url": "https://api.github.com/users/isidentical/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-09-24T15:05:46Z", "updated_at": "2020-09-25T16:20:52Z", "closed_at": "2020-09-25T16:20:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\nasttests> SELECT array_agg((SELECT ast::Dict {keys} FILTER count(.keys) = 2 LIMIT 1).keys);\r\nERROR: InternalServerError: <Link 48b8eb51-fe77-11ea-bb24-0de48e5974e3 at 0x0x7ff9d977dc10>\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/procpool/worker.py\", line 75, in worker\r\n          res = await meth(*args)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 1795, in compile_eql_tokens\r\n          return self._compile(ctx=ctx, tokens=eql_tokens)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 1429, in _compile\r\n          comp: dbstate.BaseQuery = self._compile_dispatch_ql(ctx, stmt)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 1392, in _compile_dispatch_ql\r\n          return self._compile_ql_query(ctx, ql)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 628, in _compile_ql_query\r\n          out_type_data, out_type_id = sertypes.TypeSerializer.describe(\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/compiler/sertypes.py\", line 335, in describe\r\n          type_id = builder._describe_type(\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/compiler/sertypes.py\", line 172, in _describe_type\r\n          subtypes = [self._describe_type(st, view_shapes,\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/compiler/sertypes.py\", line 172, in <listcomp>\r\n          subtypes = [self._describe_type(st, view_shapes,\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/compiler/sertypes.py\", line 238, in _describe_type\r\n          for ptr in view_shapes[t_rptr]:\r\n      KeyError: <Link 48b8eb51-fe77-11ea-bb24-0de48e5974e3 at 0x0x7f0c72013970>\r\nasttests> SELECT ast::Dict {keys} FILTER count(.keys) = 2 LIMIT 1;\r\n{Object {keys: {Object {id: 4b71ae19-fda8-11ea-8708-23c2efedd44c}, Object {id: 4b71ae1a-fda8-11ea-8708-efc8c882bd87}}}}\r\nasttests> \r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1812/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1812/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1801", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1801/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1801/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1801/events", "html_url": "https://github.com/edgedb/edgedb/issues/1801", "id": 705808802, "node_id": "MDU6SXNzdWU3MDU4MDg4MDI=", "number": 1801, "title": "edb.errors.InternalServerError: bind message supplies 2 parameters, but prepared statement \"\" requires 1", "user": {"login": "isidentical", "id": 47358913, "node_id": "MDQ6VXNlcjQ3MzU4OTEz", "avatar_url": "https://avatars.githubusercontent.com/u/47358913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/isidentical", "html_url": "https://github.com/isidentical", "followers_url": "https://api.github.com/users/isidentical/followers", "following_url": "https://api.github.com/users/isidentical/following{/other_user}", "gists_url": "https://api.github.com/users/isidentical/gists{/gist_id}", "starred_url": "https://api.github.com/users/isidentical/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/isidentical/subscriptions", "organizations_url": "https://api.github.com/users/isidentical/orgs", "repos_url": "https://api.github.com/users/isidentical/repos", "events_url": "https://api.github.com/users/isidentical/events{/privacy}", "received_events_url": "https://api.github.com/users/isidentical/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 3146162375, "node_id": "MDU6TGFiZWwzMTQ2MTYyMzc1", "url": "https://api.github.com/repos/edgedb/edgedb/labels/compiler", "name": "compiler", "color": "EB8B2B", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2020-09-21T18:07:31Z", "updated_at": "2022-10-10T23:15:45Z", "closed_at": "2022-10-10T23:15:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\nSTART MIGRATION TO {\r\n    module default {\r\n        type Movie {\r\n            required property title -> str;\r\n            multi link actors -> Person {\r\n                property index -> int64;\r\n            };\r\n        }\r\n        type Person {\r\n            required property first_name -> str;\r\n            required property last_name -> str;\r\n        }\r\n    }\r\n};\r\n```\r\n```\r\ntutorial> INSERT Movie {\r\n.........     title := \"demo\",\r\n.........     actors := {\r\n.........         (SELECT Person LIMIT 1){index := 0}\r\n.........     }\r\n......... };\r\nERROR: InternalServerError: bind message supplies 2 parameters, but prepared statement \"\" requires 1\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: bind message supplies 2 parameters, but prepared statement \"\" requires 1\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1801/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1801/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1800", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1800/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1800/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1800/events", "html_url": "https://github.com/edgedb/edgedb/issues/1800", "id": 705607446, "node_id": "MDU6SXNzdWU3MDU2MDc0NDY=", "number": 1800, "title": "[GraphQL] Inline fragments don't work when requesting nested properties", "user": {"login": "jonaird", "id": 2141154, "node_id": "MDQ6VXNlcjIxNDExNTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2141154?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonaird", "html_url": "https://github.com/jonaird", "followers_url": "https://api.github.com/users/jonaird/followers", "following_url": "https://api.github.com/users/jonaird/following{/other_user}", "gists_url": "https://api.github.com/users/jonaird/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonaird/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonaird/subscriptions", "organizations_url": "https://api.github.com/users/jonaird/orgs", "repos_url": "https://api.github.com/users/jonaird/repos", "events_url": "https://api.github.com/users/jonaird/events{/privacy}", "received_events_url": "https://api.github.com/users/jonaird/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1284200502, "node_id": "MDU6TGFiZWwxMjg0MjAwNTAy", "url": "https://api.github.com/repos/edgedb/edgedb/labels/graphql", "name": "graphql", "color": "c2b0f4", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-09-21T13:39:19Z", "updated_at": "2021-06-30T16:08:54Z", "closed_at": "2021-06-30T16:08:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1-alpha 5\r\n- OS Version: OSX 10.15.6\r\n\r\nSteps to Reproduce:\r\nTrying something like the following:\r\n```\r\nquery {\r\n    Superclass{\r\n      ... on Subclass{\r\n         property, #works fine\r\n         aLink{\r\n            nestedProperty #causes error\r\n         }\r\n      }\r\n    }\r\n}\r\n```\r\nI get the error `\"InvalidReferenceError: object type 'default::Sublcass' has no link or property 'nestedProperty'\"`\r\n\r\nInstead it should be getting the property from the linked object.\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n\r\n```\r\nabstract type Action{\r\n    required property txid -> str{\r\n        constraint exclusive;\r\n    }\r\n    required property timestamp -> int32;\r\n}\r\n\r\ntype User{\r\n    required property publicKey -> str{\r\n        constraint exclusive;\r\n    }\r\n    required property paymail -> str;\r\n    property moneyButtonId -> int32{\r\n        constraint exclusive;\r\n    }\r\n\r\n    property amountEarned := (\r\n        sum(.<user[IS Content].voteTotal)\r\n    );\r\n\r\n    property metaname -> str;\r\n    property bsvnewsname -> str;\r\n    property displayName := .metaname??.bsvnewsname;\r\n}\r\n\r\nabstract type Content extending Action {\r\n    required property voteAddress -> str;\r\n    required link user -> User;\r\n    multi link votes -> Vote;\r\n    property voteTotal := sum(.votes.voteAmount);\r\n    multi link comments -> Comment;\r\n    \r\n}\r\n\r\ntype Post extending Content { \r\n    required property title -> str;\r\n    required property url -> str;\r\n    property description -> str;\r\n\r\n    property hotness := (\r\n        .voteTotal/(datetime_get(datetime_current(), 'epochseconds')-.timestamp)\r\n    );\r\n\r\n    property numComments := \r\n        count(.<rootPost[IS Comment])\r\n    ;\r\n    \r\n}\r\n\r\ntype Comment extending Content{\r\n    required property body -> str;\r\n    required link rootPost -> Post;\r\n}\r\n\r\ntype Vote extending Action{\r\n    required property voteAmount -> int32;\r\n    required link user -> User;\r\n   \r\n}\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1800/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1800/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1792", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1792/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1792/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1792/events", "html_url": "https://github.com/edgedb/edgedb/issues/1792", "id": 704591909, "node_id": "MDU6SXNzdWU3MDQ1OTE5MDk=", "number": 1792, "title": "Possible protocol error triggered by tests", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-09-18T19:02:52Z", "updated_at": "2020-10-19T18:47:55Z", "closed_at": "2020-10-19T18:47:55Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This happens in the https://github.com/edgedb/edgedb/tree/migtests branch.\r\n\r\nSteps to Reproduce:\r\n\r\n`EDGEDB_DEBUG_SERVER=1 edb test -k test_edgeql_migration_eq_`\r\n\r\nAfter running about 50 tests or so the test suite crashes with:\r\n```\r\nmultiprocessing.pool.RemoteTraceback: \r\n\"\"\"\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.8/multiprocessing/pool.py\", line 125, in worker\r\n    result = (True, func(*args, **kwds))\r\n  File \"/usr/lib/python3.8/multiprocessing/pool.py\", line 48, in mapstar\r\n    return list(map(*args))\r\n  File \"/home/victor/dev/magicstack/edgedb/edb/tools/test/runner.py\", line 144, in _run_test\r\n    suite.run(test, result)\r\n  File \"/home/victor/dev/magicstack/edgedb/edb/tools/test/runner.py\", line 109, in run\r\n    self._run(test, result)\r\n  File \"/home/victor/dev/magicstack/edgedb/edb/tools/test/runner.py\", line 129, in _run\r\n    test.run(result)\r\n  File \"/usr/lib/python3.8/unittest/case.py\", line 684, in run\r\n    self._feedErrorsToResult(result, outcome.errors)\r\n  File \"/usr/lib/python3.8/unittest/case.py\", line 602, in _feedErrorsToResult\r\n    result.addError(test, exc_info)\r\n  File \"/home/victor/dev/magicstack/edgedb/edb/tools/test/runner.py\", line 168, in _wrapper\r\n    self._queue.put((meth, args, kwargs))\r\n  File \"/usr/lib/python3.8/multiprocessing/queues.py\", line 362, in put\r\n    obj = _ForkingPickler.dumps(obj)\r\n  File \"/usr/lib/python3.8/multiprocessing/reduction.py\", line 51, in dumps\r\n    cls(buf, protocol).dump(obj)\r\n  File \"stringsource\", line 2, in edgedb.pgproto.pgproto.ReadBuffer.__reduce_cython__\r\nTypeError: no default __reduce__ due to non-trivial __cinit__\r\n\"\"\"\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/victor/dev/venvs/edgedb/bin/edb\", line 33, in <module>\r\n    sys.exit(load_entry_point('edgedb-server', 'console_scripts', 'edb')())\r\n  File \"/home/victor/dev/venvs/edgedb/lib/python3.8/site-packages/click/core.py\", line 829, in __call__\r\n    return self.main(*args, **kwargs)\r\n  File \"/home/victor/dev/venvs/edgedb/lib/python3.8/site-packages/click/core.py\", line 782, in main\r\n    rv = self.invoke(ctx)\r\n  File \"/home/victor/dev/venvs/edgedb/lib/python3.8/site-packages/click/core.py\", line 1259, in invoke\r\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\r\n  File \"/home/victor/dev/venvs/edgedb/lib/python3.8/site-packages/click/core.py\", line 1066, in invoke\r\n    return ctx.invoke(self.callback, **ctx.params)\r\n  File \"/home/victor/dev/venvs/edgedb/lib/python3.8/site-packages/click/core.py\", line 610, in invoke\r\n    return callback(*args, **kwargs)\r\n  File \"/home/victor/dev/magicstack/edgedb/edb/tools/test/__init__.py\", line 153, in test\r\n    result = run()\r\n  File \"/home/victor/dev/magicstack/edgedb/edb/tools/test/__init__.py\", line 265, in _run\r\n    result = test_runner.run(suite)\r\n  File \"/home/victor/dev/magicstack/edgedb/edb/tools/test/runner.py\", line 798, in run\r\n    suite.run(result)\r\n  File \"/home/victor/dev/magicstack/edgedb/edb/tools/test/runner.py\", line 262, in run\r\n    ar.get(timeout=0.1)\r\n  File \"/usr/lib/python3.8/multiprocessing/pool.py\", line 771, in get\r\n    raise self._value\r\nTypeError: no default __reduce__ due to non-trivial __cinit__\r\n```\r\n\r\nPrinting out the `error_text` gets some additional insight as to what actually went wrong: https://github.com/edgedb/edgedb/blob/fa1b42a938141839316366d396e20c9d7c9123f0/edb/tools/test/runner.py#L163-L166 \r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/victor/dev/magicstack/edgedb/tests/test_edgeql_data_migration.py\", line 103, in migrate\r\n    await self.con.execute(f\"\"\"\r\n  File \"/home/victor/dev/magicstack/edgedb-python/edgedb/asyncio_con.py\", line 166, in execute\r\n    await self._protocol.simple_query(query)\r\n  File \"edgedb/protocol/protocol.pyx\", line 498, in simple_query\r\nedgedb.errors.InternalServerError: unexpected message type '3'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/victor/dev/magicstack/edgedb/edb/testbase/server.py\", line 110, in wrapper\r\n    self.loop.run_until_complete(\r\n  File \"/usr/lib/python3.8/asyncio/base_events.py\", line 616, in run_until_complete\r\n    return future.result()\r\n  File \"/home/victor/dev/magicstack/edgedb/tests/test_edgeql_data_migration.py\", line 6027, in test_edgeql_migration_eq_collections_18\r\n    await self.migrate(r\"\"\"\r\n  File \"/home/victor/dev/magicstack/edgedb/tests/test_edgeql_data_migration.py\", line 103, in migrate\r\n    await self.con.execute(f\"\"\"\r\n  File \"/home/victor/dev/magicstack/edgedb-python/edgedb/transaction.py\", line 211, in __aexit__\r\n    await self.__rollback()\r\n  File \"/home/victor/dev/magicstack/edgedb-python/edgedb/transaction.py\", line 242, in __rollback\r\n    await self._connection.execute(query)\r\n  File \"/home/victor/dev/magicstack/edgedb-python/edgedb/asyncio_con.py\", line 166, in execute\r\n    await self._protocol.simple_query(query)\r\n  File \"edgedb/protocol/protocol.pyx\", line 498, in simple_query\r\nedgedb.errors.TransactionError: savepoints can only be used in transaction blocks\r\n```\r\n\r\nNote, `EDGEDB_DEBUG_SERVER=1 edb test -j1 -k test_edgeql_migration_eq_` ultimately results in an error around the same point in tests as well. The error still seems to be triggered by `edgedb.errors.InternalServerError: unexpected message type '3'`, but it manifests a bit differently after that.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1792/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1792/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1790", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1790/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1790/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1790/events", "html_url": "https://github.com/edgedb/edgedb/issues/1790", "id": 704515433, "node_id": "MDU6SXNzdWU3MDQ1MTU0MzM=", "number": 1790, "title": "Prohibit inheriting scalar types from more than one non-abstract scalar type", "user": {"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-09-18T16:43:29Z", "updated_at": "2020-11-11T06:43:03Z", "closed_at": "2020-11-11T06:43:03Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Currently:\r\n\r\n```\r\nselect> CREATE SCALAR TYPE test::myint EXTENDING std::int64, std::str;\r\nOK: CREATE\r\n```\r\n\r\nWe have to prohibit this by enforcing that there must be exactly one base non-abstract scalar type in the ancestry of a new non-abstract scalar type.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1790/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1790/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1788", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1788/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1788/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1788/events", "html_url": "https://github.com/edgedb/edgedb/issues/1788", "id": 704089378, "node_id": "MDU6SXNzdWU3MDQwODkzNzg=", "number": 1788, "title": "ISE: AssertionError", "user": {"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-09-18T05:11:44Z", "updated_at": "2020-09-19T05:58:53Z", "closed_at": "2020-09-19T05:58:53Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "The query is obviously wrong but it should fail with a proper error:\r\n\r\n```\r\nSELECT schema::ObjectType {\r\n      name,\r\n      is_abstract: {\r\n        name,\r\n      } ORDER BY @index ASC,\r\n} FILTER .name = 'sys::Role';\r\n```\r\n\r\nCurrently fails with \r\n\r\n```\r\nERROR: InternalServerError:\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/Users/yury/dev/edge/edgedb/edb/server/procpool/worker.py\", line 75, in worker\r\n          res = await meth(*args)\r\n        File \"/Users/yury/dev/edge/edgedb/edb/server/compiler/compiler.py\", line 1795, in compile_eql_tokens\r\n          return self._compile(ctx=ctx, tokens=eql_tokens)\r\n        File \"/Users/yury/dev/edge/edgedb/edb/server/compiler/compiler.py\", line 1429, in _compile\r\n          comp: dbstate.BaseQuery = self._compile_dispatch_ql(ctx, stmt)\r\n        File \"/Users/yury/dev/edge/edgedb/edb/server/compiler/compiler.py\", line 1392, in _compile_dispatch_ql\r\n          return self._compile_ql_query(ctx, ql)\r\n        File \"/Users/yury/dev/edge/edgedb/edb/server/compiler/compiler.py\", line 592, in _compile_ql_query\r\n          ir = qlcompiler.compile_ast_to_ir(\r\n        File \"/Users/yury/dev/edge/edgedb/edb/edgeql/compiler/__init__.py\", line 175, in wrapper\r\n          return func(*args, **kwargs)\r\n        File \"/Users/yury/dev/edge/edgedb/edb/edgeql/compiler/__init__.py\", line 223, in compile_ast_to_ir\r\n          ir_set = dispatch_mod.compile(tree, ctx=ctx)\r\n        File \"/opt/local/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/functools.py\", line 874, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/Users/yury/dev/edge/edgedb/edb/edgeql/compiler/stmt.py\", line 84, in compile_SelectQuery\r\n          stmt.result = compile_result_clause(\r\n        File \"/Users/yury/dev/edge/edgedb/edb/edgeql/compiler/stmt.py\", line 1017, in compile_result_clause\r\n          ir_result = compile_query_subject(\r\n        File \"/Users/yury/dev/edge/edgedb/edb/edgeql/compiler/stmt.py\", line 1097, in compile_query_subject\r\n          view_scls = viewgen.process_view(\r\n        File \"/Users/yury/dev/edge/edgedb/edb/edgeql/compiler/viewgen.py\", line 86, in process_view\r\n          view_scls = _process_view(\r\n        File \"/Users/yury/dev/edge/edgedb/edb/edgeql/compiler/viewgen.py\", line 173, in _process_view\r\n          pointer = _normalize_view_ptr_expr(\r\n        File \"/Users/yury/dev/edge/edgedb/edb/edgeql/compiler/viewgen.py\", line 549, in _normalize_view_ptr_expr\r\n          ptr_target = _process_view(\r\n        File \"/Users/yury/dev/edge/edgedb/edb/edgeql/compiler/viewgen.py\", line 160, in _process_view\r\n          assert isinstance(view_scls, s_objtypes.ObjectType)\r\n      AssertionError\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1788/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1788/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1769", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1769/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1769/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1769/events", "html_url": "https://github.com/edgedb/edgedb/issues/1769", "id": 700536986, "node_id": "MDU6SXNzdWU3MDA1MzY5ODY=", "number": 1769, "title": "Extreme datetime arithmetic crashes the interactive tutorial", "user": {"login": "CodesInChaos", "id": 320473, "node_id": "MDQ6VXNlcjMyMDQ3Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/320473?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CodesInChaos", "html_url": "https://github.com/CodesInChaos", "followers_url": "https://api.github.com/users/CodesInChaos/followers", "following_url": "https://api.github.com/users/CodesInChaos/following{/other_user}", "gists_url": "https://api.github.com/users/CodesInChaos/gists{/gist_id}", "starred_url": "https://api.github.com/users/CodesInChaos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CodesInChaos/subscriptions", "organizations_url": "https://api.github.com/users/CodesInChaos/orgs", "repos_url": "https://api.github.com/users/CodesInChaos/repos", "events_url": "https://api.github.com/users/CodesInChaos/events{/privacy}", "received_events_url": "https://api.github.com/users/CodesInChaos/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "jaclarke", "id": 2085287, "node_id": "MDQ6VXNlcjIwODUyODc=", "avatar_url": "https://avatars.githubusercontent.com/u/2085287?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaclarke", "html_url": "https://github.com/jaclarke", "followers_url": "https://api.github.com/users/jaclarke/followers", "following_url": "https://api.github.com/users/jaclarke/following{/other_user}", "gists_url": "https://api.github.com/users/jaclarke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaclarke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaclarke/subscriptions", "organizations_url": "https://api.github.com/users/jaclarke/orgs", "repos_url": "https://api.github.com/users/jaclarke/repos", "events_url": "https://api.github.com/users/jaclarke/events{/privacy}", "received_events_url": "https://api.github.com/users/jaclarke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jaclarke", "id": 2085287, "node_id": "MDQ6VXNlcjIwODUyODc=", "avatar_url": "https://avatars.githubusercontent.com/u/2085287?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaclarke", "html_url": "https://github.com/jaclarke", "followers_url": "https://api.github.com/users/jaclarke/followers", "following_url": "https://api.github.com/users/jaclarke/following{/other_user}", "gists_url": "https://api.github.com/users/jaclarke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaclarke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaclarke/subscriptions", "organizations_url": "https://api.github.com/users/jaclarke/orgs", "repos_url": "https://api.github.com/users/jaclarke/repos", "events_url": "https://api.github.com/users/jaclarke/events{/privacy}", "received_events_url": "https://api.github.com/users/jaclarke/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-09-13T09:53:55Z", "updated_at": "2020-10-08T21:19:28Z", "closed_at": "2020-10-08T21:19:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "EdgeDB Version: Interactive Tutorial\r\n\r\nSteps to Reproduce:\r\n\r\nExecute\r\n\r\n```\r\nSELECT <cal::local_datetime>'9999-12-31T00:00:00' + <duration>'2000000000 hour' + <duration>'400000000 hour';\r\n```\r\n\r\nin the interactive tutorial. The backend appears to return a normal response, but the whole frontend crashes with \"An unexpected error has occurred\".", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1769/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1769/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1766", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1766/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1766/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1766/events", "html_url": "https://github.com/edgedb/edgedb/issues/1766", "id": 700373531, "node_id": "MDU6SXNzdWU3MDAzNzM1MzE=", "number": 1766, "title": "ERROR: InternalServerError: ObjectRef expected (got type 'AnyType')", "user": {"login": "isidentical", "id": 47358913, "node_id": "MDQ6VXNlcjQ3MzU4OTEz", "avatar_url": "https://avatars.githubusercontent.com/u/47358913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/isidentical", "html_url": "https://github.com/isidentical", "followers_url": "https://api.github.com/users/isidentical/followers", "following_url": "https://api.github.com/users/isidentical/following{/other_user}", "gists_url": "https://api.github.com/users/isidentical/gists{/gist_id}", "starred_url": "https://api.github.com/users/isidentical/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/isidentical/subscriptions", "organizations_url": "https://api.github.com/users/isidentical/orgs", "repos_url": "https://api.github.com/users/isidentical/repos", "events_url": "https://api.github.com/users/isidentical/events{/privacy}", "received_events_url": "https://api.github.com/users/isidentical/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-09-12T20:53:49Z", "updated_at": "2021-12-09T00:57:23Z", "closed_at": "2021-12-09T00:57:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: edgedb-cli 1.0.0-alpha.5\r\n- OS Version: Standard Linux\r\n\r\nSteps to Reproduce:\r\n\r\n1. Create a migration like this (where a field has the type of `anytype`);\r\n```\r\nSTART MIGRATION TO {\r\n    module default {\r\n        type ObjectX {\r\n            required property value -> anytype;\r\n        }\r\n    }\r\n};\r\nPOPULATE MIGRATION;\r\nCOMMIT MIGRATION;\r\n```\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n```traceback\r\nERROR: InternalServerError: ObjectRef expected (got type 'AnyType')\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/procpool/worker.py\", line 75, in worker\r\n          res = await meth(*args)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 1795, in compile_eql_tokens\r\n          return self._compile(ctx=ctx, tokens=eql_tokens)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 1429, in _compile\r\n          comp: dbstate.BaseQuery = self._compile_dispatch_ql(ctx, stmt)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 1352, in _compile_dispatch_ql\r\n          return self._compile_ql_migration(ctx, ql)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 789, in _compile_ql_migration\r\n          target_schema = s_ddl.apply_sdl(\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/schema/ddl.py\", line 346, in apply_sdl\r\n          ddl_stmts = s_decl.sdl_to_ddl(current_schema, documents)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/edgeql/declarative.py\", line 209, in sdl_to_ddl\r\n          trace_layout(decl_ast, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/functools.py\", line 875, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/edgeql/declarative.py\", line 266, in trace_layout_CreateObjectType\r\n          _trace_item_layout(node, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/edgeql/declarative.py\", line 325, in _trace_item_layout\r\n          target = _resolve_type_expr(decl.target, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/edgeql/declarative.py\", line 747, in _resolve_type_expr\r\n          refname = ctx.get_ref_name(texpr.maintype)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/edgeql/declarative.py\", line 105, in get_ref_name\r\n          raise TypeError(\r\n      TypeError: ObjectRef expected (got type 'AnyType')\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1766/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1766/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1751", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1751/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1751/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1751/events", "html_url": "https://github.com/edgedb/edgedb/issues/1751", "id": 694015614, "node_id": "MDU6SXNzdWU2OTQwMTU2MTQ=", "number": 1751, "title": "MULTI links and properties don't always enforce REQUIRED qualifier.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-09-05T06:38:37Z", "updated_at": "2021-10-23T00:14:07Z", "closed_at": "2021-10-23T00:13:37Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nCREATE TYPE test::Base {\r\n    CREATE REQUIRED MULTI PROPERTY name -> str;\r\n};\r\n# Explicit empty set doesn't trigger and error.\r\nINSERT test::Base {name := {}};\r\n```\r\n\r\nSee `test_edgeql_ddl_required_10` and `test_edgeql_ddl_required_11`.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1751/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1751/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1743", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1743/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1743/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1743/events", "html_url": "https://github.com/edgedb/edgedb/issues/1743", "id": 691554979, "node_id": "MDU6SXNzdWU2OTE1NTQ5Nzk=", "number": 1743, "title": "Insert-or-select fails when it's combined with a shape.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-09-03T01:33:50Z", "updated_at": "2020-09-16T00:43:18Z", "closed_at": "2020-09-16T00:43:18Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: EdgeDB 1.0-alpha.6+dev.5050.gb8aa1c99\r\n- OS Version: Linux\r\n\r\nSteps to Reproduce:\r\n```\r\nCREATE TYPE default::Foo {\r\n    CREATE OPTIONAL SINGLE PROPERTY name -> std::str {\r\n        CREATE CONSTRAINT std::exclusive;\r\n    };\r\n};\r\nCREATE TYPE default::Bar {\r\n    CREATE REQUIRED SINGLE LINK foo -> default::Foo;\r\n};\r\nINSERT Foo {name := 'foo0'};\r\n```\r\nThen the following happens:\r\n```\r\nvictor> SELECT (INSERT Bar {foo := (INSERT Foo {name := 'foo0'} UNLESS CONFLICT ON .name ELSE (SELECT Foo))}) {id};\r\n{Object {id: 948f4c8e-ed81-11ea-955a-5b32015497c5}}\r\nvictor> SELECT (INSERT Bar {foo := (INSERT Foo {name := 'foo0'} UNLESS CONFLICT ON .name ELSE (SELECT Foo))}) {id, foo};\r\nERROR: InternalServerError: more than one row returned by a subquery used as an expression\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: more than one row returned by a subquery used as an expression\r\n```\r\nSo it's not that the cardinality check fails, it's that the SQL causes an effect similar to a cardinality problem if foo is included in the final shape to be returned.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1743/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1743/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1729", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1729/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1729/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1729/events", "html_url": "https://github.com/edgedb/edgedb/issues/1729", "id": 688553627, "node_id": "MDU6SXNzdWU2ODg1NTM2Mjc=", "number": 1729, "title": "Problems after dropping `edgedb` database", "user": {"login": "CodesInChaos", "id": 320473, "node_id": "MDQ6VXNlcjMyMDQ3Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/320473?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CodesInChaos", "html_url": "https://github.com/CodesInChaos", "followers_url": "https://api.github.com/users/CodesInChaos/followers", "following_url": "https://api.github.com/users/CodesInChaos/following{/other_user}", "gists_url": "https://api.github.com/users/CodesInChaos/gists{/gist_id}", "starred_url": "https://api.github.com/users/CodesInChaos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CodesInChaos/subscriptions", "organizations_url": "https://api.github.com/users/CodesInChaos/orgs", "repos_url": "https://api.github.com/users/CodesInChaos/repos", "events_url": "https://api.github.com/users/CodesInChaos/events{/privacy}", "received_events_url": "https://api.github.com/users/CodesInChaos/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-08-29T15:30:58Z", "updated_at": "2020-09-01T17:44:55Z", "closed_at": "2020-09-01T17:44:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "After `drop database edgedb`, I can't recreate it because it supposedly already exists. However I can't connect to it either. And after stopping the server, I can't start it again.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1729/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1729/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1721", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1721/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1721/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1721/events", "html_url": "https://github.com/edgedb/edgedb/issues/1721", "id": 688243492, "node_id": "MDU6SXNzdWU2ODgyNDM0OTI=", "number": 1721, "title": "Incorrect code generated for nested inserts from a default", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-08-28T17:38:28Z", "updated_at": "2020-09-01T21:58:33Z", "closed_at": "2020-09-01T21:58:33Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Per @vpetrovykh:\r\n\r\n```\r\nEdgeDB 1.0-alpha.6+dev.5035.g8a51fcae\r\nType \"\\?\" for help.\r\nvictor> create module test;\r\nOK: CREATE\r\nvictor>             CREATE TYPE test::TestDefaultInsert03;\r\n....... \r\n.......             CREATE TYPE test::TestDefault03 {\r\n.......                 CREATE LINK def03 -> test::TestDefaultInsert03 {\r\n.......                     SET default := (INSERT test::TestDefaultInsert03);\r\n.......                 };\r\n.......             };\r\nOK: CREATE\r\nOK: CREATE\r\nvictor> INSERT test::TestDefault03;\r\n{Object {id: 978c6de2-e951-11ea-92ce-77bf9238bc18, def03: Object {id: 978c7242-e951-11ea-92ce-e7bd34764008}}}\r\nvictor> SELECT test::TestDefaultInsert03;\r\n{Object {id: 978c19f0-e951-11ea-92ce-cfa17b564165}, Object {id: 978c7242-e951-11ea-92ce-e7bd34764008}}\r\n```\r\n\r\n\r\nNote: this only happens when `output_format` is not `SCRIPT` (i.e. in `query()`, not `execute()`).", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1721/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1721/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1715", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1715/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1715/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1715/events", "html_url": "https://github.com/edgedb/edgedb/issues/1715", "id": 687869590, "node_id": "MDU6SXNzdWU2ODc4Njk1OTA=", "number": 1715, "title": "migration defining a function crashes with \"InternalServerError: list index out of range\"", "user": {"login": "CodesInChaos", "id": 320473, "node_id": "MDQ6VXNlcjMyMDQ3Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/320473?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CodesInChaos", "html_url": "https://github.com/CodesInChaos", "followers_url": "https://api.github.com/users/CodesInChaos/followers", "following_url": "https://api.github.com/users/CodesInChaos/following{/other_user}", "gists_url": "https://api.github.com/users/CodesInChaos/gists{/gist_id}", "starred_url": "https://api.github.com/users/CodesInChaos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CodesInChaos/subscriptions", "organizations_url": "https://api.github.com/users/CodesInChaos/orgs", "repos_url": "https://api.github.com/users/CodesInChaos/repos", "events_url": "https://api.github.com/users/CodesInChaos/events{/privacy}", "received_events_url": "https://api.github.com/users/CodesInChaos/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-08-28T07:26:04Z", "updated_at": "2020-08-30T21:30:51Z", "closed_at": "2020-08-30T21:30:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: alpha5\r\n- OS Version: ubuntu 20\r\n\r\nRun the following migration:\r\n```\r\nSTART MIGRATION TO {\r\nmodule default {\r\n\tfunction canonicalize_name(s:str) -> str\r\n\t\tusing (s);\r\n}\r\n};\r\nPOPULATE MIGRATION;\r\nCOMMIT MIGRATION;\r\n```\r\n\r\nit crashes with:\r\n\r\n> ERROR: InternalServerError: list index out of range\r\n>   Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n>   Server traceback:\r\n>       Traceback (most recent call last):\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/pgsql/compiler/__init__.py\", line 83, in compile_ir_to_sql_tree\r\n>           qtree = dispatch.compile(ir_expr, ctx=ctx)\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/functools.py\", line 875, in wrapper\r\n>           return dispatch(args[0].__class__)(*args, **kw)\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/pgsql/compiler/expr.py\", line 67, in compile_Set\r\n>           return output.top_output_as_value(ctx.rel, ir_set, env=ctx.env)\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/pgsql/compiler/output.py\", line 684, in top_output_as_value\r\n>           arg=stmt.target_list[0].val,\r\n>       IndexError: list index out of range\r\n>       \r\n>       The above exception was the direct cause of the following exception:\r\n>       \r\n>       Traceback (most recent call last):\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/procpool/worker.py\", line 75, in worker\r\n>           res = await meth(*args)\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 1816, in compile_eql_tokens_in_tx\r\n>           return self._compile(ctx=ctx, tokens=eql_tokens)\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 1429, in _compile\r\n>           comp: dbstate.BaseQuery = self._compile_dispatch_ql(ctx, stmt)\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 1352, in _compile_dispatch_ql\r\n>           return self._compile_ql_migration(ctx, ql)\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 1047, in _compile_ql_migration\r\n>           ddl_query = self._compile_and_apply_ddl_stmt(\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 752, in _compile_and_apply_ddl_stmt\r\n>           block, new_types = self._process_delta(ctx, delta)\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 412, in _process_delta\r\n>           schema = delta.apply(schema, context)\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/pgsql/delta.py\", line 4027, in apply\r\n>           schema = sd.DeltaRoot.apply(self, schema, context)\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/schema/delta.py\", line 1094, in apply\r\n>           schema = objop.apply(schema, context)\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/pgsql/delta.py\", line 194, in apply\r\n>           schema = self.__class__.get_adaptee().apply(self, schema, context)\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/schema/delta.py\", line 2037, in apply\r\n>           schema = self._create_innards(schema, context)\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/schema/delta.py\", line 2005, in _create_innards\r\n>           schema = op.apply(schema, context=context)\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/pgsql/delta.py\", line 595, in apply\r\n>           schema, op = self.make_op(self.scls, schema, context)\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/pgsql/delta.py\", line 575, in make_op\r\n>           dbf = self.compile_edgeql_function(func, schema, context)\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/pgsql/delta.py\", line 546, in compile_edgeql_function\r\n>           sql_text, _ = compiler.compile_ir_to_sql(\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/pgsql/compiler/__init__.py\", line 105, in compile_ir_to_sql\r\n>           qtree = compile_ir_to_sql_tree(\r\n>         File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha5/lib/python3.8/site-packages/edb/pgsql/compiler/__init__.py\", line 90, in compile_ir_to_sql_tree\r\n>           raise errors.InternalServerError(*args) from e\r\n>       edb.errors.InternalServerError: list index out of range", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1715/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1715/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1704", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1704/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1704/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1704/events", "html_url": "https://github.com/edgedb/edgedb/issues/1704", "id": 686881337, "node_id": "MDU6SXNzdWU2ODY4ODEzMzc=", "number": 1704, "title": "Omitting `__subject__` in constraints on object types fails.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-08-27T02:08:25Z", "updated_at": "2020-09-15T23:49:29Z", "closed_at": "2020-09-15T23:49:29Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Steps to Reproduce:\r\n\r\n```\r\nEdgeDB 1.0-alpha.4+dev.145.g4d9ce642\r\nType \"\\?\" for help.\r\nvictor> \r\nvictor> \r\nvictor> create type Vector {\r\n.......     create required property x -> float64;\r\n.......     create required property y -> float64;\r\n....... };\r\nOK: CREATE\r\nvictor> alter type Vector { create constraint expression on (.x^2 + .y^2 < 25) };\r\nerror: could not resolve partial path \r\n  \u250c\u2500 query:1:54\r\n  \u2502\r\n1 \u2502 alter type Vector { create constraint expression on (.x^2 + .y^2 < 25) };\r\n  \u2502                                                      ^^^ error\r\n```\r\n\r\nIdeally, the short path should assume `__subject__` as its start.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1704/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1704/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1688", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1688/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1688/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1688/events", "html_url": "https://github.com/edgedb/edgedb/issues/1688", "id": 683200339, "node_id": "MDU6SXNzdWU2ODMyMDAzMzk=", "number": 1688, "title": "Restrict the usage of DML in DDL and within shapes.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 932934397, "node_id": "MDU6TGFiZWw5MzI5MzQzOTc=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/edgeql", "name": "edgeql", "color": "0052cc", "default": false, "description": ""}, {"id": 1706980018, "node_id": "MDU6TGFiZWwxNzA2OTgwMDE4", "url": "https://api.github.com/repos/edgedb/edgedb/labels/usability", "name": "usability", "color": "5e02d6", "default": false, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-08-21T01:50:56Z", "updated_at": "2020-10-20T02:36:23Z", "closed_at": "2020-10-20T02:36:23Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "There are some limitations to using DML (`INSERT`, `DELETE`, `UPDATE`)\r\nstatements as part of other expressions:\r\n\r\n* They cannot appear as branches of conditional expressions (#684, #1639).\r\n* They shouldn't appear inside function bodies (although this\r\n  limitation can be relaxed in the future #1661).\r\n* They cannot be correlated with other query components, basically\r\n  they must always be independent of the rest of the query in such a\r\n  way that refactoring them into a `WITH` block doesn't change the\r\n  semantics.\r\n\r\nThe last point results in some additional restrictions that need to be enforced:\r\n\r\n* DML cannot appear as a computable in a shape\r\n* DML cannot appear as a computable in a type or aliased type\r\n  declaration at all (even in a `WITH` block), because that\r\n  potentially results in issues with correlation of the DML and the\r\n  rest of the object whenever that type appears in a query.\r\n\r\nIt is, however, legal to use DML in a `default` expression, for example:\r\n\r\n```\r\ntype Foo {\r\n    required property val -> str;\r\n}\r\n\r\ntype Bar {\r\n    required link foo -> Foo {\r\n        default := (INSERT Foo)\r\n    }\r\n}\r\n```\r\n\r\nWhich means that if `foo` is omitted at creation time, a new `Foo`\r\nobject will be created automatically for that link.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1688/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1688/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1669", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1669/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1669/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1669/events", "html_url": "https://github.com/edgedb/edgedb/issues/1669", "id": 679467456, "node_id": "MDU6SXNzdWU2Nzk0Njc0NTY=", "number": 1669, "title": "Nested insert of single links improperly correlated", "user": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-08-15T00:47:27Z", "updated_at": "2021-02-05T07:25:21Z", "closed_at": "2021-02-05T07:25:21Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "#1656 fixed issues with nested inserts when the outer insert had `ON CONFLICT` or was inside a `FOR`, but the fix only works for multi links.\r\n\r\nFor single links, which don't use a link table and so have a different code path, the nested insert is executed *before* the enclosing insert.\r\n\r\nFor the `FOR` case, where currently we will do one nested insert when we should do one per FOR iteration, this doesn't pose much of a problem and just needs some programming to be done.\r\n\r\nThe `ON CONFLICT` case, where currently we will execute the nested insert even if the enclosing one fails on conflict, things are trickier: we need to put something into the link column. @elprans suggests that we randomly generate a uuid for the initial enclosing insert, then UPDATE it once the nested one is done.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1669/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1669/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1667", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1667/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1667/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1667/events", "html_url": "https://github.com/edgedb/edgedb/issues/1667", "id": 679341644, "node_id": "MDU6SXNzdWU2NzkzNDE2NDQ=", "number": 1667, "title": "DDL results in SQL syntax error", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-08-14T18:49:36Z", "updated_at": "2020-08-19T01:20:54Z", "closed_at": "2020-08-19T01:20:54Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: EdgeDB 1.0-alpha.4+dev.130.g9e96c03f\r\n- OS Version: LInux\r\n\r\nSteps to Reproduce:\r\n\r\nTry this in REPL:\r\n```\r\nCREATE TYPE Foo {CREATE LINK left -> Foo};\r\n```\r\n\r\nI get an error:\r\n```\r\n  Server traceback:\r\n      edb.errors.InternalServerError: syntax error at or near \"left\"\r\n```\r\n\r\nNote that this also happens for `rgiht`. It appears that the identifier `left` is not quoted and clashes with a SQL keyword.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1667/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1667/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1664", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1664/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1664/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1664/events", "html_url": "https://github.com/edgedb/edgedb/issues/1664", "id": 678583608, "node_id": "MDU6SXNzdWU2Nzg1ODM2MDg=", "number": 1664, "title": "Incorrect behavior in functions when column name shadows parameter", "user": {"login": "Fogapod", "id": 22667809, "node_id": "MDQ6VXNlcjIyNjY3ODA5", "avatar_url": "https://avatars.githubusercontent.com/u/22667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Fogapod", "html_url": "https://github.com/Fogapod", "followers_url": "https://api.github.com/users/Fogapod/followers", "following_url": "https://api.github.com/users/Fogapod/following{/other_user}", "gists_url": "https://api.github.com/users/Fogapod/gists{/gist_id}", "starred_url": "https://api.github.com/users/Fogapod/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Fogapod/subscriptions", "organizations_url": "https://api.github.com/users/Fogapod/orgs", "repos_url": "https://api.github.com/users/Fogapod/repos", "events_url": "https://api.github.com/users/Fogapod/events{/privacy}", "received_events_url": "https://api.github.com/users/Fogapod/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-08-13T16:43:16Z", "updated_at": "2021-03-06T19:18:09Z", "closed_at": "2021-03-06T19:18:08Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: `1.0-alpha.4+dev.116.g83e9f530`\r\n- OS Version: Docker\r\n\r\nSteps to Reproduce:\r\n\r\n```edgeql\r\nROLLBACK;\r\nSTART TRANSACTION;\r\n\r\n# https://github.com/edgedb/edgedb/issues/1625\r\nCREATE TYPE User {\r\n    CREATE PROPERTY nickname -> str;\r\n};\r\n\r\nSTART MIGRATION TO {\r\n    module default {\r\n        type User {\r\n            required property nickname -> str;\r\n        }\r\n        function test(nickname: str) -> int64 {\r\n            using EdgeQL $$\r\n                SELECT count(\r\n                    (SELECT User FILTER nickname ?= .nickname)\r\n                )\r\n            $$\r\n        }\r\n    }\r\n};\r\nPOPULATE MIGRATION;\r\nCOMMIT MIGRATION;\r\n\r\nINSERT User { nickname := 'u1' };\r\nINSERT User { nickname := 'u2' };\r\n\r\nSELECT test(<optional str>{});\r\n# {2}\r\nSELECT test(<optional str>{'u3'});\r\n# {2}\r\n\r\n# using same expression outside of function body\r\nSELECT count((SELECT User FILTER 'u3' ?= .nickname));\r\n# {0}\r\nSELECT count((SELECT User FILTER <optional str>{} ?= .nickname));\r\n# {0}\r\n```\r\n\r\nThis happens with both required and optional function arguments.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1664/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1664/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1642", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1642/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1642/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1642/events", "html_url": "https://github.com/edgedb/edgedb/issues/1642", "id": 675197402, "node_id": "MDU6SXNzdWU2NzUxOTc0MDI=", "number": 1642, "title": "GraphQL: Sorting on non-trivial path doesn't work", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1284200502, "node_id": "MDU6TGFiZWwxMjg0MjAwNTAy", "url": "https://api.github.com/repos/edgedb/edgedb/labels/graphql", "name": "graphql", "color": "c2b0f4", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-08-07T18:37:57Z", "updated_at": "2020-08-17T16:57:55Z", "closed_at": "2020-08-17T16:57:55Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nCREATE TYPE Bar {\r\n    CREATE PROPERTY name -> str;\r\n};\r\n\r\nCREATE TYPE Foo {\r\n    CREATE LINK bar -> Bar;\r\n};\r\n```\r\n\r\n```\r\n  query {\r\n    foo: Foo(order: { bar: { name: { dir: DESC } } } ) {\r\n      id\r\n    }\r\n  }\r\n```\r\n\r\nActual result:\r\n\r\n```\r\n[GraphQL error]: Message: QueryError: Field 'bar' is not defined by type OrderFoo., Location: [object Object], Path: undefined\r\n```\r\n\r\nExpected result: sorting by paths of arbitrary length should work (if cardinality is proper, of course).", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1642/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1642/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1640", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1640/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1640/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1640/events", "html_url": "https://github.com/edgedb/edgedb/issues/1640", "id": 674733506, "node_id": "MDU6SXNzdWU2NzQ3MzM1MDY=", "number": 1640, "title": "Bug in interaction of OPTIONAL and SET OF", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-08-07T03:40:26Z", "updated_at": "2020-09-12T03:15:35Z", "closed_at": "2020-09-12T03:15:35Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0-alpha.4+dev.92.g20b0bd7f\r\n- OS Version: Linux\r\n\r\nSteps to Reproduce:\r\n\r\n```\r\nvictor> CREATE TYPE Foo;\r\nOK: CREATE\r\nvictor> SELECT (<str>Foo.id) ?? (<str>count(Foo));\r\n{}\r\n```\r\nThe expected result is `{'0'}`, since we expect the `count` of an empty set be called.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1640/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1640/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1636", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1636/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1636/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1636/events", "html_url": "https://github.com/edgedb/edgedb/issues/1636", "id": 673706164, "node_id": "MDU6SXNzdWU2NzM3MDYxNjQ=", "number": 1636, "title": "Trailing comma is invalid syntax for calling functions", "user": {"login": "Fogapod", "id": 22667809, "node_id": "MDQ6VXNlcjIyNjY3ODA5", "avatar_url": "https://avatars.githubusercontent.com/u/22667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Fogapod", "html_url": "https://github.com/Fogapod", "followers_url": "https://api.github.com/users/Fogapod/followers", "following_url": "https://api.github.com/users/Fogapod/following{/other_user}", "gists_url": "https://api.github.com/users/Fogapod/gists{/gist_id}", "starred_url": "https://api.github.com/users/Fogapod/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Fogapod/subscriptions", "organizations_url": "https://api.github.com/users/Fogapod/orgs", "repos_url": "https://api.github.com/users/Fogapod/repos", "events_url": "https://api.github.com/users/Fogapod/events{/privacy}", "received_events_url": "https://api.github.com/users/Fogapod/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-08-05T17:02:53Z", "updated_at": "2020-08-23T22:39:57Z", "closed_at": "2020-08-23T22:39:57Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: `1.0-alpha.4+dev.110.gc569d8dc`\r\n- OS Version: Docker\r\n\r\nSteps to Reproduce:\r\n\r\n```edgeql\r\nCREATE FUNCTION test(a: int64) -> int64 { USING ( SELECT a ) };\r\nSELECT test(\r\n  1,\r\n)\r\n# error: Unexpected ')'\r\n```\r\n\r\nIn python this is a valid syntax:\r\n```python\r\ntest(\r\n  1,\r\n)\r\ntest (1,)\r\n```\r\nAnd this is not:\r\n```python\r\ntest(,)\r\n```\r\n\r\nCurrent behavior is inconsistent, trailing commas are allowed in `SELECT`, `INSERT`, etc.\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1636/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1636/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1625", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1625/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1625/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1625/events", "html_url": "https://github.com/edgedb/edgedb/issues/1625", "id": 671593122, "node_id": "MDU6SXNzdWU2NzE1OTMxMjI=", "number": 1625, "title": "SDL migration including function definition fails on commit with \"InternalServerError: relation ... does not exist\"", "user": {"login": "CodesInChaos", "id": 320473, "node_id": "MDQ6VXNlcjMyMDQ3Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/320473?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CodesInChaos", "html_url": "https://github.com/CodesInChaos", "followers_url": "https://api.github.com/users/CodesInChaos/followers", "following_url": "https://api.github.com/users/CodesInChaos/following{/other_user}", "gists_url": "https://api.github.com/users/CodesInChaos/gists{/gist_id}", "starred_url": "https://api.github.com/users/CodesInChaos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CodesInChaos/subscriptions", "organizations_url": "https://api.github.com/users/CodesInChaos/orgs", "repos_url": "https://api.github.com/users/CodesInChaos/repos", "events_url": "https://api.github.com/users/CodesInChaos/events{/privacy}", "received_events_url": "https://api.github.com/users/CodesInChaos/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-08-02T10:38:54Z", "updated_at": "2022-02-10T23:11:49Z", "closed_at": "2022-02-10T23:11:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "- EdgeDB Version: alpha 4\r\n- OS Version: Ubuntu 20\r\n\r\nOn an empty database run the following migration:\r\n\r\n```\r\nSTART MIGRATION TO {\r\nmodule default {\r\n\ttype User {\r\n\t\toptional property name -> str;\r\n\t}\r\n\r\n\tfunction get_user(name:str) -> User\r\n\tUSING EdgeQL $$\r\n\t\tselect User {\r\n\t\t\tname,\r\n\t\t}\r\n\t\tfilter {\r\n\t\t\t.name = name\r\n\t\t}\r\n\t\tlimit 1\r\n\t$$;\r\n}\r\n\r\n};\r\nPOPULATE MIGRATION;\r\nCOMMIT MIGRATION;\r\n```\r\n\r\nThe commit fails with the following error:\r\n\r\n> InternalServerError: relation \"edgedb_22db0c59-d1e6-11ea-bd31-efd5a96c52d1.a7cb9161-d4ab-11ea-8e37-2d90af0bf1de_t\" does not exist\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1625/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1625/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1614", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1614/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1614/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1614/events", "html_url": "https://github.com/edgedb/edgedb/issues/1614", "id": 670065976, "node_id": "MDU6SXNzdWU2NzAwNjU5NzY=", "number": 1614, "title": "Cardinality calculation causes error", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-07-31T17:57:12Z", "updated_at": "2020-07-31T21:23:14Z", "closed_at": "2020-07-31T21:23:14Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This issue appears in the ff869ab54d63968081d54e99b4dfb8f2b62f9ce8\r\n\r\nSteps to Reproduce:\r\n\r\nIn `graphqlfunctional` database, try:\r\n```\r\nSELECT default::SettingAliasAugmented {\r\n    of_group: {\r\n        name_upper\r\n    }\r\n} FILTER .of_group.name_upper > \"U\";\r\n```\r\n\r\nThis causes the following error:\r\n```\r\nERROR: InternalServerError: 'NoneType' object has no attribute 'is_single'\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/procpool/worker.py\", line 75, in worker\r\n          res = await meth(*args)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 1683, in compile_eql_tokens\r\n          return self._compile(ctx=ctx, tokens=eql_tokens)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 1319, in _compile\r\n          comp: dbstate.BaseQuery = self._compile_dispatch_ql(ctx, stmt)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 1282, in _compile_dispatch_ql\r\n          return self._compile_ql_query(ctx, ql)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 589, in _compile_ql_query\r\n          ir = qlcompiler.compile_ast_to_ir(\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/__init__.py\", line 175, in wrapper\r\n          return func(*args, **kwargs)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/__init__.py\", line 224, in compile_ast_to_ir\r\n          ir_expr = stmtctx_mod.fini_expression(ir_set, ctx=ctx)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/stmtctx.py\", line 116, in fini_expression\r\n          cb(ctx=ctx)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/stmtctx.py\", line 512, in _infer_pointer_cardinality\r\n          inferred_card = infer_expr_cardinality(irexpr=irexpr, ctx=ctx)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/stmtctx.py\", line 489, in infer_expr_cardinality\r\n          return inference.infer_cardinality(irexpr, scope_tree=scope, env=ctx.env)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/inference/cardinality.py\", line 929, in infer_cardinality\r\n          result = _infer_cardinality(\r\n        File \"/home/victor/dev/venvs/edgedb/lib/python3.8/functools.py\", line 875, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/inference/cardinality.py\", line 371, in __infer_set\r\n          return infer_cardinality(\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/inference/cardinality.py\", line 929, in infer_cardinality\r\n          result = _infer_cardinality(\r\n        File \"/home/victor/dev/venvs/edgedb/lib/python3.8/functools.py\", line 875, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/inference/cardinality.py\", line 719, in __infer_select_stmt\r\n          stmt_card = _infer_stmt_cardinality(\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/inference/cardinality.py\", line 689, in _infer_stmt_cardinality\r\n          result_card = infer_cardinality(\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/inference/cardinality.py\", line 929, in infer_cardinality\r\n          result = _infer_cardinality(\r\n        File \"/home/victor/dev/venvs/edgedb/lib/python3.8/functools.py\", line 875, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/inference/cardinality.py\", line 371, in __infer_set\r\n          return infer_cardinality(\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/inference/cardinality.py\", line 929, in infer_cardinality\r\n          result = _infer_cardinality(\r\n        File \"/home/victor/dev/venvs/edgedb/lib/python3.8/functools.py\", line 875, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/inference/cardinality.py\", line 403, in __infer_func_call\r\n          return _common_cardinality(\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/inference/cardinality.py\", line 185, in _common_cardinality\r\n          return cartesian_cardinality(\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/inference/cardinality.py\", line 125, in cartesian_cardinality\r\n          card = list(zip(*(_card_to_bounds(a) for a in args)))\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/inference/cardinality.py\", line 125, in <genexpr>\r\n          card = list(zip(*(_card_to_bounds(a) for a in args)))\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/inference/cardinality.py\", line 186, in <genexpr>\r\n          infer_cardinality(\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/inference/cardinality.py\", line 929, in infer_cardinality\r\n          result = _infer_cardinality(\r\n        File \"/home/victor/dev/venvs/edgedb/lib/python3.8/functools.py\", line 875, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/inference/cardinality.py\", line 360, in __infer_set\r\n          source_card = infer_cardinality(\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/inference/cardinality.py\", line 929, in infer_cardinality\r\n          result = _infer_cardinality(\r\n        File \"/home/victor/dev/venvs/edgedb/lib/python3.8/functools.py\", line 875, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/compiler/inference/cardinality.py\", line 358, in __infer_set\r\n          if rptrref_card.is_single():\r\n      AttributeError: 'NoneType' object has no attribute 'is_single'\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1614/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1614/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1589", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1589/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1589/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1589/events", "html_url": "https://github.com/edgedb/edgedb/issues/1589", "id": 665616678, "node_id": "MDU6SXNzdWU2NjU2MTY2Nzg=", "number": 1589, "title": "select <User>{} selects all users instead of an empty set", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-07-25T16:43:01Z", "updated_at": "2020-07-26T01:58:53Z", "closed_at": "2020-07-26T01:58:53Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1589/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1589/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1586", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1586/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1586/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1586/events", "html_url": "https://github.com/edgedb/edgedb/issues/1586", "id": 665611286, "node_id": "MDU6SXNzdWU2NjU2MTEyODY=", "number": 1586, "title": "InternalServerError: cannot describe type default::User", "user": {"login": "Fogapod", "id": 22667809, "node_id": "MDQ6VXNlcjIyNjY3ODA5", "avatar_url": "https://avatars.githubusercontent.com/u/22667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Fogapod", "html_url": "https://github.com/Fogapod", "followers_url": "https://api.github.com/users/Fogapod/followers", "following_url": "https://api.github.com/users/Fogapod/following{/other_user}", "gists_url": "https://api.github.com/users/Fogapod/gists{/gist_id}", "starred_url": "https://api.github.com/users/Fogapod/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Fogapod/subscriptions", "organizations_url": "https://api.github.com/users/Fogapod/orgs", "repos_url": "https://api.github.com/users/Fogapod/repos", "events_url": "https://api.github.com/users/Fogapod/events{/privacy}", "received_events_url": "https://api.github.com/users/Fogapod/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-07-25T16:10:45Z", "updated_at": "2020-12-30T01:11:07Z", "closed_at": "2020-12-30T01:11:07Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: Docker: `1.0a4-2020071615~buster`\r\n\r\nSteps to Reproduce:\r\n\r\nRun: ` SELECT <array<User>>{};`\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n```esdl\r\ntype User {\r\n            required property nickname -> str;\r\n            required property email -> str;\r\n            required property email_verified -> bool {\r\n                default := false;\r\n            };\r\n            required property password -> bytes;\r\n            required property created_at -> datetime {\r\n                default := datetime_current();\r\n            };\r\n        };\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1586/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1586/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1566", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1566/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1566/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1566/events", "html_url": "https://github.com/edgedb/edgedb/issues/1566", "id": 663094649, "node_id": "MDU6SXNzdWU2NjMwOTQ2NDk=", "number": 1566, "title": "Multiple GraphQL mutations do not work", "user": {"login": "mistyharsh", "id": 4905303, "node_id": "MDQ6VXNlcjQ5MDUzMDM=", "avatar_url": "https://avatars.githubusercontent.com/u/4905303?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mistyharsh", "html_url": "https://github.com/mistyharsh", "followers_url": "https://api.github.com/users/mistyharsh/followers", "following_url": "https://api.github.com/users/mistyharsh/following{/other_user}", "gists_url": "https://api.github.com/users/mistyharsh/gists{/gist_id}", "starred_url": "https://api.github.com/users/mistyharsh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mistyharsh/subscriptions", "organizations_url": "https://api.github.com/users/mistyharsh/orgs", "repos_url": "https://api.github.com/users/mistyharsh/repos", "events_url": "https://api.github.com/users/mistyharsh/events{/privacy}", "received_events_url": "https://api.github.com/users/mistyharsh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1284200502, "node_id": "MDU6TGFiZWwxMjg0MjAwNTAy", "url": "https://api.github.com/repos/edgedb/edgedb/labels/graphql", "name": "graphql", "color": "c2b0f4", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-07-21T15:12:25Z", "updated_at": "2020-07-23T20:18:43Z", "closed_at": "2020-07-23T20:18:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "- EdgeDB Version: 1.0 Alpha 4\r\n- OS Version: Docker\r\n\r\n### Steps to Reproduce:\r\n1. Create a simple database & connect to it.\r\n2. Expose the GraphQL layer for this database.\r\n3. Try running one mutation - it works.\r\n4. Try running more than mutation - **it doesn't work**\r\n\r\nThe error is:\r\n```json\r\n{\r\n  \"errors\": [\r\n    {\r\n      \"message\": \"AttributeError: 'NoneType' object has no attribute 'dummy'\"\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nSchema and steps used to create the database and GraphQL layer:\r\n```\r\nstart migration to {\r\n  module default {\r\n\r\n    type Project {\r\n      required property name -> str;\r\n\r\n      multi link tests -> TestCase;\r\n    };\r\n\r\n    type TestCase {\r\n      required property name -> str {\r\n        constraint exclusive;\r\n      };\r\n    };\r\n\r\n  };\r\n};\r\npopulate migration;\r\ndescribe current migration;\r\ncommit migration;\r\n\r\n# Open port for GraphQL\r\nCONFIGURE SYSTEM INSERT Port {\r\n    protocol := \"graphql+http\",\r\n    database := \"testdb\",\r\n    address := \"0.0.0.0\",\r\n    port := 8888,\r\n    user := \"http\",\r\n    concurrency := 4\r\n};\r\n```\r\n\r\n### What works:\r\n```gql\r\nmutation {\r\n  insert_Project(data: [{ name: \"Project 1\" }]) {\r\n    id\r\n    name\r\n  }\r\n}\r\n```\r\n\r\nand\r\n```gql\r\nmutation {\r\n  insert_TestCase(data: [{ name: \"Hello world 1\" }]) {\r\n    id\r\n    name\r\n  }\r\n}\r\n```\r\n\r\n### What does not work (multiple mutations in same request):\r\n```gql\r\nmutation {\r\n  insert_Project(data: [{ name: \"Project 1\" }]) {\r\n    id\r\n    name\r\n  }\r\n\r\n  insert_TestCase(data: [{ name: \"Hello world 1\" }]) {\r\n    id\r\n    name\r\n  }\r\n}\r\n```\r\n\r\nA question (on a side note) - How does EdgeDB handle GraphQL mutation requests? If there are multiple mutations, is the full mutation request considered automatic? Is it running within a single transaction or multiple DB transactions per mutation?", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1566/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1566/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1533", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1533/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1533/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1533/events", "html_url": "https://github.com/edgedb/edgedb/issues/1533", "id": 655852964, "node_id": "MDU6SXNzdWU2NTU4NTI5NjQ=", "number": 1533, "title": "Issue with `query_work_mem`", "user": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2020-07-13T13:28:58Z", "updated_at": "2021-01-13T02:38:40Z", "closed_at": "2021-01-13T02:38:40Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "When running non dev mode edgedb, I get the following:\r\n```\r\nedgedb> describe system config;\r\n{\r\n  'CONFIGURE SYSTEM SET listen_port := 5656;\r\nCONFIGURE SYSTEM SET listen_addresses := {};\r\nCONFIGURE SYSTEM SET shared_buffers := \\'3234960kB\\';\r\nCONFIGURE SYSTEM SET query_work_mem := \\'\"6144kB\"\\';   // <-- here is double escaping\r\nCONFIGURE SYSTEM SET effective_cache_size := \\'8087392kB\\';\r\nCONFIGURE SYSTEM SET effective_io_concurrency := \\'1\\';\r\nCONFIGURE SYSTEM SET default_statistics_target := \\'100\\';\r\n',\r\n}\r\n```\r\nThis isn't problem with describe config, because this is processed as a string same as other configuration settings around, and `SELECT cfg::get_config_json()` gives the same bug.\r\n\r\nBut I can't reproduce that by setting a value:\r\n```\r\nedgedb> CONFIGURE SYSTEM SET query_work_mem := '\"8192kB\"';\r\nError: ERROR: InvalidValueError: invalid value for parameter \"work_mem\": \"\"8192kB\"\"\r\nedgedb> CONFIGURE SYSTEM SET query_work_mem := '16384kB';\r\nOK: CONFIGURE SYSTEM\r\nedgedb> describe system config;\r\n{\r\n  'CONFIGURE SYSTEM SET listen_port := 5656;\r\nCONFIGURE SYSTEM SET listen_addresses := {};\r\nCONFIGURE SYSTEM SET shared_buffers := \\'3234960kB\\';\r\nCONFIGURE SYSTEM SET query_work_mem := \\'16384kB\\';\r\nCONFIGURE SYSTEM SET effective_cache_size := \\'8087392kB\\';\r\nCONFIGURE SYSTEM SET effective_io_concurrency := \\'1\\';\r\nCONFIGURE SYSTEM SET default_statistics_target := \\'100\\';\r\n',\r\n}\r\n```\r\nThis probably has something to do with settings the value in `bootstrap.py` (other settings set there do not have this problem, though), but I don't understand what is the issue yet.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1533/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1533/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1452", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1452/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1452/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1452/events", "html_url": "https://github.com/edgedb/edgedb/issues/1452", "id": 628065047, "node_id": "MDU6SXNzdWU2MjgwNjUwNDc=", "number": 1452, "title": "WITH block declarations not picked up in computed properties", "user": {"login": "haikyuu", "id": 8558836, "node_id": "MDQ6VXNlcjg1NTg4MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/8558836?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haikyuu", "html_url": "https://github.com/haikyuu", "followers_url": "https://api.github.com/users/haikyuu/followers", "following_url": "https://api.github.com/users/haikyuu/following{/other_user}", "gists_url": "https://api.github.com/users/haikyuu/gists{/gist_id}", "starred_url": "https://api.github.com/users/haikyuu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haikyuu/subscriptions", "organizations_url": "https://api.github.com/users/haikyuu/orgs", "repos_url": "https://api.github.com/users/haikyuu/repos", "events_url": "https://api.github.com/users/haikyuu/events{/privacy}", "received_events_url": "https://api.github.com/users/haikyuu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-05-31T23:17:05Z", "updated_at": "2023-01-27T00:34:54Z", "closed_at": "2023-01-27T00:34:54Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: nightly\r\n- OS Version: Debian 10\r\n\r\nSteps to Reproduce:\r\n```\r\nproperty description := (\r\n          WITH \r\n            ts_start := (\r\n              <duration>(to_str(.number / 2) ++ ' hours') +\r\n              <duration>(\r\n                ('30 minutes' IF .number % 2 = 1 ELSE '00 minutes')\r\n              )\r\n            ),\r\n            ts_end := ts_start + <duration>'30 minutes'\r\n          SELECT to_str(.day) ++ ' bw: ' ++ to_str(ts_start) ++ ' & ' ++ to_str(ts_end)\r\n        );\r\n```\r\nI get this error `Error: ERROR: InvalidReferenceError: schema item 'std::ts_start' does not exist`", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1452/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1452/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1442", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1442/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1442/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1442/events", "html_url": "https://github.com/edgedb/edgedb/issues/1442", "id": 627721491, "node_id": "MDU6SXNzdWU2Mjc3MjE0OTE=", "number": 1442, "title": "Link property with non-trivial unicode name breaks INSERT", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-05-30T12:27:22Z", "updated_at": "2022-02-10T23:10:09Z", "closed_at": "2022-02-10T23:10:09Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: EdgeDB 1.0-alpha.3+dev.231.g0cfce63e\r\n- OS Version: Llinux\r\n\r\nWith the following schema:\r\n```\r\ntype A;\r\ntype \u0141ukasz {\r\n    required property `\u0141\ud83e\udd1e` -> str;\r\n    link `\u0141\ud83d\udcaf` -> A {\r\n        property `\ud83d\ude40\ud83d\ude80\ud83d\ude80\ud83d\ude80\ud83d\ude40` -> str;\r\n    };\r\n}\r\n```\r\nDo these inserts:\r\n```\r\ndb> INSERT A;\r\n{Object {id: 8fb921d2-a270-11ea-9321-0b662b43d047}}\r\ndb> INSERT \u0141ukasz {\r\n...     `\u0141\ud83e\udd1e` := 'simple \ud83d\ude80',\r\n...     `\u0141\ud83d\udcaf` := (\r\n...         SELECT A {\r\n...             `\ud83d\ude40\ud83d\ude80\ud83d\ude80\ud83d\ude80\ud83d\ude40`:= '\u0141ink prop \ud83d\ude40\ud83d\ude80\ud83d\ude80\ud83d\ude80\ud83d\ude40',\r\n...         }\r\n...         LIMIT 1\r\n...     )\r\n... };\r\nERROR: InternalServerError: bind message supplies 2 parameters, but prepared statement \"\" requires 1\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      edb.errors.InternalServerError: bind message supplies 2 parameters, but prepared statement \"\" requires 1\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1442/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1442/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1441", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1441/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1441/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1441/events", "html_url": "https://github.com/edgedb/edgedb/issues/1441", "id": 627720075, "node_id": "MDU6SXNzdWU2Mjc3MjAwNzU=", "number": 1441, "title": "Mismatched extending constraint causes an internal error ", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-05-30T12:19:32Z", "updated_at": "2020-05-31T03:41:42Z", "closed_at": "2020-05-31T03:41:42Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: EdgeDB 1.0-alpha.3+dev.231.g0cfce63e\r\n- OS Version: Llinux\r\n\r\nSteps to Reproduce:\r\n```\r\ndb> CREATE ABSTRACT CONSTRAINT `\ud83d\ude80\ud83c\udf7f` EXTENDING max_len_value;\r\nOK: CREATE\r\ndb> CREATE SCALAR TYPE foo EXTENDING str {\r\n...     CREATE CONSTRAINT `\ud83d\ude80\ud83c\udf7f`(10);\r\n... };\r\nERROR: InternalServerError: 'NoneType' object has no attribute 'get_parameter_name'\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/procpool/worker.py\", line 75, in worker\r\n          res = await meth(*args)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 1480, in compile_eql_tokens\r\n          return self._compile(ctx=ctx, tokens=eql_tokens)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 1141, in _compile\r\n          comp: dbstate.BaseQuery = self._compile_dispatch_ql(ctx, stmt)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 1076, in _compile_dispatch_ql\r\n          return self._compile_ql_ddl(ctx, ql)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/server/compiler/compiler.py\", line 763, in _compile_ql_ddl\r\n          cmd = s_ddl.delta_from_ddl(\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/schema/ddl.py\", line 466, in delta_from_ddl\r\n          _, cmd = _delta_from_ddl(ddl_stmt, schema=schema, modaliases=modaliases,\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/schema/ddl.py\", line 496, in _delta_from_ddl\r\n          schema = cmd.apply(schema, context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/schema/delta.py\", line 1531, in apply\r\n          schema = self._create_innards(schema, context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/schema/inheriting.py\", line 622, in _create_innards\r\n          return super()._create_innards(schema, context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/schema/delta.py\", line 1498, in _create_innards\r\n          schema = op.apply(schema, context=context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/schema/delta.py\", line 1527, in apply\r\n          schema = self._create_begin(schema, context)\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/schema/constraints.py\", line 641, in _create_begin\r\n          constr_base, attrs, inh = Constraint.get_concrete_constraint_attrs(\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/schema/constraints.py\", line 226, in get_concrete_constraint_attrs\r\n          args_map = qlutils.index_parameters(\r\n        File \"/home/victor/dev/magicstack/edgedb/edb/edgeql/utils.py\", line 92, in index_parameters\r\n          result[p.get_parameter_name(schema)] = e\r\n      AttributeError: 'NoneType' object has no attribute 'get_parameter_name'\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1441/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1441/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1403", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1403/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1403/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1403/events", "html_url": "https://github.com/edgedb/edgedb/issues/1403", "id": 622793524, "node_id": "MDU6SXNzdWU2MjI3OTM1MjQ=", "number": 1403, "title": "Backward links and inheritence. Bug?", "user": {"login": "haikyuu", "id": 8558836, "node_id": "MDQ6VXNlcjg1NTg4MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/8558836?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haikyuu", "html_url": "https://github.com/haikyuu", "followers_url": "https://api.github.com/users/haikyuu/followers", "following_url": "https://api.github.com/users/haikyuu/following{/other_user}", "gists_url": "https://api.github.com/users/haikyuu/gists{/gist_id}", "starred_url": "https://api.github.com/users/haikyuu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haikyuu/subscriptions", "organizations_url": "https://api.github.com/users/haikyuu/orgs", "repos_url": "https://api.github.com/users/haikyuu/repos", "events_url": "https://api.github.com/users/haikyuu/events{/privacy}", "received_events_url": "https://api.github.com/users/haikyuu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-05-21T21:15:28Z", "updated_at": "2020-12-22T00:35:37Z", "closed_at": "2020-12-22T00:35:37Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I'm trying to access a property of a parent type through type intersection. Note that `Course` inherits from `HasSchedule` and this Select clause is in the context of a computed property. But\r\n  - For `SELECT .<class[IS Course].scheduledAt` where scheduled at is a property from `HasSchedule` , I get the following error: `Error: ERROR: InvalidReferenceError: object type 'default::Course' has no link or property 'scheduledAt'`\r\n  - For `SELECT (.<class[IS Course][IS HasSchedule]).scheduledAt`, i get the following error\r\n```\r\nError: ERROR: InternalServerError: 'TypeIntersection' object has no attribute 'direction'\r\n  Hint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n  Server traceback:\r\n      Traceback (most recent call last):\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha3/lib/python3.8/site-packages/edb/server/procpool/worker.py\", line 75, in worker\r\n          res = await meth(*args)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha3/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 1304, in compile_eql_tokens_in_tx\r\n          return self._compile(ctx=ctx, tokens=eql_tokens)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha3/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 945, in _compile\r\n          comp: dbstate.BaseQuery = self._compile_dispatch_ql(ctx, stmt)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha3/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 874, in _compile_dispatch_ql\r\n          return self._compile_ql_migration(ctx, ql)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha3/lib/python3.8/site-packages/edb/server/compiler/compiler.py\", line 608, in _compile_ql_migration\r\n          cmd = s_ddl.compile_migration(\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha3/lib/python3.8/site-packages/edb/schema/ddl.py\", line 340, in compile_migration\r\n          target_schema = apply_sdl(\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha3/lib/python3.8/site-packages/edb/schema/ddl.py\", line 364, in apply_sdl\r\n          ddl_stmts = s_decl.sdl_to_ddl(current_schema, documents)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha3/lib/python3.8/site-packages/edb/edgeql/declarative.py\", line 229, in sdl_to_ddl\r\n          trace_dependencies(decl_ast, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha3/lib/python3.8/functools.py\", line 874, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha3/lib/python3.8/site-packages/edb/edgeql/declarative.py\", line 493, in trace_default\r\n          _register_item(node, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha3/lib/python3.8/site-packages/edb/edgeql/declarative.py\", line 603, in _register_item\r\n          trace_dependencies(cmd, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha3/lib/python3.8/functools.py\", line 874, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha3/lib/python3.8/site-packages/edb/edgeql/declarative.py\", line 442, in trace_ConcretePointer\r\n          _register_item(\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha3/lib/python3.8/site-packages/edb/edgeql/declarative.py\", line 618, in _register_item\r\n          tdeps = qltracer.trace_refs(\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha3/lib/python3.8/site-packages/edb/edgeql/tracer.py\", line 126, in trace_refs\r\n          trace(qltree, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha3/lib/python3.8/functools.py\", line 874, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha3/lib/python3.8/site-packages/edb/edgeql/tracer.py\", line 561, in trace_Select\r\n          tip = trace(node.result, ctx=ctx)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha3/lib/python3.8/functools.py\", line 874, in wrapper\r\n          return dispatch(args[0].__class__)(*args, **kw)\r\n        File \"/usr/lib/x86_64-linux-gnu/edgedb-server-1-alpha3/lib/python3.8/site-packages/edb/edgeql/tracer.py\", line 418, in trace_Path\r\n          if prev_step.direction == '<':\r\n      AttributeError: 'TypeIntersection' object has no attribute 'direction'\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1403/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1403/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1402", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1402/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1402/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1402/events", "html_url": "https://github.com/edgedb/edgedb/issues/1402", "id": 620726282, "node_id": "MDU6SXNzdWU2MjA3MjYyODI=", "number": 1402, "title": "Number literals handle overflow and underflow inconsistently", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 13, "created_at": "2020-05-19T06:54:05Z", "updated_at": "2020-11-05T17:33:02Z", "closed_at": "2020-11-05T10:11:33Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Edgedb version:  EdgeDB 1.0-alpha.3+dev.198.g9e8c0613\r\nREPL version: edgedb-cli 0.1.0\r\n\r\nI was a little surprised by the way finite-bit numbers are handled. The overflow and underflow doesn't happen consistently.\r\n\r\nConsider the following for overflow:\r\n```\r\nvictor> SELECT 11111111111111111111111111111111111111111111;\r\nERROR: EdgeQLSyntaxError: can't parse integer: number too large to fit in target type\r\n```\r\nSo far so good, the `int64` overflowed as expected.\r\n\r\nLet's see what the float does:\r\n```\r\nvictor> SELECT 1e999;\r\n{inf}\r\nvictor> SELECT 111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.0;\r\n{inf}\r\n```\r\nThat's peculiar, I was expecting an error, much like with the `int64`. So let's try slightly different literals:\r\n```\r\nvictor> SELECT <float64>'inf';\r\n{inf}\r\nvictor> SELECT <float64>'1e999';\r\nERROR: NumericOutOfRangeError: \"1e999\" is out of range for type std::float64\r\nvictor> SELECT <float64>1e999n;\r\nERROR: NumericOutOfRangeError: \"1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" is out of range for type std::float64\r\n```\r\n\r\nSimilarly, there's an underflow issue:\r\n```\r\nvictor> SELECT 1e-999;\r\n{0}\r\nvictor> SELECT <float64>1e-999n;\r\nERROR: NumericOutOfRangeError: \"0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001\" is out of range for type std::float64\r\nvictor> SELECT <float64>to_json('1e-999');\r\nERROR: NumericOutOfRangeError: \"0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001\" is out of range for type std::float64\r\n```\r\n\r\nSo it appears that overflow and underflow are not handled consistently, which can be a weird foot-gun.\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1402/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1402/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1383", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1383/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1383/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1383/events", "html_url": "https://github.com/edgedb/edgedb/issues/1383", "id": 614493856, "node_id": "MDU6SXNzdWU2MTQ0OTM4NTY=", "number": 1383, "title": "Cannot access inherited property in computed property", "user": {"login": "haikyuu", "id": 8558836, "node_id": "MDQ6VXNlcjg1NTg4MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/8558836?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haikyuu", "html_url": "https://github.com/haikyuu", "followers_url": "https://api.github.com/users/haikyuu/followers", "following_url": "https://api.github.com/users/haikyuu/following{/other_user}", "gists_url": "https://api.github.com/users/haikyuu/gists{/gist_id}", "starred_url": "https://api.github.com/users/haikyuu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haikyuu/subscriptions", "organizations_url": "https://api.github.com/users/haikyuu/orgs", "repos_url": "https://api.github.com/users/haikyuu/repos", "events_url": "https://api.github.com/users/haikyuu/events{/privacy}", "received_events_url": "https://api.github.com/users/haikyuu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-05-08T04:25:47Z", "updated_at": "2020-05-14T07:04:52Z", "closed_at": "2020-05-14T07:04:52Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "schema\r\n```\r\ntype Class extending HasAvailability {\r\n      property schedule := (\r\n        SELECT (.<class[IS Course]).scheduledAt\r\n      );\r\n    }\r\n    abstract type HasAvailability {\r\n     multi link availableAt -> TimeSpot;\r\n    }\r\n    abstract type HasSchedule {\r\n     multi link scheduledAt -> TimeSpot;\r\n    }\r\n    type Course extending HasSchedule{\r\n      required property name -> str;\r\n    }\r\n```\r\n\r\n```\r\nobject type 'default::Course' has no link or property 'scheduledAt'\r\n```\r\n\r\nNote that it works when used in a query", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1383/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1383/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1381", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1381/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1381/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1381/events", "html_url": "https://github.com/edgedb/edgedb/issues/1381", "id": 613610756, "node_id": "MDU6SXNzdWU2MTM2MTA3NTY=", "number": 1381, "title": "Incorrect result for a value computed in WITH block", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-05-06T21:01:36Z", "updated_at": "2021-01-26T08:31:49Z", "closed_at": "2021-01-26T08:31:49Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Run the following in the existing scope tests dataset (from `test_edgeql_scope.py`):\r\n```\r\nWITH \r\n    MODULE test,\r\n    avg := math::mean({len(Card.name)})\r\nSELECT Card {name, a := avg};\r\n```\r\nInstead of being the same value across all results `a` is different for each as if the function call was inlined.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1381/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1381/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1362", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1362/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1362/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1362/events", "html_url": "https://github.com/edgedb/edgedb/issues/1362", "id": 605940150, "node_id": "MDU6SXNzdWU2MDU5NDAxNTA=", "number": 1362, "title": "invalid reference to FROM-clause entry for table", "user": {"login": "fmoor", "id": 8278635, "node_id": "MDQ6VXNlcjgyNzg2MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/8278635?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmoor", "html_url": "https://github.com/fmoor", "followers_url": "https://api.github.com/users/fmoor/followers", "following_url": "https://api.github.com/users/fmoor/following{/other_user}", "gists_url": "https://api.github.com/users/fmoor/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmoor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmoor/subscriptions", "organizations_url": "https://api.github.com/users/fmoor/orgs", "repos_url": "https://api.github.com/users/fmoor/repos", "events_url": "https://api.github.com/users/fmoor/events{/privacy}", "received_events_url": "https://api.github.com/users/fmoor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-04-23T23:37:17Z", "updated_at": "2021-06-09T19:58:46Z", "closed_at": "2021-06-09T19:58:46Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0-alpha.2+g16f75ece5.d20200122\r\n- OS Version: Debian GNU/Linux 9 (stretch) via docker image dad8bf42f00a\r\n\r\nSteps to Reproduce:\r\n\r\n1. `INSERT User {email := 'a@b.com', pwd_hash := '...'};`\r\n2. `INSERT Exercise {name := 'squat', user := (SELECT User LIMIT 1)};`\r\n3. `INSERT SetGroup {index := 1, date := <cal::local_date>'1970-01-01', exercise := (SELECT Exercise LIMIT 1)};`\r\n4. \r\n```\r\nWITH indexes := (\r\n  WITH sg := SetGroup \r\n  SELECT SetGroup.index \r\n  FILTER \r\n    sg.date = <cal::local_date>'1970-01-01' \r\n    AND \r\n    sg.exercise.id = <uuid>'d1414040-85b9-11ea-8739-53e824f09289'\r\n) \r\nINSERT SetGroup {\r\n  index := 1 + max(indexes), \r\n  date := <cal::local_date>'1970-01-01', \r\n  exercise := (\r\n    SELECT Exercise \r\n    FILTER \r\n      .id = <uuid>'d1414040-85b9-11ea-8739-53e824f09289' \r\n      AND \r\n      .user.id = <uuid>'c786a450-85b9-11ea-8739-4f9d34aa15f4' \r\n    LIMIT 1 \r\n  )\r\n};\r\n\r\nInternalServerError: invalid reference to FROM-clause entry for table \"SetGroup~1\"\r\nHint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket at https://github.com/edgedb/edgedb/issues/new?template=bug_report.md\r\n```\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n```\r\nCREATE MIGRATION workout TO {\r\n      module default {\r\n        type User {\r\n          required property email -> str {\r\n            constraint exclusive;\r\n          }\r\n          required property pwd_hash -> str;\r\n        }\r\n        \r\n        type Exercise {\r\n          required property name -> str;\r\n          required link user -> User;\r\n        }\r\n\r\n        type SetGroup {\r\n          required property index -> int16;\r\n          required property date -> cal::local_date;\r\n          required link exercise -> Exercise;\r\n        }\r\n\r\n        type Set_ {\r\n          required property index -> int16;\r\n          required property weight -> float32;\r\n          required property reps -> int16;\r\n          required property is_complete -> bool;\r\n          required link set_group -> SetGroup;\r\n        }\r\n      }\r\n    };\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1362/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1362/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1335", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1335/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1335/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1335/events", "html_url": "https://github.com/edgedb/edgedb/issues/1335", "id": 598801785, "node_id": "MDU6SXNzdWU1OTg4MDE3ODU=", "number": 1335, "title": "ISE: there is no range var for (__derived__::expr~1) source in <pg.SelectStmt at ...>", "user": {"login": "ambv", "id": 55281, "node_id": "MDQ6VXNlcjU1Mjgx", "avatar_url": "https://avatars.githubusercontent.com/u/55281?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ambv", "html_url": "https://github.com/ambv", "followers_url": "https://api.github.com/users/ambv/followers", "following_url": "https://api.github.com/users/ambv/following{/other_user}", "gists_url": "https://api.github.com/users/ambv/gists{/gist_id}", "starred_url": "https://api.github.com/users/ambv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ambv/subscriptions", "organizations_url": "https://api.github.com/users/ambv/orgs", "repos_url": "https://api.github.com/users/ambv/repos", "events_url": "https://api.github.com/users/ambv/events{/privacy}", "received_events_url": "https://api.github.com/users/ambv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-04-13T10:10:41Z", "updated_at": "2020-05-28T22:36:15Z", "closed_at": "2020-05-28T22:36:15Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "- EdgeDB Version: nightly in edbcloud\r\n- OS Version: edbcloud\r\n\r\nGetting the ISE like in the title while creating the following function (SDL syntax):\r\n\r\n```\r\n    function is_public(p: Publishable) -> bool\r\n    using EdgeQL $$\r\n        SELECT\r\n          (NOT p.deleted)\r\n          AND (\r\n              p.public_since < datetime_current()\r\n              IF p.public_since ?!= <datetime>{}\r\n              ELSE false\r\n          )\r\n          AND (\r\n              p.public_until > datetime_current()\r\n              IF p.public_until ?!= <datetime>{}\r\n              ELSE true\r\n          )\r\n        ;\r\n    $$;\r\n\r\n    abstract type Publishable {\r\n        property public_since -> datetime;\r\n        property public_until -> datetime;\r\n        property deleted -> bool;\r\n    }\r\n```\r\n\r\nWhat I'm trying to accomplish here is to make `is_public` return `true` if:\r\n- the Publishable is not deleted; and\r\n- it has a non-empty `public_since` which is in the past; and\r\n- either it doesn't have a `public_until`; or\r\n- it has a non-empty `public_until` in the future.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1335/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1335/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1314", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1314/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1314/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1314/events", "html_url": "https://github.com/edgedb/edgedb/issues/1314", "id": 590434045, "node_id": "MDU6SXNzdWU1OTA0MzQwNDU=", "number": 1314, "title": "Cannot issue new command", "user": {"login": "haikyuu", "id": 8558836, "node_id": "MDQ6VXNlcjg1NTg4MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/8558836?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haikyuu", "html_url": "https://github.com/haikyuu", "followers_url": "https://api.github.com/users/haikyuu/followers", "following_url": "https://api.github.com/users/haikyuu/following{/other_user}", "gists_url": "https://api.github.com/users/haikyuu/gists{/gist_id}", "starred_url": "https://api.github.com/users/haikyuu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haikyuu/subscriptions", "organizations_url": "https://api.github.com/users/haikyuu/orgs", "repos_url": "https://api.github.com/users/haikyuu/repos", "events_url": "https://api.github.com/users/haikyuu/events{/privacy}", "received_events_url": "https://api.github.com/users/haikyuu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2020-03-30T16:41:18Z", "updated_at": "2020-09-25T04:17:46Z", "closed_at": "2020-09-25T04:17:46Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: `EdgeDB 1.0-alpha.3+dev.102.g176dac70`\r\n- OS Version: Ubuntu\r\n\r\nSteps to Reproduce:\r\n\r\n1. Expose an HTTP Port \r\n2. Send 2-3 requests at the same time\r\n\r\n```\r\n{\r\n  message: 'cannot issue new command',\r\n  type: 'InternalServerError',\r\n   code: 16777216\r\n }\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1314/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1314/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1292", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1292/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1292/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1292/events", "html_url": "https://github.com/edgedb/edgedb/issues/1292", "id": 584721333, "node_id": "MDU6SXNzdWU1ODQ3MjEzMzM=", "number": 1292, "title": "InternalServerError when restoring dump file", "user": {"login": "jaclarke", "id": 2085287, "node_id": "MDQ6VXNlcjIwODUyODc=", "avatar_url": "https://avatars.githubusercontent.com/u/2085287?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaclarke", "html_url": "https://github.com/jaclarke", "followers_url": "https://api.github.com/users/jaclarke/followers", "following_url": "https://api.github.com/users/jaclarke/following{/other_user}", "gists_url": "https://api.github.com/users/jaclarke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaclarke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaclarke/subscriptions", "organizations_url": "https://api.github.com/users/jaclarke/orgs", "repos_url": "https://api.github.com/users/jaclarke/repos", "events_url": "https://api.github.com/users/jaclarke/events{/privacy}", "received_events_url": "https://api.github.com/users/jaclarke/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-03-19T21:51:28Z", "updated_at": "2020-05-28T05:07:42Z", "closed_at": "2020-05-28T05:07:42Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: 1.0-alpha.3+dev.83.g9937f6b0\r\n- OS Version: Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-1051-aws x86_64)\r\n\r\nSteps to Reproduce:\r\n\r\n1. Dump db (attached below) from 1.0-alpha.2+g16f75ece5.d20200122\r\n2. Trying to restore into db on 1.0-alpha.3+dev.83.g9937f6b0 (or alpha.2) gives error: `InternalServerError: Object table dump data has extra fields`\r\n\r\nDump file: [movies.dump.header.gz](https://github.com/edgedb/edgedb/files/4357036/movies.dump.header.gz)\r\n(I've removed the data blocks from the dump file to make it a bit smaller and it doesn't seem to affect the error, but I can send the whole dump if it helps, it's only data from a public dataset)\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1292/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1292/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1283", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1283/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1283/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1283/events", "html_url": "https://github.com/edgedb/edgedb/issues/1283", "id": 580313382, "node_id": "MDU6SXNzdWU1ODAzMTMzODI=", "number": 1283, "title": "FOR expression doesn't work correctly with non-trivial expression", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-03-13T01:20:32Z", "updated_at": "2022-06-30T20:53:00Z", "closed_at": "2022-06-30T20:53:00Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: 1.0-alpha.3+dev.82.ga77f6950\r\n- OS Version: Linux\r\n\r\nSteps to Reproduce:\r\n```\r\ndb> CREATE TYPE Foo {CREATE PROPERTY q -> str {CREATE CONSTRAINT exclusive}};\r\nCREATE\r\ndb> FOR x IN {2,3} UNION (INSERT Foo {q := 'q' ++ <str>x});\r\nConstraintViolationError: q violates exclusivity constraint\r\ndb> FOR x IN {2,3} UNION (SELECT Object{q := 'q' ++ <str>x} LIMIT 1);\r\n{Object { q: 'q(2, 3)' }, Object { q: 'q(2, 3)' }}\r\ndb> FOR x IN {2, 3} UNION (SELECT 'q' ++ <str>x);\r\n{'q(2, 3)', 'q(2, 3)'}\r\ndb> FOR x IN {2, 3} UNION (SELECT x);\r\n{2, 3}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1283/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1283/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1271", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1271/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1271/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1271/events", "html_url": "https://github.com/edgedb/edgedb/issues/1271", "id": 576649416, "node_id": "MDU6SXNzdWU1NzY2NDk0MTY=", "number": 1271, "title": "Limit injection in REPL broke my query", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1706980018, "node_id": "MDU6TGFiZWwxNzA2OTgwMDE4", "url": "https://api.github.com/repos/edgedb/edgedb/labels/usability", "name": "usability", "color": "5e02d6", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-03-06T02:08:44Z", "updated_at": "2020-03-10T21:11:18Z", "closed_at": "2020-03-10T21:11:18Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This problem arises for me in the current master branch a81f852cf87ad4054d7e924063540fdc361fd242\r\n\r\nI have the following query in my tutorial:\r\n```\r\nSELECT User {\r\n    name,\r\n    email,\r\n    last_post := (\r\n        SELECT .<author[IS Media] {\r\n            hashtags,\r\n            type := .__type__.name,\r\n            [IS Text].title,\r\n            [IS Text].body,\r\n            [IS UploadedMedia].uri,\r\n        }\r\n        ORDER BY .post_date DESC\r\n        LIMIT 1\r\n    ),\r\n    feed := (\r\n        SELECT .follows.<author[IS Media] {\r\n            author: {\r\n                name,\r\n                email,\r\n            },\r\n            hashtags,\r\n            type := .__type__.name,\r\n            [IS Text].title,\r\n            [IS Text].body,\r\n            [IS UploadedMedia].uri,\r\n        }\r\n        ORDER BY .post_date DESC\r\n        LIMIT 5\r\n    ),\r\n}\r\nFILTER .email = 'alice@tutorial.com'\r\n```\r\n\r\nWhich actually already has small limits and does produce the expected result via the python API. The problem arises in REPL, where the query produces many more nested results for \"last_post\" and \"feed\". If I disable limit injection by using `\\limit 0` then things go back to correct expected output.\r\n\r\nThis is broken w.r.t. limit injection in python REPL. Having said that, does rust REPL even try to do limit injection at this point?\r\n\r\nIn rust REPL I think the polymorphic part of the query is the one that breaks things (i.e. if I remove all the `[IS Text].title` etc. from the shape, it works fine, but breaks with those).\r\n\r\nSteps to reproduce: \r\n0) Run the tutorial server so that it creates a database\r\n1) Connect to the tutorial database with REPL (the database name is \"queries\")\r\n2) Run the above query\r\n\r\nSorry I don't have a tiny test case for it yet.\r\n\r\nCould @elprans and @tailhook take a look at this?", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1271/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1271/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1269", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1269/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1269/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1269/events", "html_url": "https://github.com/edgedb/edgedb/issues/1269", "id": 575938217, "node_id": "MDU6SXNzdWU1NzU5MzgyMTc=", "number": 1269, "title": "Bugs with line continuation in strings", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-03-05T01:53:53Z", "updated_at": "2020-03-05T12:36:12Z", "closed_at": "2020-03-05T12:36:12Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This happens in the current master branch.\r\n\r\nTry this:\r\n```\r\nSELECT \"some text \\\r\nwill be completely \\\r\n        ignored\";\r\n```\r\n\r\nThere's also another bug that's harder to express in REPL, but I've made a test case for it. Basically, the line continuation is unhappy if it's followed by `\\r` as opposed to `\\n`. This should not be the case as either one of the two may appear as a newline depending which system this is coming from. I personally ran across this while playing around with queries submitted from the browser in tutorial.\r\n\r\nAs far as I can tell both of these are probably lexer issues.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1269/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1269/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1259", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1259/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1259/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1259/events", "html_url": "https://github.com/edgedb/edgedb/issues/1259", "id": 569404921, "node_id": "MDU6SXNzdWU1Njk0MDQ5MjE=", "number": 1259, "title": "ISE caused by an object-returning function wrapped into a SELECT", "user": {"login": "dmgolembiowski", "id": 38993137, "node_id": "MDQ6VXNlcjM4OTkzMTM3", "avatar_url": "https://avatars.githubusercontent.com/u/38993137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dmgolembiowski", "html_url": "https://github.com/dmgolembiowski", "followers_url": "https://api.github.com/users/dmgolembiowski/followers", "following_url": "https://api.github.com/users/dmgolembiowski/following{/other_user}", "gists_url": "https://api.github.com/users/dmgolembiowski/gists{/gist_id}", "starred_url": "https://api.github.com/users/dmgolembiowski/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dmgolembiowski/subscriptions", "organizations_url": "https://api.github.com/users/dmgolembiowski/orgs", "repos_url": "https://api.github.com/users/dmgolembiowski/repos", "events_url": "https://api.github.com/users/dmgolembiowski/events{/privacy}", "received_events_url": "https://api.github.com/users/dmgolembiowski/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-02-22T22:54:12Z", "updated_at": "2020-02-23T21:29:44Z", "closed_at": "2020-02-23T21:29:44Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "- Error Message:\r\n```\r\nInternalServerError: there is no range var for (__derived__::expr~6) source in <pg.SelectStmt at 0x7efbfbfa67c0>\r\nHint: This is most likely a bug in EdgeDB. Please consider opening an issue ticket...\r\n```\r\n<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: 1.0a2-2020012220~buster\r\n- OS Version: Debian 10\r\n\r\nSteps to Reproduce:\r\n0. Create the database and module.\r\n```\r\nCREATE DATABASE name;\r\n```\r\n```\r\n\\c name;\r\n...\r\nCREATE MODULE api;\r\n```\r\n1. Create the schema (shown at the bottom).\r\n2. Add the following DDL functions. The error occurs after attempting to run `CREATE FUNCTION api::LoginCredentialSession`.\r\n```sql\r\nWITH MODULE api\r\nCREATE FUNCTION validate_credentials(EMAIL: str, PASS: str) -> SET OF api::User\r\nUSING EdgeQL $$\r\n    WITH MODULE api\r\n    SELECT\r\n        User\r\n    FILTER\r\n        .email = EMAIL\r\n        AND\r\n        .password = PASS\r\n    LIMIT 1\r\n$$;\r\n\r\nWITH MODULE api\r\nCREATE FUNCTION random_big_str_id() -> str\r\nUSING EdgeQL $$\r\n    SELECT \r\n        std::re_replace(\r\n            r'^[ \\t]+',\r\n            r'',\r\n            (\r\n                SELECT std::to_str(\r\n                    random() * 10 ^ 256, \r\n                    '999999999999999999999\\\r\n                     999999999999999999999\\\r\n                     999999999999999999999\\\r\n                     999999999999999999999\\\r\n                     999999999999999999999\\\r\n                     999999999999999999999\\\r\n                     999999999999999999999\\\r\n                     999999999999999999999\\\r\n                     999999999999999999999\\\r\n                     999999999999999999999\\\r\n                     999999999999999999999\\\r\n                     999999999999999999999\\\r\n                     99999'\r\n                )\r\n            )\r\n        )\r\n$$;\r\n\r\nWITH MODULE api\r\nCREATE FUNCTION create_new_session(EMAIL: str, PASS: str) -> api::Session\r\nUSING EdgeQL $$\r\n    WITH MODULE api\r\n    INSERT Session {\r\n        token := <str>(SELECT api::random_big_str_id()),\r\n        sessionID := <str>(SELECT api::random_big_str_id()),\r\n        user := (SELECT api::validate_credentials(EMAIL, PASS) LIMIT 1)\r\n    }\r\n$$;\r\nWITH MODULE api\r\nCREATE FUNCTION LoginCredentialSession(EMAIL: str, PASS: str) -> SET OF api::Session\r\nUSING EdgeQL $$\r\n    # First case to split on is whether the user\r\n    # authenticates correctly:\r\n    WITH MODULE api\r\n    SELECT ( \r\n        SELECT Session\r\n        FILTER .sessionID = (\r\n            SELECT (SELECT api::create_new_session(EMAIL, PASS))\r\n            ).sessionID\r\n        )\r\n    )\r\n    IF\r\n    (\r\n        SELECT api::validate_credentials(EMAIL, PASS)) ?!= <Session>{}\r\n    )\r\n    ELSE <Session>{}\r\n$$;\r\n```\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n```sql\r\nCREATE MIGRATION %s TO {\r\n    module api {\r\n        type Session {\r\n            property token -> str;\r\n            required link user -> User;\r\n            required property sessionID -> str;\r\n            required property createdAt -> datetime {\r\n                default := datetime_current();\r\n            }\r\n            required property allottedDuration -> duration {\r\n                default := <duration>'24 hours';\r\n            }\r\n        }\r\n        type User {\r\n            required property name -> str;\r\n            property isDevice -> bool {\r\n                default := False\r\n            }\r\n            link device -> Device;\r\n            multi link devices -> Device;\r\n            property phone_1 -> str {\r\n                default := '';\r\n            }\r\n            property phone_2 -> str {\r\n                default := '';\r\n            }\r\n            property email -> str;\r\n            property storageDirectory := ('/' ++ __source__.email ++ '/');\r\n            property _storageDirectory := ('/ware/blob' ++ __source__.storageDirectory);\r\n            property password -> str;\r\n            property isAdmin -> bool {\r\n                default := False;\r\n            }\r\n            required property isGuest -> bool {\r\n                default := False;\r\n            }\r\n            multi link files -> File;\r\n            multi link widgets -> Widget;\r\n        }\r\n        type Device {\r\n            property device_name -> str;\r\n            property ipv4_address -> str;\r\n            property ipv6_address -> str;\r\n            property mac_address -> str;\r\n            property online -> bool;\r\n        }\r\n        type Widget {\r\n            required property name -> str;\r\n            property path -> str;\r\n            property executable_name -> str;\r\n            property indexHtmlPath -> str;\r\n            property runCommand -> str;\r\n        }\r\n        type File {\r\n            required property filename -> str;\r\n            required property path -> str;\r\n            required property readable -> bool {\r\n                default := True;\r\n            }\r\n            required property writeable -> bool {\r\n                default := True;\r\n            }\r\n            required property executable -> bool {\r\n                default := False;\r\n            }\r\n            required property isDirectory -> bool {\r\n                default := False;\r\n            }\r\n            required property isPublic -> bool {\r\n                default := False;\r\n            }\r\n            required property isDownloadable -> bool {\r\n                default := True;\r\n            }\r\n            property uploadedBy -> str;\r\n            property uploadedAt -> datetime {\r\n                default := datetime_current();\r\n            }\r\n            required property temporary -> bool {\r\n                default := False;\r\n            }\r\n        }\r\n    }\r\n};\r\nCOMMIT MIGRATION %s;\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1259/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1259/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1258", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1258/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1258/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1258/events", "html_url": "https://github.com/edgedb/edgedb/issues/1258", "id": 569398888, "node_id": "MDU6SXNzdWU1NjkzOTg4ODg=", "number": 1258, "title": "Bad type names in errors (raw object representation)", "user": {"login": "Fogapod", "id": 22667809, "node_id": "MDQ6VXNlcjIyNjY3ODA5", "avatar_url": "https://avatars.githubusercontent.com/u/22667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Fogapod", "html_url": "https://github.com/Fogapod", "followers_url": "https://api.github.com/users/Fogapod/followers", "following_url": "https://api.github.com/users/Fogapod/following{/other_user}", "gists_url": "https://api.github.com/users/Fogapod/gists{/gist_id}", "starred_url": "https://api.github.com/users/Fogapod/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Fogapod/subscriptions", "organizations_url": "https://api.github.com/users/Fogapod/orgs", "repos_url": "https://api.github.com/users/Fogapod/repos", "events_url": "https://api.github.com/users/Fogapod/events{/privacy}", "received_events_url": "https://api.github.com/users/Fogapod/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1590066979, "node_id": "MDU6TGFiZWwxNTkwMDY2OTc5", "url": "https://api.github.com/repos/edgedb/edgedb/labels/easy", "name": "easy", "color": "48ce9f", "default": false, "description": ""}, {"id": 1706980018, "node_id": "MDU6TGFiZWwxNzA2OTgwMDE4", "url": "https://api.github.com/repos/edgedb/edgedb/labels/usability", "name": "usability", "color": "5e02d6", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2020-02-22T21:56:18Z", "updated_at": "2020-05-29T19:09:06Z", "closed_at": "2020-05-29T19:09:06Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: `1.0-alpha.3+dev.69.g4f0eef61.d20200222`\r\n\r\nInitially I wanted to comment on #1134, but I found a few more bad errors and decided to create a separate issue that can be used for tracking bad error messages.\r\n\r\nSteps to reproduce:\r\n|                   operation                  | good |                                query                               |\r\n|:--------------------------------------------:|:----:|:------------------------------------------------------------------:|\r\n| create constraint - missing type             |   \u2705  | ALTER TYPE b ALTER PROPERTY b CREATE CONSTRAINT std::regexp(r'b'); |\r\n| create constraint - missing property         |   \u2b1c\ufe0f  | ALTER TYPE a ALTER PROPERTY b CREATE CONSTRAINT std::regexp(r'b'); |\r\n| drop constraint - missing type               |   \u2b1c\ufe0f  | ALTER TYPE b ALTER PROPERTY b DROP CONSTRAINT a;                   |\r\n| drop constraint - missing property           |   \u2b1c\ufe0f  | ALTER TYPE a ALTER PROPERTY b DROP CONSTRAINT a;                   |\r\n| drop constraint - missing constraint         |   \u2b1c\ufe0f  | ALTER TYPE a ALTER PROPERTY a DROP CONSTRAINT a;                   |\r\n| alter type annotation - missing type         |   \u2705  | ALTER TYPE b ALTER ANNOTATION title := 'a';                        |\r\n| alter type annotation - missing annotation   |   \u2b1c\ufe0f  | ALTER TYPE a ALTER ANNOTATION title := 'a';                        |\r\n| alter property annotation - missing type     |   \u2705  | ALTER TYPE b ALTER PROPERTY b ALTER ANNOTATION title := 'a';       |\r\n| alter property annotation - missing property |   \u2b1c\ufe0f  | ALTER TYPE a ALTER PROPERTY b ALTER ANNOTATION title := 'a';       |\r\n| drop type - missing type                     |   \u2705  | DROP TYPE b;                                                       |\r\n| drop property - missing type                 |   \u2b1c\ufe0f  | ALTER TYPE b DROP PROPERTY b;                                      |\r\n| drop property - missing property             |   \u2b1c\ufe0f  | ALTER TYPE a DROP PROPERTY b;                                      |\r\n\r\nQueries that are not \"good\" produce results like `InvalidReferenceError: schema item 'default::default|a@@default|__|b@@default|b@da39a3ee5e6b4b0d3255bfef95601890afd80709' does not exist`.\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema:\r\n```\r\nCREATE TYPE a { \r\n   CREATE PROPERTY a -> str { \r\n     CREATE CONSTRAINT std::regexp(r'a'); \r\n   }; \r\n};\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1258/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1258/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1255", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1255/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1255/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1255/events", "html_url": "https://github.com/edgedb/edgedb/issues/1255", "id": 569233185, "node_id": "MDU6SXNzdWU1NjkyMzMxODU=", "number": 1255, "title": "Ad-hoc tuple computable causes an error if used in FILTER.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-02-21T23:21:45Z", "updated_at": "2020-02-22T20:42:59Z", "closed_at": "2020-02-22T20:42:59Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\ndb> CREATE TYPE Foo {CREATE property bar -> tuple<int64, str>};\r\nCREATE\r\ndb> INSERT Foo {bar := (1, 'qqq')};\r\n{Object { id: <uuid>'21b756d0-5500-11ea-a40d-9fd3586f1102' }}\r\ndb> SELECT Foo {\r\n...     b := (.bar.1, .bar.0)\r\n... } FILTER .b.0 = 'qqq';\r\nInternalServerError: 'NoneType' object has no attribute 'source'\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1255/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1255/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1254", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1254/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1254/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1254/events", "html_url": "https://github.com/edgedb/edgedb/issues/1254", "id": 569224500, "node_id": "MDU6SXNzdWU1NjkyMjQ1MDA=", "number": 1254, "title": "The `DESCRIBE` command should preserve original expressions where possible", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 932934397, "node_id": "MDU6TGFiZWw5MzI5MzQzOTc=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/edgeql", "name": "edgeql", "color": "0052cc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-02-21T22:53:04Z", "updated_at": "2020-08-12T17:19:14Z", "closed_at": "2020-08-12T17:19:14Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Currently `DESCRIBE MODULE ... AS SDL` provides a normalized expression for the default values as opposed to the original expression.\r\n\r\nSee [this spectrum post](https://spectrum.chat/edgedb/general/production-ready~8f220310-d1c7-4b92-bb48-b637e0e7a447?m=MTU4MjI4Mjk4MTI1Ng==)", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1254/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1254/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1243", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1243/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1243/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1243/events", "html_url": "https://github.com/edgedb/edgedb/issues/1243", "id": 567893666, "node_id": "MDU6SXNzdWU1Njc4OTM2NjY=", "number": 1243, "title": "Nested insert fails for some GraphQL queries", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1284200502, "node_id": "MDU6TGFiZWwxMjg0MjAwNTAy", "url": "https://api.github.com/repos/edgedb/edgedb/labels/graphql", "name": "graphql", "color": "c2b0f4", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-02-19T22:40:50Z", "updated_at": "2020-02-20T02:13:29Z", "closed_at": "2020-02-20T02:13:29Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This is based on [spectrum chat](https://spectrum.chat/edgedb/general/graphql-insert-error-typeerror-argument-of-type-nonetype-is-not-iterable~31799eaa-a7c0-49e7-9d6f-587bdcc964f7).\r\n\r\nGiven the following schema:\r\n```\r\ntype Person {\r\n  property first_name -> str;\r\n  property last_name -> str;\r\n  property email -> str {\r\n    constraint exclusive;\r\n  }\r\n}\r\ntype Team {\r\n  property name -> str;\r\n  multi link members -> Person;\r\n  multi link chats -> Chat; \r\n}\r\ntype Chat {\r\n  property topic -> str;\r\n  multi link messages -> TextMessage\r\n}\r\ntype TextMessage {\r\n  link sender -> Person;\r\n  required property content -> str;\r\n}\r\n```\r\n\r\nThe following GraphQL query fails:\r\n```\r\nmutation insert_teams2 {\r\n  insert_Team(data: [\r\n    {\r\n      name: \"Test Team2\", \r\n      chats: [\r\n        {\r\n          data: {\r\n            topic: \"Ressources & info\", \r\n            messages: [\r\n              {\r\n                data: {\r\n                  sender: {\r\n                    filter: {email: {eq: \"1@example.com\"}}\r\n                  }, \r\n                  content: \"stuff\"\r\n                }\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  ]) {\r\n    id\r\n  }\r\n}\r\n```\r\n\r\nNote that in order for the query to work as written, the `email` field must have the `exclusive` constraint.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1243/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1243/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1233", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1233/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1233/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1233/events", "html_url": "https://github.com/edgedb/edgedb/issues/1233", "id": 566430528, "node_id": "MDU6SXNzdWU1NjY0MzA1Mjg=", "number": 1233, "title": "GraphQL - enums cannot be used in InsertTYPE mutations", "user": {"login": "haikyuu", "id": 8558836, "node_id": "MDQ6VXNlcjg1NTg4MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/8558836?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haikyuu", "html_url": "https://github.com/haikyuu", "followers_url": "https://api.github.com/users/haikyuu/followers", "following_url": "https://api.github.com/users/haikyuu/following{/other_user}", "gists_url": "https://api.github.com/users/haikyuu/gists{/gist_id}", "starred_url": "https://api.github.com/users/haikyuu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haikyuu/subscriptions", "organizations_url": "https://api.github.com/users/haikyuu/orgs", "repos_url": "https://api.github.com/users/haikyuu/repos", "events_url": "https://api.github.com/users/haikyuu/events{/privacy}", "received_events_url": "https://api.github.com/users/haikyuu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1284200502, "node_id": "MDU6TGFiZWwxMjg0MjAwNTAy", "url": "https://api.github.com/repos/edgedb/edgedb/labels/graphql", "name": "graphql", "color": "c2b0f4", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-02-17T17:16:16Z", "updated_at": "2020-02-18T23:13:49Z", "closed_at": "2020-02-18T23:13:49Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: alpha2\r\n- OS Version: Ubuntu\r\nEven though the enum is defined in Graphql\r\n\r\n![image](https://user-images.githubusercontent.com/8558836/74673960-9854a700-51b0-11ea-9592-07996092cea1.png)\r\n\r\nThe property is not found in the types that have it. Meaning `InsertPrice` mutation in graphql doesn't accept currency property.\r\n```\r\ntype Price{\r\n  property currency -> Currency {\r\n   default := <Currency>'USD';\r\n  };\r\n}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1233/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1233/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1227", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1227/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1227/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1227/events", "html_url": "https://github.com/edgedb/edgedb/issues/1227", "id": 566257919, "node_id": "MDU6SXNzdWU1NjYyNTc5MTk=", "number": 1227, "title": "Graphql - error in non nullable custom scalar types (enum)", "user": {"login": "haikyuu", "id": 8558836, "node_id": "MDQ6VXNlcjg1NTg4MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/8558836?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haikyuu", "html_url": "https://github.com/haikyuu", "followers_url": "https://api.github.com/users/haikyuu/followers", "following_url": "https://api.github.com/users/haikyuu/following{/other_user}", "gists_url": "https://api.github.com/users/haikyuu/gists{/gist_id}", "starred_url": "https://api.github.com/users/haikyuu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haikyuu/subscriptions", "organizations_url": "https://api.github.com/users/haikyuu/orgs", "repos_url": "https://api.github.com/users/haikyuu/repos", "events_url": "https://api.github.com/users/haikyuu/events{/privacy}", "received_events_url": "https://api.github.com/users/haikyuu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1284200502, "node_id": "MDU6TGFiZWwxMjg0MjAwNTAy", "url": "https://api.github.com/repos/edgedb/edgedb/labels/graphql", "name": "graphql", "color": "c2b0f4", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-02-17T12:11:24Z", "updated_at": "2020-02-18T22:23:08Z", "closed_at": "2020-02-18T22:23:08Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: alpha2\r\n- OS Version: Ubuntu 18.04\r\n\r\nSteps to Reproduce:\r\n\r\n1. Create a new enum in your schema\r\n2. Make the enum required in one of the objects\r\n3. Error is thrown when exposing the graphql API. i.e when `configure system insert Port ...`\r\n## Schema\r\n```\r\nmodule default {\r\n    scalar type Currency extending enum<'USD', 'EURO'>;\r\n    type Credit {\r\n      required property currency -> Currency; \r\n     }\r\n```\r\n\r\n## Error\r\n```\r\nInternalServerError: unhandled errors in a TaskGroup; 1 sub errors: (AssertionError)\r\n + AssertionError: Can only create NonNull of a Nullable GraphQLType but got: None.\r\n |   File \"/usr/lib/x86_64-linux-gnu/edgedb-1-alpha2/lib/python3.8/site-packages/edb/server/baseport.py\", line 66, in new_compiler\r\n |     await compiler_worker.call('connect', dbname, dbver)\r\n |   File \"/usr/lib/x86_64-linux-gnu/edgedb-1-alpha2/lib/python3.8/site-packages/edb/server/procpool/pool.py\", line 120, in call\r\n |     raise exc\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1227/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1227/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1201", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1201/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1201/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1201/events", "html_url": "https://github.com/edgedb/edgedb/issues/1201", "id": 561336450, "node_id": "MDU6SXNzdWU1NjEzMzY0NTA=", "number": 1201, "title": "Unexpected cardinality error", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-02-06T23:44:57Z", "updated_at": "2020-03-10T21:11:51Z", "closed_at": "2020-03-10T21:11:51Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\ndb> WITH\r\n...     MODULE schema,\r\n...     I := Constraint\r\n... SELECT I {\r\n...     cons_subj := I.subject {\r\n...         of := I.subject[IS Pointer].<pointers[IS Source] {\r\n...             of := I.subject[IS Pointer].<pointers[IS Source][IS Link].<links[IS Source].name,\r\n...         },\r\n...     },\r\n... }\r\n... FILTER\r\n...     .cons_subj.of.name LIKE 'default::%'\r\n...     OR .cons_subj.of.of LIKE 'default::%';\r\nQueryError: possibly more than one element returned by an expression where only singletons are allowed\r\n```\r\nWhat's odd about this is that there's nothing in this query that I can think of that requires singleton cardinality.\r\nAnother issue is that this is not 100% reproducible, occasionally the query just goes through, so there's some non-deterministic component in this bug.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1201/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1201/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1187", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1187/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1187/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1187/events", "html_url": "https://github.com/edgedb/edgedb/issues/1187", "id": 559888491, "node_id": "MDU6SXNzdWU1NTk4ODg0OTE=", "number": 1187, "title": "Self-referencing alias DDL just stalls without failing", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1706980018, "node_id": "MDU6TGFiZWwxNzA2OTgwMDE4", "url": "https://api.github.com/repos/edgedb/edgedb/labels/usability", "name": "usability", "color": "5e02d6", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-02-04T18:04:23Z", "updated_at": "2020-02-05T00:04:29Z", "closed_at": "2020-02-05T00:04:29Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I can't meaningfully add this to the tests as it will just hang the test suite. So try this in REPL:\r\n```\r\nCREATE TYPE Foo {CREATE PROPERTY a -> str};\r\nCREATE ALIAS AliasFoo := Foo {b := AliasFoo};\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1187/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1187/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1184", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1184/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1184/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1184/events", "html_url": "https://github.com/edgedb/edgedb/issues/1184", "id": 559883372, "node_id": "MDU6SXNzdWU1NTk4ODMzNzI=", "number": 1184, "title": "Alias referencing another alias fails under some circumstances.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-02-04T17:54:34Z", "updated_at": "2021-02-02T20:22:24Z", "closed_at": "2021-02-02T20:22:24Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "It seems that when a schema-level alias either has a computable link or gets re-used in another schema-level alias as a computable link there's a problem processing DDL.\r\n\r\nFor example:\r\n```\r\ndb> # base type\r\n... CREATE TYPE Foo {CREATE PROPERTY a -> str};\r\nCREATE\r\ndb> CREATE ALIAS Alias0 := Foo {b := .a ++ 'b'};\r\nCREATE\r\ndb> START TRANSACTION;\r\nSTART TRANSACTION\r\ndb> CREATE ALIAS Alias2 := Foo {d := Alias0};\r\nCREATE\r\ndb> ROLLBACK;\r\nROLLBACK TRANSACTION\r\ndb> CREATE ALIAS Alias1 := Alias0 {c := .b ++ 'c'};\r\nCREATE\r\ndb> CREATE ALIAS Alias2 := Foo {d := Alias0};\r\nSchemaError: ObjectType 'default::default|Alias0@@w~1' is already present in the schema <Schema gen:3566 at 0x7f0e40ff9550>\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1184/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1184/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1182", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1182/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1182/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1182/events", "html_url": "https://github.com/edgedb/edgedb/issues/1182", "id": 559792866, "node_id": "MDU6SXNzdWU1NTk3OTI4NjY=", "number": 1182, "title": "InternalServerError error creating scalar type", "user": {"login": "Fogapod", "id": 22667809, "node_id": "MDQ6VXNlcjIyNjY3ODA5", "avatar_url": "https://avatars.githubusercontent.com/u/22667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Fogapod", "html_url": "https://github.com/Fogapod", "followers_url": "https://api.github.com/users/Fogapod/followers", "following_url": "https://api.github.com/users/Fogapod/following{/other_user}", "gists_url": "https://api.github.com/users/Fogapod/gists{/gist_id}", "starred_url": "https://api.github.com/users/Fogapod/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Fogapod/subscriptions", "organizations_url": "https://api.github.com/users/Fogapod/orgs", "repos_url": "https://api.github.com/users/Fogapod/repos", "events_url": "https://api.github.com/users/Fogapod/events{/privacy}", "received_events_url": "https://api.github.com/users/Fogapod/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 932934397, "node_id": "MDU6TGFiZWw5MzI5MzQzOTc=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/edgeql", "name": "edgeql", "color": "0052cc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-02-04T15:25:45Z", "updated_at": "2020-07-24T02:35:43Z", "closed_at": "2020-07-24T02:35:43Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: `1.0-alpha.2+dev.505.g5b68ec24`\r\n\r\nSteps to Reproduce:\r\n\r\n```\r\nSTART TRANSACTION;\r\nCREATE MIGRATION init TO {\r\n    module default {\r\n        scalar type unique_name extending str {\r\n            constraint exclusive;\r\n        }\r\n    }\r\n};\r\nCOMMIT MIGRATION init;\r\n```\r\nError: `InternalServerError: column \"78096142-4760-11ea-ad7d-c3dbbf5ced49\" does not exist`\r\n\r\nI found another InternalServerError while playing with this:\r\n```\r\nSTART TRANSACTION;\r\nCREATE MIGRATION init TO {\r\n    module default {\r\n        scalar type unique_name extending str {\r\n            constraint exclusive on (str_lower(__subject__));\r\n        }\r\n    }\r\n};\r\nCOMMIT MIGRATION init;\r\n```\r\nError: `InternalServerError: argument of CHECK must be type boolean, not type text`\r\n\r\nI'm not sure if the latter is a bug, I'm using it wrong, but `InternalServerError` is scary.\r\n\r\nIs it possible to declare `exclusive` constraint in scalar so that it checks lowercase value?\r\nMy plan to use it is:\r\n```\r\ntype User {\r\n    required property nickname -> unique_name;\r\n    # ...\r\n    index on (str_lower(__subject__.nickname));\r\n}\r\n```\r\n`unique_name` has other constraints, but I removed them to simplify my report.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1182/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1182/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1181", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1181/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1181/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1181/events", "html_url": "https://github.com/edgedb/edgedb/issues/1181", "id": 559764488, "node_id": "MDU6SXNzdWU1NTk3NjQ0ODg=", "number": 1181, "title": "Migration error: unable to create type with index", "user": {"login": "Fogapod", "id": 22667809, "node_id": "MDQ6VXNlcjIyNjY3ODA5", "avatar_url": "https://avatars.githubusercontent.com/u/22667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Fogapod", "html_url": "https://github.com/Fogapod", "followers_url": "https://api.github.com/users/Fogapod/followers", "following_url": "https://api.github.com/users/Fogapod/following{/other_user}", "gists_url": "https://api.github.com/users/Fogapod/gists{/gist_id}", "starred_url": "https://api.github.com/users/Fogapod/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Fogapod/subscriptions", "organizations_url": "https://api.github.com/users/Fogapod/orgs", "repos_url": "https://api.github.com/users/Fogapod/repos", "events_url": "https://api.github.com/users/Fogapod/events{/privacy}", "received_events_url": "https://api.github.com/users/Fogapod/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-02-04T14:41:52Z", "updated_at": "2020-02-11T17:54:05Z", "closed_at": "2020-02-11T17:54:05Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please search existing issues to avoid creating duplicates. -->\r\n- EdgeDB Version: `1.0-alpha.2+dev.505.g5b68ec24`\r\n\r\nSteps to Reproduce:\r\n\r\nRunning this migration\r\n```\r\nSTART TRANSACTION;\r\nCREATE MIGRATION test TO {\r\n    module default {\r\n        type Author {\r\n            required property name -> str;\r\n        }\r\n\r\n        type Comment {\r\n            required property body -> str;\r\n        }\r\n\r\n        type CommentRating {\r\n            required link author -> Author;\r\n            required link comment -> Comment;\r\n\r\n            index on ((__subject__.author, __subject__.comment));\r\n        }\r\n    }\r\n};\r\nCOMMIT MIGRATION test;\r\nCOMMIT;\r\n```\r\nresults in crypric error: `InvalidReferenceError: schema item 'default::__|author@@default|CommentRating' does not exist`\r\n\r\nIt looks like there is a problem with index creation: creating type before migration works. Working code:\r\n```\r\nSTART TRANSACTION;\r\n\r\nCREATE TYPE CommentRating;  # <----- added\r\n\r\nCREATE MIGRATION test TO {\r\n    module default {\r\n        type Author {\r\n            required property name -> str;\r\n        }\r\n\r\n        type Comment {\r\n            required property body -> str;\r\n        }\r\n\r\n        type CommentRating {\r\n            required link author -> Author;\r\n            required link comment -> Comment;\r\n\r\n            index on ((__subject__.author, __subject__.comment));\r\n        }\r\n    }\r\n};\r\nCOMMIT MIGRATION test;\r\nCOMMIT;\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1181/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1181/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1177", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1177/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1177/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1177/events", "html_url": "https://github.com/edgedb/edgedb/issues/1177", "id": 558849704, "node_id": "MDU6SXNzdWU1NTg4NDk3MDQ=", "number": 1177, "title": "failed to lookup transaction error", "user": {"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-02-03T05:21:32Z", "updated_at": "2020-05-26T07:09:20Z", "closed_at": "2020-05-26T07:09:20Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "`connection.execute` triggers an internal server error on the following script:\r\n\r\n```\r\nSTART TRANSACTION;\r\nCREATE MIGRATION test TO {\r\n    module default {\r\n        scalar type MyEnum extending enum<\"A\", \"B\">;\r\n        type Row {\r\n            property an_enum -> MyEnum;\r\n        }\r\n    }\r\n};\r\nCOMMIT MIGRATION test;\r\nCOMMIT;\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1177/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1177/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1175", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1175/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1175/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1175/events", "html_url": "https://github.com/edgedb/edgedb/issues/1175", "id": 558613886, "node_id": "MDU6SXNzdWU1NTg2MTM4ODY=", "number": 1175, "title": "Tuple/ GraphQL bug", "user": {"login": "agritheory", "id": 18033666, "node_id": "MDQ6VXNlcjE4MDMzNjY2", "avatar_url": "https://avatars.githubusercontent.com/u/18033666?v=4", "gravatar_id": "", "url": "https://api.github.com/users/agritheory", "html_url": "https://github.com/agritheory", "followers_url": "https://api.github.com/users/agritheory/followers", "following_url": "https://api.github.com/users/agritheory/following{/other_user}", "gists_url": "https://api.github.com/users/agritheory/gists{/gist_id}", "starred_url": "https://api.github.com/users/agritheory/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/agritheory/subscriptions", "organizations_url": "https://api.github.com/users/agritheory/orgs", "repos_url": "https://api.github.com/users/agritheory/repos", "events_url": "https://api.github.com/users/agritheory/events{/privacy}", "received_events_url": "https://api.github.com/users/agritheory/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1284200502, "node_id": "MDU6TGFiZWwxMjg0MjAwNTAy", "url": "https://api.github.com/repos/edgedb/edgedb/labels/graphql", "name": "graphql", "color": "c2b0f4", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-02-01T23:19:51Z", "updated_at": "2020-02-25T18:20:44Z", "closed_at": "2020-02-25T18:20:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "- EdgeDB Version: alpha2\r\n- OS Version: Ubunut 18.04\r\n\r\n```\r\nInternalServerError: unhandled errors in a TaskGroup; 1 sub errors: (AttributeError)\r\n + AttributeError: 'Tuple' object has no attribute 'get_topmost_concrete_base'\r\n |   File \"/usr/lib/x86_64-linux-gnu/edgedb-1-alpha2/lib/python3.8/site-packages/edb/server/baseport.py\", line 66, in new_compiler\r\n |     await compiler_worker.call('connect', dbname, dbver)\r\n |   File \"/usr/lib/x86_64-linux-gnu/edgedb-1-alpha2/lib/python3.8/site-packages/edb/server/procpool/pool.py\", line 120, in call\r\n |     raise exc\r\n```\r\n\r\n\r\nSteps to Reproduce:\r\nSchema is below; I'm trying to set up graphql on a database with a tuple scalar... which where I think this error is coming from.\r\n\r\n<!-- If the issue is about a query error, please also provide your schema -->\r\nSchema (Tuples)\r\n```\r\nSCALAR TYPE root_account_type_enum EXTENDING enum<'Asset', 'Liability', 'Equity', 'Income', 'Expense'>;\r\n        SCALAR TYPE report_type_enum EXTENDING enum<'BalanceSheet', 'ProfitAndLoss'>;\r\n```\r\nSchema (Object)\r\n```\r\n      type Account {\r\n        required property name -> str;\r\n        required property account_number -> str;\r\n        required link company -> Company;\r\n        required link account_currency -> Currency;\r\n        link parent_account -> Account;\r\n        required property root_account_type -> root_account_type_enum;\r\n        required property report_type -> report_type_enum;\r\n        property has_subledger -> bool;\r\n        link children_accounts := .<parent_account[IS Account];\r\n        index on (.name) {\r\n            annotation indextitle := 'Account Index';\r\n        }\r\n      }\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1175/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1175/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1174", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1174/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1174/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1174/events", "html_url": "https://github.com/edgedb/edgedb/issues/1174", "id": 558555959, "node_id": "MDU6SXNzdWU1NTg1NTU5NTk=", "number": 1174, "title": "Current version does not automatically update in /var/lib/edgedb/current alpha1 to alpha2", "user": {"login": "agritheory", "id": 18033666, "node_id": "MDQ6VXNlcjE4MDMzNjY2", "avatar_url": "https://avatars.githubusercontent.com/u/18033666?v=4", "gravatar_id": "", "url": "https://api.github.com/users/agritheory", "html_url": "https://github.com/agritheory", "followers_url": "https://api.github.com/users/agritheory/followers", "following_url": "https://api.github.com/users/agritheory/following{/other_user}", "gists_url": "https://api.github.com/users/agritheory/gists{/gist_id}", "starred_url": "https://api.github.com/users/agritheory/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/agritheory/subscriptions", "organizations_url": "https://api.github.com/users/agritheory/orgs", "repos_url": "https://api.github.com/users/agritheory/repos", "events_url": "https://api.github.com/users/agritheory/events{/privacy}", "received_events_url": "https://api.github.com/users/agritheory/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-02-01T15:30:53Z", "updated_at": "2020-05-25T19:22:44Z", "closed_at": "2020-05-25T19:22:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "- EdgeDB Version: switching from alpha1 to alpha2\r\n- OS Version: ubuntu 18.04\r\n\r\nSteps to Reproduce:\r\n\r\n1. Install apha2\r\n2. Uninstall alpha1\r\n3. Start alpha2 \r\n3. Run `edgedb` command\r\n\r\nThis returns:\r\n> /usr/bin/edgedb: 15: exec: /usr/lib/x86_64-linux-gnu/edgedb-1-alpha1/bin/edgedb: not found\r\n\r\nThis can be resolved manually (on ubuntu) with:\r\ncd /var/lib/edgedb/\r\nsudo nano current\r\n\r\nEdit `/usr/lib/x86_64-linux-gnu/edgedb-1-alpha1/bin` to `/usr/lib/x86_64-linux-gnu/edgedb-1-alpha2/bin`\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1174/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1174/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1170", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1170/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1170/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1170/events", "html_url": "https://github.com/edgedb/edgedb/issues/1170", "id": 557727933, "node_id": "MDU6SXNzdWU1NTc3Mjc5MzM=", "number": 1170, "title": "InternalServerError: more than one row returned by a subquery used as an expression", "user": {"login": "jaclarke", "id": 2085287, "node_id": "MDQ6VXNlcjIwODUyODc=", "avatar_url": "https://avatars.githubusercontent.com/u/2085287?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaclarke", "html_url": "https://github.com/jaclarke", "followers_url": "https://api.github.com/users/jaclarke/followers", "following_url": "https://api.github.com/users/jaclarke/following{/other_user}", "gists_url": "https://api.github.com/users/jaclarke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaclarke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaclarke/subscriptions", "organizations_url": "https://api.github.com/users/jaclarke/orgs", "repos_url": "https://api.github.com/users/jaclarke/repos", "events_url": "https://api.github.com/users/jaclarke/events{/privacy}", "received_events_url": "https://api.github.com/users/jaclarke/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 932934397, "node_id": "MDU6TGFiZWw5MzI5MzQzOTc=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/edgeql", "name": "edgeql", "color": "0052cc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2020-01-30T20:17:14Z", "updated_at": "2022-03-02T21:57:28Z", "closed_at": "2022-03-02T21:57:27Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- EdgeDB Version: 1.0-alpha.2+g16f75ece5.d20200122\r\n- OS Version: Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-1051-aws x86_64)\r\n\r\nTrying to update a multi link fails if the set returned by a `FOR x IN y UNION ...` expression contains duplicate objects. A workaround trying to add the duplicate objects separately fails with `QueryError: invalid reference to link property in top level shape`, same as in this issue: #904\r\n\r\nSteps to Reproduce:\r\n```\r\nCREATE TYPE Person {\r\n  CREATE REQUIRED PROPERTY name -> str;\r\n};\r\n\r\nCREATE TYPE Movie {\r\n  CREATE REQUIRED PROPERTY title -> str;\r\n  CREATE MULTI LINK cast -> Person {\r\n    CREATE PROPERTY character -> str;\r\n  };\r\n};\r\n\r\nINSERT Person {\r\n  name := 'Actor 1'\r\n};\r\n\r\nINSERT Person {\r\n  name := 'Actor 2'\r\n};\r\n\r\nINSERT Movie {\r\n  title := 'Movie 1'\r\n};\r\n\r\n# This works with different actors\r\nWITH cast := [\r\n  (name := 'Actor 1', character := 'Some Character'),\r\n  (name := 'Actor 2', character := 'Another Character')\r\n]\r\nUPDATE Movie\r\nFILTER .title = 'Movie 1'\r\nSET {\r\n  cast := (\r\n    FOR actor IN {array_unpack(cast)}\r\n    UNION (\r\n      SELECT Person {\r\n        @character := actor.character\r\n      }\r\n      FILTER .name = actor.name\r\n    )\r\n  )\r\n};\r\n\r\n# This fails with error:\r\n# InternalServerError: more than one row returned by a subquery used as an expression\r\nWITH cast := [\r\n  (name := 'Actor 1', character := 'Some Character'),\r\n  (name := 'Actor 1', character := 'Another Character')\r\n#               ^ same actor\r\n]\r\nUPDATE Movie\r\nFILTER .title = 'Movie 1'\r\nSET {\r\n  cast := (\r\n    FOR actor IN {array_unpack(cast)}\r\n    UNION (\r\n      SELECT Person {\r\n        @character := actor.character\r\n      }\r\n      FILTER .name = actor.name\r\n    )\r\n  )\r\n};\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1170/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1170/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1155", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1155/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1155/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1155/events", "html_url": "https://github.com/edgedb/edgedb/pull/1155", "id": 552555859, "node_id": "MDExOlB1bGxSZXF1ZXN0MzY1MDQwMjU3", "number": 1155, "title": "docs: Fix broken links.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 646632736, "node_id": "MDU6TGFiZWw2NDY2MzI3MzY=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/documentation", "name": "documentation", "color": "5319e7", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-01-20T23:54:50Z", "updated_at": "2020-01-21T00:33:38Z", "closed_at": "2020-01-21T00:33:31Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/edgedb/edgedb/pulls/1155", "html_url": "https://github.com/edgedb/edgedb/pull/1155", "diff_url": "https://github.com/edgedb/edgedb/pull/1155.diff", "patch_url": "https://github.com/edgedb/edgedb/pull/1155.patch", "merged_at": "2020-01-21T00:33:31Z"}, "body": "Some links to PostgreSQL website in the \"Administration\"/\"Initial Setup\"\r\nwere broken. The RST link format was incorrect.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1155/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1155/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1147", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1147/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1147/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1147/events", "html_url": "https://github.com/edgedb/edgedb/issues/1147", "id": 551898322, "node_id": "MDU6SXNzdWU1NTE4OTgzMjI=", "number": 1147, "title": "InternalServerError during migration", "user": {"login": "Fogapod", "id": 22667809, "node_id": "MDQ6VXNlcjIyNjY3ODA5", "avatar_url": "https://avatars.githubusercontent.com/u/22667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Fogapod", "html_url": "https://github.com/Fogapod", "followers_url": "https://api.github.com/users/Fogapod/followers", "following_url": "https://api.github.com/users/Fogapod/following{/other_user}", "gists_url": "https://api.github.com/users/Fogapod/gists{/gist_id}", "starred_url": "https://api.github.com/users/Fogapod/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Fogapod/subscriptions", "organizations_url": "https://api.github.com/users/Fogapod/orgs", "repos_url": "https://api.github.com/users/Fogapod/repos", "events_url": "https://api.github.com/users/Fogapod/events{/privacy}", "received_events_url": "https://api.github.com/users/Fogapod/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-19T10:09:14Z", "updated_at": "2020-01-23T06:56:41Z", "closed_at": "2020-01-23T06:56:41Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "EdgeDB version: `1.0-alpha.2+dev.505.g5b68ec24`\r\n\r\nTypes from my current schema:\r\n```\r\ntype User {\r\n            required property nickname -> str;\r\n            required property created_at -> datetime {\r\n                default := datetime_current();\r\n                readonly := true;\r\n            };\r\n\r\n            property edited_at -> datetime;\r\n}\r\ntype Article {\r\n            link author -> User;\r\n}\r\n```\r\n`User` type has `created_at` and `eddited_at` properties, type `Article` does not.\r\n\r\nI created type `Editable` that looks this way:\r\n```\r\nabstract type Editable {\r\n            required property created_at -> datetime {\r\n                default := datetime_current();\r\n                readonly := true;\r\n            };\r\n            property edited_at -> datetime;\r\n        }\r\n```\r\n\r\nI used it to `Article` and `User` types:\r\n```\r\ntype User extending Editable {\r\n            required property nickname -> str;\r\n}\r\ntype Article extending Editable {\r\n            link author -> User;\r\n}\r\n```\r\n\r\nI tried running migration twice and got these errors:\r\n```\r\nInternalServerError: 'created_at'\r\nInternalServerError: 'edited_at'\r\n```\r\n\r\nI ran server with debug logging, there are no logs.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1147/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1147/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1140", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1140/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1140/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1140/events", "html_url": "https://github.com/edgedb/edgedb/issues/1140", "id": 551682291, "node_id": "MDU6SXNzdWU1NTE2ODIyOTE=", "number": 1140, "title": "Restrict `VERBOSE` usage in `DESCRIBE`", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 932934397, "node_id": "MDU6TGFiZWw5MzI5MzQzOTc=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/edgeql", "name": "edgeql", "color": "0052cc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-01-17T23:44:21Z", "updated_at": "2020-01-18T01:40:23Z", "closed_at": "2020-01-18T01:40:23Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "The only usage of `VERBOSE` flag that has any effect is with the `DESCRIBE ... AS TEXT VERBOSE`. The grammar should reflect that.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1140/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1140/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1138", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1138/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1138/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1138/events", "html_url": "https://github.com/edgedb/edgedb/issues/1138", "id": 551606982, "node_id": "MDU6SXNzdWU1NTE2MDY5ODI=", "number": 1138, "title": "GraphQL and EdgeDB numeric types", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1284200502, "node_id": "MDU6TGFiZWwxMjg0MjAwNTAy", "url": "https://api.github.com/repos/edgedb/edgedb/labels/graphql", "name": "graphql", "color": "c2b0f4", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-01-17T20:03:48Z", "updated_at": "2020-01-20T20:03:16Z", "closed_at": "2020-01-20T20:03:16Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "GraphQL spec defines `Int` as `int32` and `Float` as `float64` specifically. The definitions are actually very rigid and currently we don't quite adhere to these limitations when mapping EdgeDB types onto GraphQL.\r\n\r\nThe solution would be to add custom scalars like `Int64`, `Bigint` and `Decimal` so that we can map EdgeDB types in the following way:\r\n```\r\nint16 -> Int\r\nint32 -> Int\r\nint64 -> Int64\r\nbigint -> Bigint\r\nfloat32 -> Float\r\nfloat64 -> Float\r\ndecimal -> Decimal\r\n```\r\nThe actual number representations (both in terms of input and output formats) will adhere to valid representations of `Int` and `Float` since the parsing spec and output spec don't put a limit on the digits for either one of these. So crucially, GraphQL `Decimal` and `Bigint` won't have a special suffix like their counterparts in EdgeQL do. This is not very important for `Bigint` as it's perfectly compatible with all the other integers and differs only in the range. However, for `Decimal` vs. `Float` the number `1.23` actually has a different value, so we'll have to be careful when reading these literals to infer the correct type so that the actual values passed to EdgeDB don't get unexpectedly mangled. ", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1138/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1138/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1119", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1119/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1119/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1119/events", "html_url": "https://github.com/edgedb/edgedb/issues/1119", "id": 550832003, "node_id": "MDU6SXNzdWU1NTA4MzIwMDM=", "number": 1119, "title": "Error creating role using CLI tool: please specify an attribute to alter", "user": {"login": "Fogapod", "id": 22667809, "node_id": "MDQ6VXNlcjIyNjY3ODA5", "avatar_url": "https://avatars.githubusercontent.com/u/22667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Fogapod", "html_url": "https://github.com/Fogapod", "followers_url": "https://api.github.com/users/Fogapod/followers", "following_url": "https://api.github.com/users/Fogapod/following{/other_user}", "gists_url": "https://api.github.com/users/Fogapod/gists{/gist_id}", "starred_url": "https://api.github.com/users/Fogapod/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Fogapod/subscriptions", "organizations_url": "https://api.github.com/users/Fogapod/orgs", "repos_url": "https://api.github.com/users/Fogapod/repos", "events_url": "https://api.github.com/users/Fogapod/events{/privacy}", "received_events_url": "https://api.github.com/users/Fogapod/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1590066979, "node_id": "MDU6TGFiZWwxNTkwMDY2OTc5", "url": "https://api.github.com/repos/edgedb/edgedb/labels/easy", "name": "easy", "color": "48ce9f", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-01-16T14:11:15Z", "updated_at": "2020-02-11T02:16:18Z", "closed_at": "2020-02-11T02:16:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "EdgeDB version: `1.0-alpha.2+dev.505.g5b68ec24`\r\n\r\nSteps to reproduce:\r\n```\r\n# edgedb --admin create-role test\r\nUsage: edgedb create-role [OPTIONS] ROLE_NAME\r\n\r\nError: please specify an attribute to alter\r\n```\r\nCommand fails with weird error message if `OPTIONS` were no provided, even though they're supposed to be optional according to help message.\r\nIt works if 1 or more options are present: `edgedb --admin create-role --allow-login test`\r\n\r\nCreating role inside interactive session without options works as expected:\r\n```\r\nmodbay_beta> CREATE ROLE test;                                                                                                                                                                                         \r\nCREATE\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1119/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1119/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1107", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1107/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1107/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1107/events", "html_url": "https://github.com/edgedb/edgedb/issues/1107", "id": 550318969, "node_id": "MDU6SXNzdWU1NTAzMTg5Njk=", "number": 1107, "title": "Investigate logic of `Flush` message", "user": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1710371090, "node_id": "MDU6TGFiZWwxNzEwMzcxMDkw", "url": "https://api.github.com/repos/edgedb/edgedb/labels/high%20priority", "name": "high priority", "color": "db62d1", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2020-01-15T17:11:27Z", "updated_at": "2021-02-09T01:43:21Z", "closed_at": "2020-06-18T15:23:44Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "# Motivation\r\n\r\nWhen we were using `Flush` instead of `Sync` in the (Rust) REPL the shell could hang on error (errors aren't flushed or something)\r\n\r\n# Investigate\r\n\r\n1. Take a look at `Flush`, it might not flush everything as it should\r\n2. Errors should always flush (or at least by default), even if there is no `Flush` message, there is no sense in optimizing that failure path.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1107/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1107/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1098", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1098/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1098/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1098/events", "html_url": "https://github.com/edgedb/edgedb/issues/1098", "id": 549364927, "node_id": "MDU6SXNzdWU1NDkzNjQ5Mjc=", "number": 1098, "title": "Incorrect or inconsistent results for computables based on a link", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-14T06:39:49Z", "updated_at": "2020-01-22T20:06:45Z", "closed_at": "2020-01-22T20:06:45Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Steps to reproduce:\r\n```\r\ndb> CREATE TYPE Foo {\r\n...   CREATE LINK next -> Foo;\r\n...   CREATE LINK prev := .<next[IS Foo];\r\n... };\r\nCREATE\r\ndb> SELECT Foo.prev.prev.id;\r\nInternalServerError: missing FROM-clause entry for table \"Foo_prev~5\"\r\n```\r\nIt's worth mentioning that an explicit `SELECT Foo.<next[IS Foo].next[IS Foo].id` works just fine.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1098/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1098/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1097", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1097/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1097/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1097/events", "html_url": "https://github.com/edgedb/edgedb/issues/1097", "id": 549359540, "node_id": "MDU6SXNzdWU1NDkzNTk1NDA=", "number": 1097, "title": "InternalServerError on DELETE operation of self-refential type.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-14T06:24:00Z", "updated_at": "2020-01-20T21:44:21Z", "closed_at": "2020-01-20T21:44:21Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Steps to reproduce:\r\n```\r\ndb> CREATE TYPE Foo { \r\n...   CREATE LINK next -> Foo; \r\n...   CREATE LINK prev := .<next[IS Foo]; \r\n... };                                                                                                                         \r\nCREATE\r\ndb> INSERT Foo;                                                                                                                \r\n{Object { id: <uuid>'29f164ea-3696-11ea-9a67-47bc7013c36f' }}\r\ndb> DELETE Foo;                                                                                                                \r\nInternalServerError: relation \"edgedb_cc19d764-365f-11ea-a69a-8dd80ac4c3d3.2785b336-3696-11ea-abbb-b538a104f38f\" does not exist\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1097/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1097/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1080", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1080/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1080/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1080/events", "html_url": "https://github.com/edgedb/edgedb/issues/1080", "id": 548379084, "node_id": "MDU6SXNzdWU1NDgzNzkwODQ=", "number": 1080, "title": "Nested INSERT bug", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 932934397, "node_id": "MDU6TGFiZWw5MzI5MzQzOTc=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/edgeql", "name": "edgeql", "color": "0052cc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2020-01-11T04:25:45Z", "updated_at": "2021-08-25T20:37:25Z", "closed_at": "2021-08-25T20:37:25Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\ndb> CREATE TYPE Foo {CREATE LINK bar -> Object};\r\nCREATE\r\ndb> INSERT Foo {bar := (INSERT Foo)};\r\nQueryError: invalid reference to default::Foo: self-referencing INSERTs are not allowed\r\nHint: Use DETACHED if you meant to refer to an uncorrelated default::Foo set\r\n### INSERT Foo {bar := (INSERT Foo)};\r\n###\r\n```\r\nThis looks like a bug to me. I was under the impression that the thing right after `INSERT` is supposed to be a type name, not an arbitrary expression, as such there cannot be a problem of self-reference. If memory serves me, we couldn't actually guarantee that self-references in an `INSERT` would work (say for use in a subquery selecting some link based on other yet-to-be-inserted data that appears syntactically in the `INSERT` statement).\r\n\r\nAs far as I recall this is illegal:\r\n```\r\nINSERT Bar {\r\n    a := 'data',\r\n    b := .a\r\n};\r\n```\r\nAm I misunderstanding `INSERT`?\r\n\r\nJust to clarify, the intent is to simple create 2 `Foo` objects where one is linked to the other. This is *not* intended or expected to be some sort of self-link.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1080/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1080/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1076", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1076/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1076/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1076/events", "html_url": "https://github.com/edgedb/edgedb/issues/1076", "id": 548345597, "node_id": "MDU6SXNzdWU1NDgzNDU1OTc=", "number": 1076, "title": "`DESCRIBE` ignores `ON TARGET DELETE`", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-01-10T23:58:49Z", "updated_at": "2020-01-11T01:39:09Z", "closed_at": "2020-01-11T01:39:09Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\ndb> CREATE TYPE Foo {CREATE LINK bar -> Object {ON TARGET DELETE ALLOW}};\r\nCREATE\r\ndb> DESCRIBE TYPE Foo;\r\n{'CREATE TYPE default::Foo {\r\n    CREATE SINGLE LINK bar -> std::Object;\r\n};'}\r\ndb> DESCRIBE TYPE Foo AS SDL;\r\n{'type default::Foo {\r\n    single link bar -> std::Object;\r\n};'}\r\ndb> DESCRIBE TYPE Foo AS TEXT;\r\n{\r\n    'type default::Foo {\r\n    required single link __type__ -> schema::Type {\r\n        readonly := true;\r\n    };\r\n    single link bar -> std::Object;\r\n    required single property id -> std::uuid {\r\n        readonly := true;\r\n    };\r\n};'\r\n}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1076/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1076/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1010", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1010/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1010/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1010/events", "html_url": "https://github.com/edgedb/edgedb/issues/1010", "id": 541419425, "node_id": "MDU6SXNzdWU1NDE0MTk0MjU=", "number": 1010, "title": "Union types cause problems as link targets.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-12-22T07:41:18Z", "updated_at": "2019-12-26T03:46:05Z", "closed_at": "2019-12-26T03:46:05Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Several problems occur with union types as link targets.\r\n```\r\nabstract type R {\r\n    required property name -> str {\r\n        delegated constraint exclusive;\r\n    }\r\n}\r\ntype S extending R {\r\n    required property s -> str;\r\n}\r\ntype T extending R {\r\n    required property t -> str;\r\n}\r\nabstract type U {\r\n    required property u -> str;\r\n}\r\ntype V extending U, S, T;\r\ntype W {\r\n    required property name -> str {\r\n        constraint exclusive;\r\n    }\r\n    link w -> W;\r\n}\r\n\r\n# link target as a union type\r\ntype Z {\r\n    # have 'name' in common\r\n    link stw0 -> S | T | W;\r\n    multi link stw1 -> S | T | W;\r\n}\r\n```\r\n\r\nInserting data seems to go without error:\r\n```\r\nINSERT S {name:= 'name0', s := 's0'};\r\nINSERT T {name:= 'name0', t := 't0'};\r\nINSERT V {name:= 'name1', s := 's1', t := 't1', u := 'u1'};\r\nINSERT W {name := 'w0'};\r\n\r\nINSERT Z { \r\n    stw0 := (\r\n        SELECT V FILTER .name = 'name1' \r\n        LIMIT 1\r\n    ), \r\n    stw1 := (\r\n        SELECT V FILTER .name = 'name1'\r\n    ), \r\n}; \r\n```\r\nThe problem arises with `SELECT`:\r\n```\r\ndb> SELECT V {name};\r\n{Object { name: 'name1' }}\r\ndb> SELECT Z {stw1: {name}};\r\n{Object { stw1: {Object { name: 'name1' }, Object { name: 'name1' }} }}\r\ndb> SELECT Z {stw0: {name}};\r\nInternalServerError: more than one row returned by a subquery used as an expression\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1010/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1010/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1008", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1008/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1008/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1008/events", "html_url": "https://github.com/edgedb/edgedb/issues/1008", "id": 541278355, "node_id": "MDU6SXNzdWU1NDEyNzgzNTU=", "number": 1008, "title": "The 'readonly' flag does not appear to work.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-12-21T03:56:38Z", "updated_at": "2019-12-25T03:56:04Z", "closed_at": "2019-12-25T03:56:04Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "As far as I can tell, `readonly` doesn't work.\r\n\r\n```\r\ndb> CREATE TYPE R {\r\n...     CREATE PROPERTY once -> str {\r\n...         SET readonly := True;\r\n...     };\r\n... };\r\nCREATE\r\ndb> INSERT R {once := 'test'};\r\n{Object { id: <uuid>'668e42be-23a5-11ea-ae15-bf34b48b91de' }}\r\ndb> SELECT R{once};\r\n{Object { once: 'test' }}\r\ndb> UPDATE R SET {once := 'changed'};\r\n{Object { id: <uuid>'668e42be-23a5-11ea-ae15-bf34b48b91de' }}\r\ndb> SELECT R{once};\r\n{Object { once: 'changed' }}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1008/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1008/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1006", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1006/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1006/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1006/events", "html_url": "https://github.com/edgedb/edgedb/issues/1006", "id": 541269341, "node_id": "MDU6SXNzdWU1NDEyNjkzNDE=", "number": 1006, "title": "Need an `ALTER FUNCTION` DDL", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 932934397, "node_id": "MDU6TGFiZWw5MzI5MzQzOTc=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/edgeql", "name": "edgeql", "color": "0052cc", "default": false, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-12-21T02:09:07Z", "updated_at": "2020-09-29T19:09:47Z", "closed_at": "2020-09-29T19:09:47Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Currently functions only have `CREATE` and `DROP` DDL, which means that function annotations cannot be altered once they are set (or not set, for that matter).", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1006/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1006/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1005", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/1005/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/1005/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/1005/events", "html_url": "https://github.com/edgedb/edgedb/issues/1005", "id": 541227232, "node_id": "MDU6SXNzdWU1NDEyMjcyMzI=", "number": 1005, "title": "Constraints should not propagate to type variants.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-12-20T22:23:48Z", "updated_at": "2020-01-11T05:52:24Z", "closed_at": "2020-01-11T05:52:24Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Currently a constraint on the real type will be inherited by the type variant, but only if the constraint on the original type is added _after_ the type variant is creates.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/1005/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/1005/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/968", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/968/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/968/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/968/events", "html_url": "https://github.com/edgedb/edgedb/issues/968", "id": 537931710, "node_id": "MDU6SXNzdWU1Mzc5MzE3MTA=", "number": 968, "title": "Bad error reporting when changing schema", "user": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1587344812, "node_id": "MDU6TGFiZWwxNTg3MzQ0ODEy", "url": "https://api.github.com/repos/edgedb/edgedb/labels/sql", "name": "sql", "color": "eff484", "default": false, "description": ""}, {"id": 1734403421, "node_id": "MDU6TGFiZWwxNzM0NDAzNDIx", "url": "https://api.github.com/repos/edgedb/edgedb/labels/migrations", "name": "migrations", "color": "317fed", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2019-12-14T16:05:14Z", "updated_at": "2020-09-29T19:18:50Z", "closed_at": "2020-09-29T19:18:49Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Initial schema is kinda:\r\n```\r\nmodule default {\r\n    type Ticket {\r\n        required property title -> str;\r\n    }\r\n}\r\n```\r\nAnd the new schema is:\r\n```\r\nmodule default {\r\n    abstract type Something {\r\n        property kind -> str;\r\n    }\r\n    type Ticket extending Something {\r\n        required property title -> str;\r\n    }\r\n}\r\n```\r\nI'm not sure if this update makes sense, but the error definitely don't:\r\n```\r\nInternalServerError: 'kind'\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/968/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/968/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/904", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/904/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/904/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/904/events", "html_url": "https://github.com/edgedb/edgedb/issues/904", "id": 530374060, "node_id": "MDU6SXNzdWU1MzAzNzQwNjA=", "number": 904, "title": "Can't update multi link with link property", "user": {"login": "kfrp", "id": 6949436, "node_id": "MDQ6VXNlcjY5NDk0MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/6949436?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kfrp", "html_url": "https://github.com/kfrp", "followers_url": "https://api.github.com/users/kfrp/followers", "following_url": "https://api.github.com/users/kfrp/following{/other_user}", "gists_url": "https://api.github.com/users/kfrp/gists{/gist_id}", "starred_url": "https://api.github.com/users/kfrp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kfrp/subscriptions", "organizations_url": "https://api.github.com/users/kfrp/orgs", "repos_url": "https://api.github.com/users/kfrp/repos", "events_url": "https://api.github.com/users/kfrp/events{/privacy}", "received_events_url": "https://api.github.com/users/kfrp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 932934397, "node_id": "MDU6TGFiZWw5MzI5MzQzOTc=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/edgeql", "name": "edgeql", "color": "0052cc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2019-11-29T14:29:06Z", "updated_at": "2020-08-23T17:14:37Z", "closed_at": "2020-08-23T17:14:37Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I cannot figure out how to update multi links with link properties. Everything I try results in the error: **QueryError: invalid reference to link property in top level shape**.\r\n\r\nTo illustrate using an example from the docs (bottom of [this](https://edgedb.com/docs/edgeql/statements/for#ref-eql-forstatement) page), here's a simple schema:\r\n```\r\ntype User { \r\n    property name -> str; \r\n    multi link friends -> User { \r\n        property nickname -> str; \r\n    } \r\n}\r\n```\r\nAs the docs demonstrate, I can insert all the users and use the WITH + FOR + array_unpack statement to set multiple links and their corresponding link properties.\r\n\r\nBut now if I add another user and want to update any of the existing users' friends list with a link and a link property, it just doesn't happen. The following (and all permutations I could think of as far as adding and removing round brackets) does not work:\r\n```\r\nWITH U2 := User UPDATE User FILTER .name = 'Bob' \r\nSET { \r\n    friends := User.friends UNION (\r\n        SELECT U2 { @nickname := 'new guy' } FILTER U2.name = 'John' \r\n    )\r\n};  \r\n```\r\nResult: *QueryError: invalid reference to link property in top level shape* with the error arrow pointing to the beginning of the `{ @nickname` ... part\r\n\r\nNote that just without the link property part I am able to add the new friend to the friends list using the query above. \r\n\r\nI am also able to add the link with its link property if I replace all existing friends (by omitting User.friends UNION). So clearly this should be possible, but I can't find/understand my syntax error. \r\n\r\nThanks for your help!", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/904/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/904/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/857", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/857/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/857/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/857/events", "html_url": "https://github.com/edgedb/edgedb/issues/857", "id": 527117862, "node_id": "MDU6SXNzdWU1MjcxMTc4NjI=", "number": 857, "title": "Repl exception on connecting", "user": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-11-22T10:36:19Z", "updated_at": "2020-10-19T19:04:36Z", "closed_at": "2019-11-28T16:38:19Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I'm executing:\r\n```\r\nedgedb  -p 5656 -d tutorial --no-password\r\n```\r\nWhere the database exists, but the user is probably doesn't. The exception is:\r\n```\r\n  File \"/work/edb/cli/__init__.py\", line 72, in cli\r\n    admin=admin,\r\n  File \"/work/edb/repl/__init__.py\", line 611, in main\r\n    return Cli(connect_kwargs).run()\r\n  File \"/work/edb/repl/__init__.py\", line 449, in run\r\n    self.ensure_connection()\r\n  File \"/work/edb/repl/__init__.py\", line 269, in ensure_connection\r\n    print(f'Could not establish connection to {dbname}: {reason}')\r\nUnboundLocalError: local variable 'reason' referenced before assignment\r\n```\r\nProbably it's somewhere `edgedb.AuthenticationError` branch, but I've not debugged too much.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/857/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/857/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/854", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/854/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/854/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/854/events", "html_url": "https://github.com/edgedb/edgedb/issues/854", "id": 526904731, "node_id": "MDU6SXNzdWU1MjY5MDQ3MzE=", "number": 854, "title": "We need \"order\" link property for \"bases\" and \"ancestors\"", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-11-21T23:46:20Z", "updated_at": "2019-12-18T04:03:48Z", "closed_at": "2019-12-18T04:03:47Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "We need a way to record and preserve the order of `bases` and `ancestors` in the schema so that we can reliably reconstruct the class hierarchy in a dump.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/854/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/854/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/840", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/840/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/840/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/840/events", "html_url": "https://github.com/edgedb/edgedb/issues/840", "id": 524594755, "node_id": "MDU6SXNzdWU1MjQ1OTQ3NTU=", "number": 840, "title": "Identifier quoting clashes with fully-qualified names", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 932934397, "node_id": "MDU6TGFiZWw5MzI5MzQzOTc=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/edgeql", "name": "edgeql", "color": "0052cc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-11-18T20:14:25Z", "updated_at": "2019-11-18T21:59:22Z", "closed_at": "2019-11-18T21:59:22Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "The point of identifier quoting is that it allows using non-alphanumeric characters or reserved keywords as identifiers. So consider the following:\r\n```\r\nCREATE TYPE `foo::Bar`;\r\n```\r\nIt will be interpreted as a single identifier, which then gets prefixed with the `default` module name to create a fully-qualified name with module `default` and name `foo::Bar`. Unfortunately, during processing it gets normalized into a single string `\"default::foo::Bar\"`, which then further down the line gets (mis-)interpreted as module `default::foo` and name `Bar`.\r\n```\r\nedgedb> CREATE TYPE `foo::Bar`;\r\nCREATE\r\nedgedb> WITH MODULE schema\r\n....... SELECT ObjectType {name};\r\nUnknownModuleError: module 'default::foo' is not in this schema\r\n```\r\n\r\nSo the question is what is the right fix here?\r\n- We could ban `::` inside quoted identifiers, for the same reasons we ban `@` and `__` at the beginning of them already. It causes clashes and it's problematic to disambiguate in some circumstances (such as in `__type__.name` string).\r\n- We could review what it means to be a fully-qualified name and whether it really *has* to be 2 identifier tokens separated by a `::` token or whether it's OK to just have a single quoted identifier with the `::` inside of it. This would mean that the type from the example would simply be equivalent to a plain `foo::Bar`, meaning module `foo` type-name `Bar`.\r\n\r\nPersonally, I'm leaning towards a ban. @1st1 and @elprans , what do you think?", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/840/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/840/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/834", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/834/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/834/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/834/events", "html_url": "https://github.com/edgedb/edgedb/issues/834", "id": 523233177, "node_id": "MDU6SXNzdWU1MjMyMzMxNzc=", "number": 834, "title": "Apparent incorrect scoping involving `FOR`", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-11-15T03:34:47Z", "updated_at": "2019-12-18T03:02:00Z", "closed_at": "2019-12-18T03:02:00Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "See `test_edgeql_for_in_computable_02` in #832 .\r\n\r\nThe iterator variable from the inner `FOR` ends up leaking all its values into a shape instead of one-by-one.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/834/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/834/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/833", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/833/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/833/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/833/events", "html_url": "https://github.com/edgedb/edgedb/issues/833", "id": 523228604, "node_id": "MDU6SXNzdWU1MjMyMjg2MDQ=", "number": 833, "title": "Bug with tuple element cardinality.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-11-15T03:18:14Z", "updated_at": "2019-12-06T18:45:51Z", "closed_at": "2019-12-06T18:45:50Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Consider the following:\r\n```\r\nscope> WITH\r\n......     MODULE test,\r\n......     letter := {'A', 'B'},\r\n......     tup := (\r\n......         letter,\r\n......         (\r\n......             SELECT User\r\n......             FILTER .name[0] = letter\r\n......         )\r\n......     )\r\n...... SELECT _ := tup.1 {\r\n......     name,\r\n......     l := tup.0,\r\n...... }\r\n...... ORDER BY .name;\r\n......\r\n{Object { name: 'Alice', l: {'A'} }, Object { name: 'Bob', l: {'B'} }\r\n```\r\n(see `test_edgeql_scope_tuple_13`)\r\n\r\nThe goal here is to re-package the tuple elements such that one of them becomes a computable in the shape of the other. \r\n\r\nThe first question is: is this even legal? It intuitively makes sense, but technically it *looks* as if two different prefixes `tup.1` and `tup.0` are combined in a way that would be definitely illegal if they were regular paths like `Foo.bar1` and `Foo.bar0`. I would argue that this should be legal because the `.` in tuple dereferencing is not really a path, but is more akin to `[...]` index access. So there's no violation of the common path prefix rule. More pragmatically, making it hard to repackage tuples makes tuples less useful.\r\n\r\nThe reason why I came up with this example of tuple usage is #743. Basically, it's an attempt to rewrite a `FOR` in terms of tuples. Although I agree with the point that the additional clauses are ambiguous when used with `FOR` and they cause problems, it means that if I want to order my `FOR` computable (because I'll use it in output) I need to jump through hoops. See `test_edgeql_for_in_computable_01` (which works) and `test_edgeql_for_in_computable_02` (which doesn't work) in #832 . Correlating link props and link targets is one of good examples why we even need a `FOR`.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/833/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/833/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/758", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/758/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/758/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/758/events", "html_url": "https://github.com/edgedb/edgedb/issues/758", "id": 502758035, "node_id": "MDU6SXNzdWU1MDI3NTgwMzU=", "number": 758, "title": "SDL and DDL for INDEX are not equivalent", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-10-04T17:33:20Z", "updated_at": "2019-10-11T22:34:39Z", "closed_at": "2019-10-11T22:34:39Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Depending on whether an `INDEX` is created via SDL or DDL it will end up with a different \"name\". This results in a \"schema  difference\" where no difference is expected.\r\n\r\nSee `test_migrations_equivalence_index_01`.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/758/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/758/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/755", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/755/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/755/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/755/events", "html_url": "https://github.com/edgedb/edgedb/issues/755", "id": 502340406, "node_id": "MDU6SXNzdWU1MDIzNDA0MDY=", "number": 755, "title": "Annotation migration fails intermittently", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-10-03T23:02:15Z", "updated_at": "2019-10-04T16:45:20Z", "closed_at": "2019-10-04T16:45:20Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "The test `test_migrations_equivalence_annotation_01` fails intermittently.\r\n\r\nI'll record one of the tracebacks here, just in case:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/victor/dev/magicstack/edgedb/tests/test_schema.py\", line 2084, in test_migrations_equivalence_annotation_01\r\n    \"\"\"])\r\n  File \"/home/victor/dev/magicstack/edgedb/tests/test_schema.py\", line 603, in _assert_migration_equivalence\r\n    self._assert_migration_consistency(migrations[-1])\r\n  File \"/home/victor/dev/magicstack/edgedb/tests/test_schema.py\", line 588, in _assert_migration_consistency\r\n    diff = s_ddl.delta_schemas(baseline_schema, test_schema)\r\n  File \"/home/victor/dev/magicstack/edgedb/edb/schema/ddl.py\", line 87, in delta_schemas\r\n    old, new, old_schema=schema2, new_schema=schema1))\r\n  File \"/home/victor/dev/magicstack/edgedb/edb/schema/objects.py\", line 1143, in delta_sets\r\n    their_schema=old_schema)\r\n  File \"/home/victor/dev/magicstack/edgedb/edb/schema/objects.py\", line 778, in compare\r\n    context=context)\r\n  File \"/home/victor/dev/magicstack/edgedb/edb/schema/objects.py\", line 796, in compare_field_value\r\n    compcoef=field.compcoef or 0.5)\r\n  File \"/home/victor/dev/magicstack/edgedb/edb/schema/objects.py\", line 1466, in compare_values\r\n    their_schema=their_schema, context=context))\r\n  File \"/home/victor/dev/magicstack/edgedb/edb/schema/objects.py\", line 770, in compare\r\n    their_value = other.get_field_value(their_schema, field_name)\r\n  File \"/home/victor/dev/magicstack/edgedb/edb/schema/objects.py\", line 642, in get_field_value\r\n    schema, field_name, allow_default=allow_default)\r\n  File \"/home/victor/dev/magicstack/edgedb/edb/schema/objects.py\", line 635, in _get_schema_field_value\r\n    f'{self!r} object has no value for field {field_name!r}')\r\nedb.schema.objects.FieldValueNotFoundError: <AnnotationValue: at 0x7f27da85bf60> object has no value for field 'annotation'\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/755/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/755/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/748", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/748/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/748/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/748/events", "html_url": "https://github.com/edgedb/edgedb/issues/748", "id": 501858020, "node_id": "MDU6SXNzdWU1MDE4NTgwMjA=", "number": 748, "title": "Migration that renames a `VIEW` property are broken", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 932934397, "node_id": "MDU6TGFiZWw5MzI5MzQzOTc=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/edgeql", "name": "edgeql", "color": "0052cc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-10-03T05:15:37Z", "updated_at": "2019-10-04T19:35:38Z", "closed_at": "2019-10-04T19:35:38Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Currently a migration that renames a `property` of a `VIEW` fails due to an `InternalServerError`.\r\nThe `test_edgeql_migration_37` from #744 is an example of this.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/748/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/748/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/746", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/746/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/746/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/746/events", "html_url": "https://github.com/edgedb/edgedb/issues/746", "id": 501855833, "node_id": "MDU6SXNzdWU1MDE4NTU4MzM=", "number": 746, "title": "SDL with polymorphic functions is broken", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 932934397, "node_id": "MDU6TGFiZWw5MzI5MzQzOTc=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/edgeql", "name": "edgeql", "color": "0052cc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-10-03T05:07:03Z", "updated_at": "2020-10-19T19:04:35Z", "closed_at": "2019-10-03T21:11:06Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Currently, if a polymorphic function is introduced via SDL the migration then produces only _one_ of the variants presented in SDL.\r\n\r\nExample of problematic SDL:\r\n```edgeql\r\nfunction hello12(a: int64) -> str\r\n    from edgeql $$\r\n        SELECT 'hello' ++ <str>a\r\n    $$;\r\n\r\nfunction hello12(a: str) -> str\r\n    from edgeql $$\r\n        SELECT 'hello' ++ a\r\n    $$;\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/746/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/746/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/738", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/738/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/738/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/738/events", "html_url": "https://github.com/edgedb/edgedb/issues/738", "id": 499182576, "node_id": "MDU6SXNzdWU0OTkxODI1NzY=", "number": 738, "title": "protocol: optimistic execute broken", "user": {"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-09-27T01:08:04Z", "updated_at": "2019-10-07T22:32:42Z", "closed_at": "2019-10-07T22:32:42Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "There can be a situation when a completely different query can be executed. It's hard to reproduce under normal circumstances, but can become an issue if a client implements protocol incorrectly.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/738/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/738/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/713", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/713/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/713/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/713/events", "html_url": "https://github.com/edgedb/edgedb/issues/713", "id": 490606657, "node_id": "MDU6SXNzdWU0OTA2MDY2NTc=", "number": 713, "title": "No keyboard echo until terminal resize | edgedb shell in podman", "user": {"login": "buckle2000", "id": 10850402, "node_id": "MDQ6VXNlcjEwODUwNDAy", "avatar_url": "https://avatars.githubusercontent.com/u/10850402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/buckle2000", "html_url": "https://github.com/buckle2000", "followers_url": "https://api.github.com/users/buckle2000/followers", "following_url": "https://api.github.com/users/buckle2000/following{/other_user}", "gists_url": "https://api.github.com/users/buckle2000/gists{/gist_id}", "starred_url": "https://api.github.com/users/buckle2000/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/buckle2000/subscriptions", "organizations_url": "https://api.github.com/users/buckle2000/orgs", "repos_url": "https://api.github.com/users/buckle2000/repos", "events_url": "https://api.github.com/users/buckle2000/events{/privacy}", "received_events_url": "https://api.github.com/users/buckle2000/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tailhook", "id": 321799, "node_id": "MDQ6VXNlcjMyMTc5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/321799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tailhook", "html_url": "https://github.com/tailhook", "followers_url": "https://api.github.com/users/tailhook/followers", "following_url": "https://api.github.com/users/tailhook/following{/other_user}", "gists_url": "https://api.github.com/users/tailhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/tailhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tailhook/subscriptions", "organizations_url": "https://api.github.com/users/tailhook/orgs", "repos_url": "https://api.github.com/users/tailhook/repos", "events_url": "https://api.github.com/users/tailhook/events{/privacy}", "received_events_url": "https://api.github.com/users/tailhook/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-09-07T08:01:19Z", "updated_at": "2020-05-26T15:35:32Z", "closed_at": "2020-05-26T15:34:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "I tried to run edgedb shell with this command: `podman exec -it edgedb-server edgedb -u edgedb`. The `edgedb>` prompt and the bottom `[F3] [F4] [F5]` status bar were invisible (no key echo either) until I resized the terminal window. I could type `\\q` to exit. This is the case for both gnome-terminal and xterm.\r\nbash works fine in podman, so I suspect this problem is specific to edgedb.\r\n\r\nExample session:\r\n```\r\nEdgeDB 1.0.alpha.1\r\nType \"\\?\" for help.\r\n(I type \\?)\r\n  \\c DBNAME            connect to database DBNAME\r\n  \\l                   list databases\r\n  \\errverbose          show most recent error message at maximum verbosity\r\n  \\q or \"exit\"         quit\r\n(I type \\q)\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/713/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/713/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/709", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/709/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/709/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/709/events", "html_url": "https://github.com/edgedb/edgedb/issues/709", "id": 489286554, "node_id": "MDU6SXNzdWU0ODkyODY1NTQ=", "number": 709, "title": "GraphQL port unable to handle covariant object types", "user": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1284200502, "node_id": "MDU6TGFiZWwxMjg0MjAwNTAy", "url": "https://api.github.com/repos/edgedb/edgedb/labels/graphql", "name": "graphql", "color": "c2b0f4", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-09-04T17:13:33Z", "updated_at": "2019-09-17T22:01:24Z", "closed_at": "2019-09-17T22:01:24Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "The following schema crashes the GraphQL schema adaptor:\r\n\r\n```\r\ntype Bar;\r\ntype Bar2 extending Bar;\r\n\r\ntype Foo {\r\n   link blah -> Bar\r\n}\r\n\r\ntype Foo2 extending Foo {\r\n   link blah -> Bar2;\r\n}\r\n```\r\n\r\n```\r\nInternalServerError: unhandled errors in a TaskGroup; 1 sub errors: (AssertionError)\r\n + AssertionError: Foo.bar expects type \"Bar\" but Foo2Type.bar provides type \"Bar2\".\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/709/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/709/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/708", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/708/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/708/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/708/events", "html_url": "https://github.com/edgedb/edgedb/issues/708", "id": 488894101, "node_id": "MDU6SXNzdWU0ODg4OTQxMDE=", "number": 708, "title": "GraphQL crash", "user": {"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1284200502, "node_id": "MDU6TGFiZWwxMjg0MjAwNTAy", "url": "https://api.github.com/repos/edgedb/edgedb/labels/graphql", "name": "graphql", "color": "c2b0f4", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-09-04T01:29:07Z", "updated_at": "2019-09-17T21:19:00Z", "closed_at": "2019-09-17T21:19:00Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Our benchmarks app is no longer able to create a test edgedb db. See the below error dump:\r\n\r\n```\r\n Exception occurred: Mutation fields must be a mapping (dict / OrderedDict) with field names as keys or a function which returns such a mapping.\r\n\r\n1. AssertionError: Mutation fields must be a mapping (dict / OrderedDict) with field names as keys or a function which returns such a mapping.\r\n\r\n-------------------------------------------- Traceback --------------------------------------------\r\n\r\n    /Users/yury/dev/edge/edgedb/edb/server/compiler/compiler.py, line 204, in connect\r\n        > await self._get_database(dbver)\r\n    /Users/yury/dev/edge/edgedb/edb/server/compiler/compiler.py, line 193, in _get_database\r\n        > db = self._wrap_schema(dbver, con_args, schema)\r\n    /Users/yury/dev/edge/edgedb/edb/server/http_graphql_port/compiler.py, line 56, in _wrap_schema\r\n        > gqlcore = graphql.GQLCoreSchema(schema)\r\n    /Users/yury/dev/edge/edgedb/edb/graphql/types.py, line 150, in __init__\r\n        > query=query, mutation=mutation, types=types)\r\n    /Users/yury/dev/venvs/edgedb/lib/python3.7/site-packages/graphql/type/schema.py, line 104, in __init__\r\n        > self._type_map = GraphQLTypeMap(initial_types)  # type: GraphQLTypeMap\r\n    /Users/yury/dev/venvs/edgedb/lib/python3.7/site-packages/graphql/type/typemap.py, line 28, in __init__\r\n        > self.update(reduce(self.reducer, types, OrderedDict()))  # type: ignore\r\n    /Users/yury/dev/venvs/edgedb/lib/python3.7/site-packages/graphql/type/typemap.py, line 106, in reducer\r\n        > field_map = type.fields\r\n    /Users/yury/dev/venvs/edgedb/lib/python3.7/site-packages/graphql/pyutils/cached_property.py, line 22, in __get__\r\n        > value = obj.__dict__[self.func.__name__] = self.func(obj)\r\n    /Users/yury/dev/venvs/edgedb/lib/python3.7/site-packages/graphql/type/definition.py, line 226, in fields\r\n        > return define_field_map(self, self._fields)\r\n    /Users/yury/dev/venvs/edgedb/lib/python3.7/site-packages/graphql/type/definition.py, line 245, in define_field_map\r\n        > ).format(type)\r\n\r\nAssertionError: Mutation fields must be a mapping (dict / OrderedDict) with field names as keys or a function which returns such a mapping.\r\n Exception occurred: Mutation fields must be a mapping (dict / OrderedDict) with field names as keys or a function which returns such a mapping.\r\n\r\n1. AssertionError: Mutation fields must be a mapping (dict / OrderedDict) with field names as keys or a function which returns such a mapping.\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/708/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/708/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/634", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/634/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/634/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/634/events", "html_url": "https://github.com/edgedb/edgedb/issues/634", "id": 437386051, "node_id": "MDU6SXNzdWU0MzczODYwNTE=", "number": 634, "title": "Schema types introspection is broken for required and default values.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-04-25T20:35:09Z", "updated_at": "2020-08-23T21:27:53Z", "closed_at": "2020-08-23T21:27:53Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Currently if a schema type has a required link or property it can still show up as `{}` in the introspection. Similarly, default values are also ignored.\r\n\r\nSee #633 for tests that show this behavior.\r\n\r\nIncidentally, we may want to review what is required in the schema. For example, why is `__type__` not a required link? Why `is_abstract` and `is_final` have a default, but aren't required? Also `readonly` should be exposed.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/634/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/634/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/606", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/606/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/606/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/606/events", "html_url": "https://github.com/edgedb/edgedb/issues/606", "id": 431778200, "node_id": "MDU6SXNzdWU0MzE3NzgyMDA=", "number": 606, "title": "Errors incorrectly mapped when they reference objects inside a transaction", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-04-11T00:31:19Z", "updated_at": "2019-09-04T20:59:31Z", "closed_at": "2019-09-04T20:59:31Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Code to reproduce:\r\n```edgeql\r\nSET MODULE default;\r\n\r\nCREATE ABSTRACT CONSTRAINT uppercase {\r\n    SET ANNOTATION title := \"Upper case constraint\";\r\n    SET expr := str_upper(__subject__) = __subject__;\r\n    SET errmessage := \"{__subject__} is not in upper case\";\r\n};\r\n\r\nCREATE SCALAR TYPE upper_str EXTENDING str {\r\n    CREATE CONSTRAINT uppercase\r\n};\r\nSELECT <upper_str>'123_hello';\r\n```\r\n\r\nGenerates\r\n```\r\nedb.server.pgcon.errors.BackendError: value for domain \"edgedb_a1d05f9c-5bef-11e9-89a5-4d49c7e8cf3f\".\"2d402ba8-5bf0-11e9-ba66-07e2ba59f340_domain\" violates check constraint \"2d423558-5bf0-11e9-baae-631005192d3c;schemaconstr\"\r\n```\r\n\r\nThe error presents itself if the `SELECT` is wrapped in a `with self.assertRaisesRegex(ConstraintViolationError)` in userddl tests.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/606/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/606/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/604", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/604/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/604/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/604/events", "html_url": "https://github.com/edgedb/edgedb/issues/604", "id": 431743419, "node_id": "MDU6SXNzdWU0MzE3NDM0MTk=", "number": 604, "title": "Problem with altering constraint", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-04-10T22:21:24Z", "updated_at": "2019-09-04T21:39:55Z", "closed_at": "2019-09-04T21:39:55Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "A very particular sequence of CREATE/ALTER DDL commands ends up with a constraint that cannot be dropped or altered.\r\n\r\nSee `test_edgeql_ddl_constraint_alter_01` (#602)", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/604/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/604/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/603", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/603/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/603/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/603/events", "html_url": "https://github.com/edgedb/edgedb/issues/603", "id": 431743354, "node_id": "MDU6SXNzdWU0MzE3NDMzNTQ=", "number": 603, "title": "Problem with reverse links", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-04-10T22:21:08Z", "updated_at": "2019-09-04T21:41:33Z", "closed_at": "2019-09-04T21:41:33Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Unrelated links with same name and target result in errors when accessing the reverse link.\r\n\r\nSee test `test_edgeql_ddl_inheritance_alter_03` (#602)", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/603/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/603/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/563", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/563/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/563/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/563/events", "html_url": "https://github.com/edgedb/edgedb/issues/563", "id": 428508002, "node_id": "MDU6SXNzdWU0Mjg1MDgwMDI=", "number": 563, "title": "Problem with introspecting variadic args of a concrete constraint", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-04-03T00:42:15Z", "updated_at": "2019-10-17T18:41:43Z", "closed_at": "2019-10-17T18:41:43Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "The relevant test is present in #562: `test_edgeql_introspection_constraint_06`.\r\n\r\nBasically introspecting the concrete constraint `one_of` on `schema::cardinality_t` unexpectedly produces one arg with a single value `ONE` instead of `['ONE', 'MANY']`.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/563/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/563/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/538", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/538/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/538/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/538/events", "html_url": "https://github.com/edgedb/edgedb/issues/538", "id": 426767438, "node_id": "MDU6SXNzdWU0MjY3Njc0Mzg=", "number": 538, "title": "Problems with indexed type", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-03-29T00:53:42Z", "updated_at": "2019-04-05T18:56:45Z", "closed_at": "2019-04-05T18:56:45Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Currently attempting to drop a type that has an index fails. See `test_index_02` from #537 ", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/538/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/538/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/514", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/514/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/514/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/514/events", "html_url": "https://github.com/edgedb/edgedb/issues/514", "id": 423557738, "node_id": "MDU6SXNzdWU0MjM1NTc3Mzg=", "number": 514, "title": "GraphQL: \"limit\" doesn't accept a variable", "user": {"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 1284200502, "node_id": "MDU6TGFiZWwxMjg0MjAwNTAy", "url": "https://api.github.com/repos/edgedb/edgedb/labels/graphql", "name": "graphql", "color": "c2b0f4", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/edgedb/edgedb/milestones/1", "html_url": "https://github.com/edgedb/edgedb/milestone/1", "labels_url": "https://api.github.com/repos/edgedb/edgedb/milestones/1/labels", "id": 2905036, "node_id": "MDk6TWlsZXN0b25lMjkwNTAzNg==", "number": 1, "title": "Alpha 1", "description": "", "creator": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 26, "state": "closed", "created_at": "2017-11-11T05:25:45Z", "updated_at": "2019-09-26T23:23:15Z", "due_on": null, "closed_at": "2019-09-26T23:23:15Z"}, "comments": 0, "created_at": "2019-03-21T03:19:10Z", "updated_at": "2019-03-22T02:25:07Z", "closed_at": "2019-03-22T02:25:07Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\n                query($limit: Int) {\r\n                  User(first: $limit) {\r\n                    id\r\n                  }\r\n                }\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/514/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/514/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/510", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/510/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/510/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/510/events", "html_url": "https://github.com/edgedb/edgedb/issues/510", "id": 423025177, "node_id": "MDU6SXNzdWU0MjMwMjUxNzc=", "number": 510, "title": "Problem with using types from other modules in SDL.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-03-20T01:30:10Z", "updated_at": "2020-05-25T20:10:41Z", "closed_at": "2020-05-25T20:10:41Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I've added an `std::UniquelyNamed` abstract type, but it's causing issues when another type is extending it.\r\n\r\nSee #509, specifically `test_edgeql_ddl_modules_02`.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/510/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/510/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/355", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/355/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/355/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/355/events", "html_url": "https://github.com/edgedb/edgedb/issues/355", "id": 388454290, "node_id": "MDU6SXNzdWUzODg0NTQyOTA=", "number": 355, "title": "Implicit cast performed by Postgres instead of EdgeDB", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-12-07T00:22:07Z", "updated_at": "2018-12-17T18:00:37Z", "closed_at": "2018-12-17T18:00:37Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nSELECT <float64>'1' + <float32>'1';\r\n```\r\nThis currently produces SQL code without explicit cast generated by EdgeDB and it relies on Postgres to actually cast both sides into `float8`.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/355/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/355/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/350", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/350/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/350/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/350/events", "html_url": "https://github.com/edgedb/edgedb/issues/350", "id": 387981009, "node_id": "MDU6SXNzdWUzODc5ODEwMDk=", "number": 350, "title": "Cardinality validation for aggregates mapped onto SQL", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-12-05T22:51:25Z", "updated_at": "2019-04-05T19:00:50Z", "closed_at": "2019-04-05T19:00:49Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This is related to #349 \r\n\r\nFor standard library functions there's a need to map them onto existing SQL functions. Sometimes aggregate functions in SQL can return `NULL` for cases that in EdgeDB we would consider invalid. Consider `stddev` (sample standard deviation) that is not defined for sets of cardinality < 2. On the other hand for all other sets it is a single number. So in our definition of cardinality we expect the return value to be of cardinality exactly 1, neither more nor less (much like `count`). Unfortunately Postgres will return `NULL` for the input sets that are too small and we need a way of handling that with some sort of graceful error message instead.\r\n\r\nThe proposal is to have a special attribute like `empty_result_error` that provides a way to customize the error message. While a `NULL` test of the result is only added if the function return type is declared to be of cardinality >= 1 (not `OPTIONAL` or `SET OF`).", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/350/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/350/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/243", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/243/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/243/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/243/events", "html_url": "https://github.com/edgedb/edgedb/issues/243", "id": 369354262, "node_id": "MDU6SXNzdWUzNjkzNTQyNjI=", "number": 243, "title": "Out of bound indexes for arrays and strings.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-10-12T00:24:01Z", "updated_at": "2018-10-29T23:11:44Z", "closed_at": "2018-10-29T23:11:44Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Currently, there's no index-out-of-bounds error for accessing arrays and strings. This should be corrected.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/243/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/243/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/215", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/215/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/215/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/215/events", "html_url": "https://github.com/edgedb/edgedb/issues/215", "id": 337157093, "node_id": "MDU6SXNzdWUzMzcxNTcwOTM=", "number": 215, "title": "Uniqueness of link and property targets", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-06-29T22:41:08Z", "updated_at": "2018-07-23T16:23:29Z", "closed_at": "2018-07-23T16:23:29Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "In EdgeDB for any given object links and properties all point to sets (the targets are unique). Currently, this invariant is broken by computables. We need to have compile-time uniqueness inference for computable targets. This would make computables behave just like links and properties at all times, which is the original intent.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/215/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/215/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/203", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/203/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/203/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/203/events", "html_url": "https://github.com/edgedb/edgedb/issues/203", "id": 334183004, "node_id": "MDU6SXNzdWUzMzQxODMwMDQ=", "number": 203, "title": "Cardinality inference failure due to improper namespace stripping.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-06-20T17:39:56Z", "updated_at": "2018-06-29T01:50:22Z", "closed_at": "2018-06-29T01:50:22Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "See `test_edgeql_scope_filter_01`.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/203/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/203/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/202", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/202/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/202/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/202/events", "html_url": "https://github.com/edgedb/edgedb/issues/202", "id": 334182336, "node_id": "MDU6SXNzdWUzMzQxODIzMzY=", "number": 202, "title": "Empty set results in a tuple with a `None` element.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-06-20T17:37:46Z", "updated_at": "2018-07-03T20:02:15Z", "closed_at": "2018-07-03T20:02:15Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "It is currently possible to create a tuple with `None` as one of its elements from an `{}`.\r\n\r\nTests involving this issue: \r\n- [ ] `test_edgeql_expr_tuple_14` created directly from literals\r\n- [ ] `test_edgeql_expr_tuple_15` created from views using literals\r\n- [ ] `test_edgeql_scope_tuple_12` created using an empty link property", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/202/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/202/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/201", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/201/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/201/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/201/events", "html_url": "https://github.com/edgedb/edgedb/issues/201", "id": 334178898, "node_id": "MDU6SXNzdWUzMzQxNzg4OTg=", "number": 201, "title": "Shapes rooted at the same object can mask each other.", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-06-20T17:27:21Z", "updated_at": "2018-06-29T14:10:52Z", "closed_at": "2018-06-29T14:10:52Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Two different shapes rooted at the same object mask each other if they appear in the same scope (such as sibling tuple elements).\r\n\r\n```\r\nWITH MODULE test\r\nSELECT _ := (User { name }, User { id });\r\n```\r\n\r\nSee `test_edgeql_scope_tuple_03`.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/201/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/201/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/200", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/200/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/200/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/200/events", "html_url": "https://github.com/edgedb/edgedb/issues/200", "id": 334177510, "node_id": "MDU6SXNzdWUzMzQxNzc1MTA=", "number": 200, "title": "Polymorphism and implicit casting support", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-06-20T17:22:40Z", "updated_at": "2018-11-05T23:54:17Z", "closed_at": "2018-11-05T23:54:17Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Implicit casting is not always done correctly for scalar types. This goes hand in hand with polymorphic function implementation - if the argument type is not inferred correctly, the wrong function is called or a function may not even be found.\r\n\r\nTests `test_edgeql_functions_sum_02` and `test_edgeql_functions_sum_03` highlight this problem.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/200/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/200/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/190", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/190/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/190/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/190/events", "html_url": "https://github.com/edgedb/edgedb/issues/190", "id": 329128164, "node_id": "MDU6SXNzdWUzMjkxMjgxNjQ=", "number": 190, "title": "Bug with a `VIEW` referring to another `VIEW`", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-06-04T16:24:51Z", "updated_at": "2018-06-29T14:08:31Z", "closed_at": "2018-06-29T14:08:31Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "There's a bug that prevents creating a `VIEW` that refers to another `VIEW` (both based on the same type).", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/190/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/190/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/188", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/188/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/188/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/188/events", "html_url": "https://github.com/edgedb/edgedb/issues/188", "id": 328699357, "node_id": "MDU6SXNzdWUzMjg2OTkzNTc=", "number": 188, "title": "Bug in coalescing operator", "user": {"login": "vpetrovykh", "id": 508466, "node_id": "MDQ6VXNlcjUwODQ2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/508466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpetrovykh", "html_url": "https://github.com/vpetrovykh", "followers_url": "https://api.github.com/users/vpetrovykh/followers", "following_url": "https://api.github.com/users/vpetrovykh/following{/other_user}", "gists_url": "https://api.github.com/users/vpetrovykh/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpetrovykh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpetrovykh/subscriptions", "organizations_url": "https://api.github.com/users/vpetrovykh/orgs", "repos_url": "https://api.github.com/users/vpetrovykh/repos", "events_url": "https://api.github.com/users/vpetrovykh/events{/privacy}", "received_events_url": "https://api.github.com/users/vpetrovykh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-06-02T01:06:40Z", "updated_at": "2018-06-29T01:50:23Z", "closed_at": "2018-06-29T01:50:23Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "There are some discrepancies in how coalescing operator works. See `test_edgeql_coalesce_dependent_22` and `test_edgeql_coalesce_dependent_23`.", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/188/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/188/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/182", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/182/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/182/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/182/events", "html_url": "https://github.com/edgedb/edgedb/issues/182", "id": 322953355, "node_id": "MDU6SXNzdWUzMjI5NTMzNTU=", "number": 182, "title": "Typecasting tuple doesn't work", "user": {"login": "fmoor", "id": 8278635, "node_id": "MDQ6VXNlcjgyNzg2MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/8278635?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmoor", "html_url": "https://github.com/fmoor", "followers_url": "https://api.github.com/users/fmoor/followers", "following_url": "https://api.github.com/users/fmoor/following{/other_user}", "gists_url": "https://api.github.com/users/fmoor/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmoor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmoor/subscriptions", "organizations_url": "https://api.github.com/users/fmoor/orgs", "repos_url": "https://api.github.com/users/fmoor/repos", "events_url": "https://api.github.com/users/fmoor/events{/privacy}", "received_events_url": "https://api.github.com/users/fmoor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 932934397, "node_id": "MDU6TGFiZWw5MzI5MzQzOTc=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/edgeql", "name": "edgeql", "color": "0052cc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-05-14T19:42:01Z", "updated_at": "2018-07-04T20:13:27Z", "closed_at": "2018-07-04T20:13:27Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nedgedb> SELECT <tuple<int64, str>>(1, 3);\r\nUnknownEdgeDBError: 'TypeCast' object has no attribute 'path_id'\r\n```\r\n\r\nThe example comes from the [docs](https://edgedb.com/docs/edgeql/funcop/type#type-cast-expression).\r\n\r\nI tried some simpler examples and they all failed with a slightly differen't error.\r\n\r\n```\r\nedgedb> SELECT <tuple<int64>>('1');\r\nUnknownEdgeDBError: could not cast std::str to std::tuple<std::int64>\r\nedgedb> SELECT <int64>'1';\r\n{1}\r\nedgedb> SELECT <tuple<int64>>(<int32>1);\r\nUnknownEdgeDBError: could not cast std::int32 to std::tuple<std::int64>\r\nedgedb> SELECT <int64>(<int32>1);\r\n{1}\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/182/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/182/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/181", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/181/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/181/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/181/events", "html_url": "https://github.com/edgedb/edgedb/issues/181", "id": 322934172, "node_id": "MDU6SXNzdWUzMjI5MzQxNzI=", "number": 181, "title": "The IS operator doesn't work on scalars", "user": {"login": "fmoor", "id": 8278635, "node_id": "MDQ6VXNlcjgyNzg2MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/8278635?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmoor", "html_url": "https://github.com/fmoor", "followers_url": "https://api.github.com/users/fmoor/followers", "following_url": "https://api.github.com/users/fmoor/following{/other_user}", "gists_url": "https://api.github.com/users/fmoor/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmoor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmoor/subscriptions", "organizations_url": "https://api.github.com/users/fmoor/orgs", "repos_url": "https://api.github.com/users/fmoor/repos", "events_url": "https://api.github.com/users/fmoor/events{/privacy}", "received_events_url": "https://api.github.com/users/fmoor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}, {"id": 932934397, "node_id": "MDU6TGFiZWw5MzI5MzQzOTc=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/edgeql", "name": "edgeql", "color": "0052cc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-05-14T18:41:02Z", "updated_at": "2019-04-05T18:59:04Z", "closed_at": "2019-04-05T18:59:04Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\nedgedb> SELECT 1 IS int64;\r\nEdgeQLError: reference to a non-existent schema item: int64\r\n\r\n\r\n---- Source Context ----\r\n\r\n    <string>, line 1, in <string>\r\n        > SELECT 1 IS int64;\r\n                      ^\r\n        \r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/181/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/181/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/edgedb/edgedb/issues/17", "repository_url": "https://api.github.com/repos/edgedb/edgedb", "labels_url": "https://api.github.com/repos/edgedb/edgedb/issues/17/labels{/name}", "comments_url": "https://api.github.com/repos/edgedb/edgedb/issues/17/comments", "events_url": "https://api.github.com/repos/edgedb/edgedb/issues/17/events", "html_url": "https://github.com/edgedb/edgedb/issues/17", "id": 242507616, "node_id": "MDU6SXNzdWUyNDI1MDc2MTY=", "number": 17, "title": "error: \"resolve_type_name: unknown type: UUID\"", "user": {"login": "1st1", "id": 239003, "node_id": "MDQ6VXNlcjIzOTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/239003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1st1", "html_url": "https://github.com/1st1", "followers_url": "https://api.github.com/users/1st1/followers", "following_url": "https://api.github.com/users/1st1/following{/other_user}", "gists_url": "https://api.github.com/users/1st1/gists{/gist_id}", "starred_url": "https://api.github.com/users/1st1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1st1/subscriptions", "organizations_url": "https://api.github.com/users/1st1/orgs", "repos_url": "https://api.github.com/users/1st1/repos", "events_url": "https://api.github.com/users/1st1/events{/privacy}", "received_events_url": "https://api.github.com/users/1st1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 637054051, "node_id": "MDU6TGFiZWw2MzcwNTQwNTE=", "url": "https://api.github.com/repos/edgedb/edgedb/labels/bug", "name": "bug", "color": "e88da4", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "elprans", "id": 347119, "node_id": "MDQ6VXNlcjM0NzExOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/347119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elprans", "html_url": "https://github.com/elprans", "followers_url": "https://api.github.com/users/elprans/followers", "following_url": "https://api.github.com/users/elprans/following{/other_user}", "gists_url": "https://api.github.com/users/elprans/gists{/gist_id}", "starred_url": "https://api.github.com/users/elprans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elprans/subscriptions", "organizations_url": "https://api.github.com/users/elprans/orgs", "repos_url": "https://api.github.com/users/elprans/repos", "events_url": "https://api.github.com/users/elprans/events{/privacy}", "received_events_url": "https://api.github.com/users/elprans/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2017-07-12T20:37:15Z", "updated_at": "2017-08-01T21:59:00Z", "closed_at": "2017-08-01T21:59:00Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Steps to reproduce:\r\n\r\n1. Create a new cluster\r\n2. Create a new DB `test1` and switch to it\r\n3. Create a new module `test1`: `CREATE MODULE test1;`\r\n4. Create an atom:\r\n    ```\r\n    CREATE ATOM test1::a1 EXTENDING std::str {\r\n        CREATE CONSTRAINT std::enum(['a', 'b']);\r\n    };\r\n    ```\r\n5. `DROP ATOM test1::a1;`\r\n\r\nThis will lead to this exception:\r\n\r\n```\r\n1. asyncpg.exceptions.RaiseError: resolve_type_name: unknown type: \"288c3ba6-6741-11e7-8575-ab3c1ce9c654\"\r\n\r\n---------------------------------------- Traceback -----------------------------------------\r\n\r\n    /Users/yury/dev/edge/edgedb/edgedb/server/protocol.py, line 217, in _on_edge_connect\r\n        > self.backend = fut.result()\r\n    /Users/yury/dev/edge/edgedb/edgedb/server/pgsql/backend.py, line 1571, in open_database\r\n        > await bk.getschema()\r\n    /Users/yury/dev/edge/edgedb/edgedb/server/pgsql/backend.py, line 427, in getschema\r\n        > self.schema = await self.readschema()\r\n    /Users/yury/dev/edge/edgedb/edgedb/server/pgsql/backend.py, line 410, in readschema\r\n        > await self.read_constraints(schema)\r\n    /Users/yury/dev/edge/edgedb/edgedb/server/pgsql/backend.py, line 791, in read_constraints\r\n        > self.connection)\r\n    /Users/yury/dev/edge/edgedb/edgedb/server/pgsql/datasources/schema/constraints.py, line 42, in fetch\r\n        > \"\"\", name)\r\n    /Users/yury/dev/venvs/edgedb/lib/python3.6/site-packages/asyncpg/connection.py, line 314, in fetch\r\n        > return await self._execute(query, args, 0, timeout)\r\n    /Users/yury/dev/venvs/edgedb/lib/python3.6/site-packages/asyncpg/connection.py, line 997, in _execute\r\n        > return await self._do_execute(query, executor, timeout)\r\n    /Users/yury/dev/venvs/edgedb/lib/python3.6/site-packages/asyncpg/connection.py, line 1018, in _do_execute\r\n        > result = await executor(stmt, None)\r\n    asyncpg/protocol/protocol.pyx, line 189, in bind_execute (asyncpg/protocol/protocol.c:60713)\r\n\r\n\r\nasyncpg.exceptions.RaiseError: resolve_type_name: unknown type: \"288c3ba6-6741-11e7-8575-ab3c1ce9c654\"\r\n```", "reactions": {"url": "https://api.github.com/repos/edgedb/edgedb/issues/17/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/edgedb/edgedb/issues/17/timeline", "performed_via_github_app": null, "state_reason": "completed"}]