[{"url": "https://api.github.com/repos/ganeti/ganeti/issues/1440", "repository_url": "https://api.github.com/repos/ganeti/ganeti", "labels_url": "https://api.github.com/repos/ganeti/ganeti/issues/1440/labels{/name}", "comments_url": "https://api.github.com/repos/ganeti/ganeti/issues/1440/comments", "events_url": "https://api.github.com/repos/ganeti/ganeti/issues/1440/events", "html_url": "https://github.com/ganeti/ganeti/issues/1440", "id": 595101956, "node_id": "MDU6SXNzdWU1OTUxMDE5NTY=", "number": 1440, "title": "Powering instance down from within results in ERROR_down rather than USER_down", "user": {"login": "ronnyadsetts", "id": 1334007, "node_id": "MDQ6VXNlcjEzMzQwMDc=", "avatar_url": "https://avatars.githubusercontent.com/u/1334007?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronnyadsetts", "html_url": "https://github.com/ronnyadsetts", "followers_url": "https://api.github.com/users/ronnyadsetts/followers", "following_url": "https://api.github.com/users/ronnyadsetts/following{/other_user}", "gists_url": "https://api.github.com/users/ronnyadsetts/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronnyadsetts/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronnyadsetts/subscriptions", "organizations_url": "https://api.github.com/users/ronnyadsetts/orgs", "repos_url": "https://api.github.com/users/ronnyadsetts/repos", "events_url": "https://api.github.com/users/ronnyadsetts/events{/privacy}", "received_events_url": "https://api.github.com/users/ronnyadsetts/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 137427612, "node_id": "MDU6TGFiZWwxMzc0Mjc2MTI=", "url": "https://api.github.com/repos/ganeti/ganeti/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "rbott", "id": 13122740, "node_id": "MDQ6VXNlcjEzMTIyNzQw", "avatar_url": "https://avatars.githubusercontent.com/u/13122740?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rbott", "html_url": "https://github.com/rbott", "followers_url": "https://api.github.com/users/rbott/followers", "following_url": "https://api.github.com/users/rbott/following{/other_user}", "gists_url": "https://api.github.com/users/rbott/gists{/gist_id}", "starred_url": "https://api.github.com/users/rbott/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rbott/subscriptions", "organizations_url": "https://api.github.com/users/rbott/orgs", "repos_url": "https://api.github.com/users/rbott/repos", "events_url": "https://api.github.com/users/rbott/events{/privacy}", "received_events_url": "https://api.github.com/users/rbott/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rbott", "id": 13122740, "node_id": "MDQ6VXNlcjEzMTIyNzQw", "avatar_url": "https://avatars.githubusercontent.com/u/13122740?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rbott", "html_url": "https://github.com/rbott", "followers_url": "https://api.github.com/users/rbott/followers", "following_url": "https://api.github.com/users/rbott/following{/other_user}", "gists_url": "https://api.github.com/users/rbott/gists{/gist_id}", "starred_url": "https://api.github.com/users/rbott/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rbott/subscriptions", "organizations_url": "https://api.github.com/users/rbott/orgs", "repos_url": "https://api.github.com/users/rbott/repos", "events_url": "https://api.github.com/users/rbott/events{/privacy}", "received_events_url": "https://api.github.com/users/rbott/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/ganeti/ganeti/milestones/25", "html_url": "https://github.com/ganeti/ganeti/milestone/25", "labels_url": "https://api.github.com/repos/ganeti/ganeti/milestones/25/labels", "id": 5450977, "node_id": "MDk6TWlsZXN0b25lNTQ1MDk3Nw==", "number": 25, "title": "Release 3.0.0", "description": "Planning for the final 3.0 release", "creator": {"login": "saschalucas", "id": 8359898, "node_id": "MDQ6VXNlcjgzNTk4OTg=", "avatar_url": "https://avatars.githubusercontent.com/u/8359898?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saschalucas", "html_url": "https://github.com/saschalucas", "followers_url": "https://api.github.com/users/saschalucas/followers", "following_url": "https://api.github.com/users/saschalucas/following{/other_user}", "gists_url": "https://api.github.com/users/saschalucas/gists{/gist_id}", "starred_url": "https://api.github.com/users/saschalucas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saschalucas/subscriptions", "organizations_url": "https://api.github.com/users/saschalucas/orgs", "repos_url": "https://api.github.com/users/saschalucas/repos", "events_url": "https://api.github.com/users/saschalucas/events{/privacy}", "received_events_url": "https://api.github.com/users/saschalucas/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 7, "state": "closed", "created_at": "2020-05-22T13:28:19Z", "updated_at": "2020-12-24T09:14:51Z", "due_on": "2020-12-04T08:00:00Z", "closed_at": "2020-12-24T09:14:51Z"}, "comments": 12, "created_at": "2020-04-06T13:09:21Z", "updated_at": "2020-12-22T19:58:13Z", "closed_at": "2020-12-22T19:58:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "Issue reported as suggested by Sascha Lucas.\r\n\r\nThis is on Debian Buster with ganeti 2.16.0-5 and qemu-system-x86 1:3.1+dfsg-8+deb10u4.\r\n\r\nInitially reported by Christian Baumann, Message-Id: <7ad37664-0d85-4361-9d6d-8c489e563b7d@googlegroups.com>.\r\n\r\nWe sometimes have a need to power down instances from within the instance. This is accomplished in Ganeti using the \"user_shutdown\" at either the cluster or instance level and with the --user-shutdown cluster option.\r\n\r\nThis appears to be broken on the above platform. When running a 'poweroff' from within an instance, the instance correctly powers down. The instance status however is reported as ERROR_down. Ganeti watcher then comes along and restarts the instance.\r\n\r\n$ sudo gnt-cluster show | grep -E \"(shutdown|acpi)\"\r\n    acpi: True\r\n    user_shutdown: True\r\n  enabled user shutdown: True\r\n$ sudo gnt-instance show mysql-01.amazing-internet.net | grep -E \"(shutdown|acpi)\"\r\n    acpi: default (True)\r\n    user_shutdown: default (True)\r\n\r\nThanks.", "reactions": {"url": "https://api.github.com/repos/ganeti/ganeti/issues/1440/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/ganeti/ganeti/issues/1440/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/ganeti/ganeti/issues/1403", "repository_url": "https://api.github.com/repos/ganeti/ganeti", "labels_url": "https://api.github.com/repos/ganeti/ganeti/issues/1403/labels{/name}", "comments_url": "https://api.github.com/repos/ganeti/ganeti/issues/1403/comments", "events_url": "https://api.github.com/repos/ganeti/ganeti/issues/1403/events", "html_url": "https://github.com/ganeti/ganeti/pull/1403", "id": 526656729, "node_id": "MDExOlB1bGxSZXF1ZXN0MzQ0MDgxNTcx", "number": 1403, "title": "RPC: prevent cURL from sending Expect: 100-Continue", "user": {"login": "apoikos", "id": 1160889, "node_id": "MDQ6VXNlcjExNjA4ODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1160889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apoikos", "html_url": "https://github.com/apoikos", "followers_url": "https://api.github.com/users/apoikos/followers", "following_url": "https://api.github.com/users/apoikos/following{/other_user}", "gists_url": "https://api.github.com/users/apoikos/gists{/gist_id}", "starred_url": "https://api.github.com/users/apoikos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apoikos/subscriptions", "organizations_url": "https://api.github.com/users/apoikos/orgs", "repos_url": "https://api.github.com/users/apoikos/repos", "events_url": "https://api.github.com/users/apoikos/events{/privacy}", "received_events_url": "https://api.github.com/users/apoikos/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 137427612, "node_id": "MDU6TGFiZWwxMzc0Mjc2MTI=", "url": "https://api.github.com/repos/ganeti/ganeti/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 571939775, "node_id": "MDU6TGFiZWw1NzE5Mzk3NzU=", "url": "https://api.github.com/repos/ganeti/ganeti/labels/cla:%20yes", "name": "cla: yes", "color": "0e8a16", "default": false, "description": null}, {"id": 632512873, "node_id": "MDU6TGFiZWw2MzI1MTI4NzM=", "url": "https://api.github.com/repos/ganeti/ganeti/labels/Performance", "name": "Performance", "color": "ededed", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-11-21T15:12:28Z", "updated_at": "2019-11-22T09:34:06Z", "closed_at": "2019-11-22T09:34:06Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/ganeti/ganeti/pulls/1403", "html_url": "https://github.com/ganeti/ganeti/pull/1403", "diff_url": "https://github.com/ganeti/ganeti/pull/1403.diff", "patch_url": "https://github.com/ganeti/ganeti/pull/1403.patch", "merged_at": "2019-11-22T09:34:06Z"}, "body": "Curl sends POST/PUT requests using the Expect mechanism, to avoid doing\r\nunnecessary work in case the server rejects the request. While doing so,\r\ncurl waits 1 second for a '100 Continue' or other response and then\r\nsends the request body anyway in order to cope with broken/incomplete\r\nHTTP server implementations.\r\n\r\nOur HTTP server implementation unfortunately does not handle the Expect\r\ndance, so by default all curl POST/PUT requests will incur a 1-second\r\noverhead. Note that this had been previously fixed for the Python RPC\r\nclient in 8e29563f (\"RPC: disable curl's Expect header\"), but was never\r\ndone for the Haskell RPC client. This commit fixes the issue for the\r\nHaskell RPC client, eliminating the 1-second delay found in many query\r\ncalls that pass through LuxiD (e.g. gnt-instance list).\r\n\r\nEventually we should probably switch to a more feature-complete HTTP\r\nserver implementation, but for now this will have to do.", "reactions": {"url": "https://api.github.com/repos/ganeti/ganeti/issues/1403/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/ganeti/ganeti/issues/1403/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/ganeti/ganeti/issues/1399", "repository_url": "https://api.github.com/repos/ganeti/ganeti", "labels_url": "https://api.github.com/repos/ganeti/ganeti/issues/1399/labels{/name}", "comments_url": "https://api.github.com/repos/ganeti/ganeti/issues/1399/comments", "events_url": "https://api.github.com/repos/ganeti/ganeti/issues/1399/events", "html_url": "https://github.com/ganeti/ganeti/issues/1399", "id": 478455959, "node_id": "MDU6SXNzdWU0Nzg0NTU5NTk=", "number": 1399, "title": "gnt-node list shows wrong Sinst count (sinst_cnt)", "user": {"login": "the2nd", "id": 6143394, "node_id": "MDQ6VXNlcjYxNDMzOTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/6143394?v=4", "gravatar_id": "", "url": "https://api.github.com/users/the2nd", "html_url": "https://github.com/the2nd", "followers_url": "https://api.github.com/users/the2nd/followers", "following_url": "https://api.github.com/users/the2nd/following{/other_user}", "gists_url": "https://api.github.com/users/the2nd/gists{/gist_id}", "starred_url": "https://api.github.com/users/the2nd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/the2nd/subscriptions", "organizations_url": "https://api.github.com/users/the2nd/orgs", "repos_url": "https://api.github.com/users/the2nd/repos", "events_url": "https://api.github.com/users/the2nd/events{/privacy}", "received_events_url": "https://api.github.com/users/the2nd/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 137427612, "node_id": "MDU6TGFiZWwxMzc0Mjc2MTI=", "url": "https://api.github.com/repos/ganeti/ganeti/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1730393486, "node_id": "MDU6TGFiZWwxNzMwMzkzNDg2", "url": "https://api.github.com/repos/ganeti/ganeti/labels/target:stable-2.16", "name": "target:stable-2.16", "color": "96ea7c", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "apoikos", "id": 1160889, "node_id": "MDQ6VXNlcjExNjA4ODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1160889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apoikos", "html_url": "https://github.com/apoikos", "followers_url": "https://api.github.com/users/apoikos/followers", "following_url": "https://api.github.com/users/apoikos/following{/other_user}", "gists_url": "https://api.github.com/users/apoikos/gists{/gist_id}", "starred_url": "https://api.github.com/users/apoikos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apoikos/subscriptions", "organizations_url": "https://api.github.com/users/apoikos/orgs", "repos_url": "https://api.github.com/users/apoikos/repos", "events_url": "https://api.github.com/users/apoikos/events{/privacy}", "received_events_url": "https://api.github.com/users/apoikos/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "apoikos", "id": 1160889, "node_id": "MDQ6VXNlcjExNjA4ODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1160889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apoikos", "html_url": "https://github.com/apoikos", "followers_url": "https://api.github.com/users/apoikos/followers", "following_url": "https://api.github.com/users/apoikos/following{/other_user}", "gists_url": "https://api.github.com/users/apoikos/gists{/gist_id}", "starred_url": "https://api.github.com/users/apoikos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apoikos/subscriptions", "organizations_url": "https://api.github.com/users/apoikos/orgs", "repos_url": "https://api.github.com/users/apoikos/repos", "events_url": "https://api.github.com/users/apoikos/events{/privacy}", "received_events_url": "https://api.github.com/users/apoikos/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/ganeti/ganeti/milestones/24", "html_url": "https://github.com/ganeti/ganeti/milestone/24", "labels_url": "https://api.github.com/repos/ganeti/ganeti/milestones/24/labels", "id": 4925502, "node_id": "MDk6TWlsZXN0b25lNDkyNTUwMg==", "number": 24, "title": "Release 2.16.2", "description": "", "creator": {"login": "apoikos", "id": 1160889, "node_id": "MDQ6VXNlcjExNjA4ODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1160889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apoikos", "html_url": "https://github.com/apoikos", "followers_url": "https://api.github.com/users/apoikos/followers", "following_url": "https://api.github.com/users/apoikos/following{/other_user}", "gists_url": "https://api.github.com/users/apoikos/gists{/gist_id}", "starred_url": "https://api.github.com/users/apoikos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apoikos/subscriptions", "organizations_url": "https://api.github.com/users/apoikos/orgs", "repos_url": "https://api.github.com/users/apoikos/repos", "events_url": "https://api.github.com/users/apoikos/events{/privacy}", "received_events_url": "https://api.github.com/users/apoikos/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 3, "state": "closed", "created_at": "2019-12-12T14:18:34Z", "updated_at": "2020-06-01T08:24:39Z", "due_on": "2020-05-22T07:00:00Z", "closed_at": "2020-06-01T08:24:39Z"}, "comments": 2, "created_at": "2019-08-08T12:58:45Z", "updated_at": "2020-05-10T09:00:28Z", "closed_at": "2020-05-10T09:00:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "# Version info.\r\n# gnt-cluster version\r\nSoftware version: 2.16.1\r\nInternode protocol: 2160000\r\nConfiguration format: 2160000\r\nOS api version: 20\r\nExport interface: 0\r\nVCS version: (ganeti) version 2.16.1-9\r\n\r\nThe command \"gnt-node list\" shows the wrong \"Sinst\" count.\r\n\r\nRunning the following command shows the instances (names) multiple times, once for each disk/drbd device the instance has (in this case 3 disks per instance).\r\n\r\n# gnt-node list --no-headers -o sinst_list testnode2 | tr ',' '\\n'\r\ninstance1\r\ninstance1\r\ninstance1\r\ninstance2\r\ninstance2\r\ninstance2\r\ninstance3\r\ninstance3\r\ninstance3\r\ninstance4\r\ninstance4\r\ninstance4\r\n\r\nIt seems like the data is received from luxid at this line https://github.com/ganeti/ganeti/blob/0dfa4d212ae2fc216db0249d5f6e0b4aa22ac059/lib/cli.py#L2035 and i do not have any haskell skills. \u00af\\_(\u30c4)_/\u00af", "reactions": {"url": "https://api.github.com/repos/ganeti/ganeti/issues/1399/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/ganeti/ganeti/issues/1399/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/ganeti/ganeti/issues/1323", "repository_url": "https://api.github.com/repos/ganeti/ganeti", "labels_url": "https://api.github.com/repos/ganeti/ganeti/issues/1323/labels{/name}", "comments_url": "https://api.github.com/repos/ganeti/ganeti/issues/1323/comments", "events_url": "https://api.github.com/repos/ganeti/ganeti/issues/1323/events", "html_url": "https://github.com/ganeti/ganeti/issues/1323", "id": 405736602, "node_id": "MDU6SXNzdWU0MDU3MzY2MDI=", "number": 1323, "title": "WaitForJobChange sometimes returns malformed responses", "user": {"login": "apoikos", "id": 1160889, "node_id": "MDQ6VXNlcjExNjA4ODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1160889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apoikos", "html_url": "https://github.com/apoikos", "followers_url": "https://api.github.com/users/apoikos/followers", "following_url": "https://api.github.com/users/apoikos/following{/other_user}", "gists_url": "https://api.github.com/users/apoikos/gists{/gist_id}", "starred_url": "https://api.github.com/users/apoikos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apoikos/subscriptions", "organizations_url": "https://api.github.com/users/apoikos/orgs", "repos_url": "https://api.github.com/users/apoikos/repos", "events_url": "https://api.github.com/users/apoikos/events{/privacy}", "received_events_url": "https://api.github.com/users/apoikos/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 137427612, "node_id": "MDU6TGFiZWwxMzc0Mjc2MTI=", "url": "https://api.github.com/repos/ganeti/ganeti/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 633159780, "node_id": "MDU6TGFiZWw2MzMxNTk3ODA=", "url": "https://api.github.com/repos/ganeti/ganeti/labels/Component-luxi", "name": "Component-luxi", "color": "ededed", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/ganeti/ganeti/milestones/21", "html_url": "https://github.com/ganeti/ganeti/milestone/21", "labels_url": "https://api.github.com/repos/ganeti/ganeti/milestones/21/labels", "id": 4065989, "node_id": "MDk6TWlsZXN0b25lNDA2NTk4OQ==", "number": 21, "title": "Release 3.0 beta", "description": "", "creator": {"login": "apoikos", "id": 1160889, "node_id": "MDQ6VXNlcjExNjA4ODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1160889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apoikos", "html_url": "https://github.com/apoikos", "followers_url": "https://api.github.com/users/apoikos/followers", "following_url": "https://api.github.com/users/apoikos/following{/other_user}", "gists_url": "https://api.github.com/users/apoikos/gists{/gist_id}", "starred_url": "https://api.github.com/users/apoikos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apoikos/subscriptions", "organizations_url": "https://api.github.com/users/apoikos/orgs", "repos_url": "https://api.github.com/users/apoikos/repos", "events_url": "https://api.github.com/users/apoikos/events{/privacy}", "received_events_url": "https://api.github.com/users/apoikos/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 33, "state": "closed", "created_at": "2019-02-18T12:11:18Z", "updated_at": "2020-06-05T11:51:23Z", "due_on": "2020-06-05T07:00:00Z", "closed_at": "2020-06-05T11:51:23Z"}, "comments": 2, "created_at": "2019-02-01T14:58:58Z", "updated_at": "2019-12-08T16:53:10Z", "closed_at": "2019-12-08T16:53:10Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "2.16.0's QA sporadically fails on Debian's [CI system](https://ci.debian.net/packages/g/ganeti/), with the following error:\r\n```\r\nStderr was:\r\nUnhandled protocol error while talking to the master daemon:\r\nError while deserializing response: Extra data: line 1 column 28 - line 1 column 69 (char 27 - 68)\r\n```\r\n\r\nI managed to reproduce this locally and it looks like LuxiD actually sends out a malformed response by gluing two responses together. Adding some debug prints in `rpc.client.CallRPCMethod`, the conversation between `gnt-cluster init` and `LuxiD` seems to be the following:\r\n\r\n```json\r\n->{\"args\": [[\"cluster_name\"]], \"method\": \"QueryConfigValues\", \"version\": 2160000}\r\n<-{\"success\":true,\"result\":[\"cluster\"]}\r\n\r\n->{\"args\": [[{\"comment\": null, \"dry_run\": null, \"OP_ID\": \"OP_CLUSTER_POST_INIT\", \"reason\": [[\"gnt:client:gnt-cluster\", \"init\", 1549032471372483072]], \"priority\": 0, \"debug_level\": 0, \"depends\": null}]], \"method\": \"SubmitJob\", \"version\": 2160000}\r\n<-{\"success\":true,\"result\":1}\r\n\r\n->{\"args\": [1, [\"status\"], null, null, 60], \"method\": \"WaitForJobChange\", \"version\": 2160000}\r\n<-{\"success\":true,\"result\":1}{\"success\":true,\"result\":[[\"queued\"],[]]}\r\n```\r\n\r\nNote that LuxiD responds to `WaitForJobChange` with a malformed response that contains the previous response to `SubmitJob` _and_ the actual response to `WaitForJobChange` \u2014 a healthy response would only contain the `{\"success\":true,\"result\":[[\"queued\"],[]]}` message. Note that the offset (\"column 28\") in the error corresponds to the beginning of the second JSON object. This is not trivial to reproduce, it takes a number of attempts to hit it, so it looks like a race condition of sorts. It also goes away when starting LuxiD with `-d`, which also contributes to the racy nature of this bug.", "reactions": {"url": "https://api.github.com/repos/ganeti/ganeti/issues/1323/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/ganeti/ganeti/issues/1323/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/ganeti/ganeti/issues/1316", "repository_url": "https://api.github.com/repos/ganeti/ganeti", "labels_url": "https://api.github.com/repos/ganeti/ganeti/issues/1316/labels{/name}", "comments_url": "https://api.github.com/repos/ganeti/ganeti/issues/1316/comments", "events_url": "https://api.github.com/repos/ganeti/ganeti/issues/1316/events", "html_url": "https://github.com/ganeti/ganeti/issues/1316", "id": 383900937, "node_id": "MDU6SXNzdWUzODM5MDA5Mzc=", "number": 1316, "title": "Disk hotplugging is broken with QEMU >= 2.8", "user": {"login": "apoikos", "id": 1160889, "node_id": "MDQ6VXNlcjExNjA4ODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1160889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apoikos", "html_url": "https://github.com/apoikos", "followers_url": "https://api.github.com/users/apoikos/followers", "following_url": "https://api.github.com/users/apoikos/following{/other_user}", "gists_url": "https://api.github.com/users/apoikos/gists{/gist_id}", "starred_url": "https://api.github.com/users/apoikos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apoikos/subscriptions", "organizations_url": "https://api.github.com/users/apoikos/orgs", "repos_url": "https://api.github.com/users/apoikos/repos", "events_url": "https://api.github.com/users/apoikos/events{/privacy}", "received_events_url": "https://api.github.com/users/apoikos/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 137427612, "node_id": "MDU6TGFiZWwxMzc0Mjc2MTI=", "url": "https://api.github.com/repos/ganeti/ganeti/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 631699483, "node_id": "MDU6TGFiZWw2MzE2OTk0ODM=", "url": "https://api.github.com/repos/ganeti/ganeti/labels/Hypervisor-KVM", "name": "Hypervisor-KVM", "color": "ededed", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/ganeti/ganeti/milestones/22", "html_url": "https://github.com/ganeti/ganeti/milestone/22", "labels_url": "https://api.github.com/repos/ganeti/ganeti/milestones/22/labels", "id": 4065990, "node_id": "MDk6TWlsZXN0b25lNDA2NTk5MA==", "number": 22, "title": "Release 2.16.1", "description": "", "creator": {"login": "apoikos", "id": 1160889, "node_id": "MDQ6VXNlcjExNjA4ODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1160889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apoikos", "html_url": "https://github.com/apoikos", "followers_url": "https://api.github.com/users/apoikos/followers", "following_url": "https://api.github.com/users/apoikos/following{/other_user}", "gists_url": "https://api.github.com/users/apoikos/gists{/gist_id}", "starred_url": "https://api.github.com/users/apoikos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apoikos/subscriptions", "organizations_url": "https://api.github.com/users/apoikos/orgs", "repos_url": "https://api.github.com/users/apoikos/repos", "events_url": "https://api.github.com/users/apoikos/events{/privacy}", "received_events_url": "https://api.github.com/users/apoikos/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 10, "state": "closed", "created_at": "2019-02-18T12:12:15Z", "updated_at": "2019-04-04T07:59:24Z", "due_on": null, "closed_at": "2019-04-04T07:59:24Z"}, "comments": 3, "created_at": "2018-11-23T18:05:35Z", "updated_at": "2019-02-22T07:58:25Z", "closed_at": "2019-02-22T07:58:25Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "When hotplugging a disk on a KVM instance, we're using the `blockdev-add` QMP command to register the disk with the hypervisor. The form of the command we're using is unfortunately no longer supported since [QEMU 2.8](https://github.com/qemu/qemu/commit/0153d2f50bc2ad3f41810d838fcf66acbf10f07a). Hot-adding a disk to an instance currently outputs:\r\n\r\n```\r\n          Content: [2, message,  - WARNING: Could not hotplug device: Error while executing backend function: kvm: error executing the blockdev-add command: Parameter 'driver' is missing (GenericError):]\r\n```\r\n\r\nThe `blockdev-add` command was previously regarded experimental and has been marked stable as of QEMU 2.9.", "reactions": {"url": "https://api.github.com/repos/ganeti/ganeti/issues/1316/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/ganeti/ganeti/issues/1316/timeline", "performed_via_github_app": null, "state_reason": "completed"}]