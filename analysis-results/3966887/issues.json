[{"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/2105", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/2105/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/2105/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/2105/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/2105", "id": 460574265, "node_id": "MDU6SXNzdWU0NjA1NzQyNjU=", "number": 2105, "title": "MongoEngine docs are not up-to-date", "user": {"login": "bagerard", "id": 11854690, "node_id": "MDQ6VXNlcjExODU0Njkw", "avatar_url": "https://avatars.githubusercontent.com/u/11854690?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bagerard", "html_url": "https://github.com/bagerard", "followers_url": "https://api.github.com/users/bagerard/followers", "following_url": "https://api.github.com/users/bagerard/following{/other_user}", "gists_url": "https://api.github.com/users/bagerard/gists{/gist_id}", "starred_url": "https://api.github.com/users/bagerard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bagerard/subscriptions", "organizations_url": "https://api.github.com/users/bagerard/orgs", "repos_url": "https://api.github.com/users/bagerard/repos", "events_url": "https://api.github.com/users/bagerard/events{/privacy}", "received_events_url": "https://api.github.com/users/bagerard/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}, {"id": 204222428, "node_id": "MDU6TGFiZWwyMDQyMjI0Mjg=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Documentation", "name": "Documentation", "color": "c5def5", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "wojcikstefan", "id": 1718372, "node_id": "MDQ6VXNlcjE3MTgzNzI=", "avatar_url": "https://avatars.githubusercontent.com/u/1718372?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wojcikstefan", "html_url": "https://github.com/wojcikstefan", "followers_url": "https://api.github.com/users/wojcikstefan/followers", "following_url": "https://api.github.com/users/wojcikstefan/following{/other_user}", "gists_url": "https://api.github.com/users/wojcikstefan/gists{/gist_id}", "starred_url": "https://api.github.com/users/wojcikstefan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wojcikstefan/subscriptions", "organizations_url": "https://api.github.com/users/wojcikstefan/orgs", "repos_url": "https://api.github.com/users/wojcikstefan/repos", "events_url": "https://api.github.com/users/wojcikstefan/events{/privacy}", "received_events_url": "https://api.github.com/users/wojcikstefan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "wojcikstefan", "id": 1718372, "node_id": "MDQ6VXNlcjE3MTgzNzI=", "avatar_url": "https://avatars.githubusercontent.com/u/1718372?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wojcikstefan", "html_url": "https://github.com/wojcikstefan", "followers_url": "https://api.github.com/users/wojcikstefan/followers", "following_url": "https://api.github.com/users/wojcikstefan/following{/other_user}", "gists_url": "https://api.github.com/users/wojcikstefan/gists{/gist_id}", "starred_url": "https://api.github.com/users/wojcikstefan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wojcikstefan/subscriptions", "organizations_url": "https://api.github.com/users/wojcikstefan/orgs", "repos_url": "https://api.github.com/users/wojcikstefan/repos", "events_url": "https://api.github.com/users/wojcikstefan/events{/privacy}", "received_events_url": "https://api.github.com/users/wojcikstefan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2019-06-25T18:27:19Z", "updated_at": "2019-07-15T08:21:26Z", "closed_at": "2019-07-15T08:01:08Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "It looks like the online docs isn't updated since 0.17.0\r\nhttps://mongoengine-odm.readthedocs.io/changelog.html\r\n\r\nCould you also clarify how readthedocs update is supposed to be triggered", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/2105/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/2105/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1869", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1869/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1869/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1869/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1869", "id": 356452693, "node_id": "MDU6SXNzdWUzNTY0NTI2OTM=", "number": 1869, "title": "Flaky test in test suite makes CI randomly failing due to query_counter context manager", "user": {"login": "bagerard", "id": 11854690, "node_id": "MDQ6VXNlcjExODU0Njkw", "avatar_url": "https://avatars.githubusercontent.com/u/11854690?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bagerard", "html_url": "https://github.com/bagerard", "followers_url": "https://api.github.com/users/bagerard/followers", "following_url": "https://api.github.com/users/bagerard/following{/other_user}", "gists_url": "https://api.github.com/users/bagerard/gists{/gist_id}", "starred_url": "https://api.github.com/users/bagerard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bagerard/subscriptions", "organizations_url": "https://api.github.com/users/bagerard/orgs", "repos_url": "https://api.github.com/users/bagerard/repos", "events_url": "https://api.github.com/users/bagerard/events{/privacy}", "received_events_url": "https://api.github.com/users/bagerard/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-09-03T10:43:28Z", "updated_at": "2018-09-07T06:22:12Z", "closed_at": "2018-09-07T06:22:12Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "The test `def test_no_cached_queryset(self):` Is failing from time to time which is not handy as it makes the CI failing for unrelated reasons in PRs (e.g: #1766). https://github.com/MongoEngine/mongoengine/blob/42bbe6392729ee12ee4461452ac3614814933dcd/tests/queryset/queryset.py#L4709-L4719\r\n\r\nThe issue occurs because the query_counter() context was catching queries that aren't related to this particular test.\r\n\r\nI managed to reproduce the issue after adding some debugging code and running travis in my fork (https://travis-ci.com/bagerard/mongoengine/jobs/143421029). The additional query being counted is actually a 'killcursors' query, probably being issued after the garbage collector closes another pymongo cursors.\r\n\r\nThe query_counter context manager is very handy for debugging but since it is not only counting the queries being issued within the context (other threads or processes can pollute it), it is not very robust.\r\n\r\nI'll push a PR that makes the query_counter context ignoring 'killcursors' queries to fix this (and add a parameter `ignore_query` to the query_counter to let users customize the behavior if needed). Let me know if you have other ideas", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1869/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1869/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1852", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1852/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1852/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1852/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1852", "id": 354022919, "node_id": "MDU6SXNzdWUzNTQwMjI5MTk=", "number": 1852, "title": "ListField/BaseList marked has changed in _changed_fields in case of errors", "user": {"login": "bagerard", "id": 11854690, "node_id": "MDQ6VXNlcjExODU0Njkw", "avatar_url": "https://avatars.githubusercontent.com/u/11854690?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bagerard", "html_url": "https://github.com/bagerard", "followers_url": "https://api.github.com/users/bagerard/followers", "following_url": "https://api.github.com/users/bagerard/following{/other_user}", "gists_url": "https://api.github.com/users/bagerard/gists{/gist_id}", "starred_url": "https://api.github.com/users/bagerard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bagerard/subscriptions", "organizations_url": "https://api.github.com/users/bagerard/orgs", "repos_url": "https://api.github.com/users/bagerard/repos", "events_url": "https://api.github.com/users/bagerard/events{/privacy}", "received_events_url": "https://api.github.com/users/bagerard/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-08-25T15:55:48Z", "updated_at": "2018-12-19T19:16:57Z", "closed_at": "2018-12-19T19:16:57Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "While working on something else I've noticed that the BaseList could get marked as 'changed' (i.e: added to Document._changed_fields) when it shouldn't. This is harmless but I thought it was worth fixing.\r\n\r\nSee below:\r\n```\r\nclass MyDoc(me.Document):\r\n    my_list = me.ListField(me.StringField())\r\n\r\ndoc = MyDoc(my_list=['a'])\r\ndoc.save()\r\nprint(doc._changed_fields) == []\r\n\r\ntry:\r\n    doc.my_list.remove('y')\r\nexcept ValueError:    # ValueError: list.remove(x): x not in list\r\n    print(doc._changed_fields)         # ['my_list'] --> Wrong!\r\n```\r\n\r\nThe issue is the same with any of the methods that could raise an error (pop, sort,+=, etc). It occurs because we mark it as changed before applying the change. I'll submit a PR shortly", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1852/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1852/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1733", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1733/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1733/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1733/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1733", "id": 292465516, "node_id": "MDU6SXNzdWUyOTI0NjU1MTY=", "number": 1733, "title": "Update of a ListField depends on an unrelated dynamic field update", "user": {"login": "th-erker", "id": 35792856, "node_id": "MDQ6VXNlcjM1NzkyODU2", "avatar_url": "https://avatars.githubusercontent.com/u/35792856?v=4", "gravatar_id": "", "url": "https://api.github.com/users/th-erker", "html_url": "https://github.com/th-erker", "followers_url": "https://api.github.com/users/th-erker/followers", "following_url": "https://api.github.com/users/th-erker/following{/other_user}", "gists_url": "https://api.github.com/users/th-erker/gists{/gist_id}", "starred_url": "https://api.github.com/users/th-erker/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/th-erker/subscriptions", "organizations_url": "https://api.github.com/users/th-erker/orgs", "repos_url": "https://api.github.com/users/th-erker/repos", "events_url": "https://api.github.com/users/th-erker/events{/privacy}", "received_events_url": "https://api.github.com/users/th-erker/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-01-29T16:11:07Z", "updated_at": "2018-11-13T20:45:09Z", "closed_at": "2018-11-13T20:44:03Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Summary**\r\nWhen a ListField is updated to the empty list, the actual behavior (setting to the empty list or unsetting) is dependent on whether any dynamic (ad-hoc) field is updated too.\r\n \r\n**How to reproduce**\r\n```python\r\n>>> class Doc(mongoengine.DynamicDocument):\r\n...     x = mongoengine.ListField(mongoengine.BooleanField(), default=lambda: [True])\r\n... \r\n>>> f = Doc()\r\n>>> f.save()\r\n<Doc: Doc object>\r\n>>> f.x = []\r\n>>> f.save()\r\n<Doc: Doc object>\r\n>>> f = Doc.objects.get(id=f.id)\r\n>>> f.x\r\n[]\r\n>>> \r\n>>> g = Doc()\r\n>>> g.save()\r\n<Doc: Doc object>\r\n>>> g.x = []\r\n>>> g.y = 1\r\n>>> g.save()\r\n<Doc: Doc object>\r\n>>> g = Doc.objects.get(id=g.id)\r\n>>> g.x\r\n[True]\r\n```\r\n\r\n**Analysis**\r\n`base.document.BaseDocument._delta` calculates which fields (paths) to unset (instead of setting to a value). The relevant loop uses the following shortcut, otherwise the value is checked against the default for that field:\r\n```python\r\n      if (self._dynamic and len(parts) and parts[0] in\r\n                    self._dynamic_fields):\r\n                del set_data[path]\r\n                unset_data[path] = 1\r\n```\r\nHowever, `parts` is a leftover from the previous loop. So whenever the document is dynamic and a dynamic field is updated, this condition is true, and the field is unset (case g; the default value for x is used). Otherwise, the field x is set to `[]`, because it is not equal to the default value (case f).", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1733/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1733/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1602", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1602/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1602/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1602/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1602", "id": 244388808, "node_id": "MDU6SXNzdWUyNDQzODg4MDg=", "number": 1602, "title": "Invalid QuerySet count caching ", "user": {"login": "wojcikstefan", "id": 1718372, "node_id": "MDQ6VXNlcjE3MTgzNzI=", "avatar_url": "https://avatars.githubusercontent.com/u/1718372?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wojcikstefan", "html_url": "https://github.com/wojcikstefan", "followers_url": "https://api.github.com/users/wojcikstefan/followers", "following_url": "https://api.github.com/users/wojcikstefan/following{/other_user}", "gists_url": "https://api.github.com/users/wojcikstefan/gists{/gist_id}", "starred_url": "https://api.github.com/users/wojcikstefan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wojcikstefan/subscriptions", "organizations_url": "https://api.github.com/users/wojcikstefan/orgs", "repos_url": "https://api.github.com/users/wojcikstefan/repos", "events_url": "https://api.github.com/users/wojcikstefan/events{/privacy}", "received_events_url": "https://api.github.com/users/wojcikstefan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}, {"id": 553307063, "node_id": "MDU6TGFiZWw1NTMzMDcwNjM=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/High%20Priority", "name": "High Priority", "color": "b60205", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-07-20T14:44:56Z", "updated_at": "2018-09-07T07:48:58Z", "closed_at": "2018-09-07T07:48:58Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Steps to reproduce:\r\n```\r\nclass User(Document):\r\n    name = StringField()\r\n\r\nUser.drop_collection()\r\nUser.objects.create(name='aaa')\r\nUser.objects.create(name='bbb')\r\nUser.objects.create(name='ccc')\r\nqs = User.objects\r\nprint qs.count(with_limit_and_skip=True)  # 3\r\nUser.objects.create(name='ddd')\r\nprint qs.count(with_limit_and_skip=True)  # still 3 :(\r\n```\r\n\r\nExpected behavior: the 2nd count returns 4.\r\nActual behavior: the 2nd count returns 3, because the query set's previous count result is cached.", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1602/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1602/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1569", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1569/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1569/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1569/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1569", "id": 236551476, "node_id": "MDU6SXNzdWUyMzY1NTE0NzY=", "number": 1569, "title": "Document.modify() fails on sharded collections", "user": {"login": "chromaticgliss", "id": 196342, "node_id": "MDQ6VXNlcjE5NjM0Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/196342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chromaticgliss", "html_url": "https://github.com/chromaticgliss", "followers_url": "https://api.github.com/users/chromaticgliss/followers", "following_url": "https://api.github.com/users/chromaticgliss/following{/other_user}", "gists_url": "https://api.github.com/users/chromaticgliss/gists{/gist_id}", "starred_url": "https://api.github.com/users/chromaticgliss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chromaticgliss/subscriptions", "organizations_url": "https://api.github.com/users/chromaticgliss/orgs", "repos_url": "https://api.github.com/users/chromaticgliss/repos", "events_url": "https://api.github.com/users/chromaticgliss/events{/privacy}", "received_events_url": "https://api.github.com/users/chromaticgliss/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}, {"id": 553307063, "node_id": "MDU6TGFiZWw1NTMzMDcwNjM=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/High%20Priority", "name": "High Priority", "color": "b60205", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2017-06-16T17:54:36Z", "updated_at": "2018-11-09T14:20:08Z", "closed_at": "2018-11-09T14:20:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "Recently had a snippet like this that started failing after we sharded our collection.\r\n\r\nDocumentExample is a mongoengine Document, with the shard key defined in its meta property as the docs suggest.\r\n\r\n```\r\n    obj_list = []\r\n    doc_set = DocumentExample.objects.filter(processed=False)\r\n    for obj in doc_set:\r\n        modified = obj.modify(\r\n            modified_date=datetime.datetime.utcnow(),\r\n            processed=True\r\n        )\r\n        if modified:\r\n            obj_list.append(obj)\r\n```\r\n\r\nThis was failing with the following exception:\r\n\r\n```\r\n  File \"/home/shemmy/sites/sunlight/envs/sunlight/local/lib/python2.7/site-packages/mongoengine/document.py\", line 239, in modify\r\n    updated = self._qs(**query).modify(new=True, **update)\r\n  File \"/home/shemmy/sites/sunlight/envs/sunlight/local/lib/python2.7/site-packages/mongoengine/queryset/base.py\", line 579, in modify\r\n    raise OperationError(u\"Update failed (%s)\" % err)\r\nmongoengine.errors.OperationError: Update failed (exception: query for sharded findAndModify must have shardkey)\r\n\r\n```\r\n\r\nIn order to fix we included the Document's `_object_key` property, which includes the shard key, as a query argument.\r\n\r\n```\r\n    obj_list = []\r\n    doc_set = DocumentExample.objects.filter(processed=False)\r\n    for obj in doc_set:\r\n        modified = obj.modify(\r\n            query=obj._object_key, # *** ADDED THIS ****\r\n            modified_date=datetime.datetime.utcnow(),\r\n            processed=True\r\n        )\r\n        if modified:\r\n            obj_list.append(obj)\r\n```\r\n\r\nPerhaps I'm misunderstanding the purpose of the `modify()` function, but it seems like the `_object_key` property should be used by default instead of just the primary key here, as is the case in the `save()` and `update()` functions.", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1569/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1569/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1519", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1519/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1519/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1519/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1519", "id": 217379052, "node_id": "MDU6SXNzdWUyMTczNzkwNTI=", "number": 1519, "title": "reverse_delete_rule PULL not working on self reference fields", "user": {"login": "spitzbubchen", "id": 1012301, "node_id": "MDQ6VXNlcjEwMTIzMDE=", "avatar_url": "https://avatars.githubusercontent.com/u/1012301?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spitzbubchen", "html_url": "https://github.com/spitzbubchen", "followers_url": "https://api.github.com/users/spitzbubchen/followers", "following_url": "https://api.github.com/users/spitzbubchen/following{/other_user}", "gists_url": "https://api.github.com/users/spitzbubchen/gists{/gist_id}", "starred_url": "https://api.github.com/users/spitzbubchen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spitzbubchen/subscriptions", "organizations_url": "https://api.github.com/users/spitzbubchen/orgs", "repos_url": "https://api.github.com/users/spitzbubchen/repos", "events_url": "https://api.github.com/users/spitzbubchen/events{/privacy}", "received_events_url": "https://api.github.com/users/spitzbubchen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2017-03-27T21:21:29Z", "updated_at": "2017-12-23T03:33:18Z", "closed_at": "2017-12-23T03:33:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "Using the following model:\r\n\r\n```\r\nclass Record(db.Document):\r\n\tchildren = db.ListField(db.ReferenceField('self'), reverse_delete_rule = 'PULL')\r\n```\r\n\r\nand appending a child so that print of record.children looks like: \r\n`[<Record: my record>]`\r\n\r\nand then deleting the child results in print of parent record.children becoming:\r\n`[DBRef('record', ObjectId('58d98058b6697b29544fef21'))]`\r\n\r\nIt seems that the child is not being pulled from the parent upon deletion....???", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1519/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1519/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1475", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1475/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1475/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1475/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1475", "id": 205749538, "node_id": "MDU6SXNzdWUyMDU3NDk1Mzg=", "number": 1475, "title": ".limit broken after re-accessing stored Queryset object in 0.10.1 and beyond", "user": {"login": "liuhelen10", "id": 4095479, "node_id": "MDQ6VXNlcjQwOTU0Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/4095479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liuhelen10", "html_url": "https://github.com/liuhelen10", "followers_url": "https://api.github.com/users/liuhelen10/followers", "following_url": "https://api.github.com/users/liuhelen10/following{/other_user}", "gists_url": "https://api.github.com/users/liuhelen10/gists{/gist_id}", "starred_url": "https://api.github.com/users/liuhelen10/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liuhelen10/subscriptions", "organizations_url": "https://api.github.com/users/liuhelen10/orgs", "repos_url": "https://api.github.com/users/liuhelen10/repos", "events_url": "https://api.github.com/users/liuhelen10/events{/privacy}", "received_events_url": "https://api.github.com/users/liuhelen10/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-02-07T00:27:14Z", "updated_at": "2017-02-09T20:16:17Z", "closed_at": "2017-02-09T20:16:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "To my knowledge, this is occurring in `0.10.1` through `0.11.0` (I discovered when upgrading from `0.9.0`). \r\n\r\n`.limit` works fine when being called on the initial declaration of a queryset, but breaks if you access the queryset beforehand and then try to call `.limit` on it.\r\n\r\nI tested this with `class Test(Document): ...`\r\n\r\n```\r\nIn [1]: Test.objects\r\nOut [1]: [<Test: Test object>, <Test: Test object>]\r\n\r\nIn [2]: test_objects = Test.objects\r\nIn [3]: test_objects.limit(1)\r\nOut [3]: [<Test: Test object>]\r\n\r\nIn [4]: test_objects\r\nOut [4]: [<Test: Test object>, <Test: Test object>]\r\n\r\nIn [5]: test_objects.limit(1)\r\nOut [5]: [<Test: Test object>, <Test: Test object>]\r\n```\r\n\r\nAnd just for good measure:\r\n\r\n```\r\nIn [6]: test_objects = Test.objects\r\nIn [7]: test_objects\r\nOut [7]: [<Test: Test object>, <Test: Test object>]\r\n\r\nIn [8]: test_objects.limit(1)\r\nOut [8]: [<Test: Test object>, <Test: Test object>]\r\n```\r\n\r\nIt seems like this is maybe related to https://github.com/MongoEngine/mongoengine/issues/1136. Either way, IMO this is a pretty big bug.", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1475/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1475/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1472", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1472/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1472/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1472/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1472", "id": 203041244, "node_id": "MDU6SXNzdWUyMDMwNDEyNDQ=", "number": 1472, "title": "Primary key index is not unique?", "user": {"login": "mindojo-victor", "id": 17159503, "node_id": "MDQ6VXNlcjE3MTU5NTAz", "avatar_url": "https://avatars.githubusercontent.com/u/17159503?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mindojo-victor", "html_url": "https://github.com/mindojo-victor", "followers_url": "https://api.github.com/users/mindojo-victor/followers", "following_url": "https://api.github.com/users/mindojo-victor/following{/other_user}", "gists_url": "https://api.github.com/users/mindojo-victor/gists{/gist_id}", "starred_url": "https://api.github.com/users/mindojo-victor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mindojo-victor/subscriptions", "organizations_url": "https://api.github.com/users/mindojo-victor/orgs", "repos_url": "https://api.github.com/users/mindojo-victor/repos", "events_url": "https://api.github.com/users/mindojo-victor/events{/privacy}", "received_events_url": "https://api.github.com/users/mindojo-victor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-01-25T08:35:43Z", "updated_at": "2018-03-29T22:08:03Z", "closed_at": "2017-03-04T06:33:13Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "How is that primary key index is not unique?\r\n```python\r\nclass CeleryTask(Document):\r\n    \"\"\"Our track of Celery tasks.\r\n    \"\"\"\r\n    id = me.StringField(primary_key=True)\r\n    name = me.StringField()\r\n    args = me.DictField()\r\n    created_at = me.DateTimeField(default=lambda: datetime.datetime.utcnow())\r\n\r\n    meta = {\r\n        'db_alias': 'celery',\r\n        'collection': 'tasks',\r\n        'indexes': [\r\n            {'fields': ['name']},\r\n            {'fields': ['created_at']},\r\n        ],\r\n    }\r\n```\r\nAnd those docs without explicit `id` field defined also are not unique.", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1472/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1472/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1469", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1469/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1469/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1469/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1469", "id": 200700461, "node_id": "MDU6SXNzdWUyMDA3MDA0NjE=", "number": 1469, "title": "BaseQuerySet._cursor_obj inconsistent handling with query methods, e.g. skip and limit?", "user": {"login": "alanbriolat", "id": 12193, "node_id": "MDQ6VXNlcjEyMTkz", "avatar_url": "https://avatars.githubusercontent.com/u/12193?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanbriolat", "html_url": "https://github.com/alanbriolat", "followers_url": "https://api.github.com/users/alanbriolat/followers", "following_url": "https://api.github.com/users/alanbriolat/following{/other_user}", "gists_url": "https://api.github.com/users/alanbriolat/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanbriolat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanbriolat/subscriptions", "organizations_url": "https://api.github.com/users/alanbriolat/orgs", "repos_url": "https://api.github.com/users/alanbriolat/repos", "events_url": "https://api.github.com/users/alanbriolat/events{/privacy}", "received_events_url": "https://api.github.com/users/alanbriolat/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "wojcikstefan", "id": 1718372, "node_id": "MDQ6VXNlcjE3MTgzNzI=", "avatar_url": "https://avatars.githubusercontent.com/u/1718372?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wojcikstefan", "html_url": "https://github.com/wojcikstefan", "followers_url": "https://api.github.com/users/wojcikstefan/followers", "following_url": "https://api.github.com/users/wojcikstefan/following{/other_user}", "gists_url": "https://api.github.com/users/wojcikstefan/gists{/gist_id}", "starred_url": "https://api.github.com/users/wojcikstefan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wojcikstefan/subscriptions", "organizations_url": "https://api.github.com/users/wojcikstefan/orgs", "repos_url": "https://api.github.com/users/wojcikstefan/repos", "events_url": "https://api.github.com/users/wojcikstefan/events{/privacy}", "received_events_url": "https://api.github.com/users/wojcikstefan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "wojcikstefan", "id": 1718372, "node_id": "MDQ6VXNlcjE3MTgzNzI=", "avatar_url": "https://avatars.githubusercontent.com/u/1718372?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wojcikstefan", "html_url": "https://github.com/wojcikstefan", "followers_url": "https://api.github.com/users/wojcikstefan/followers", "following_url": "https://api.github.com/users/wojcikstefan/following{/other_user}", "gists_url": "https://api.github.com/users/wojcikstefan/gists{/gist_id}", "starred_url": "https://api.github.com/users/wojcikstefan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wojcikstefan/subscriptions", "organizations_url": "https://api.github.com/users/wojcikstefan/orgs", "repos_url": "https://api.github.com/users/wojcikstefan/repos", "events_url": "https://api.github.com/users/wojcikstefan/events{/privacy}", "received_events_url": "https://api.github.com/users/wojcikstefan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2017-01-13T18:41:37Z", "updated_at": "2017-02-09T20:02:51Z", "closed_at": "2017-02-09T20:02:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'll start by saying this is as much a discussion as a bug report. Perhaps there are good reasons for the way things currently work.\r\n\r\nAs part of `BaseQuerySet.clone()`, the underlying cursor is copied if it already exists. However only some queryset methods (`__call__`, `search_text`, `read_preference`) clear the cached `_cursor_obj` and only some other queryset methods (`__getitem__`, `order_by`) modify the cached `_cursor_obj`.\r\n\r\nFor other behaviour, most specifically `skip` and `limit`, the queryset and cursor live entirely independent lives from the moment a cursor is first created. This gives all kinds of unexpected behaviour, especially in any code that passes around queryset objects and does pagination.\r\n\r\nSome examples (assume `MyDoc` has an underlying collection of 15 documents):\r\n```python\r\nq = MyDoc.objects\r\nx = list(q)\r\ny = list(q.skip(10).limit(10))\r\n# x == y, because the cursor was used from the \"all objects\" query\r\n\r\nq = MyDoc.objects\r\nx = q.count()\r\ny = list(q.skip(10).limit(10))\r\n# len(y) == x, not 5, because the cursor was used from the count() query,\r\n# not the new skip and limit\r\n\r\nq = MyDoc.objects.skip(0).limit(10)\r\nx = list(q)\r\ny = list(q.skip(10))\r\n# y == x, not the next page, because yet again the cursor was used from the\r\n# first query, ignoring the new skip and limit\r\n```\r\n\r\nFrom the way this behaviour has been avoided in an ad-hoc way in some methods, my suspicion is that this isn't intended behaviour at all. Would you welcome tests and a patch to fix this behaviour, or is there some unknown justification for it?", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1469/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1469/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1376", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1376/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1376/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1376/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1376", "id": 176817959, "node_id": "MDU6SXNzdWUxNzY4MTc5NTk=", "number": 1376, "title": "db_field with dot-notation works on inserts but not on reads", "user": {"login": "wpromatt", "id": 10120896, "node_id": "MDQ6VXNlcjEwMTIwODk2", "avatar_url": "https://avatars.githubusercontent.com/u/10120896?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wpromatt", "html_url": "https://github.com/wpromatt", "followers_url": "https://api.github.com/users/wpromatt/followers", "following_url": "https://api.github.com/users/wpromatt/following{/other_user}", "gists_url": "https://api.github.com/users/wpromatt/gists{/gist_id}", "starred_url": "https://api.github.com/users/wpromatt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wpromatt/subscriptions", "organizations_url": "https://api.github.com/users/wpromatt/orgs", "repos_url": "https://api.github.com/users/wpromatt/repos", "events_url": "https://api.github.com/users/wpromatt/events{/privacy}", "received_events_url": "https://api.github.com/users/wpromatt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "wojcikstefan", "id": 1718372, "node_id": "MDQ6VXNlcjE3MTgzNzI=", "avatar_url": "https://avatars.githubusercontent.com/u/1718372?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wojcikstefan", "html_url": "https://github.com/wojcikstefan", "followers_url": "https://api.github.com/users/wojcikstefan/followers", "following_url": "https://api.github.com/users/wojcikstefan/following{/other_user}", "gists_url": "https://api.github.com/users/wojcikstefan/gists{/gist_id}", "starred_url": "https://api.github.com/users/wojcikstefan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wojcikstefan/subscriptions", "organizations_url": "https://api.github.com/users/wojcikstefan/orgs", "repos_url": "https://api.github.com/users/wojcikstefan/repos", "events_url": "https://api.github.com/users/wojcikstefan/events{/privacy}", "received_events_url": "https://api.github.com/users/wojcikstefan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "wojcikstefan", "id": 1718372, "node_id": "MDQ6VXNlcjE3MTgzNzI=", "avatar_url": "https://avatars.githubusercontent.com/u/1718372?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wojcikstefan", "html_url": "https://github.com/wojcikstefan", "followers_url": "https://api.github.com/users/wojcikstefan/followers", "following_url": "https://api.github.com/users/wojcikstefan/following{/other_user}", "gists_url": "https://api.github.com/users/wojcikstefan/gists{/gist_id}", "starred_url": "https://api.github.com/users/wojcikstefan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wojcikstefan/subscriptions", "organizations_url": "https://api.github.com/users/wojcikstefan/orgs", "repos_url": "https://api.github.com/users/wojcikstefan/repos", "events_url": "https://api.github.com/users/wojcikstefan/events{/privacy}", "received_events_url": "https://api.github.com/users/wojcikstefan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2016-09-14T05:26:03Z", "updated_at": "2016-12-29T17:39:05Z", "closed_at": "2016-12-29T17:39:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\nclass Metric(Document):\n    key = StringField(primary_key=True)\n    date = DateTimeField()\n    clicks = IntField(default=0, required=True, db_field='fields.clicks')\n\nm = Metric()\n\nm.key = 'foobar'\nm.date = datetime.utcnow()\nm.clicks = 45\nm.save()\n\nm = Metric.objects.first()\n# >> mongoengine.errors.FieldDoesNotExist: The field 'fields' does not exist on the document 'Metric'\n```\n\nIt is saved in the database\n\n```\n> db.metric.find().pretty()\n{\n        \"_id\" : \"foobar\",\n        \"date\" : ISODate(\"2016-09-14T05:18:38.137Z\"),\n        \"fields\" : {\n                \"clicks\" : 45\n        }\n}\n```\n\nI have a feeling the issue is that you can use dot notation when you assign values after creating the document instance. Somehow assigning the values after bypasses the validation. For example, this doesn't work:\n\n```\nm = Metric(key='foobar',\n           date=datetime.utcnow(),\n           clicks=45)\nm.save()\n# mongoengine.errors.OperationError: Could not save document (The dotted field 'fields.clicks' in 'fields.clicks' is not valid for storage.)\n```\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1376/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1376/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1371", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1371/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1371/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1371/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1371", "id": 175363684, "node_id": "MDU6SXNzdWUxNzUzNjM2ODQ=", "number": 1371, "title": "reload() function always clears _changed_fields list", "user": {"login": "ppecio", "id": 9433262, "node_id": "MDQ6VXNlcjk0MzMyNjI=", "avatar_url": "https://avatars.githubusercontent.com/u/9433262?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ppecio", "html_url": "https://github.com/ppecio", "followers_url": "https://api.github.com/users/ppecio/followers", "following_url": "https://api.github.com/users/ppecio/following{/other_user}", "gists_url": "https://api.github.com/users/ppecio/gists{/gist_id}", "starred_url": "https://api.github.com/users/ppecio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ppecio/subscriptions", "organizations_url": "https://api.github.com/users/ppecio/orgs", "repos_url": "https://api.github.com/users/ppecio/repos", "events_url": "https://api.github.com/users/ppecio/events{/privacy}", "received_events_url": "https://api.github.com/users/ppecio/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-09-06T22:07:03Z", "updated_at": "2018-05-21T08:17:11Z", "closed_at": "2018-05-21T08:17:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "Document.realod() always set _changed_fields to empty list, even if reload function is invoked with fields arguments. This cause, that not reload fields which were changed before reload() call are not marked as changed after that and for example not saved in later save() call.\n\nExample:\n\n``` python\nclass Bob(Document):\n   name = StringField()\n   department_code = IntField()\n\nbob = Bob(name=\"Bob\", department_code=1)\nbob.save()\nbob.name = \"John\"\n# ... here something changed department_code in DB and I need to realod only this field\nbob.reload('department_code')\nbob.save()\n```\n\nSecond save does not change name from \"Bob\" to \"John\" in mongo db, because after reload() call 'name' was removed from _changed_fields and has not been put into update query.\n\nProposed fix:\nIn Document.reload() function change line:\n\n``` python\nself._changed_fields = obj._changed_fields\n```\n\nto:\n\n``` python\nself._changed_fields = set(self._changed_fields) - set(fields) \\\n                                          if fields else obj._changed_fields\n```\n\n(or something similar)\n\nIf reload() function is invoked with fields list only these fields should be removed from _changed_fields list not all changed fields.\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1371/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1371/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1339", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1339/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1339/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1339/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1339", "id": 166176063, "node_id": "MDU6SXNzdWUxNjYxNzYwNjM=", "number": 1339, "title": "Register delete rule docs", "user": {"login": "latteier", "id": 312702, "node_id": "MDQ6VXNlcjMxMjcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/312702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/latteier", "html_url": "https://github.com/latteier", "followers_url": "https://api.github.com/users/latteier/followers", "following_url": "https://api.github.com/users/latteier/following{/other_user}", "gists_url": "https://api.github.com/users/latteier/gists{/gist_id}", "starred_url": "https://api.github.com/users/latteier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/latteier/subscriptions", "organizations_url": "https://api.github.com/users/latteier/orgs", "repos_url": "https://api.github.com/users/latteier/repos", "events_url": "https://api.github.com/users/latteier/events{/privacy}", "received_events_url": "https://api.github.com/users/latteier/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}, {"id": 204222428, "node_id": "MDU6TGFiZWwyMDQyMjI0Mjg=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Documentation", "name": "Documentation", "color": "c5def5", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-07-18T19:42:23Z", "updated_at": "2016-07-18T20:56:28Z", "closed_at": "2016-07-18T20:56:28Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The documentation for `register_delete_rule` provides this example.\n\n```\nclass Bar(Document):\n    content = StringField()\n    foo = ReferenceField('Foo')\n\nBar.register_delete_rule(Foo, 'foo', NULLIFY)\n```\n\nI looks like a mistake to me. I think it should be:\n\n`Foo.register_delete_rule(Bar, 'foo', NULLIFY)`\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1339/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1339/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1318", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1318/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1318/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1318/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1318", "id": 161014395, "node_id": "MDU6SXNzdWUxNjEwMTQzOTU=", "number": 1318, "title": "Deleting an element from middle of ListField results in an incorrect list.", "user": {"login": "rminsk", "id": 1779137, "node_id": "MDQ6VXNlcjE3NzkxMzc=", "avatar_url": "https://avatars.githubusercontent.com/u/1779137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rminsk", "html_url": "https://github.com/rminsk", "followers_url": "https://api.github.com/users/rminsk/followers", "following_url": "https://api.github.com/users/rminsk/following{/other_user}", "gists_url": "https://api.github.com/users/rminsk/gists{/gist_id}", "starred_url": "https://api.github.com/users/rminsk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rminsk/subscriptions", "organizations_url": "https://api.github.com/users/rminsk/orgs", "repos_url": "https://api.github.com/users/rminsk/repos", "events_url": "https://api.github.com/users/rminsk/events{/privacy}", "received_events_url": "https://api.github.com/users/rminsk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2016-06-18T08:43:56Z", "updated_at": "2016-12-22T18:11:45Z", "closed_at": "2016-12-22T18:11:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "``` python\nimport mongoengine as me\n\nclass TestList(me.Document):\n    test_list = me.ListField(me.IntField())\n\ndef test():\n    me.connect('test_list', host='mongomock://localhost')\n\n    vals = [1, 2, 3, 4]\n    test_list = TestList(test_list=vals)\n    test_list.save()\n\n    for tl in TestList.objects():\n        print tl.to_json()\n\n    del test_list.test_list[1]\n    test_list.save()\n\n    for tl in TestList.objects():\n        print tl.to_json()\n\nif __name__ == '__main__':\n    test()\n```\n\nRunning this gives the following result:\n\n```\n$ python test_list.py\n{\"_id\": {\"$oid\": \"576506f653c26b60b8f9d93c\"}, \"test_list\": [1, 2, 3, 4]}\n{\"_id\": {\"$oid\": \"576506f653c26b60b8f9d93c\"}, \"test_list\": [1, 3, 3, 4]}\n```\n\nI would expect the modified list to be [1, 3, 4].  If I completely replace the list (test_list.test_list = [1, 3, 4]) instead of deleting an element it works fine.\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1318/reactions", "total_count": 4, "+1": 4, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1318/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1308", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1308/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1308/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1308/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1308", "id": 158488663, "node_id": "MDU6SXNzdWUxNTg0ODg2NjM=", "number": 1308, "title": "Can not query on embedded documents for greater than", "user": {"login": "aakashef", "id": 15725123, "node_id": "MDQ6VXNlcjE1NzI1MTIz", "avatar_url": "https://avatars.githubusercontent.com/u/15725123?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aakashef", "html_url": "https://github.com/aakashef", "followers_url": "https://api.github.com/users/aakashef/followers", "following_url": "https://api.github.com/users/aakashef/following{/other_user}", "gists_url": "https://api.github.com/users/aakashef/gists{/gist_id}", "starred_url": "https://api.github.com/users/aakashef/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aakashef/subscriptions", "organizations_url": "https://api.github.com/users/aakashef/orgs", "repos_url": "https://api.github.com/users/aakashef/repos", "events_url": "https://api.github.com/users/aakashef/events{/privacy}", "received_events_url": "https://api.github.com/users/aakashef/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}, {"id": 774310, "node_id": "MDU6TGFiZWw3NzQzMTA=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Awaiting%20Response", "name": "Awaiting Response", "color": "c2e0c6", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-06-04T05:30:05Z", "updated_at": "2016-06-23T16:29:18Z", "closed_at": "2016-06-23T16:29:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have a database model:\n\n```\nclass Wallet(EmbeddedDocument):\n    is_active = BooleanField(default=True)\n    balance = IntField(default=0, min_value=0)\n\nclass User(Document):\n    email = EmailField(required=True, unique=True)\n    mobile = StringField(required=True, unique=True, min_length=10, max_length=10)\n    first_name = StringField(required=True)\n    last_name = StringField()\n    default_address_id = ObjectIdField()\n    wallet = EmbeddedDocumentField(Wallet, default=Wallet())\n```\n\nI want to query all the Users who have a wallet balance of more than 10,000. This is the query I wrote \n`User.objects.filter(wallet__balance__gt=0)`\nHowever it returns an empty list, whereas, the query \n`User.objects.filter(wallet__balance=11500)` returns multiple objects.\n`[<User: User object>, <User: User object>, <User: User object>, <User: User object>]`\n\nThis does not work for less than queries as well.\nIs there something which I am doing wrong?\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1308/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1308/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1306", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1306/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1306/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1306/events", "html_url": "https://github.com/MongoEngine/mongoengine/pull/1306", "id": 158027494, "node_id": "MDExOlB1bGxSZXF1ZXN0NzIyNjczMzc=", "number": 1306, "title": "add failing test for modify with exclude then save", "user": {"login": "ellmanj", "id": 3692462, "node_id": "MDQ6VXNlcjM2OTI0NjI=", "avatar_url": "https://avatars.githubusercontent.com/u/3692462?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ellmanj", "html_url": "https://github.com/ellmanj", "followers_url": "https://api.github.com/users/ellmanj/followers", "following_url": "https://api.github.com/users/ellmanj/following{/other_user}", "gists_url": "https://api.github.com/users/ellmanj/gists{/gist_id}", "starred_url": "https://api.github.com/users/ellmanj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ellmanj/subscriptions", "organizations_url": "https://api.github.com/users/ellmanj/orgs", "repos_url": "https://api.github.com/users/ellmanj/repos", "events_url": "https://api.github.com/users/ellmanj/events{/privacy}", "received_events_url": "https://api.github.com/users/ellmanj/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-06-01T23:12:41Z", "updated_at": "2017-10-04T17:44:59Z", "closed_at": "2017-10-04T17:44:59Z", "author_association": "NONE", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/pulls/1306", "html_url": "https://github.com/MongoEngine/mongoengine/pull/1306", "diff_url": "https://github.com/MongoEngine/mongoengine/pull/1306.diff", "patch_url": "https://github.com/MongoEngine/mongoengine/pull/1306.patch", "merged_at": null}, "body": "In this failing test, I exclude some field from a queryset, then update and return a document using `modify()`. If I save that document, the excluded field will be saved to the database as its default value (instead of not being modified).\n\nI haven't been able to find a fix.\n\n<!-- Reviewable:start -->\n\n---\n\nThis change is [<img src=\"https://reviewable.io/review_button.svg\" height=\"35\" align=\"absmiddle\" alt=\"Reviewable\"/>](https://reviewable.io/reviews/mongoengine/mongoengine/1306)\n\n<!-- Reviewable:end -->\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1306/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1306/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1294", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1294/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1294/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1294/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1294", "id": 154605786, "node_id": "MDU6SXNzdWUxNTQ2MDU3ODY=", "number": 1294, "title": "Travis tests for python 2.6 are failing ", "user": {"login": "RStatkevych", "id": 8261179, "node_id": "MDQ6VXNlcjgyNjExNzk=", "avatar_url": "https://avatars.githubusercontent.com/u/8261179?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RStatkevych", "html_url": "https://github.com/RStatkevych", "followers_url": "https://api.github.com/users/RStatkevych/followers", "following_url": "https://api.github.com/users/RStatkevych/following{/other_user}", "gists_url": "https://api.github.com/users/RStatkevych/gists{/gist_id}", "starred_url": "https://api.github.com/users/RStatkevych/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RStatkevych/subscriptions", "organizations_url": "https://api.github.com/users/RStatkevych/orgs", "repos_url": "https://api.github.com/users/RStatkevych/repos", "events_url": "https://api.github.com/users/RStatkevych/events{/privacy}", "received_events_url": "https://api.github.com/users/RStatkevych/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2016-05-12T23:47:13Z", "updated_at": "2016-10-19T21:25:33Z", "closed_at": "2016-10-19T21:25:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "Travis show tests failing on python2.6 when I was trying to submit my pull request [#1282] . First I thought that this is my fault, but I see that that few recent builds have the same fails as mine (for example https://travis-ci.org/MongoEngine/mongoengine/jobs/128043817 and mine is https://travis-ci.org/MongoEngine/mongoengine/jobs/129869183). What the problem can it be? Is this travis problem or mongoengine? \n\nP.S: I noticed that it's not reported or asked yet, so let it be here\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1294/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1294/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1286", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1286/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1286/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1286/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1286", "id": 152497834, "node_id": "MDU6SXNzdWUxNTI0OTc4MzQ=", "number": 1286, "title": "Filtering with AND with same key and a regex value causes: TypeError: '_sre.SRE_Pattern' object is not iterable\"", "user": {"login": "jkauppila", "id": 19145506, "node_id": "MDQ6VXNlcjE5MTQ1NTA2", "avatar_url": "https://avatars.githubusercontent.com/u/19145506?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jkauppila", "html_url": "https://github.com/jkauppila", "followers_url": "https://api.github.com/users/jkauppila/followers", "following_url": "https://api.github.com/users/jkauppila/following{/other_user}", "gists_url": "https://api.github.com/users/jkauppila/gists{/gist_id}", "starred_url": "https://api.github.com/users/jkauppila/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jkauppila/subscriptions", "organizations_url": "https://api.github.com/users/jkauppila/orgs", "repos_url": "https://api.github.com/users/jkauppila/repos", "events_url": "https://api.github.com/users/jkauppila/events{/privacy}", "received_events_url": "https://api.github.com/users/jkauppila/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-05-02T07:53:24Z", "updated_at": "2018-09-04T13:17:50Z", "closed_at": "2018-09-04T13:17:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi all,\nThe problem should be replicatable with any model like this: \nModel.objects.filter(Q((value__startswith=\"test\")&Q(value__not__startswith=\"test2\"))\n\nHere's the total traceback\n\n```\nFile \"<console>\", line 1, in <module>\n                  File \"/Users/jussi/src/project/env/lib/python2.7/site-packages/mongoengine/queryset/queryset.py\", line 58, in __repr__\n                    self._populate_cache()\n                  File \"/Users/jussi/src/project/env/lib/python2.7/site-packages/mongoengine/queryset/queryset.py\", line 92, in _populate_cache\n                    self._result_cache.append(self.next())\n                  File \"/Users/jussi/src/project/env/lib/python2.7/site-packages/mongoengine/queryset/base.py\", line 1416, in next\n                    raw_doc = self._cursor.next()\n                  File \"/Users/jussi/src/project/env/lib/python2.7/site-packages/mongoengine/queryset/base.py\", line 1490, in _cursor\n                    self._cursor_obj = self._collection.find(self._query,\n                  File \"/Users/jussi/src/project/env/lib/python2.7/site-packages/mongoengine/queryset/base.py\", line 1524, in _query\n                    self._mongo_query = self._query_obj.to_query(self._document)\n                  File \"/Users/jussi/src/project/env/lib/python2.7/site-packages/mongoengine/queryset/visitor.py\", line 90, in to_query\n                    query = query.accept(QueryCompilerVisitor(document))\n                  File \"/Users/jussi/src/project/env/lib/python2.7/site-packages/mongoengine/queryset/visitor.py\", line 155, in accept\n                    return visitor.visit_query(self)\n                  File \"/Users/jussi/src/project/env/lib/python2.7/site-packages/mongoengine/queryset/visitor.py\", line 78, in visit_query\n                    return transform.query(self.document, **query.query)\n                  File \"/Users/jussi/src/project/env/lib/python2.7/site-packages/mongoengine/queryset/transform.py\", line 136, in query\n                    mongo_query[key].update(value)\n                TypeError: '_sre.SRE_Pattern' object is not iterable\n```\n\nHere is the my proposed fix:\n\n```\ndiff --git a/mongoengine/queryset/transform.py b/mongoengine/queryset/transform.py\nindex 13302af..c5d4c1f 100644\n--- a/mongoengine/queryset/transform.py\n+++ b/mongoengine/queryset/transform.py\n@@ -1,6 +1,7 @@\n from collections import defaultdict\n\n import pymongo\n+import re\n from bson import SON\n\n from mongoengine.base.fields import UPDATE_OPERATORS\n@@ -129,7 +130,8 @@ def query(_doc_cls=None, **kwargs):\n         if op is None or key not in mongo_query:\n             mongo_query[key] = value\n         elif key in mongo_query:\n-            if key in mongo_query and isinstance(mongo_query[key], dict):\n+            if key in mongo_query and isinstance(mongo_query[key], dict) and \\\n+                    (not isinstance(value, re._pattern_type)):\n                 mongo_query[key].update(value)\n                 # $max/minDistance needs to come last - convert to SON\n                 value_dict = mongo_query[key]\n```\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1286/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1286/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1285", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1285/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1285/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1285/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1285", "id": 151828625, "node_id": "MDU6SXNzdWUxNTE4Mjg2MjU=", "number": 1285, "title": "Broken links to documentation from Google search results", "user": {"login": "shvechikov", "id": 12324, "node_id": "MDQ6VXNlcjEyMzI0", "avatar_url": "https://avatars.githubusercontent.com/u/12324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shvechikov", "html_url": "https://github.com/shvechikov", "followers_url": "https://api.github.com/users/shvechikov/followers", "following_url": "https://api.github.com/users/shvechikov/following{/other_user}", "gists_url": "https://api.github.com/users/shvechikov/gists{/gist_id}", "starred_url": "https://api.github.com/users/shvechikov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shvechikov/subscriptions", "organizations_url": "https://api.github.com/users/shvechikov/orgs", "repos_url": "https://api.github.com/users/shvechikov/repos", "events_url": "https://api.github.com/users/shvechikov/events{/privacy}", "received_events_url": "https://api.github.com/users/shvechikov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}, {"id": 204222428, "node_id": "MDU6TGFiZWwyMDQyMjI0Mjg=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Documentation", "name": "Documentation", "color": "c5def5", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2016-04-29T09:41:06Z", "updated_at": "2018-11-09T14:18:45Z", "closed_at": "2018-11-09T14:18:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "I get links like:\nhttp://docs.mongoengine.org/en/latest/apireference.html\ninstead of:\nhttp://docs.mongoengine.org/apireference.html\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1285/reactions", "total_count": 5, "+1": 5, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1285/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1278", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1278/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1278/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1278/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1278", "id": 146991790, "node_id": "MDU6SXNzdWUxNDY5OTE3OTA=", "number": 1278, "title": "Attribute Error when building nested index for DictField in DynamicDocument", "user": {"login": "vahana", "id": 1245065, "node_id": "MDQ6VXNlcjEyNDUwNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1245065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vahana", "html_url": "https://github.com/vahana", "followers_url": "https://api.github.com/users/vahana/followers", "following_url": "https://api.github.com/users/vahana/following{/other_user}", "gists_url": "https://api.github.com/users/vahana/gists{/gist_id}", "starred_url": "https://api.github.com/users/vahana/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vahana/subscriptions", "organizations_url": "https://api.github.com/users/vahana/orgs", "repos_url": "https://api.github.com/users/vahana/repos", "events_url": "https://api.github.com/users/vahana/events{/privacy}", "received_events_url": "https://api.github.com/users/vahana/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2016-04-08T17:39:29Z", "updated_at": "2016-06-24T15:48:43Z", "closed_at": "2016-06-24T15:48:43Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "pymongo==3.2.2\nmongoengine==0.10.6\n\n```\nclass ABC(DynamicDocument):\n\n  meta = {\n    'indexes':[\n        'nested.a',\n        'nested.b'\n    ]\n  }\n  nested = mongo.DictField()\n```\n\nThis fails with:\n\n`AttributeError: 'DictField' object has no attribute 'document_type'`\n\nHowever if base class is just Document, it seems to be working.\n\nAlso this used to work for \nmongoengine==0.8.7\npymongo==2.8\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1278/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1278/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1275", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1275/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1275/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1275/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1275", "id": 145701699, "node_id": "MDU6SXNzdWUxNDU3MDE2OTk=", "number": 1275, "title": "Issues with MapField and _fields_to_dbfields", "user": {"login": "AlJohri", "id": 2790092, "node_id": "MDQ6VXNlcjI3OTAwOTI=", "avatar_url": "https://avatars.githubusercontent.com/u/2790092?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AlJohri", "html_url": "https://github.com/AlJohri", "followers_url": "https://api.github.com/users/AlJohri/followers", "following_url": "https://api.github.com/users/AlJohri/following{/other_user}", "gists_url": "https://api.github.com/users/AlJohri/gists{/gist_id}", "starred_url": "https://api.github.com/users/AlJohri/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AlJohri/subscriptions", "organizations_url": "https://api.github.com/users/AlJohri/orgs", "repos_url": "https://api.github.com/users/AlJohri/repos", "events_url": "https://api.github.com/users/AlJohri/events{/privacy}", "received_events_url": "https://api.github.com/users/AlJohri/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2016-04-04T14:32:20Z", "updated_at": "2017-06-19T00:26:47Z", "closed_at": "2017-06-19T00:26:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have a model defined with a MapField.\n\n``` python\nclass Race(Document):\n    raceUID = StringField(primary_key=True)\n    electionDate = StringField()\n    statePostal = StringField()\n\n    historical_reporting_units = MapField(ListField(EmbeddedDocumentField(ReportingUnit)))\n    current_reporting_units = MapField(field=EmbeddedDocumentField(ReportingUnit))\n```\n\nWhen trying to project the result to only include a certain key within the MapField like so: `Race.objects(raceUID=\"2016-03-01-MA-24548\").only(\"current_reporting_units.state-MA\").first()`\n\nI get the following stack trace. I believe it should skip trying to resolve the dbfield attribute for MapFields.\n\n```\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n<ipython-input-10-9098a246470f> in <module>()\n      1 from electionbot2016.models import Race, ReportingUnit\n----> 2 race = Race.objects(raceUID=\"2016-03-01-MA-24548\").only(\"current_reporting_units.state-MA\").first()\n      3 for unit in race.current_reporting_units:\n      4     print(unit)\n\n/Users/johria/anaconda/lib/python3.5/site-packages/mongoengine/queryset/base.py in only(self, *fields)\n    810         fields = dict([(f, QueryFieldList.ONLY) for f in fields])\n    811         self.only_fields = list(fields.keys())\n--> 812         return self.fields(True, **fields)\n    813 \n    814     def exclude(self, *fields):\n\n/Users/johria/anaconda/lib/python3.5/site-packages/mongoengine/queryset/base.py in fields(self, _only_called, **kwargs)\n    864         for value, group in itertools.groupby(fields, lambda x: x[1]):\n    865             fields = [field for field, value in group]\n--> 866             fields = queryset._fields_to_dbfields(fields)\n    867             queryset._loaded_fields += QueryFieldList(\n    868                 fields, value=value, _only_called=_only_called)\n\n/Users/johria/anaconda/lib/python3.5/site-packages/mongoengine/queryset/base.py in _fields_to_dbfields(self, fields)\n   1659             try:\n   1660                 field = \".\".join(f.db_field for f in\n-> 1661                                  document._lookup_field(field.split('.')))\n   1662                 ret.append(field)\n   1663             except LookUpError as err:\n\n/Users/johria/anaconda/lib/python3.5/site-packages/mongoengine/queryset/base.py in <genexpr>(.0)\n   1658         for field in fields:\n   1659             try:\n-> 1660                 field = \".\".join(f.db_field for f in\n   1661                                  document._lookup_field(field.split('.')))\n   1662                 ret.append(field)\n\nAttributeError: 'str' object has no attribute 'db_field'\n```\n\nAm I using the `only` function wrong? Can I manually input a raw projection for the timebeing?\n\nEDIT: added `current_reporting_units` to Race model\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1275/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1275/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1259", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1259/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1259/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1259/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1259", "id": 142677508, "node_id": "MDU6SXNzdWUxNDI2Nzc1MDg=", "number": 1259, "title": "non strict mode behaves like strict for Document.reload", "user": {"login": "alon", "id": 55290, "node_id": "MDQ6VXNlcjU1Mjkw", "avatar_url": "https://avatars.githubusercontent.com/u/55290?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alon", "html_url": "https://github.com/alon", "followers_url": "https://api.github.com/users/alon/followers", "following_url": "https://api.github.com/users/alon/following{/other_user}", "gists_url": "https://api.github.com/users/alon/gists{/gist_id}", "starred_url": "https://api.github.com/users/alon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alon/subscriptions", "organizations_url": "https://api.github.com/users/alon/orgs", "repos_url": "https://api.github.com/users/alon/repos", "events_url": "https://api.github.com/users/alon/events{/privacy}", "received_events_url": "https://api.github.com/users/alon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/11", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/11", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/11/labels", "id": 375346, "node_id": "MDk6TWlsZXN0b25lMzc1MzQ2", "number": 11, "title": "Scheduled, not planned", "description": "", "creator": {"login": "rozza", "id": 420, "node_id": "MDQ6VXNlcjQyMA==", "avatar_url": "https://avatars.githubusercontent.com/u/420?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rozza", "html_url": "https://github.com/rozza", "followers_url": "https://api.github.com/users/rozza/followers", "following_url": "https://api.github.com/users/rozza/following{/other_user}", "gists_url": "https://api.github.com/users/rozza/gists{/gist_id}", "starred_url": "https://api.github.com/users/rozza/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rozza/subscriptions", "organizations_url": "https://api.github.com/users/rozza/orgs", "repos_url": "https://api.github.com/users/rozza/repos", "events_url": "https://api.github.com/users/rozza/events{/privacy}", "received_events_url": "https://api.github.com/users/rozza/received_events", "type": "User", "site_admin": false}, "open_issues": 10, "closed_issues": 23, "state": "open", "created_at": "2013-07-10T20:31:48Z", "updated_at": "2019-12-29T21:04:57Z", "due_on": null, "closed_at": null}, "comments": 1, "created_at": "2016-03-22T15:01:47Z", "updated_at": "2017-06-22T09:19:59Z", "closed_at": "2017-06-22T09:19:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "When a document contains a field not in the schema an AttributeError is thrown for a non strict document.\n\nReproducer: (git describe: v0.9.0-290-ga6e996d)\n\n``` python\nimport mongoengine\n\nclass Doc(mongoengine.Document):\n    field = mongoengine.StringField()\n    meta = dict(\n        strict=False,\n    )\n\nmongoengine.connect()\nd=Doc()\nd.field='20'\nd.save()\nDoc._get_collection().update({'_id': d.id}, {\"$set\": {\"new_field\": \"This should work\"}}, upsert=False)\nd.reload() # Throws asseretion\n```\n\nOutput of reproduction:\n\n``` python\nTraceback (most recent call last):\n  File \"mongoengine_issue.py\", line 14, in <module>\n    d.reload() # Throws asseretion\n  File \"/home2/alon/consumer/env_main/lib/python2.7/site-packages/mongoengine/document.py\", line 602, in reload\n    delattr(self, field)\n  File \"/home2/alon/consumer/env_main/lib/python2.7/site-packages/mongoengine/base/document.py\", line 146, in __delattr__\n    super(BaseDocument, self).__delattr__(*args, **kwargs)\nAttributeError: new_field\n```\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1259/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1259/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1243", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1243/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1243/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1243/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1243", "id": 137252847, "node_id": "MDU6SXNzdWUxMzcyNTI4NDc=", "number": 1243, "title": "as_pymongo() not work as expected with only()", "user": {"login": "Roman1us", "id": 4437421, "node_id": "MDQ6VXNlcjQ0Mzc0MjE=", "avatar_url": "https://avatars.githubusercontent.com/u/4437421?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Roman1us", "html_url": "https://github.com/Roman1us", "followers_url": "https://api.github.com/users/Roman1us/followers", "following_url": "https://api.github.com/users/Roman1us/following{/other_user}", "gists_url": "https://api.github.com/users/Roman1us/gists{/gist_id}", "starred_url": "https://api.github.com/users/Roman1us/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Roman1us/subscriptions", "organizations_url": "https://api.github.com/users/Roman1us/orgs", "repos_url": "https://api.github.com/users/Roman1us/repos", "events_url": "https://api.github.com/users/Roman1us/events{/privacy}", "received_events_url": "https://api.github.com/users/Roman1us/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-02-29T13:20:41Z", "updated_at": "2019-02-17T22:01:30Z", "closed_at": "2019-02-17T22:01:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello!\n\nDocument:\n\n``` python\nclass TestDocument(Document):\n    ...\n    dict_field = fields.DictField()\n    ...\n```\n\nSave this data to dict_field:\n\n``` python\ndict_data = {\n    \"level1_1\": {\n        \"level2_1:\" 90,\n        \"level2_2\": True,\n    },\n    \"level1_1\": {\n        \"level2_1\": 70,\n        \"level2_2\": False,\n    },\n}\n```\n\nTrying to get it:\n\n``` python\nTestDocument.objects.filter(...).only(..., \"dict_field\", ...).as_pymongo()\n```\n\n`= {..., dict_field: {}, ...}`\n\nWe get **empty** dict\n\nI debugged `as_pymongo()` and find bug in `_get_as_pymongo`. When function is called, it generates field list in `all_fields` variable. For this example `all_fields = [..., \"dict_field\", ...]`. Then try to fetch all fields recursively, and check every dict key in `all_fields`. At first it check `dict_field` in `all_fields` and its ok, but then it check `level1_1`... So `check` function returns empty dict.\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1243/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1243/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1239", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1239/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1239/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1239/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1239", "id": 134840799, "node_id": "MDU6SXNzdWUxMzQ4NDA3OTk=", "number": 1239, "title": "Update method works incorrectly", "user": {"login": "nosuchip", "id": 418073, "node_id": "MDQ6VXNlcjQxODA3Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/418073?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nosuchip", "html_url": "https://github.com/nosuchip", "followers_url": "https://api.github.com/users/nosuchip/followers", "following_url": "https://api.github.com/users/nosuchip/following{/other_user}", "gists_url": "https://api.github.com/users/nosuchip/gists{/gist_id}", "starred_url": "https://api.github.com/users/nosuchip/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nosuchip/subscriptions", "organizations_url": "https://api.github.com/users/nosuchip/orgs", "repos_url": "https://api.github.com/users/nosuchip/repos", "events_url": "https://api.github.com/users/nosuchip/events{/privacy}", "received_events_url": "https://api.github.com/users/nosuchip/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2016-02-19T11:20:38Z", "updated_at": "2016-12-12T04:53:52Z", "closed_at": "2016-12-12T04:53:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "I found that method `update` work weird. At least not how I expected it. Once model populated with new field `update` method with kwargs prefixed with `set_` skips new field and saved it with `default` value. In the same time existing field updated correctly. I tried to do the same (i.e. update model with new field and it was saved correctrly).\n\nMoreover, after `model.update(...)` fiels still have old valued and refreshed only after model reloaded from database (you colud see it in line 7 or output below).\n\nI suspect the Ada Lovelace will be a bit anxious when find she changed last name but still not married.\n\nrequirements.txt:\n\n```\nflask-mongoengine==0.7.5\nmongoengine==0.10.6\npymongo==3.2.1\n```\n\nsample.py\n\n``` python\n# -*- coding: utf-8 -*-\n\nfrom flask import Flask\nfrom flask.ext.mongoengine import MongoEngine\n\napp = Flask(__name__)\n\napp.config['DEBUG'] = True\napp.config['SECRET_KEY'] = 'fb50545dc2cca37b13921231ee55ed047e887c5ada8513af'\n\napp.config['MONGODB_SETTINGS'] = {\n    'db': 'test',\n    'host': '127.0.0.1',\n    'port': 27017\n}\n\ndb = MongoEngine(app)\n\ndef test_before_model_update():\n    class User(db.Document):\n        email = db.StringField(required=True)\n        first_name = db.StringField(max_length=50)\n        last_name = db.StringField(max_length=50)\n\n        def __unicode__(self):\n            return '{} {} ({})'.format(self.first_name, self.last_name, self.email)\n\n    user = User(email='adabyron@example.com',\n                first_name='Ada',\n                last_name='Byron')\n    user.save()\n    print \"Created user:\", user\n    return user.pk\n\n\ndef test_after_model_update(model_id):\n    class User(db.Document):\n        email = db.StringField(required=True)\n        first_name = db.StringField(max_length=50)\n        last_name = db.StringField(max_length=50)\n        married = db.StringField(choices=['Y', 'N'], default='N')\n\n        def __unicode__(self):\n            return '{} {} ({}, married: {})'.format(\n                self.first_name, self.last_name, self.email, self.married\n            )\n\n    print \"Trying to get user with id\", model_id\n    user = User.objects(pk=model_id).first()\n    print \"Got old-fashioned user:\", user\n\n    update_params = {'married': 'Y', 'last_name': 'Lovelace'}\n    print \"Updating user with following params:\", update_params\n\n    user.update(**{'set__%s' % key: update_params[key] for key in update_params})\n    print \"User updated:\", user\n    print \"User's _chaged_fiels is:\", user._changed_fields\n\n\n    print \"Saving user\", user\n    user.save()\n\n    print \"User after save, not taken from DB:\", user\n\n    user = User.objects(pk=model_id).first()\n    print \"User after save refreshed from DB:\", user\n\n\nuid = test_before_model_update()\ntest_after_model_update(uid)\n```\n\noutput.txt\n\n```\nCreated user: Ada Byron (adabyron@example.com)\nTrying to get user with id 56cb6fa58b66df16a4c04317\nGot old-fashioned user: Ada Byron (adabyron@example.com, married: N)\nUpdating user with following params: {'last_name': 'Lovelace', 'married': 'Y'}\nUser updated: Ada Byron (adabyron@example.com, married: N)\nUser's _chaged_fiels is: ['married']\nSaving user Ada Byron (adabyron@example.com, married: N)\nUser after save, not taken from DB: Ada Byron (adabyron@example.com, married: N)\n```\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1239/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1239/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1227", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1227/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1227/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1227/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1227", "id": 131535273, "node_id": "MDU6SXNzdWUxMzE1MzUyNzM=", "number": 1227, "title": "DeprecationWarning raised with PyMongo 3.2", "user": {"login": "SevenDeadlySins", "id": 1319968, "node_id": "MDQ6VXNlcjEzMTk5Njg=", "avatar_url": "https://avatars.githubusercontent.com/u/1319968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SevenDeadlySins", "html_url": "https://github.com/SevenDeadlySins", "followers_url": "https://api.github.com/users/SevenDeadlySins/followers", "following_url": "https://api.github.com/users/SevenDeadlySins/following{/other_user}", "gists_url": "https://api.github.com/users/SevenDeadlySins/gists{/gist_id}", "starred_url": "https://api.github.com/users/SevenDeadlySins/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SevenDeadlySins/subscriptions", "organizations_url": "https://api.github.com/users/SevenDeadlySins/orgs", "repos_url": "https://api.github.com/users/SevenDeadlySins/repos", "events_url": "https://api.github.com/users/SevenDeadlySins/events{/privacy}", "received_events_url": "https://api.github.com/users/SevenDeadlySins/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/11", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/11", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/11/labels", "id": 375346, "node_id": "MDk6TWlsZXN0b25lMzc1MzQ2", "number": 11, "title": "Scheduled, not planned", "description": "", "creator": {"login": "rozza", "id": 420, "node_id": "MDQ6VXNlcjQyMA==", "avatar_url": "https://avatars.githubusercontent.com/u/420?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rozza", "html_url": "https://github.com/rozza", "followers_url": "https://api.github.com/users/rozza/followers", "following_url": "https://api.github.com/users/rozza/following{/other_user}", "gists_url": "https://api.github.com/users/rozza/gists{/gist_id}", "starred_url": "https://api.github.com/users/rozza/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rozza/subscriptions", "organizations_url": "https://api.github.com/users/rozza/orgs", "repos_url": "https://api.github.com/users/rozza/repos", "events_url": "https://api.github.com/users/rozza/events{/privacy}", "received_events_url": "https://api.github.com/users/rozza/received_events", "type": "User", "site_admin": false}, "open_issues": 10, "closed_issues": 23, "state": "open", "created_at": "2013-07-10T20:31:48Z", "updated_at": "2019-12-29T21:04:57Z", "due_on": null, "closed_at": null}, "comments": 7, "created_at": "2016-02-05T02:15:29Z", "updated_at": "2021-05-23T09:59:49Z", "closed_at": "2017-02-27T03:38:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm getting the following deprecation warnings:\n\n`py.warnings: WARNING: /Users/ahsan/vir-env/dj19/lib/python2.7/site-packages/mongoengine/document.py:324: DeprecationWarning: save is deprecated. Use insert_one or replace_one instead\n  object_id = collection.save(doc, **write_concern)\npy.warnings: WARNING: /Users/ahsan/vir-env/dj19/lib/python2.7/site-packages/mongoengine/document.py:367: DeprecationWarning: update is deprecated. Use replace_one, update_one or update_many instead.\n  upsert=upsert, **write_concern)`\n\nIt looks like there's usage of some deprecated-in-PyMongo-3.2 functions still in the code, and now they're being loud about it. Are there any plans to switch to the new functions any time soon?\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1227/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1227/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1224", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1224/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1224/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1224/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1224", "id": 129956165, "node_id": "MDU6SXNzdWUxMjk5NTYxNjU=", "number": 1224, "title": "delete Document fail on 0.10.1", "user": {"login": "oxbambooxo", "id": 4627506, "node_id": "MDQ6VXNlcjQ2Mjc1MDY=", "avatar_url": "https://avatars.githubusercontent.com/u/4627506?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oxbambooxo", "html_url": "https://github.com/oxbambooxo", "followers_url": "https://api.github.com/users/oxbambooxo/followers", "following_url": "https://api.github.com/users/oxbambooxo/following{/other_user}", "gists_url": "https://api.github.com/users/oxbambooxo/gists{/gist_id}", "starred_url": "https://api.github.com/users/oxbambooxo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oxbambooxo/subscriptions", "organizations_url": "https://api.github.com/users/oxbambooxo/orgs", "repos_url": "https://api.github.com/users/oxbambooxo/repos", "events_url": "https://api.github.com/users/oxbambooxo/events{/privacy}", "received_events_url": "https://api.github.com/users/oxbambooxo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2016-01-30T08:15:43Z", "updated_at": "2016-12-12T04:26:44Z", "closed_at": "2016-12-12T04:26:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "``` python\n# -*- coding: utf-8 -*-\nfrom mongoengine import connect, Document, StringField, ReferenceField, CASCADE\n\nconnect(db='test')\n\nclass User(Document):\n    name = StringField(primary_key=True)\n\nclass Book(Document):\n    author = ReferenceField(User, reverse_delete_rule=CASCADE)\n\nuser = User(name='mike')\nuser.save()\nuser.delete()\n```\n\nit will throw exception:\n\n``` python\nmongoengine.errors.ValidationError: u'mike' is not a valid ObjectId, it must be a 12-byte input or a 24-character hex string\n```\n\nabove code is work well in mongoengine==0.10.0\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1224/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1224/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1215", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1215/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1215/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1215/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1215", "id": 127676767, "node_id": "MDU6SXNzdWUxMjc2NzY3Njc=", "number": 1215, "title": "Random fail in travis with ", "user": {"login": "touilleMan", "id": 3187637, "node_id": "MDQ6VXNlcjMxODc2Mzc=", "avatar_url": "https://avatars.githubusercontent.com/u/3187637?v=4", "gravatar_id": "", "url": "https://api.github.com/users/touilleMan", "html_url": "https://github.com/touilleMan", "followers_url": "https://api.github.com/users/touilleMan/followers", "following_url": "https://api.github.com/users/touilleMan/following{/other_user}", "gists_url": "https://api.github.com/users/touilleMan/gists{/gist_id}", "starred_url": "https://api.github.com/users/touilleMan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/touilleMan/subscriptions", "organizations_url": "https://api.github.com/users/touilleMan/orgs", "repos_url": "https://api.github.com/users/touilleMan/repos", "events_url": "https://api.github.com/users/touilleMan/events{/privacy}", "received_events_url": "https://api.github.com/users/touilleMan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-01-20T12:57:33Z", "updated_at": "2016-12-12T04:55:51Z", "closed_at": "2016-12-12T04:55:51Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Travis unittest are currently failling with the following error:\n\n```\n1) ERROR: test_compound_key_dictfield (tests.IndexesTest)\n   Traceback (most recent call last):\n    tests/document/indexes.py line 851 in test_compound_key_dictfield\n      self.assertEqual(report, Report.objects.get(pk=my_key))\n    mongoengine/queryset/base.py line 242 in get\n      raise queryset._document.DoesNotExist(msg)\n   DoesNotExist: Report matching query does not exist.\n```\n\nsee for example https://travis-ci.org/MongoEngine/mongoengine/jobs/103586407\n\nThis issue looks really similar than #1108 with the same random triggering\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1215/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1215/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1136", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1136/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1136/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1136/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1136", "id": 113563901, "node_id": "MDU6SXNzdWUxMTM1NjM5MDE=", "number": 1136, "title": "regression in 0.10.0 compared to 0.9.0 for queryset limit after count", "user": {"login": "alon", "id": 55290, "node_id": "MDQ6VXNlcjU1Mjkw", "avatar_url": "https://avatars.githubusercontent.com/u/55290?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alon", "html_url": "https://github.com/alon", "followers_url": "https://api.github.com/users/alon/followers", "following_url": "https://api.github.com/users/alon/following{/other_user}", "gists_url": "https://api.github.com/users/alon/gists{/gist_id}", "starred_url": "https://api.github.com/users/alon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alon/subscriptions", "organizations_url": "https://api.github.com/users/alon/orgs", "repos_url": "https://api.github.com/users/alon/repos", "events_url": "https://api.github.com/users/alon/events{/privacy}", "received_events_url": "https://api.github.com/users/alon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "wojcikstefan", "id": 1718372, "node_id": "MDQ6VXNlcjE3MTgzNzI=", "avatar_url": "https://avatars.githubusercontent.com/u/1718372?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wojcikstefan", "html_url": "https://github.com/wojcikstefan", "followers_url": "https://api.github.com/users/wojcikstefan/followers", "following_url": "https://api.github.com/users/wojcikstefan/following{/other_user}", "gists_url": "https://api.github.com/users/wojcikstefan/gists{/gist_id}", "starred_url": "https://api.github.com/users/wojcikstefan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wojcikstefan/subscriptions", "organizations_url": "https://api.github.com/users/wojcikstefan/orgs", "repos_url": "https://api.github.com/users/wojcikstefan/repos", "events_url": "https://api.github.com/users/wojcikstefan/events{/privacy}", "received_events_url": "https://api.github.com/users/wojcikstefan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "wojcikstefan", "id": 1718372, "node_id": "MDQ6VXNlcjE3MTgzNzI=", "avatar_url": "https://avatars.githubusercontent.com/u/1718372?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wojcikstefan", "html_url": "https://github.com/wojcikstefan", "followers_url": "https://api.github.com/users/wojcikstefan/followers", "following_url": "https://api.github.com/users/wojcikstefan/following{/other_user}", "gists_url": "https://api.github.com/users/wojcikstefan/gists{/gist_id}", "starred_url": "https://api.github.com/users/wojcikstefan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wojcikstefan/subscriptions", "organizations_url": "https://api.github.com/users/wojcikstefan/orgs", "repos_url": "https://api.github.com/users/wojcikstefan/repos", "events_url": "https://api.github.com/users/wojcikstefan/events{/privacy}", "received_events_url": "https://api.github.com/users/wojcikstefan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2015-10-27T11:39:14Z", "updated_at": "2016-12-27T23:43:35Z", "closed_at": "2016-12-27T23:42:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "The following test passes in 0.9.0 but fails in 0.10.0:\n\n``` python\nclient = connect(\"alon-test\")\n\nclass Obj(Document):\n    pass\n\n[x.delete() for x in Obj.objects()] # remove existing items - just a nicety\n\n[Obj().save() for x in xrange(10)]\n\nassert(2 == len(Obj.objects().limit(2))) # no regression\nqs = Obj.objects()\ncount = qs.count()\nassert(2 == len(qs.limit(2).all())) # no regression\nprint(len(qs.limit(2)))\nassert(2 == len(qs.limit(2))) # regression - right hand side returns 10\n\n```\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1136/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1136/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1135", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1135/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1135/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1135/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1135", "id": 113548024, "node_id": "MDU6SXNzdWUxMTM1NDgwMjQ=", "number": 1135, "title": "regression from 0.9.0: assert on reverse_delete_rule=CASCADE with source.id.field != dest.id.field", "user": {"login": "alon", "id": 55290, "node_id": "MDQ6VXNlcjU1Mjkw", "avatar_url": "https://avatars.githubusercontent.com/u/55290?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alon", "html_url": "https://github.com/alon", "followers_url": "https://api.github.com/users/alon/followers", "following_url": "https://api.github.com/users/alon/following{/other_user}", "gists_url": "https://api.github.com/users/alon/gists{/gist_id}", "starred_url": "https://api.github.com/users/alon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alon/subscriptions", "organizations_url": "https://api.github.com/users/alon/orgs", "repos_url": "https://api.github.com/users/alon/repos", "events_url": "https://api.github.com/users/alon/events{/privacy}", "received_events_url": "https://api.github.com/users/alon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2015-10-27T10:05:36Z", "updated_at": "2016-12-12T05:10:23Z", "closed_at": "2016-12-12T05:09:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "The regression seems to be in queryset/base.py BaseQuerySet.delete, in creating the queryset in 0.9.0 there is only one clause, but in 0.10.0 there is an additional 'id__nin' clause that implicitly assumes the id of both objects is of the same field, and breaks when they are not, as in this example.\n\nAdditionally it doesn't make sense to check for id of a different collection not in this collection.\n\nThe following example breaks in 0.10.0 but works in 0.9.0:\n\nfrom mongoengine import connect, Document, StringField, ReferenceField, CASCADE\n\n``` python\nclient = connect(\"alon-test\")\n#db = client.get_database('alon-test')\n#idtest = db.create_collection('idtest') # only in 0.10.0?\n\nclass Client(Document):\n    id = StringField(primary_key=True)\n    foo = StringField()\n\n\nclass Token(Document):\n    client = ReferenceField('Client', dbref=False, reverse_delete_rule=CASCADE)\n    somethingelse = StringField()\n\n\nclient = Client(id=\"1234\", foo=\"bar\")\nclient.save()\n\ntoken = Token(client=client, somethingelse='something else entirely')\ntoken.save()\n\nclient.delete()\n```\n\nThe error in 0.10.0 results from the 'id__nin' clause on the rule's queryset that is checking the id of Token, which is ObjectId, but should be checking the id of Client, which is a StringField:\n\n``` python\n$ python mongo_test.py \nTraceback (most recent call last):\n  File \"mongo_test.py\", line 24, in <module>\n    client.delete()\n  File \"/home2/alon/consumer/env_main/lib/python2.7/site-packages/mongoengine/document.py\", line 491, in delete\n    **self._object_key).delete(write_concern=write_concern, _from_doc_delete=True)\n  File \"/home2/alon/consumer/env_main/lib/python2.7/site-packages/mongoengine/queryset/base.py\", line 409, in delete\n    ref_q_count = ref_q.count()\n  File \"/home2/alon/consumer/env_main/lib/python2.7/site-packages/mongoengine/queryset/queryset.py\", line 104, in count\n    return super(QuerySet, self).count(with_limit_and_skip)\n  File \"/home2/alon/consumer/env_main/lib/python2.7/site-packages/mongoengine/queryset/base.py\", line 347, in count\n    return self._cursor.count(with_limit_and_skip=with_limit_and_skip)\n  File \"/home2/alon/consumer/env_main/lib/python2.7/site-packages/mongoengine/queryset/base.py\", line 1445, in _cursor\n    self._cursor_obj = self._collection.find(self._query,\n  File \"/home2/alon/consumer/env_main/lib/python2.7/site-packages/mongoengine/queryset/base.py\", line 1479, in _query\n    self._mongo_query = self._query_obj.to_query(self._document)\n  File \"/home2/alon/consumer/env_main/lib/python2.7/site-packages/mongoengine/queryset/visitor.py\", line 90, in to_query\n    query = query.accept(QueryCompilerVisitor(document))\n  File \"/home2/alon/consumer/env_main/lib/python2.7/site-packages/mongoengine/queryset/visitor.py\", line 155, in accept\n    return visitor.visit_query(self)\n  File \"/home2/alon/consumer/env_main/lib/python2.7/site-packages/mongoengine/queryset/visitor.py\", line 78, in visit_query\n    return transform.query(self.document, **query.query)\n  File \"/home2/alon/consumer/env_main/lib/python2.7/site-packages/mongoengine/queryset/transform.py\", line 102, in query\n    value = [field.prepare_query_value(op, v) for v in value]\n  File \"/home2/alon/consumer/env_main/lib/python2.7/site-packages/mongoengine/base/fields.py\", line 446, in prepare_query_value\n    return self.to_mongo(value)\n  File \"/home2/alon/consumer/env_main/lib/python2.7/site-packages/mongoengine/base/fields.py\", line 442, in to_mongo\n    self.error(unicode(e))\n  File \"/home2/alon/consumer/env_main/lib/python2.7/site-packages/mongoengine/base/fields.py\", line 144, in error\n    raise ValidationError(message, errors=errors, field_name=field_name)\nmongoengine.errors.ValidationError: u'1234' is not a valid ObjectId, it must be a 12-byte input or a 24-character hex string\n```\n\nThe query in 0.9.0:\n\nref_q = document_cls.objects(**{field_name + '__in': self})\n\nin 0.10.0:\n\nref_q = document_cls.objects(**{field_name + '__in': self, 'id__nin': cascade_refs})\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1135/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1135/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1127", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1127/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1127/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1127/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1127", "id": 110854675, "node_id": "MDU6SXNzdWUxMTA4NTQ2NzU=", "number": 1127, "title": "InvalidStringData when using modify on a BinaryField", "user": {"login": "apmorton", "id": 63636, "node_id": "MDQ6VXNlcjYzNjM2", "avatar_url": "https://avatars.githubusercontent.com/u/63636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apmorton", "html_url": "https://github.com/apmorton", "followers_url": "https://api.github.com/users/apmorton/followers", "following_url": "https://api.github.com/users/apmorton/following{/other_user}", "gists_url": "https://api.github.com/users/apmorton/gists{/gist_id}", "starred_url": "https://api.github.com/users/apmorton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apmorton/subscriptions", "organizations_url": "https://api.github.com/users/apmorton/orgs", "repos_url": "https://api.github.com/users/apmorton/repos", "events_url": "https://api.github.com/users/apmorton/events{/privacy}", "received_events_url": "https://api.github.com/users/apmorton/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-10-11T12:56:18Z", "updated_at": "2019-02-18T01:27:02Z", "closed_at": "2019-02-18T01:27:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "``` python\nclass MyDocument(db.Document):\n    some_field = db.StringField()\n    bin_field = db.BinaryField()\n\n\nbin_value = '\\xa9\\xf3\\x8d(\\xd7\\x03\\x84\\xb4k[\\x0f\\xe3\\xa2\\x19\\x85p[J\\xa3\\xd2>\\xde\\xe6\\x87\\xb1\\x7f\\xc6\\xe6\\xd9r\\x18\\xf5'\ndoc = MyDocument.objects(some_field='test').modify(\n    upsert=True, new=True,\n    set__bin_field=bin_value\n)\n```\n\nThis code will result in an error as follows:\n\n``` python\nInvalidStringData: strings in documents must be valid UTF-8\n```\n\nby applying this monkey patch, the above code will function correctly\n\n``` python\ndef binary_field_prepare_query_value(self, op, value):\n    return super(db.BinaryField, self).prepare_query_value(op, self.to_mongo(value))\ndb.BinaryField.prepare_query_value = binary_field_prepare_query_value\n```\n\nI believe BinaryField should define prepare_query_value as such:\n\n``` python\nclass BinaryField(BaseField):\n    def prepare_query_value(self, op, value):\n       return super(BinaryField, self).prepare_query_value(op, self.to_mongo(value))\n```\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1127/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1127/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1119", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1119/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1119/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1119/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1119", "id": 109100477, "node_id": "MDU6SXNzdWUxMDkxMDA0Nzc=", "number": 1119, "title": "ListField minus index assignment does not work", "user": {"login": "iici-gli", "id": 6988262, "node_id": "MDQ6VXNlcjY5ODgyNjI=", "avatar_url": "https://avatars.githubusercontent.com/u/6988262?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iici-gli", "html_url": "https://github.com/iici-gli", "followers_url": "https://api.github.com/users/iici-gli/followers", "following_url": "https://api.github.com/users/iici-gli/following{/other_user}", "gists_url": "https://api.github.com/users/iici-gli/gists{/gist_id}", "starred_url": "https://api.github.com/users/iici-gli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iici-gli/subscriptions", "organizations_url": "https://api.github.com/users/iici-gli/orgs", "repos_url": "https://api.github.com/users/iici-gli/repos", "events_url": "https://api.github.com/users/iici-gli/events{/privacy}", "received_events_url": "https://api.github.com/users/iici-gli/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-09-30T14:14:47Z", "updated_at": "2017-03-05T23:13:54Z", "closed_at": "2017-03-05T23:12:08Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "```\r\nclass Foo(Document):\r\n  a_str = StringField()\r\n  a_list_str = ListField(StringField())\r\n\r\nfoo = Foo(a_str='a', a_list_str=['1','2','3'])\r\nfoo.save()\r\nfoo.a_list_str[-1] = '4'\r\nfoo.save()\r\n\r\nfoo = Foo.objects(a_str='a').as_pymongo().first()\r\nprint foo['a_list_str'][-1] \r\n```\r\n=> ['1', '2', '4'] \r\nThe last element becomes list itself\r\n\r\nThe bug is in file mongoengine/base/document at line 644:\r\n```\r\n     if isinstance(d, list) and p.isdigit():\r\n```\r\nIt should be:\r\n```\r\n    if isinstance(d, list) and p.lstrip('-').isdigit(): \r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1119/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1119/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1108", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1108/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1108/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1108/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1108", "id": 104532510, "node_id": "MDU6SXNzdWUxMDQ1MzI1MTA=", "number": 1108, "title": "Shared connect test randomly fails with pymongo 3.0/dev", "user": {"login": "touilleMan", "id": 3187637, "node_id": "MDQ6VXNlcjMxODc2Mzc=", "avatar_url": "https://avatars.githubusercontent.com/u/3187637?v=4", "gravatar_id": "", "url": "https://api.github.com/users/touilleMan", "html_url": "https://github.com/touilleMan", "followers_url": "https://api.github.com/users/touilleMan/followers", "following_url": "https://api.github.com/users/touilleMan/following{/other_user}", "gists_url": "https://api.github.com/users/touilleMan/gists{/gist_id}", "starred_url": "https://api.github.com/users/touilleMan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/touilleMan/subscriptions", "organizations_url": "https://api.github.com/users/touilleMan/orgs", "repos_url": "https://api.github.com/users/touilleMan/repos", "events_url": "https://api.github.com/users/touilleMan/events{/privacy}", "received_events_url": "https://api.github.com/users/touilleMan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-09-02T17:27:43Z", "updated_at": "2016-01-20T12:58:39Z", "closed_at": "2016-01-20T12:58:36Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Travis unittest are currently failling with the following error:\n\n```\n1) FAIL: Ensure that connections are shared when the connection settings are exactly the same\n   Traceback (most recent call last):\n    tests/test_connection.py line 77 in test_sharing_connections\n      self.assertEqual(expected_connection, actual_connection)\n   AssertionError: Mongo[47 chars]=dict, tz_aware=False, connect=True, read_preference=Primary()) != Mongo[47 chars]=dict, tz_aware=False, connect=True, read_preference=Primary())\n       'Mongo[47 chars]=dict, tz_aware=False, connect=True, read_preference=Primary()) != Mongo[47 chars]=dict, tz_aware=False, connect=True, read_preference=Primary())' = '%s != %s' % _common_shorten_repr(MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=True, read_preference=Primary()), MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=True, read_preference=Primary()))\n       'Mongo[47 chars]=dict, tz_aware=False, connect=True, read_preference=Primary()) != Mongo[47 chars]=dict, tz_aware=False, connect=True, read_preference=Primary())' = self._formatMessage('Mongo[47 chars]=dict, tz_aware=False, connect=True, read_preference=Primary()) != Mongo[47 chars]=dict, tz_aware=False, connect=True, read_preference=Primary())', 'Mongo[47 chars]=dict, tz_aware=False, connect=True, read_preference=Primary()) != Mongo[47 chars]=dict, tz_aware=False, connect=True, read_preference=Primary())')\n   >>  raise self.failureException('Mongo[47 chars]=dict, tz_aware=False, connect=True, read_preference=Primary()) != Mongo[47 chars]=dict, tz_aware=False, connect=True, read_preference=Primary())')\n\n-----------------------------------------------------------------------------\n738 tests run in 18.9 seconds. \n1 FAILED, 4 skipped (733 tests passed)\nERROR: InvocationError: '/home/travis/build/MongoEngine/mongoengine/.tox/py34-mgdev/bin/python setup.py nosetests --with-coverage'\n___________________________________ summary ____________________________________\nERROR:   py34-mgdev: commands failed\n```\n\nLooking back in travis history, it seems this random bug is not new, just few examples:\n- https://travis-ci.org/MongoEngine/mongoengine/jobs/68064225\n- https://travis-ci.org/MongoEngine/mongoengine/jobs/66434008\n- https://travis-ci.org/MongoEngine/mongoengine/jobs/66434015\n\nFrom my experience, it seems this bug appears only with python 3.x & pymongo 3.0/DEV. Futhermore, when I retry a failed testcase, it is more likely to fail again if there is other processes still running.\n\nI guess the same mongodb database is used on the travis machine running multiple instances of the test at the same time, making the pymongo driver doing special tricks under load...\n\nAny ideas ?\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1108/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1108/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1075", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1075/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1075/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1075/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1075", "id": 95820545, "node_id": "MDU6SXNzdWU5NTgyMDU0NQ==", "number": 1075, "title": "AttributeError: 'CachedReferenceField' object has no attribute '_get_db'", "user": {"login": "yarneo", "id": 4066863, "node_id": "MDQ6VXNlcjQwNjY4NjM=", "avatar_url": "https://avatars.githubusercontent.com/u/4066863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarneo", "html_url": "https://github.com/yarneo", "followers_url": "https://api.github.com/users/yarneo/followers", "following_url": "https://api.github.com/users/yarneo/following{/other_user}", "gists_url": "https://api.github.com/users/yarneo/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarneo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarneo/subscriptions", "organizations_url": "https://api.github.com/users/yarneo/orgs", "repos_url": "https://api.github.com/users/yarneo/repos", "events_url": "https://api.github.com/users/yarneo/events{/privacy}", "received_events_url": "https://api.github.com/users/yarneo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2015-07-18T12:32:39Z", "updated_at": "2018-11-01T21:14:47Z", "closed_at": "2018-11-01T21:14:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "After appending an object to a list of CachedReferenceFields, I get this error when trying to fetch the object:\n\nAttributeError: 'CachedReferenceField' object has no attribute '_get_db'\n\nFile \"build/bdist.macosx-10.10-x86_64/egg/mongoengine/dereference.py\", line 145, in _fetch_objects\n    references = doc_type._get_db()[collection].find({'_id': {'$in': refs}})\nAttributeError: 'CachedReferenceField' object has no attribute '_get_db'\n\nAny clue?\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1075/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1075/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1069", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1069/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1069/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1069/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1069", "id": 94919513, "node_id": "MDU6SXNzdWU5NDkxOTUxMw==", "number": 1069, "title": "Replace connection .disconnect() with .close() when IS_PYMONGO3", "user": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}, {"id": 208337895, "node_id": "MDU6TGFiZWwyMDgzMzc4OTU=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Client/Connect", "name": "Client/Connect", "color": "f9d0c4", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/18", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/18", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/18/labels", "id": 1178260, "node_id": "MDk6TWlsZXN0b25lMTE3ODI2MA==", "number": 18, "title": "0.10.1", "description": "", "creator": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "open_issues": 6, "closed_issues": 25, "state": "open", "created_at": "2015-06-23T21:06:37Z", "updated_at": "2020-03-22T13:59:53Z", "due_on": "2015-09-04T07:00:00Z", "closed_at": null}, "comments": 1, "created_at": "2015-07-14T10:55:28Z", "updated_at": "2015-09-04T19:47:25Z", "closed_at": "2015-09-04T19:47:24Z", "author_association": "MEMBER", "active_lock_reason": null, "body": ".disconnect() method/alias was removed but we forgot to made so... (and obviously have no test on it!)\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1069/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1069/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1066", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1066/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1066/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1066/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1066", "id": 93795625, "node_id": "MDU6SXNzdWU5Mzc5NTYyNQ==", "number": 1066, "title": "Filtering on embedded attribute raises an exception (regression 0.9/0.10)", "user": {"login": "bagerard", "id": 11854690, "node_id": "MDQ6VXNlcjExODU0Njkw", "avatar_url": "https://avatars.githubusercontent.com/u/11854690?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bagerard", "html_url": "https://github.com/bagerard", "followers_url": "https://api.github.com/users/bagerard/followers", "following_url": "https://api.github.com/users/bagerard/following{/other_user}", "gists_url": "https://api.github.com/users/bagerard/gists{/gist_id}", "starred_url": "https://api.github.com/users/bagerard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bagerard/subscriptions", "organizations_url": "https://api.github.com/users/bagerard/orgs", "repos_url": "https://api.github.com/users/bagerard/repos", "events_url": "https://api.github.com/users/bagerard/events{/privacy}", "received_events_url": "https://api.github.com/users/bagerard/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/18", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/18", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/18/labels", "id": 1178260, "node_id": "MDk6TWlsZXN0b25lMTE3ODI2MA==", "number": 18, "title": "0.10.1", "description": "", "creator": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "open_issues": 6, "closed_issues": 25, "state": "open", "created_at": "2015-06-23T21:06:37Z", "updated_at": "2020-03-22T13:59:53Z", "due_on": "2015-09-04T07:00:00Z", "closed_at": null}, "comments": 4, "created_at": "2015-07-08T13:54:45Z", "updated_at": "2016-12-28T06:21:47Z", "closed_at": "2016-12-28T06:21:47Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "Hi There,\nI observed a regression after switching to 0.10.0 when querying objects on embedded attribute. It raises an AttributeError as soon as you iterate or .count\n\nBelow is a test case:\n\n```\nclass MyEmbeddedClass(EmbeddedDocument):\n    name = StringField()\n\nclass MyClass(Document):\n    emb_attr = EmbeddedDocumentField(MyEmbeddedClass, default=None)\n\nMyClass(emb_attr=MyEmbeddedClass(name='bob')).save()\n\nMyClass.objects(emb_attr=None).count()\n```\n\nAnd the end of the stack trace:\n(...)\n  File \".../mongoengine/queryset/transform.py\", line 95, in query\n    value = field.prepare_query_value(op, value)\n  File \".../mongoengine/fields.py\", line 570, in prepare_query_value\n    value = self.document_type._from_son(value)\n  File \".../mongoengine/base/document.py\", line 687, in _from_son\n    class_name = son.get('_cls', cls._class_name)\nAttributeError: 'NoneType' object has no attribute 'get'\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1066/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1066/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1058", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1058/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1058/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1058/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1058", "id": 92621817, "node_id": "MDU6SXNzdWU5MjYyMTgxNw==", "number": 1058, "title": "DictField with '_cls' field is converted to Document on access", "user": {"login": "touilleMan", "id": 3187637, "node_id": "MDQ6VXNlcjMxODc2Mzc=", "avatar_url": "https://avatars.githubusercontent.com/u/3187637?v=4", "gravatar_id": "", "url": "https://api.github.com/users/touilleMan", "html_url": "https://github.com/touilleMan", "followers_url": "https://api.github.com/users/touilleMan/followers", "following_url": "https://api.github.com/users/touilleMan/following{/other_user}", "gists_url": "https://api.github.com/users/touilleMan/gists{/gist_id}", "starred_url": "https://api.github.com/users/touilleMan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/touilleMan/subscriptions", "organizations_url": "https://api.github.com/users/touilleMan/orgs", "repos_url": "https://api.github.com/users/touilleMan/repos", "events_url": "https://api.github.com/users/touilleMan/events{/privacy}", "received_events_url": "https://api.github.com/users/touilleMan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2015-07-02T12:14:11Z", "updated_at": "2015-09-22T13:03:51Z", "closed_at": "2015-09-22T13:03:50Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Hi again,\n\nI've spotted a pretty interesting bug involving the `DictField`, see this example:\n\n``` python3\n>>> class Doc(Document):\n...     f = fields.DictField()\n>>> a = Doc(f={'key': 'value'}).save()  # Create document with a dict field\n>>> a.f  # The field is a valid dict\n{'key': 'value'}\n>>> b = Doc(f=a.to_mongo().to_dict()).save() # The field contains the previous document as dump\n>>> b.f  # The field is a valid dict\n{'_id': ObjectId('5595277d13adf277f76efa40'), 'f': {'key': 'value'}}\n>>> b.f['_cls'] = 'Doc' # If the _cls field is provided as well, weird things happened...\n>>> b.f  # The dict is considered as a document and dereferenced\n<Doc: Doc object>\n>>> b.f  # The 2nd time the field is called, it returns a list of fields !!!\n['id', 'f']\n>>> b.f  # Next calls are all the same\n['id', 'f']\n```\n\nIt seems the trouble is the DeReference (https://github.com/MongoEngine/mongoengine/blob/master/mongoengine/dereference.py#L13) class is always called (no matter if the field is actually a (Generic)ReferenceField or not), so the dict is dereferenced given it really looks like something to dereference...\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1058/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1058/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1057", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1057/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1057/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1057/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1057", "id": 92586572, "node_id": "MDU6SXNzdWU5MjU4NjU3Mg==", "number": 1057, "title": "Mongo 2.4.14 - KeyError: 'nModified'", "user": {"login": "Toinews", "id": 158583, "node_id": "MDQ6VXNlcjE1ODU4Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/158583?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Toinews", "html_url": "https://github.com/Toinews", "followers_url": "https://api.github.com/users/Toinews/followers", "following_url": "https://api.github.com/users/Toinews/following{/other_user}", "gists_url": "https://api.github.com/users/Toinews/gists{/gist_id}", "starred_url": "https://api.github.com/users/Toinews/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Toinews/subscriptions", "organizations_url": "https://api.github.com/users/Toinews/orgs", "repos_url": "https://api.github.com/users/Toinews/repos", "events_url": "https://api.github.com/users/Toinews/events{/privacy}", "received_events_url": "https://api.github.com/users/Toinews/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2015-07-02T08:56:35Z", "updated_at": "2016-12-28T05:51:21Z", "closed_at": "2016-12-28T05:51:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\n\nWhen I try to make a save_condition, it seems that the key `nModified` is not available (field seems to be called `n`) in mongo 2.4.14 (have not check with other 2.4).\n\n```\n                if updates:\n                    update_query[\"$set\"] = updates\n                if removals:\n                    update_query[\"$unset\"] = removals\n                if updates or removals:\n                    upsert = save_condition is None\n                    last_error = collection.update(select_dict, update_query,\n                                                   upsert=upsert, **write_concern)\n>                   if not upsert and last_error['nModified'] == 0:\nE                   KeyError: 'nModified'\n\n```\n\nIs there any plan to fix this for mongo 2.4 or should I migrate to 2.6 ? \nThanks,\nRegards,\n## \n\nToinews\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1057/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1057/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1048", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1048/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1048/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1048/events", "html_url": "https://github.com/MongoEngine/mongoengine/pull/1048", "id": 91607334, "node_id": "MDExOlB1bGxSZXF1ZXN0Mzg3MjY2ODY=", "number": 1048, "title": "Suggested fix for #1047: CachedReferenceField DBRefs bug", "user": {"login": "amitlicht", "id": 10258630, "node_id": "MDQ6VXNlcjEwMjU4NjMw", "avatar_url": "https://avatars.githubusercontent.com/u/10258630?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amitlicht", "html_url": "https://github.com/amitlicht", "followers_url": "https://api.github.com/users/amitlicht/followers", "following_url": "https://api.github.com/users/amitlicht/following{/other_user}", "gists_url": "https://api.github.com/users/amitlicht/gists{/gist_id}", "starred_url": "https://api.github.com/users/amitlicht/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amitlicht/subscriptions", "organizations_url": "https://api.github.com/users/amitlicht/orgs", "repos_url": "https://api.github.com/users/amitlicht/repos", "events_url": "https://api.github.com/users/amitlicht/events{/privacy}", "received_events_url": "https://api.github.com/users/amitlicht/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}, {"id": 208337816, "node_id": "MDU6TGFiZWwyMDgzMzc4MTY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/(De)Reference", "name": "(De)Reference", "color": "fef2c0", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/18", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/18", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/18/labels", "id": 1178260, "node_id": "MDk6TWlsZXN0b25lMTE3ODI2MA==", "number": 18, "title": "0.10.1", "description": "", "creator": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "open_issues": 6, "closed_issues": 25, "state": "open", "created_at": "2015-06-23T21:06:37Z", "updated_at": "2020-03-22T13:59:53Z", "due_on": "2015-09-04T07:00:00Z", "closed_at": null}, "comments": 6, "created_at": "2015-06-28T14:54:56Z", "updated_at": "2015-07-01T06:53:09Z", "closed_at": "2015-07-01T06:53:03Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/pulls/1048", "html_url": "https://github.com/MongoEngine/mongoengine/pull/1048", "diff_url": "https://github.com/MongoEngine/mongoengine/pull/1048.diff", "patch_url": "https://github.com/MongoEngine/mongoengine/pull/1048.patch", "merged_at": "2015-07-01T06:53:03Z"}, "body": "CachedReferenceField creates DBRef on to_python, but can't save them on to_mongo.\n\nDereferencing DBRef to document type before returning it from to_python.\n\n<!-- Reviewable:start -->\n\n[<img src=\"https://reviewable.io/review_button.png\" height=40 alt=\"Review on Reviewable\"/>](https://reviewable.io/reviews/mongoengine/mongoengine/1048)\n\n<!-- Reviewable:end -->\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1048/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1048/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1047", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1047/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1047/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1047/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1047", "id": 91605044, "node_id": "MDU6SXNzdWU5MTYwNTA0NA==", "number": 1047, "title": "CachedReferenceField creates DBRefs on to_python, but can't save them on to_mongo", "user": {"login": "amitlicht", "id": 10258630, "node_id": "MDQ6VXNlcjEwMjU4NjMw", "avatar_url": "https://avatars.githubusercontent.com/u/10258630?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amitlicht", "html_url": "https://github.com/amitlicht", "followers_url": "https://api.github.com/users/amitlicht/followers", "following_url": "https://api.github.com/users/amitlicht/following{/other_user}", "gists_url": "https://api.github.com/users/amitlicht/gists{/gist_id}", "starred_url": "https://api.github.com/users/amitlicht/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amitlicht/subscriptions", "organizations_url": "https://api.github.com/users/amitlicht/orgs", "repos_url": "https://api.github.com/users/amitlicht/repos", "events_url": "https://api.github.com/users/amitlicht/events{/privacy}", "received_events_url": "https://api.github.com/users/amitlicht/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}, {"id": 208337816, "node_id": "MDU6TGFiZWwyMDgzMzc4MTY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/(De)Reference", "name": "(De)Reference", "color": "fef2c0", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/18", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/18", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/18/labels", "id": 1178260, "node_id": "MDk6TWlsZXN0b25lMTE3ODI2MA==", "number": 18, "title": "0.10.1", "description": "", "creator": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "open_issues": 6, "closed_issues": 25, "state": "open", "created_at": "2015-06-23T21:06:37Z", "updated_at": "2020-03-22T13:59:53Z", "due_on": "2015-09-04T07:00:00Z", "closed_at": null}, "comments": 6, "created_at": "2015-06-28T14:27:46Z", "updated_at": "2020-03-22T13:59:53Z", "closed_at": "2020-03-22T13:59:53Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "``` python\nimport mongoengine\nfrom mongoengine import Document\nfrom mongoengine.fields import CachedReferenceField, BooleanField, IntField\n\nmongoengine.connect('test')\n\nclass TestCachedDoc(Document):\n    test = BooleanField(required=True)\n\nclass TestDoc(Document):\n    cached_doc = CachedReferenceField(TestCachedDoc)\n    other_field = IntField(required=True)\n\nTestDoc.objects.delete()\nTestDoc(cached_doc=TestCachedDoc(test=False).save(),\n        other_field=10).save()\nt = TestDoc.objects.get()\nt.other_field = 1\nt.save()   # --> raises mongoengine.errors.ValidationError: ValidationError (TestDoc:559003e21bacb5bcf87a3195) (A CachedReferenceField only accepts documents: ['cached_doc'])\n```\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1047/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1047/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1043", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1043/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1043/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1043/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1043", "id": 90915984, "node_id": "MDU6SXNzdWU5MDkxNTk4NA==", "number": 1043, "title": "Cycle issues in reverse_delete_rules", "user": {"login": "emilecaron", "id": 6242447, "node_id": "MDQ6VXNlcjYyNDI0NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/6242447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/emilecaron", "html_url": "https://github.com/emilecaron", "followers_url": "https://api.github.com/users/emilecaron/followers", "following_url": "https://api.github.com/users/emilecaron/following{/other_user}", "gists_url": "https://api.github.com/users/emilecaron/gists{/gist_id}", "starred_url": "https://api.github.com/users/emilecaron/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/emilecaron/subscriptions", "organizations_url": "https://api.github.com/users/emilecaron/orgs", "repos_url": "https://api.github.com/users/emilecaron/repos", "events_url": "https://api.github.com/users/emilecaron/events{/privacy}", "received_events_url": "https://api.github.com/users/emilecaron/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/18", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/18", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/18/labels", "id": 1178260, "node_id": "MDk6TWlsZXN0b25lMTE3ODI2MA==", "number": 18, "title": "0.10.1", "description": "", "creator": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "open_issues": 6, "closed_issues": 25, "state": "open", "created_at": "2015-06-23T21:06:37Z", "updated_at": "2020-03-22T13:59:53Z", "due_on": "2015-09-04T07:00:00Z", "closed_at": null}, "comments": 3, "created_at": "2015-06-25T09:57:44Z", "updated_at": "2015-06-26T16:00:45Z", "closed_at": "2015-06-26T16:00:45Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When object is self referencing with a cascade delete rule, it ends up in a recursive loop.\n\nFollowing commit fixes this behavior by avoiding self cascading, and also removes a bugged line\nhttps://github.com/MongoEngine/mongoengine/commit/e64eff0c17720c4b8ee9cf17c06bd4ff394370cd\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1043/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1043/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1037", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1037/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1037/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1037/events", "html_url": "https://github.com/MongoEngine/mongoengine/pull/1037", "id": 89846511, "node_id": "MDExOlB1bGxSZXF1ZXN0MzgxNzc0Nzc=", "number": 1037, "title": "Added test and fix for delete with write_concern w:0", "user": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/17", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/17", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/17/labels", "id": 1098863, "node_id": "MDk6TWlsZXN0b25lMTA5ODg2Mw==", "number": 17, "title": "0.10", "description": "", "creator": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 37, "state": "closed", "created_at": "2015-05-06T16:17:07Z", "updated_at": "2015-06-26T08:50:24Z", "due_on": "2015-06-20T07:00:00Z", "closed_at": "2015-06-24T08:21:08Z"}, "comments": 4, "created_at": "2015-06-21T01:42:05Z", "updated_at": "2015-06-22T12:50:06Z", "closed_at": "2015-06-22T12:50:04Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/pulls/1037", "html_url": "https://github.com/MongoEngine/mongoengine/pull/1037", "diff_url": "https://github.com/MongoEngine/mongoengine/pull/1037.diff", "patch_url": "https://github.com/MongoEngine/mongoengine/pull/1037.patch", "merged_at": "2015-06-22T12:50:04Z"}, "body": "Fix #1008\n\n<!-- Reviewable:start -->\n\n[<img src=\"https://reviewable.io/review_button.png\" height=40 alt=\"Review on Reviewable\"/>](https://reviewable.io/reviews/mongoengine/mongoengine/1037)\n\n<!-- Reviewable:end -->\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1037/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1037/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1017", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1017/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1017/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1017/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1017", "id": 84185282, "node_id": "MDU6SXNzdWU4NDE4NTI4Mg==", "number": 1017, "title": "Document reload cause clash between reference with same id but different collection", "user": {"login": "touilleMan", "id": 3187637, "node_id": "MDQ6VXNlcjMxODc2Mzc=", "avatar_url": "https://avatars.githubusercontent.com/u/3187637?v=4", "gravatar_id": "", "url": "https://api.github.com/users/touilleMan", "html_url": "https://github.com/touilleMan", "followers_url": "https://api.github.com/users/touilleMan/followers", "following_url": "https://api.github.com/users/touilleMan/following{/other_user}", "gists_url": "https://api.github.com/users/touilleMan/gists{/gist_id}", "starred_url": "https://api.github.com/users/touilleMan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/touilleMan/subscriptions", "organizations_url": "https://api.github.com/users/touilleMan/orgs", "repos_url": "https://api.github.com/users/touilleMan/repos", "events_url": "https://api.github.com/users/touilleMan/events{/privacy}", "received_events_url": "https://api.github.com/users/touilleMan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}, {"id": 208337816, "node_id": "MDU6TGFiZWwyMDgzMzc4MTY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/(De)Reference", "name": "(De)Reference", "color": "fef2c0", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2015-06-02T19:58:40Z", "updated_at": "2015-06-12T07:24:34Z", "closed_at": "2015-06-12T07:24:34Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Hi there,\n\nLet say I have a document with two `ReferenceField` on two different collections with incremental ids.\nGiven the ids are incremental and not uuid, an id can point on a valid document in both collections (pretty obvious for id `1` ^^)\n\nThat being said, the `reload` handle reference reloading in around here: https://github.com/MongoEngine/mongoengine/blob/d4a8ae5743fe335ac4cea957537be34de45a440f/mongoengine/dereference.py#L77\n\nThe idea is (if I'm not wrong) to collect the document's references in a dict something like that\n\n``` python\n>>> print(self.reference_map)\n{\n    MyDocumentA: [DBref('MyDocumentA', 'id-1'), DBref('MyDocumentA', 'id-2') ],\n    MyDocumentB: [DBref('MyDocumentB', 'id-1'),]\n}\n```\n\nThen use this dict to retrieve all those document from database\n\n``` python\n>>> print(self.object_map)\n{\n    'id-1': <MyDocumentB: MyDocumentB object>,\n    'id-2': <MyDocumentA: MyDocumentA object>\n}\n```\n\nAs you can see, given object_map only use id as key, the document `MyDocumentA` with key 'id-1' has been shadowed by the `MyDocumentB` with similar id !\n\nThus, the final `_attach_objects` aiming at refreshing the main document's references will replace a `MyDocumentA` reference with a `MyDocumentB`...\n\nI think to solve this trouble, we should replace the key in object_map from this single to a `DBref`, thus the check would be on both collection and id.\n\nWhat do you think ? Given I've spend some time tracking this nasty bug, I think I can provide a fix myself if you ask for ;-)\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1017/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1017/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1015", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1015/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1015/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1015/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1015", "id": 83939202, "node_id": "MDU6SXNzdWU4MzkzOTIwMg==", "number": 1015, "title": "compatibility with pymongo whoes version is larger than 3.0", "user": {"login": "normal-cock", "id": 2618306, "node_id": "MDQ6VXNlcjI2MTgzMDY=", "avatar_url": "https://avatars.githubusercontent.com/u/2618306?v=4", "gravatar_id": "", "url": "https://api.github.com/users/normal-cock", "html_url": "https://github.com/normal-cock", "followers_url": "https://api.github.com/users/normal-cock/followers", "following_url": "https://api.github.com/users/normal-cock/following{/other_user}", "gists_url": "https://api.github.com/users/normal-cock/gists{/gist_id}", "starred_url": "https://api.github.com/users/normal-cock/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/normal-cock/subscriptions", "organizations_url": "https://api.github.com/users/normal-cock/orgs", "repos_url": "https://api.github.com/users/normal-cock/repos", "events_url": "https://api.github.com/users/normal-cock/events{/privacy}", "received_events_url": "https://api.github.com/users/normal-cock/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}, {"id": 208337895, "node_id": "MDU6TGFiZWwyMDgzMzc4OTU=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Client/Connect", "name": "Client/Connect", "color": "f9d0c4", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/18", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/18", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/18/labels", "id": 1178260, "node_id": "MDk6TWlsZXN0b25lMTE3ODI2MA==", "number": 18, "title": "0.10.1", "description": "", "creator": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "open_issues": 6, "closed_issues": 25, "state": "open", "created_at": "2015-06-23T21:06:37Z", "updated_at": "2020-03-22T13:59:53Z", "due_on": "2015-09-04T07:00:00Z", "closed_at": null}, "comments": 6, "created_at": "2015-06-02T09:35:34Z", "updated_at": "2015-10-27T13:32:29Z", "closed_at": "2015-10-27T13:32:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "Mongoengine seems not compatible with pymongo whoes version is larger than 3.0.\nWhen I executed the follow code:\n\n```\nconnect( 'website', alias=DEFAULT_CONNECTION_NAME, host='mongodb://username:password@localhost:27017,localhost:27117,localhost:27217/website?replicaSet=test')\n```\n\nI got the following error:\n\n```\nConnectionError: Cannot connect to database default :\nUnknown option hosts_or_uri\n```\n\nThen I tried to find out what happened and found that after pymongo 3.0, `MongoReplicaSetClient` is just a alias of `MongoClient` and doesn't support hosts_or_uri parameter.\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1015/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1015/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1011", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1011/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1011/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1011/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1011", "id": 83025996, "node_id": "MDU6SXNzdWU4MzAyNTk5Ng==", "number": 1011, "title": "Default CappedCollection max_size should be rounded to a multiplication of 256", "user": {"login": "amitlicht", "id": 10258630, "node_id": "MDQ6VXNlcjEwMjU4NjMw", "avatar_url": "https://avatars.githubusercontent.com/u/10258630?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amitlicht", "html_url": "https://github.com/amitlicht", "followers_url": "https://api.github.com/users/amitlicht/followers", "following_url": "https://api.github.com/users/amitlicht/following{/other_user}", "gists_url": "https://api.github.com/users/amitlicht/gists{/gist_id}", "starred_url": "https://api.github.com/users/amitlicht/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amitlicht/subscriptions", "organizations_url": "https://api.github.com/users/amitlicht/orgs", "repos_url": "https://api.github.com/users/amitlicht/repos", "events_url": "https://api.github.com/users/amitlicht/events{/privacy}", "received_events_url": "https://api.github.com/users/amitlicht/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/17", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/17", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/17/labels", "id": 1098863, "node_id": "MDk6TWlsZXN0b25lMTA5ODg2Mw==", "number": 17, "title": "0.10", "description": "", "creator": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 37, "state": "closed", "created_at": "2015-05-06T16:17:07Z", "updated_at": "2015-06-26T08:50:24Z", "due_on": "2015-06-20T07:00:00Z", "closed_at": "2015-06-24T08:21:08Z"}, "comments": 1, "created_at": "2015-05-31T07:23:31Z", "updated_at": "2015-06-15T13:25:34Z", "closed_at": "2015-06-15T13:25:33Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "According to mongodb documentation: \"MongoDB will raise the provided size to make it an integer multiple of 256\". However, the default size used in mongoengine/document.py is 10000000 (which is obviously not a multiple of 256). This causes errors when calling _get_collection() on an already-created capped collection with the default max size:\n\nTraceback (most recent call last):\n  ....\n  File \"/usr/local/lib/python2.7/dist-packages/mongoengine/document.py\", line 300, in save\n    collection = self._get_collection()\n  File \"/usr/local/lib/python2.7/dist-packages/mongoengine/document.py\", line 186, in _get_collection\n    raise InvalidCollectionError(msg)\nInvalidCollectionError: Cannot create collection \"Collection(Database(MongoClient('localhost', 27017), u'my_db'), u'my_coll')\" as a capped collection as it already exists\n\nThe problem here is that the default size is 10000000, but mongodb rounded it 10002432, and so the comparison between the two fails. \n\nSuggested solution: set the default max_size to \"real\" 10MB, i.e. 10 \\* 2**20.\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1011/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1011/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1008", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1008/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1008/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1008/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/1008", "id": 80923399, "node_id": "MDU6SXNzdWU4MDkyMzM5OQ==", "number": 1008, "title": "Delete returns None but expected a dict", "user": {"login": "Garito", "id": 1005398, "node_id": "MDQ6VXNlcjEwMDUzOTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1005398?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Garito", "html_url": "https://github.com/Garito", "followers_url": "https://api.github.com/users/Garito/followers", "following_url": "https://api.github.com/users/Garito/following{/other_user}", "gists_url": "https://api.github.com/users/Garito/gists{/gist_id}", "starred_url": "https://api.github.com/users/Garito/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Garito/subscriptions", "organizations_url": "https://api.github.com/users/Garito/orgs", "repos_url": "https://api.github.com/users/Garito/repos", "events_url": "https://api.github.com/users/Garito/events{/privacy}", "received_events_url": "https://api.github.com/users/Garito/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/17", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/17", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/17/labels", "id": 1098863, "node_id": "MDk6TWlsZXN0b25lMTA5ODg2Mw==", "number": 17, "title": "0.10", "description": "", "creator": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 37, "state": "closed", "created_at": "2015-05-06T16:17:07Z", "updated_at": "2015-06-26T08:50:24Z", "due_on": "2015-06-20T07:00:00Z", "closed_at": "2015-06-24T08:21:08Z"}, "comments": 28, "created_at": "2015-05-26T11:37:22Z", "updated_at": "2015-06-22T14:25:46Z", "closed_at": "2015-06-22T12:50:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm trying to delete a document with self.delete() but it raises and error:\nFile \"/Users/garito/TimeFounder/App/0.3/env/lib/python2.7/site-packages/mongoengine/queryset/base.py\", line 467, in delete\n    return result[\"n\"]\nTypeError: 'NoneType' object has no attribute '**getitem**'\n\nI've checked the result with print result and it is None\nThe deletion is made ok but the try to return result[\"n\"] raises and error because result is None\n\nDid I missed something or did I find a bug?\n\nThanks!\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1008/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/1008/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/997", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/997/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/997/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/997/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/997", "id": 75302636, "node_id": "MDU6SXNzdWU3NTMwMjYzNg==", "number": 997, "title": "mongoengine.errors.ValidationError: A ReferenceField only accepts DBRef or documents", "user": {"login": "dmitry-saritasa", "id": 1747653, "node_id": "MDQ6VXNlcjE3NDc2NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1747653?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dmitry-saritasa", "html_url": "https://github.com/dmitry-saritasa", "followers_url": "https://api.github.com/users/dmitry-saritasa/followers", "following_url": "https://api.github.com/users/dmitry-saritasa/following{/other_user}", "gists_url": "https://api.github.com/users/dmitry-saritasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/dmitry-saritasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dmitry-saritasa/subscriptions", "organizations_url": "https://api.github.com/users/dmitry-saritasa/orgs", "repos_url": "https://api.github.com/users/dmitry-saritasa/repos", "events_url": "https://api.github.com/users/dmitry-saritasa/events{/privacy}", "received_events_url": "https://api.github.com/users/dmitry-saritasa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}, {"id": 208337816, "node_id": "MDU6TGFiZWwyMDgzMzc4MTY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/(De)Reference", "name": "(De)Reference", "color": "fef2c0", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/18", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/18", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/18/labels", "id": 1178260, "node_id": "MDk6TWlsZXN0b25lMTE3ODI2MA==", "number": 18, "title": "0.10.1", "description": "", "creator": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "open_issues": 6, "closed_issues": 25, "state": "open", "created_at": "2015-06-23T21:06:37Z", "updated_at": "2020-03-22T13:59:53Z", "due_on": "2015-09-04T07:00:00Z", "closed_at": null}, "comments": 5, "created_at": "2015-05-11T17:44:27Z", "updated_at": "2022-04-11T12:10:43Z", "closed_at": "2018-10-15T23:55:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "python 2.7.8, latest mongoengine.zip from master:\nmongoengine/fields.py, line 990\n\n``` python\ndef validate(self, value):\n        if not isinstance(value, (self.document_type, DBRef)):\n            self.error(\"A ReferenceField only accepts DBRef or documents\")\n\n        if isinstance(value, Document) and value.id is None:\n            self.error('You can only reference documents once they have been '\n                       'saved to the database')\n```\n\n**first \"if\" gives the following code**\n\n``` python\n    s = Shift.objects.get(id='554ad0c18a5da50025b7c7c3')\n    print s.guard.fname\n    #guard = Guard.objects.get(id='55355d7083ba88e23f8b4569')\n    guard = Guard.objects.get(id='54d4361183ba88c24a8b4567')\n    print guard.fullname\n    s.guard = guard\n    s.save()\n\n```\n\nmongoengine.errors.ValidationError: A ReferenceField only accepts DBRef or documents\n\ntraceback:\nhttps://gist.github.com/saritasa/27d82f33e3cc33afe1cb\n\nIf I run it again - everything works. If I uncomment the first guard and comment 2nd guard, I get this error again. Run 4th time - and error gone. \n\nvalue is ObjectId type, when I debug code.\n\nSample data:\n\n``` json\n{\n    \"_id\" : ObjectId(\"554ad0c18a5da50025b7c7c3\"),\n    \"parent\" : ObjectId(\"55241c448a5da5002616ede5\"),\n    \"type\" : \"reassignment\",\n    \"date\" : ISODate(\"2015-05-15T00:00:00.000Z\"),\n    \"school\" : ObjectId(\"55241a8983ba889a678b4567\"),\n    \"location\" : ObjectId(\"55241ae583ba88d46c8b4567\"),\n    \"guard\" : ObjectId(\"54d4361183ba88c24a8b4567\"),\n    \"name\" : \"1st shift\",\n    \"weekday\" : 5,\n    \"start\" : \"08:00:00\",\n    \"finish\" : \"08:30:00\",\n    \"start_sec\" : 28800,\n    \"finish_sec\" : 30600,\n    \"weight\" : 28800,\n    \"holidays\" : [],\n    \"created_at\" : ISODate(\"2015-05-07T02:41:05.618Z\"),\n    \"updated_at\" : ISODate(\"2015-05-11T10:01:58.139Z\"),\n    \"guard_name\" : \"Guard2Vadik alt Kuz\",\n    \"school_name\" : \"VictorHigh\",\n    \"location_name\" : \"Joslin / Gard\",\n    \"guard_phone\" : \"1231231234\",\n    \"parent_cache\" : {\n        \"_id\" : ObjectId(\"55241c448a5da5002616ede5\"),\n        \"finish\" : \"08:30:00\",\n        \"weight\" : 28800,\n        \"start_sec\" : 28800,\n        \"finish_sec\" : 30600,\n        \"start\" : \"08:00:00\",\n        \"guard\" : ObjectId(\"552411f883ba8842658b4567\"),\n        \"type\" : \"regular\"\n    }\n}\n```\n\nFull shift class is here:\nhttps://gist.github.com/saritasa/ad9387a1259141db4a04\n\n**any ideas?**\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/997/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/997/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/961", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/961/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/961/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/961/events", "html_url": "https://github.com/MongoEngine/mongoengine/pull/961", "id": 68915898, "node_id": "MDExOlB1bGxSZXF1ZXN0MzM0NDY2MDk=", "number": 961, "title": "Fixes and tests for default 'id' field creation in Document metaclass", "user": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/17", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/17", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/17/labels", "id": 1098863, "node_id": "MDk6TWlsZXN0b25lMTA5ODg2Mw==", "number": 17, "title": "0.10", "description": "", "creator": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 37, "state": "closed", "created_at": "2015-05-06T16:17:07Z", "updated_at": "2015-06-26T08:50:24Z", "due_on": "2015-06-20T07:00:00Z", "closed_at": "2015-06-24T08:21:08Z"}, "comments": 11, "created_at": "2015-04-16T12:43:32Z", "updated_at": "2016-08-24T13:19:39Z", "closed_at": "2015-06-12T07:13:00Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/pulls/961", "html_url": "https://github.com/MongoEngine/mongoengine/pull/961", "diff_url": "https://github.com/MongoEngine/mongoengine/pull/961.diff", "patch_url": "https://github.com/MongoEngine/mongoengine/pull/961.patch", "merged_at": "2015-06-12T07:13:00Z"}, "body": "It's a pity we were waiting too long for tests for PR #688, so I decided to copy the logic and provide tests.\n\nIt allowed me to fix a couple other places too.\n\nThe tests also allowed me to find out that in one case, we are still messing up fields. I'll appreciate your input on this one\n\n<!-- Reviewable:start -->\n\n[<img src=\"https://reviewable.io/review_button.png\" height=40 alt=\"Review on Reviewable\"/>](https://reviewable.io/reviews/mongoengine/mongoengine/961)\n\n<!-- Reviewable:end -->\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/961/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/961/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/959", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/959/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/959/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/959/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/959", "id": 68887865, "node_id": "MDU6SXNzdWU2ODg4Nzg2NQ==", "number": 959, "title": "Impossible to filter a binary PK by its string value", "user": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/18", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/18", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/18/labels", "id": 1178260, "node_id": "MDk6TWlsZXN0b25lMTE3ODI2MA==", "number": 18, "title": "0.10.1", "description": "", "creator": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "open_issues": 6, "closed_issues": 25, "state": "open", "created_at": "2015-06-23T21:06:37Z", "updated_at": "2020-03-22T13:59:53Z", "due_on": "2015-09-04T07:00:00Z", "closed_at": null}, "comments": 1, "created_at": "2015-04-16T09:51:45Z", "updated_at": "2019-12-14T20:56:20Z", "closed_at": "2019-12-14T20:56:20Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Hi all,\n\nAs showed in the skipped test test_binary_field_primary_filter_by_binary_pk_as_str from the branch #946 it is currently possible to create a object by the bytes string representation of a binary object, but not to query it afterwards.\n\nFor consistency and practically, it should be fixed, furthermore knowing there are different bson.Binary object types\n\nBest,\nMatthieu\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/959/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/959/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/954", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/954/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/954/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/954/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/954", "id": 67866116, "node_id": "MDU6SXNzdWU2Nzg2NjExNg==", "number": 954, "title": "ReferenceField('self') attribute of a subclass document can't hold an instance of parent class document", "user": {"login": "c05mic", "id": 1133165, "node_id": "MDQ6VXNlcjExMzMxNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1133165?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c05mic", "html_url": "https://github.com/c05mic", "followers_url": "https://api.github.com/users/c05mic/followers", "following_url": "https://api.github.com/users/c05mic/following{/other_user}", "gists_url": "https://api.github.com/users/c05mic/gists{/gist_id}", "starred_url": "https://api.github.com/users/c05mic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c05mic/subscriptions", "organizations_url": "https://api.github.com/users/c05mic/orgs", "repos_url": "https://api.github.com/users/c05mic/repos", "events_url": "https://api.github.com/users/c05mic/events{/privacy}", "received_events_url": "https://api.github.com/users/c05mic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "mmellison", "id": 799727, "node_id": "MDQ6VXNlcjc5OTcyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/799727?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mmellison", "html_url": "https://github.com/mmellison", "followers_url": "https://api.github.com/users/mmellison/followers", "following_url": "https://api.github.com/users/mmellison/following{/other_user}", "gists_url": "https://api.github.com/users/mmellison/gists{/gist_id}", "starred_url": "https://api.github.com/users/mmellison/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mmellison/subscriptions", "organizations_url": "https://api.github.com/users/mmellison/orgs", "repos_url": "https://api.github.com/users/mmellison/repos", "events_url": "https://api.github.com/users/mmellison/events{/privacy}", "received_events_url": "https://api.github.com/users/mmellison/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mmellison", "id": 799727, "node_id": "MDQ6VXNlcjc5OTcyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/799727?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mmellison", "html_url": "https://github.com/mmellison", "followers_url": "https://api.github.com/users/mmellison/followers", "following_url": "https://api.github.com/users/mmellison/following{/other_user}", "gists_url": "https://api.github.com/users/mmellison/gists{/gist_id}", "starred_url": "https://api.github.com/users/mmellison/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mmellison/subscriptions", "organizations_url": "https://api.github.com/users/mmellison/orgs", "repos_url": "https://api.github.com/users/mmellison/repos", "events_url": "https://api.github.com/users/mmellison/events{/privacy}", "received_events_url": "https://api.github.com/users/mmellison/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2015-04-12T03:29:28Z", "updated_at": "2015-04-30T13:22:19Z", "closed_at": "2015-04-30T13:22:15Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "```\nclass Parent(Document):\n    link = ReferenceField('self')\n\nclass Child(Parent):\n   pass\n\nparent = Parent()\nparent.save()\nchild = Child()\nchild.link = parent\n# Below line throws ValidationError: ValidationError (A ReferenceField only accepts DBRef or documents)\nchild.save()\n```\n\nIs this an expected behaviour?\n\nUsing MongoDB 3.0.2 with MongoEngine 0.9.0 and PyMongo 2.7.2.\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/954/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/954/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/943", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/943/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/943/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/943/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/943", "id": 67187069, "node_id": "MDU6SXNzdWU2NzE4NzA2OQ==", "number": 943, "title": "Calling limit() on a queryset does not actually limit results on server side call", "user": {"login": "andrewbelu", "id": 3247221, "node_id": "MDQ6VXNlcjMyNDcyMjE=", "avatar_url": "https://avatars.githubusercontent.com/u/3247221?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andrewbelu", "html_url": "https://github.com/andrewbelu", "followers_url": "https://api.github.com/users/andrewbelu/followers", "following_url": "https://api.github.com/users/andrewbelu/following{/other_user}", "gists_url": "https://api.github.com/users/andrewbelu/gists{/gist_id}", "starred_url": "https://api.github.com/users/andrewbelu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andrewbelu/subscriptions", "organizations_url": "https://api.github.com/users/andrewbelu/orgs", "repos_url": "https://api.github.com/users/andrewbelu/repos", "events_url": "https://api.github.com/users/andrewbelu/events{/privacy}", "received_events_url": "https://api.github.com/users/andrewbelu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/18", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/18", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/18/labels", "id": 1178260, "node_id": "MDk6TWlsZXN0b25lMTE3ODI2MA==", "number": 18, "title": "0.10.1", "description": "", "creator": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "open_issues": 6, "closed_issues": 25, "state": "open", "created_at": "2015-06-23T21:06:37Z", "updated_at": "2020-03-22T13:59:53Z", "due_on": "2015-09-04T07:00:00Z", "closed_at": null}, "comments": 8, "created_at": "2015-04-08T18:13:22Z", "updated_at": "2015-06-29T20:25:59Z", "closed_at": "2015-06-29T20:25:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am trying to limit the results of a query and feed the queryset to a Django template. When I try to perform the following:\n\n```\nrecords = Record.objects(query).limit(10)\n```\n\nAnd send it to a Django (v1.7) table template, this results in more than 10 records appearing in my table (71 to be exact).\n\nNote that if I call records.count() after the limit(), it returns 71. len(records) returns 10 however.  \n\nI am using mongoengine 0.9 and pymongo 2.8.\n\nAlso note, if I cast records to a list it works fine, but I lose some of the pagination/queryset capabilities I would want.\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/943/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/943/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/938", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/938/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/938/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/938/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/938", "id": 67162583, "node_id": "MDU6SXNzdWU2NzE2MjU4Mw==", "number": 938, "title": "Using only() with a ListField doesn't populate the field with an empty BaseList if the field is missing", "user": {"login": "eli-b", "id": 834999, "node_id": "MDQ6VXNlcjgzNDk5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/834999?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eli-b", "html_url": "https://github.com/eli-b", "followers_url": "https://api.github.com/users/eli-b/followers", "following_url": "https://api.github.com/users/eli-b/following{/other_user}", "gists_url": "https://api.github.com/users/eli-b/gists{/gist_id}", "starred_url": "https://api.github.com/users/eli-b/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eli-b/subscriptions", "organizations_url": "https://api.github.com/users/eli-b/orgs", "repos_url": "https://api.github.com/users/eli-b/repos", "events_url": "https://api.github.com/users/eli-b/events{/privacy}", "received_events_url": "https://api.github.com/users/eli-b/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}, {"id": 208337311, "node_id": "MDU6TGFiZWwyMDgzMzczMTE=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/ListField", "name": "ListField", "color": "fef2c0", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2015-04-08T16:01:26Z", "updated_at": "2021-05-17T19:08:01Z", "closed_at": "2021-05-17T19:08:01Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "To reproduce:\n\n```\nclass A(Document):\n    my_list = ListField(IntField())\na = A(my_list=[3]).save()\na.my_list = []\na.save()\n# This creates a document without a my_list key in the a collection.\n# This does not happen when there are no versions initially. A my_list key mapped to an empty list is saved then.\n\na2 = A.objects(id=a.id).get()\nassert a2.my_list == []  # Actually a BaseList object\n\na3 = A.objects(id=a.id).only('my_list').get()\nassert a3.my_list is None\n```\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/938/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/938/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/935", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/935/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/935/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/935/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/935", "id": 67034420, "node_id": "MDU6SXNzdWU2NzAzNDQyMA==", "number": 935, "title": "upgrade to pymongo 3.0 breaks pymongo connection", "user": {"login": "timfeirg", "id": 4319104, "node_id": "MDQ6VXNlcjQzMTkxMDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4319104?v=4", "gravatar_id": "", "url": "https://api.github.com/users/timfeirg", "html_url": "https://github.com/timfeirg", "followers_url": "https://api.github.com/users/timfeirg/followers", "following_url": "https://api.github.com/users/timfeirg/following{/other_user}", "gists_url": "https://api.github.com/users/timfeirg/gists{/gist_id}", "starred_url": "https://api.github.com/users/timfeirg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/timfeirg/subscriptions", "organizations_url": "https://api.github.com/users/timfeirg/orgs", "repos_url": "https://api.github.com/users/timfeirg/repos", "events_url": "https://api.github.com/users/timfeirg/events{/privacy}", "received_events_url": "https://api.github.com/users/timfeirg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/17", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/17", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/17/labels", "id": 1098863, "node_id": "MDk6TWlsZXN0b25lMTA5ODg2Mw==", "number": 17, "title": "0.10", "description": "", "creator": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 37, "state": "closed", "created_at": "2015-05-06T16:17:07Z", "updated_at": "2015-06-26T08:50:24Z", "due_on": "2015-06-20T07:00:00Z", "closed_at": "2015-06-24T08:21:08Z"}, "comments": 11, "created_at": "2015-04-08T02:37:42Z", "updated_at": "2015-05-11T13:59:53Z", "closed_at": "2015-05-11T13:59:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "error message as follows:\n\n```\nException Type: ConnectionError\nException Value:    \nCannot connect to database dashboard :\nFalse is not a read preference.\n\n# local variables from django output\nconn_settings = {'host': '10.6.2.41', 'port': 27017, 'read_preference': False}\nconnection_settings  = {'authentication_source': None, 'host': '10.6.2.41', 'port': 27017, 'read_preference': False}\n```\n\nYou can see the problem is in 'read_preference', which in mongnengine is False by default, which no longer is valid in pymongo.\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/935/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/935/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/918", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/918/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/918/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/918/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/918", "id": 65046153, "node_id": "MDU6SXNzdWU2NTA0NjE1Mw==", "number": 918, "title": "Datetimes become timezone aware", "user": {"login": "CosmicAnalogue465", "id": 499021, "node_id": "MDQ6VXNlcjQ5OTAyMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/499021?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CosmicAnalogue465", "html_url": "https://github.com/CosmicAnalogue465", "followers_url": "https://api.github.com/users/CosmicAnalogue465/followers", "following_url": "https://api.github.com/users/CosmicAnalogue465/following{/other_user}", "gists_url": "https://api.github.com/users/CosmicAnalogue465/gists{/gist_id}", "starred_url": "https://api.github.com/users/CosmicAnalogue465/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CosmicAnalogue465/subscriptions", "organizations_url": "https://api.github.com/users/CosmicAnalogue465/orgs", "repos_url": "https://api.github.com/users/CosmicAnalogue465/repos", "events_url": "https://api.github.com/users/CosmicAnalogue465/events{/privacy}", "received_events_url": "https://api.github.com/users/CosmicAnalogue465/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}, {"id": 774310, "node_id": "MDU6TGFiZWw3NzQzMTA=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Awaiting%20Response", "name": "Awaiting Response", "color": "c2e0c6", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/18", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/18", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/18/labels", "id": 1178260, "node_id": "MDk6TWlsZXN0b25lMTE3ODI2MA==", "number": 18, "title": "0.10.1", "description": "", "creator": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "open_issues": 6, "closed_issues": 25, "state": "open", "created_at": "2015-06-23T21:06:37Z", "updated_at": "2020-03-22T13:59:53Z", "due_on": "2015-09-04T07:00:00Z", "closed_at": null}, "comments": 8, "created_at": "2015-03-29T10:20:21Z", "updated_at": "2017-07-14T04:40:39Z", "closed_at": "2017-07-14T04:40:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "If I serialize a object using to_json with timezone unaware dates and then load them back with from_json, the datetime object is then timezone aware.\r\n\r\n```py\r\nclass TestDoc(Document):\r\n    d = DateTimeField()\r\n\r\na = TestDoc()\r\na.d = datetime.now()\r\n\r\nprint a.d  # 2015-03-29 11:12:53.963929\r\na = TestDoc.from_json(a.to_json())\r\nprint a.d  # 2015-03-29 11:12:53.963000+00:00\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/918/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/918/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/912", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/912/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/912/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/912/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/912", "id": 63726085, "node_id": "MDU6SXNzdWU2MzcyNjA4NQ==", "number": 912, "title": "Field filtering on MapField with EmbeddedDocumentField not working", "user": {"login": "MasterMind2k", "id": 1457425, "node_id": "MDQ6VXNlcjE0NTc0MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1457425?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MasterMind2k", "html_url": "https://github.com/MasterMind2k", "followers_url": "https://api.github.com/users/MasterMind2k/followers", "following_url": "https://api.github.com/users/MasterMind2k/following{/other_user}", "gists_url": "https://api.github.com/users/MasterMind2k/gists{/gist_id}", "starred_url": "https://api.github.com/users/MasterMind2k/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MasterMind2k/subscriptions", "organizations_url": "https://api.github.com/users/MasterMind2k/orgs", "repos_url": "https://api.github.com/users/MasterMind2k/repos", "events_url": "https://api.github.com/users/MasterMind2k/events{/privacy}", "received_events_url": "https://api.github.com/users/MasterMind2k/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2015-03-23T13:46:12Z", "updated_at": "2015-05-06T10:54:18Z", "closed_at": "2015-05-06T10:54:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi.\n\nBy looking through the net, the only and other field filtering should work on MapField, but if MapField has EmbeddedDocumentField for it's field, it does not work. Raising this exception in queryset/base.py\", line 1357:\n\nAttributeError: 'str' object has no attribute 'db_field'\n\nBy looking more in depth, I found out that _lookup_field \"delegates\" lookup_member to it's field if present, which MapField has, the EmbeddedDocumentField. Since the EmbeddedDocument has no idea about the members I'm requesting, it returns None, and since MapField is BaseComplexField, the _lookup_field puts field name into the fields list as a string causing that exception.\n\nOne way to fix this, would be to add an exception into _lookup_field, not to use field property on MapField (which would result in creating a DictField and not using the EmbeddedDocument's lookup_member method).\n\nBest regards,\nGregor Kali\u0161nik\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/912/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/912/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/909", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/909/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/909/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/909/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/909", "id": 62773903, "node_id": "MDU6SXNzdWU2Mjc3MzkwMw==", "number": 909, "title": "Connect blindly overrides username/password when URI style connection is used.", "user": {"login": "ryan-lane", "id": 1538354, "node_id": "MDQ6VXNlcjE1MzgzNTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1538354?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ryan-lane", "html_url": "https://github.com/ryan-lane", "followers_url": "https://api.github.com/users/ryan-lane/followers", "following_url": "https://api.github.com/users/ryan-lane/following{/other_user}", "gists_url": "https://api.github.com/users/ryan-lane/gists{/gist_id}", "starred_url": "https://api.github.com/users/ryan-lane/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ryan-lane/subscriptions", "organizations_url": "https://api.github.com/users/ryan-lane/orgs", "repos_url": "https://api.github.com/users/ryan-lane/repos", "events_url": "https://api.github.com/users/ryan-lane/events{/privacy}", "received_events_url": "https://api.github.com/users/ryan-lane/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}, {"id": 208337895, "node_id": "MDU6TGFiZWwyMDgzMzc4OTU=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Client/Connect", "name": "Client/Connect", "color": "f9d0c4", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2015-03-18T19:03:27Z", "updated_at": "2016-12-12T03:04:29Z", "closed_at": "2016-12-12T03:04:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\nmongoengine.register_connection(\n    'myalias',\n    'mydb',\n    host='mongodb://localhost:27017',\n    username='myuser',\n    password=='mypassword'\n)\n```\n\nThe above will connect to mydb with username None and password None. This is because though a username and password are set, if a uri is used mongoengine will blindly override them: https://github.com/MongoEngine/mongoengine/blob/master/mongoengine/connection.py#L57\n\nIs there any reason not to do 'or username' and 'or password' similar to what's being done for database?\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/909/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/909/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/904", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/904/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/904/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/904/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/904", "id": 60069710, "node_id": "MDU6SXNzdWU2MDA2OTcxMA==", "number": 904, "title": "error while using \"db_field\" parameter in multi-level embedded documents", "user": {"login": "ms5", "id": 5268998, "node_id": "MDQ6VXNlcjUyNjg5OTg=", "avatar_url": "https://avatars.githubusercontent.com/u/5268998?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ms5", "html_url": "https://github.com/ms5", "followers_url": "https://api.github.com/users/ms5/followers", "following_url": "https://api.github.com/users/ms5/following{/other_user}", "gists_url": "https://api.github.com/users/ms5/gists{/gist_id}", "starred_url": "https://api.github.com/users/ms5/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ms5/subscriptions", "organizations_url": "https://api.github.com/users/ms5/orgs", "repos_url": "https://api.github.com/users/ms5/repos", "events_url": "https://api.github.com/users/ms5/events{/privacy}", "received_events_url": "https://api.github.com/users/ms5/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}, {"id": 774310, "node_id": "MDU6TGFiZWw3NzQzMTA=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Awaiting%20Response", "name": "Awaiting Response", "color": "c2e0c6", "default": false, "description": null}, {"id": 208337816, "node_id": "MDU6TGFiZWwyMDgzMzc4MTY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/(De)Reference", "name": "(De)Reference", "color": "fef2c0", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "wojcikstefan", "id": 1718372, "node_id": "MDQ6VXNlcjE3MTgzNzI=", "avatar_url": "https://avatars.githubusercontent.com/u/1718372?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wojcikstefan", "html_url": "https://github.com/wojcikstefan", "followers_url": "https://api.github.com/users/wojcikstefan/followers", "following_url": "https://api.github.com/users/wojcikstefan/following{/other_user}", "gists_url": "https://api.github.com/users/wojcikstefan/gists{/gist_id}", "starred_url": "https://api.github.com/users/wojcikstefan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wojcikstefan/subscriptions", "organizations_url": "https://api.github.com/users/wojcikstefan/orgs", "repos_url": "https://api.github.com/users/wojcikstefan/repos", "events_url": "https://api.github.com/users/wojcikstefan/events{/privacy}", "received_events_url": "https://api.github.com/users/wojcikstefan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "wojcikstefan", "id": 1718372, "node_id": "MDQ6VXNlcjE3MTgzNzI=", "avatar_url": "https://avatars.githubusercontent.com/u/1718372?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wojcikstefan", "html_url": "https://github.com/wojcikstefan", "followers_url": "https://api.github.com/users/wojcikstefan/followers", "following_url": "https://api.github.com/users/wojcikstefan/following{/other_user}", "gists_url": "https://api.github.com/users/wojcikstefan/gists{/gist_id}", "starred_url": "https://api.github.com/users/wojcikstefan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wojcikstefan/subscriptions", "organizations_url": "https://api.github.com/users/wojcikstefan/orgs", "repos_url": "https://api.github.com/users/wojcikstefan/repos", "events_url": "https://api.github.com/users/wojcikstefan/events{/privacy}", "received_events_url": "https://api.github.com/users/wojcikstefan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2015-03-06T07:42:02Z", "updated_at": "2019-03-07T15:24:38Z", "closed_at": "2017-03-05T23:20:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "The following code is an example to reconstruct what's going wrong. The main problem seems to be the use of `db_field` in the second level of the embedded document (In the example this is `class B`)\n\n``` python\ndata = {'b': {'c': [{'x': 1.0, 'y': 2.0}]}}\n\nclass C(EmbeddedDocument):\n    x = FloatField(db_field='fx')\n    y = FloatField(db_field='fy')\n\nclass B(EmbeddedDocument):\n    c = ListField(EmbeddedDocumentField(C), db_field='fc')\n\nclass A(EmbeddedDocument):\n    b = EmbeddedDocumentField(B, db_field='fb')\n\na = A(**data)\na.validate()\n```\n\nIf I run this, it throws an exception:\n\n``` python\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/site-packages/mongoengine/base/document.py\", line 424, in validate\n    raise ValidationError(message, errors=errors)\nmongoengine.errors.ValidationError: ValidationError (A:None) (c.Invalid embedded document instance provided to an EmbeddedDocumentField: ['b'])\n```\n\nBut it runs through if I remove the `db_field` attribute in `class B`:\n\n``` python\nclass B(EmbeddedDocument):\n    c = ListField(EmbeddedDocumentField(C))\n```\n\nWhile digging in to this problem I found out that the exception is actually correct when saying the Document has the wrong format. \n\nwhile running a simple print on the working an non working version, the type differs. \n\n``` python\nprint(a.b.c[0])\nprint(type(a.b.c[0]))\n\n# wrong\n{'x': 1.0, 'y': 2.0}\n<class 'mongoengine.base.datastructures.BaseDict'>\n\n# good\nC object\n<class '__main__.C'>\n```\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/904/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/904/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/882", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/882/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/882/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/882/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/882", "id": 57928672, "node_id": "MDU6SXNzdWU1NzkyODY3Mg==", "number": 882, "title": "'str' object has no attribute 'lookup_member'", "user": {"login": "TvoroG", "id": 1325161, "node_id": "MDQ6VXNlcjEzMjUxNjE=", "avatar_url": "https://avatars.githubusercontent.com/u/1325161?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TvoroG", "html_url": "https://github.com/TvoroG", "followers_url": "https://api.github.com/users/TvoroG/followers", "following_url": "https://api.github.com/users/TvoroG/following{/other_user}", "gists_url": "https://api.github.com/users/TvoroG/gists{/gist_id}", "starred_url": "https://api.github.com/users/TvoroG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TvoroG/subscriptions", "organizations_url": "https://api.github.com/users/TvoroG/orgs", "repos_url": "https://api.github.com/users/TvoroG/repos", "events_url": "https://api.github.com/users/TvoroG/events{/privacy}", "received_events_url": "https://api.github.com/users/TvoroG/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/17", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/17", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/17/labels", "id": 1098863, "node_id": "MDk6TWlsZXN0b25lMTA5ODg2Mw==", "number": 17, "title": "0.10", "description": "", "creator": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 37, "state": "closed", "created_at": "2015-05-06T16:17:07Z", "updated_at": "2015-06-26T08:50:24Z", "due_on": "2015-06-20T07:00:00Z", "closed_at": "2015-06-24T08:21:08Z"}, "comments": 0, "created_at": "2015-02-17T14:14:47Z", "updated_at": "2015-06-22T12:56:15Z", "closed_at": "2015-06-22T12:56:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello! If the dynamic lookup is composed of more than two parts then it fails.\n\n``` python\nfrom mongoengine import *\nconnect('mongoengine')\n\nclass Page(DynamicDocument):\n    title = StringField(max_length=200, required=True)\n\nprint Page.objects.filter(field1__field2__field3=1)\n```\n\nTraceback:\n\n```\n  File \"test_mongo.py\", line 12, in <module>\n    print Page.objects.filter(field1__field2__field3=1)\n  File \"/home/test/.virtualenvs/test_env/lib/python2.7/site-packages/mongoengine/queryset/queryset.py\", line 58, in __repr__\n    self._populate_cache()\n  File \"/home/test/.virtualenvs/test_env/lib/python2.7/site-packages/mongoengine/queryset/queryset.py\", line 93, in _populate_cache\n    self._result_cache.append(self.next())\n  File \"/home/test/.virtualenvs/test_env/lib/python2.7/site-packages/mongoengine/queryset/base.py\", line 1137, in next\n    raw_doc = self._cursor.next()\n  File \"/home/test/.virtualenvs/test_env/lib/python2.7/site-packages/mongoengine/queryset/base.py\", line 1182, in _cursor\n    self._cursor_obj = self._collection.find(self._query,\n  File \"/home/test/.virtualenvs/test_env/lib/python2.7/site-packages/mongoengine/queryset/base.py\", line 1215, in _query\n    self._mongo_query = self._query_obj.to_query(self._document)\n  File \"/home/test/.virtualenvs/test_env/lib/python2.7/site-packages/mongoengine/queryset/visitor.py\", line 92, in to_query\n    query = query.accept(QueryCompilerVisitor(document))\n  File \"/home/test/.virtualenvs/test_env/lib/python2.7/site-packages/mongoengine/queryset/visitor.py\", line 157, in accept\n    return visitor.visit_query(self)\n  File \"/home/test/.virtualenvs/test_env/lib/python2.7/site-packages/mongoengine/queryset/visitor.py\", line 80, in visit_query\n    return transform.query(self.document, **query.query)\n  File \"/home/test/.virtualenvs/test_env/lib/python2.7/site-packages/mongoengine/queryset/transform.py\", line 59, in query\n    raise InvalidQueryError(e)\nmongoengine.errors.InvalidQueryError: 'str' object has no attribute 'lookup_member'\n```\n\nThis worked for me, but I don't know for sure.\n\n``` python\nclass DynamicField(BaseField):\n    ...\n    def lookup_member(self, member_name):\n        return DynamicField(db_field=member_name)\n    ...\n```\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/882/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/882/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/843", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/843/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/843/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/843/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/843", "id": 53237429, "node_id": "MDU6SXNzdWU1MzIzNzQyOQ==", "number": 843, "title": "Error with atomic updates and modifier operator: InvalidQueryError(\"Updates must supply an operation eg: set__FIELD=value\")", "user": {"login": "mamigot", "id": 4607838, "node_id": "MDQ6VXNlcjQ2MDc4Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/4607838?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mamigot", "html_url": "https://github.com/mamigot", "followers_url": "https://api.github.com/users/mamigot/followers", "following_url": "https://api.github.com/users/mamigot/following{/other_user}", "gists_url": "https://api.github.com/users/mamigot/gists{/gist_id}", "starred_url": "https://api.github.com/users/mamigot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mamigot/subscriptions", "organizations_url": "https://api.github.com/users/mamigot/orgs", "repos_url": "https://api.github.com/users/mamigot/repos", "events_url": "https://api.github.com/users/mamigot/events{/privacy}", "received_events_url": "https://api.github.com/users/mamigot/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}, {"id": 774310, "node_id": "MDU6TGFiZWw3NzQzMTA=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Awaiting%20Response", "name": "Awaiting Response", "color": "c2e0c6", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2015-01-02T04:44:05Z", "updated_at": "2022-12-09T23:24:42Z", "closed_at": "2022-12-09T23:24:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "(I am using mongoengine==0.8.7 and flask-mongoengine==0.7.1; though the error is traced to a mongoengine file independent of Flask, I am posting this in case it's a problem with their compatibility)\n\n<a href=\"https://mongoengine-odm.readthedocs.org/en/latest/guide/querying.html#atomic-updates\">The mongoengine docs</a> state that the following code is equivalent.\n\n```\n>>> BlogPost.objects(id=post.id).update(title='Example Post')\n>>> BlogPost.objects(id=post.id).update(set__title='Example Post')\n```\n\nHowever, when the modifier isn't set as in the former example, I get the following error. Notice that it disappears when I provide the modifier, however:\n\n```\n>>> BlogPost.objects(slug='slug3').update(title='new_title')\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/Users/miguelamigot/.virtualenvs/pw-venv/lib/python2.7/site-packages/mongoengine/queryset/base.py\", line 430, in update\n    update = transform.update(queryset._document, **update)\n  File \"/Users/miguelamigot/.virtualenvs/pw-venv/lib/python2.7/site-packages/mongoengine/queryset/transform.py\", line 233, in update\n    raise InvalidQueryError(\"Updates must supply an operation \"\nmongoengine.errors.InvalidQueryError: Updates must supply an operation eg: set__FIELD=value\n\n>>> BlogPost.objects(slug='slug3').update(set__title='new_title')\n1\n```\n\nBy looking at the `update(_doc_cls=None, **update)` function in transform.py, it's clear that it expects \"set__\" to come before each key. Here it is:\n\n```\ndef update(_doc_cls=None, **update):\n    \"\"\"Transform an update spec from Django-style format to Mongo format.\n    \"\"\"\n    mongo_update = {}\n    for key, value in update.items():\n        if key == \"__raw__\":\n            mongo_update.update(value)\n            continue\n        parts = key.split('__')\n        # Check for an operator and transform to mongo-style if there is\n        op = None\n        if parts[0] in UPDATE_OPERATORS:\n            op = parts.pop(0)\n            # Convert Pythonic names to Mongo equivalents\n            if op in ('push_all', 'pull_all'):\n                op = op.replace('_all', 'All')\n            elif op == 'dec':\n                # Support decrement by flipping a positive value's sign\n                # and using 'inc'\n                op = 'inc'\n                if value > 0:\n                    value = -value\n            elif op == 'add_to_set':\n                op = 'addToSet'\n            elif op == 'set_on_insert':\n                op = \"setOnInsert\"\n```\n\nLater in the function (no value is assigned to `op` in the meantime)...\n\n```\nif not op:\n            raise InvalidQueryError(\"Updates must supply an operation \"\n                                    \"eg: set__FIELD=value\")\n```\n\nPlease let me know; thank you!\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/843/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/843/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/842", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/842/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/842/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/842/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/842", "id": 53078781, "node_id": "MDU6SXNzdWU1MzA3ODc4MQ==", "number": 842, "title": "chaining only after limit", "user": {"login": "jwkvam", "id": 86304, "node_id": "MDQ6VXNlcjg2MzA0", "avatar_url": "https://avatars.githubusercontent.com/u/86304?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwkvam", "html_url": "https://github.com/jwkvam", "followers_url": "https://api.github.com/users/jwkvam/followers", "following_url": "https://api.github.com/users/jwkvam/following{/other_user}", "gists_url": "https://api.github.com/users/jwkvam/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwkvam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwkvam/subscriptions", "organizations_url": "https://api.github.com/users/jwkvam/orgs", "repos_url": "https://api.github.com/users/jwkvam/repos", "events_url": "https://api.github.com/users/jwkvam/events{/privacy}", "received_events_url": "https://api.github.com/users/jwkvam/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "DavidBord", "id": 3276118, "node_id": "MDQ6VXNlcjMyNzYxMTg=", "avatar_url": "https://avatars.githubusercontent.com/u/3276118?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DavidBord", "html_url": "https://github.com/DavidBord", "followers_url": "https://api.github.com/users/DavidBord/followers", "following_url": "https://api.github.com/users/DavidBord/following{/other_user}", "gists_url": "https://api.github.com/users/DavidBord/gists{/gist_id}", "starred_url": "https://api.github.com/users/DavidBord/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DavidBord/subscriptions", "organizations_url": "https://api.github.com/users/DavidBord/orgs", "repos_url": "https://api.github.com/users/DavidBord/repos", "events_url": "https://api.github.com/users/DavidBord/events{/privacy}", "received_events_url": "https://api.github.com/users/DavidBord/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "DavidBord", "id": 3276118, "node_id": "MDQ6VXNlcjMyNzYxMTg=", "avatar_url": "https://avatars.githubusercontent.com/u/3276118?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DavidBord", "html_url": "https://github.com/DavidBord", "followers_url": "https://api.github.com/users/DavidBord/followers", "following_url": "https://api.github.com/users/DavidBord/following{/other_user}", "gists_url": "https://api.github.com/users/DavidBord/gists{/gist_id}", "starred_url": "https://api.github.com/users/DavidBord/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DavidBord/subscriptions", "organizations_url": "https://api.github.com/users/DavidBord/orgs", "repos_url": "https://api.github.com/users/DavidBord/repos", "events_url": "https://api.github.com/users/DavidBord/events{/privacy}", "received_events_url": "https://api.github.com/users/DavidBord/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2014-12-29T22:52:49Z", "updated_at": "2015-07-03T05:23:15Z", "closed_at": "2015-07-03T05:23:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "Maybe this is obvious but I was using `only` after `limit` and didn't understand why the `only` call had no effect. Would it be helpful to have this documented in the API?\n\nSo\n\n```\nDocument.limit(1000).only('field')\n```\n\nwas the same as\n\n```\nDocument.limit(1000)\n```\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/842/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/842/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/789", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/789/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/789/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/789/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/789", "id": 47137388, "node_id": "MDU6SXNzdWU0NzEzNzM4OA==", "number": 789, "title": "abstract shouldn't be inherited in EmbeddedDocument", "user": {"login": "DavidBord", "id": 3276118, "node_id": "MDQ6VXNlcjMyNzYxMTg=", "avatar_url": "https://avatars.githubusercontent.com/u/3276118?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DavidBord", "html_url": "https://github.com/DavidBord", "followers_url": "https://api.github.com/users/DavidBord/followers", "following_url": "https://api.github.com/users/DavidBord/following{/other_user}", "gists_url": "https://api.github.com/users/DavidBord/gists{/gist_id}", "starred_url": "https://api.github.com/users/DavidBord/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DavidBord/subscriptions", "organizations_url": "https://api.github.com/users/DavidBord/orgs", "repos_url": "https://api.github.com/users/DavidBord/repos", "events_url": "https://api.github.com/users/DavidBord/events{/privacy}", "received_events_url": "https://api.github.com/users/DavidBord/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2014-10-29T11:32:06Z", "updated_at": "2014-10-29T11:55:56Z", "closed_at": "2014-10-29T11:55:54Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/789/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/789/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/776", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/776/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/776/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/776/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/776", "id": 44751038, "node_id": "MDU6SXNzdWU0NDc1MTAzOA==", "number": 776, "title": "ValidationError: Only lists and tuples may be used in a list field", "user": {"login": "shahafabileah", "id": 2823450, "node_id": "MDQ6VXNlcjI4MjM0NTA=", "avatar_url": "https://avatars.githubusercontent.com/u/2823450?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shahafabileah", "html_url": "https://github.com/shahafabileah", "followers_url": "https://api.github.com/users/shahafabileah/followers", "following_url": "https://api.github.com/users/shahafabileah/following{/other_user}", "gists_url": "https://api.github.com/users/shahafabileah/gists{/gist_id}", "starred_url": "https://api.github.com/users/shahafabileah/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shahafabileah/subscriptions", "organizations_url": "https://api.github.com/users/shahafabileah/orgs", "repos_url": "https://api.github.com/users/shahafabileah/repos", "events_url": "https://api.github.com/users/shahafabileah/events{/privacy}", "received_events_url": "https://api.github.com/users/shahafabileah/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2014-10-02T23:23:42Z", "updated_at": "2015-08-12T17:46:18Z", "closed_at": "2015-04-16T07:51:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm hitting a ValidationError.  It looks like a bug with the way default values are applied to list fields.\n\nHere is my repro:\n\n``` python\nimport mongoengine as me\n\nme.connect('test')\n\n\n# We release V1 of our code\n\nclass FooV1(me.DynamicDocument):\n    meta = { 'collection': 'foo' }\n\n# Create an object and save it.  Remember its ID.\n\nfoo = FooV1()\nfoo.save()\n\nfoo_id = foo.id\n\n\n# We release V2 of our code.\n# It's the same collection but now each object has a list of embedded objects.\n\nclass Bar(me.EmbeddedDocument):\n    name = me.StringField()\n\ndef default_bar_list():\n    first_bar = Bar()\n    first_bar.name = 'first'\n    return [first_bar]\n\nclass FooV2(me.DynamicDocument):\n    meta = { 'collection': 'foo' }\n    bar_list = me.ListField(me.EmbeddedDocumentField(Bar), default=default_bar_list)\n\n\n# Fetch that same object, change it, and try to save it.  It should get that default bar list.\n\nfoo = FooV2.objects(id=foo_id).first()\nfoo.save()\n\n\n# Fetch that object one more time, change it, and try to save it.  BOOM!\n\nfoo = FooV2.objects(id=foo_id).first()\nfoo.save()\n```\n\nHere's what I get:\n\n```\n(venv)~/work> python default_list.py\nTraceback (most recent call last):\n  File \"default_list.py\", line 44, in <module>\n    foo.save()\n  File \"/Users/shahaf/work/vamo/venv/lib/python2.7/site-packages/mongoengine/document.py\", line 224, in save\n    self.validate(clean=clean)\n  File \"/Users/shahaf/work/vamo/venv/lib/python2.7/site-packages/mongoengine/base/document.py\", line 323, in validate\n    raise ValidationError(message, errors=errors)\nmongoengine.errors.ValidationError: ValidationError (FooV2:542ddda6964e2474821651ea) (Only lists and tuples may be used in a list field: ['bar_list'])\n```\n\nWhen look in the DB, here's what I see after the first save (using FooV1):\n\n```\n{ \"_id\" : ObjectId(\"542ddda6964e2474821651ea\") }\n```\n\nHere's how it looks after the second save (with FooV2):\n\n```\n{ \"_id\" : ObjectId(\"542ddda6964e2474821651ea\"), \"bar_list\" : { \"0\" : { \"name\" : \"first\" } } }\n```\n\nSo, bar_list should be getting a list of objects, but instead it's getting a dictionary.\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/776/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/776/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/740", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/740/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/740/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/740/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/740", "id": 40573062, "node_id": "MDU6SXNzdWU0MDU3MzA2Mg==", "number": 740, "title": "MapField update bug after #620 fix", "user": {"login": "laurentpayot", "id": 2776142, "node_id": "MDQ6VXNlcjI3NzYxNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/2776142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/laurentpayot", "html_url": "https://github.com/laurentpayot", "followers_url": "https://api.github.com/users/laurentpayot/followers", "following_url": "https://api.github.com/users/laurentpayot/following{/other_user}", "gists_url": "https://api.github.com/users/laurentpayot/gists{/gist_id}", "starred_url": "https://api.github.com/users/laurentpayot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/laurentpayot/subscriptions", "organizations_url": "https://api.github.com/users/laurentpayot/orgs", "repos_url": "https://api.github.com/users/laurentpayot/repos", "events_url": "https://api.github.com/users/laurentpayot/events{/privacy}", "received_events_url": "https://api.github.com/users/laurentpayot/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/15", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/15", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/15/labels", "id": 500350, "node_id": "MDk6TWlsZXN0b25lNTAwMzUw", "number": 15, "title": "Needs More Information", "description": "", "creator": {"login": "rozza", "id": 420, "node_id": "MDQ6VXNlcjQyMA==", "avatar_url": "https://avatars.githubusercontent.com/u/420?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rozza", "html_url": "https://github.com/rozza", "followers_url": "https://api.github.com/users/rozza/followers", "following_url": "https://api.github.com/users/rozza/following{/other_user}", "gists_url": "https://api.github.com/users/rozza/gists{/gist_id}", "starred_url": "https://api.github.com/users/rozza/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rozza/subscriptions", "organizations_url": "https://api.github.com/users/rozza/orgs", "repos_url": "https://api.github.com/users/rozza/repos", "events_url": "https://api.github.com/users/rozza/events{/privacy}", "received_events_url": "https://api.github.com/users/rozza/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 13, "state": "open", "created_at": "2013-11-29T09:16:49Z", "updated_at": "2020-04-08T19:28:56Z", "due_on": null, "closed_at": null}, "comments": 5, "created_at": "2014-08-19T09:31:01Z", "updated_at": "2014-08-21T22:39:32Z", "closed_at": "2014-08-21T22:39:32Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This bug appeared after the 5th of August commit 1e6a3163afc0bfc30a003010596a6800620d32a6 fixing issue #620.\n\nI'm using this field:\n\n<pre>\ndescriptions = MapField(StringField(max_length=AUTHOR_DESCRIPTION_LENGTH, default=\"\"),\n                        verbose_name=_(\"description\"))\n</pre>\n\nAfter commit when I do the following in my unit test\n\n<pre>\nself.author_jv.descriptions['fr'] = \"L\u2019\u0153uvre de Jules Verne est populaire \"\\\n                                    \"dans le monde entier.\"\nself.author_jv.save()\n</pre>\n\nI get \n<code>\nmongoengine.errors.OperationError: Could not save document (Cannot update 'descriptions' and 'descriptions.fr' at the same time)\n</code>\n\nI pass all my unit tests before that commit.\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/740/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/740/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/739", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/739/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/739/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/739/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/739", "id": 40479461, "node_id": "MDU6SXNzdWU0MDQ3OTQ2MQ==", "number": 739, "title": "Error while iterating through queryset", "user": {"login": "niranjrajasekaran", "id": 6571935, "node_id": "MDQ6VXNlcjY1NzE5MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/6571935?v=4", "gravatar_id": "", "url": "https://api.github.com/users/niranjrajasekaran", "html_url": "https://github.com/niranjrajasekaran", "followers_url": "https://api.github.com/users/niranjrajasekaran/followers", "following_url": "https://api.github.com/users/niranjrajasekaran/following{/other_user}", "gists_url": "https://api.github.com/users/niranjrajasekaran/gists{/gist_id}", "starred_url": "https://api.github.com/users/niranjrajasekaran/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/niranjrajasekaran/subscriptions", "organizations_url": "https://api.github.com/users/niranjrajasekaran/orgs", "repos_url": "https://api.github.com/users/niranjrajasekaran/repos", "events_url": "https://api.github.com/users/niranjrajasekaran/events{/privacy}", "received_events_url": "https://api.github.com/users/niranjrajasekaran/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2014-08-18T11:43:13Z", "updated_at": "2014-12-09T08:57:52Z", "closed_at": "2014-12-09T08:57:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "for user in User.objects:\n    print user.first_name\n\nWhen i iterate through queryset, it shows \n\nTypeError: **init**() takes at least 2 arguments (1 given)\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/739/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/739/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/734", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/734/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/734/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/734/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/734", "id": 40198980, "node_id": "MDU6SXNzdWU0MDE5ODk4MA==", "number": 734, "title": "set attribute to None does not work (at least for fields with default values)", "user": {"login": "DavidBord", "id": 3276118, "node_id": "MDQ6VXNlcjMyNzYxMTg=", "avatar_url": "https://avatars.githubusercontent.com/u/3276118?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DavidBord", "html_url": "https://github.com/DavidBord", "followers_url": "https://api.github.com/users/DavidBord/followers", "following_url": "https://api.github.com/users/DavidBord/following{/other_user}", "gists_url": "https://api.github.com/users/DavidBord/gists{/gist_id}", "starred_url": "https://api.github.com/users/DavidBord/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DavidBord/subscriptions", "organizations_url": "https://api.github.com/users/DavidBord/orgs", "repos_url": "https://api.github.com/users/DavidBord/repos", "events_url": "https://api.github.com/users/DavidBord/events{/privacy}", "received_events_url": "https://api.github.com/users/DavidBord/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2014-08-13T21:03:33Z", "updated_at": "2019-06-15T17:32:11Z", "closed_at": "2014-11-10T02:28:21Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "```\n    class User(Document):\n        name = StringField()\n        height = IntField(default=184)\n    User.objects.delete()\n    u = User(name='user')\n    u.save()\n    u_from_db = User.objects.get(name='user')\n    u_from_db.height = None\n    u_from_db.save()\n    self.assertEquals(u_from_db.height, None)\n```\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/734/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/734/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/730", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/730/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/730/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/730/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/730", "id": 39910120, "node_id": "MDU6SXNzdWUzOTkxMDEyMA==", "number": 730, "title": "Build process does not publish coverage to coveralls.io", "user": {"login": "thedrow", "id": 48936, "node_id": "MDQ6VXNlcjQ4OTM2", "avatar_url": "https://avatars.githubusercontent.com/u/48936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thedrow", "html_url": "https://github.com/thedrow", "followers_url": "https://api.github.com/users/thedrow/followers", "following_url": "https://api.github.com/users/thedrow/following{/other_user}", "gists_url": "https://api.github.com/users/thedrow/gists{/gist_id}", "starred_url": "https://api.github.com/users/thedrow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thedrow/subscriptions", "organizations_url": "https://api.github.com/users/thedrow/orgs", "repos_url": "https://api.github.com/users/thedrow/repos", "events_url": "https://api.github.com/users/thedrow/events{/privacy}", "received_events_url": "https://api.github.com/users/thedrow/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "thedrow", "id": 48936, "node_id": "MDQ6VXNlcjQ4OTM2", "avatar_url": "https://avatars.githubusercontent.com/u/48936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thedrow", "html_url": "https://github.com/thedrow", "followers_url": "https://api.github.com/users/thedrow/followers", "following_url": "https://api.github.com/users/thedrow/following{/other_user}", "gists_url": "https://api.github.com/users/thedrow/gists{/gist_id}", "starred_url": "https://api.github.com/users/thedrow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thedrow/subscriptions", "organizations_url": "https://api.github.com/users/thedrow/orgs", "repos_url": "https://api.github.com/users/thedrow/repos", "events_url": "https://api.github.com/users/thedrow/events{/privacy}", "received_events_url": "https://api.github.com/users/thedrow/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "thedrow", "id": 48936, "node_id": "MDQ6VXNlcjQ4OTM2", "avatar_url": "https://avatars.githubusercontent.com/u/48936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thedrow", "html_url": "https://github.com/thedrow", "followers_url": "https://api.github.com/users/thedrow/followers", "following_url": "https://api.github.com/users/thedrow/following{/other_user}", "gists_url": "https://api.github.com/users/thedrow/gists{/gist_id}", "starred_url": "https://api.github.com/users/thedrow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thedrow/subscriptions", "organizations_url": "https://api.github.com/users/thedrow/orgs", "repos_url": "https://api.github.com/users/thedrow/repos", "events_url": "https://api.github.com/users/thedrow/events{/privacy}", "received_events_url": "https://api.github.com/users/thedrow/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2014-08-10T15:37:17Z", "updated_at": "2014-08-12T16:08:05Z", "closed_at": "2014-08-12T14:02:22Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/730/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/730/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/729", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/729/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/729/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/729/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/729", "id": 39910022, "node_id": "MDU6SXNzdWUzOTkxMDAyMg==", "number": 729, "title": "Benchmarks fail on PyPy3", "user": {"login": "thedrow", "id": 48936, "node_id": "MDQ6VXNlcjQ4OTM2", "avatar_url": "https://avatars.githubusercontent.com/u/48936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thedrow", "html_url": "https://github.com/thedrow", "followers_url": "https://api.github.com/users/thedrow/followers", "following_url": "https://api.github.com/users/thedrow/following{/other_user}", "gists_url": "https://api.github.com/users/thedrow/gists{/gist_id}", "starred_url": "https://api.github.com/users/thedrow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thedrow/subscriptions", "organizations_url": "https://api.github.com/users/thedrow/orgs", "repos_url": "https://api.github.com/users/thedrow/repos", "events_url": "https://api.github.com/users/thedrow/events{/privacy}", "received_events_url": "https://api.github.com/users/thedrow/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}, {"id": 92585955, "node_id": "MDU6TGFiZWw5MjU4NTk1NQ==", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Python%203.x", "name": "Python 3.x", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "thedrow", "id": 48936, "node_id": "MDQ6VXNlcjQ4OTM2", "avatar_url": "https://avatars.githubusercontent.com/u/48936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thedrow", "html_url": "https://github.com/thedrow", "followers_url": "https://api.github.com/users/thedrow/followers", "following_url": "https://api.github.com/users/thedrow/following{/other_user}", "gists_url": "https://api.github.com/users/thedrow/gists{/gist_id}", "starred_url": "https://api.github.com/users/thedrow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thedrow/subscriptions", "organizations_url": "https://api.github.com/users/thedrow/orgs", "repos_url": "https://api.github.com/users/thedrow/repos", "events_url": "https://api.github.com/users/thedrow/events{/privacy}", "received_events_url": "https://api.github.com/users/thedrow/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "thedrow", "id": 48936, "node_id": "MDQ6VXNlcjQ4OTM2", "avatar_url": "https://avatars.githubusercontent.com/u/48936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thedrow", "html_url": "https://github.com/thedrow", "followers_url": "https://api.github.com/users/thedrow/followers", "following_url": "https://api.github.com/users/thedrow/following{/other_user}", "gists_url": "https://api.github.com/users/thedrow/gists{/gist_id}", "starred_url": "https://api.github.com/users/thedrow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thedrow/subscriptions", "organizations_url": "https://api.github.com/users/thedrow/orgs", "repos_url": "https://api.github.com/users/thedrow/repos", "events_url": "https://api.github.com/users/thedrow/events{/privacy}", "received_events_url": "https://api.github.com/users/thedrow/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2014-08-10T15:32:00Z", "updated_at": "2016-12-12T02:44:25Z", "closed_at": "2016-12-12T02:44:25Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "For some reason the tests pass but the following benchmark fails:\n\n```\nCreating 10000 dictionaries - MongoEngine\n\nTraceback (most recent call last):\n\nFile \"benchmark.py\", line 283, in <module>\n\nmain()\n\nFile \"benchmark.py\", line 197, in main\n\nprint(t.timeit(1))\n\nFile \"/opt/python/pypy3-2.3.1/lib-python/3/timeit.py\", line 195, in timeit\n\ntiming = self.inner(it, self.timer)\n\nFile \"<timeit-src>\", line 9, in inner\n\nFile \"/home/travis/build/MongoEngine/mongoengine/mongoengine/__init__.py\", line 1, in <module>\n\nimport document\n\nImportError: No module named document\n```\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/729/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/729/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/723", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/723/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/723/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/723/events", "html_url": "https://github.com/MongoEngine/mongoengine/pull/723", "id": 39524351, "node_id": "MDExOlB1bGxSZXF1ZXN0MTkzNDUyNTg=", "number": 723, "title": "Fix 620", "user": {"login": "DavidBord", "id": 3276118, "node_id": "MDQ6VXNlcjMyNzYxMTg=", "avatar_url": "https://avatars.githubusercontent.com/u/3276118?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DavidBord", "html_url": "https://github.com/DavidBord", "followers_url": "https://api.github.com/users/DavidBord/followers", "following_url": "https://api.github.com/users/DavidBord/following{/other_user}", "gists_url": "https://api.github.com/users/DavidBord/gists{/gist_id}", "starred_url": "https://api.github.com/users/DavidBord/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DavidBord/subscriptions", "organizations_url": "https://api.github.com/users/DavidBord/orgs", "repos_url": "https://api.github.com/users/DavidBord/repos", "events_url": "https://api.github.com/users/DavidBord/events{/privacy}", "received_events_url": "https://api.github.com/users/DavidBord/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "yograterol", "id": 3322886, "node_id": "MDQ6VXNlcjMzMjI4ODY=", "avatar_url": "https://avatars.githubusercontent.com/u/3322886?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yograterol", "html_url": "https://github.com/yograterol", "followers_url": "https://api.github.com/users/yograterol/followers", "following_url": "https://api.github.com/users/yograterol/following{/other_user}", "gists_url": "https://api.github.com/users/yograterol/gists{/gist_id}", "starred_url": "https://api.github.com/users/yograterol/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yograterol/subscriptions", "organizations_url": "https://api.github.com/users/yograterol/orgs", "repos_url": "https://api.github.com/users/yograterol/repos", "events_url": "https://api.github.com/users/yograterol/events{/privacy}", "received_events_url": "https://api.github.com/users/yograterol/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "yograterol", "id": 3322886, "node_id": "MDQ6VXNlcjMzMjI4ODY=", "avatar_url": "https://avatars.githubusercontent.com/u/3322886?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yograterol", "html_url": "https://github.com/yograterol", "followers_url": "https://api.github.com/users/yograterol/followers", "following_url": "https://api.github.com/users/yograterol/following{/other_user}", "gists_url": "https://api.github.com/users/yograterol/gists{/gist_id}", "starred_url": "https://api.github.com/users/yograterol/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yograterol/subscriptions", "organizations_url": "https://api.github.com/users/yograterol/orgs", "repos_url": "https://api.github.com/users/yograterol/repos", "events_url": "https://api.github.com/users/yograterol/events{/privacy}", "received_events_url": "https://api.github.com/users/yograterol/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2014-08-05T14:30:30Z", "updated_at": "2014-08-06T19:13:27Z", "closed_at": "2014-08-06T06:53:28Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/pulls/723", "html_url": "https://github.com/MongoEngine/mongoengine/pull/723", "diff_url": "https://github.com/MongoEngine/mongoengine/pull/723.diff", "patch_url": "https://github.com/MongoEngine/mongoengine/pull/723.patch", "merged_at": "2014-08-06T06:53:28Z"}, "body": "Done on top of #399\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/723/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/723/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/721", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/721/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/721/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/721/events", "html_url": "https://github.com/MongoEngine/mongoengine/pull/721", "id": 39393577, "node_id": "MDExOlB1bGxSZXF1ZXN0MTkyNjY2NjQ=", "number": 721, "title": "fix-#399: Not overriding default values when loading a subset of fields", "user": {"login": "DavidBord", "id": 3276118, "node_id": "MDQ6VXNlcjMyNzYxMTg=", "avatar_url": "https://avatars.githubusercontent.com/u/3276118?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DavidBord", "html_url": "https://github.com/DavidBord", "followers_url": "https://api.github.com/users/DavidBord/followers", "following_url": "https://api.github.com/users/DavidBord/following{/other_user}", "gists_url": "https://api.github.com/users/DavidBord/gists{/gist_id}", "starred_url": "https://api.github.com/users/DavidBord/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DavidBord/subscriptions", "organizations_url": "https://api.github.com/users/DavidBord/orgs", "repos_url": "https://api.github.com/users/DavidBord/repos", "events_url": "https://api.github.com/users/DavidBord/events{/privacy}", "received_events_url": "https://api.github.com/users/DavidBord/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "yograterol", "id": 3322886, "node_id": "MDQ6VXNlcjMzMjI4ODY=", "avatar_url": "https://avatars.githubusercontent.com/u/3322886?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yograterol", "html_url": "https://github.com/yograterol", "followers_url": "https://api.github.com/users/yograterol/followers", "following_url": "https://api.github.com/users/yograterol/following{/other_user}", "gists_url": "https://api.github.com/users/yograterol/gists{/gist_id}", "starred_url": "https://api.github.com/users/yograterol/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yograterol/subscriptions", "organizations_url": "https://api.github.com/users/yograterol/orgs", "repos_url": "https://api.github.com/users/yograterol/repos", "events_url": "https://api.github.com/users/yograterol/events{/privacy}", "received_events_url": "https://api.github.com/users/yograterol/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "yograterol", "id": 3322886, "node_id": "MDQ6VXNlcjMzMjI4ODY=", "avatar_url": "https://avatars.githubusercontent.com/u/3322886?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yograterol", "html_url": "https://github.com/yograterol", "followers_url": "https://api.github.com/users/yograterol/followers", "following_url": "https://api.github.com/users/yograterol/following{/other_user}", "gists_url": "https://api.github.com/users/yograterol/gists{/gist_id}", "starred_url": "https://api.github.com/users/yograterol/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yograterol/subscriptions", "organizations_url": "https://api.github.com/users/yograterol/orgs", "repos_url": "https://api.github.com/users/yograterol/repos", "events_url": "https://api.github.com/users/yograterol/events{/privacy}", "received_events_url": "https://api.github.com/users/yograterol/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/6", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/6", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/6/labels", "id": 232471, "node_id": "MDk6TWlsZXN0b25lMjMyNDcx", "number": 6, "title": "0.9", "description": "", "creator": {"login": "rozza", "id": 420, "node_id": "MDQ6VXNlcjQyMA==", "avatar_url": "https://avatars.githubusercontent.com/u/420?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rozza", "html_url": "https://github.com/rozza", "followers_url": "https://api.github.com/users/rozza/followers", "following_url": "https://api.github.com/users/rozza/following{/other_user}", "gists_url": "https://api.github.com/users/rozza/gists{/gist_id}", "starred_url": "https://api.github.com/users/rozza/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rozza/subscriptions", "organizations_url": "https://api.github.com/users/rozza/orgs", "repos_url": "https://api.github.com/users/rozza/repos", "events_url": "https://api.github.com/users/rozza/events{/privacy}", "received_events_url": "https://api.github.com/users/rozza/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 52, "state": "closed", "created_at": "2012-12-19T11:42:10Z", "updated_at": "2015-05-06T18:53:03Z", "due_on": "2014-04-01T07:00:00Z", "closed_at": "2015-05-06T18:53:03Z"}, "comments": 2, "created_at": "2014-08-04T06:23:51Z", "updated_at": "2014-08-06T06:51:58Z", "closed_at": "2014-08-06T06:51:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/pulls/721", "html_url": "https://github.com/MongoEngine/mongoengine/pull/721", "diff_url": "https://github.com/MongoEngine/mongoengine/pull/721.diff", "patch_url": "https://github.com/MongoEngine/mongoengine/pull/721.patch", "merged_at": null}, "body": "", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/721/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/721/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/716", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/716/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/716/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/716/events", "html_url": "https://github.com/MongoEngine/mongoengine/pull/716", "id": 38968939, "node_id": "MDExOlB1bGxSZXF1ZXN0MTkwMTQzNTc=", "number": 716, "title": "change:fix alias overridden by for loop variable bug", "user": {"login": "weiweiwang", "id": 822994, "node_id": "MDQ6VXNlcjgyMjk5NA==", "avatar_url": "https://avatars.githubusercontent.com/u/822994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/weiweiwang", "html_url": "https://github.com/weiweiwang", "followers_url": "https://api.github.com/users/weiweiwang/followers", "following_url": "https://api.github.com/users/weiweiwang/following{/other_user}", "gists_url": "https://api.github.com/users/weiweiwang/gists{/gist_id}", "starred_url": "https://api.github.com/users/weiweiwang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/weiweiwang/subscriptions", "organizations_url": "https://api.github.com/users/weiweiwang/orgs", "repos_url": "https://api.github.com/users/weiweiwang/repos", "events_url": "https://api.github.com/users/weiweiwang/events{/privacy}", "received_events_url": "https://api.github.com/users/weiweiwang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "thedrow", "id": 48936, "node_id": "MDQ6VXNlcjQ4OTM2", "avatar_url": "https://avatars.githubusercontent.com/u/48936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thedrow", "html_url": "https://github.com/thedrow", "followers_url": "https://api.github.com/users/thedrow/followers", "following_url": "https://api.github.com/users/thedrow/following{/other_user}", "gists_url": "https://api.github.com/users/thedrow/gists{/gist_id}", "starred_url": "https://api.github.com/users/thedrow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thedrow/subscriptions", "organizations_url": "https://api.github.com/users/thedrow/orgs", "repos_url": "https://api.github.com/users/thedrow/repos", "events_url": "https://api.github.com/users/thedrow/events{/privacy}", "received_events_url": "https://api.github.com/users/thedrow/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "thedrow", "id": 48936, "node_id": "MDQ6VXNlcjQ4OTM2", "avatar_url": "https://avatars.githubusercontent.com/u/48936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thedrow", "html_url": "https://github.com/thedrow", "followers_url": "https://api.github.com/users/thedrow/followers", "following_url": "https://api.github.com/users/thedrow/following{/other_user}", "gists_url": "https://api.github.com/users/thedrow/gists{/gist_id}", "starred_url": "https://api.github.com/users/thedrow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thedrow/subscriptions", "organizations_url": "https://api.github.com/users/thedrow/orgs", "repos_url": "https://api.github.com/users/thedrow/repos", "events_url": "https://api.github.com/users/thedrow/events{/privacy}", "received_events_url": "https://api.github.com/users/thedrow/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/6", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/6", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/6/labels", "id": 232471, "node_id": "MDk6TWlsZXN0b25lMjMyNDcx", "number": 6, "title": "0.9", "description": "", "creator": {"login": "rozza", "id": 420, "node_id": "MDQ6VXNlcjQyMA==", "avatar_url": "https://avatars.githubusercontent.com/u/420?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rozza", "html_url": "https://github.com/rozza", "followers_url": "https://api.github.com/users/rozza/followers", "following_url": "https://api.github.com/users/rozza/following{/other_user}", "gists_url": "https://api.github.com/users/rozza/gists{/gist_id}", "starred_url": "https://api.github.com/users/rozza/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rozza/subscriptions", "organizations_url": "https://api.github.com/users/rozza/orgs", "repos_url": "https://api.github.com/users/rozza/repos", "events_url": "https://api.github.com/users/rozza/events{/privacy}", "received_events_url": "https://api.github.com/users/rozza/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 52, "state": "closed", "created_at": "2012-12-19T11:42:10Z", "updated_at": "2015-05-06T18:53:03Z", "due_on": "2014-04-01T07:00:00Z", "closed_at": "2015-05-06T18:53:03Z"}, "comments": 1, "created_at": "2014-07-29T08:46:04Z", "updated_at": "2014-11-04T16:28:18Z", "closed_at": "2014-11-04T16:28:16Z", "author_association": "NONE", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/pulls/716", "html_url": "https://github.com/MongoEngine/mongoengine/pull/716", "diff_url": "https://github.com/MongoEngine/mongoengine/pull/716.diff", "patch_url": "https://github.com/MongoEngine/mongoengine/pull/716.patch", "merged_at": null}, "body": "alias variable is overridden by for loop variable with the same name, wich cause chaos in mongo connections \n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/716/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/716/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/714", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/714/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/714/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/714/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/714", "id": 38879107, "node_id": "MDU6SXNzdWUzODg3OTEwNw==", "number": 714, "title": "New FileFields create the files but appear as None", "user": {"login": "balkian", "id": 213135, "node_id": "MDQ6VXNlcjIxMzEzNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/213135?v=4", "gravatar_id": "", "url": "https://api.github.com/users/balkian", "html_url": "https://github.com/balkian", "followers_url": "https://api.github.com/users/balkian/followers", "following_url": "https://api.github.com/users/balkian/following{/other_user}", "gists_url": "https://api.github.com/users/balkian/gists{/gist_id}", "starred_url": "https://api.github.com/users/balkian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/balkian/subscriptions", "organizations_url": "https://api.github.com/users/balkian/orgs", "repos_url": "https://api.github.com/users/balkian/repos", "events_url": "https://api.github.com/users/balkian/events{/privacy}", "received_events_url": "https://api.github.com/users/balkian/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "thedrow", "id": 48936, "node_id": "MDQ6VXNlcjQ4OTM2", "avatar_url": "https://avatars.githubusercontent.com/u/48936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thedrow", "html_url": "https://github.com/thedrow", "followers_url": "https://api.github.com/users/thedrow/followers", "following_url": "https://api.github.com/users/thedrow/following{/other_user}", "gists_url": "https://api.github.com/users/thedrow/gists{/gist_id}", "starred_url": "https://api.github.com/users/thedrow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thedrow/subscriptions", "organizations_url": "https://api.github.com/users/thedrow/orgs", "repos_url": "https://api.github.com/users/thedrow/repos", "events_url": "https://api.github.com/users/thedrow/events{/privacy}", "received_events_url": "https://api.github.com/users/thedrow/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "thedrow", "id": 48936, "node_id": "MDQ6VXNlcjQ4OTM2", "avatar_url": "https://avatars.githubusercontent.com/u/48936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thedrow", "html_url": "https://github.com/thedrow", "followers_url": "https://api.github.com/users/thedrow/followers", "following_url": "https://api.github.com/users/thedrow/following{/other_user}", "gists_url": "https://api.github.com/users/thedrow/gists{/gist_id}", "starred_url": "https://api.github.com/users/thedrow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thedrow/subscriptions", "organizations_url": "https://api.github.com/users/thedrow/orgs", "repos_url": "https://api.github.com/users/thedrow/repos", "events_url": "https://api.github.com/users/thedrow/events{/privacy}", "received_events_url": "https://api.github.com/users/thedrow/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/6", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/6", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/6/labels", "id": 232471, "node_id": "MDk6TWlsZXN0b25lMjMyNDcx", "number": 6, "title": "0.9", "description": "", "creator": {"login": "rozza", "id": 420, "node_id": "MDQ6VXNlcjQyMA==", "avatar_url": "https://avatars.githubusercontent.com/u/420?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rozza", "html_url": "https://github.com/rozza", "followers_url": "https://api.github.com/users/rozza/followers", "following_url": "https://api.github.com/users/rozza/following{/other_user}", "gists_url": "https://api.github.com/users/rozza/gists{/gist_id}", "starred_url": "https://api.github.com/users/rozza/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rozza/subscriptions", "organizations_url": "https://api.github.com/users/rozza/orgs", "repos_url": "https://api.github.com/users/rozza/repos", "events_url": "https://api.github.com/users/rozza/events{/privacy}", "received_events_url": "https://api.github.com/users/rozza/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 52, "state": "closed", "created_at": "2012-12-19T11:42:10Z", "updated_at": "2015-05-06T18:53:03Z", "due_on": "2014-04-01T07:00:00Z", "closed_at": "2015-05-06T18:53:03Z"}, "comments": 5, "created_at": "2014-07-28T10:45:34Z", "updated_at": "2015-03-23T13:46:32Z", "closed_at": "2015-03-23T13:46:31Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When [streaming a new file](http://docs.mongoengine.org/guide/gridfs.html#streaming) the gridfs file is written to mongodb, but the FileField is still set to None.\n\nThe workaround now is to delete the object before writing to it.\n\nA quick solution would be to mark the field as changed when [creating the new file](https://github.com/MongoEngine/mongoengine/blob/master/mongoengine/fields.py#L1156) as follows:\n\n``` python\n    def new_file(self, **kwargs):\n        self.newfile = self.fs.new_file(**kwargs)\n        self.grid_id = self.newfile._id\n        self._mark_as_changed()\n```\n\nOr, better yet, just set grid_id as a property and run _mark_as_changed automatically.\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/714/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/714/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/712", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/712/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/712/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/712/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/712", "id": 38830329, "node_id": "MDU6SXNzdWUzODgzMDMyOQ==", "number": 712, "title": "InvalidId is thrown on iterating", "user": {"login": "thedug", "id": 158122, "node_id": "MDQ6VXNlcjE1ODEyMg==", "avatar_url": "https://avatars.githubusercontent.com/u/158122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thedug", "html_url": "https://github.com/thedug", "followers_url": "https://api.github.com/users/thedug/followers", "following_url": "https://api.github.com/users/thedug/following{/other_user}", "gists_url": "https://api.github.com/users/thedug/gists{/gist_id}", "starred_url": "https://api.github.com/users/thedug/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thedug/subscriptions", "organizations_url": "https://api.github.com/users/thedug/orgs", "repos_url": "https://api.github.com/users/thedug/repos", "events_url": "https://api.github.com/users/thedug/events{/privacy}", "received_events_url": "https://api.github.com/users/thedug/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/17", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/17", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/17/labels", "id": 1098863, "node_id": "MDk6TWlsZXN0b25lMTA5ODg2Mw==", "number": 17, "title": "0.10", "description": "", "creator": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 37, "state": "closed", "created_at": "2015-05-06T16:17:07Z", "updated_at": "2015-06-26T08:50:24Z", "due_on": "2015-06-20T07:00:00Z", "closed_at": "2015-06-24T08:21:08Z"}, "comments": 8, "created_at": "2014-07-27T01:49:14Z", "updated_at": "2015-06-14T21:31:59Z", "closed_at": "2015-06-14T21:31:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "When iterating a cursor if an object is encountered with a bad reference then the entire cursor blows up and in my case the ObjectId is empty string.\n\nHere's the source:\nbson/objectid.py, line 196, in __validate\nraise InvalidId(\"%s is not a valid ObjectId\" % oid)\n\n1) It would be good to know the field name of this reference field\n2) It would be nice if \"\" would result in a None reference rather than blowing up.\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/712/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/712/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/711", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/711/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/711/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/711/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/711", "id": 38825391, "node_id": "MDU6SXNzdWUzODgyNTM5MQ==", "number": 711, "title": "MongoUserManager.get_query_set method should be renamed get_queryset.", "user": {"login": "foodaemon", "id": 4949414, "node_id": "MDQ6VXNlcjQ5NDk0MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4949414?v=4", "gravatar_id": "", "url": "https://api.github.com/users/foodaemon", "html_url": "https://github.com/foodaemon", "followers_url": "https://api.github.com/users/foodaemon/followers", "following_url": "https://api.github.com/users/foodaemon/following{/other_user}", "gists_url": "https://api.github.com/users/foodaemon/gists{/gist_id}", "starred_url": "https://api.github.com/users/foodaemon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/foodaemon/subscriptions", "organizations_url": "https://api.github.com/users/foodaemon/orgs", "repos_url": "https://api.github.com/users/foodaemon/repos", "events_url": "https://api.github.com/users/foodaemon/events{/privacy}", "received_events_url": "https://api.github.com/users/foodaemon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/6", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/6", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/6/labels", "id": 232471, "node_id": "MDk6TWlsZXN0b25lMjMyNDcx", "number": 6, "title": "0.9", "description": "", "creator": {"login": "rozza", "id": 420, "node_id": "MDQ6VXNlcjQyMA==", "avatar_url": "https://avatars.githubusercontent.com/u/420?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rozza", "html_url": "https://github.com/rozza", "followers_url": "https://api.github.com/users/rozza/followers", "following_url": "https://api.github.com/users/rozza/following{/other_user}", "gists_url": "https://api.github.com/users/rozza/gists{/gist_id}", "starred_url": "https://api.github.com/users/rozza/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rozza/subscriptions", "organizations_url": "https://api.github.com/users/rozza/orgs", "repos_url": "https://api.github.com/users/rozza/repos", "events_url": "https://api.github.com/users/rozza/events{/privacy}", "received_events_url": "https://api.github.com/users/rozza/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 52, "state": "closed", "created_at": "2012-12-19T11:42:10Z", "updated_at": "2015-05-06T18:53:03Z", "due_on": "2014-04-01T07:00:00Z", "closed_at": "2015-05-06T18:53:03Z"}, "comments": 2, "created_at": "2014-07-26T20:15:00Z", "updated_at": "2014-11-25T14:16:54Z", "closed_at": "2014-11-25T14:16:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am using django 1.7rc1 with mongodb. While trying to use mongo_auth backend, i am getting this following error:\n\nlib/python3.4/site-packages/mongoengine/django/mongo_auth/models.py:33: RemovedInDjango18Warning: `MongoUserManager.get_query_set` method should be renamed `get_queryset`.\n  class MongoUserManager(UserManager):\n\ni got around this issue by renaming the method and all its references to get_queryset. Does this causes any issues later on with the auth backend? or is this the right way to fix this?\nAny suggestions would be highly appreciated.\n\nThanks,\nRobin\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/711/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/711/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/651", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/651/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/651/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/651/events", "html_url": "https://github.com/MongoEngine/mongoengine/pull/651", "id": 34052139, "node_id": "MDExOlB1bGxSZXF1ZXN0MTYyMDE5NTg=", "number": 651, "title": "Don't use a system collection in the tests", "user": {"login": "wojcikstefan", "id": 1718372, "node_id": "MDQ6VXNlcjE3MTgzNzI=", "avatar_url": "https://avatars.githubusercontent.com/u/1718372?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wojcikstefan", "html_url": "https://github.com/wojcikstefan", "followers_url": "https://api.github.com/users/wojcikstefan/followers", "following_url": "https://api.github.com/users/wojcikstefan/following{/other_user}", "gists_url": "https://api.github.com/users/wojcikstefan/gists{/gist_id}", "starred_url": "https://api.github.com/users/wojcikstefan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wojcikstefan/subscriptions", "organizations_url": "https://api.github.com/users/wojcikstefan/orgs", "repos_url": "https://api.github.com/users/wojcikstefan/repos", "events_url": "https://api.github.com/users/wojcikstefan/events{/privacy}", "received_events_url": "https://api.github.com/users/wojcikstefan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "yograterol", "id": 3322886, "node_id": "MDQ6VXNlcjMzMjI4ODY=", "avatar_url": "https://avatars.githubusercontent.com/u/3322886?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yograterol", "html_url": "https://github.com/yograterol", "followers_url": "https://api.github.com/users/yograterol/followers", "following_url": "https://api.github.com/users/yograterol/following{/other_user}", "gists_url": "https://api.github.com/users/yograterol/gists{/gist_id}", "starred_url": "https://api.github.com/users/yograterol/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yograterol/subscriptions", "organizations_url": "https://api.github.com/users/yograterol/orgs", "repos_url": "https://api.github.com/users/yograterol/repos", "events_url": "https://api.github.com/users/yograterol/events{/privacy}", "received_events_url": "https://api.github.com/users/yograterol/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "yograterol", "id": 3322886, "node_id": "MDQ6VXNlcjMzMjI4ODY=", "avatar_url": "https://avatars.githubusercontent.com/u/3322886?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yograterol", "html_url": "https://github.com/yograterol", "followers_url": "https://api.github.com/users/yograterol/followers", "following_url": "https://api.github.com/users/yograterol/following{/other_user}", "gists_url": "https://api.github.com/users/yograterol/gists{/gist_id}", "starred_url": "https://api.github.com/users/yograterol/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yograterol/subscriptions", "organizations_url": "https://api.github.com/users/yograterol/orgs", "repos_url": "https://api.github.com/users/yograterol/repos", "events_url": "https://api.github.com/users/yograterol/events{/privacy}", "received_events_url": "https://api.github.com/users/yograterol/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/6", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/6", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/6/labels", "id": 232471, "node_id": "MDk6TWlsZXN0b25lMjMyNDcx", "number": 6, "title": "0.9", "description": "", "creator": {"login": "rozza", "id": 420, "node_id": "MDQ6VXNlcjQyMA==", "avatar_url": "https://avatars.githubusercontent.com/u/420?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rozza", "html_url": "https://github.com/rozza", "followers_url": "https://api.github.com/users/rozza/followers", "following_url": "https://api.github.com/users/rozza/following{/other_user}", "gists_url": "https://api.github.com/users/rozza/gists{/gist_id}", "starred_url": "https://api.github.com/users/rozza/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rozza/subscriptions", "organizations_url": "https://api.github.com/users/rozza/orgs", "repos_url": "https://api.github.com/users/rozza/repos", "events_url": "https://api.github.com/users/rozza/events{/privacy}", "received_events_url": "https://api.github.com/users/rozza/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 52, "state": "closed", "created_at": "2012-12-19T11:42:10Z", "updated_at": "2015-05-06T18:53:03Z", "due_on": "2014-04-01T07:00:00Z", "closed_at": "2015-05-06T18:53:03Z"}, "comments": 2, "created_at": "2014-05-22T05:23:42Z", "updated_at": "2014-06-25T14:48:30Z", "closed_at": "2014-06-25T14:48:30Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/pulls/651", "html_url": "https://github.com/MongoEngine/mongoengine/pull/651", "diff_url": "https://github.com/MongoEngine/mongoengine/pull/651.diff", "patch_url": "https://github.com/MongoEngine/mongoengine/pull/651.patch", "merged_at": "2014-06-25T14:48:30Z"}, "body": "This PR simply renames one document class, which is used in the tests. It was causing a crash on mongod 2.6.1.\n\nSee https://jira.mongodb.org/browse/SERVER-13975 for more details.\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/651/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/651/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/636", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/636/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/636/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/636/events", "html_url": "https://github.com/MongoEngine/mongoengine/pull/636", "id": 32885578, "node_id": "MDExOlB1bGxSZXF1ZXN0MTU1MzY2NTc=", "number": 636, "title": "Using the id field as shard key doesn't set the id of the Document when first created", "user": {"login": "ronaldvanrij", "id": 1950914, "node_id": "MDQ6VXNlcjE5NTA5MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1950914?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronaldvanrij", "html_url": "https://github.com/ronaldvanrij", "followers_url": "https://api.github.com/users/ronaldvanrij/followers", "following_url": "https://api.github.com/users/ronaldvanrij/following{/other_user}", "gists_url": "https://api.github.com/users/ronaldvanrij/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronaldvanrij/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronaldvanrij/subscriptions", "organizations_url": "https://api.github.com/users/ronaldvanrij/orgs", "repos_url": "https://api.github.com/users/ronaldvanrij/repos", "events_url": "https://api.github.com/users/ronaldvanrij/events{/privacy}", "received_events_url": "https://api.github.com/users/ronaldvanrij/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/6", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/6", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/6/labels", "id": 232471, "node_id": "MDk6TWlsZXN0b25lMjMyNDcx", "number": 6, "title": "0.9", "description": "", "creator": {"login": "rozza", "id": 420, "node_id": "MDQ6VXNlcjQyMA==", "avatar_url": "https://avatars.githubusercontent.com/u/420?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rozza", "html_url": "https://github.com/rozza", "followers_url": "https://api.github.com/users/rozza/followers", "following_url": "https://api.github.com/users/rozza/following{/other_user}", "gists_url": "https://api.github.com/users/rozza/gists{/gist_id}", "starred_url": "https://api.github.com/users/rozza/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rozza/subscriptions", "organizations_url": "https://api.github.com/users/rozza/orgs", "repos_url": "https://api.github.com/users/rozza/repos", "events_url": "https://api.github.com/users/rozza/events{/privacy}", "received_events_url": "https://api.github.com/users/rozza/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 52, "state": "closed", "created_at": "2012-12-19T11:42:10Z", "updated_at": "2015-05-06T18:53:03Z", "due_on": "2014-04-01T07:00:00Z", "closed_at": "2015-05-06T18:53:03Z"}, "comments": 1, "created_at": "2014-05-06T11:53:52Z", "updated_at": "2014-06-27T08:31:33Z", "closed_at": "2014-06-27T08:31:33Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/pulls/636", "html_url": "https://github.com/MongoEngine/mongoengine/pull/636", "diff_url": "https://github.com/MongoEngine/mongoengine/pull/636.diff", "patch_url": "https://github.com/MongoEngine/mongoengine/pull/636.patch", "merged_at": "2014-06-27T08:31:33Z"}, "body": "Test case:\n\n```\nclass Animal(Document):\n    name = StringField()\n    meta = {'shard_key': ('id', )}\n\ndog = Animal()\ndog.save()\ndog.id == None\n>> True\n```\n\nThe item itself is in fact saved to MongoDB and does contain a valid id, however this id is not being set onto the MongoEngine Document when save() returns. \nIn the following example we're referencing the animals from their sharded collection using a ReferenceField. As such the animal's id is required to save the referencing Zoo Document:\n\n```\nclass Zoo(Document):\n    animals = ListField(ReferenceField(Animal))\nzoo = Zoo(animals=[dog])\nzoo.save()\n>> ValidationError: ValidationError (Zoo:None) (You can only reference documents once they have been saved to the database: ['animals'])\n```\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/636/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/636/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/635", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/635/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/635/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/635/events", "html_url": "https://github.com/MongoEngine/mongoengine/pull/635", "id": 32880845, "node_id": "MDExOlB1bGxSZXF1ZXN0MTU1MzQwMjE=", "number": 635, "title": "Fix for post_init signal to receive correct state of _created flag.", "user": {"login": "SergeChmelev", "id": 7498495, "node_id": "MDQ6VXNlcjc0OTg0OTU=", "avatar_url": "https://avatars.githubusercontent.com/u/7498495?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SergeChmelev", "html_url": "https://github.com/SergeChmelev", "followers_url": "https://api.github.com/users/SergeChmelev/followers", "following_url": "https://api.github.com/users/SergeChmelev/following{/other_user}", "gists_url": "https://api.github.com/users/SergeChmelev/gists{/gist_id}", "starred_url": "https://api.github.com/users/SergeChmelev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SergeChmelev/subscriptions", "organizations_url": "https://api.github.com/users/SergeChmelev/orgs", "repos_url": "https://api.github.com/users/SergeChmelev/repos", "events_url": "https://api.github.com/users/SergeChmelev/events{/privacy}", "received_events_url": "https://api.github.com/users/SergeChmelev/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/6", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/6", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/6/labels", "id": 232471, "node_id": "MDk6TWlsZXN0b25lMjMyNDcx", "number": 6, "title": "0.9", "description": "", "creator": {"login": "rozza", "id": 420, "node_id": "MDQ6VXNlcjQyMA==", "avatar_url": "https://avatars.githubusercontent.com/u/420?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rozza", "html_url": "https://github.com/rozza", "followers_url": "https://api.github.com/users/rozza/followers", "following_url": "https://api.github.com/users/rozza/following{/other_user}", "gists_url": "https://api.github.com/users/rozza/gists{/gist_id}", "starred_url": "https://api.github.com/users/rozza/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rozza/subscriptions", "organizations_url": "https://api.github.com/users/rozza/orgs", "repos_url": "https://api.github.com/users/rozza/repos", "events_url": "https://api.github.com/users/rozza/events{/privacy}", "received_events_url": "https://api.github.com/users/rozza/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 52, "state": "closed", "created_at": "2012-12-19T11:42:10Z", "updated_at": "2015-05-06T18:53:03Z", "due_on": "2014-04-01T07:00:00Z", "closed_at": "2015-05-06T18:53:03Z"}, "comments": 11, "created_at": "2014-05-06T10:31:38Z", "updated_at": "2014-07-03T11:51:15Z", "closed_at": "2014-07-02T23:38:52Z", "author_association": "NONE", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/pulls/635", "html_url": "https://github.com/MongoEngine/mongoengine/pull/635", "diff_url": "https://github.com/MongoEngine/mongoengine/pull/635.diff", "patch_url": "https://github.com/MongoEngine/mongoengine/pull/635.patch", "merged_at": "2014-07-02T23:38:52Z"}, "body": "Working on automated audittrail extension to Mongoengine faced a problem with base.Document._created flag, if use post_init signal  it always accepts document with _created=True(since we always use constructor for documents), which is not the desired behaviour if we load Document from DB.    \n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/635/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/635/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/630", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/630/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/630/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/630/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/630", "id": 32037791, "node_id": "MDU6SXNzdWUzMjAzNzc5MQ==", "number": 630, "title": "MultipleObjectsReturned: 1 items returned, instead of 1", "user": {"login": "socrateslee", "id": 90537, "node_id": "MDQ6VXNlcjkwNTM3", "avatar_url": "https://avatars.githubusercontent.com/u/90537?v=4", "gravatar_id": "", "url": "https://api.github.com/users/socrateslee", "html_url": "https://github.com/socrateslee", "followers_url": "https://api.github.com/users/socrateslee/followers", "following_url": "https://api.github.com/users/socrateslee/following{/other_user}", "gists_url": "https://api.github.com/users/socrateslee/gists{/gist_id}", "starred_url": "https://api.github.com/users/socrateslee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/socrateslee/subscriptions", "organizations_url": "https://api.github.com/users/socrateslee/orgs", "repos_url": "https://api.github.com/users/socrateslee/repos", "events_url": "https://api.github.com/users/socrateslee/events{/privacy}", "received_events_url": "https://api.github.com/users/socrateslee/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/15", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/15", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/15/labels", "id": 500350, "node_id": "MDk6TWlsZXN0b25lNTAwMzUw", "number": 15, "title": "Needs More Information", "description": "", "creator": {"login": "rozza", "id": 420, "node_id": "MDQ6VXNlcjQyMA==", "avatar_url": "https://avatars.githubusercontent.com/u/420?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rozza", "html_url": "https://github.com/rozza", "followers_url": "https://api.github.com/users/rozza/followers", "following_url": "https://api.github.com/users/rozza/following{/other_user}", "gists_url": "https://api.github.com/users/rozza/gists{/gist_id}", "starred_url": "https://api.github.com/users/rozza/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rozza/subscriptions", "organizations_url": "https://api.github.com/users/rozza/orgs", "repos_url": "https://api.github.com/users/rozza/repos", "events_url": "https://api.github.com/users/rozza/events{/privacy}", "received_events_url": "https://api.github.com/users/rozza/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 13, "state": "open", "created_at": "2013-11-29T09:16:49Z", "updated_at": "2020-04-08T19:28:56Z", "due_on": null, "closed_at": null}, "comments": 9, "created_at": "2014-04-23T07:18:02Z", "updated_at": "2020-04-08T19:28:56Z", "closed_at": "2020-04-08T19:28:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have occasionally got the error, I use uwsgi(4 threads) with django.\n\nThe case I occurred the error is very simple:\n\n```\nobj = SomeDocument.objects.filter(user_id=xxx).get()\nif not obj:\n    obj = SomeDocument(...)\n    obj.save()\n```\n\nAnd when I look up the document(I have logged the id), there is no duplicated entry, and I can  not reproduce the exception. Normally, if there existed more than one results match user_id=xxx, we should have\n\n```\n  MultipleObjectsReturned: 2 items returned, instead of 1\n```\n\nbut \n\n```\n MultipleObjectsReturned: 1 items returned, instead of 1\n```\n\nis quite weird, since there is only one match. I am aware that before raising the exception in QuerySet.get, the code called .rewind() and .count() to form a exception message,  so there may a case if remove a duplicate entry causing the exception message inconsistent. But I have no code removing SomeDocument instances.\n\nIs there anybody happen to occur the error?  How could this happened.\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/630/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/630/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/628", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/628/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/628/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/628/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/628", "id": 31533873, "node_id": "MDU6SXNzdWUzMTUzMzg3Mw==", "number": 628, "title": "Add entity oid to traceback", "user": {"login": "osimicek", "id": 1182965, "node_id": "MDQ6VXNlcjExODI5NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1182965?v=4", "gravatar_id": "", "url": "https://api.github.com/users/osimicek", "html_url": "https://github.com/osimicek", "followers_url": "https://api.github.com/users/osimicek/followers", "following_url": "https://api.github.com/users/osimicek/following{/other_user}", "gists_url": "https://api.github.com/users/osimicek/gists{/gist_id}", "starred_url": "https://api.github.com/users/osimicek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/osimicek/subscriptions", "organizations_url": "https://api.github.com/users/osimicek/orgs", "repos_url": "https://api.github.com/users/osimicek/repos", "events_url": "https://api.github.com/users/osimicek/events{/privacy}", "received_events_url": "https://api.github.com/users/osimicek/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/14", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/14", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/14/labels", "id": 500346, "node_id": "MDk6TWlsZXN0b25lNTAwMzQ2", "number": 14, "title": "0.8.x", "description": "", "creator": {"login": "rozza", "id": 420, "node_id": "MDQ6VXNlcjQyMA==", "avatar_url": "https://avatars.githubusercontent.com/u/420?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rozza", "html_url": "https://github.com/rozza", "followers_url": "https://api.github.com/users/rozza/followers", "following_url": "https://api.github.com/users/rozza/following{/other_user}", "gists_url": "https://api.github.com/users/rozza/gists{/gist_id}", "starred_url": "https://api.github.com/users/rozza/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rozza/subscriptions", "organizations_url": "https://api.github.com/users/rozza/orgs", "repos_url": "https://api.github.com/users/rozza/repos", "events_url": "https://api.github.com/users/rozza/events{/privacy}", "received_events_url": "https://api.github.com/users/rozza/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 6, "state": "closed", "created_at": "2013-11-29T09:07:13Z", "updated_at": "2015-05-06T18:53:00Z", "due_on": "2014-02-28T08:00:00Z", "closed_at": "2015-05-06T18:53:00Z"}, "comments": 7, "created_at": "2014-04-15T08:16:49Z", "updated_at": "2014-12-09T09:49:08Z", "closed_at": "2014-12-09T09:48:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\nI use mongoengine and rockmongo to manage my MongoDB. Sometimes in rockmongo I make a mistake and fill attribute with empty string \"\" instead of oid. \nThen I get this error:\n\n```\nFile \"/home/vagrant/.virtualenvs/shop-demo/lib/python2.7/site-packages/mongoengine/queryset/queryset.py\", line 81, in _iter_results\nself._populate_cache()\nFile \"/home/vagrant/.virtualenvs/shop-demo/lib/python2.7/site-packages/mongoengine/queryset/queryset.py\", line 93, in _populate_cache\nself._result_cache.append(self.next())\nFile \"/home/vagrant/.virtualenvs/shop-demo/lib/python2.7/site-packages/mongoengine/queryset/base.py\", line 1141, in next\n_auto_dereference=self._auto_dereference)\nFile \"/home/vagrant/.virtualenvs/shop-demo/lib/python2.7/site-packages/mongoengine/base/document.py\", line 570, in _from_son\nelse field.to_python(value))\nFile \"/home/vagrant/.virtualenvs/shop-demo/lib/python2.7/site-packages/mongoengine/base/fields.py\", line 392, in to_python\nvalue = ObjectId(value)\nFile \"/home/vagrant/.virtualenvs/shop-demo/lib/python2.7/site-packages/bson/objectid.py\", line 92, in __init__\nself.__validate(oid)\nFile \"/home/vagrant/.virtualenvs/shop-demo/lib/python2.7/site-packages/bson/objectid.py\", line 196, in __validate\nraise InvalidId(\"%s is not a valid ObjectId\" % oid)\n```\n\nThe traceback is useful but I\u00b4m not able to track down which entity causes this. Is there any chance to add to traceback an information about entity that is processed (oid or dict repr.)?\n\nThanks for answer.\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/628/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/628/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/619", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/619/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/619/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/619/events", "html_url": "https://github.com/MongoEngine/mongoengine/pull/619", "id": 30593007, "node_id": "MDExOlB1bGxSZXF1ZXN0MTQyMjMzMjE=", "number": 619, "title": "Fixed incorrectly split a query key, when it ends with \"_\"", "user": {"login": "polyrabbit", "id": 2657334, "node_id": "MDQ6VXNlcjI2NTczMzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2657334?v=4", "gravatar_id": "", "url": "https://api.github.com/users/polyrabbit", "html_url": "https://github.com/polyrabbit", "followers_url": "https://api.github.com/users/polyrabbit/followers", "following_url": "https://api.github.com/users/polyrabbit/following{/other_user}", "gists_url": "https://api.github.com/users/polyrabbit/gists{/gist_id}", "starred_url": "https://api.github.com/users/polyrabbit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/polyrabbit/subscriptions", "organizations_url": "https://api.github.com/users/polyrabbit/orgs", "repos_url": "https://api.github.com/users/polyrabbit/repos", "events_url": "https://api.github.com/users/polyrabbit/events{/privacy}", "received_events_url": "https://api.github.com/users/polyrabbit/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/6", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/6", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/6/labels", "id": 232471, "node_id": "MDk6TWlsZXN0b25lMjMyNDcx", "number": 6, "title": "0.9", "description": "", "creator": {"login": "rozza", "id": 420, "node_id": "MDQ6VXNlcjQyMA==", "avatar_url": "https://avatars.githubusercontent.com/u/420?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rozza", "html_url": "https://github.com/rozza", "followers_url": "https://api.github.com/users/rozza/followers", "following_url": "https://api.github.com/users/rozza/following{/other_user}", "gists_url": "https://api.github.com/users/rozza/gists{/gist_id}", "starred_url": "https://api.github.com/users/rozza/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rozza/subscriptions", "organizations_url": "https://api.github.com/users/rozza/orgs", "repos_url": "https://api.github.com/users/rozza/repos", "events_url": "https://api.github.com/users/rozza/events{/privacy}", "received_events_url": "https://api.github.com/users/rozza/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 52, "state": "closed", "created_at": "2012-12-19T11:42:10Z", "updated_at": "2015-05-06T18:53:03Z", "due_on": "2014-04-01T07:00:00Z", "closed_at": "2015-05-06T18:53:03Z"}, "comments": 8, "created_at": "2014-04-01T12:09:57Z", "updated_at": "2014-07-02T20:17:29Z", "closed_at": "2014-06-25T15:42:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/pulls/619", "html_url": "https://github.com/MongoEngine/mongoengine/pull/619", "diff_url": "https://github.com/MongoEngine/mongoengine/pull/619.diff", "patch_url": "https://github.com/MongoEngine/mongoengine/pull/619.patch", "merged_at": "2014-06-25T15:42:27Z"}, "body": "Say we have a string field called `from_`, and we use `Q(from___contains='blah')` to query against it. However mongoengine seems to interpret this query incorrectly as it use `__` to split field and operator, which leads to `from` and `_contains` which is certainly incorrect. I believe we should use `rsplit` to split field and operator since operators are always in the right hand side.\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/619/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/619/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/618", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/618/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/618/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/618/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/618", "id": 30592186, "node_id": "MDU6SXNzdWUzMDU5MjE4Ng==", "number": 618, "title": "Wrong ObjectIdField to_mongo() and validate() methods behavior on Python 3", "user": {"login": "lig", "id": 38705, "node_id": "MDQ6VXNlcjM4NzA1", "avatar_url": "https://avatars.githubusercontent.com/u/38705?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lig", "html_url": "https://github.com/lig", "followers_url": "https://api.github.com/users/lig/followers", "following_url": "https://api.github.com/users/lig/following{/other_user}", "gists_url": "https://api.github.com/users/lig/gists{/gist_id}", "starred_url": "https://api.github.com/users/lig/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lig/subscriptions", "organizations_url": "https://api.github.com/users/lig/orgs", "repos_url": "https://api.github.com/users/lig/repos", "events_url": "https://api.github.com/users/lig/events{/privacy}", "received_events_url": "https://api.github.com/users/lig/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}, {"id": 92585955, "node_id": "MDU6TGFiZWw5MjU4NTk1NQ==", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Python%203.x", "name": "Python 3.x", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2014-04-01T11:56:02Z", "updated_at": "2018-08-19T21:51:09Z", "closed_at": "2018-08-19T21:51:09Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "ObjectIdField uses `unicode(value)` to prepare value. `2to3` converts it into `str(value)` that will lead to `\"b'\u2026'\"` strings for values of type `bytes` on Python 3.\n\nIt is better to use `decode()` method on `bytes` instances on Python 3. Not sure how to achieve this via `2to3`.\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/618/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/618/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/568", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/568/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/568/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/568/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/568", "id": 26902222, "node_id": "MDU6SXNzdWUyNjkwMjIyMg==", "number": 568, "title": "Missuse of write_concern in Document.save", "user": {"login": "blatinier", "id": 1086629, "node_id": "MDQ6VXNlcjEwODY2Mjk=", "avatar_url": "https://avatars.githubusercontent.com/u/1086629?v=4", "gravatar_id": "", "url": "https://api.github.com/users/blatinier", "html_url": "https://github.com/blatinier", "followers_url": "https://api.github.com/users/blatinier/followers", "following_url": "https://api.github.com/users/blatinier/following{/other_user}", "gists_url": "https://api.github.com/users/blatinier/gists{/gist_id}", "starred_url": "https://api.github.com/users/blatinier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/blatinier/subscriptions", "organizations_url": "https://api.github.com/users/blatinier/orgs", "repos_url": "https://api.github.com/users/blatinier/repos", "events_url": "https://api.github.com/users/blatinier/events{/privacy}", "received_events_url": "https://api.github.com/users/blatinier/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2014-02-04T18:03:01Z", "updated_at": "2019-05-15T13:26:51Z", "closed_at": "2019-05-15T13:26:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "It is possible to define write_concern on the connection.\nHowever, while calling save method on a document, the following code (line 229 in document.py) tells you that if it's not define on save call, it is erased, whatever is your settings on the connection: \n\n```\n        if write_concern is None:\n            write_concern = {\"w\": 1}\n```\n\nThe idea is to delete those two lines to fallback on connection settings.\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/568/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/568/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/530", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/530/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/530/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/530/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/530", "id": 23707784, "node_id": "MDU6SXNzdWUyMzcwNzc4NA==", "number": 530, "title": "combining only and save deletes embedded fields value with default", "user": {"login": "gleseur", "id": 1303269, "node_id": "MDQ6VXNlcjEzMDMyNjk=", "avatar_url": "https://avatars.githubusercontent.com/u/1303269?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gleseur", "html_url": "https://github.com/gleseur", "followers_url": "https://api.github.com/users/gleseur/followers", "following_url": "https://api.github.com/users/gleseur/following{/other_user}", "gists_url": "https://api.github.com/users/gleseur/gists{/gist_id}", "starred_url": "https://api.github.com/users/gleseur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gleseur/subscriptions", "organizations_url": "https://api.github.com/users/gleseur/orgs", "repos_url": "https://api.github.com/users/gleseur/repos", "events_url": "https://api.github.com/users/gleseur/events{/privacy}", "received_events_url": "https://api.github.com/users/gleseur/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/17", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/17", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/17/labels", "id": 1098863, "node_id": "MDk6TWlsZXN0b25lMTA5ODg2Mw==", "number": 17, "title": "0.10", "description": "", "creator": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 37, "state": "closed", "created_at": "2015-05-06T16:17:07Z", "updated_at": "2015-06-26T08:50:24Z", "due_on": "2015-06-20T07:00:00Z", "closed_at": "2015-06-24T08:21:08Z"}, "comments": 3, "created_at": "2013-12-04T10:57:04Z", "updated_at": "2015-06-12T18:40:52Z", "closed_at": "2015-06-12T18:40:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "This makes the use of save very dangerous as you may loose some data while doing that if the request was done with an only previously.\nThis does not happen with fields with no default value or basic fields.\nSee repro script below:\n\n``` python\n#!/usr/bin/env python\n\nfrom mongoengine import connect, Document, IntField, EmbeddedDocument, EmbeddedDocumentField\n\n\nclass Embed(EmbeddedDocument):\n    field = IntField()\n\n\nclass A(Document):\n    meta = {'collection': 'a'}\n\n    field = IntField(default = 1)\n    embed = EmbeddedDocumentField(Embed, default = Embed)\n    embed_no_default = EmbeddedDocumentField(Embed)\n\n    connect('test')\n\nA.objects().delete()\n\n# Creating {field : 2, embed : {field: 2}, embed_no_default: {field: 2}}\nembed  = Embed()\nembed.field = 2\nrecord = A()\nrecord.field = 2\nrecord.embed = embed\nrecord.embed_no_default = embed\nrecord.save()\n\n# Checking it was saved correclty\nrecord.reload()\nassert record.field == 2\nassert record.embed_no_default.field == 2\nassert record.embed.field == 2\n\n# Request only the _id field and save\nclone = A.objects().only('id').first()\nclone.save()\n\n# Reload the record and see that the embed data is lost\nrecord.reload()\nprint(\"record.field was not erased\")\nassert record.field == 2\nprint(\"record.embed_no_default was not erased\")\nassert record.embed_no_default.field == 2\nprint(\"However record.embed.field was\")\nassert record.embed.field == 2\n```\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/530/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/530/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/517", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/517/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/517/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/517/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/517", "id": 22832779, "node_id": "MDU6SXNzdWUyMjgzMjc3OQ==", "number": 517, "title": "no_dereference() not respected on embedded docs containing reference.", "user": {"login": "jimmy-001", "id": 5955189, "node_id": "MDQ6VXNlcjU5NTUxODk=", "avatar_url": "https://avatars.githubusercontent.com/u/5955189?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jimmy-001", "html_url": "https://github.com/jimmy-001", "followers_url": "https://api.github.com/users/jimmy-001/followers", "following_url": "https://api.github.com/users/jimmy-001/following{/other_user}", "gists_url": "https://api.github.com/users/jimmy-001/gists{/gist_id}", "starred_url": "https://api.github.com/users/jimmy-001/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jimmy-001/subscriptions", "organizations_url": "https://api.github.com/users/jimmy-001/orgs", "repos_url": "https://api.github.com/users/jimmy-001/repos", "events_url": "https://api.github.com/users/jimmy-001/events{/privacy}", "received_events_url": "https://api.github.com/users/jimmy-001/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}, {"id": 208337816, "node_id": "MDU6TGFiZWwyMDgzMzc4MTY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/(De)Reference", "name": "(De)Reference", "color": "fef2c0", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/17", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/17", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/17/labels", "id": 1098863, "node_id": "MDk6TWlsZXN0b25lMTA5ODg2Mw==", "number": 17, "title": "0.10", "description": "", "creator": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 37, "state": "closed", "created_at": "2015-05-06T16:17:07Z", "updated_at": "2015-06-26T08:50:24Z", "due_on": "2015-06-20T07:00:00Z", "closed_at": "2015-06-24T08:21:08Z"}, "comments": 5, "created_at": "2013-11-18T12:58:54Z", "updated_at": "2015-06-11T12:16:38Z", "closed_at": "2015-06-11T12:16:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "When calling queryset.no_dereference if the result contains an embedded document with a reference that reference is dereferenced.\n\nTest case (cases 2 and 3 fail):\n\n``` python\n\nimport unittest\nfrom mongoengine import *\nfrom bson import ObjectId, DBRef\n\nclass QuerySetTest(unittest.TestCase):\n\n    def setUp(self):\n        connect(db=\"mongoenginetest\")\n\n    def test_no_dereference_embedded_doc(self):\n\n        class User(Document):\n            name = StringField\n\n        class Member(EmbeddedDocument):\n            name = StringField()\n            user = ReferenceField(User)\n\n        class Organization(Document):\n            name = StringField()\n            members = ListField(EmbeddedDocumentField(Member))\n            ceo = ReferenceField(User)\n            member = EmbeddedDocumentField(Member)\n            admin = ListField(ReferenceField(User))\n\n        Organization.drop_collection()\n        User.drop_collection()\n\n        user = User(name=\"Flash\")\n        user.save()\n\n        member = Member(name=\"Flash\", user=user)\n\n        company = Organization(name=\"Mongo Inc\", ceo=user, member=member)\n        company.admin.append(user)\n        company.members.append(member)\n        company.save()\n\n        result = Organization.objects().no_dereference().first()\n\n        self.assertTrue(isinstance(result.admin[0], (DBRef, ObjectId)))\n        self.assertTrue(isinstance(result.member.user, (DBRef, ObjectId)))\n        self.assertTrue(isinstance(result.members[0].user, (DBRef, ObjectId)))\n\nif __name__=='__main__':\n    unittest.main()\n```\n\nPossible solution:\n\n```\ndiff --git a/mongoengine/base/fields.py b/mongoengine/base/fields.py\nindex c6abd02..84155eb 100644\n--- a/mongoengine/base/fields.py\n+++ b/mongoengine/base/fields.py\n@@ -251,6 +251,7 @@ class ComplexBaseField(BaseField):\n                 return value\n\n         if self.field:\n+            self.field._auto_dereference = self._auto_dereference\n             value_dict = dict([(key, self.field.to_python(item))\n                                for key, item in value.items()])\n         else:\ndiff --git a/mongoengine/fields.py b/mongoengine/fields.py\nindex 036a00c..a94241f 100644\n--- a/mongoengine/fields.py\n+++ b/mongoengine/fields.py\n@@ -547,7 +547,7 @@ class EmbeddedDocumentField(BaseField):\n\n     def to_python(self, value):\n         if not isinstance(value, self.document_type):\n-            return self.document_type._from_son(value)\n+            return self.document_type._from_son(value, _auto_dereference=self._auto_dereference)\n         return value\n\n     def to_mongo(self, value):\n```\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/517/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/517/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/497", "repository_url": "https://api.github.com/repos/MongoEngine/mongoengine", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/497/labels{/name}", "comments_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/497/comments", "events_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/497/events", "html_url": "https://github.com/MongoEngine/mongoengine/issues/497", "id": 21174547, "node_id": "MDU6SXNzdWUyMTE3NDU0Nw==", "number": 497, "title": "SequenceField bug with abstract classes", "user": {"login": "snahor", "id": 96594, "node_id": "MDQ6VXNlcjk2NTk0", "avatar_url": "https://avatars.githubusercontent.com/u/96594?v=4", "gravatar_id": "", "url": "https://api.github.com/users/snahor", "html_url": "https://github.com/snahor", "followers_url": "https://api.github.com/users/snahor/followers", "following_url": "https://api.github.com/users/snahor/following{/other_user}", "gists_url": "https://api.github.com/users/snahor/gists{/gist_id}", "starred_url": "https://api.github.com/users/snahor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/snahor/subscriptions", "organizations_url": "https://api.github.com/users/snahor/orgs", "repos_url": "https://api.github.com/users/snahor/repos", "events_url": "https://api.github.com/users/snahor/events{/privacy}", "received_events_url": "https://api.github.com/users/snahor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 774306, "node_id": "MDU6TGFiZWw3NzQzMDY=", "url": "https://api.github.com/repos/MongoEngine/mongoengine/labels/Bug", "name": "Bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/17", "html_url": "https://github.com/MongoEngine/mongoengine/milestone/17", "labels_url": "https://api.github.com/repos/MongoEngine/mongoengine/milestones/17/labels", "id": 1098863, "node_id": "MDk6TWlsZXN0b25lMTA5ODg2Mw==", "number": 17, "title": "0.10", "description": "", "creator": {"login": "MRigal", "id": 2190327, "node_id": "MDQ6VXNlcjIxOTAzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2190327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MRigal", "html_url": "https://github.com/MRigal", "followers_url": "https://api.github.com/users/MRigal/followers", "following_url": "https://api.github.com/users/MRigal/following{/other_user}", "gists_url": "https://api.github.com/users/MRigal/gists{/gist_id}", "starred_url": "https://api.github.com/users/MRigal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MRigal/subscriptions", "organizations_url": "https://api.github.com/users/MRigal/orgs", "repos_url": "https://api.github.com/users/MRigal/repos", "events_url": "https://api.github.com/users/MRigal/events{/privacy}", "received_events_url": "https://api.github.com/users/MRigal/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 37, "state": "closed", "created_at": "2015-05-06T16:17:07Z", "updated_at": "2015-06-26T08:50:24Z", "due_on": "2015-06-20T07:00:00Z", "closed_at": "2015-06-24T08:21:08Z"}, "comments": 9, "created_at": "2013-10-17T18:36:29Z", "updated_at": "2015-06-12T20:17:33Z", "closed_at": "2015-06-12T13:17:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "When two or more classes inherits from an abstract one, in which a `SequenceField` is defined, it only creates an entry in `mongoengine.counters` for the last class. The problem is `owner_document`. \n\n```\n>>> class Base(Document):\n...     counter = SequenceField()\n...     meta = {'abstract': True}\n\n>>> class Foo(Base):\n...     pass\n\n>>> class Bar(Base):\n...     pass\n\n>>> bar = Bar()\n>>> bar.save()\n\n>>> foo = Foo()\n>>> foo.save()\n\n>>> foo.counter == bar.counter\nFalse\n\n>>> for i in db['mongoengine.counters'].find(): print i\n{u'_id': u'bar.counter', u'next': 2}\n\n>>> foo._fields['counter'].owner_document\n__main__.Bar\n\n>>> bar._fields['counter'].owner_document\n__main__.Bar\n```\n\nTests:\n\n```\nimport pytest\nfrom mongoengine import *\n\n\ndef test_inherited_sequencefield():\n    dbname = 'test_inherited_sequencefield'\n    conn = connect(dbname)\n\n    class Base(Document):\n        name = StringField()\n        counter = SequenceField()\n        meta = {'abstract': True}\n\n    class Foo(Base):\n        pass\n\n    class Bar(Base):\n        pass\n\n    bar = Bar(name='Bar')\n    bar.save()\n\n    foo = Foo(name='Foo')\n    foo.save()\n\n    assert foo.counter == bar.counter\n    assert foo._fields['counter'].owner_document == Foo\n    assert bar._fields['counter'].owner_document == Bar\n\n    conn.drop_database(dbname)\n\n\ndef test_no_inherited_sequencefield():\n    dbname = 'test_no_inherited_sequencefield'\n    conn = connect(dbname)\n\n    class Base(Document):\n        name = StringField()\n        meta = {'abstract': True}\n\n    class Foo(Base):\n        counter = SequenceField()\n\n    class Bar(Base):\n        counter = SequenceField()\n\n    bar = Bar(name='Bar')\n    bar.save()\n\n    foo = Foo(name='Foo')\n    foo.save()\n\n    assert foo.counter == bar.counter\n    assert foo._fields['counter'].owner_document == Foo\n    assert bar._fields['counter'].owner_document == Bar\n\n    conn.drop_database(dbname)\n```\n", "reactions": {"url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/497/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/MongoEngine/mongoengine/issues/497/timeline", "performed_via_github_app": null, "state_reason": "completed"}]