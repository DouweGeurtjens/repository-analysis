[{"url": "https://api.github.com/repos/buildbot/buildbot/issues/6657", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/6657/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/6657/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/6657/events", "html_url": "https://github.com/buildbot/buildbot/issues/6657", "id": 1429581760, "node_id": "I_kwDOAAuZZc5VNa_A", "number": 6657, "title": "Add support for docker-py 6.0.0", "user": {"login": "JohannesKauffmann", "id": 19662702, "node_id": "MDQ6VXNlcjE5NjYyNzAy", "avatar_url": "https://avatars.githubusercontent.com/u/19662702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohannesKauffmann", "html_url": "https://github.com/JohannesKauffmann", "followers_url": "https://api.github.com/users/JohannesKauffmann/followers", "following_url": "https://api.github.com/users/JohannesKauffmann/following{/other_user}", "gists_url": "https://api.github.com/users/JohannesKauffmann/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohannesKauffmann/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohannesKauffmann/subscriptions", "organizations_url": "https://api.github.com/users/JohannesKauffmann/orgs", "repos_url": "https://api.github.com/users/JohannesKauffmann/repos", "events_url": "https://api.github.com/users/JohannesKauffmann/events{/privacy}", "received_events_url": "https://api.github.com/users/JohannesKauffmann/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-10-31T10:05:44Z", "updated_at": "2022-11-07T17:09:08Z", "closed_at": "2022-11-07T17:09:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "See https://github.com/docker/docker-py/releases/tag/6.0.0\r\n\r\nFoolishly, I did not pin my docker-py version. So since august, our build server was broken and it turned out to be coming from a new version of docker-py. The following shows what happens with current Buildbot master and docker-py 6.0.0:\r\n\r\n```\r\nbuildbot_master  | 2022-10-17 13:41:09+0000 [-] while worker_prepare\r\nbuildbot_master  |       Traceback (most recent call last):\r\nbuildbot_master  |         File \"/buildbot_venv/lib/python3.9/site-packages/twisted/internet/defer.py\", line 891, in _runCallbacks\r\nbuildbot_master  |           current.result = callback(  # type: ignore[misc]\r\nbuildbot_master  |         File \"/buildbot_venv/lib/python3.9/site-packages/twisted/internet/defer.py\", line 1791, in gotResult\r\nbuildbot_master  |           _inlineCallbacks(r, gen, status, context)\r\nbuildbot_master  |         File \"/buildbot_venv/lib/python3.9/site-packages/twisted/internet/defer.py\", line 1692, in _inlineCallbacks\r\nbuildbot_master  |           result = context.run(\r\nbuildbot_master  |         File \"/buildbot_venv/lib/python3.9/site-packages/twisted/python/failure.py\", line 518, in throwExceptionIntoGenerator\r\nbuildbot_master  |           return g.throw(self.type, self.value, self.tb)\r\nbuildbot_master  |       --- <exception caught here> ---\r\nbuildbot_master  |         File \"/buildbot_venv/lib/python3.9/site-packages/buildbot/process/build.py\", line 360, in startBuild\r\nbuildbot_master  |           ready_or_failure = yield workerforbuilder.substantiate_if_needed(self)\r\nbuildbot_master  |         File \"/buildbot_venv/lib/python3.9/site-packages/buildbot/worker/latent.py\", line 289, in _substantiate\r\nbuildbot_master  |           start_success = yield self.start_instance(build)\r\nbuildbot_master  |         File \"/buildbot_venv/lib/python3.9/site-packages/twisted/internet/defer.py\", line 1692, in _inlineCallbacks\r\nbuildbot_master  |           result = context.run(\r\nbuildbot_master  |         File \"/buildbot_venv/lib/python3.9/site-packages/twisted/python/failure.py\", line 518, in throwExceptionIntoGenerator\r\nbuildbot_master  |           return g.throw(self.type, self.value, self.tb)\r\nbuildbot_master  |         File \"/buildbot_venv/lib/python3.9/site-packages/buildbot/worker/docker.py\", line 233, in start_instance\r\nbuildbot_master  |           res = yield threads.deferToThread(self._thd_start_instance, docker_host, image,\r\nbuildbot_master  |         File \"/buildbot_venv/lib/python3.9/site-packages/twisted/python/threadpool.py\", line 244, in inContext\r\nbuildbot_master  |           result = inContext.theWork()  # type: ignore[attr-defined]\r\nbuildbot_master  |         File \"/buildbot_venv/lib/python3.9/site-packages/twisted/python/threadpool.py\", line 260, in <lambda>\r\nbuildbot_master  |           inContext.theWork = lambda: context.call(  # type: ignore[attr-defined]\r\nbuildbot_master  |         File \"/buildbot_venv/lib/python3.9/site-packages/twisted/python/context.py\", line 117, in callWithContext\r\nbuildbot_master  |           return self.currentContext().callWithContext(ctx, func, *args, **kw)\r\nbuildbot_master  |         File \"/buildbot_venv/lib/python3.9/site-packages/twisted/python/context.py\", line 82, in callWithContext\r\nbuildbot_master  |           return func(*args, **kw)\r\nbuildbot_master  |         File \"/buildbot_venv/lib/python3.9/site-packages/buildbot/worker/docker.py\", line 253, in _thd_start_instance\r\nbuildbot_master  |           docker_client = self._getDockerClient(curr_client_args)\r\nbuildbot_master  |         File \"/buildbot_venv/lib/python3.9/site-packages/buildbot/worker/docker.py\", line 213, in _getDockerClient\r\nbuildbot_master  |           if docker.version[0] == '1':\r\nbuildbot_master  |       builtins.TypeError: 'module' object is not subscriptable\r\n```\r\n\r\n(This stack trace is from Buildbot v3.5.0)\r\n\r\nQuoting from the GitHub releases page:\r\n```\r\nVersion metadata is now exposed as __version__\r\n```\r\n\r\nSo this was the failure in the stack trace.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6657/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/6657/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6539", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/6539/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/6539/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/6539/events", "html_url": "https://github.com/buildbot/buildbot/issues/6539", "id": 1265069618, "node_id": "I_kwDOAAuZZc5LZ24y", "number": 6539, "title": "buildbot.steps.source.git.Git fails with full mode + copy method", "user": {"login": "minyang", "id": 2056960, "node_id": "MDQ6VXNlcjIwNTY5NjA=", "avatar_url": "https://avatars.githubusercontent.com/u/2056960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/minyang", "html_url": "https://github.com/minyang", "followers_url": "https://api.github.com/users/minyang/followers", "following_url": "https://api.github.com/users/minyang/following{/other_user}", "gists_url": "https://api.github.com/users/minyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/minyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/minyang/subscriptions", "organizations_url": "https://api.github.com/users/minyang/orgs", "repos_url": "https://api.github.com/users/minyang/repos", "events_url": "https://api.github.com/users/minyang/events{/privacy}", "received_events_url": "https://api.github.com/users/minyang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-06-08T17:21:50Z", "updated_at": "2022-09-03T02:29:04Z", "closed_at": "2022-09-03T02:29:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "When checking out git source tree with `full` mode and `copy` method, `buildbot.steps.source.git.Git` fails.\r\n\r\nBuildbot master versions (I'm using docker):\r\n```\r\nbuildbot_1  | 2022-06-08 17:15:55+0000 [-] Loading /buildbot/buildbot.tac...\r\nbuildbot_1  | 2022-06-08 17:15:57+0000 [-] Loaded.\r\nbuildbot_1  | 2022-06-08 17:15:57+0000 [-] twistd 22.4.0 (/buildbot_venv/bin/python 3.9.2) starting up.\r\nbuildbot_1  | 2022-06-08 17:15:57+0000 [-] reactor class: twisted.internet.epollreactor.EPollReactor.\r\nbuildbot_1  | 2022-06-08 17:15:57+0000 [-] Starting BuildMaster -- buildbot.version: 3.5.1-dev212\r\n```\r\n\r\n`master.cfg` is configured as follows:\r\n```\r\nf.addStep(steps.Git(\r\n            repourl = REPO_URL,\r\n            mode = 'full', method = 'copy',\r\n            sshKnownHosts = util.Secret(\"known_hosts\"),\r\n            sshPrivateKey = util.Secret(\"id_rsa\")))\r\n```\r\n\r\nRun-time python error (`builtins.ValueError`):\r\n```\r\nbuildbot_1  | 2022-06-08 17:16:21+0000 [-] BuildStep.failed; traceback follows\r\nbuildbot_1  |   Traceback (most recent call last):\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/twisted/internet/defer.py\", line 700, in errback\r\nbuildbot_1  |       self._startRunCallbacks(fail)\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/twisted/internet/defer.py\", line 763, in _startRunCallbacks\r\nbuildbot_1  |       self._runCallbacks()\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/twisted/internet/defer.py\", line 857, in _runCallbacks\r\nbuildbot_1  |       current.result = callback(  # type: ignore[misc]\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/twisted/internet/defer.py\", line 1750, in gotResult\r\nbuildbot_1  |       current_context.run(_inlineCallbacks, r, gen, status)\r\nbuildbot_1  |   --- <exception caught here> ---\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/buildbot/process/buildstep.py\", line 486, in startStep\r\nbuildbot_1  |       self.results = yield self.run()\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/buildbot/steps/source/base.py\", line 287, in run\r\nbuildbot_1  |       res = yield self.run_vc(branch, revision, patch)\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/buildbot/steps/source/git.py\", line 141, in run_vc\r\nbuildbot_1  |       yield self._getAttrGroupMember('mode', self.mode)()\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/buildbot/steps/source/git.py\", line 158, in mode_full\r\nbuildbot_1  |       yield self.copy()\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/buildbot/steps/source/git.py\", line 257, in copy\r\nbuildbot_1  |       yield self.runCommand(cmd)\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/buildbot/process/buildstep.py\", line 766, in runCommand\r\nbuildbot_1  |       res = yield command.run(self, self.remote, self.build.builder.name)\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/buildbot/process/remotecommand.py\", line 164, in _finished\r\nbuildbot_1  |       yield self.remoteComplete(failure)\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/twisted/internet/defer.py\", line 1656, in _inlineCallbacks\r\nbuildbot_1  |       result = current_context.run(\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/twisted/python/failure.py\", line 514, in throwExceptionIntoGenerator\r\nbuildbot_1  |       return g.throw(self.type, self.value, self.tb)\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/buildbot/steps/source/base.py\", line 287, in run\r\nbuildbot_1  |       res = yield self.run_vc(branch, revision, patch)\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/twisted/internet/defer.py\", line 1660, in _inlineCallbacks\r\nbuildbot_1  |       result = current_context.run(gen.send, result)\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/buildbot/steps/source/git.py\", line 141, in run_vc\r\nbuildbot_1  |       yield self._getAttrGroupMember('mode', self.mode)()\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/twisted/internet/defer.py\", line 1656, in _inlineCallbacks\r\nbuildbot_1  |       result = current_context.run(\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/twisted/python/failure.py\", line 514, in throwExceptionIntoGenerator\r\nbuildbot_1  |       return g.throw(self.type, self.value, self.tb)\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/buildbot/steps/source/git.py\", line 158, in mode_full\r\nbuildbot_1  |       yield self.copy()\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/twisted/internet/defer.py\", line 1656, in _inlineCallbacks\r\nbuildbot_1  |       result = current_context.run(\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/twisted/python/failure.py\", line 514, in throwExceptionIntoGenerator\r\nbuildbot_1  |       return g.throw(self.type, self.value, self.tb)\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/buildbot/steps/source/git.py\", line 257, in copy\r\nbuildbot_1  |       yield self.runCommand(cmd)\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/twisted/internet/defer.py\", line 1656, in _inlineCallbacks\r\nbuildbot_1  |       result = current_context.run(\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/twisted/python/failure.py\", line 514, in throwExceptionIntoGenerator\r\nbuildbot_1  |       return g.throw(self.type, self.value, self.tb)\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/buildbot/process/buildstep.py\", line 766, in runCommand\r\nbuildbot_1  |       res = yield command.run(self, self.remote, self.build.builder.name)\r\nbuildbot_1  |     File \"/buildbot_venv/lib/python3.9/site-packages/buildbot/process/remotecommand.py\", line 164, in _finished\r\nbuildbot_1  |       yield self.remoteComplete(failure)\r\nbuildbot_1  |   buildbot.process.remotecommand.RemoteException: b'builtins.ValueError': CopyDirectory is missing args: to_path\r\nbuildbot_1  |   Traceback unavailable\r\n```\r\n\r\nBased on this trace, it appears `CopyDirectory` does not work when attempting to copy `source` directory to `build`.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6539/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/6539/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6507", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/6507/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/6507/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/6507/events", "html_url": "https://github.com/buildbot/buildbot/issues/6507", "id": 1233495062, "node_id": "I_kwDOAAuZZc5JhaQW", "number": 6507, "title": "Github change hook injects a change record...  then what?", "user": {"login": "levitte", "id": 698918, "node_id": "MDQ6VXNlcjY5ODkxOA==", "avatar_url": "https://avatars.githubusercontent.com/u/698918?v=4", "gravatar_id": "", "url": "https://api.github.com/users/levitte", "html_url": "https://github.com/levitte", "followers_url": "https://api.github.com/users/levitte/followers", "following_url": "https://api.github.com/users/levitte/following{/other_user}", "gists_url": "https://api.github.com/users/levitte/gists{/gist_id}", "starred_url": "https://api.github.com/users/levitte/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/levitte/subscriptions", "organizations_url": "https://api.github.com/users/levitte/orgs", "repos_url": "https://api.github.com/users/levitte/repos", "events_url": "https://api.github.com/users/levitte/events{/privacy}", "received_events_url": "https://api.github.com/users/levitte/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2022-05-12T06:14:58Z", "updated_at": "2022-05-30T06:16:03Z", "closed_at": "2022-05-30T06:16:02Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I've come so far with detecting PRs that there is indeed a visible change record\r\n\r\n![foo](https://user-images.githubusercontent.com/698918/168003544-73832979-887d-477c-a7e1-5910a21abee4.png)\r\n\r\nHowever, no build is being scheduled.  I'm quite stumped as to why.\r\n\r\nThe scheduler that I imagined would catch looks like this:\r\n\r\n``` python\r\n    schedulers.SingleBranchScheduler(\r\n        name = 'unix-pulls',\r\n        builderNames = list({\r\n            f'unix-{workerdata[n][\"platform_id\"]}': 0\r\n            for n in workerdata\r\n            if (workerdata[n].get('platform_type', 'unix') == 'unix'\r\n                and 'pull' in workerdata[n].get('builder_types', [ 'pull' ]))\r\n        }),\r\n        change_filter = util.ChangeFilter(category='pull', branch_re='^.*$'),\r\n    ),\r\n```\r\n\r\nFor completeness, `workerdata` is a dict with entries like this:\r\n\r\n``` python\r\n    'w-debian11-x86_64': {\r\n        'password': 'wouldntyouliketoknow',\r\n        'platform_type': 'unix',\r\n        'platform_id': 'debian11-x86_64',\r\n    },\r\n```\r\n\r\nCan you help me figure out what I'm missing?", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6507/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/6507/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6264", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/6264/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/6264/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/6264/events", "html_url": "https://github.com/buildbot/buildbot/issues/6264", "id": 1025412151, "node_id": "I_kwDOAAuZZc49How3", "number": 6264, "title": "problem displaying logs on browser with buildbot 3.3.1-dev109 ", "user": {"login": "aliceinwire", "id": 107572, "node_id": "MDQ6VXNlcjEwNzU3Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/107572?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aliceinwire", "html_url": "https://github.com/aliceinwire", "followers_url": "https://api.github.com/users/aliceinwire/followers", "following_url": "https://api.github.com/users/aliceinwire/following{/other_user}", "gists_url": "https://api.github.com/users/aliceinwire/gists{/gist_id}", "starred_url": "https://api.github.com/users/aliceinwire/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aliceinwire/subscriptions", "organizations_url": "https://api.github.com/users/aliceinwire/orgs", "repos_url": "https://api.github.com/users/aliceinwire/repos", "events_url": "https://api.github.com/users/aliceinwire/events{/privacy}", "received_events_url": "https://api.github.com/users/aliceinwire/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-10-13T15:42:54Z", "updated_at": "2021-10-15T10:02:33Z", "closed_at": "2021-10-15T10:02:33Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "We have problem displaying logs in the browser\r\nhttps://gkernelci.gentoo.org/#/builders", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6264/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/6264/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6222", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/6222/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/6222/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/6222/events", "html_url": "https://github.com/buildbot/buildbot/issues/6222", "id": 989804311, "node_id": "MDU6SXNzdWU5ODk4MDQzMTE=", "number": 6222, "title": "Cannot install with setuptools 58", "user": {"login": "rjarry", "id": 472286, "node_id": "MDQ6VXNlcjQ3MjI4Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/472286?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rjarry", "html_url": "https://github.com/rjarry", "followers_url": "https://api.github.com/users/rjarry/followers", "following_url": "https://api.github.com/users/rjarry/following{/other_user}", "gists_url": "https://api.github.com/users/rjarry/gists{/gist_id}", "starred_url": "https://api.github.com/users/rjarry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rjarry/subscriptions", "organizations_url": "https://api.github.com/users/rjarry/orgs", "repos_url": "https://api.github.com/users/rjarry/repos", "events_url": "https://api.github.com/users/rjarry/events{/privacy}", "received_events_url": "https://api.github.com/users/rjarry/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "rjarry", "id": 472286, "node_id": "MDQ6VXNlcjQ3MjI4Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/472286?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rjarry", "html_url": "https://github.com/rjarry", "followers_url": "https://api.github.com/users/rjarry/followers", "following_url": "https://api.github.com/users/rjarry/following{/other_user}", "gists_url": "https://api.github.com/users/rjarry/gists{/gist_id}", "starred_url": "https://api.github.com/users/rjarry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rjarry/subscriptions", "organizations_url": "https://api.github.com/users/rjarry/orgs", "repos_url": "https://api.github.com/users/rjarry/repos", "events_url": "https://api.github.com/users/rjarry/events{/privacy}", "received_events_url": "https://api.github.com/users/rjarry/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rjarry", "id": 472286, "node_id": "MDQ6VXNlcjQ3MjI4Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/472286?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rjarry", "html_url": "https://github.com/rjarry", "followers_url": "https://api.github.com/users/rjarry/followers", "following_url": "https://api.github.com/users/rjarry/following{/other_user}", "gists_url": "https://api.github.com/users/rjarry/gists{/gist_id}", "starred_url": "https://api.github.com/users/rjarry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rjarry/subscriptions", "organizations_url": "https://api.github.com/users/rjarry/orgs", "repos_url": "https://api.github.com/users/rjarry/repos", "events_url": "https://api.github.com/users/rjarry/events{/privacy}", "received_events_url": "https://api.github.com/users/rjarry/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-09-07T09:51:47Z", "updated_at": "2021-09-09T09:26:47Z", "closed_at": "2021-09-09T09:26:47Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "[Setuptools 58.0.0 removes the support for 2to3](https://setuptools.readthedocs.io/en/latest/history.html#v58-0-0) which breaks the installation of [Tempita](https://pypi.org/project/Tempita/) (dependency of [sqlalchemy-migrate](https://pypi.org/project/sqlalchemy-migrate/)).\r\n\r\nThis leads to a semi-silent installation error:\r\n\r\n```\r\nCollecting Tempita>=0.4\r\n  Downloading https://....../Tempita-0.5.2.tar.gz (12 kB)\r\n    ERROR: Command errored out with exit status 1:\r\n     ...\r\n    Complete output (1 lines):\r\n    error in Tempita setup command: use_2to3 is invalid.\r\n    ----------------------------------------\r\nWARNING: Discarding https://......./Tempita-0.5.2.tar.gz\r\nCommand errored out with exit status 1: python setup.py egg_info\r\nCheck the logs for full command output.\r\n  Downloading https://...../Tempita-0.5.1.tar.gz (12 kB)\r\n    ERROR: Command errored out with exit status 1:\r\n     ...\r\n    Complete output (1 lines):\r\n    error in Tempita setup command: use_2to3 is invalid.\r\n    ----------------------------------------\r\nWARNING: Discarding https://...../Tempita-0.5.1.tar.gz\r\nCommand errored out with exit status 1: python setup.py egg_info\r\nCheck the logs for full command output.\r\n  Downloading https://......./Tempita-0.4.tar.gz (21 kB)\r\n...\r\n  Building wheel for Tempita (setup.py) ... done\r\n  Created wheel for Tempita: filename=Tempita-0.4-py3-none-any.whl\r\n```\r\n\r\n[Tempita is a dead project. Last commit activity dates from 2013.](https://pypi.org/project/Tempita/) Versions 0.5.x have `use_2to3=True` in their `setup.py` scripts which allowed silent conversion of code to python3 syntax. With setuptools 58, this conversion is not possible anymore. pip falls back to version 0.4 of tempita which is not compatible with python 3 at all. Leading to an error when starting buildbot:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"twisted/application/app.py\", line 448, in getApplication\r\n    application = service.loadApplication(filename, style, passphrase)\r\n  File \"twisted/application/service.py\", line 404, in loadApplication\r\n    application = sob.loadValueFromFile(filename, \"application\")\r\n  File \"twisted/persisted/sob.py\", line 176, in loadValueFromFile\r\n    eval(codeObj, d, d)\r\n  File \"buildbot.tac\", line 155, in <module>\r\n    from buildbot.master import BuildMaster\r\n  File \"buildbot/master.py\", line 35, in <module>\r\n    from buildbot.db import connector as dbconnector\r\n  File \"buildbot/db/connector.py\", line 35, in <module>\r\n    from buildbot.db import model\r\n  File \"buildbot/db/model.py\", line 18, in <module>\r\n    import migrate.versioning.repository\r\n  File \"migrate/versioning/repository.py\", line 10, in <module>\r\n    from tempita import Template as TempitaTemplate\r\nbuiltins.SyntaxError: invalid syntax (__init__.py, line 295)\r\n```\r\n\r\nIndeed, here is an excerpt from `tempita/__init__.py` (the source code is not browseable anymore):\r\n\r\n```python\r\n290     def _eval(self, code, ns, pos):\r\n291         __traceback_hide__ = True\r\n292         try:\r\n293             try:\r\n294                 value = eval(code, self.default_namespace, ns)\r\n295             except SyntaxError, e:\r\n296                 raise SyntaxError(\r\n297                     'invalid syntax in expression: %s' % code)\r\n298             return value\r\n299         except:\r\n300             exc_info = sys.exc_info()\r\n301             e = exc_info[1]\r\n302             if getattr(e, 'args', None):\r\n303                 arg0 = e.args[0]\r\n304             else:\r\n305                 arg0 = coerce_text(e)\r\n306             e.args = (self._add_line_info(arg0, pos),)\r\n307             raise exc_info[0], e, exc_info[2]\r\n```\r\n\r\nThis is obviously Python 2 syntax only.\r\n\r\nThe wise choice would be to switch from [sqlalchemy-migrate](https://opendev.org/x/sqlalchemy-migrate) to [alembic](https://github.com/sqlalchemy/alembic) which is officially supported by sqlalchemy maintainers. I don't know what it implies in buildbot codebase.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6222/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/6222/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6140", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/6140/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/6140/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/6140/events", "html_url": "https://github.com/buildbot/buildbot/issues/6140", "id": 946000314, "node_id": "MDU6SXNzdWU5NDYwMDAzMTQ=", "number": 6140, "title": "Should add the exit code '128' of TASKKILL as a Successful Return Code", "user": {"login": "yinyangsx", "id": 52401909, "node_id": "MDQ6VXNlcjUyNDAxOTA5", "avatar_url": "https://avatars.githubusercontent.com/u/52401909?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yinyangsx", "html_url": "https://github.com/yinyangsx", "followers_url": "https://api.github.com/users/yinyangsx/followers", "following_url": "https://api.github.com/users/yinyangsx/following{/other_user}", "gists_url": "https://api.github.com/users/yinyangsx/gists{/gist_id}", "starred_url": "https://api.github.com/users/yinyangsx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yinyangsx/subscriptions", "organizations_url": "https://api.github.com/users/yinyangsx/orgs", "repos_url": "https://api.github.com/users/yinyangsx/repos", "events_url": "https://api.github.com/users/yinyangsx/events{/privacy}", "received_events_url": "https://api.github.com/users/yinyangsx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-07-16T06:55:10Z", "updated_at": "2022-01-03T22:56:45Z", "closed_at": "2022-01-03T22:56:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, my Windows Server 2019 worker failed to run TASKKILL command when timeout happen.  TASKKILL failed with exit status 128. \r\n_2021-07-14 10:29:25+0300 [-] using TASKKILL PID /F /T to kill pid 213464\r\n2021-07-14 10:29:25+0300 [-] Unhandled Error\r\nTraceback (most recent call last):\r\nFile \"d:\\buildbot\\sandbox\\lib\\site-packages\\twisted\\application\\app.py\", line 399, in startReactor\r\nself.config, oldstdout, oldstderr, self.profiler, reactor)\r\nFile \"d:\\buildbot\\sandbox\\lib\\site-packages\\twisted\\application\\app.py\", line 312, in runReactorWithLogging\r\nreactor.run()\r\nFile \"d:\\buildbot\\sandbox\\lib\\site-packages\\twisted\\internet\\base.py\", line 1272, in run\r\nself.mainLoop()\r\nFile \"d:\\buildbot\\sandbox\\lib\\site-packages\\twisted\\internet\\base.py\", line 1281, in mainLoop\r\nself.runUntilCurrent()\r\nFile \"d:\\buildbot\\sandbox\\lib\\site-packages\\twisted\\internet\\base.py\", line 902, in runUntilCurrent\r\ncall.func(*call.args, **call.kw)\r\nFile \"d:\\buildbot\\sandbox\\lib\\site-packages\\buildbot_worker\\runprocess.py\", line 822, in doTimeout\r\nself.kill(msg)\r\nFile \"d:\\buildbot\\sandbox\\lib\\site-packages\\buildbot_worker\\runprocess.py\", line 946, in kill\r\nhit = self.sendSig(self.interruptSignal)\r\nFile \"d:\\buildbot\\sandbox\\lib\\site-packages\\buildbot_worker\\runprocess.py\", line 905, in sendSig\r\n\"TASKKILL /F /PID {0} /T\".format(self.process.pid))\r\nFile \"C:\\Program Files\\Python37\\lib\\subprocess.py\", line 363, in check_call\r\nraise CalledProcessError(retcode, cmd)\r\nsubprocess.CalledProcessError: Command 'TASKKILL /F /PID 213464 /T' returned non-zero exit status 128._\r\n\r\nI've manually invoked the failing TASKKILL command, and it does fail with error code 128. From the output, we can see the failure reason is that there is no running instance of the task when killing some child process. \r\nAs well as I found that the process tree was successfully killed, but the job is not terminated, it is still in yellow, the yellow job blocks new jobs to be assigned to my my windows worker. \r\n**I think Buildbot should add the exit code '128' of TASKKILL as a Successful Return Code because code 128 means that the process you attempted to kill wasn't actually running on the target system.** \r\n\r\n_ERROR: The process with PID 214484 (child process of PID 213096) could not be terminated.\r\nReason: There is no running instance of the task.\r\nERROR: The process with PID 213976 (child process of PID 212212) could not be terminated.\r\nReason: There is no running instance of the task.\r\nERROR: The process with PID 215376 (child process of PID 215556) could not be terminated.\r\nReason: There is no running instance of the task.\r\nSUCCESS: The process with PID 215556 (child process of PID 213264) has been terminated.\r\nSUCCESS: The process with PID 212212 (child process of PID 213264) has been terminated.\r\nSUCCESS: The process with PID 215492 (child process of PID 213264) has been terminated.\r\nSUCCESS: The process with PID 213196 (child process of PID 213264) has been terminated.\r\nSUCCESS: The process with PID 207940 (child process of PID 213264) has been terminated.\r\nSUCCESS: The process with PID 207084 (child process of PID 213264) has been terminated.\r\nSUCCESS: The process with PID 214124 (child process of PID 213264) has been terminated.\r\nSUCCESS: The process with PID 211980 (child process of PID 213264) has been terminated.\r\nSUCCESS: The process with PID 213620 (child process of PID 213264) has been terminated.\r\nSUCCESS: The process with PID 215100 (child process of PID 213264) has been terminated.\r\nSUCCESS: The process with PID 213096 (child process of PID 213264) has been terminated.\r\nSUCCESS: The process with PID 210924 (child process of PID 213264) has been terminated.\r\nSUCCESS: The process with PID 213264 (child process of PID 214776) has been terminated.\r\nSUCCESS: The process with PID 214776 (child process of PID 208396) has been terminated.\r\nSUCCESS: The process with PID 208396 (child process of PID 213760) has been terminated.\r\nSUCCESS: The process with PID 213760 (child process of PID 212780) has been terminated.\r\nSUCCESS: The process with PID 212780 (child process of PID 211996) has been terminated.\r\nSUCCESS: The process with PID 215312 (child process of PID 213256) has been terminated.\r\nSUCCESS: The process with PID 211996 (child process of PID 213256) has been terminated.\r\nSUCCESS: The process with PID 213256 (child process of PID 28064) has been terminated._\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6140/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/6140/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6134", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/6134/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/6134/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/6134/events", "html_url": "https://github.com/buildbot/buildbot/issues/6134", "id": 940555830, "node_id": "MDU6SXNzdWU5NDA1NTU4MzA=", "number": 6134, "title": "Cancelled builds on startup with multiple SingleBranchSchedulers", "user": {"login": "LuluDavid", "id": 49950449, "node_id": "MDQ6VXNlcjQ5OTUwNDQ5", "avatar_url": "https://avatars.githubusercontent.com/u/49950449?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LuluDavid", "html_url": "https://github.com/LuluDavid", "followers_url": "https://api.github.com/users/LuluDavid/followers", "following_url": "https://api.github.com/users/LuluDavid/following{/other_user}", "gists_url": "https://api.github.com/users/LuluDavid/gists{/gist_id}", "starred_url": "https://api.github.com/users/LuluDavid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LuluDavid/subscriptions", "organizations_url": "https://api.github.com/users/LuluDavid/orgs", "repos_url": "https://api.github.com/users/LuluDavid/repos", "events_url": "https://api.github.com/users/LuluDavid/events{/privacy}", "received_events_url": "https://api.github.com/users/LuluDavid/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-07-09T08:45:29Z", "updated_at": "2021-07-28T23:36:29Z", "closed_at": "2021-07-28T23:36:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, I opened this issue because I found a problem that might be similar to #4686 and #3762.  \r\nI am working with HgPoller but I extended it because I want to poll the initial commits as changesets to test (whereas they are considered as references not to test in the default implementation). I also created multiple SingleBranchSchedulers to listen to the polled repositories, each scheduler triggering a few builders. I also fire a Stable Timer of 30 seconds for each of the single branch scheduler.  \r\n\r\nSo when I restart my instance of buildbot, it should test all polled branches for all builders that listen to these commits. Locally, it works perfectly, and I get all expected buildrequests in the UI. But when I tried to deploy it on a distant Virtual Machine, it did not work as expected, with only the few first buildrequests being taken into account. After a lot of debugging, it seems that the missing changes are polled as expected by the HgPoller, but they are never processed by the schedulers then.  \r\n\r\nAfter this initial fail, it seems then to work fine (all buildrequests happen as expected). So it just comes from a concurrency problem when all polled changes should trigger builds as for  (maybe it comes from concurrent accesses to buildbot's internal changes database). Also, the fact it works locally (16 GB of RAM, 8 CPUs)  but not on my VM (8 GB, 4 CPUs) shows that it stands out of a hardware performance problem underneath the python code, and made me think about #3762.\r\n\r\nThanks for reading, hope my report is exhaustive enough to track the cause of this error.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6134/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/6134/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6114", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/6114/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/6114/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/6114/events", "html_url": "https://github.com/buildbot/buildbot/issues/6114", "id": 922094921, "node_id": "MDU6SXNzdWU5MjIwOTQ5MjE=", "number": 6114, "title": "documentation says 3.0 is not released yet", "user": {"login": "hmoffatt", "id": 7577172, "node_id": "MDQ6VXNlcjc1NzcxNzI=", "avatar_url": "https://avatars.githubusercontent.com/u/7577172?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hmoffatt", "html_url": "https://github.com/hmoffatt", "followers_url": "https://api.github.com/users/hmoffatt/followers", "following_url": "https://api.github.com/users/hmoffatt/following{/other_user}", "gists_url": "https://api.github.com/users/hmoffatt/gists{/gist_id}", "starred_url": "https://api.github.com/users/hmoffatt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hmoffatt/subscriptions", "organizations_url": "https://api.github.com/users/hmoffatt/orgs", "repos_url": "https://api.github.com/users/hmoffatt/repos", "events_url": "https://api.github.com/users/hmoffatt/events{/privacy}", "received_events_url": "https://api.github.com/users/hmoffatt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557389668, "node_id": "MDU6TGFiZWw1NTczODk2Njg=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/documentation", "name": "documentation", "color": "006b75", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-06-16T04:57:56Z", "updated_at": "2021-06-17T16:26:36Z", "closed_at": "2021-06-17T16:26:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "Even in the 3.1 documentation, the chapter on upgrading to 3.0 says that version is not released yet. https://docs.buildbot.net/3.1.0/manual/upgrading/3.0-upgrade.html", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6114/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/6114/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6113", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/6113/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/6113/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/6113/events", "html_url": "https://github.com/buildbot/buildbot/issues/6113", "id": 922041292, "node_id": "MDU6SXNzdWU5MjIwNDEyOTI=", "number": 6113, "title": "lists.buildbot.net certificate expired", "user": {"login": "hmoffatt", "id": 7577172, "node_id": "MDQ6VXNlcjc1NzcxNzI=", "avatar_url": "https://avatars.githubusercontent.com/u/7577172?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hmoffatt", "html_url": "https://github.com/hmoffatt", "followers_url": "https://api.github.com/users/hmoffatt/followers", "following_url": "https://api.github.com/users/hmoffatt/following{/other_user}", "gists_url": "https://api.github.com/users/hmoffatt/gists{/gist_id}", "starred_url": "https://api.github.com/users/hmoffatt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hmoffatt/subscriptions", "organizations_url": "https://api.github.com/users/hmoffatt/orgs", "repos_url": "https://api.github.com/users/hmoffatt/repos", "events_url": "https://api.github.com/users/hmoffatt/events{/privacy}", "received_events_url": "https://api.github.com/users/hmoffatt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-06-16T03:03:14Z", "updated_at": "2022-08-02T23:22:14Z", "closed_at": "2022-08-02T23:22:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "https://lists.buildbot.net/ shows an expired certificate warning as of June 6.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6113/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/6113/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6100", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/6100/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/6100/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/6100/events", "html_url": "https://github.com/buildbot/buildbot/issues/6100", "id": 918948434, "node_id": "MDU6SXNzdWU5MTg5NDg0MzQ=", "number": 6100, "title": "Git poller state exceeds database field size after some time", "user": {"login": "felixfontein", "id": 5781356, "node_id": "MDQ6VXNlcjU3ODEzNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/5781356?v=4", "gravatar_id": "", "url": "https://api.github.com/users/felixfontein", "html_url": "https://github.com/felixfontein", "followers_url": "https://api.github.com/users/felixfontein/followers", "following_url": "https://api.github.com/users/felixfontein/following{/other_user}", "gists_url": "https://api.github.com/users/felixfontein/gists{/gist_id}", "starred_url": "https://api.github.com/users/felixfontein/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/felixfontein/subscriptions", "organizations_url": "https://api.github.com/users/felixfontein/orgs", "repos_url": "https://api.github.com/users/felixfontein/repos", "events_url": "https://api.github.com/users/felixfontein/events{/privacy}", "received_events_url": "https://api.github.com/users/felixfontein/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-06-11T16:19:29Z", "updated_at": "2021-06-30T10:27:23Z", "closed_at": "2021-06-30T10:27:23Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When the Git poller covers all branches, it can happen that eventually the `lastRev` state gets too large so that it cannot be stored in the DB anymore (resulting in `Data too long for column 'value_json' at row 1` exceptions). This is because it never forgets branches that used to exist in the past (https://github.com/buildbot/buildbot/blob/master/master/buildbot/changes/gitpoller.py#L239), so its `lastRev` state never shrinks.\r\n\r\nI'm wondering whether the `lastRev` state really needs to be updated (and not replaced) by the current set of references. The only reason why update is used (instead of replacing) I can think of is that if a branch is deleted and then restored (with the same HEAD), it will not trigger a change.\r\n\r\nI'd like to create a PR which removes the updating, or at least makes it configurable. What is the preferred solution here?", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6100/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/6100/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6054", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/6054/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/6054/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/6054/events", "html_url": "https://github.com/buildbot/buildbot/issues/6054", "id": 892337607, "node_id": "MDU6SXNzdWU4OTIzMzc2MDc=", "number": 6054, "title": "Can't start Buildbot master", "user": {"login": "seankelly", "id": 93281, "node_id": "MDQ6VXNlcjkzMjgx", "avatar_url": "https://avatars.githubusercontent.com/u/93281?v=4", "gravatar_id": "", "url": "https://api.github.com/users/seankelly", "html_url": "https://github.com/seankelly", "followers_url": "https://api.github.com/users/seankelly/followers", "following_url": "https://api.github.com/users/seankelly/following{/other_user}", "gists_url": "https://api.github.com/users/seankelly/gists{/gist_id}", "starred_url": "https://api.github.com/users/seankelly/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/seankelly/subscriptions", "organizations_url": "https://api.github.com/users/seankelly/orgs", "repos_url": "https://api.github.com/users/seankelly/repos", "events_url": "https://api.github.com/users/seankelly/events{/privacy}", "received_events_url": "https://api.github.com/users/seankelly/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-05-15T02:33:00Z", "updated_at": "2021-05-15T05:39:13Z", "closed_at": "2021-05-15T05:39:13Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Ansible updated buildbot.buildbot.net to the latest commit (81d1179e5a) and it quickly gets this in `twisted.log`\r\n```\r\n2021-05-15 02:23:55+0000 [-] while starting BuildMaster\r\n        Traceback (most recent call last):\r\n        --- <exception caught here> ---\r\n          File \"/usr/home/bbuser/buildbot/master/buildbot/master.py\", line 300, in startService\r\n            yield self.reconfigServiceWithBuildbotConfig(self.config)\r\n          File \"/usr/home/bbuser/buildbot/master/buildbot/util/service.py\", line 49, in reconfigServiceW\r\nithBuildbotConfig\r\n            yield svc.reconfigServiceWithBuildbotConfig(new_config)\r\n          File \"/usr/home/bbuser/buildbot/master/buildbot/process/measured_service.py\", line 31, in reco\r\nnfigServiceWithBuildbotConfig\r\n            yield super().reconfigServiceWithBuildbotConfig(new_config)\r\n          File \"/usr/home/bbuser/buildbot/master/buildbot/util/service.py\", line 507, in reconfigService\r\nWithBuildbotConfig\r\n            yield child.setServiceParent(self)\r\n          File \"/usr/home/bbuser/buildbot/master/buildbot/util/service.py\", line 64, in setServiceParent\r\n            yield self.parent.addService(self)\r\n          File \"/usr/home/bbuser/buildbot/master/buildbot/worker/base.py\", line 262, in startService\r\n            yield super().startService()\r\n          File \"/usr/home/bbuser/buildbot/master/buildbot/util/service.py\", line 244, in startService\r\n            yield super().startService()\r\n        twisted.internet.defer.FirstError: FirstError[#0, [Failure instance: Traceback: <class 'TypeError'>: __init__() takes 2 positional arguments but 3 were given\r\n        /usr/home/bbuser/buildbot/master/buildbot/util/service.py:94:startService\r\n        /home/bbuser/venv/lib/python3.6/site-packages/twisted/internet/defer.py:151:maybeDeferred\r\n        /home/bbuser/venv/lib/python3.6/site-packages/twisted/internet/defer.py:1613:unwindGenerator\r\n        /home/bbuser/venv/lib/python3.6/site-packages/twisted/internet/defer.py:1529:_cancellableInlineCallbacks\r\n        --- <exception caught here> ---\r\n        /home/bbuser/venv/lib/python3.6/site-packages/twisted/internet/defer.py:1418:_inlineCallbacks\r\n        /home/bbuser/venv/lib/python3.6/site-packages/buildbot_worker/null.py:34:startService\r\n        ]]\r\n```\r\n\r\nI reset to the previous merge, 1b16975313, and now it runs fine.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/6054/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/6054/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5992", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5992/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5992/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5992/events", "html_url": "https://github.com/buildbot/buildbot/issues/5992", "id": 866441789, "node_id": "MDU6SXNzdWU4NjY0NDE3ODk=", "number": 5992, "title": "compatibility with sqlalchemy 1.4", "user": {"login": "anthraxx", "id": 203012, "node_id": "MDQ6VXNlcjIwMzAxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/203012?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anthraxx", "html_url": "https://github.com/anthraxx", "followers_url": "https://api.github.com/users/anthraxx/followers", "following_url": "https://api.github.com/users/anthraxx/following{/other_user}", "gists_url": "https://api.github.com/users/anthraxx/gists{/gist_id}", "starred_url": "https://api.github.com/users/anthraxx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anthraxx/subscriptions", "organizations_url": "https://api.github.com/users/anthraxx/orgs", "repos_url": "https://api.github.com/users/anthraxx/repos", "events_url": "https://api.github.com/users/anthraxx/events{/privacy}", "received_events_url": "https://api.github.com/users/anthraxx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-04-23T21:26:29Z", "updated_at": "2021-07-30T14:01:34Z", "closed_at": "2021-07-30T09:16:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nIt would be great if buildbot gets compatibility with 1.4. In PR #5912 the constraints has simply been set to <1.4 but this is unfortunately not a solution for distro packaging of buildbot.\r\n\r\nIs there an estimated timeline for compatibility with 1.4 as this issue is blocking distro efforts?", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5992/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5992/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5991", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5991/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5991/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5991/events", "html_url": "https://github.com/buildbot/buildbot/issues/5991", "id": 863322007, "node_id": "MDU6SXNzdWU4NjMzMjIwMDc=", "number": 5991, "title": "ws_ping_interval is not added in the set of allowed keys for ww", "user": {"login": "pablogsal", "id": 11718525, "node_id": "MDQ6VXNlcjExNzE4NTI1", "avatar_url": "https://avatars.githubusercontent.com/u/11718525?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pablogsal", "html_url": "https://github.com/pablogsal", "followers_url": "https://api.github.com/users/pablogsal/followers", "following_url": "https://api.github.com/users/pablogsal/following{/other_user}", "gists_url": "https://api.github.com/users/pablogsal/gists{/gist_id}", "starred_url": "https://api.github.com/users/pablogsal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pablogsal/subscriptions", "organizations_url": "https://api.github.com/users/pablogsal/orgs", "repos_url": "https://api.github.com/users/pablogsal/repos", "events_url": "https://api.github.com/users/pablogsal/events{/privacy}", "received_events_url": "https://api.github.com/users/pablogsal/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-04-20T23:35:03Z", "updated_at": "2021-04-28T11:56:01Z", "closed_at": "2021-04-25T09:31:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "Checking the configuration after adding this parameter throws:\r\n\r\n```\r\nConfiguration Errors:\r\n  unknown www configuration parameter(s) ws_ping_interval\r\nmake: *** [Makefile:34: check] Error 1\r\n```\r\n\r\nThe parameter should be updated in https://github.com/buildbot/buildbot/blob/c1c4812cc67265798dd597b06f113943dc154112/master/buildbot/config.py#L717", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5991/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5991/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5988", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5988/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5988/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5988/events", "html_url": "https://github.com/buildbot/buildbot/issues/5988", "id": 862664701, "node_id": "MDU6SXNzdWU4NjI2NjQ3MDE=", "number": 5988, "title": "build_wait_timeout option in Latent worker not working as expected", "user": {"login": "BishopGIS", "id": 1708122, "node_id": "MDQ6VXNlcjE3MDgxMjI=", "avatar_url": "https://avatars.githubusercontent.com/u/1708122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BishopGIS", "html_url": "https://github.com/BishopGIS", "followers_url": "https://api.github.com/users/BishopGIS/followers", "following_url": "https://api.github.com/users/BishopGIS/following{/other_user}", "gists_url": "https://api.github.com/users/BishopGIS/gists{/gist_id}", "starred_url": "https://api.github.com/users/BishopGIS/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BishopGIS/subscriptions", "organizations_url": "https://api.github.com/users/BishopGIS/orgs", "repos_url": "https://api.github.com/users/BishopGIS/repos", "events_url": "https://api.github.com/users/BishopGIS/events{/privacy}", "received_events_url": "https://api.github.com/users/BishopGIS/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557389668, "node_id": "MDU6TGFiZWw1NTczODk2Njg=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/documentation", "name": "documentation", "color": "006b75", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-04-20T10:23:01Z", "updated_at": "2022-01-31T19:24:58Z", "closed_at": "2022-01-31T19:24:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Buildbot version 3.1.0 both master and latent worker (worker.LibVirtWorker).\r\n\r\nAfter upgrade from 2.4 to 3.1 the builds using latent worker begin to stop in about 10 minutes.\r\nIt seems to me that build_wait_timeout now starts timer not after the build task finished but from the moment from start of latent worker.\r\nChanging build_wait_timeout to several hours fix the problem (quick fix).\r\n\r\nAlso in documentation there is no mention to set build_wait_timeout in seconds (http://docs.buildbot.net/current/manual/configuration/workers.html?highlight=build_wait_timeout#common-options).\r\n\r\nFirst I tried to set 20 min (build_wait_timeout=20) and I got restarting latent worker every 20s.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5988/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5988/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5957", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5957/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5957/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5957/events", "html_url": "https://github.com/buildbot/buildbot/issues/5957", "id": 843557019, "node_id": "MDU6SXNzdWU4NDM1NTcwMTk=", "number": 5957, "title": "lazylogfiles broken on 3.0.2", "user": {"login": "tonyhutter", "id": 11469457, "node_id": "MDQ6VXNlcjExNDY5NDU3", "avatar_url": "https://avatars.githubusercontent.com/u/11469457?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tonyhutter", "html_url": "https://github.com/tonyhutter", "followers_url": "https://api.github.com/users/tonyhutter/followers", "following_url": "https://api.github.com/users/tonyhutter/following{/other_user}", "gists_url": "https://api.github.com/users/tonyhutter/gists{/gist_id}", "starred_url": "https://api.github.com/users/tonyhutter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tonyhutter/subscriptions", "organizations_url": "https://api.github.com/users/tonyhutter/orgs", "repos_url": "https://api.github.com/users/tonyhutter/repos", "events_url": "https://api.github.com/users/tonyhutter/events{/privacy}", "received_events_url": "https://api.github.com/users/tonyhutter/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-03-29T16:41:54Z", "updated_at": "2021-04-06T16:38:29Z", "closed_at": "2021-04-04T22:46:17Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I'm upgrading from 0.8.x to 3.0.2, and have this:\r\n```python\r\ntest_factory = util.BuildFactory()\r\n\r\ntest_factory.addStep(ShellCommand(\r\n    env={'PATH' : bin_path},\r\n    command=[\"runurl\", bb_url + \"bb-dependencies.sh\"],\r\n    decodeRC={0 : SUCCESS, 1 : FAILURE, 2 : WARNINGS, 3 : SKIPPED },\r\n    haltOnFailure=True, logEnviron=False,\r\n    lazylogfiles=True,\r\n    description=[\"installing dependencies\"],\r\n    descriptionDone=[\"installed dependencies\"]))\r\n```\r\nWhich gives me:\r\n```\r\n2021-03-26 18:38:03+0000 [-]   Invalid argument(s) passed to ShellCommand: lazylogfiles\r\n```\r\nAccording to the 3.0.2 documentation, `lazylogfiles` is a valid parameter for `ShellCommand`\r\nhttp://docs.buildbot.net/3.0.2/manual/configuration/steps/shell_command.html\r\n\r\nI originally opened a question for this (https://github.com/buildbot/buildbot/discussions/5954) but was told to open a bug instead.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5957/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5957/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5948", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5948/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5948/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5948/events", "html_url": "https://github.com/buildbot/buildbot/issues/5948", "id": 840970381, "node_id": "MDU6SXNzdWU4NDA5NzAzODE=", "number": 5948, "title": "worker version is shown incorrectly in the UI ", "user": {"login": "aj062", "id": 3098702, "node_id": "MDQ6VXNlcjMwOTg3MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3098702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aj062", "html_url": "https://github.com/aj062", "followers_url": "https://api.github.com/users/aj062/followers", "following_url": "https://api.github.com/users/aj062/following{/other_user}", "gists_url": "https://api.github.com/users/aj062/gists{/gist_id}", "starred_url": "https://api.github.com/users/aj062/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aj062/subscriptions", "organizations_url": "https://api.github.com/users/aj062/orgs", "repos_url": "https://api.github.com/users/aj062/repos", "events_url": "https://api.github.com/users/aj062/events{/privacy}", "received_events_url": "https://api.github.com/users/aj062/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-03-25T14:10:30Z", "updated_at": "2021-04-09T15:16:11Z", "closed_at": "2021-04-09T15:16:11Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "worker version is shown incorrectly in the UI, e.g.: on workers page, or individual worker pages.\r\ne.g.: \r\nhttp://buildbot.buildbot.net/#/workers\r\nhttp://buildbot.buildbot.net/#/workers/5\r\n<img width=\"1187\" alt=\"worker_version_incorrect\" src=\"https://user-images.githubusercontent.com/3098702/112486433-3de22e80-8d52-11eb-83c4-3046a9e42c58.png\">\r\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5948/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5948/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5940", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5940/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5940/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5940/events", "html_url": "https://github.com/buildbot/buildbot/issues/5940", "id": 838040161, "node_id": "MDU6SXNzdWU4MzgwNDAxNjE=", "number": 5940, "title": "Regression: Owners column empty for pending build-requests", "user": {"login": "aj062", "id": 3098702, "node_id": "MDQ6VXNlcjMwOTg3MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3098702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aj062", "html_url": "https://github.com/aj062", "followers_url": "https://api.github.com/users/aj062/followers", "following_url": "https://api.github.com/users/aj062/following{/other_user}", "gists_url": "https://api.github.com/users/aj062/gists{/gist_id}", "starred_url": "https://api.github.com/users/aj062/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aj062/subscriptions", "organizations_url": "https://api.github.com/users/aj062/orgs", "repos_url": "https://api.github.com/users/aj062/repos", "events_url": "https://api.github.com/users/aj062/events{/privacy}", "received_events_url": "https://api.github.com/users/aj062/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-03-22T19:26:25Z", "updated_at": "2021-03-22T22:08:46Z", "closed_at": "2021-03-22T22:08:46Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Owners column is empty for pending build-requests in Buildbot 2.10.2. This used to work properly in Buildbot 1.8.2\r\n\r\nThis issue can also be noticed at https://buildbot.buildbot.net/#/builders/3\r\n<img width=\"607\" alt=\"empty_owners_column_pending_buildrequests\" src=\"https://user-images.githubusercontent.com/3098702/112046835-e6aa4700-8b22-11eb-83d1-b848a16b6e04.png\">\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5940/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5940/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5933", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5933/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5933/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5933/events", "html_url": "https://github.com/buildbot/buildbot/issues/5933", "id": 836368541, "node_id": "MDU6SXNzdWU4MzYzNjg1NDE=", "number": 5933, "title": "buildbot try fails for files containing non utf-8 characters", "user": {"login": "aj062", "id": 3098702, "node_id": "MDQ6VXNlcjMwOTg3MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3098702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aj062", "html_url": "https://github.com/aj062", "followers_url": "https://api.github.com/users/aj062/followers", "following_url": "https://api.github.com/users/aj062/following{/other_user}", "gists_url": "https://api.github.com/users/aj062/gists{/gist_id}", "starred_url": "https://api.github.com/users/aj062/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aj062/subscriptions", "organizations_url": "https://api.github.com/users/aj062/orgs", "repos_url": "https://api.github.com/users/aj062/repos", "events_url": "https://api.github.com/users/aj062/events{/privacy}", "received_events_url": "https://api.github.com/users/aj062/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-03-19T21:24:55Z", "updated_at": "2021-06-16T10:00:47Z", "closed_at": "2021-06-16T10:00:47Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "buildbot try fails for files containing non utf-8 characters, i.e. different encoding.\r\n\r\ne.g.:\r\n```\r\n[~]$buildbot try --connect=pb --master=master-name:1234 --username=buildbot_try --passwd=test --diff=testfile.patch --repository=''\r\nusing 'pb' connect method\r\nUnhandled Error\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib64/python3.6/site-packages/twisted/internet/base.py\", line 913, in runUntilCurrent\r\n    call.func(*call.args, **call.kw)\r\n  File \"/usr/local/lib/python3.6/site-packages/buildbot/util/eventual.py\", line 48, in _turn\r\n    cb(*args, **kwargs)\r\n  File \"/usr/local/lib64/python3.6/site-packages/twisted/internet/defer.py\", line 460, in callback\r\n    self._startRunCallbacks(result)\r\n  File \"/usr/local/lib64/python3.6/site-packages/twisted/internet/defer.py\", line 568, in _startRunCallbacks\r\n    self._runCallbacks()\r\n--- <exception caught here> ---\r\n  File \"/usr/local/lib64/python3.6/site-packages/twisted/internet/defer.py\", line 654, in _runCallbacks\r\n    current.result = callback(current.result, *args, **kw)\r\n  File \"/usr/local/lib/python3.6/site-packages/buildbot/clients/tryclient.py\", line 937, in trapSystemExit\r\n    why.trap(SystemExit)\r\n  File \"/usr/local/lib64/python3.6/site-packages/twisted/python/failure.py\", line 460, in trap\r\n    self.raiseException()\r\n  File \"/usr/local/lib64/python3.6/site-packages/twisted/python/failure.py\", line 488, in raiseException\r\n    raise self.value.with_traceback(self.tb)\r\n  File \"/usr/local/lib64/python3.6/site-packages/twisted/internet/defer.py\", line 654, in _runCallbacks\r\n    current.result = callback(current.result, *args, **kw)\r\n  File \"/usr/local/lib/python3.6/site-packages/buildbot/clients/tryclient.py\", line 917, in <lambda>\r\n    d.addCallback(lambda res: self.createJob())\r\n  File \"/usr/local/lib/python3.6/site-packages/buildbot/clients/tryclient.py\", line 582, in createJob\r\n    diff = f.read()\r\n  File \"/usr/lib64/python3.6/codecs.py\", line 321, in decode\r\n    (result, consumed) = self._buffer_decode(data, self.errors, final)\r\nbuiltins.UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcf in position 177: invalid continuation byte\r\n\r\n[~]$cat testfile.patch\r\nprint(\"\u00cf\u00f0\u00ee\u00e2\u00e5\u00f0\u00ea\u00e0\")\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5933/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5933/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5930", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5930/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5930/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5930/events", "html_url": "https://github.com/buildbot/buildbot/issues/5930", "id": 835897808, "node_id": "MDU6SXNzdWU4MzU4OTc4MDg=", "number": 5930, "title": "[Feature] Build summary tooltip improvements", "user": {"login": "PhilippSelenium", "id": 31542906, "node_id": "MDQ6VXNlcjMxNTQyOTA2", "avatar_url": "https://avatars.githubusercontent.com/u/31542906?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PhilippSelenium", "html_url": "https://github.com/PhilippSelenium", "followers_url": "https://api.github.com/users/PhilippSelenium/followers", "following_url": "https://api.github.com/users/PhilippSelenium/following{/other_user}", "gists_url": "https://api.github.com/users/PhilippSelenium/gists{/gist_id}", "starred_url": "https://api.github.com/users/PhilippSelenium/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PhilippSelenium/subscriptions", "organizations_url": "https://api.github.com/users/PhilippSelenium/orgs", "repos_url": "https://api.github.com/users/PhilippSelenium/repos", "events_url": "https://api.github.com/users/PhilippSelenium/events{/privacy}", "received_events_url": "https://api.github.com/users/PhilippSelenium/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557387615, "node_id": "MDU6TGFiZWw1NTczODc2MTU=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/feature", "name": "feature", "color": "0e8c50", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-03-19T11:50:49Z", "updated_at": "2021-06-09T13:09:53Z", "closed_at": "2021-06-09T13:09:53Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The build summary tooltip box jumps like crazy (To a degree where it almost causes seizures ;)) when hovering over the build numbers.\r\n\r\nSolutions:\r\n* Possibility to disable build summary tooltip \r\n* rendered more relaxed and smoothly\r\n* ?\r\n\r\nSee: https://github.com/buildbot/buildbot/pull/5700", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5930/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5930/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5910", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5910/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5910/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5910/events", "html_url": "https://github.com/buildbot/buildbot/issues/5910", "id": 832230432, "node_id": "MDU6SXNzdWU4MzIyMzA0MzI=", "number": 5910, "title": "AttributeError: module 'sqlalchemy.engine.strategies' has no attribute 'PlainEngineStrategy'", "user": {"login": "daltenty", "id": 2355082, "node_id": "MDQ6VXNlcjIzNTUwODI=", "avatar_url": "https://avatars.githubusercontent.com/u/2355082?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daltenty", "html_url": "https://github.com/daltenty", "followers_url": "https://api.github.com/users/daltenty/followers", "following_url": "https://api.github.com/users/daltenty/following{/other_user}", "gists_url": "https://api.github.com/users/daltenty/gists{/gist_id}", "starred_url": "https://api.github.com/users/daltenty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daltenty/subscriptions", "organizations_url": "https://api.github.com/users/daltenty/orgs", "repos_url": "https://api.github.com/users/daltenty/repos", "events_url": "https://api.github.com/users/daltenty/events{/privacy}", "received_events_url": "https://api.github.com/users/daltenty/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-03-15T22:06:33Z", "updated_at": "2022-02-24T12:31:40Z", "closed_at": "2021-03-16T13:07:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "On buildbot version 3.0.1, since upgrading SQLAlchemy to version 1.4, `buildbot create-master` now throws an error:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/opt/buildbot/master/venv/bin/buildbot\", line 8, in <module>\r\n    sys.exit(run())\r\n  File \"/opt/buildbot/master/venv/lib/python3.8/site-packages/buildbot/scripts/runner.py\", line 772, in run\r\n    subcommandFunction = reflect.namedObject(subconfig.subcommandFunction)\r\n  File \"/opt/buildbot/master/venv/lib/python3.8/site-packages/twisted/python/reflect.py\", line 170, in namedObject\r\n    module = namedModule(\".\".join(classSplit[:-1]))\r\n  File \"/opt/buildbot/master/venv/lib/python3.8/site-packages/twisted/python/reflect.py\", line 157, in namedModule\r\n    topLevel = __import__(name)\r\n  File \"/opt/buildbot/master/venv/lib/python3.8/site-packages/buildbot/scripts/create_master.py\", line 25, in <module>\r\n    from buildbot.master import BuildMaster\r\n  File \"/opt/buildbot/master/venv/lib/python3.8/site-packages/buildbot/master.py\", line 35, in <module>\r\n    from buildbot.db import connector as dbconnector\r\n  File \"/opt/buildbot/master/venv/lib/python3.8/site-packages/buildbot/db/connector.py\", line 30, in <module>\r\n    from buildbot.db import enginestrategy\r\n  File \"/opt/buildbot/master/venv/lib/python3.8/site-packages/buildbot/db/enginestrategy.py\", line 154, in <module>\r\n    class BuildbotEngineStrategy(strategies.PlainEngineStrategy):\r\nAttributeError: module 'sqlalchemy.engine.strategies' has no attribute 'PlainEngineStrategy'\r\n````\r\n\r\nRestricting the sqlalchemy version to 1.3.23 seems to resolve this issue.\r\n\r\nSeems related to the removal of this interface in SQLAlchemy 1.4: https://github.com/sqlalchemy/sqlalchemy/commit/dfb20f07d8796ec27732df84c40b4ce4857fd83b", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5910/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5910/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5906", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5906/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5906/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5906/events", "html_url": "https://github.com/buildbot/buildbot/issues/5906", "id": 831742862, "node_id": "MDU6SXNzdWU4MzE3NDI4NjI=", "number": 5906, "title": "Message queue doesn't provide correct message for step finished", "user": {"login": "aj062", "id": 3098702, "node_id": "MDQ6VXNlcjMwOTg3MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3098702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aj062", "html_url": "https://github.com/aj062", "followers_url": "https://api.github.com/users/aj062/followers", "following_url": "https://api.github.com/users/aj062/following{/other_user}", "gists_url": "https://api.github.com/users/aj062/gists{/gist_id}", "starred_url": "https://api.github.com/users/aj062/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aj062/subscriptions", "organizations_url": "https://api.github.com/users/aj062/orgs", "repos_url": "https://api.github.com/users/aj062/repos", "events_url": "https://api.github.com/users/aj062/events{/privacy}", "received_events_url": "https://api.github.com/users/aj062/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-03-15T12:04:18Z", "updated_at": "2021-04-05T13:05:58Z", "closed_at": "2021-04-05T13:05:57Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Message queue doesn't provide correct message for step finished in Buildbot 2.10.1. It used to work in Buildbot 1.8.2.\r\n\r\nBelow is a code snippet which used to properly print step state_string in Buildbot 1.8.2 and earlier. In Buildbot 2.10.1 (and also in 2.10.2), it returns messages like: \"pending\", \"shell\" etc.. For some steps, it prints step \"description\" instead of \"descriptionDone\". It seems like this api is invoked by buildbot little too early, before descriptionDone is set.\r\n\r\n```class Events(service.BuildbotService):\r\n    @defer.inlineCallbacks\r\n    def startService(self):\r\n        yield service.BuildbotService.startService(self)\r\n        startConsuming = self.master.mq.startConsuming\r\n\r\n        self._stepStartedConsumer = yield startConsuming(self.stepStarted, ('steps', None, 'started'))\r\n        self._stepFinishedConsumer = yield startConsuming(self.stepFinished, ('steps', None, 'finished'))\r\n\r\n    def stepFinished(self, key, step):\r\n        print('step state_string: {}'.format(step.get('state_string')))\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5906/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5906/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5903", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5903/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5903/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5903/events", "html_url": "https://github.com/buildbot/buildbot/issues/5903", "id": 831012251, "node_id": "MDU6SXNzdWU4MzEwMTIyNTE=", "number": 5903, "title": "flawed HashiCorpVaultSecretProvider implementation", "user": {"login": "mixicz", "id": 17336901, "node_id": "MDQ6VXNlcjE3MzM2OTAx", "avatar_url": "https://avatars.githubusercontent.com/u/17336901?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mixicz", "html_url": "https://github.com/mixicz", "followers_url": "https://api.github.com/users/mixicz/followers", "following_url": "https://api.github.com/users/mixicz/following{/other_user}", "gists_url": "https://api.github.com/users/mixicz/gists{/gist_id}", "starred_url": "https://api.github.com/users/mixicz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mixicz/subscriptions", "organizations_url": "https://api.github.com/users/mixicz/orgs", "repos_url": "https://api.github.com/users/mixicz/repos", "events_url": "https://api.github.com/users/mixicz/events{/privacy}", "received_events_url": "https://api.github.com/users/mixicz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-03-13T22:32:16Z", "updated_at": "2021-09-17T08:03:10Z", "closed_at": "2021-09-17T08:03:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "After unsuccessfuly trying to get vault working with buildbot I realized, that current naive implementation has several major flaws preventing it to be usable in real world scenarios. To give more context, we are using hashicorp vault in production at my work for about 5 years now, having several thousand secrets stored in generic kv store. We use typically 5 level deep paths allowing us for fine grained access control to secrets.\r\n\r\n### Current issues:\r\n1. separating optional key with `/` is ambiguos, as vault path components are separated by `/` as well,\r\n2. only flat (single component) path can be used now, which is not viable real world use (it would severely hinder management of access control in vault),\r\n3. only token authentication is supported, but even when I write some python code in config to obtain it, tokens are short lived with forced TTL. So in real world scenarios buildbot uptime will typically exceed token TTL, breaking pipelines after some time after config/restart,\r\n4. vault paths in general may contain any characters so it is good practice to URL escape path components.\r\n\r\n### To resolve this I suggest following changes:\r\n1. use [HVAC](https://github.com/hvac/hvac) module for vault communication (it will help with points 3. and 4.),\r\n2. use colon `:` for separating path from key (this convention is used in [Ansible hashi_vault lookup plugin](https://docs.ansible.com/ansible/latest/collections/community/hashi_vault/hashi_vault_lookup.html)), ideally with escaping extra colons in path or key name using `\\`,\r\n3. support additional login methods, at least *approle* which is probably most typical for CI/CD pipelines,\r\n4. drop support for default `value` key, it's only confusing with no real world benefit; mentioned Ansible plugin returns dictionary with all keys when no key is specified, but I'm not sure if buildbot could handle this (if not, we can throw exception to enforce key specification).\r\n\r\nI would welcome any comments or objections regarding this topic. I'll make PR with new HashiCorpVaultSecretProvider once we agree on this.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5903/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5903/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5892", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5892/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5892/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5892/events", "html_url": "https://github.com/buildbot/buildbot/issues/5892", "id": 830212579, "node_id": "MDU6SXNzdWU4MzAyMTI1Nzk=", "number": 5892, "title": "Unknown component name: BuildStatusGenerator", "user": {"login": "lfdmn", "id": 17184363, "node_id": "MDQ6VXNlcjE3MTg0MzYz", "avatar_url": "https://avatars.githubusercontent.com/u/17184363?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lfdmn", "html_url": "https://github.com/lfdmn", "followers_url": "https://api.github.com/users/lfdmn/followers", "following_url": "https://api.github.com/users/lfdmn/following{/other_user}", "gists_url": "https://api.github.com/users/lfdmn/gists{/gist_id}", "starred_url": "https://api.github.com/users/lfdmn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lfdmn/subscriptions", "organizations_url": "https://api.github.com/users/lfdmn/orgs", "repos_url": "https://api.github.com/users/lfdmn/repos", "events_url": "https://api.github.com/users/lfdmn/events{/privacy}", "received_events_url": "https://api.github.com/users/lfdmn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-03-12T15:11:43Z", "updated_at": "2021-03-12T22:18:11Z", "closed_at": "2021-03-12T22:18:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI'm trying to create a status generator using the example code\r\n\r\n```python\r\nfrom buildbot.plugins import reporters\r\n\r\ntemplate=u'''\\\r\n<h4>Build status: {{ summary }}</h4>\r\n<p> Worker used: {{ workername }}</p>\r\n{% for step in build['steps'] %}\r\n<p> {{ step['name'] }}: {{ step['results'] }}</p>\r\n{% endfor %}\r\n<p><b> -- The Buildbot</b></p>\r\n'''\r\n\r\ngenerator = reporters.BuildStatusGenerator(\r\n    mode=('failing',),\r\n    message_formatter=reporters.MessageFormatter(\r\n        template=template, template_type='html',\r\n        wantProperties=True, wantSteps=True))\r\n\r\nc['services'] = [\r\n    reporters.MailNotifier(\r\n        fromaddr=\"buildbot@example.org\",\r\n        sendToInterestedUsers=False,\r\n        mode=('failing',),\r\n        extraRecipients=['listaddr@example.org'],\r\n        generators=[generator]\r\n    )\r\n]\r\n```\r\n\r\nI get this error\r\n```\r\n2021-03-12 16:59:48+0200 [-] Loading buildbot.tac...\r\n2021-03-12 16:59:49+0200 [-] Loaded.\r\n2021-03-12 16:59:49+0200 [-] twistd 21.2.0 (/home/damien/ci/master/env/bin/python3 3.6.9) starting up.\r\n2021-03-12 16:59:49+0200 [-] reactor class: twisted.internet.epollreactor.EPollReactor.\r\n2021-03-12 16:59:49+0200 [-] Starting BuildMaster -- buildbot.version: 3.0.0\r\n2021-03-12 16:59:49+0200 [-] Loading configuration from '/home/damien/ci/master/master.cfg'\r\n2021-03-12 16:59:49+0200 [-] error while parsing config file:\r\n\tTraceback (most recent call last):\r\n\t  File \"/home/damien/ci/master/env/lib/python3.6/site-packages/twisted/python/threadpool.py\", line 255, in <lambda>\r\n\t    ctx, func, *args, **kw\r\n\t  File \"/home/damien/ci/master/env/lib/python3.6/site-packages/twisted/python/context.py\", line 118, in callWithContext\r\n\t    return self.currentContext().callWithContext(ctx, func, *args, **kw)\r\n\t  File \"/home/damien/ci/master/env/lib/python3.6/site-packages/twisted/python/context.py\", line 83, in callWithContext\r\n\t    return func(*args, **kw)\r\n\t  File \"/home/damien/ci/master/env/lib/python3.6/site-packages/buildbot/config.py\", line 152, in loadConfig\r\n\t    self.basedir, self.configFileName)\r\n\t--- <exception caught here> ---\r\n\t  File \"/home/damien/ci/master/env/lib/python3.6/site-packages/buildbot/config.py\", line 114, in loadConfigDict\r\n\t    execfile(filename, localDict)\r\n\t  File \"/home/damien/ci/master/env/lib/python3.6/site-packages/twisted/python/compat.py\", line 225, in execfile\r\n\t    exec(code, globals, locals)\r\n\t  File \"/home/damien/ci/master/master.cfg\", line 5, in <module>\r\n\t    import blabla\r\n\t  File \"/home/damien/ci/master/blabla.py\", line 12, in <module>\r\n\t    generator = reporters.BuildStatusGenerator(\r\n\t  File \"/home/damien/ci/master/env/lib/python3.6/site-packages/buildbot/plugins/db.py\", line 278, in __getattr__\r\n\t    raise AttributeError(str(e)) from e\r\n\tbuiltins.AttributeError: Unknown component name: BuildStatusGenerator\r\n\t\r\n2021-03-12 16:59:49+0200 [-] Configuration Errors:\r\n2021-03-12 16:59:49+0200 [-]   error while parsing config file: Unknown component name: BuildStatusGenerator (traceback in logfile)\r\n2021-03-12 16:59:49+0200 [-] Halting master.\r\n2021-03-12 16:59:49+0200 [-] BuildMaster startup failed\r\n2021-03-12 16:59:49+0200 [-] BuildMaster is stopped\r\n2021-03-12 16:59:49+0200 [-] Main loop terminated.\r\n2021-03-12 16:59:49+0200 [-] Server Shut Down.\r\n```\r\n\r\nI'm having difficulties tracking this one down.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5892/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5892/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5888", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5888/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5888/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5888/events", "html_url": "https://github.com/buildbot/buildbot/issues/5888", "id": 828217775, "node_id": "MDU6SXNzdWU4MjgyMTc3NzU=", "number": 5888, "title": "changes page doesn't show data for Owners and Worker columns", "user": {"login": "aj062", "id": 3098702, "node_id": "MDQ6VXNlcjMwOTg3MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3098702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aj062", "html_url": "https://github.com/aj062", "followers_url": "https://api.github.com/users/aj062/followers", "following_url": "https://api.github.com/users/aj062/following{/other_user}", "gists_url": "https://api.github.com/users/aj062/gists{/gist_id}", "starred_url": "https://api.github.com/users/aj062/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aj062/subscriptions", "organizations_url": "https://api.github.com/users/aj062/orgs", "repos_url": "https://api.github.com/users/aj062/repos", "events_url": "https://api.github.com/users/aj062/events{/privacy}", "received_events_url": "https://api.github.com/users/aj062/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-03-10T19:16:17Z", "updated_at": "2021-03-25T17:30:02Z", "closed_at": "2021-03-25T17:30:02Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "changes page doesn't show data for Owners and Worker columns.\r\n\r\nBelow screenshot for http://buildbot.buildbot.net/#/changes/9005 shows empty Owners and Worker columns.\r\n\r\n<img width=\"1169\" alt=\"changes_page_empty_columns\" src=\"https://user-images.githubusercontent.com/3098702/110684426-267c4080-81ab-11eb-851b-a27be46b1ff2.png\">\r\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5888/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5888/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5887", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5887/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5887/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5887/events", "html_url": "https://github.com/buildbot/buildbot/issues/5887", "id": 828214358, "node_id": "MDU6SXNzdWU4MjgyMTQzNTg=", "number": 5887, "title": "workers page doesn't show data for Owners and Worker columns", "user": {"login": "aj062", "id": 3098702, "node_id": "MDQ6VXNlcjMwOTg3MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3098702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aj062", "html_url": "https://github.com/aj062", "followers_url": "https://api.github.com/users/aj062/followers", "following_url": "https://api.github.com/users/aj062/following{/other_user}", "gists_url": "https://api.github.com/users/aj062/gists{/gist_id}", "starred_url": "https://api.github.com/users/aj062/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aj062/subscriptions", "organizations_url": "https://api.github.com/users/aj062/orgs", "repos_url": "https://api.github.com/users/aj062/repos", "events_url": "https://api.github.com/users/aj062/events{/privacy}", "received_events_url": "https://api.github.com/users/aj062/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-03-10T19:13:07Z", "updated_at": "2021-03-23T18:28:31Z", "closed_at": "2021-03-23T18:28:31Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "workers page doesn't show data for Owners and Worker columns.\r\n\r\nBelow screenshot for http://buildbot.buildbot.net/#/workers/5 shows empty Owners and Worker columns.\r\n\r\n<img width=\"1436\" alt=\"workers_page_empty_columns\" src=\"https://user-images.githubusercontent.com/3098702/110684042-a9e96200-81aa-11eb-8253-e7af0aa572d2.png\">\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5887/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5887/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5877", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5877/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5877/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5877/events", "html_url": "https://github.com/buildbot/buildbot/issues/5877", "id": 825059589, "node_id": "MDU6SXNzdWU4MjUwNTk1ODk=", "number": 5877, "title": "FileDownload fails with exception when file not available", "user": {"login": "aj062", "id": 3098702, "node_id": "MDQ6VXNlcjMwOTg3MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3098702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aj062", "html_url": "https://github.com/aj062", "followers_url": "https://api.github.com/users/aj062/followers", "following_url": "https://api.github.com/users/aj062/following{/other_user}", "gists_url": "https://api.github.com/users/aj062/gists{/gist_id}", "starred_url": "https://api.github.com/users/aj062/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aj062/subscriptions", "organizations_url": "https://api.github.com/users/aj062/orgs", "repos_url": "https://api.github.com/users/aj062/repos", "events_url": "https://api.github.com/users/aj062/events{/privacy}", "received_events_url": "https://api.github.com/users/aj062/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-03-08T23:29:07Z", "updated_at": "2021-04-09T15:05:51Z", "closed_at": "2021-04-09T15:05:50Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "transfer.FileDownload fails with exception when expected file is not available. It should be gracefully handled, and the step should just fail, instead of causing an exception.\r\n\r\nException:\r\n```Traceback (most recent call last):\r\n  File \"/usr/local/lib64/python3.8/site-packages/twisted/internet/defer.py\", line 654, in _runCallbacks\r\n    current.result = callback(current.result, *args, **kw)\r\n  File \"/usr/local/lib64/python3.8/site-packages/twisted/internet/defer.py\", line 1475, in gotResult\r\n    _inlineCallbacks(r, g, status)\r\n  File \"/usr/local/lib64/python3.8/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\n    result = result.throwExceptionIntoGenerator(g)\r\n  File \"/usr/local/lib64/python3.8/site-packages/twisted/python/failure.py\", line 512, in throwExceptionIntoGenerator\r\n    return g.throw(self.type, self.value, self.tb)\r\n--- <exception caught here> ---\r\n  File \"/usr/local/lib/python3.8/site-packages/buildbot/process/buildstep.py\", line 628, in startStep\r\n    self.results = yield self.run()\r\n  File \"/usr/local/lib64/python3.8/site-packages/twisted/internet/defer.py\", line 1418, in _inlineCallbacks\r\n    result = g.send(result)\r\n  File \"/usr/local/lib/python3.8/site-packages/buildbot/steps/transfer.py\", line 459, in run\r\n    fp = open(source, 'rb')\r\nbuiltins.FileNotFoundError: [Errno 2] No such file or directory: '123456.zip'\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5877/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5877/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5844", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5844/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5844/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5844/events", "html_url": "https://github.com/buildbot/buildbot/issues/5844", "id": 820638328, "node_id": "MDU6SXNzdWU4MjA2MzgzMjg=", "number": 5844, "title": "Windows Worker: When TASKKILL fails on 'TERM', does not retry on 'KILL'", "user": {"login": "klhowell", "id": 12501977, "node_id": "MDQ6VXNlcjEyNTAxOTc3", "avatar_url": "https://avatars.githubusercontent.com/u/12501977?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klhowell", "html_url": "https://github.com/klhowell", "followers_url": "https://api.github.com/users/klhowell/followers", "following_url": "https://api.github.com/users/klhowell/following{/other_user}", "gists_url": "https://api.github.com/users/klhowell/gists{/gist_id}", "starred_url": "https://api.github.com/users/klhowell/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klhowell/subscriptions", "organizations_url": "https://api.github.com/users/klhowell/orgs", "repos_url": "https://api.github.com/users/klhowell/repos", "events_url": "https://api.github.com/users/klhowell/events{/privacy}", "received_events_url": "https://api.github.com/users/klhowell/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-03-03T03:40:40Z", "updated_at": "2022-02-03T20:44:42Z", "closed_at": "2022-02-03T20:44:41Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "On my Windows Server 2016 worker, when trying to cancel a Step (either manually or due to timeout), the initial TASKKILL command (without /F) causes an exception, and the forced TASKKILL (with /F) is never run.\r\n\r\n> [Broker,client] Unhandled Error\r\n>         Traceback (most recent call last):\r\n>           File \"c:\\python38\\lib\\site-packages\\twisted\\spread\\banana.py\", line 173, in gotItem\r\n>             self.callExpressionReceived(item)\r\n>           File \"c:\\python38\\lib\\site-packages\\twisted\\spread\\banana.py\", line 136, in callExpressionReceived\r\n>             self.expressionReceived(obj)\r\n>           File \"c:\\python38\\lib\\site-packages\\twisted\\spread\\pb.py\", line 621, in expressionReceived\r\n>             method(*sexp[1:])\r\n>           File \"c:\\python38\\lib\\site-packages\\twisted\\spread\\pb.py\", line 1025, in proto_message\r\n>             self._recvMessage(self.localObjectForID, requestID, objectID, message, answerRequired, netArgs, netKw)\r\n>         --- <exception caught here> ---\r\n>           File \"c:\\python38\\lib\\site-packages\\twisted\\spread\\pb.py\", line 1054, in _recvMessage\r\n>             netResult = object.remoteMessageReceived(self, message, netArgs, netKw)\r\n>           File \"c:\\python38\\lib\\site-packages\\twisted\\spread\\flavors.py\", line 125, in remoteMessageReceived\r\n>             state = method(*args, **kw)\r\n>           File \"c:\\python38\\lib\\site-packages\\buildbot_worker\\base.py\", line 169, in remote_interruptCommand\r\n>             self.command.doInterrupt()\r\n>           File \"c:\\python38\\lib\\site-packages\\buildbot_worker\\commands\\base.py\", line 189, in doInterrupt\r\n>             self.interrupt()\r\n>           File \"c:\\python38\\lib\\site-packages\\buildbot_worker\\commands\\shell.py\", line 58, in interrupt\r\n>             self.command.kill(\"command interrupted\")\r\n>           File \"c:\\python38\\lib\\site-packages\\buildbot_worker\\runprocess.py\", line 945, in kill\r\n>             self.sendSig(\"TERM\")\r\n>           File \"c:\\python38\\lib\\site-packages\\buildbot_worker\\runprocess.py\", line 900, in sendSig\r\n>             subprocess.check_call(\r\n>           File \"c:\\python38\\lib\\subprocess.py\", line 364, in check_call\r\n>             raise CalledProcessError(retcode, cmd)\r\n>         subprocess.CalledProcessError: Command 'TASKKILL /PID 2204 /T' returned non-zero exit status 128.\r\n\r\nI've manually invoked the failing TASKKILL command, and it does fail with error code 128. However, the failure reason that it reports is that one of the child processes in the tree must be killed with '/F'.\r\n\r\n> C:\\Users\\Administrator>TASKKILL /PID 2204 /T\r\n> ERROR: The process with PID 2488 (child process of PID 2344) could not be terminated.\r\n> Reason: This process can only be terminated forcefully (with /F option).\r\n> ...\r\n\r\nBecause runprocess.py uses the 'check_call()' method without an exception handler, the error code translates to an unhandled python exception and the code never gets to schedule the 'KILL' version of the command (which successfully terminates the process tree when I run it manually).\r\n\r\nIt looks to me like there either needs to be an exception handler for the win32 path in sendSig() or the method needs to use 'subprocess.call()' instead of 'subprocess.check_call()'. ", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5844/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5844/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5794", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5794/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5794/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5794/events", "html_url": "https://github.com/buildbot/buildbot/issues/5794", "id": 807762791, "node_id": "MDU6SXNzdWU4MDc3NjI3OTE=", "number": 5794, "title": "gitpoller: exceptions must be classes or instances deriving from BaseException, not type", "user": {"login": "aliceinwire", "id": 107572, "node_id": "MDQ6VXNlcjEwNzU3Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/107572?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aliceinwire", "html_url": "https://github.com/aliceinwire", "followers_url": "https://api.github.com/users/aliceinwire/followers", "following_url": "https://api.github.com/users/aliceinwire/following{/other_user}", "gists_url": "https://api.github.com/users/aliceinwire/gists{/gist_id}", "starred_url": "https://api.github.com/users/aliceinwire/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aliceinwire/subscriptions", "organizations_url": "https://api.github.com/users/aliceinwire/orgs", "repos_url": "https://api.github.com/users/aliceinwire/repos", "events_url": "https://api.github.com/users/aliceinwire/events{/privacy}", "received_events_url": "https://api.github.com/users/aliceinwire/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2021-02-13T14:51:02Z", "updated_at": "2021-06-05T02:29:48Z", "closed_at": "2021-06-05T02:29:48Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "```\r\nbuildbot_1               | 2021-02-13 09:28:45+0000 [-] trying to poll branch refs/heads/4.1 of https://github.com/GKernelCI/linux-patches.git\r\nbuildbot_1               |      Traceback (most recent call last):\r\nbuildbot_1               |        File \"/usr/lib/python3.8/site-packages/twisted/internet/defer.py\", line 654, in _runCallbacks\r\nbuildbot_1               |          current.result = callback(current.result, *args, **kw)\r\nbuildbot_1               |        File \"/usr/lib/python3.8/site-packages/twisted/internet/defer.py\", line 1475, in gotResult\r\nbuildbot_1               |          _inlineCallbacks(r, g, status)\r\nbuildbot_1               |        File \"/usr/lib/python3.8/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\nbuildbot_1               |          result = result.throwExceptionIntoGenerator(g)\r\nbuildbot_1               |        File \"/usr/lib/python3.8/site-packages/twisted/python/failure.py\", line 512, in throwExceptionIntoGenerator\r\nbuildbot_1               |          return g.throw(self.type, self.value, self.tb)\r\nbuildbot_1               |      --- <exception caught here> ---\r\nbuildbot_1               |        File \"/usr/lib/python3.8/site-packages/buildbot/changes/gitpoller.py\", line 220, in poll\r\nbuildbot_1               |          yield self._process_changes(revs[branch], branch)\r\nbuildbot_1               |        File \"/usr/lib/python3.8/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\nbuildbot_1               |          result = result.throwExceptionIntoGenerator(g)\r\nbuildbot_1               |        File \"/usr/lib/python3.8/site-packages/twisted/python/failure.py\", line 512, in throwExceptionIntoGenerator\r\nbuildbot_1               |          return g.throw(self.type, self.value, self.tb)\r\nbuildbot_1               |        File \"/usr/lib/python3.8/site-packages/buildbot/changes/gitpoller.py\", line 311, in _process_changes\r\nbuildbot_1               |          results = yield self._dovccmd('log', revListArgs, path=self.workdir)\r\nbuildbot_1               |        File \"/usr/lib/python3.8/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\nbuildbot_1               |          result = result.throwExceptionIntoGenerator(g)\r\nbuildbot_1               |        File \"/usr/lib/python3.8/site-packages/twisted/python/failure.py\", line 512, in throwExceptionIntoGenerator\r\nbuildbot_1               |          return g.throw(self.type, self.value, self.tb)\r\nbuildbot_1               |        File \"/usr/lib/python3.8/site-packages/buildbot/changes/gitpoller.py\", line 405, in _dovccmd\r\nbuildbot_1               |          stdout = yield self._dovccmdImpl(command, args, path, None)\r\nbuildbot_1               |        File \"/usr/lib/python3.8/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\nbuildbot_1               |          result = result.throwExceptionIntoGenerator(g)\r\nbuildbot_1               |        File \"/usr/lib/python3.8/site-packages/twisted/python/failure.py\", line 512, in throwExceptionIntoGenerator\r\nbuildbot_1               |          return g.throw(self.type, self.value, self.tb)\r\nbuildbot_1               |      builtins.TypeError: exceptions must be classes or instances deriving from BaseException, not type\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5794/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5794/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5792", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5792/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5792/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5792/events", "html_url": "https://github.com/buildbot/buildbot/issues/5792", "id": 805999968, "node_id": "MDU6SXNzdWU4MDU5OTk5Njg=", "number": 5792, "title": "Some tasks that are stopped refuse to end, require manager restart to clear", "user": {"login": "YngveNPettersen", "id": 3061808, "node_id": "MDQ6VXNlcjMwNjE4MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/3061808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/YngveNPettersen", "html_url": "https://github.com/YngveNPettersen", "followers_url": "https://api.github.com/users/YngveNPettersen/followers", "following_url": "https://api.github.com/users/YngveNPettersen/following{/other_user}", "gists_url": "https://api.github.com/users/YngveNPettersen/gists{/gist_id}", "starred_url": "https://api.github.com/users/YngveNPettersen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/YngveNPettersen/subscriptions", "organizations_url": "https://api.github.com/users/YngveNPettersen/orgs", "repos_url": "https://api.github.com/users/YngveNPettersen/repos", "events_url": "https://api.github.com/users/YngveNPettersen/events{/privacy}", "received_events_url": "https://api.github.com/users/YngveNPettersen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-02-11T01:00:16Z", "updated_at": "2021-03-01T21:11:06Z", "closed_at": "2021-03-01T21:11:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "We have occasional incidents when cancelling ongoing buildbot tasks that the task remain in \"Building\" (Yellow bagde) mode, and is impossible to end even after rebooting the worker or restarting the buildbot worker process (not sure if it is always Windows workers). The result is that the worker cannot start new tasks until the buildbot manager process has been shut down and restarted.\r\n\r\nBased on log from the most recent case, a precondition may be that the taskkill operation fails, and this causes some kind of logic state that is not resolved unless the buildbot manager is shut down and restarted. Multiple clicks on the task stop button does not resolve the situation, even after the worker has reconnected.\r\n\r\nIIRC loss of connection normally do end the task, but in this case the Stop button had been clicked before the worker process was ended (manually), and it seems that this causes some kind of exception that prevents the buildbot manager from ending the task.\r\n\r\n```\r\n2021-02-10 23:43:36+0000 [_GenericHTTPChannelProtocol,6850,1.2.3.4]  <Build OurBuilder number:535 results:warnings>: stopping build: no reason 6\r\n2021-02-10 23:43:36+0000 [_GenericHTTPChannelProtocol,6850,1.2.3.4] RemoteCommand.interrupt <RemoteShellCommand '['git', 'submodule', 'foreach', '--recursive', 'git submodule sync; git submodule update --init --force --checkout']'> no reason\r\n2021-02-10 23:43:36+0000 [Broker (TLSMemoryBIOProtocol),63,1.2.3.4] RemoteCommand.interrupt failed <RemoteShellCommand '['git', 'submodule', 'foreach', '--recursive', 'git submodule sync; git submodule update --init --force --checkout']'> b\"Command 'TASKKILL /PID 7128 /T' returned non-zero exit status 128\"\r\n2021-02-10 23:43:39+0000 [Broker (TLSMemoryBIOProtocol),64,1.2.3.4] <RemoteShellCommand '['git', 'submodule', 'update', '--init', '--force', '--checkout']'> rc=0\r\n2021-02-10 23:43:39+0000 [-] <RemoteShellCommand '['git', 'submodule', 'foreach', '--recursive', 'git submodule sync; git submodule update --init --force --checkout']'>: RemoteCommand.run [7766]\r\n2021-02-10 23:43:39+0000 [-] command '['git', 'submodule', 'foreach', '--recursive', 'git submodule sync; git submodule update --init --force --checkout']' in dir 'build/vivaldi'\r\n\r\n2021-02-10 23:45:03+0000 [Broker (TLSMemoryBIOProtocol),63,1.2.3.4] <Build OurBuilder number:535 results:cancelled>.lostRemote\r\n2021-02-10 23:45:03+0000 [Broker (TLSMemoryBIOProtocol),63,1.2.3.4]  stopping currentStep OurGit(repourl='repo.git', mode='incremental', method='fresh', submodules=True, progress=True, retryFetch=True, name='update', workdir='build/vivaldi', timeout=5400, env={'PATH': ['C:\\\\Program Files\\\\Git\\\\cmd', '${PATH}']}, clobberOnFailure=True, haltOnFailure=True)\r\n2021-02-10 23:45:03+0000 [Broker (TLSMemoryBIOProtocol),63,1.2.3.4] RemoteCommand.interrupt <RemoteShellCommand '['git', 'submodule', 'foreach', '--recursive', 'git submodule sync; git submodule update --init --force --checkout']'> [Failure instance: Traceback (failure with no frames): <class 'twisted.internet.error.ConnectionLost'>: Connection to the other side was lost in a non-clean fashion.\r\n        ]\r\n2021-02-10 23:45:03+0000 [Broker (TLSMemoryBIOProtocol),63,1.2.3.4] Got fatal Exception on DB\r\n        Traceback (most recent call last):\r\n          File \"sandbox/lib/python3.6/site-packages/twisted/python/threadpool.py\", line 266, in <lambda>\r\n            inContext.theWork = lambda: context.call(ctx, func, *args, **kw)\r\n          File \"sandbox/lib/python3.6/site-packages/twisted/python/context.py\", line 122, in callWithContext\r\n            return self.currentContext().callWithContext(ctx, func, *args, **kw)\r\n          File \"sandbox/lib/python3.6/site-packages/twisted/python/context.py\", line 85, in callWithContext\r\n            return func(*args,**kw)\r\n          File \"sandbox/lib/python3.6/site-packages/buildbot/db/pool.py\", line 217, in __thd\r\n            log.err(e, 'Got fatal Exception on DB')\r\n        --- <exception caught here> ---\r\n          File \"sandbox/lib/python3.6/site-packages/buildbot/db/pool.py\", line 190, in __thd\r\n            rv = callable(arg, *args, **kwargs)\r\n          File \"sandbox/lib/python3.6/site-packages/buildbot/db/logs.py\", line 155, in thdAddLog\r\n            \"log with slug '%r' already exists in this step\" % (slug,)) from e\r\n        builtins.KeyError: \"log with slug ''cancelled'' already exists in this step\"\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5792/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5792/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5760", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5760/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5760/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5760/events", "html_url": "https://github.com/buildbot/buildbot/issues/5760", "id": 790166500, "node_id": "MDU6SXNzdWU3OTAxNjY1MDA=", "number": 5760, "title": "GitHub hook does not work without token", "user": {"login": "umar456", "id": 457510, "node_id": "MDQ6VXNlcjQ1NzUxMA==", "avatar_url": "https://avatars.githubusercontent.com/u/457510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/umar456", "html_url": "https://github.com/umar456", "followers_url": "https://api.github.com/users/umar456/followers", "following_url": "https://api.github.com/users/umar456/following{/other_user}", "gists_url": "https://api.github.com/users/umar456/gists{/gist_id}", "starred_url": "https://api.github.com/users/umar456/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/umar456/subscriptions", "organizations_url": "https://api.github.com/users/umar456/orgs", "repos_url": "https://api.github.com/users/umar456/repos", "events_url": "https://api.github.com/users/umar456/events{/privacy}", "received_events_url": "https://api.github.com/users/umar456/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-01-20T17:13:20Z", "updated_at": "2021-03-06T21:37:20Z", "closed_at": "2021-03-06T21:37:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "GitHub accepts requests for its API without requiring a token for public repositories. Commit  f1d01ecac8beea3766d7e101b2afd281e396346e seems to break this by requiring a token to get the files from the GitHub API. Because of this (and maybe other commits) my instance of buildbot is not creating change sets for the incoming hooks.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5760/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5760/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5757", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5757/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5757/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5757/events", "html_url": "https://github.com/buildbot/buildbot/issues/5757", "id": 787862450, "node_id": "MDU6SXNzdWU3ODc4NjI0NTA=", "number": 5757, "title": "Renderable locks fail with 2.10", "user": {"login": "franz", "id": 90404, "node_id": "MDQ6VXNlcjkwNDA0", "avatar_url": "https://avatars.githubusercontent.com/u/90404?v=4", "gravatar_id": "", "url": "https://api.github.com/users/franz", "html_url": "https://github.com/franz", "followers_url": "https://api.github.com/users/franz/followers", "following_url": "https://api.github.com/users/franz/following{/other_user}", "gists_url": "https://api.github.com/users/franz/gists{/gist_id}", "starred_url": "https://api.github.com/users/franz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/franz/subscriptions", "organizations_url": "https://api.github.com/users/franz/orgs", "repos_url": "https://api.github.com/users/franz/repos", "events_url": "https://api.github.com/users/franz/events{/privacy}", "received_events_url": "https://api.github.com/users/franz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-01-18T02:17:08Z", "updated_at": "2021-01-27T21:09:18Z", "closed_at": "2021-01-27T21:09:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nI have a buildbot setup with a bunch of DockerLatentWorkers and I use a renderable lock to avoid launching too much Docker builds on a physical machine. This worked fine with 2.8.3 but stopped working when i updated buildbot to 2.10. The error reported is:\r\n\r\n```\r\n2021-01-18 01:56:45+0000 [-] added buildset 182 to database\r\n2021-01-18 01:56:45+0000 [-] from maybeStartBuild for builder 'llvm_100_pthread'\r\n\tTraceback (most recent call last):\r\n\t  File \"/home/alarm/VENV/lib/python3.9/site-packages/buildbot/process/buildrequestdistributor.py\", line 194, in popNextBuild\r\n\t    canStart = yield self.canStartBuild(worker, breq)\r\n\t  File \"/home/alarm/VENV/lib/python3.9/site-packages/buildbot/process/buildrequestdistributor.py\", line 267, in canStartBuild\r\n\t    return self.bldr.canStartBuild(worker, breq)\r\n\t  File \"/usr/lib/python3.9/site-packages/twisted/internet/defer.py\", line 1613, in unwindGenerator\r\n\t    return _cancellableInlineCallbacks(gen)\r\n\t  File \"/usr/lib/python3.9/site-packages/twisted/internet/defer.py\", line 1529, in _cancellableInlineCallbacks\r\n\t    _inlineCallbacks(None, g, status)\r\n\t--- <exception caught here> ---\r\n\t  File \"/home/alarm/VENV/lib/python3.9/site-packages/buildbot/process/buildrequestdistributor.py\", line 478, in _activityLoop\r\n\t    yield self._maybeStartBuildsOnBuilder(bldr)\r\n\t  File \"/home/alarm/VENV/lib/python3.9/site-packages/buildbot/process/buildrequestdistributor.py\", line 495, in _maybeStartBuildsOnBuilder\r\n\t    worker, breqs = yield bc.chooseNextBuild()\r\n\t  File \"/home/alarm/VENV/lib/python3.9/site-packages/buildbot/process/buildrequestdistributor.py\", line 62, in chooseNextBuild\r\n\t    worker, breq = yield self.popNextBuild()\r\n\t  File \"/home/alarm/VENV/lib/python3.9/site-packages/buildbot/process/buildrequestdistributor.py\", line 194, in popNextBuild\r\n\t    canStart = yield self.canStartBuild(worker, breq)\r\n\t  File \"/usr/lib/python3.9/site-packages/twisted/internet/defer.py\", line 1418, in _inlineCallbacks\r\n\t    result = g.send(result)\r\n\t  File \"/home/alarm/VENV/lib/python3.9/site-packages/buildbot/process/builder.py\", line 300, in canStartBuild\r\n\t    locks = yield props.render(locks)\r\n\tbuiltins.AttributeError: 'NoneType' object has no attribute 'render'\r\n```\r\n\r\nI'll create a PR with a fix.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5757/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5757/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5745", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5745/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5745/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5745/events", "html_url": "https://github.com/buildbot/buildbot/issues/5745", "id": 782005265, "node_id": "MDU6SXNzdWU3ODIwMDUyNjU=", "number": 5745, "title": "Worker stuck in building state after worker disconnection", "user": {"login": "jpflori", "id": 1288156, "node_id": "MDQ6VXNlcjEyODgxNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1288156?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jpflori", "html_url": "https://github.com/jpflori", "followers_url": "https://api.github.com/users/jpflori/followers", "following_url": "https://api.github.com/users/jpflori/following{/other_user}", "gists_url": "https://api.github.com/users/jpflori/gists{/gist_id}", "starred_url": "https://api.github.com/users/jpflori/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jpflori/subscriptions", "organizations_url": "https://api.github.com/users/jpflori/orgs", "repos_url": "https://api.github.com/users/jpflori/repos", "events_url": "https://api.github.com/users/jpflori/events{/privacy}", "received_events_url": "https://api.github.com/users/jpflori/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 23, "created_at": "2021-01-08T10:11:31Z", "updated_at": "2021-05-15T05:39:25Z", "closed_at": "2021-05-15T05:39:25Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The connection got lost but the build went on, or rather kept waiting for worker feedback.\r\nI tried to stop the build by clicking the stop button but it does not work and stays in yellow/building.\r\nIt only adds new lines with:\r\n`no reason`\r\nor\r\n`[Failure instance: Traceback (failure with no frames): <class 'twisted.internet.error.ConnectionLost'>: Connection to the other side was lost in a non-clean fashion. ]`\r\n\r\nI'm working on giving a fuller log and precise repro instructions.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5745/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5745/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5698", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5698/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5698/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5698/events", "html_url": "https://github.com/buildbot/buildbot/issues/5698", "id": 767461678, "node_id": "MDU6SXNzdWU3Njc0NjE2Nzg=", "number": 5698, "title": "Exception sometimes thrown by steps.MsBuild14", "user": {"login": "jodogne", "id": 6000889, "node_id": "MDQ6VXNlcjYwMDA4ODk=", "avatar_url": "https://avatars.githubusercontent.com/u/6000889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jodogne", "html_url": "https://github.com/jodogne", "followers_url": "https://api.github.com/users/jodogne/followers", "following_url": "https://api.github.com/users/jodogne/following{/other_user}", "gists_url": "https://api.github.com/users/jodogne/gists{/gist_id}", "starred_url": "https://api.github.com/users/jodogne/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jodogne/subscriptions", "organizations_url": "https://api.github.com/users/jodogne/orgs", "repos_url": "https://api.github.com/users/jodogne/repos", "events_url": "https://api.github.com/users/jodogne/events{/privacy}", "received_events_url": "https://api.github.com/users/jodogne/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2020-12-15T10:56:27Z", "updated_at": "2023-01-28T00:57:54Z", "closed_at": "2021-10-18T08:43:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nSince my upgrade to BuildBot 1.9.2, if using the `MsBuild14` step to build a Visual Studio 2015 solution, I sometimes (not always) obtain the following trace in the `twistd.log`:\r\n\r\n```\r\n2020-12-15 10:53:20+0100 [-] when trying to finish a log\r\n\tTraceback (most recent call last):\r\n\t  File \"/usr/local/lib/python3.5/dist-packages/twisted/internet/defer.py\", line 501, in errback\r\n\t    self._startRunCallbacks(fail)\r\n\t  File \"/usr/local/lib/python3.5/dist-packages/twisted/internet/defer.py\", line 568, in _startRunCallbacks\r\n\t    self._runCallbacks()\r\n\t  File \"/usr/local/lib/python3.5/dist-packages/twisted/internet/defer.py\", line 654, in _runCallbacks\r\n\t    current.result = callback(current.result, *args, **kw)\r\n\t  File \"/usr/local/lib/python3.5/dist-packages/twisted/internet/defer.py\", line 1475, in gotResult\r\n\t    _inlineCallbacks(r, g, status)\r\n\t--- <exception caught here> ---\r\n\t  File \"/usr/local/lib/python3.5/dist-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\n\t    result = result.throwExceptionIntoGenerator(g)\r\n\t  File \"/usr/local/lib/python3.5/dist-packages/twisted/python/failure.py\", line 491, in throwExceptionIntoGenerator\r\n\t    return g.throw(self.type, self.value, self.tb)\r\n\t  File \"/usr/local/lib/python3.5/dist-packages/buildbot/process/log.py\", line 203, in finish\r\n\t    yield super().finish()\r\n\t  File \"/usr/local/lib/python3.5/dist-packages/twisted/internet/defer.py\", line 1418, in _inlineCallbacks\r\n\t    result = g.send(result)\r\n\t  File \"/usr/local/lib/python3.5/dist-packages/buildbot/process/log.py\", line 115, in finish\r\n\t    self._had_errors = len(self.subPoint.pop_exceptions()) > 0\r\n\tbuiltins.TypeError: object of type 'NoneType' has no len()\r\n\t\r\n2020-12-15 10:53:20+0100 [-] releaseLocks(MsBuild14(env={'PreferredToolArchitecture': 'x64'}, workdir='build/Build', projectfile='OrthancMySQL.sln', config='Release', platform='x64')): []\r\n2020-12-15 10:53:20+0100 [-]  step 'compile' complete: exception (['built solution for Release|x64'])\r\n2020-12-15 10:53:20+0100 [-]  <Build DB mainline - MySQL - VC2015-64 Release number:699 results:exception>: build finished\r\n```\r\n\r\nThe build is then aborted and tagged with the `EXCEPTION` tag.  When I look at the `stdio` stream from Visual Studio, the build is reported as a success, and the binaries are properly generated:\r\n\r\n```\r\n    2551 Warning(s)\r\n    0 Error(s)\r\nTime Elapsed 00:07:53.31\r\nprogram finished with exit code 0\r\nelapsedTime=475.270000\r\n```\r\n\r\nThis issue might be related to a large number of warnings being generated by Visual Studio, which seems to take long time to be parsed from `stdio` to `warnings` (this parsing seems to last more than 1 minute, which I find highly suspicious), although I am unsure about this. This issue didn't occur on releases 1.8.x of BuildBot.\r\n\r\nThanks in advance for your help, and thanks for your hard work on BuildBot!", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5698/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5698/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5669", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5669/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5669/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5669/events", "html_url": "https://github.com/buildbot/buildbot/issues/5669", "id": 757884163, "node_id": "MDU6SXNzdWU3NTc4ODQxNjM=", "number": 5669, "title": "db upgrade broken with sqlalchemy.exc.NoSuchTableError: migration_tmp", "user": {"login": "landryb", "id": 3421760, "node_id": "MDQ6VXNlcjM0MjE3NjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3421760?v=4", "gravatar_id": "", "url": "https://api.github.com/users/landryb", "html_url": "https://github.com/landryb", "followers_url": "https://api.github.com/users/landryb/followers", "following_url": "https://api.github.com/users/landryb/following{/other_user}", "gists_url": "https://api.github.com/users/landryb/gists{/gist_id}", "starred_url": "https://api.github.com/users/landryb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/landryb/subscriptions", "organizations_url": "https://api.github.com/users/landryb/orgs", "repos_url": "https://api.github.com/users/landryb/repos", "events_url": "https://api.github.com/users/landryb/events{/privacy}", "received_events_url": "https://api.github.com/users/landryb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 22, "created_at": "2020-12-06T09:28:58Z", "updated_at": "2020-12-15T01:00:41Z", "closed_at": "2020-12-15T01:00:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\nexact same issue as #4978 :\r\n```\r\nupgrading database (sqlite:/state.sqlite)         \r\nWarning: Stopping this process might cause data loss                                                                                                                                                                 \r\n'A serious error has been encountered during the upgrade. The previous upgrade has been likely interrupted. The database has been damaged and automatic recovery is impossible.'\r\n'If you believe this is an error, please submit a bug to the Buildbot project.'                                                                                                                                      \r\nGot fatal Exception on DB                      \r\nTraceback (most recent call last):                                                                                                                                                                                   \r\n  File \"/usr/local/lib/python3.8/site-packages/twisted/python/threadpool.py\", line 266, in <lambda>\r\n    inContext.theWork = lambda: context.call(ctx, func, *args, **kw)                                                                                                                                                 \r\n  File \"/usr/local/lib/python3.8/site-packages/twisted/python/context.py\", line 122, in callWithContext                                                                                                              \r\n    return self.currentContext().callWithContext(ctx, func, *args, **kw)                                                                                                                                             \r\n  File \"/usr/local/lib/python3.8/site-packages/twisted/python/context.py\", line 85, in callWithContext                                                                                                               \r\n    return func(*args,**kw)                                                                               \r\n  File \"/usr/local/lib/python3.8/site-packages/buildbot/db/pool.py\", line 217, in __thd                                                                                                                              \r\n    log.err(e, 'Got fatal Exception on DB')                                                                                                                                                                          \r\n--- <exception caught here> ---                                                                                                                                                                                      \r\n  File \"/usr/local/lib/python3.8/site-packages/buildbot/db/pool.py\", line 190, in __thd                   \r\n    rv = callable(arg, *args, **kwargs)                                                                                                                                                                              \r\n  File \"/usr/local/lib/python3.8/site-packages/buildbot/db/model.py\", line 1089, in thd                                                                                                                              \r\n    upgrade(engine)                                                                                                                                                                                                  \r\n  File \"/usr/local/lib/python3.8/site-packages/buildbot/db/model.py\", line 1053, in upgrade                                                                                                                          \r\n    schema.runchange(version, change, 1)                                                                                                                                                                             \r\n  File \"/usr/local/lib/python3.8/site-packages/migrate/versioning/schema.py\", line 93, in runchange       \r\n    change.run(self.engine, step)                                                                         \r\n  File \"/usr/local/lib/python3.8/site-packages/migrate/versioning/script/py.py\", line 154, in run                                                                                                                    \r\n    script_func(engine)                        \r\n  File \"/usr/local/lib/python3.8/site-packages/buildbot/db/migrate/versions/058_add_build_data_length.py\", line 27, in upgrade                                                                                       \r\n    build_data_table = sautils.Table('build_data', metadata, autoload=True)                               \r\n  File \"/usr/local/lib/python3.8/site-packages/buildbot/util/sautils.py\", line 62, in Table               \r\n    return sa.Table(*args, **kwargs)                                                                                                                                                                                 \r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py\", line 469, in __new__                                                                                                                       \r\n    metadata._remove_table(name, schema)          \r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py\", line 67, in __exit__                                                                                                                 \r\n    compat.reraise(exc_type, exc_value, exc_tb)                                                           \r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/util/compat.py\", line 277, in reraise                                                                                                                      \r\n    raise value\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py\", line 464, in __new__\r\n    table._init(name, metadata, *args, **kw)\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py\", line 551, in _init\r\n    self._autoload(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py\", line 585, in _autoload\r\n    bind.run_callable(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/engine/base.py\", line 2125, in run_callable\r\n    return conn.run_callable(callable_, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/engine/base.py\", line 1596, in run_callable\r\n    return callable_(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/engine/default.py\", line 414, in reflecttable\r\n    return insp.reflecttable(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/engine/reflection.py\", line 645, in reflecttable \r\n    self._reflect_fk(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/engine/reflection.py\", line 818, in _reflect_fk\r\n    sa_schema.Table(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py\", line 469, in __new__\r\n    metadata._remove_table(name, schema)\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py\", line 67, in __exit__\r\n    compat.reraise(exc_type, exc_value, exc_tb)\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/util/compat.py\", line 277, in reraise\r\n    raise value\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py\", line 464, in __new__\r\n    table._init(name, metadata, *args, **kw)\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py\", line 551, in _init\r\n    self._autoload(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py\", line 569, in _autoload\r\n    autoload_with.run_callable(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/engine/base.py\", line 1596, in run_callable\r\n    return callable_(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/engine/default.py\", line 414, in reflecttable\r\n    return insp.reflecttable(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/engine/reflection.py\", line 645, in reflecttable \r\n    self._reflect_fk(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/engine/reflection.py\", line 818, in _reflect_fk\r\n    sa_schema.Table(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py\", line 469, in __new__\r\n    metadata._remove_table(name, schema)\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py\", line 67, in __exit__\r\n    compat.reraise(exc_type, exc_value, exc_tb)\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/util/compat.py\", line 277, in reraise\r\n    raise value\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py\", line 464, in __new__\r\n    table._init(name, metadata, *args, **kw)\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py\", line 551, in _init\r\n    self._autoload(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py\", line 569, in _autoload\r\n    autoload_with.run_callable(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/engine/base.py\", line 1596, in run_callable\r\n    return callable_(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/engine/default.py\", line 414, in reflecttable\r\n    return insp.reflecttable(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/engine/reflection.py\", line 645, in reflecttable \r\n    self._reflect_fk(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/engine/reflection.py\", line 818, in _reflect_fk\r\n    sa_schema.Table(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py\", line 469, in __new__\r\n    metadata._remove_table(name, schema)\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py\", line 67, in __exit__\r\n    compat.reraise(exc_type, exc_value, exc_tb)\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/util/compat.py\", line 277, in reraise\r\n    raise value\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py\", line 464, in __new__\r\n    table._init(name, metadata, *args, **kw)\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py\", line 551, in _init\r\n    self._autoload(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py\", line 569, in _autoload\r\n    autoload_with.run_callable(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/engine/base.py\", line 1596, in run_callable\r\n    return callable_(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/engine/default.py\", line 414, in reflecttable\r\n    return insp.reflecttable(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/engine/reflection.py\", line 645, in reflecttable \r\n    self._reflect_fk(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/engine/reflection.py\", line 818, in _reflect_fk\r\n    sa_schema.Table(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py\", line 469, in __new__\r\n    metadata._remove_table(name, schema)\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py\", line 67, in __exit__\r\n    compat.reraise(exc_type, exc_value, exc_tb)\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/util/compat.py\", line 277, in reraise\r\n    raise value\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py\", line 464, in __new__\r\n    table._init(name, metadata, *args, **kw)\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py\", line 551, in _init\r\n    self._autoload(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py\", line 569, in _autoload\r\n    autoload_with.run_callable(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/engine/base.py\", line 1596, in run_callable\r\n    return callable_(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/engine/default.py\", line 414, in reflecttable\r\n    return insp.reflecttable(\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/engine/reflection.py\", line 639, in reflecttable \r\n    raise exc.NoSuchTableError(table.name)\r\nsqlalchemy.exc.NoSuchTableError: migration_tmp\r\nproblem while upgrading!:\r\n```\r\n\r\nso.. sigh.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5669/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5669/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5464", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5464/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5464/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5464/events", "html_url": "https://github.com/buildbot/buildbot/issues/5464", "id": 680265632, "node_id": "MDU6SXNzdWU2ODAyNjU2MzI=", "number": 5464, "title": "Reconfigurion is failing with exceptions", "user": {"login": "sri-codefresh", "id": 60429148, "node_id": "MDQ6VXNlcjYwNDI5MTQ4", "avatar_url": "https://avatars.githubusercontent.com/u/60429148?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sri-codefresh", "html_url": "https://github.com/sri-codefresh", "followers_url": "https://api.github.com/users/sri-codefresh/followers", "following_url": "https://api.github.com/users/sri-codefresh/following{/other_user}", "gists_url": "https://api.github.com/users/sri-codefresh/gists{/gist_id}", "starred_url": "https://api.github.com/users/sri-codefresh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sri-codefresh/subscriptions", "organizations_url": "https://api.github.com/users/sri-codefresh/orgs", "repos_url": "https://api.github.com/users/sri-codefresh/repos", "events_url": "https://api.github.com/users/sri-codefresh/events{/privacy}", "received_events_url": "https://api.github.com/users/sri-codefresh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-08-17T14:09:31Z", "updated_at": "2021-09-05T02:36:28Z", "closed_at": "2021-09-05T02:36:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "buildbot master has started to run multiple builds.\r\nAnd these builds are using Master locks for exclusive Compilation.\r\n\r\nDuring this phase, buildbot reconfig has executed.\r\n\r\nThen, we are getting following error.\r\n\r\n2020-08-17 15:03:06+0200 [-] Unhandled Error\r\n\tTraceback (most recent call last):\r\n\t  File \"/h/svcbbemi/bb_venv/lib/python3.6/site-packages/twisted/internet/defer.py\", line 460, in callback\r\n\t    self._startRunCallbacks(result)\r\n\t  File \"/h/svcbbemi/bb_venv/lib/python3.6/site-packages/twisted/internet/defer.py\", line 568, in _startRunCallbacks\r\n\t    self._runCallbacks()\r\n\t  File \"/h/svcbbemi/bb_venv/lib/python3.6/site-packages/twisted/internet/defer.py\", line 654, in _runCallbacks\r\n\t    current.result = callback(current.result, *args, **kw)\r\n\t  File \"/h/svcbbemi/bb_venv/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1475, in gotResult\r\n\t    _inlineCallbacks(r, g, status)\r\n\t--- <exception caught here> ---\r\n\t  File \"/h/svcbbemi/bb_venv/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1418, in _inlineCallbacks\r\n\t    result = g.send(result)\r\n\t  File \"/h/svcbbemi/buildbot/master/buildbot/process/buildstep.py\", line 524, in startStep\r\n\t    self.locks = yield botmaster.getLockFromLockAccesses(self.locks, self.build.config_version)\r\n\tbuiltins.AttributeError: 'NoneType' object has no attribute 'getLockFromLockAccesses'\r\n\r\nAny hints are helpful to debug this issue further", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5464/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5464/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5451", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5451/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5451/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5451/events", "html_url": "https://github.com/buildbot/buildbot/issues/5451", "id": 678646154, "node_id": "MDU6SXNzdWU2Nzg2NDYxNTQ=", "number": 5451, "title": "Github integration not successful for user in a team", "user": {"login": "xeniorac", "id": 23617086, "node_id": "MDQ6VXNlcjIzNjE3MDg2", "avatar_url": "https://avatars.githubusercontent.com/u/23617086?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xeniorac", "html_url": "https://github.com/xeniorac", "followers_url": "https://api.github.com/users/xeniorac/followers", "following_url": "https://api.github.com/users/xeniorac/following{/other_user}", "gists_url": "https://api.github.com/users/xeniorac/gists{/gist_id}", "starred_url": "https://api.github.com/users/xeniorac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xeniorac/subscriptions", "organizations_url": "https://api.github.com/users/xeniorac/orgs", "repos_url": "https://api.github.com/users/xeniorac/repos", "events_url": "https://api.github.com/users/xeniorac/events{/privacy}", "received_events_url": "https://api.github.com/users/xeniorac/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-08-13T18:23:10Z", "updated_at": "2020-08-28T15:08:46Z", "closed_at": "2020-08-28T15:08:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\nfrom buildbot.plugins import util\r\nc['www'] = {\r\n    # ...\r\n    'auth': util.GitHubAuth(\"clientid\", \"clientsecret\", apiVersion=4,\r\n                            getTeamsMembership=True),\r\n    'authz': util.Authz(\r\n        allowRules=[\r\n          util.AnyControlEndpointMatcher(role=\"checkers\"),\r\n        ],\r\n        roleMatchers=[\r\n          util.RolesFromGroups(groupPrefix='buildbotvb/')\r\n        ]\r\n      )\r\n}\r\n```\r\n\r\nI have the above added to my buildbot to allow users from buildbotvb org belonging to the team checkers... \r\nAs per the documentation...\r\n\r\nAny members inside the team checkers under buildbotvb must be able to run rebuilds and stuffs... \r\nI can login successfully via Github but when I click rebuild it get's me an error saying \r\n\r\n*Cannot rebuild: you need to have role 'checker'*\r\n\r\nCan I know what am I missing here?\r\n\r\nThis works great for basic user:pass auth though", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5451/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5451/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5444", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5444/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5444/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5444/events", "html_url": "https://github.com/buildbot/buildbot/issues/5444", "id": 673645777, "node_id": "MDU6SXNzdWU2NzM2NDU3Nzc=", "number": 5444, "title": "command 'buildbot try' doesn't work with p4", "user": {"login": "GaryFunKing", "id": 68108846, "node_id": "MDQ6VXNlcjY4MTA4ODQ2", "avatar_url": "https://avatars.githubusercontent.com/u/68108846?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GaryFunKing", "html_url": "https://github.com/GaryFunKing", "followers_url": "https://api.github.com/users/GaryFunKing/followers", "following_url": "https://api.github.com/users/GaryFunKing/following{/other_user}", "gists_url": "https://api.github.com/users/GaryFunKing/gists{/gist_id}", "starred_url": "https://api.github.com/users/GaryFunKing/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GaryFunKing/subscriptions", "organizations_url": "https://api.github.com/users/GaryFunKing/orgs", "repos_url": "https://api.github.com/users/GaryFunKing/repos", "events_url": "https://api.github.com/users/GaryFunKing/events{/privacy}", "received_events_url": "https://api.github.com/users/GaryFunKing/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-08-05T15:47:45Z", "updated_at": "2021-03-01T21:19:03Z", "closed_at": "2021-03-01T21:19:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI am currently trying to use the 'buildbot try' command line.\r\nI use the pb connect methode and our vc is perforce.\r\nI found a first bug in tryclient.py in the readPatch function of PerforceExtractor.\r\nAt line 270 : \r\n`for line in res.split(\"\\n\"):`\r\nres is a byte type and not a string type.\r\nI made a quick fix like this : \r\n```\r\nresAsString = res.decode(\"utf-8\")\r\n        for line in resAsString.split(\"\\n\"):\r\n```\r\nwith this the job is correctly send to the master, but then I have this error on the master : \r\n```\r\n\r\n2020-08-05 16:32:41+0200 [-] <Build myBuild number:None results:success>.startBuild\r\n2020-08-05 16:32:41+0200 [-] from a running build; this is a serious error - please file a bug at http://buildbot.net\r\n        Traceback (most recent call last):\r\n          File \"/usr/lib/python3/dist-packages/twisted/internet/defer.py\", line 460, in callback\r\n            self._startRunCallbacks(result)\r\n          File \"/usr/lib/python3/dist-packages/twisted/internet/defer.py\", line 568, in _startRunCallbacks\r\n            self._runCallbacks()\r\n          File \"/usr/lib/python3/dist-packages/twisted/internet/defer.py\", line 654, in _runCallbacks\r\n            current.result = callback(current.result, *args, **kw)\r\n          File \"/usr/lib/python3/dist-packages/twisted/internet/defer.py\", line 1475, in gotResult\r\n            _inlineCallbacks(r, g, status)\r\n        --- <exception caught here> ---\r\n          File \"/usr/lib/python3/dist-packages/twisted/internet/defer.py\", line 1418, in _inlineCallbacks\r\n            result = g.send(result)\r\n          File \"/home/buildbot/.local/lib/python3.7/site-packages/buildbot/process/build.py\", line 318, in startBuild\r\n            self.setupOwnProperties()\r\n          File \"/home/buildbot/.local/lib/python3.7/site-packages/buildbot/process/build.py\", line 241, in setupOwnProperties\r\n            props.setProperty(\"revision\", source.revision, \"Build\")\r\n          File \"/home/buildbot/.local/lib/python3.7/site-packages/buildbot/process/properties.py\", line 194, in setProperty\r\n            json.dumps(value)  # Let the exception propagate ...\r\n          File \"/usr/lib/python3.7/json/__init__.py\", line 231, in dumps\r\n            return _default_encoder.encode(obj)\r\n          File \"/usr/lib/python3.7/json/encoder.py\", line 199, in encode\r\n            chunks = self.iterencode(o, _one_shot=True)\r\n          File \"/usr/lib/python3.7/json/encoder.py\", line 257, in iterencode\r\n            return _iterencode(o, 0)\r\n          File \"/usr/lib/python3.7/json/encoder.py\", line 179, in default\r\n            raise TypeError(f'Object of type {o.__class__.__name__} '\r\n        builtins.TypeError: Object of type bytes is not JSON serializable\r\n```\r\nIt look like another type error.\r\nThis error is really troublesome because it create a build who never finish is worker_preparation step.\r\nI can't stop it, and I can't restart the master. The only way to stop the build is to reboot the master computer.\r\n\r\nFor information, the command line I use is : \r\nbuildbot try --connect=pb --master=XXX.XXX.XXX.X:XXXX --username=myName --passwd=myPassword --vc=p4 --builder=myBuilder --branch=dev", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5444/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5444/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5237", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5237/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5237/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5237/events", "html_url": "https://github.com/buildbot/buildbot/issues/5237", "id": 580551554, "node_id": "MDU6SXNzdWU1ODA1NTE1NTQ=", "number": 5237, "title": "\"YOUR BROWSER IS OUT OF DATE\" error in web interface.", "user": {"login": "vext01", "id": 604955, "node_id": "MDQ6VXNlcjYwNDk1NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/604955?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vext01", "html_url": "https://github.com/vext01", "followers_url": "https://api.github.com/users/vext01/followers", "following_url": "https://api.github.com/users/vext01/following{/other_user}", "gists_url": "https://api.github.com/users/vext01/gists{/gist_id}", "starred_url": "https://api.github.com/users/vext01/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vext01/subscriptions", "organizations_url": "https://api.github.com/users/vext01/orgs", "repos_url": "https://api.github.com/users/vext01/repos", "events_url": "https://api.github.com/users/vext01/events{/privacy}", "received_events_url": "https://api.github.com/users/vext01/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557399128, "node_id": "MDU6TGFiZWw1NTczOTkxMjg=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/web%20UI", "name": "web UI", "color": "bfd4f2", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-03-13T11:49:43Z", "updated_at": "2021-07-25T21:40:28Z", "closed_at": "2021-07-25T21:40:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nWhen visiting a buildbot instance in the [DuckDuckGo Privacy Browser for Android](https://play.google.com/store/apps/details?id=com.duckduckgo.mobile.android&hl=en_GB) you are greeted with a rather obnoxious error message:\r\n\r\n![buildbot](https://user-images.githubusercontent.com/604955/76618437-7ab0fe00-6520-11ea-9e7d-822777a54eeb.png)\r\n\r\nSince it's recommending Chrome, I guess it's generated by a dependency from Google somewhere?\r\n\r\nCan it be killed?\r\n\r\nThanks\r\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5237/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5237/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5224", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5224/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5224/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5224/events", "html_url": "https://github.com/buildbot/buildbot/issues/5224", "id": 577087909, "node_id": "MDU6SXNzdWU1NzcwODc5MDk=", "number": 5224, "title": "Tests are freezing/hanging on debian unstable", "user": {"login": "rjarry", "id": 472286, "node_id": "MDQ6VXNlcjQ3MjI4Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/472286?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rjarry", "html_url": "https://github.com/rjarry", "followers_url": "https://api.github.com/users/rjarry/followers", "following_url": "https://api.github.com/users/rjarry/following{/other_user}", "gists_url": "https://api.github.com/users/rjarry/gists{/gist_id}", "starred_url": "https://api.github.com/users/rjarry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rjarry/subscriptions", "organizations_url": "https://api.github.com/users/rjarry/orgs", "repos_url": "https://api.github.com/users/rjarry/repos", "events_url": "https://api.github.com/users/rjarry/events{/privacy}", "received_events_url": "https://api.github.com/users/rjarry/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-06T17:57:25Z", "updated_at": "2020-03-27T14:36:02Z", "closed_at": "2020-03-27T14:35:11Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The tests are completely freezing with version 2.7.0 on debian unstable until the build is interrupted with ctrl-c.\r\n\r\nI can reproduce the problem systematically:\r\n\r\n```\r\n~$ git clone https://salsa.debian.org/python-team/applications/buildbot/\r\n...\r\n~$ cd buildbot\r\n~$ gbp buildpackage\r\n...\r\nI: pybuild base:217: PYTHONPATH=pkg:/<<PKGBUILDDIR>>/debian/tmp//usr/lib/python3.8/dist-packages PATH=$PATH:/<<PKGBUILDDIR>>/debian/tmp/usr/bin trial3 -xe buildbot.test buildbot_worker.test\r\nbuildbot.test.integration.interop.test_commandmixin\r\n  CommandMixinMaster\r\n    test_commandmixin ...                                                  [OK]\r\n  CommandMixinMasterPB\r\n    test_commandmixin ... Traceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\n    result = result.throwExceptionIntoGenerator(g)\r\n  File \"/usr/lib/python3/dist-packages/twisted/python/failure.py\", line 491, in throwExceptionIntoGenerator\r\n    return g.throw(self.type, self.value, self.tb)\r\n  File \"/<<PKGBUILDDIR>>/debian/tmp/usr/lib/python3.8/dist-packages/buildbot/test/integration/interop/test_commandmixin.py\", line 31, in test_commandmixin\r\n    yield self.setupConfig(masterConfig())\r\n  File \"/usr/lib/python3/dist-packages/twisted/internet/defer.py\", line 1418, in _inlineCallbacks\r\n    result = g.send(result)\r\n  File \"/<<PKGBUILDDIR>>/debian/tmp/usr/lib/python3.8/dist-packages/buildbot/test/util/integration.py\", line 197, in setupConfig\r\n    yield self.w.setServiceParent(m)\r\n  File \"/usr/lib/python3/dist-packages/twisted/application/service.py\", line 193, in setServiceParent\r\n    self.parent.addService(self)\r\n  File \"/<<PKGBUILDDIR>>/debian/tmp/usr/lib/python3.8/dist-packages/buildbot/util/service.py\", line 117, in addService\r\n    return service.startService()\r\n  File \"/<<PKGBUILDDIR>>/debian/tmp/usr/lib/python3.8/dist-packages/buildbot_worker/pb.py\", line 236, in startService\r\n    WorkerBase.startService(self)\r\n  File \"/<<PKGBUILDDIR>>/debian/tmp/usr/lib/python3.8/dist-packages/buildbot_worker/base.py\", line 418, in startService\r\n    service.MultiService.startService(self)\r\n  File \"/usr/lib/python3/dist-packages/twisted/application/service.py\", line 288, in startService\r\n    service.startService()\r\n  File \"/usr/lib/python3/dist-packages/twisted/application/internet.py\", line 1132, in startService\r\n    self._machine.start()\r\n  File \"/usr/lib/python3/dist-packages/automat/_methodical.py\", line 126, in __get__\r\n    def doInput(*args, **kwargs):\r\n  File \"/usr/lib/python3/dist-packages/automat/_introspection.py\", line 39, in decorator\r\n    return copyfunction(decorated,\r\n  File \"/usr/lib/python3/dist-packages/automat/_introspection.py\", line 31, in copyfunction\r\n    return function(copycode(template.__code__, codechanges), *values)\r\n  File \"/usr/lib/python3/dist-packages/automat/_introspection.py\", line 19, in copycode\r\n    return code(*values)\r\nbuiltins.TypeError: an integer is required (got type bytes)\r\n[ERROR]\r\n<<<<<<<<<<<<<<<<<<< HANGS FOREVER >>>>>>>>>>>>>>>>>>>>>>>>>\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5224/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5224/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5215", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5215/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5215/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5215/events", "html_url": "https://github.com/buildbot/buildbot/issues/5215", "id": 572758826, "node_id": "MDU6SXNzdWU1NzI3NTg4MjY=", "number": 5215, "title": "httpclientservice unit tests are failing when txrequests is not available", "user": {"login": "rjarry", "id": 472286, "node_id": "MDQ6VXNlcjQ3MjI4Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/472286?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rjarry", "html_url": "https://github.com/rjarry", "followers_url": "https://api.github.com/users/rjarry/followers", "following_url": "https://api.github.com/users/rjarry/following{/other_user}", "gists_url": "https://api.github.com/users/rjarry/gists{/gist_id}", "starred_url": "https://api.github.com/users/rjarry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rjarry/subscriptions", "organizations_url": "https://api.github.com/users/rjarry/orgs", "repos_url": "https://api.github.com/users/rjarry/repos", "events_url": "https://api.github.com/users/rjarry/events{/privacy}", "received_events_url": "https://api.github.com/users/rjarry/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p12tic", "id": 1056711, "node_id": "MDQ6VXNlcjEwNTY3MTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1056711?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p12tic", "html_url": "https://github.com/p12tic", "followers_url": "https://api.github.com/users/p12tic/followers", "following_url": "https://api.github.com/users/p12tic/following{/other_user}", "gists_url": "https://api.github.com/users/p12tic/gists{/gist_id}", "starred_url": "https://api.github.com/users/p12tic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p12tic/subscriptions", "organizations_url": "https://api.github.com/users/p12tic/orgs", "repos_url": "https://api.github.com/users/p12tic/repos", "events_url": "https://api.github.com/users/p12tic/events{/privacy}", "received_events_url": "https://api.github.com/users/p12tic/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p12tic", "id": 1056711, "node_id": "MDQ6VXNlcjEwNTY3MTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1056711?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p12tic", "html_url": "https://github.com/p12tic", "followers_url": "https://api.github.com/users/p12tic/followers", "following_url": "https://api.github.com/users/p12tic/following{/other_user}", "gists_url": "https://api.github.com/users/p12tic/gists{/gist_id}", "starred_url": "https://api.github.com/users/p12tic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p12tic/subscriptions", "organizations_url": "https://api.github.com/users/p12tic/orgs", "repos_url": "https://api.github.com/users/p12tic/repos", "events_url": "https://api.github.com/users/p12tic/events{/privacy}", "received_events_url": "https://api.github.com/users/p12tic/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-02-28T13:34:45Z", "updated_at": "2020-03-02T10:42:32Z", "closed_at": "2020-03-02T10:42:32Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When running the unit tests without txrequests installed:\r\n\r\n```\r\n===============================================================================\r\n[ERROR]\r\nTraceback (most recent call last):\r\n  File \"/<<PKGBUILDDIR>>/debian/tmp/usr/lib/python3.7/dist-packages/buildbot/test/unit/test_util_httpclientservice.py\", line 236, in setUp\r\n    httpclientservice.HTTPClientService.getService(self.parent, 'http://foo',\r\nbuiltins.AttributeError: 'HTTPClientServiceTestTReqNoEncoding' object has no attribute 'parent'\r\n\r\nbuildbot.test.unit.test_util_httpclientservice.HTTPClientServiceTestTReqNoEncoding.test_post_raw\r\nbuildbot.test.unit.test_util_httpclientservice.HTTPClientServiceTestTReqNoEncoding.test_post_rawlist\r\n===============================================================================\r\n[ERROR]\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/twisted/internet/defer.py\", line 1418, in _inlineCallbacks\r\n    result = g.send(result)\r\n  File \"/<<PKGBUILDDIR>>/debian/tmp/usr/lib/python3.7/dist-packages/buildbot/test/unit/test_util_httpclientservice.py\", line 54, in setUp\r\n    raise unittest.SkipTest('this test requires txrequests and treq')\r\ntwisted.trial.unittest.SkipTest: this test requires txrequests and treq\r\n\r\nbuildbot.test.unit.test_util_httpclientservice.HTTPClientServiceTestTxRequest.test_post_headers\r\nbuildbot.test.unit.test_util_httpclientservice.HTTPClientServiceTestTxRequest.test_post_headers\r\nbuildbot.test.unit.test_util_httpclientservice.HTTPClientServiceTestTxRequestNoEncoding.test_post_rawlist\r\nbuildbot.test.unit.test_util_httpclientservice.HTTPClientServiceTestTxRequestNoEncoding.test_post_rawlist\r\n===============================================================================\r\n[ERROR]\r\nTraceback (most recent call last):\r\n  File \"/<<PKGBUILDDIR>>/debian/tmp/usr/lib/python3.7/dist-packages/buildbot/test/unit/test_util_httpclientservice.py\", line 134, in setUp\r\n    httpclientservice.HTTPClientService.getService(self.parent, 'http://foo',\r\nbuiltins.AttributeError: 'HTTPClientServiceTestTxRequestNoEncoding' object has no attribute 'parent'\r\n\r\nbuildbot.test.unit.test_util_httpclientservice.HTTPClientServiceTestTxRequestNoEncoding.test_post_raw\r\nbuildbot.test.unit.test_util_httpclientservice.HTTPClientServiceTestTxRequestNoEncoding.test_post_rawlist\r\n```\r\n\r\nThese tests should be skipped. In fact, they were skipped with version 2.6.0 but they are failing with 2.7.0.\r\n\r\nThis seems caused by #5191.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5215/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5215/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5165", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5165/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5165/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5165/events", "html_url": "https://github.com/buildbot/buildbot/issues/5165", "id": 553855220, "node_id": "MDU6SXNzdWU1NTM4NTUyMjA=", "number": 5165, "title": "prepareSourcestampListForTrigger fails when sourcestamp contains a patch_body", "user": {"login": "ehohenstein-imvu", "id": 14223101, "node_id": "MDQ6VXNlcjE0MjIzMTAx", "avatar_url": "https://avatars.githubusercontent.com/u/14223101?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ehohenstein-imvu", "html_url": "https://github.com/ehohenstein-imvu", "followers_url": "https://api.github.com/users/ehohenstein-imvu/followers", "following_url": "https://api.github.com/users/ehohenstein-imvu/following{/other_user}", "gists_url": "https://api.github.com/users/ehohenstein-imvu/gists{/gist_id}", "starred_url": "https://api.github.com/users/ehohenstein-imvu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ehohenstein-imvu/subscriptions", "organizations_url": "https://api.github.com/users/ehohenstein-imvu/orgs", "repos_url": "https://api.github.com/users/ehohenstein-imvu/repos", "events_url": "https://api.github.com/users/ehohenstein-imvu/events{/privacy}", "received_events_url": "https://api.github.com/users/ehohenstein-imvu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-01-22T23:30:30Z", "updated_at": "2021-03-05T08:37:54Z", "closed_at": "2021-03-05T08:37:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "Our Buildbot configuration has a builder that will trigger another builder but this fails when we use the Buildbot try command to submit a build with a patch. The patch file is binary but the `prepareSourcestampListForTrigger()` function in `master/buildbot/steps/trigger.py` calls `asDict()` on the buildrequest instance and that fails an assertion that all of the fields in the buildrequest have values that are of type string, int, or None. The assertion fails because the patch_body field is binary (as I think it probably should be).\r\n\r\nHere is a stack trace in case that helps:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/twisted/internet/defer.py\", line 1442, in gotResult\r\n    _inlineCallbacks(r, g, deferred)\r\n  File \"/usr/lib/python3/dist-packages/twisted/internet/defer.py\", line 1386, in _inlineCallbacks\r\n    result = g.send(result)\r\n  File \"/home/cit/.local/lib/python3.6/site-packages/buildbot/process/buildstep.py\", line 567, in startStep\r\n    self.results = yield self.run()\r\n  File \"/usr/lib/python3/dist-packages/twisted/internet/defer.py\", line 1532, in unwindGenerator\r\n    return _inlineCallbacks(None, gen, Deferred())\r\n--- <exception caught here> ---\r\n  File \"/usr/lib/python3/dist-packages/twisted/internet/defer.py\", line 1386, in _inlineCallbacks\r\n    result = g.send(result)\r\n  File \"/home/cit/.local/lib/python3.6/site-packages/buildbot/steps/trigger.py\", line 257, in run\r\n    ss_for_trigger = self.prepareSourcestampListForTrigger()\r\n  File \"/home/cit/.local/lib/python3.6/site-packages/buildbot/steps/trigger.py\", line 167, in prepareSourcestampListForTrigger\r\n    ss_for_trigger[ss.codebase] = ss.asDict()\r\n  File \"/home/cit/.local/lib/python3.6/site-packages/buildbot/process/buildrequest.py\", line 137, in asDict\r\n    ), result\r\nbuiltins.AssertionError: {'branch': None, 'revision': '8a3fad6b5f844704f678af71d10fdc822ff11641', 'repository': 'ssh://some-private-git-host/infra/bb-test.git', 'project': '', 'codebase': '', 'patch_level': 1, 'patch_body': b':100755 100755 1465b4e... 0000000... M\\ttest\\n\\ndiff --git a/test b/test\\nindex 1465b4e..c8548bb 100755\\n--- a/test\\n+++ b/test\\n@@ -4,5 +4,5 @@ echo \"This is a fake test to be run by a test buildbot\"\\n \\n echo \"Still not actually running any tests\"\\n \\n-echo \"NO TESTS PASSED!!!\"\\n+echo \"NO TESTS PASSED, BUT ALL TESTS PASSED!!!\"\\n \\n', 'patch_subdir': '', 'patch_author': 'ehohenstein', 'patch_comment': 'ehohenstein'}\r\n```\r\n\r\nAlso, here is a patch (based on v2.6.0) with the fix that I am suggesting, though I'm not familiar enough with Buildbot code to know if this is really the right fix for this problem:\r\n\r\n```\r\ndiff --git a/master/buildbot/process/buildrequest.py b/master/buildbot/process/buildrequest.py\r\nindex be37254..45201e0 100644\r\n--- a/master/buildbot/process/buildrequest.py\r\n+++ b/master/buildbot/process/buildrequest.py\r\n@@ -132,7 +132,7 @@ class TempSourceStamp:\r\n             result['patch_%s' % attr] = patch.get(attr)\r\n\r\n         assert all(\r\n-            isinstance(val, (str, int, type(None)))\r\n+            isinstance(val, (str, int, type(None), bytes))\r\n             for attr, val in result.items()\r\n         ), result\r\n         return result\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5165/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5165/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5161", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5161/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5161/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5161/events", "html_url": "https://github.com/buildbot/buildbot/issues/5161", "id": 551955841, "node_id": "MDU6SXNzdWU1NTE5NTU4NDE=", "number": 5161, "title": "The example dashboard in the documentation does not work properly", "user": {"login": "pablogsal", "id": 11718525, "node_id": "MDQ6VXNlcjExNzE4NTI1", "avatar_url": "https://avatars.githubusercontent.com/u/11718525?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pablogsal", "html_url": "https://github.com/pablogsal", "followers_url": "https://api.github.com/users/pablogsal/followers", "following_url": "https://api.github.com/users/pablogsal/following{/other_user}", "gists_url": "https://api.github.com/users/pablogsal/gists{/gist_id}", "starred_url": "https://api.github.com/users/pablogsal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pablogsal/subscriptions", "organizations_url": "https://api.github.com/users/pablogsal/orgs", "repos_url": "https://api.github.com/users/pablogsal/repos", "events_url": "https://api.github.com/users/pablogsal/events{/privacy}", "received_events_url": "https://api.github.com/users/pablogsal/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-01-19T17:37:21Z", "updated_at": "2020-01-21T21:46:41Z", "closed_at": "2020-01-21T21:46:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "When trying the example dashboard in the [documentation](http://docs.buildbot.net/latest/manual/customization.html#writing-dashboards-with-flask-or-bottle) I get this error in the inspect tab of my browser:\r\n\r\n```\r\nVM450:4 Uncaught ReferenceError: $ is not defined\r\n    at <anonymous>:4:9\r\n    at w (jquery.js:124)\r\n    at qe (jquery.js:5945)\r\n    at M.fn.init.append (jquery.js:6081)\r\n    at M.fn.init.<anonymous> (jquery.js:6175)\r\n    at W (jquery.js:3962)\r\n    at M.fn.init.html (jquery.js:6142)\r\n    at Object.<anonymous> (viewDirective.js:310)\r\n    at angular.js:1390\r\n    at He (angular.js:11269)\r\n```\r\n\r\nwhich comes from this line in the template:\r\n\r\n```\r\n        $.getScript(\"https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.bundle.min.js\",\r\n``` \r\n\r\nDid something changed in recent versions of buildbot regarding jquery?\r\n\r\nVersions:\r\n\r\n```\r\nbuildbot==2.5.1\r\nbuildbot-console-view==2.5.1\r\nbuildbot-grid-view==2.5.1\r\nbuildbot-waterfall-view==2.5.1\r\nbuildbot-worker==2.5.1\r\nbuildbot-wsgi-dashboards==2.5.1\r\nbuildbot-www==2.5.1\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5161/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5161/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5155", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5155/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5155/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5155/events", "html_url": "https://github.com/buildbot/buildbot/issues/5155", "id": 549178959, "node_id": "MDU6SXNzdWU1NDkxNzg5NTk=", "number": 5155, "title": "buildbot-worker doesn't support ipv6 address for master connection", "user": {"login": "jocelynj", "id": 68169, "node_id": "MDQ6VXNlcjY4MTY5", "avatar_url": "https://avatars.githubusercontent.com/u/68169?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jocelynj", "html_url": "https://github.com/jocelynj", "followers_url": "https://api.github.com/users/jocelynj/followers", "following_url": "https://api.github.com/users/jocelynj/following{/other_user}", "gists_url": "https://api.github.com/users/jocelynj/gists{/gist_id}", "starred_url": "https://api.github.com/users/jocelynj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jocelynj/subscriptions", "organizations_url": "https://api.github.com/users/jocelynj/orgs", "repos_url": "https://api.github.com/users/jocelynj/repos", "events_url": "https://api.github.com/users/jocelynj/events{/privacy}", "received_events_url": "https://api.github.com/users/jocelynj/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-13T21:00:59Z", "updated_at": "2020-01-29T19:15:51Z", "closed_at": "2020-01-29T19:15:51Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I'm trying the following command line:\r\n```shell\r\n/usr/bin/buildbot-worker create-worker . \"[2001\\:\\:324]:9989\" test toto\r\n```\r\nBut it gives the following error:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/buildbot-worker\", line 11, in <module>\r\n    load_entry_point('buildbot-worker==2.0.1.post2', 'console_scripts', 'buildbot-worker')()\r\n  File \"/usr/lib/python3/dist-packages/buildbot_worker/scripts/runner.py\", line 238, in run\r\n    config.parseOptions()\r\n  File \"/usr/lib/python3/dist-packages/twisted/python/usage.py\", line 267, in parseOptions\r\n    self.subOptions.parseOptions(rest)\r\n  File \"/usr/lib/python3/dist-packages/twisted/python/usage.py\", line 273, in parseOptions\r\n    self.parseArgs(*args)\r\n  File \"/usr/lib/python3/dist-packages/buildbot_worker/scripts/runner.py\", line 183, in parseArgs\r\n    self['host'], self['port'] = self.validateMasterArgument(master)\r\n  File \"/usr/lib/python3/dist-packages/buildbot_worker/scripts/runner.py\", line 161, in validateMasterArgument\r\n    master, port = master_arg.split(\":\")\r\nValueError: too many values to unpack (expected 2)\r\n```\r\n\r\nIs Ipv6 address supposed to be supported?\r\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5155/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5155/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5148", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5148/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5148/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5148/events", "html_url": "https://github.com/buildbot/buildbot/issues/5148", "id": 545295569, "node_id": "MDU6SXNzdWU1NDUyOTU1Njk=", "number": 5148, "title": "P4: bytes encoding error in TicketLoginProtocol", "user": {"login": "p12tic", "id": 1056711, "node_id": "MDQ6VXNlcjEwNTY3MTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1056711?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p12tic", "html_url": "https://github.com/p12tic", "followers_url": "https://api.github.com/users/p12tic/followers", "following_url": "https://api.github.com/users/p12tic/following{/other_user}", "gists_url": "https://api.github.com/users/p12tic/gists{/gist_id}", "starred_url": "https://api.github.com/users/p12tic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p12tic/subscriptions", "organizations_url": "https://api.github.com/users/p12tic/orgs", "repos_url": "https://api.github.com/users/p12tic/repos", "events_url": "https://api.github.com/users/p12tic/events{/privacy}", "received_events_url": "https://api.github.com/users/p12tic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-01-04T15:12:37Z", "updated_at": "2020-01-04T15:30:16Z", "closed_at": "2020-01-04T15:30:16Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Extracted out of issue #5042 by @bschatt:\r\n\r\nI don't recall the exact error message but I had some string encoding issues with the 3 variables (stdin, stderr and stdout) in the TicketLoginProtocol class. I made an easy fix and I can submit a PR if needed:\r\n\r\n```\r\nself.stdin = stdin.encode('ascii')\r\nself.stdout = b''\r\nself.stderr = b''\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5148/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5148/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5136", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5136/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5136/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5136/events", "html_url": "https://github.com/buildbot/buildbot/issues/5136", "id": 542603307, "node_id": "MDU6SXNzdWU1NDI2MDMzMDc=", "number": 5136, "title": "latent: Can't stop build when it's preparing worker", "user": {"login": "p12tic", "id": 1056711, "node_id": "MDQ6VXNlcjEwNTY3MTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1056711?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p12tic", "html_url": "https://github.com/p12tic", "followers_url": "https://api.github.com/users/p12tic/followers", "following_url": "https://api.github.com/users/p12tic/following{/other_user}", "gists_url": "https://api.github.com/users/p12tic/gists{/gist_id}", "starred_url": "https://api.github.com/users/p12tic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p12tic/subscriptions", "organizations_url": "https://api.github.com/users/p12tic/orgs", "repos_url": "https://api.github.com/users/p12tic/repos", "events_url": "https://api.github.com/users/p12tic/events{/privacy}", "received_events_url": "https://api.github.com/users/p12tic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-12-26T16:48:52Z", "updated_at": "2021-01-08T09:32:52Z", "closed_at": "2021-01-02T19:22:19Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I've seen this on buildbot.buildbot.net and didn't debug it so I'm not sure if it's caused by Kubernetes or by a general bug in latent worker implementation.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5136/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5136/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5110", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5110/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5110/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5110/events", "html_url": "https://github.com/buildbot/buildbot/issues/5110", "id": 538451024, "node_id": "MDU6SXNzdWU1Mzg0NTEwMjQ=", "number": 5110, "title": "gitpoller: failed with exit code 128: fatal: bad object", "user": {"login": "aliceinwire", "id": 107572, "node_id": "MDQ6VXNlcjEwNzU3Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/107572?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aliceinwire", "html_url": "https://github.com/aliceinwire", "followers_url": "https://api.github.com/users/aliceinwire/followers", "following_url": "https://api.github.com/users/aliceinwire/following{/other_user}", "gists_url": "https://api.github.com/users/aliceinwire/gists{/gist_id}", "starred_url": "https://api.github.com/users/aliceinwire/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aliceinwire/subscriptions", "organizations_url": "https://api.github.com/users/aliceinwire/orgs", "repos_url": "https://api.github.com/users/aliceinwire/repos", "events_url": "https://api.github.com/users/aliceinwire/events{/privacy}", "received_events_url": "https://api.github.com/users/aliceinwire/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-12-16T14:35:27Z", "updated_at": "2020-05-18T20:50:19Z", "closed_at": "2020-05-18T20:50:19Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "```\r\nbuildbot_1               | 2019-12-16 14:43:59+0000 [-] trying to poll branch refs/heads/5.3 of https://github.com/aliceinwire/linux-patches\r\nbuildbot_1               |      Traceback (most recent call last):\r\nbuildbot_1               |        File \"/usr/lib/python3.6/site-packages/twisted/internet/defer.py\", line 654, in _runCallbacks\r\nbuildbot_1               |          current.result = callback(current.result, *args, **kw)\r\nbuildbot_1               |        File \"/usr/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1475, in gotResult\r\nbuildbot_1               |          _inlineCallbacks(r, g, status)\r\nbuildbot_1               |        File \"/usr/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\nbuildbot_1               |          result = result.throwExceptionIntoGenerator(g)\r\nbuildbot_1               |        File \"/usr/lib/python3.6/site-packages/twisted/python/failure.py\", line 512, in throwExceptionIntoGenerator\r\nbuildbot_1               |          return g.throw(self.type, self.value, self.tb)\r\nbuildbot_1               |      --- <exception caught here> ---\r\nbuildbot_1               |        File \"/usr/lib/python3.6/site-packages/buildbot/changes/gitpoller.py\", line 226, in poll\r\nbuildbot_1               |          yield self._process_changes(revs[branch], branch)\r\nbuildbot_1               |        File \"/usr/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\nbuildbot_1               |          result = result.throwExceptionIntoGenerator(g)\r\nbuildbot_1               |        File \"/usr/lib/python3.6/site-packages/twisted/python/failure.py\", line 512, in throwExceptionIntoGenerator\r\nbuildbot_1               |          return g.throw(self.type, self.value, self.tb)\r\nbuildbot_1               |        File \"/usr/lib/python3.6/site-packages/buildbot/changes/gitpoller.py\", line 316, in _process_changes\r\nbuildbot_1               |          results = yield self._dovccmd('log', revListArgs, path=self.workdir)\r\nbuildbot_1               |        File \"/usr/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\nbuildbot_1               |          result = result.throwExceptionIntoGenerator(g)\r\nbuildbot_1               |        File \"/usr/lib/python3.6/site-packages/twisted/python/failure.py\", line 512, in throwExceptionIntoGenerator\r\nbuildbot_1               |          return g.throw(self.type, self.value, self.tb)\r\nbuildbot_1               |        File \"/usr/lib/python3.6/site-packages/buildbot/changes/gitpoller.py\", line 410, in _dovccmd\r\nbuildbot_1               |          stdout = yield self._dovccmdImpl(command, args, path, None)\r\nbuildbot_1               |        File \"/usr/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1418, in _inlineCallbacks\r\nbuildbot_1               |          result = g.send(result)\r\nbuildbot_1               |        File \"/usr/lib/python3.6/site-packages/buildbot/changes/gitpoller.py\", line 441, in _dovccmdImpl\r\nbuildbot_1               |          full_args, path, self.repourl, code, stderr))\r\nbuildbot_1               |      buildbot.changes.gitpoller.GitError: command ['log', '--format=%H', '0ed25f649e3464d2d4a156d1ec101d471e87f711', '^0632b05dfe0edf20e50d473d3c174fda502d6808', '^077ba01d4280501028651068c5276ca67f0a827f', '^077ba01d4280501028651068c5276ca67f0a827f', '^0b3da0b3904e0dabb4d3ba04448ba3169b8599d8', '^0b3da0b3904e0dabb4d3ba04448ba3169b8599d8', '^0ed25f649e3464d2d4a156d1ec101d471e87f711', '^0ee489d1a3a6a217d26da42a6151dc67d33ca20c', '^0f69e0c144eb22f7b48b0c48d4bbdca32290481d', '^107277b141052bc8f7fe406453cdb51e4bb0fc1d', '^111b09445ca154f9feee0743aa1a84f9250a2dab', '^1ed332103c66657d4606ae29c42ba41adb713a3d', '^203f855f3df02c2e1878212e32716806671716cd', '^203f855f3df02c2e1878212e32716806671716cd', '^389573bf5cf2f40a9ec37dfc15e4f14ca9e0a74d', '^398f49b48283feeacc2e0ed33dc6951e0978ada1', '^3a9d9184e1f0d412574eabf24e5cd3586f69d3e9', '^47283ffe7b6fc31c1326713424e59ca4852ab7d4', '^4bcce038842874ce87861be9f9682af7c21c9d61', '^4f401f0d67bf9ea50c8d9ebc772844fd26b4e99d', '^5f1fcf42d2b9edd5baca2940182eb948753faf2a', '^63a8f3beb3c3ac5417e18aad9ed0b4001e5c92b3', '^64881833b8854f3c3a82270811c619b49e013da7', '^679479168a68ec71fc95e7a66dac25305220e45f', '^70fa93ee16ccde9d51810e352e2a25b7edb13e78', '^71ec30f97ea667e987e0de30f7592909cfa96685', '^7204d256da7c380bc6fcc48f4acebc4b1e6fed07', '^9182fc70611d1887e3090d9768655dacf0a7fb06', '^a1276f7f2c41720aeee601e59069f45f1fb5ebf2', '^aacb6d87890588e839500bcfeabb1fde7bf93e35', '^ae029c4cde3493b928e501e846e93cc067b4a845', '^af6dfb8341d6ec2f07e8be8c04cc67db993f7d5c', '^afdf80395cd18368043156124343e742f3cb572c', '^b40e4b7205dd73330cf29bf39590327f973a473b', '^b9fd7bdba6609d0fa42485ee3cdee8f607a321ec', '^b9fd7bdba6609d0fa42485ee3cdee8f607a321ec', '^c75c995c2729fd757a3c04492a7adac5e31b18c0', '^cec555b10aaa9021172ca97c9c4f3a605f82ffb8', '^d3b6891f47be9ecc46753b7da1ae9d4ab09e004a', '^d9a7b48394c11e665ecac4ddb28dfae1fb8a2a42', '^dadae5e6ec2d9d5e86edccb8cbeb728efc26033c', '^dadae5e6ec2d9d5e86edccb8cbeb728efc26033c', '^df00160fd19ac3ffbd1887ee9bdc64384f4f8421', '^e54c798c11904682e91e05d4114b6bf7181ed8b9', '^e70e295836f04951c3eeaf0bdba524da86691c26', '^f038ea3a40fec1a50410f3e39b1ca402f8d6543c', '^f038ea3a40fec1a50410f3e39b1ca402f8d6543c', '^f0c91086a01b8aebce1a268d2545b694d3e52c39', '^f209e98096e70700cfc4d98580b2f817781c15b6', '--'] in /var/lib/buildbot/gitpoller-work on repourl https://github.com/aliceinwire/linux-patches failed with exit code 128: fatal: bad object e70e295836f04951c3eeaf0bdba524da86691c26\r\nbuildbot_1               | \r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5110/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5110/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5058", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5058/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5058/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5058/events", "html_url": "https://github.com/buildbot/buildbot/issues/5058", "id": 511886208, "node_id": "MDU6SXNzdWU1MTE4ODYyMDg=", "number": 5058, "title": "builtins.KeyError: 'stat' when file is not existing", "user": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-10-24T11:34:37Z", "updated_at": "2020-01-13T15:10:24Z", "closed_at": "2020-01-13T15:10:24Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "As per:\r\nhttps://build.contextgarden.net/#/builders/13/builds/55\r\n\r\n```\r\nbuiltins.KeyError: 'stat'\r\n/data1/buildbot/install-2.x/sandbox/lib/python3.7/site-packages/buildbot/process/buildstep.py:567 in startStep\r\n566                    self._running = True\r\n567                    self.results = yield self.run()\r\n568                finally:\r\n/data1/buildbot/install-2.x/sandbox/lib/python3.7/site-packages/twisted/internet/defer.py:1418 in _inlineCallbacks\r\n1417            else:\r\n1418                result = g.send(result)\r\n1419        except StopIteration as e:\r\n/data1/buildbot/install-2.x/sandbox/lib/python3.7/site-packages/buildbot/process/buildstep.py:697 in run\r\n696                self._start_deferred.callback(results)\r\n697            results = yield self._start_deferred\r\n698        finally:\r\n/data1/buildbot/install-2.x/sandbox/lib/python3.7/site-packages/twisted/internet/defer.py:1416 in _inlineCallbacks\r\n1415            if isFailure:\r\n1416                result = result.throwExceptionIntoGenerator(g)\r\n1417            else:\r\n/data1/buildbot/install-2.x/sandbox/lib/python3.7/site-packages/twisted/python/failure.py:512 in throwExceptionIntoGenerator\r\n511        # is done in _findFailure.\r\n512        return g.throw(self.type, self.value, self.tb)\r\n513\r\n/data1/buildbot/install-2.x/sandbox/lib/python3.7/site-packages/buildbot/steps/transfer.py:397 in uploadSources\r\n396                for source in sources:\r\n397                    result = yield self.startUpload(source, masterdest)\r\n398                    if result == FAILURE:\r\n/data1/buildbot/install-2.x/sandbox/lib/python3.7/site-packages/twisted/internet/defer.py:654 in _runCallbacks\r\n653                    try:\r\n654                        current.result = callback(current.result, *args, **kw)\r\n655                        if current.result is current:\r\n/data1/buildbot/install-2.x/sandbox/lib/python3.7/site-packages/buildbot/steps/transfer.py:342 in checkStat\r\n341        def checkStat(_):\r\n342            s = cmd.updates['stat'][-1]\r\n343            if stat.S_ISDIR(s[stat.ST_MODE]):\r\nbuiltins.KeyError: 'stat'\r\n```\r\nin the worker implementation:\r\n```\r\n       try:\r\n            stat = os.stat(filename)\r\n            self.sendStatus({'stat': tuple(stat)})\r\n            self.sendStatus({'rc': 0})\r\n        except OSError as e:\r\n            log.msg(\"StatFile {0} failed: {1}\".format(filename, e))\r\n            self.sendStatus(\r\n                {'header': '{0}: {1}: {2}'.format(self.header, e.strerror, filename)})\r\n            self.sendStatus({'rc': e.errno})\r\n\r\n```\r\nwhen os.stat fail, no 'stat' status is send, but the master will anyway check for 'stat' first", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5058/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5058/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5042", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5042/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5042/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5042/events", "html_url": "https://github.com/buildbot/buildbot/issues/5042", "id": 508576668, "node_id": "MDU6SXNzdWU1MDg1NzY2Njg=", "number": 5042, "title": "p4 issues", "user": {"login": "bschatt", "id": 44769431, "node_id": "MDQ6VXNlcjQ0NzY5NDMx", "avatar_url": "https://avatars.githubusercontent.com/u/44769431?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bschatt", "html_url": "https://github.com/bschatt", "followers_url": "https://api.github.com/users/bschatt/followers", "following_url": "https://api.github.com/users/bschatt/following{/other_user}", "gists_url": "https://api.github.com/users/bschatt/gists{/gist_id}", "starred_url": "https://api.github.com/users/bschatt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bschatt/subscriptions", "organizations_url": "https://api.github.com/users/bschatt/orgs", "repos_url": "https://api.github.com/users/bschatt/repos", "events_url": "https://api.github.com/users/bschatt/events{/privacy}", "received_events_url": "https://api.github.com/users/bschatt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-10-17T16:04:46Z", "updated_at": "2020-12-12T12:39:20Z", "closed_at": "2020-12-12T12:39:11Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "We had a lot of issues with p4poller recently. Most of them appeared after we enabled ticket-based auth on our p4 server.\r\n\r\n1. (moved to #5148)\r\n\r\n2. We are currently running in a random issue. Sometimes we get a weird error forever. I think this is due to the password parameter but not sure. I will let you know if I find anything.\r\n\r\n> 2019-10-17 17:49:41+0200 [-] P4 poll failed on XXX.XXX.XXX.XXX:1666, //XXXXXXXXX/\r\n> \tTraceback (most recent call last):\r\n> \t  File \"/usr/lib/python3/dist-packages/twisted/internet/defer.py\", line 151, in maybeDeferred\r\n> \t    result = f(*args, **kw)\r\n> \t  File \"/home/buildbot/.local/lib/python3.7/site-packages/buildbot/changes/p4poller.py\", line 175, in poll\r\n> \t    d = self._poll()\r\n> \t  File \"/usr/lib/python3/dist-packages/twisted/internet/defer.py\", line 1613, in unwindGenerator\r\n> \t    return _cancellableInlineCallbacks(gen)\r\n> \t  File \"/usr/lib/python3/dist-packages/twisted/internet/defer.py\", line 1529, in _cancellableInlineCallbacks\r\n> \t    _inlineCallbacks(None, g, status)\r\n> \t--- <exception caught here> ---\r\n> \t  File \"/usr/lib/python3/dist-packages/twisted/internet/defer.py\", line 1418, in _inlineCallbacks\r\n> \t    result = g.send(result)\r\n> \t  File \"/home/buildbot/.local/lib/python3.7/site-packages/buildbot/changes/p4poller.py\", line 245, in _poll\r\n> \t    result = yield self._get_process_output(args)\r\n> \t  File \"/home/buildbot/.local/lib/python3.7/site-packages/buildbot/changes/p4poller.py\", line 183, in _get_process_output\r\n> \t    d = utils.getProcessOutput(self.p4bin, args, env)\r\n> \t  File \"/usr/lib/python3/dist-packages/twisted/internet/utils.py\", line 128, in getProcessOutput\r\n> \t    reactor)\r\n> \t  File \"/usr/lib/python3/dist-packages/twisted/internet/utils.py\", line 28, in _callProtocolWithDeferred\r\n> \t    reactor.spawnProcess(p, executable, (executable,)+tuple(args), env, path)\r\n> \t  File \"/usr/lib/python3/dist-packages/twisted/internet/posixbase.py\", line 331, in spawnProcess\r\n> \t    args, env = self._checkProcessArgs(args, env)\r\n> \t  File \"/usr/lib/python3/dist-packages/twisted/internet/base.py\", line 981, in _checkProcessArgs\r\n> \t    raise TypeError(\"Arguments contain a non-string value\")\r\n> \tbuiltins.TypeError: Arguments contain a non-string value\r\n\r\n3. Buildbot seems to create normal workspaces even when the depot is a stream depot. I added the support for streams. I can submit a PR for this feature if you want.\r\n\r\nUseful informations :\r\nBuildbot version: 2.4.1\r\nTwisted version: 18.9.0\r\nPython 3.7.3", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5042/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5042/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5033", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/5033/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/5033/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/5033/events", "html_url": "https://github.com/buildbot/buildbot/issues/5033", "id": 504671867, "node_id": "MDU6SXNzdWU1MDQ2NzE4Njc=", "number": 5033, "title": "`make frontend` broken on Debian 10", "user": {"login": "vext01", "id": 604955, "node_id": "MDQ6VXNlcjYwNDk1NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/604955?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vext01", "html_url": "https://github.com/vext01", "followers_url": "https://api.github.com/users/vext01/followers", "following_url": "https://api.github.com/users/vext01/following{/other_user}", "gists_url": "https://api.github.com/users/vext01/gists{/gist_id}", "starred_url": "https://api.github.com/users/vext01/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vext01/subscriptions", "organizations_url": "https://api.github.com/users/vext01/orgs", "repos_url": "https://api.github.com/users/vext01/repos", "events_url": "https://api.github.com/users/vext01/events{/privacy}", "received_events_url": "https://api.github.com/users/vext01/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-10-09T13:59:29Z", "updated_at": "2021-07-30T01:17:03Z", "closed_at": "2021-07-30T01:17:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\n$ make frontend\r\n...\r\nRequirement already satisfied: cffi!=1.11.3,>=1.8 in ./.venv/lib/python3.7/site-packages (from cryptography>=2.7->autobahn>=0.16.0->buildbot) (1.12.3)\r\nRequirement already satisfied: asn1crypto>=0.21.0 in ./.venv/lib/python3.7/site-packages (from cryptography>=2.7->autobahn>=0.16.0->buildbot) (1.0.1)\r\nRequirement already satisfied: pycparser in ./.venv/lib/python3.7/site-packages (from cffi!=1.11.3,>=1.8->cryptography>=2.7->autobahn>=0.16.0->buildbot) (2.19)\r\ncd www/build_common; yarn install --pure-lockfile\r\nUsage: yarn [options]\r\n\r\nyarn: error: no such option: --pure-lockfile\r\nmake: *** [Makefile:47: frontend_deps] Error 2\r\n```\r\n\r\nThere are two pieces of software called \"yarn\" and we are using the wrong one.\r\n\r\nI notice the following when installing the yarn pkg:\r\n```\r\n$ sudo apt-get install yarn\r\nReading package lists... Done\r\nBuilding dependency tree       \r\nReading state information... Done\r\nNote, selecting 'cmdtest' instead of 'yarn'\r\n...\r\n```\r\n\r\nIf it's the nodejs `yarn` we need, that's the `yarnpkg` package:\r\n```\r\n$ apt-cache search yarnpkg\r\nyarnpkg - Fast, reliable and secure npm alternative\r\n```\r\n\r\nAs a workaround, I made a symlink from `/usr/bin/yarnpkg` to `yarnpkg` in the python virtualenv and it works fine.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/5033/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/5033/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4998", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4998/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4998/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4998/events", "html_url": "https://github.com/buildbot/buildbot/issues/4998", "id": 488413397, "node_id": "MDU6SXNzdWU0ODg0MTMzOTc=", "number": 4998, "title": "Docker image for 2.4.0 contains packages from 2.3.1", "user": {"login": "cjolowicz", "id": 653941, "node_id": "MDQ6VXNlcjY1Mzk0MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/653941?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjolowicz", "html_url": "https://github.com/cjolowicz", "followers_url": "https://api.github.com/users/cjolowicz/followers", "following_url": "https://api.github.com/users/cjolowicz/following{/other_user}", "gists_url": "https://api.github.com/users/cjolowicz/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjolowicz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjolowicz/subscriptions", "organizations_url": "https://api.github.com/users/cjolowicz/orgs", "repos_url": "https://api.github.com/users/cjolowicz/repos", "events_url": "https://api.github.com/users/cjolowicz/events{/privacy}", "received_events_url": "https://api.github.com/users/cjolowicz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-09-03T06:21:28Z", "updated_at": "2021-05-20T13:24:25Z", "closed_at": "2021-05-20T13:24:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "The Docker image `buildbot/buildbot-master:v2.4.0` contains Python packages for buildbot `2.3.1`:\r\n\r\n```sh\r\nbuildbot-console-view==2.3.1\r\nbuildbot-grid-view==2.3.1\r\nbuildbot-waterfall-view==2.3.1\r\nbuildbot-worker==2.3.1\r\nbuildbot-www==2.3.1\r\n```\r\n\r\nThe `buildbot` package itself has version `2019.8.18`, which is not available from PyPI.\r\n\r\nEven if `2019.8.18` turns out to be identical to `2.4.0`, this is somewhat problematic: Installing packages into the image with a dependency on buildbot will always uninstall the buildbot version that comes with the official image.\r\n\r\nIt would be nice if the Dockerfile could install buildbot from PyPI to ensure deterministic builds for those who need to derive their own image.\r\n\r\n<details>\r\n  <summary>Output of pip freeze</summary>\r\n\r\n```\r\n$ docker run --rm buildbot/buildbot-master:v2.4.0 pip freeze\r\nasn1crypto==0.24.0\r\nattrs==19.1.0\r\nautobahn==19.8.1\r\nAutomat==0.7.0\r\nbuildbot==2019.8.18\r\nbuildbot-console-view==2.3.1\r\nbuildbot-grid-view==2.3.1\r\nbuildbot-waterfall-view==2.3.1\r\nbuildbot-worker==2.3.1\r\nbuildbot-www==2.3.1\r\ncertifi==2019.6.16\r\ncffi==1.12.3\r\nchardet==3.0.4\r\nconstantly==15.1.0\r\ncryptography==2.7\r\ndecorator==4.4.0\r\nfuture==0.17.1\r\nhyperlink==19.0.0\r\nidna==2.8\r\nincremental==17.5.0\r\nJinja2==2.10.1\r\nMarkupSafe==1.1.1\r\npbr==5.4.2\r\npsycopg2==2.8.3\r\npyasn1==0.4.6\r\npyasn1-modules==0.2.6\r\npycparser==2.19\r\nPyHamcrest==1.9.0\r\nPyJWT==1.7.1\r\npyOpenSSL==19.0.0\r\npython-dateutil==2.8.0\r\nPyYAML==5.1.2\r\nrequests==2.22.0\r\nservice-identity==18.1.0\r\nsix==1.12.0\r\nSQLAlchemy==1.3.7\r\nsqlalchemy-migrate==0.12.0\r\nsqlparse==0.3.0\r\nTempita==0.5.2\r\nTwisted==19.7.0\r\ntxaio==18.8.1\r\ntxrequests==0.9.6\r\nurllib3==1.25.3\r\nzope.interface==4.6.0\r\n```\r\n</details>", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4998/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4998/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4987", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4987/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4987/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4987/events", "html_url": "https://github.com/buildbot/buildbot/issues/4987", "id": 484689647, "node_id": "MDU6SXNzdWU0ODQ2ODk2NDc=", "number": 4987, "title": "hgpoller fails with \"null value in column committer\"", "user": {"login": "komaeda", "id": 45509655, "node_id": "MDQ6VXNlcjQ1NTA5NjU1", "avatar_url": "https://avatars.githubusercontent.com/u/45509655?v=4", "gravatar_id": "", "url": "https://api.github.com/users/komaeda", "html_url": "https://github.com/komaeda", "followers_url": "https://api.github.com/users/komaeda/followers", "following_url": "https://api.github.com/users/komaeda/following{/other_user}", "gists_url": "https://api.github.com/users/komaeda/gists{/gist_id}", "starred_url": "https://api.github.com/users/komaeda/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/komaeda/subscriptions", "organizations_url": "https://api.github.com/users/komaeda/orgs", "repos_url": "https://api.github.com/users/komaeda/repos", "events_url": "https://api.github.com/users/komaeda/events{/privacy}", "received_events_url": "https://api.github.com/users/komaeda/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2019-08-23T20:01:32Z", "updated_at": "2019-08-27T08:26:14Z", "closed_at": "2019-08-27T08:26:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm running a Buildbot master inside a Docker container, and I have an HgPoller set up to poll a Kallithea repository. When the poller detects changes, it fails with the following:\r\n\r\n```\r\nbuildbot_1  | 2019-08-23 19:58:52+0000 [-] hgpoller: repo poll failed\r\n{... unneeded stack trace ...}\r\nbuildbot_1  |   sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column \"committer\" violates not-null constraint\r\nbuildbot_1  |   DETAIL:  Failing row contains (9, marisa <marisa@mokou.zone>, null, Add lint script for CI execution, default, 8c43f72068449130372da25f6583531c9e4f88a8, , 1566588893, null, https://callie.marisa.cloud/tometo/tometo, , tometo, 1, null).\r\n```\r\n\r\nReading through the hgpoller source, this seems to stem from here:\r\n\r\nhttps://github.com/buildbot/buildbot/blob/master/master/buildbot/changes/hgpoller.py#L285\r\n\r\nAm I correct in assuming that `committer=None` is directly opposed to `committer` being a non-null constraint in the database? If so, wouldn't that be a clear bug?", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4987/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4987/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4978", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4978/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4978/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4978/events", "html_url": "https://github.com/buildbot/buildbot/issues/4978", "id": 482438034, "node_id": "MDU6SXNzdWU0ODI0MzgwMzQ=", "number": 4978, "title": "upgrade broken from 2.3.1 to 2.4.0", "user": {"login": "landryb", "id": 3421760, "node_id": "MDQ6VXNlcjM0MjE3NjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3421760?v=4", "gravatar_id": "", "url": "https://api.github.com/users/landryb", "html_url": "https://github.com/landryb", "followers_url": "https://api.github.com/users/landryb/followers", "following_url": "https://api.github.com/users/landryb/following{/other_user}", "gists_url": "https://api.github.com/users/landryb/gists{/gist_id}", "starred_url": "https://api.github.com/users/landryb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/landryb/subscriptions", "organizations_url": "https://api.github.com/users/landryb/orgs", "repos_url": "https://api.github.com/users/landryb/repos", "events_url": "https://api.github.com/users/landryb/events{/privacy}", "received_events_url": "https://api.github.com/users/landryb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2019-08-19T17:34:31Z", "updated_at": "2020-08-19T11:10:21Z", "closed_at": "2020-08-19T11:10:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "Updating buildbot on OpenBSD, the upgrade command fails:\r\n```\r\n$doas -u _buildbot buildbot upgrade-master /build/buildbot9                                                  \r\nchecking basedir                                                                                                                                               \r\nchecking for running master                                                                                                                                    \r\nchecking master.cfg                                                                                                                                            \r\nupgrading basedir                                                                                                                                              \r\nupgrading database (sqlite:/state.sqlite)                                                                                                                      \r\nWarning: Stopping this process might cause data loss                                                                                                           \r\nGot fatal Exception on DB                                                                                                                                      \r\nTraceback (most recent call last):                                                                                                                             \r\n  File \"/usr/local/lib/python3.7/site-packages/twisted/python/threadpool.py\", line 266, in <lambda>                                                            \r\n    inContext.theWork = lambda: context.call(ctx, func, *args, **kw)                                                                                           \r\n  File \"/usr/local/lib/python3.7/site-packages/twisted/python/context.py\", line 122, in callWithContext                                                        \r\n    return self.currentContext().callWithContext(ctx, func, *args, **kw)                                                                                       \r\n  File \"/usr/local/lib/python3.7/site-packages/twisted/python/context.py\", line 85, in callWithContext                                                         \r\n    return func(*args,**kw)                                                                                                                                    \r\n  File \"/usr/local/lib/python3.7/site-packages/buildbot/db/pool.py\", line 209, in __thd                                                                        \r\n    log.err(e, 'Got fatal Exception on DB')                                                                                                                    \r\n--- <exception caught here> ---                                                                                                                                \r\n  File \"/usr/local/lib/python3.7/site-packages/buildbot/db/pool.py\", line 182, in __thd                                                                        \r\n    rv = callable(arg, *args, **kwargs)                                                                                                                        \r\n  File \"/usr/local/lib/python3.7/site-packages/buildbot/db/model.py\", line 903, in thd                                                                         \r\n    upgrade(engine)                                                                                                                                            \r\n  File \"/usr/local/lib/python3.7/site-packages/buildbot/db/model.py\", line 868, in upgrade                                                                     \r\n    schema.runchange(version, change, 1)                                                                                                                       \r\n  File \"/usr/local/lib/python3.7/site-packages/migrate/versioning/schema.py\", line 93, in runchange                                                            \r\n    change.run(self.engine, step)                                                                                                                              \r\n  File \"/usr/local/lib/python3.7/site-packages/migrate/versioning/script/py.py\", line 148, in run                                                              \r\n    script_func(engine)                                                                                                                                        \r\n  File \"/usr/local/lib/python3.7/site-packages/buildbot/db/migrate/versions/054_add_index_to_steps.py\", line 26, in upgrade                                    \r\n    steps = sautils.Table('steps', metadata, autoload=True)                                                                                                    \r\n  File \"/usr/local/lib/python3.7/site-packages/buildbot/util/sautils.py\", line 62, in Table                                                                    \r\n    return sa.Table(*args, **kwargs)                                                                                                                           \r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 456, in __new__                                                                 \r\n    metadata._remove_table(name, schema)                                                                                                                       \r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py\", line 66, in __exit__\r\n    compat.reraise(exc_type, exc_value, exc_tb)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 187, in reraise\r\n    raise value\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 451, in __new__\r\n    table._init(name, metadata, *args, **kw)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 533, in _init\r\n    include_columns, _extend_on=_extend_on)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 559, in _autoload\r\n    _extend_on=_extend_on\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 2056, in run_callable\r\n    return conn.run_callable(callable_, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1545, in run_callable\r\n    return callable_(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 390, in reflecttable\r\n    table, include_columns, exclude_columns, **opts)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/reflection.py\", line 633, in reflecttable\r\n    exclude_columns, _extend_on, reflection_options)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/reflection.py\", line 761, in _reflect_fk\r\n    **reflection_options\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 456, in __new__\r\n    metadata._remove_table(name, schema)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py\", line 66, in __exit__\r\n    compat.reraise(exc_type, exc_value, exc_tb)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 187, in reraise\r\n    raise value\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 451, in __new__\r\n    table._init(name, metadata, *args, **kw)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 533, in _init\r\n    include_columns, _extend_on=_extend_on)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 546, in _autoload\r\n    _extend_on=_extend_on\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1545, in run_callable\r\n    return callable_(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 390, in reflecttable\r\n    table, include_columns, exclude_columns, **opts)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/reflection.py\", line 633, in reflecttable\r\n    exclude_columns, _extend_on, reflection_options)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/reflection.py\", line 761, in _reflect_fk\r\n    **reflection_options\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 456, in __new__\r\n    metadata._remove_table(name, schema)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py\", line 66, in __exit__\r\n    compat.reraise(exc_type, exc_value, exc_tb)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 187, in reraise\r\n    raise value\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 451, in __new__\r\n    table._init(name, metadata, *args, **kw)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 533, in _init\r\n    include_columns, _extend_on=_extend_on)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 546, in _autoload\r\n    _extend_on=_extend_on\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1545, in run_callable\r\n    return callable_(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 390, in reflecttable\r\n    table, include_columns, exclude_columns, **opts)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/reflection.py\", line 633, in reflecttable\r\n    exclude_columns, _extend_on, reflection_options)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/reflection.py\", line 761, in _reflect_fk\r\n    **reflection_options\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 456, in __new__\r\n    metadata._remove_table(name, schema)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py\", line 66, in __exit__\r\n    compat.reraise(exc_type, exc_value, exc_tb)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 187, in reraise\r\n    raise value\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 451, in __new__\r\n    table._init(name, metadata, *args, **kw)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 533, in _init\r\n    include_columns, _extend_on=_extend_on)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 546, in _autoload\r\n    _extend_on=_extend_on\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1545, in run_callable\r\n    return callable_(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 390, in reflecttable\r\n    table, include_columns, exclude_columns, **opts)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/reflection.py\", line 633, in reflecttable\r\n    exclude_columns, _extend_on, reflection_options)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/reflection.py\", line 761, in _reflect_fk\r\n    **reflection_options\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 456, in __new__\r\n    metadata._remove_table(name, schema)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py\", line 66, in __exit__\r\n    compat.reraise(exc_type, exc_value, exc_tb)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 187, in reraise\r\n    raise value\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 451, in __new__\r\n    table._init(name, metadata, *args, **kw)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 533, in _init\r\n    include_columns, _extend_on=_extend_on)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 546, in _autoload\r\n    _extend_on=_extend_on\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1545, in run_callable\r\n    return callable_(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 390, in reflecttable\r\n    table, include_columns, exclude_columns, **opts)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/reflection.py\", line 626, in reflecttable\r\n    raise exc.NoSuchTableError(table.name)\r\nsqlalchemy.exc.NoSuchTableError: migration_tmp\r\n\r\nproblem while upgrading!:                                                                                                                                      \r\nTraceback (most recent call last):                                                                                                                             \r\n  File \"/usr/local/lib/python3.7/site-packages/buildbot/scripts/upgrade_master.py\", line 141, in _upgradeMaster                                                \r\n    yield upgradeDatabase(config, master_cfg)                                                                                                                  \r\n  File \"/usr/local/lib/python3.7/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks                                                      \r\n    result = result.throwExceptionIntoGenerator(g)                                                                                                             \r\n  File \"/usr/local/lib/python3.7/site-packages/twisted/python/failure.py\", line 491, in throwExceptionIntoGenerator                                            \r\n    return g.throw(self.type, self.value, self.tb)                                                                                                             \r\n  File \"/usr/local/lib/python3.7/site-packages/buildbot/scripts/upgrade_master.py\", line 103, in upgradeDatabase                                               \r\n    yield db.model.upgrade()                                                                                                                                   \r\n  File \"/usr/local/lib/python3.7/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks                                                      \r\n    result = result.throwExceptionIntoGenerator(g)                                                                                                             \r\n  File \"/usr/local/lib/python3.7/site-packages/twisted/python/failure.py\", line 491, in throwExceptionIntoGenerator                                            \r\n    return g.throw(self.type, self.value, self.tb)                                                                                                             \r\n  File \"/usr/local/lib/python3.7/site-packages/buildbot/db/model.py\", line 925, in upgrade                                                                     \r\n    yield self.db.pool.do_with_engine(thd) \r\n  File \"/usr/local/lib/python3.7/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\n    result = result.throwExceptionIntoGenerator(g)                                                                                                             \r\n  File \"/usr/local/lib/python3.7/site-packages/twisted/python/failure.py\", line 491, in throwExceptionIntoGenerator                                            \r\n    return g.throw(self.type, self.value, self.tb)                                                                                                             \r\n  File \"/usr/local/lib/python3.7/site-packages/buildbot/db/pool.py\", line 228, in do_with_engine                                                               \r\n    args, kwargs)                                                                                                                                              \r\n  File \"/usr/local/lib/python3.7/site-packages/twisted/python/threadpool.py\", line 250, in inContext                                                           \r\n    result = inContext.theWork()                                                                                                                               \r\n  File \"/usr/local/lib/python3.7/site-packages/twisted/python/threadpool.py\", line 266, in <lambda>                                                            \r\n    inContext.theWork = lambda: context.call(ctx, func, *args, **kw)                                                                                           \r\n  File \"/usr/local/lib/python3.7/site-packages/twisted/python/context.py\", line 122, in callWithContext                                                        \r\n    return self.currentContext().callWithContext(ctx, func, *args, **kw)                                                                                       \r\n  File \"/usr/local/lib/python3.7/site-packages/twisted/python/context.py\", line 85, in callWithContext                                                         \r\n    return func(*args,**kw)                                                                                                                                    \r\n  File \"/usr/local/lib/python3.7/site-packages/buildbot/db/pool.py\", line 182, in __thd                                                                        \r\n    rv = callable(arg, *args, **kwargs)                                                                                                                        \r\n  File \"/usr/local/lib/python3.7/site-packages/buildbot/db/model.py\", line 903, in thd                                                                         \r\n    upgrade(engine)                                                                                                                                            \r\n  File \"/usr/local/lib/python3.7/site-packages/buildbot/db/model.py\", line 868, in upgrade                                                                     \r\n    schema.runchange(version, change, 1)                                                                                                                       \r\n  File \"/usr/local/lib/python3.7/site-packages/migrate/versioning/schema.py\", line 93, in runchange                                                            \r\n    change.run(self.engine, step)                                                                                                                              \r\n  File \"/usr/local/lib/python3.7/site-packages/migrate/versioning/script/py.py\", line 148, in run\r\n    script_func(engine)                                                        \r\n  File \"/usr/local/lib/python3.7/site-packages/buildbot/db/migrate/versions/054_add_index_to_steps.py\", line 26, in upgrade\r\n    steps = sautils.Table('steps', metadata, autoload=True)\r\n  File \"/usr/local/lib/python3.7/site-packages/buildbot/util/sautils.py\", line 62, in Table     \r\n    return sa.Table(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 456, in __new__       \r\n    metadata._remove_table(name, schema)   \r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py\", line 66, in __exit__   \r\n    compat.reraise(exc_type, exc_value, exc_tb)     \r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 187, in reraise           \r\n    raise value                                                                \r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 451, in __new__           \r\n    table._init(name, metadata, *args, **kw)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 533, in _init  \r\n    include_columns, _extend_on=_extend_on)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 559, in _autoload    \r\n    _extend_on=_extend_on                                                      \r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 2056, in run_callable\r\n    return conn.run_callable(callable_, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1545, in run_callable\r\n    return callable_(self, *args, **kwargs) \r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 390, in reflecttable\r\n    table, include_columns, exclude_columns, **opts)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/reflection.py\", line 633, in reflecttable\r\n    exclude_columns, _extend_on, reflection_options)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/reflection.py\", line 761, in _reflect_fk\r\n    **reflection_options                                                       \r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 456, in __new__         \r\n    metadata._remove_table(name, schema)            \r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py\", line 66, in __exit__      \r\n    compat.reraise(exc_type, exc_value, exc_tb)     \r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 187, in reraise       \r\n    raise value\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 451, in __new__\r\n    table._init(name, metadata, *args, **kw)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 533, in _init\r\n    include_columns, _extend_on=_extend_on)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 546, in _autoload\r\n    _extend_on=_extend_on\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1545, in run_callable\r\n    return callable_(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 390, in reflecttable\r\n    table, include_columns, exclude_columns, **opts)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/reflection.py\", line 633, in reflecttable\r\n    exclude_columns, _extend_on, reflection_options)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/reflection.py\", line 761, in _reflect_fk\r\n    **reflection_options\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 456, in __new__\r\n    metadata._remove_table(name, schema)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py\", line 66, in __exit__\r\n    compat.reraise(exc_type, exc_value, exc_tb)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 187, in reraise\r\n    raise value\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 451, in __new__\r\n    table._init(name, metadata, *args, **kw)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 533, in _init\r\n    include_columns, _extend_on=_extend_on)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 546, in _autoload\r\n    _extend_on=_extend_on\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1545, in run_callable\r\n    return callable_(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 390, in reflecttable\r\n    table, include_columns, exclude_columns, **opts)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/reflection.py\", line 633, in reflecttable\r\n    exclude_columns, _extend_on, reflection_options)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/reflection.py\", line 761, in _reflect_fk\r\n    **reflection_options\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 456, in __new__\r\n    metadata._remove_table(name, schema)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py\", line 66, in __exit__\r\n    compat.reraise(exc_type, exc_value, exc_tb)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 187, in reraise\r\n    raise value\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 451, in __new__\r\n    table._init(name, metadata, *args, **kw)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 533, in _init\r\n    include_columns, _extend_on=_extend_on)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 546, in _autoload\r\n    _extend_on=_extend_on\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1545, in run_callable\r\n    return callable_(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 390, in reflecttable\r\n    table, include_columns, exclude_columns, **opts)\r\n  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/reflection.py\", line 626, in reflecttable\r\n    raise exc.NoSuchTableError(table.name)\r\nsqlalchemy.exc.NoSuchTableError: migration_tmp\r\n\r\n```\r\n\r\nI initially thought it was about a bad path in the `migrate_version` table (this bot instance started its life with python 2.7 and now uses 3.7) but fixing it didnt help.\r\n\r\n```\r\nsqlite> select * from migrate_version ;\r\nBuildbot|/usr/local/lib/python2.7/site-packages/buildbot/db/migrate|53\r\nsqlite> update migrate_version set repository_path='/usr/local/lib/python3.7/site-packages/buildbot/db/migrate';\r\nsqlite> select * from migrate_version ;\r\nBuildbot|/usr/local/lib/python3.7/site-packages/buildbot/db/migrate|53\r\n```\r\n\r\nthis is with twisted 18.9.0 and sqlalchemy 1.2.8 / sqlachemy-migrate 0.11.0.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4978/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4978/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4935", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4935/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4935/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4935/events", "html_url": "https://github.com/buildbot/buildbot/issues/4935", "id": 476110853, "node_id": "MDU6SXNzdWU0NzYxMTA4NTM=", "number": 4935, "title": "Insubstantiation notifier left after the refactor", "user": {"login": "kszucs", "id": 961747, "node_id": "MDQ6VXNlcjk2MTc0Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/961747?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kszucs", "html_url": "https://github.com/kszucs", "followers_url": "https://api.github.com/users/kszucs/followers", "following_url": "https://api.github.com/users/kszucs/following{/other_user}", "gists_url": "https://api.github.com/users/kszucs/gists{/gist_id}", "starred_url": "https://api.github.com/users/kszucs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kszucs/subscriptions", "organizations_url": "https://api.github.com/users/kszucs/orgs", "repos_url": "https://api.github.com/users/kszucs/repos", "events_url": "https://api.github.com/users/kszucs/events{/privacy}", "received_events_url": "https://api.github.com/users/kszucs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-08-02T10:26:12Z", "updated_at": "2020-01-25T20:58:03Z", "closed_at": "2020-01-25T20:58:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "Which blocks the `BuildMaster.stopService`, see https://github.com/buildbot/buildbot/blob/master/master/buildbot/worker/latent.py#L495", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4935/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4935/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4912", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4912/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4912/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4912/events", "html_url": "https://github.com/buildbot/buildbot/issues/4912", "id": 471638777, "node_id": "MDU6SXNzdWU0NzE2Mzg3Nzc=", "number": 4912, "title": "gitpoller is crashed", "user": {"login": "EndrII", "id": 12465465, "node_id": "MDQ6VXNlcjEyNDY1NDY1", "avatar_url": "https://avatars.githubusercontent.com/u/12465465?v=4", "gravatar_id": "", "url": "https://api.github.com/users/EndrII", "html_url": "https://github.com/EndrII", "followers_url": "https://api.github.com/users/EndrII/followers", "following_url": "https://api.github.com/users/EndrII/following{/other_user}", "gists_url": "https://api.github.com/users/EndrII/gists{/gist_id}", "starred_url": "https://api.github.com/users/EndrII/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/EndrII/subscriptions", "organizations_url": "https://api.github.com/users/EndrII/orgs", "repos_url": "https://api.github.com/users/EndrII/repos", "events_url": "https://api.github.com/users/EndrII/events{/privacy}", "received_events_url": "https://api.github.com/users/EndrII/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-07-23T11:22:39Z", "updated_at": "2019-10-15T13:32:19Z", "closed_at": "2019-10-15T13:32:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "``` log \r\n2019-07-23 11:19:08+0000 [-] trying to poll branch refs/heads/master of git@github.com:QuasarApp/Qt-Secret.git\r\n        Traceback (most recent call last):\r\n          File \"/home/andrei/bot/sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 654, in _runCallbacks\r\n            current.result = callback(current.result, *args, **kw)\r\n          File \"/home/andrei/bot/sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1475, in gotResult\r\n            _inlineCallbacks(r, g, status)\r\n          File \"/home/andrei/bot/sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\n            result = result.throwExceptionIntoGenerator(g)\r\n          File \"/home/andrei/bot/sandbox/lib/python3.6/site-packages/twisted/python/failure.py\", line 512, in throwExceptionIntoGenerator\r\n            return g.throw(self.type, self.value, self.tb)\r\n        --- <exception caught here> ---\r\n          File \"/home/andrei/bot/sandbox/lib/python3.6/site-packages/buildbot/changes/gitpoller.py\", line 226, in poll\r\n            yield self._process_changes(revs[branch], branch)\r\n          File \"/home/andrei/bot/sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\n            result = result.throwExceptionIntoGenerator(g)\r\n          File \"/home/andrei/bot/sandbox/lib/python3.6/site-packages/twisted/python/failure.py\", line 512, in throwExceptionIntoGenerator\r\n            return g.throw(self.type, self.value, self.tb)\r\n          File \"/home/andrei/bot/sandbox/lib/python3.6/site-packages/buildbot/changes/gitpoller.py\", line 323, in _process_changes\r\n            results = yield self._dovccmd('log', revListArgs, path=self.workdir)\r\n          File \"/home/andrei/bot/sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\n            result = result.throwExceptionIntoGenerator(g)\r\n          File \"/home/andrei/bot/sandbox/lib/python3.6/site-packages/twisted/python/failure.py\", line 512, in throwExceptionIntoGenerator\r\n            return g.throw(self.type, self.value, self.tb)\r\n          File \"/home/andrei/bot/sandbox/lib/python3.6/site-packages/buildbot/changes/gitpoller.py\", line 404, in _dovccmd\r\n            stdout = yield self._dovccmdImpl(command, args, path, None)\r\n          File \"/home/andrei/bot/sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1418, in _inlineCallbacks\r\n            result = g.send(result)\r\n          File \"/home/andrei/bot/sandbox/lib/python3.6/site-packages/buildbot/changes/gitpoller.py\", line 435, in _dovccmdImpl\r\n            full_args, path, self.repourl, code, stderr))\r\n        buildbot.changes.gitpoller.GitError: command ['log', '--format=%H', 'c95ef0d02693d2f241407a8e212de44505d7b2d2', '^06c7ebeae91f0d4253f50d27084ed6254cfc4375', '^183278a5caa2d18d1acb0acfb5747b77c5f02427', $\r\n\r\n\r\n2019-07-23 11:19:11+0000 [-] gitpoller: processing changes from \"git@github.com:QuasarApp/Hanoi-Towers.git\"\r\n2019-07-23 11:19:12+0000 [-] gitpoller: processing changes from \"https://github.com/usermeme/chat-vironit.git\"\r\n``` \r\n\r\n\r\n**How to fix it error ?**", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4912/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4912/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4903", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4903/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4903/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4903/events", "html_url": "https://github.com/buildbot/buildbot/issues/4903", "id": 470779011, "node_id": "MDU6SXNzdWU0NzA3NzkwMTE=", "number": 4903, "title": "UnboundLocalError in /api/v2/changes/:n/builds", "user": {"login": "ImRajdeepB", "id": 30660439, "node_id": "MDQ6VXNlcjMwNjYwNDM5", "avatar_url": "https://avatars.githubusercontent.com/u/30660439?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ImRajdeepB", "html_url": "https://github.com/ImRajdeepB", "followers_url": "https://api.github.com/users/ImRajdeepB/followers", "following_url": "https://api.github.com/users/ImRajdeepB/following{/other_user}", "gists_url": "https://api.github.com/users/ImRajdeepB/gists{/gist_id}", "starred_url": "https://api.github.com/users/ImRajdeepB/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ImRajdeepB/subscriptions", "organizations_url": "https://api.github.com/users/ImRajdeepB/orgs", "repos_url": "https://api.github.com/users/ImRajdeepB/repos", "events_url": "https://api.github.com/users/ImRajdeepB/events{/privacy}", "received_events_url": "https://api.github.com/users/ImRajdeepB/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "ImRajdeepB", "id": 30660439, "node_id": "MDQ6VXNlcjMwNjYwNDM5", "avatar_url": "https://avatars.githubusercontent.com/u/30660439?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ImRajdeepB", "html_url": "https://github.com/ImRajdeepB", "followers_url": "https://api.github.com/users/ImRajdeepB/followers", "following_url": "https://api.github.com/users/ImRajdeepB/following{/other_user}", "gists_url": "https://api.github.com/users/ImRajdeepB/gists{/gist_id}", "starred_url": "https://api.github.com/users/ImRajdeepB/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ImRajdeepB/subscriptions", "organizations_url": "https://api.github.com/users/ImRajdeepB/orgs", "repos_url": "https://api.github.com/users/ImRajdeepB/repos", "events_url": "https://api.github.com/users/ImRajdeepB/events{/privacy}", "received_events_url": "https://api.github.com/users/ImRajdeepB/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ImRajdeepB", "id": 30660439, "node_id": "MDQ6VXNlcjMwNjYwNDM5", "avatar_url": "https://avatars.githubusercontent.com/u/30660439?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ImRajdeepB", "html_url": "https://github.com/ImRajdeepB", "followers_url": "https://api.github.com/users/ImRajdeepB/followers", "following_url": "https://api.github.com/users/ImRajdeepB/following{/other_user}", "gists_url": "https://api.github.com/users/ImRajdeepB/gists{/gist_id}", "starred_url": "https://api.github.com/users/ImRajdeepB/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ImRajdeepB/subscriptions", "organizations_url": "https://api.github.com/users/ImRajdeepB/orgs", "repos_url": "https://api.github.com/users/ImRajdeepB/repos", "events_url": "https://api.github.com/users/ImRajdeepB/events{/privacy}", "received_events_url": "https://api.github.com/users/ImRajdeepB/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-07-21T12:59:54Z", "updated_at": "2019-08-01T18:08:23Z", "closed_at": "2019-08-01T18:08:23Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "```\r\n{\"error\": \"UnboundLocalError(\\\"local variable 'filters' referenced before assignment\\\")\"}\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4903/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4903/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4898", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4898/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4898/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4898/events", "html_url": "https://github.com/buildbot/buildbot/issues/4898", "id": 470158627, "node_id": "MDU6SXNzdWU0NzAxNTg2Mjc=", "number": 4898, "title": "How to use GitHubCommentPush in BuildBot?", "user": {"login": "EndrII", "id": 12465465, "node_id": "MDQ6VXNlcjEyNDY1NDY1", "avatar_url": "https://avatars.githubusercontent.com/u/12465465?v=4", "gravatar_id": "", "url": "https://api.github.com/users/EndrII", "html_url": "https://github.com/EndrII", "followers_url": "https://api.github.com/users/EndrII/followers", "following_url": "https://api.github.com/users/EndrII/following{/other_user}", "gists_url": "https://api.github.com/users/EndrII/gists{/gist_id}", "starred_url": "https://api.github.com/users/EndrII/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/EndrII/subscriptions", "organizations_url": "https://api.github.com/users/EndrII/orgs", "repos_url": "https://api.github.com/users/EndrII/repos", "events_url": "https://api.github.com/users/EndrII/events{/privacy}", "received_events_url": "https://api.github.com/users/EndrII/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2019-07-19T06:22:34Z", "updated_at": "2019-08-21T12:24:06Z", "closed_at": "2019-08-21T12:24:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm trying to add an automatic feedback from BuildBot to a github pull request using [GitHubCommentPush](http://docs.buildbot.net/current/manual/configuration/reporters.html#githubcommentpush)\r\n\r\nBut I constantly get an error:\r\n\r\n``` log\r\n2019-07-18 09: 04: 56 + 0000 [-] Timing out client: IPv4Address (type = 'TCP', host = '86 .57.157.184 ', port = 42090)\r\n2019-07-18 09: 04: 56 + 0000 [-] Timing out client: IPv4Address (type = 'TCP', host = '86 .57.245.94 ', port = 42086)\r\n2019-07-18 09: 04: 56 + 0000 [-] Timing out client: IPv4Address (type = 'TCP', host = '86 .57.157.184 ', port = 42092)\r\n2019-07-18 09: 04: 56 + 0000 [-] while invoking <bound method HttpStatusPushBase.buildStarted of <buildbot.reporters.github.GitHubCommentPush object at 0x7f4ae512aa20 >>\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Traceback (most recent call last):\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0File \"/home/andrei/bot/sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1418, in _inlineCallbacks\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0result = g.send (result)\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0File \"/home/andrei/bot/sandbox/lib/python3.6/site-packages/buildbot/reporters/http.py\", line 80, in getMoreInfoAndSend\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0yield self.send (build)\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0File \"/home/andrei/bot/sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1613, in unwindGenerator\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0return _cancellableInlineCallbacks (gen)\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0File \"/home/andrei/bot/sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1529, in _cancellableInlineCallbacks\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0_inlineCallbacks (None, g, status)\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0--- <exception caught here> ---\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0File \"/home/andrei/bot/sandbox/lib/python3.6/site-packages/buildbot/reporters/http.py\", line 80, in getMoreInfoAndSend\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0yield self.send (build)\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0File \"/home/andrei/bot/sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1418, in _inlineCallbacks\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0result = g.send (result)\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0File \"/home/andrei/bot/sandbox/lib/python3.6/site-packages/buildbot/reporters/github.py\", line 177, in send\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0content = yield response.content ()\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0builtins.UnboundLocalError: local variable 'response' referenced before assignment\r\n\r\n```\r\n\r\nApparently my GitHub token is not a valid .\r\n\r\nI have no idea what kind of token the buildbot wants.\r\n\r\n* I tried to create OAuth Apps (but did not publish it in the GitHub Marketplace) and use the Client Secret of the created application as a token.\r\n\r\n* I tried to create GitHub Apps in the same way as above, I used Client Secret as a token.\r\n\r\n* I tried to create a Personal access token.\r\n\r\nNone of these points helped me.\r\n\r\nCan anyone explain how this should work?\r\n\r\n\r\nHere is the code for how I connect the service.\r\n``` python\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0self.masterConf ['services'] = []\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0self.masterConf ['secretsProviders'] = [\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0secrets.SecretInAFile (dirname = \"/path/to/buildBotSecret\")\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0]\r\n\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0gc = reporters.GitHubCommentPush (token = util.Secret(\"gitHub\"),\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0startDescription = 'Build started.',\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0endDescription = 'Build done.')\r\n\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0self.masterConf ['services']. append (gc)\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4898/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4898/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4894", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4894/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4894/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4894/events", "html_url": "https://github.com/buildbot/buildbot/issues/4894", "id": 468686498, "node_id": "MDU6SXNzdWU0Njg2ODY0OTg=", "number": 4894, "title": "Performance of stopping jobs on Yocto Project buildbot instance is problematic", "user": {"login": "rpurdie", "id": 1184070, "node_id": "MDQ6VXNlcjExODQwNzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1184070?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rpurdie", "html_url": "https://github.com/rpurdie", "followers_url": "https://api.github.com/users/rpurdie/followers", "following_url": "https://api.github.com/users/rpurdie/following{/other_user}", "gists_url": "https://api.github.com/users/rpurdie/gists{/gist_id}", "starred_url": "https://api.github.com/users/rpurdie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rpurdie/subscriptions", "organizations_url": "https://api.github.com/users/rpurdie/orgs", "repos_url": "https://api.github.com/users/rpurdie/repos", "events_url": "https://api.github.com/users/rpurdie/events{/privacy}", "received_events_url": "https://api.github.com/users/rpurdie/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 637049577, "node_id": "MDU6TGFiZWw2MzcwNDk1Nzc=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/performance", "name": "performance", "color": "d93f0b", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2019-07-16T14:25:28Z", "updated_at": "2019-10-23T21:40:25Z", "closed_at": "2019-10-23T21:40:24Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The Yocto Project has a buildbot installation at: https://autobuilder.yoctoproject.org/typhoon/#/console which includes a custom console view plugin (http://git.yoctoproject.org/cgit.cgi/yocto-autobuilder2).\r\n\r\nA characteristic of this is there are a couple of trigger jobs (a-full and a-quick) which trigger 40-50 sub jobs. If we notice a build failing and want to stop it, we can hit the \"stop\" button in the buildbot UI. The problem is that the server then goes completely non-responsive for 3-4 minutes. Builds that are running will keep running and the UI does come back but nginx will timeout and we lose the UI for that time.\r\n\r\nWe shared profiling data with tardyp who said it looked like some kind of unindexed database query problem. We switched our database backend from sqlite to mysql and whilst the UI is responsive in some other ways, the original problem remains. The database is around 8GB in size, mostly with logfiles. We're looking at timing those out but I instinct says that probably also won't help this timeout problem much. Any pointers on how to improve things, or help debug this are welcome. We can reproduce the problem at will by starting a build, letting it get going then stopping it.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4894/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4894/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4885", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4885/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4885/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4885/events", "html_url": "https://github.com/buildbot/buildbot/issues/4885", "id": 465741761, "node_id": "MDU6SXNzdWU0NjU3NDE3NjE=", "number": 4885, "title": "virtual builders are shown as old builders", "user": {"login": "ImRajdeepB", "id": 30660439, "node_id": "MDQ6VXNlcjMwNjYwNDM5", "avatar_url": "https://avatars.githubusercontent.com/u/30660439?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ImRajdeepB", "html_url": "https://github.com/ImRajdeepB", "followers_url": "https://api.github.com/users/ImRajdeepB/followers", "following_url": "https://api.github.com/users/ImRajdeepB/following{/other_user}", "gists_url": "https://api.github.com/users/ImRajdeepB/gists{/gist_id}", "starred_url": "https://api.github.com/users/ImRajdeepB/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ImRajdeepB/subscriptions", "organizations_url": "https://api.github.com/users/ImRajdeepB/orgs", "repos_url": "https://api.github.com/users/ImRajdeepB/repos", "events_url": "https://api.github.com/users/ImRajdeepB/events{/privacy}", "received_events_url": "https://api.github.com/users/ImRajdeepB/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 1445494760, "node_id": "MDU6TGFiZWwxNDQ1NDk0NzYw", "url": "https://api.github.com/repos/buildbot/buildbot/labels/gsoc2019", "name": "gsoc2019", "color": "bfd4f2", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-07-09T12:03:39Z", "updated_at": "2019-08-17T19:17:24Z", "closed_at": "2019-08-17T19:17:24Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "In the builders page, I am having to enable `show old builders` option to display virtual builders.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4885/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4885/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4880", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4880/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4880/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4880/events", "html_url": "https://github.com/buildbot/buildbot/issues/4880", "id": 464745484, "node_id": "MDU6SXNzdWU0NjQ3NDU0ODQ=", "number": 4880, "title": "images not displayed (icon, favicon, etc.)", "user": {"login": "ImRajdeepB", "id": 30660439, "node_id": "MDQ6VXNlcjMwNjYwNDM5", "avatar_url": "https://avatars.githubusercontent.com/u/30660439?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ImRajdeepB", "html_url": "https://github.com/ImRajdeepB", "followers_url": "https://api.github.com/users/ImRajdeepB/followers", "following_url": "https://api.github.com/users/ImRajdeepB/following{/other_user}", "gists_url": "https://api.github.com/users/ImRajdeepB/gists{/gist_id}", "starred_url": "https://api.github.com/users/ImRajdeepB/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ImRajdeepB/subscriptions", "organizations_url": "https://api.github.com/users/ImRajdeepB/orgs", "repos_url": "https://api.github.com/users/ImRajdeepB/repos", "events_url": "https://api.github.com/users/ImRajdeepB/events{/privacy}", "received_events_url": "https://api.github.com/users/ImRajdeepB/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557399128, "node_id": "MDU6TGFiZWw1NTczOTkxMjg=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/web%20UI", "name": "web UI", "color": "bfd4f2", "default": false, "description": null}, {"id": 1445494760, "node_id": "MDU6TGFiZWwxNDQ1NDk0NzYw", "url": "https://api.github.com/repos/buildbot/buildbot/labels/gsoc2019", "name": "gsoc2019", "color": "bfd4f2", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "ImRajdeepB", "id": 30660439, "node_id": "MDQ6VXNlcjMwNjYwNDM5", "avatar_url": "https://avatars.githubusercontent.com/u/30660439?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ImRajdeepB", "html_url": "https://github.com/ImRajdeepB", "followers_url": "https://api.github.com/users/ImRajdeepB/followers", "following_url": "https://api.github.com/users/ImRajdeepB/following{/other_user}", "gists_url": "https://api.github.com/users/ImRajdeepB/gists{/gist_id}", "starred_url": "https://api.github.com/users/ImRajdeepB/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ImRajdeepB/subscriptions", "organizations_url": "https://api.github.com/users/ImRajdeepB/orgs", "repos_url": "https://api.github.com/users/ImRajdeepB/repos", "events_url": "https://api.github.com/users/ImRajdeepB/events{/privacy}", "received_events_url": "https://api.github.com/users/ImRajdeepB/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ImRajdeepB", "id": 30660439, "node_id": "MDQ6VXNlcjMwNjYwNDM5", "avatar_url": "https://avatars.githubusercontent.com/u/30660439?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ImRajdeepB", "html_url": "https://github.com/ImRajdeepB", "followers_url": "https://api.github.com/users/ImRajdeepB/followers", "following_url": "https://api.github.com/users/ImRajdeepB/following{/other_user}", "gists_url": "https://api.github.com/users/ImRajdeepB/gists{/gist_id}", "starred_url": "https://api.github.com/users/ImRajdeepB/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ImRajdeepB/subscriptions", "organizations_url": "https://api.github.com/users/ImRajdeepB/orgs", "repos_url": "https://api.github.com/users/ImRajdeepB/repos", "events_url": "https://api.github.com/users/ImRajdeepB/events{/privacy}", "received_events_url": "https://api.github.com/users/ImRajdeepB/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-07-05T18:58:56Z", "updated_at": "2019-07-27T17:41:03Z", "closed_at": "2019-07-27T17:41:03Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "Also, the dev environment isn't working properly in `www/base`", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4880/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4880/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4876", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4876/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4876/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4876/events", "html_url": "https://github.com/buildbot/buildbot/issues/4876", "id": 463737012, "node_id": "MDU6SXNzdWU0NjM3MzcwMTI=", "number": 4876, "title": "HgPoller crashes in mercurial repo with stripped commits", "user": {"login": "smelc", "id": 634720, "node_id": "MDQ6VXNlcjYzNDcyMA==", "avatar_url": "https://avatars.githubusercontent.com/u/634720?v=4", "gravatar_id": "", "url": "https://api.github.com/users/smelc", "html_url": "https://github.com/smelc", "followers_url": "https://api.github.com/users/smelc/followers", "following_url": "https://api.github.com/users/smelc/following{/other_user}", "gists_url": "https://api.github.com/users/smelc/gists{/gist_id}", "starred_url": "https://api.github.com/users/smelc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/smelc/subscriptions", "organizations_url": "https://api.github.com/users/smelc/orgs", "repos_url": "https://api.github.com/users/smelc/repos", "events_url": "https://api.github.com/users/smelc/events{/privacy}", "received_events_url": "https://api.github.com/users/smelc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2019-07-03T12:55:26Z", "updated_at": "2020-01-04T10:59:39Z", "closed_at": "2020-01-04T10:59:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm witnessing issues with **mercurial**'s poller after updating my bots from 2.0.1 to 2.3.0. The issues have been introduced starting at version 2.2.0, see the entry _Buildbot can now monitor multiple branches in a Mercurial repository._ in the [changelog](http://docs.buildbot.net/current/relnotes/index.html) and is related to [this streak of commits](https://github.com/buildbot/buildbot/commits?author=slightlyunconventional) by @slightlyunconventional \r\n\r\nHere are the issues I've witnessed:\r\n\r\n* BUG1: Without changing my bot's code, I'm witnessing that only a **single poller is alive** whereas I'm creating multiple instances of HgPoller (for multiple branches of the same repo). This is visible in the bot's log, because `buildbot/changes/hgpoller.py` logs every time it polls a repo (see \"hgpoller: polling hg repo\" string). With version 2.3.0 only a single branch is active. On a production bot I was witnessing that solely branch \"default\" (whereas pollers were created for branches \"default\" and \"DtsXtextEditor\") was being polled. When creating a minimal example, I was witnessing that a non-\"default\" branch was the working one. I tried understanding which branch was being chosen to no avail. Note that I however witness:\r\n\r\n     ```\r\n     buildbotNetUsageData: sending  { ...  'buildbot/changes/hgpoller/HgPoller': 2 }\r\n     ```\r\n    \r\n     when creating two pollers for two branches. So the pollers are sent but are somehow lost afterwards.\r\n\r\n* BUG2: By changing my bot's code, to use a single HgPoller for all branches (i.e. using the new feature introduced in 2.2.0), I'm witnessing that **only one branch is being pulled** (I've tried with at most two branches) successfully. The other branch fails as follows (every time the poller runs, not only on an incoming commit):\r\n    \r\n    ```[-] hgpoller: repo poll failed\r\n    Unhandled Error\r\n    File \".../sandbox/lib/python3.6/site-packages/buildbot/changes/hgpoller.py\", line 277, in `_processBranchChanges`\r\n    del revNodeList[0]\r\n    builtins.IndexError: list assignment index out of range\r\n   ````\r\n\r\n  I've witnessed this behavior on two production bots. I could not reproduce it with a minimal example with fresh mercurial repositories. I believe it has to do with the database's state. This is a **blocking bug** as it forbids the bot to consume incoming commits.\r\n    \r\nFor the record, I've also witnessing the following issues when **stripping the mercurial repo**:\r\n\r\n```[-] hgpoller: repo poll failed\r\n[-] Unhandled Error\r\n\tTraceback (most recent call last):\r\n\t--- <exception caught here> ---\r\n\t  File \"/media/truecrypt1/merlin/korhal/sandbox/lib/python3.6/site-packages/buildbot/changes/hgpoller.py\", line 255, in _processChanges\r\n\t    yield self._processBranchChanges(rev, branch)\r\n\t  File \"/media/truecrypt1/merlin/korhal/sandbox/lib/python3.6/site-packages/buildbot/changes/hgpoller.py\", line 272, in _processBranchChanges\r\n\t    path=self._absWorkdir(), env=os.environ, errortoo=False)\r\n\ttwisted.internet.utils._UnexpectedErrorOutput: got stderr: b\"abort: unknown revision '11'!\\n\"\r\n```\r\n\t\r\nwhen revision `11` got stripped, and afterwards the following traces (at every polling):\r\n\r\n```\r\n[-] Unhandled error in Deferred:\r\n[-] Unhandled Error\r\n\tTraceback (most recent call last):\r\n\tFailure: twisted.internet.error.ProcessTerminated: A process has ended with a probable error condition: process ended with exit code 255.\r\n```\r\nThe fact that this trace was appearing after every polling seem to disagree with `_processChangesFailure` comment:\r\n\r\n```\r\n        # eat the failure to continue along the deferred chain - we still want\r\n        # to catch up\r\n```\r\n\r\nHowever these last two traces seem less of an issue that my first two bullets, because if new changesets are created (making the stripped revision number \"come back\"), polling will work again (with the caveat of my second bullet). It could however be an issue if you strip a large number of commits. I can't say if this behavior was already in 2.0.1.\r\n\r\nI'm willing to test patches, please send them my way. For the moment I've stayed on version 2.1.0.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4876/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4876/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4873", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4873/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4873/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4873/events", "html_url": "https://github.com/buildbot/buildbot/issues/4873", "id": 463178468, "node_id": "MDU6SXNzdWU0NjMxNzg0Njg=", "number": 4873, "title": "Bitbucket Cloud web hook returns 500", "user": {"login": "tzaeru", "id": 537240, "node_id": "MDQ6VXNlcjUzNzI0MA==", "avatar_url": "https://avatars.githubusercontent.com/u/537240?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tzaeru", "html_url": "https://github.com/tzaeru", "followers_url": "https://api.github.com/users/tzaeru/followers", "following_url": "https://api.github.com/users/tzaeru/following{/other_user}", "gists_url": "https://api.github.com/users/tzaeru/gists{/gist_id}", "starred_url": "https://api.github.com/users/tzaeru/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tzaeru/subscriptions", "organizations_url": "https://api.github.com/users/tzaeru/orgs", "repos_url": "https://api.github.com/users/tzaeru/repos", "events_url": "https://api.github.com/users/tzaeru/events{/privacy}", "received_events_url": "https://api.github.com/users/tzaeru/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-07-02T11:36:58Z", "updated_at": "2019-08-03T12:16:28Z", "closed_at": "2019-08-03T12:16:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "Started three weeks ago (missed it due to vacations), my guess is that Bitbucket changed something. Error log looks like this:\r\n\r\n```\r\n2019-07-02 14:33:40+0300 [_GenericHTTPChannelProtocol,13,18.234.32.226] adding changes from web hook\r\n        Traceback (most recent call last):\r\n          File \"/home/buildbot/sandbox/lib/python3.5/site-packages/twisted/internet/defer.py\", line 1418, in _inlineCallbacks\r\n            result = g.send(result)\r\n          File \"/home/buildbot/sandbox/lib/python3.5/site-packages/buildbot/www/change_hook.py\", line 106, in getAndSubmitChanges\r\n            changes, src = yield self.getChanges(request)\r\n          File \"/home/buildbot/sandbox/lib/python3.5/site-packages/twisted/internet/defer.py\", line 1613, in unwindGenerator\r\n            return _cancellableInlineCallbacks(gen)\r\n          File \"/home/buildbot/sandbox/lib/python3.5/site-packages/twisted/internet/defer.py\", line 1529, in _cancellableInlineCallbacks\r\n            _inlineCallbacks(None, g, status)\r\n        --- <exception caught here> ---\r\n          File \"/home/buildbot/sandbox/lib/python3.5/site-packages/buildbot/www/change_hook.py\", line 106, in getAndSubmitChanges\r\n            changes, src = yield self.getChanges(request)\r\n          File \"/home/buildbot/sandbox/lib/python3.5/site-packages/twisted/internet/defer.py\", line 1418, in _inlineCallbacks\r\n            result = g.send(result)\r\n          File \"/home/buildbot/sandbox/lib/python3.5/site-packages/buildbot/www/change_hook.py\", line 167, in getChanges\r\n            changes, src = yield handler.getChanges(request)\r\n          File \"/home/buildbot/sandbox/lib/python3.5/site-packages/buildbot/www/hooks/bitbucketcloud.py\", line 163, in getChanges\r\n            return self.process(request)\r\n          File \"/home/buildbot/sandbox/lib/python3.5/site-packages/buildbot/www/hooks/bitbucketcloud.py\", line 54, in process\r\n            return handler(payload)\r\n          File \"/home/buildbot/sandbox/lib/python3.5/site-packages/buildbot/www/hooks/bitbucketcloud.py\", line 97, in handle_repo_push\r\n            payload['actor']['username']),\r\n        builtins.KeyError: 'username'\r\n```\r\n\r\nLast line reveals the culprit.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4873/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4873/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4869", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4869/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4869/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4869/events", "html_url": "https://github.com/buildbot/buildbot/issues/4869", "id": 461712713, "node_id": "MDU6SXNzdWU0NjE3MTI3MTM=", "number": 4869, "title": "builders page is slow, need search-ish alternative or a filter", "user": {"login": "dankegel", "id": 170976, "node_id": "MDQ6VXNlcjE3MDk3Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/170976?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dankegel", "html_url": "https://github.com/dankegel", "followers_url": "https://api.github.com/users/dankegel/followers", "following_url": "https://api.github.com/users/dankegel/following{/other_user}", "gists_url": "https://api.github.com/users/dankegel/gists{/gist_id}", "starred_url": "https://api.github.com/users/dankegel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dankegel/subscriptions", "organizations_url": "https://api.github.com/users/dankegel/orgs", "repos_url": "https://api.github.com/users/dankegel/repos", "events_url": "https://api.github.com/users/dankegel/events{/privacy}", "received_events_url": "https://api.github.com/users/dankegel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557399128, "node_id": "MDU6TGFiZWw1NTczOTkxMjg=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/web%20UI", "name": "web UI", "color": "bfd4f2", "default": false, "description": null}, {"id": 834247540, "node_id": "MDU6TGFiZWw4MzQyNDc1NDA=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/large%20scale", "name": "large scale", "color": "006b75", "default": false, "description": null}, {"id": 1445494760, "node_id": "MDU6TGFiZWwxNDQ1NDk0NzYw", "url": "https://api.github.com/repos/buildbot/buildbot/labels/gsoc2019", "name": "gsoc2019", "color": "bfd4f2", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-06-27T19:37:48Z", "updated_at": "2019-08-17T19:27:16Z", "closed_at": "2019-08-17T19:27:16Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The builders page takes about five seconds to load, and even after it loads, finding the builder in question amongst the thousands of builders is hard.  Users have taken to doing things like\r\n```\r\n#!/bin/sh\r\n# wmb - Dude, where's my builder?\r\ncurl -sS http://buildhost5.example.com:8010/api/v2/builders | jq '\r\n[.builders[]\r\n | select(.name | match($search))\r\n | {name:.name, link: @uri \"http://buildhost5.oblong.com:8010/#/builders/\\(.builderid)\"}]\r\n | sort_by(.name)\r\n' --arg search \"$1\"\r\n```\r\n\r\nThat lets users quickly find the URLs for the builders of interest... but it'd be nice if the\r\nfront page had a search box that did the same thing, so they didn't have to resort to\r\nthe commandline.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4869/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4869/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4860", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4860/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4860/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4860/events", "html_url": "https://github.com/buildbot/buildbot/issues/4860", "id": 459550406, "node_id": "MDU6SXNzdWU0NTk1NTA0MDY=", "number": 4860, "title": "Fully support committer field", "user": {"login": "ImRajdeepB", "id": 30660439, "node_id": "MDQ6VXNlcjMwNjYwNDM5", "avatar_url": "https://avatars.githubusercontent.com/u/30660439?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ImRajdeepB", "html_url": "https://github.com/ImRajdeepB", "followers_url": "https://api.github.com/users/ImRajdeepB/followers", "following_url": "https://api.github.com/users/ImRajdeepB/following{/other_user}", "gists_url": "https://api.github.com/users/ImRajdeepB/gists{/gist_id}", "starred_url": "https://api.github.com/users/ImRajdeepB/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ImRajdeepB/subscriptions", "organizations_url": "https://api.github.com/users/ImRajdeepB/orgs", "repos_url": "https://api.github.com/users/ImRajdeepB/repos", "events_url": "https://api.github.com/users/ImRajdeepB/events{/privacy}", "received_events_url": "https://api.github.com/users/ImRajdeepB/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557387615, "node_id": "MDU6TGFiZWw1NTczODc2MTU=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/feature", "name": "feature", "color": "0e8c50", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "ImRajdeepB", "id": 30660439, "node_id": "MDQ6VXNlcjMwNjYwNDM5", "avatar_url": "https://avatars.githubusercontent.com/u/30660439?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ImRajdeepB", "html_url": "https://github.com/ImRajdeepB", "followers_url": "https://api.github.com/users/ImRajdeepB/followers", "following_url": "https://api.github.com/users/ImRajdeepB/following{/other_user}", "gists_url": "https://api.github.com/users/ImRajdeepB/gists{/gist_id}", "starred_url": "https://api.github.com/users/ImRajdeepB/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ImRajdeepB/subscriptions", "organizations_url": "https://api.github.com/users/ImRajdeepB/orgs", "repos_url": "https://api.github.com/users/ImRajdeepB/repos", "events_url": "https://api.github.com/users/ImRajdeepB/events{/privacy}", "received_events_url": "https://api.github.com/users/ImRajdeepB/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ImRajdeepB", "id": 30660439, "node_id": "MDQ6VXNlcjMwNjYwNDM5", "avatar_url": "https://avatars.githubusercontent.com/u/30660439?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ImRajdeepB", "html_url": "https://github.com/ImRajdeepB", "followers_url": "https://api.github.com/users/ImRajdeepB/followers", "following_url": "https://api.github.com/users/ImRajdeepB/following{/other_user}", "gists_url": "https://api.github.com/users/ImRajdeepB/gists{/gist_id}", "starred_url": "https://api.github.com/users/ImRajdeepB/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ImRajdeepB/subscriptions", "organizations_url": "https://api.github.com/users/ImRajdeepB/orgs", "repos_url": "https://api.github.com/users/ImRajdeepB/repos", "events_url": "https://api.github.com/users/ImRajdeepB/events{/privacy}", "received_events_url": "https://api.github.com/users/ImRajdeepB/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2019-06-23T08:29:35Z", "updated_at": "2019-07-18T10:33:01Z", "closed_at": "2019-07-03T21:55:04Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "changes.commiter is `null` on \r\n\r\n- [ ] github pull requests\r\n- [ ] hooks", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4860/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4860/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4844", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4844/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4844/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4844/events", "html_url": "https://github.com/buildbot/buildbot/issues/4844", "id": 456866016, "node_id": "MDU6SXNzdWU0NTY4NjYwMTY=", "number": 4844, "title": "Error when disconnecting libvirt's worker", "user": {"login": "Akrog", "id": 5928725, "node_id": "MDQ6VXNlcjU5Mjg3MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5928725?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Akrog", "html_url": "https://github.com/Akrog", "followers_url": "https://api.github.com/users/Akrog/followers", "following_url": "https://api.github.com/users/Akrog/following{/other_user}", "gists_url": "https://api.github.com/users/Akrog/gists{/gist_id}", "starred_url": "https://api.github.com/users/Akrog/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Akrog/subscriptions", "organizations_url": "https://api.github.com/users/Akrog/orgs", "repos_url": "https://api.github.com/users/Akrog/repos", "events_url": "https://api.github.com/users/Akrog/events{/privacy}", "received_events_url": "https://api.github.com/users/Akrog/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-06-17T10:43:59Z", "updated_at": "2019-06-20T07:36:15Z", "closed_at": "2019-06-20T07:36:15Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When insubstantiating a libvirt worker the disconnection will raise an excepcion:\r\n\r\n```\r\njun 13 18:37:15 emberci buildbot[7131]: 2019-06-13 18:37:15+0000 [-] disconnecting old worker libvirt now\r\njun 13 18:37:15 emberci buildbot[7131]: 2019-06-13 18:37:15+0000 [-] waiting for worker to finish disconnecting\r\njun 13 18:37:15 emberci buildbot[7131]: 2019-06-13 18:37:15+0000 [-] insubstantiating worker <LibVirtWorker 'libvirt'>\r\njun 13 18:37:15 emberci buildbot[7131]: 2019-06-13 18:37:15+0000 [-] Attempting to stop 'libvirt'\r\njun 13 18:37:15 emberci buildbot[7131]: 2019-06-13 18:37:15+0000 [-] Looking to start a piece of work now...\r\njun 13 18:37:15 emberci buildbot[7131]: 2019-06-13 18:37:15+0000 [Broker,0,192.168.122.105] Worker.detached(libvirt)\r\njun 13 18:37:15 emberci buildbot[7131]: 2019-06-13 18:37:15+0000 [Broker,0,192.168.122.105] releaseLocks(<LibVirtWorker 'libvirt'>): []\r\njun 13 18:37:15 emberci buildbot[7131]: 2019-06-13 18:37:15+0000 [-] Completed a piece of work\r\njun 13 18:37:15 emberci buildbot[7131]: 2019-06-13 18:37:15+0000 [-] VM destroyed (libvirt): Forcing its connection closed.\r\njun 13 18:37:15 emberci buildbot[7131]: 2019-06-13 18:37:15+0000 [-] We forced disconnection (libvirt), cleaning up and triggering new build\r\njun 13 18:37:15 emberci buildbot[7131]: 2019-06-13 18:37:15+0000 [-] while insubstantiating\r\njun 13 18:37:15 emberci buildbot[7131]: Traceback (most recent call last):\r\njun 13 18:37:15 emberci buildbot[7131]: File \"/usr/local/lib64/python3.6/site-packages/twisted/internet/defer.py\", line 1475, in gotResult\r\njun 13 18:37:15 emberci buildbot[7131]: _inlineCallbacks(r, g, status)\r\njun 13 18:37:15 emberci buildbot[7131]: File \"/usr/local/lib64/python3.6/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\njun 13 18:37:15 emberci buildbot[7131]: result = result.throwExceptionIntoGenerator(g)\r\njun 13 18:37:15 emberci buildbot[7131]: File \"/usr/local/lib64/python3.6/site-packages/twisted/python/failure.py\", line 512, in throwExceptionIntoGenerator\r\njun 13 18:37:15 emberci buildbot[7131]: return g.throw(self.type, self.value, self.tb)\r\njun 13 18:37:15 emberci buildbot[7131]: File \"/usr/local/lib/python3.6/site-packages/buildbot/worker/latent.py\", line 439, in insubstantiate\r\njun 13 18:37:15 emberci buildbot[7131]: log.err(e, \"while insubstantiating\")\r\njun 13 18:37:15 emberci buildbot[7131]: --- <exception caught here> ---\r\njun 13 18:37:15 emberci buildbot[7131]: File \"/usr/local/lib/python3.6/site-packages/buildbot/worker/latent.py\", line 433, in insubstantiate\r\njun 13 18:37:15 emberci buildbot[7131]: yield self.stop_instance(fast)\r\njun 13 18:37:15 emberci buildbot[7131]: File \"/usr/local/lib64/python3.6/site-packages/twisted/internet/defer.py\", line 654, in _runCallbacks\r\njun 13 18:37:15 emberci buildbot[7131]: current.result = callback(current.result, *args, **kw)\r\njun 13 18:37:15 emberci buildbot[7131]: File \"/usr/local/lib/python3.6/site-packages/buildbot/worker/libvirt.py\", line 301, in _disconnect\r\njun 13 18:37:15 emberci buildbot[7131]: return super().disconnect()\r\njun 13 18:37:15 emberci buildbot[7131]: builtins.TypeError: super(type, obj): obj must be an instance or subtype of type\r\n[root@emberci images]# virsh list --all\r\n```\r\n\r\nThe issue is caused by the call to `super().disconnect()` in `_disconnect`'s callback:\r\n\r\n```\r\n        @d.addCallback\r\n        def _disconnect(res):\r\n            log.msg(\"VM destroyed (%s): Forcing its connection closed.\" %\r\n                    self.workername)\r\n            return super().disconnect()\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4844/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4844/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4836", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4836/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4836/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4836/events", "html_url": "https://github.com/buildbot/buildbot/issues/4836", "id": 456158280, "node_id": "MDU6SXNzdWU0NTYxNTgyODA=", "number": 4836, "title": "Unable to use logfiles in ShellCommand after upgraded buildbot worker to python 3", "user": {"login": "doberkofler", "id": 1009585, "node_id": "MDQ6VXNlcjEwMDk1ODU=", "avatar_url": "https://avatars.githubusercontent.com/u/1009585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/doberkofler", "html_url": "https://github.com/doberkofler", "followers_url": "https://api.github.com/users/doberkofler/followers", "following_url": "https://api.github.com/users/doberkofler/following{/other_user}", "gists_url": "https://api.github.com/users/doberkofler/gists{/gist_id}", "starred_url": "https://api.github.com/users/doberkofler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/doberkofler/subscriptions", "organizations_url": "https://api.github.com/users/doberkofler/orgs", "repos_url": "https://api.github.com/users/doberkofler/repos", "events_url": "https://api.github.com/users/doberkofler/events{/privacy}", "received_events_url": "https://api.github.com/users/doberkofler/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 632499035, "node_id": "MDU6TGFiZWw2MzI0OTkwMzU=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bytes", "name": "bytes", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-06-14T09:46:20Z", "updated_at": "2019-06-16T12:03:02Z", "closed_at": "2019-06-16T12:03:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have just upgraded a buildbot worker to Python version 3.7.3 and buildbot version 2019.06.13 on the Windows platform and without any changes in the configuration itself, I now get the following buildbot error whenever the `logfiles` parameter is used in a `ShellCommand`\r\n\r\n```\r\n2019-06-14 11:30:12+0200 [-] Unhandled Error\r\n\tTraceback (most recent call last):\r\n\t  File \"c:\\program files\\python37\\lib\\site-packages\\twisted\\internet\\base.py\", line 1272, in run\r\n\t    self.mainLoop()\r\n\t  File \"c:\\program files\\python37\\lib\\site-packages\\twisted\\internet\\base.py\", line 1281, in mainLoop\r\n\t    self.runUntilCurrent()\r\n\t  File \"c:\\program files\\python37\\lib\\site-packages\\twisted\\internet\\base.py\", line 902, in runUntilCurrent\r\n\t    call.func(*call.args, **call.kw)\r\n\t  File \"c:\\program files\\python37\\lib\\site-packages\\twisted\\internet\\task.py\", line 239, in __call__\r\n\t    d = defer.maybeDeferred(self.f, *self.a, **self.kw)\r\n\t--- <exception caught here> ---\r\n\t  File \"c:\\program files\\python37\\lib\\site-packages\\twisted\\internet\\defer.py\", line 151, in maybeDeferred\r\n\t    result = f(*args, **kw)\r\n\t  File \"c:\\program files\\python37\\lib\\site-packages\\buildbot_worker\\runprocess.py\", line 166, in poll\r\n\t    self.command.addLogfile(self.name, data)\r\n\t  File \"c:\\program files\\python37\\lib\\site-packages\\buildbot_worker\\runprocess.py\", line 773, in addLogfile\r\n\t    self._addToBuffers(('log', name), data)\r\n\t  File \"c:\\program files\\python37\\lib\\site-packages\\buildbot_worker\\runprocess.py\", line 749, in _addToBuffers\r\n\t    self._sendBuffers()\r\n\t  File \"c:\\program files\\python37\\lib\\site-packages\\buildbot_worker\\runprocess.py\", line 731, in _sendBuffers\r\n\t    self._sendMessage(msg)\r\n\t  File \"c:\\program files\\python37\\lib\\site-packages\\buildbot_worker\\runprocess.py\", line 677, in _sendMessage\r\n\t    msg = self._collapseMsg(msg)\r\n\t  File \"c:\\program files\\python37\\lib\\site-packages\\buildbot_worker\\runprocess.py\", line 663, in _collapseMsg\r\n\t    m = bytes2unicode(m, self.builder.unicode_encoding)\r\n\t  File \"c:\\program files\\python37\\lib\\site-packages\\buildbot_worker\\compat.py\", line 87, in bytes2unicode\r\n\t    return text_type(x, encoding, errors)\r\n\tbuiltins.UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 3388: invalid start byte\r\n```\r\n\r\nExample step:\r\n```\r\n\tfactory.addStep(steps.ShellCommand(\r\n\t\tname\t\t\t= \"install_database\",\r\n\t\tdescription\t\t= \"installing database\",\r\n\t\tdescriptionDone\t= \"installed database\",\r\n\t\thaltOnFailure\t= True,\r\n\t\tcommand\t\t\t= [\"python\", \"runInstall.py\", \"--dba\", \"--function=install\", \"--outputDir=./output_install\", \"--logfile=./output_install/runInstall.log\", \"--source=.\", \"--server=\" + oracleServer, \"--user=\" + ORACLE_USERNAME, \"--password=\" + ORACLE_PASSWORD, \"--sysPassword=\" + ORACLE_SYS_PASSWORD, \"--noStoreLog\", \"--noFtpUpload\", \"--client=!!!\", \"--language=001\", \"--noConfirm\", \"--noShowProgress\", \"--installTest\"],\r\n\t\tlogfiles\t\t= {\"installDatabase\": \"./output_install/runInstall.log\"},\r\n\t\tworkdir\t\t\t= \"build/LJS_DB/Install\",\r\n\t\tdecodeRC\t\t= {\r\n\t\t\t0: util.SUCCESS,\r\n\t\t\t1: util.WARNINGS\r\n\t\t}\r\n\t))\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4836/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4836/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4823", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4823/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4823/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4823/events", "html_url": "https://github.com/buildbot/buildbot/issues/4823", "id": 454221013, "node_id": "MDU6SXNzdWU0NTQyMjEwMTM=", "number": 4823, "title": "Accidental multiple starts of force build", "user": {"login": "vibbo", "id": 44985186, "node_id": "MDQ6VXNlcjQ0OTg1MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/44985186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vibbo", "html_url": "https://github.com/vibbo", "followers_url": "https://api.github.com/users/vibbo/followers", "following_url": "https://api.github.com/users/vibbo/following{/other_user}", "gists_url": "https://api.github.com/users/vibbo/gists{/gist_id}", "starred_url": "https://api.github.com/users/vibbo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vibbo/subscriptions", "organizations_url": "https://api.github.com/users/vibbo/orgs", "repos_url": "https://api.github.com/users/vibbo/repos", "events_url": "https://api.github.com/users/vibbo/events{/privacy}", "received_events_url": "https://api.github.com/users/vibbo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-06-10T15:12:47Z", "updated_at": "2019-07-08T08:57:34Z", "closed_at": "2019-07-08T08:57:34Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When on slow client or when force scheduler is too slow, force build can be started multiple times by pressing \"Start Build\" button. This consumes unnecessary resources and can be confusing for users as they are notified from multiple builds.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4823/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4823/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4815", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4815/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4815/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4815/events", "html_url": "https://github.com/buildbot/buildbot/issues/4815", "id": 453366456, "node_id": "MDU6SXNzdWU0NTMzNjY0NTY=", "number": 4815, "title": "Cannot connect to SMTP server", "user": {"login": "angeloudy", "id": 1284475, "node_id": "MDQ6VXNlcjEyODQ0NzU=", "avatar_url": "https://avatars.githubusercontent.com/u/1284475?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angeloudy", "html_url": "https://github.com/angeloudy", "followers_url": "https://api.github.com/users/angeloudy/followers", "following_url": "https://api.github.com/users/angeloudy/following{/other_user}", "gists_url": "https://api.github.com/users/angeloudy/gists{/gist_id}", "starred_url": "https://api.github.com/users/angeloudy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angeloudy/subscriptions", "organizations_url": "https://api.github.com/users/angeloudy/orgs", "repos_url": "https://api.github.com/users/angeloudy/repos", "events_url": "https://api.github.com/users/angeloudy/events{/privacy}", "received_events_url": "https://api.github.com/users/angeloudy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-06-07T06:59:10Z", "updated_at": "2019-06-12T08:23:32Z", "closed_at": "2019-06-12T08:23:31Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "My buildbot cannot send email since I upgraded it to 2.3.x\r\n\r\nGetting the following error\r\n```\r\n82412 2019-06-07 16:48:02+1000 [-] sending mail (599 bytes) to ['tao@ish.com.au']\r\n82413 2019-06-07 16:48:02+1000 [-] Starting factory <twisted.mail.smtp.ESMTPSenderFactory object at 0x811c7f4a8>\r\n82414 2019-06-07 16:48:02+1000 [ESMTPSender,client] SMTP Client retrying server. Retry: 5\r\n82415 2019-06-07 16:48:02+1000 [ESMTPSender,client] SMTP Client retrying server. Retry: 4\r\n82416 2019-06-07 16:48:02+1000 [ESMTPSender,client] SMTP Client retrying server. Retry: 3\r\n82417 2019-06-07 16:48:02+1000 [ESMTPSender,client] SMTP Client retrying server. Retry: 2\r\n82418 2019-06-07 16:48:02+1000 [ESMTPSender,client] SMTP Client retrying server. Retry: 1\r\n82419 2019-06-07 16:48:02+1000 [-] Stopping factory <twisted.mail.smtp.ESMTPSenderFactory object at 0x811c7f4a8>\r\n82420 2019-06-07 16:48:02+1000 [-] Unhandled error in Deferred:\r\n82421 2019-06-07 16:48:02+1000 [-] Unhandled Error\r\n82422     Traceback (most recent call last):\r\n82423     --- <exception caught here> ---\r\n82424       File \"/usr/local/lib/python3.6/site-packages/buildbot/reporters/notifier.py\", line 280, in buildMessage\r\n82425         list(users), patches, logs)\r\n82426       File \"/usr/local/lib/python3.6/site-packages/buildbot/reporters/mail.py\", line 268, in sendMessage\r\n82427         yield self.sendMail(m, all_recipients)\r\n82428     twisted.mail._except.SMTPConnectError: Unable to connect to server.\r\n82429\r\n```\r\nMy twisted installation is `twisted-18.9.0_1`\r\n\r\nIs there a way I can debug into this?\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4815/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4815/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4809", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4809/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4809/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4809/events", "html_url": "https://github.com/buildbot/buildbot/issues/4809", "id": 452422219, "node_id": "MDU6SXNzdWU0NTI0MjIyMTk=", "number": 4809, "title": "GitPoller only triggers on pushes with no commits when the new revision is the tip of another branch", "user": {"login": "adbull", "id": 7279321, "node_id": "MDQ6VXNlcjcyNzkzMjE=", "avatar_url": "https://avatars.githubusercontent.com/u/7279321?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adbull", "html_url": "https://github.com/adbull", "followers_url": "https://api.github.com/users/adbull/followers", "following_url": "https://api.github.com/users/adbull/following{/other_user}", "gists_url": "https://api.github.com/users/adbull/gists{/gist_id}", "starred_url": "https://api.github.com/users/adbull/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adbull/subscriptions", "organizations_url": "https://api.github.com/users/adbull/orgs", "repos_url": "https://api.github.com/users/adbull/repos", "events_url": "https://api.github.com/users/adbull/events{/privacy}", "received_events_url": "https://api.github.com/users/adbull/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-06-05T10:16:19Z", "updated_at": "2021-07-11T13:40:45Z", "closed_at": "2021-07-11T13:40:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "Configure buildbot with `GitPoller(buildPushesWithNoCommits=True)` to monitor branches A and B of a git repo. Push commits 1 and 2 to branch A. Then make B point to commit 1, and push.\r\n\r\nThis should trigger the poller, as it's a new push (despite having no new commits). However, it won't, because the logic in `GitPoller._process_changes` only triggers when the new revision is the tip of another branch.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4809/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4809/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4801", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4801/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4801/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4801/events", "html_url": "https://github.com/buildbot/buildbot/issues/4801", "id": 450155275, "node_id": "MDU6SXNzdWU0NTAxNTUyNzU=", "number": 4801, "title": "Grid view tag filtering bug", "user": {"login": "ImRajdeepB", "id": 30660439, "node_id": "MDQ6VXNlcjMwNjYwNDM5", "avatar_url": "https://avatars.githubusercontent.com/u/30660439?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ImRajdeepB", "html_url": "https://github.com/ImRajdeepB", "followers_url": "https://api.github.com/users/ImRajdeepB/followers", "following_url": "https://api.github.com/users/ImRajdeepB/following{/other_user}", "gists_url": "https://api.github.com/users/ImRajdeepB/gists{/gist_id}", "starred_url": "https://api.github.com/users/ImRajdeepB/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ImRajdeepB/subscriptions", "organizations_url": "https://api.github.com/users/ImRajdeepB/orgs", "repos_url": "https://api.github.com/users/ImRajdeepB/repos", "events_url": "https://api.github.com/users/ImRajdeepB/events{/privacy}", "received_events_url": "https://api.github.com/users/ImRajdeepB/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557399128, "node_id": "MDU6TGFiZWw1NTczOTkxMjg=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/web%20UI", "name": "web UI", "color": "bfd4f2", "default": false, "description": null}, {"id": 1445494760, "node_id": "MDU6TGFiZWwxNDQ1NDk0NzYw", "url": "https://api.github.com/repos/buildbot/buildbot/labels/gsoc2019", "name": "gsoc2019", "color": "bfd4f2", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-05-30T06:39:30Z", "updated_at": "2019-10-17T11:09:02Z", "closed_at": "2019-10-17T11:09:02Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "Builders with selected tags are highlighted, but all the builders are displayed on the grid.\r\n\r\n```\r\nError: \"branch\" is read-only\r\nrefresh@http://localhost:8010/grid_view/scripts.js:676:5\r\ntoggleTag@http://localhost:8010/grid_view/scripts.js:667:17\r\nfn@http://localhost:8010/scripts.js?_1559194180589 line 40425 > Function:4:346\r\nexpensiveCheckFn@http://localhost:8010/scripts.js?_1559194180589:41438:18\r\ncallback@http://localhost:8010/scripts.js?_1559194180589:50965:17\r\n$eval@http://localhost:8010/scripts.js?_1559194180589:43182:28\r\n$apply@http://localhost:8010/scripts.js?_1559194180589:43282:25\r\nngEventHandler/<@http://localhost:8010/scripts.js?_1559194180589:50970:23\r\ndispatch@http://localhost:8010/scripts.js?_1559194180589:149296:27\r\nadd/elemData.handle@http://localhost:8010/scripts.js?_1559194180589:149103:28\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4801/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4801/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4799", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4799/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4799/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4799/events", "html_url": "https://github.com/buildbot/buildbot/issues/4799", "id": 449923908, "node_id": "MDU6SXNzdWU0NDk5MjM5MDg=", "number": 4799, "title": "Always getting \"WARNING: reconfig partially applied; master may malfunction\"?", "user": {"login": "dankegel", "id": 170976, "node_id": "MDQ6VXNlcjE3MDk3Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/170976?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dankegel", "html_url": "https://github.com/dankegel", "followers_url": "https://api.github.com/users/dankegel/followers", "following_url": "https://api.github.com/users/dankegel/following{/other_user}", "gists_url": "https://api.github.com/users/dankegel/gists{/gist_id}", "starred_url": "https://api.github.com/users/dankegel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dankegel/subscriptions", "organizations_url": "https://api.github.com/users/dankegel/orgs", "repos_url": "https://api.github.com/users/dankegel/repos", "events_url": "https://api.github.com/users/dankegel/events{/privacy}", "received_events_url": "https://api.github.com/users/dankegel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-05-29T17:09:22Z", "updated_at": "2021-03-18T21:00:28Z", "closed_at": "2021-03-18T21:00:28Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "My master doesn't seem to like reconfiguration, so I've been shutting down and restarting instead.  I'm running v2.2.0-133-g5711c7b4d built from source.  (That's April 26, so it's about five weeks old.  Maybe I should update to v2.3.1, but it's not clear from the commit log it'd help.)\r\n\r\nWhen I send it a SIGHUP, I see: \r\n```\r\n2019-04-27 21:49:53-0700 [-] reconfig is ongoing for 50 s\r\n2019-04-27 21:50:00-0700 [-] initializing www plugin 'waterfall_view'\r\n2019-04-27 21:50:00-0700 [-] initializing www plugin 'console_view'\r\n2019-04-27 21:50:00-0700 [-] initializing www plugin 'grid_view'\r\n2019-04-27 21:50:00-0700 [Broker,22,10.10.130.255] during reconfig:\r\n        Traceback (most recent call last):\r\n          File \"/home/buildbot/.local/lib/python3.6/site-packages/twisted/internet/defer.py\", line 654, in _runCallbacks\r\n            current.result = callback(current.result, *args, **kw)\r\n          File \"/home/buildbot/.local/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1475, in gotResult\r\n            _inlineCallbacks(r, g, status)\r\n          File \"/home/buildbot/.local/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\n            result = result.throwExceptionIntoGenerator(g)\r\n          File \"/home/buildbot/.local/lib/python3.6/site-packages/twisted/python/failure.py\", line 512, in throwExceptionIntoGenerator\r\n            return g.throw(self.type, self.value, self.tb)\r\n        --- <exception caught here> ---\r\n          File \"/home/buildbot/src/buildbot/master/buildbot/master.py\", line 397, in doReconfig\r\n            yield self.reconfigServiceWithBuildbotConfig(new_config)\r\n          File \"/home/buildbot/.local/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\n            result = result.throwExceptionIntoGenerator(g)\r\n          File \"/home/buildbot/.local/lib/python3.6/site-packages/twisted/python/failure.py\", line 512, in throwExceptionIntoGenerator\r\n            return g.throw(self.type, self.value, self.tb)\r\n          File \"/home/buildbot/src/buildbot/master/buildbot/util/service.py\", line 49, in reconfigServiceWithBuildbotConfig\r\n            yield svc.reconfigServiceWithBuildbotConfig(new_config)\r\n          File \"/home/buildbot/.local/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\n            result = result.throwExceptionIntoGenerator(g)\r\n          File \"/home/buildbot/.local/lib/python3.6/site-packages/twisted/python/failure.py\", line 512, in throwExceptionIntoGenerator\r\n            return g.throw(self.type, self.value, self.tb)\r\n          File \"/home/buildbot/src/buildbot/master/buildbot/process/measured_service.py\", line 31, in reconfigServiceWithBuildbotConfig\r\n            yield super(MeasuredBuildbotServiceManager, self).reconfigServiceWithBuildbotConfig(new_config)\r\n          File \"/home/buildbot/.local/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\n            result = result.throwExceptionIntoGenerator(g)\r\n          File \"/home/buildbot/.local/lib/python3.6/site-packages/twisted/python/failure.py\", line 512, in throwExceptionIntoGenerator\r\n            return g.throw(self.type, self.value, self.tb)\r\n          File \"/home/buildbot/src/buildbot/master/buildbot/util/service.py\", line 520, in reconfigServiceWithBuildbotConfig\r\n            yield svc.reconfigServiceWithSibling(config_sibling)\r\n          File \"/home/buildbot/.local/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\n            result = result.throwExceptionIntoGenerator(g)\r\n          File \"/home/buildbot/.local/lib/python3.6/site-packages/twisted/python/failure.py\", line 512, in throwExceptionIntoGenerator\r\n            return g.throw(self.type, self.value, self.tb)\r\n          File \"/home/buildbot/src/buildbot/master/buildbot/worker/base.py\", line 331, in reconfigServiceWithSibling\r\n            yield self.updateWorker()\r\n          File \"/home/buildbot/.local/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1418, in _inlineCallbacks\r\n            result = g.send(result)\r\n          File \"/home/buildbot/src/buildbot/master/buildbot/worker/base.py\", line 538, in sendBuilderList\r\n            d1 = self.attachBuilder(b)\r\n          File \"/home/buildbot/src/buildbot/master/buildbot/worker/base.py\", line 543, in attachBuilder\r\n            return builder.attached(self, self.worker_commands)\r\n          File \"/home/buildbot/.local/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1613, in unwindGenerator\r\n            return _cancellableInlineCallbacks(gen)\r\n          File \"/home/buildbot/.local/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1529, in _cancellableInlineCallbacks\r\n            _inlineCallbacks(None, g, status)\r\n          File \"/home/buildbot/.local/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1421, in _inlineCallbacks\r\n            status.deferred.callback(getattr(e, \"value\", None))\r\n          File \"/home/buildbot/.local/lib/python3.6/site-packages/twisted/internet/defer.py\", line 459, in callback\r\n            assert not isinstance(result, Deferred)\r\n        builtins.AssertionError:\r\n\r\n2019-04-27 21:50:00-0700 [Broker,22,10.10.130.255] WARNING: reconfig partially applied; master may malfunction\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4799/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4799/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4773", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4773/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4773/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4773/events", "html_url": "https://github.com/buildbot/buildbot/issues/4773", "id": 445789271, "node_id": "MDU6SXNzdWU0NDU3ODkyNzE=", "number": 4773, "title": "assertion when triggering sub build from try build", "user": {"login": "hurricanechristian", "id": 35347397, "node_id": "MDQ6VXNlcjM1MzQ3Mzk3", "avatar_url": "https://avatars.githubusercontent.com/u/35347397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hurricanechristian", "html_url": "https://github.com/hurricanechristian", "followers_url": "https://api.github.com/users/hurricanechristian/followers", "following_url": "https://api.github.com/users/hurricanechristian/following{/other_user}", "gists_url": "https://api.github.com/users/hurricanechristian/gists{/gist_id}", "starred_url": "https://api.github.com/users/hurricanechristian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hurricanechristian/subscriptions", "organizations_url": "https://api.github.com/users/hurricanechristian/orgs", "repos_url": "https://api.github.com/users/hurricanechristian/repos", "events_url": "https://api.github.com/users/hurricanechristian/events{/privacy}", "received_events_url": "https://api.github.com/users/hurricanechristian/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-05-19T07:25:25Z", "updated_at": "2021-03-03T23:27:28Z", "closed_at": "2021-03-01T20:32:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI've been playing with try builds, and want to get a patch passed down to sub builds the build  jobs have the source layed out in the same way and they can trigger fine if I set `alwaysUseLatest=True,` but I want to pass the patch down. I get the following crash each time I remove that setting.\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib64/python3.6/site-packages/twisted/internet/defer.py\", line 1418, in _inlineCallbacks\r\n    result = g.send(result)\r\n  File \"/usr/local/lib/python3.6/site-packages/buildbot/process/buildstep.py\", line 566, in startStep\r\n    self.results = yield self.run()\r\n  File \"/usr/local/lib64/python3.6/site-packages/twisted/internet/defer.py\", line 1613, in unwindGenerator\r\n    return _cancellableInlineCallbacks(gen)\r\n  File \"/usr/local/lib64/python3.6/site-packages/twisted/internet/defer.py\", line 1529, in _cancellableInlineCallbacks\r\n    _inlineCallbacks(None, g, status)\r\n--- <exception caught here> ---\r\n  File \"/usr/local/lib/python3.6/site-packages/buildbot/process/buildstep.py\", line 566, in startStep\r\n    self.results = yield self.run()\r\n  File \"/usr/local/lib64/python3.6/site-packages/twisted/internet/defer.py\", line 1418, in _inlineCallbacks\r\n    result = g.send(result)\r\n  File \"/usr/local/lib/python3.6/site-packages/buildbot/steps/trigger.py\", line 258, in run\r\n    ss_for_trigger = self.prepareSourcestampListForTrigger()\r\n  File \"/usr/local/lib/python3.6/site-packages/buildbot/steps/trigger.py\", line 167, in prepareSourcestampListForTrigger\r\n    ss_for_trigger[ss.codebase] = ss.asDict()\r\n  File \"/usr/local/lib/python3.6/site-packages/buildbot/process/buildrequest.py\", line 137, in asDict\r\n    ), result\r\nbuiltins.AssertionError: {'branch': 'foo', 'revision': None, 'repository': 'code', 'project': '', 'codebase': '', 'patch_level': 0, 'patch_body': b'Index: MyPatch...', 'patch_subdir': '', 'patch_author': 'me', 'patch_comment': '\"trigger build (by me)\"'}\r\n\r\nHowever if I move the step out of the config and into the try scheduler, it triggers both. But I want to be able to link the two together - is this a bug, or am I doing something wrong? Do I need to define a codebase?\r\n\r\nThanks", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4773/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4773/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4757", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4757/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4757/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4757/events", "html_url": "https://github.com/buildbot/buildbot/issues/4757", "id": 441174845, "node_id": "MDU6SXNzdWU0NDExNzQ4NDU=", "number": 4757, "title": "Exceptions when adding new workers to builder using sighup; -> worker does not get jobs from builder", "user": {"login": "YngveNPettersen", "id": 3061808, "node_id": "MDQ6VXNlcjMwNjE4MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/3061808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/YngveNPettersen", "html_url": "https://github.com/YngveNPettersen", "followers_url": "https://api.github.com/users/YngveNPettersen/followers", "following_url": "https://api.github.com/users/YngveNPettersen/following{/other_user}", "gists_url": "https://api.github.com/users/YngveNPettersen/gists{/gist_id}", "starred_url": "https://api.github.com/users/YngveNPettersen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/YngveNPettersen/subscriptions", "organizations_url": "https://api.github.com/users/YngveNPettersen/orgs", "repos_url": "https://api.github.com/users/YngveNPettersen/repos", "events_url": "https://api.github.com/users/YngveNPettersen/events{/privacy}", "received_events_url": "https://api.github.com/users/YngveNPettersen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-05-07T11:15:11Z", "updated_at": "2019-10-06T14:04:01Z", "closed_at": "2019-10-06T14:04:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "Buildbot 2.2.0\r\n\r\nI added new workers to some of our builders. The builders were already active in the system and used for other builders. They were added to the new builders due a short term need for more workers for those builders, and doing a full restart for the master is out of the question in this scenario.\r\n\r\nWhen running sighup, I frequently got the exception below for various builders\r\n\r\nWhen the sighup operation did succeed, only one of the three workers accepted scheduled builds from the builder they had been added to; and that was AFAICT a build on the builder that did not trigger any exceptions. I tried removing one of the workers from the builder, sighup, readding it, and sighup; got exceptions, then succeeded, but builds does not start.\r\n\r\nPlease note that this is not the first case we have had of exceptions breaking stuff during sighup, see https://github.com/buildbot/buildbot/issues/4673 and https://github.com/buildbot/buildbot/issues/4715 for the others.\r\n\r\n```\r\n2019-05-07 10:51:03+0000 [Broker (TLSMemoryBIOProtocol),19,1.2.3.4] during reconfig:\r\n        Traceback (most recent call last):\r\n          File \"sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 654, in _runCallbacks\r\n            current.result = callback(current.result, *args, **kw)\r\n          File \"sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1475, in gotResult\r\n            _inlineCallbacks(r, g, status)\r\n          File \"sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\n            result = result.throwExceptionIntoGenerator(g)\r\n          File \"sandbox/lib/python3.6/site-packages/twisted/python/failure.py\", line 491, in throwExceptionIntoGenerator\r\n            return g.throw(self.type, self.value, self.tb)\r\n        --- <exception caught here> ---\r\n          File \"sandbox/lib/python3.6/site-packages/buildbot/master.py\", line 393, in doReconfig\r\n            yield self.reconfigServiceWithBuildbotConfig(new_config)\r\n          File \"sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\n            result = result.throwExceptionIntoGenerator(g)\r\n          File \"sandbox/lib/python3.6/site-packages/twisted/python/failure.py\", line 491, in throwExceptionIntoGenerator\r\n            return g.throw(self.type, self.value, self.tb)\r\n          File \"sandbox/lib/python3.6/site-packages/buildbot/util/service.py\", line 49, in reconfigServiceWithBuildbotConfig\r\n            yield svc.reconfigServiceWithBuildbotConfig(new_config)\r\n          File \"sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\n            result = result.throwExceptionIntoGenerator(g)\r\n          File \"sandbox/lib/python3.6/site-packages/twisted/python/failure.py\", line 491, in throwExceptionIntoGenerator\r\n            return g.throw(self.type, self.value, self.tb)\r\n          File \"sandbox/lib/python3.6/site-packages/buildbot/process/measured_service.py\", line 31, in reconfigServiceWithBuildbotConfig\r\n            yield super(MeasuredBuildbotServiceManager, self).reconfigServiceWithBuildbotConfig(new_config)\r\n          File \"sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\n            result = result.throwExceptionIntoGenerator(g)\r\n          File \"sandbox/lib/python3.6/site-packages/twisted/python/failure.py\", line 491, in throwExceptionIntoGenerator\r\n            return g.throw(self.type, self.value, self.tb)\r\n          File \"sandbox/lib/python3.6/site-packages/buildbot/util/service.py\", line 520, in reconfigServiceWithBuildbotConfig\r\n            yield svc.reconfigServiceWithSibling(config_sibling)\r\n          File \"sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1416, in _inlineCallbacks\r\n            result = result.throwExceptionIntoGenerator(g)\r\n          File \"sandbox/lib/python3.6/site-packages/twisted/python/failure.py\", line 491, in throwExceptionIntoGenerator\r\n            return g.throw(self.type, self.value, self.tb)\r\n          File \"sandbox/lib/python3.6/site-packages/buildbot/worker/base.py\", line 302, in reconfigServiceWithSibling\r\n            yield self.updateWorker()\r\n          File \"sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1418, in _inlineCallbacks\r\n            result = g.send(result)\r\n          File \"sandbox/lib/python3.6/site-packages/buildbot/worker/base.py\", line 509, in sendBuilderList\r\n            d1 = self.attachBuilder(b)\r\n          File \"sandbox/lib/python3.6/site-packages/buildbot/worker/base.py\", line 514, in attachBuilder\r\n            return builder.attached(self, self.worker_commands)\r\n          File \"sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1613, in unwindGenerator\r\n            return _cancellableInlineCallbacks(gen)\r\n          File \"sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1529, in _cancellableInlineCallbacks\r\n            _inlineCallbacks(None, g, status)\r\n          File \"sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1421, in _inlineCallbacks\r\n            status.deferred.callback(getattr(e, \"value\", None))\r\n          File \"sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 459, in callback\r\n            assert not isinstance(result, Deferred)\r\n        builtins.AssertionError:\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4757/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4757/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4746", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4746/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4746/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4746/events", "html_url": "https://github.com/buildbot/buildbot/issues/4746", "id": 439397431, "node_id": "MDU6SXNzdWU0MzkzOTc0MzE=", "number": 4746, "title": "buildbot try (try_vc=git) fails with \"Data must not be unicode\"", "user": {"login": "yhager", "id": 65973, "node_id": "MDQ6VXNlcjY1OTcz", "avatar_url": "https://avatars.githubusercontent.com/u/65973?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yhager", "html_url": "https://github.com/yhager", "followers_url": "https://api.github.com/users/yhager/followers", "following_url": "https://api.github.com/users/yhager/following{/other_user}", "gists_url": "https://api.github.com/users/yhager/gists{/gist_id}", "starred_url": "https://api.github.com/users/yhager/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yhager/subscriptions", "organizations_url": "https://api.github.com/users/yhager/orgs", "repos_url": "https://api.github.com/users/yhager/repos", "events_url": "https://api.github.com/users/yhager/events{/privacy}", "received_events_url": "https://api.github.com/users/yhager/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 632499035, "node_id": "MDU6TGFiZWw2MzI0OTkwMzU=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bytes", "name": "bytes", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-05-02T01:30:00Z", "updated_at": "2019-07-09T18:20:15Z", "closed_at": "2019-07-09T18:20:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "Running a command like `buildbot try -w me -b <builder>` results in a stack trace before even connecting to the master:\r\n```\r\nusing 'ssh' connect method\r\njob created\r\nUnhandled Error\r\nTraceback (most recent call last):\r\n  File \"/home/yuval/.virtualenv/buildbot/lib/python3.7/site-packages/twisted/internet/defer.py\", line 654, in _runCallbacks\r\n    current.result = callback(current.result, *args, **kw)\r\n  File \"/home/yuval/.virtualenv/buildbot/lib/python3.7/site-packages/buildbot/clients/tryclient.py\", line 907, in <lambda>\r\n    d.addCallback(lambda res: deliver())\r\n  File \"/home/yuval/.virtualenv/buildbot/lib/python3.7/site-packages/buildbot/clients/tryclient.py\", line 669, in deliverJob\r\n    reactor.spawnProcess(pp, argv[0], argv, os.environ)\r\n  File \"/home/yuval/.virtualenv/buildbot/lib/python3.7/site-packages/twisted/internet/posixbase.py\", line 340, in spawnProcess\r\n    processProtocol, uid, gid, childFDs)\r\n--- <exception caught here> ---\r\n  File \"/home/yuval/.virtualenv/buildbot/lib/python3.7/site-packages/twisted/internet/process.py\", line 770, in __init__\r\n    self.proto.makeConnection(self)\r\n  File \"/home/yuval/.virtualenv/buildbot/lib/python3.7/site-packages/twisted/internet/protocol.py\", line 514, in makeConnection\r\n    self.connectionMade()\r\n  File \"/home/yuval/.virtualenv/buildbot/lib/python3.7/site-packages/buildbot/clients/tryclient.py\", line 512, in connectionMade\r\n    self.transport.write(self.job)\r\n  File \"/home/yuval/.virtualenv/buildbot/lib/python3.7/site-packages/twisted/internet/process.py\", line 927, in write\r\n    self.pipes[0].write(data)\r\n  File \"/home/yuval/.virtualenv/buildbot/lib/python3.7/site-packages/twisted/internet/process.py\", line 203, in write\r\n    abstract.FileDescriptor.write(self, data)\r\n  File \"/home/yuval/.virtualenv/buildbot/lib/python3.7/site-packages/twisted/internet/abstract.py\", line 349, in write\r\n    raise TypeError(\"Data must not be unicode\")\r\nbuiltins.TypeError: Data must not be unicode\r\n```\r\n\r\nThe patch is very simple:\r\n```\r\ndiff --git a/myproject/version.py b/myproject/version.py\r\nindex 68d7165..61ad8a0 100644\r\n--- a/myproject/version.py\r\n+++ b/myproject/version.py\r\n@@ -1,4 +1,4 @@\r\n-__version__ = '1.0.0.19'\r\n+__version__ = '1.0.0.20'\r\n __describe__ = ''\r\n __revision__ = ''\r\n __build_type__ = 'RelWithDebInfo'\r\n```\r\n\r\nbuildbot version 2.2.0, twisted version 19.2.0", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4746/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4746/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4745", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4745/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4745/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4745/events", "html_url": "https://github.com/buildbot/buildbot/issues/4745", "id": 439396385, "node_id": "MDU6SXNzdWU0MzkzOTYzODU=", "number": 4745, "title": "Don't timeout during clone / checkout", "user": {"login": "mojca", "id": 15606, "node_id": "MDQ6VXNlcjE1NjA2", "avatar_url": "https://avatars.githubusercontent.com/u/15606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mojca", "html_url": "https://github.com/mojca", "followers_url": "https://api.github.com/users/mojca/followers", "following_url": "https://api.github.com/users/mojca/following{/other_user}", "gists_url": "https://api.github.com/users/mojca/gists{/gist_id}", "starred_url": "https://api.github.com/users/mojca/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mojca/subscriptions", "organizations_url": "https://api.github.com/users/mojca/orgs", "repos_url": "https://api.github.com/users/mojca/repos", "events_url": "https://api.github.com/users/mojca/events{/privacy}", "received_events_url": "https://api.github.com/users/mojca/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "ImRajdeepB", "id": 30660439, "node_id": "MDQ6VXNlcjMwNjYwNDM5", "avatar_url": "https://avatars.githubusercontent.com/u/30660439?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ImRajdeepB", "html_url": "https://github.com/ImRajdeepB", "followers_url": "https://api.github.com/users/ImRajdeepB/followers", "following_url": "https://api.github.com/users/ImRajdeepB/following{/other_user}", "gists_url": "https://api.github.com/users/ImRajdeepB/gists{/gist_id}", "starred_url": "https://api.github.com/users/ImRajdeepB/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ImRajdeepB/subscriptions", "organizations_url": "https://api.github.com/users/ImRajdeepB/orgs", "repos_url": "https://api.github.com/users/ImRajdeepB/repos", "events_url": "https://api.github.com/users/ImRajdeepB/events{/privacy}", "received_events_url": "https://api.github.com/users/ImRajdeepB/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ImRajdeepB", "id": 30660439, "node_id": "MDQ6VXNlcjMwNjYwNDM5", "avatar_url": "https://avatars.githubusercontent.com/u/30660439?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ImRajdeepB", "html_url": "https://github.com/ImRajdeepB", "followers_url": "https://api.github.com/users/ImRajdeepB/followers", "following_url": "https://api.github.com/users/ImRajdeepB/following{/other_user}", "gists_url": "https://api.github.com/users/ImRajdeepB/gists{/gist_id}", "starred_url": "https://api.github.com/users/ImRajdeepB/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ImRajdeepB/subscriptions", "organizations_url": "https://api.github.com/users/ImRajdeepB/orgs", "repos_url": "https://api.github.com/users/ImRajdeepB/repos", "events_url": "https://api.github.com/users/ImRajdeepB/events{/privacy}", "received_events_url": "https://api.github.com/users/ImRajdeepB/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-05-02T01:22:36Z", "updated_at": "2019-09-30T07:38:34Z", "closed_at": "2019-09-30T07:38:34Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "During `git clone` buildbot (2.2) seems to supress all output. A big disadvantage is that it can no longer differentiate between situation when git (or another VCS) is still happily doing its job and situations when something actually hanged. If the command kept outputting something, buildbot wouldn't need to time out.\r\n\r\nIn my case I wanted to fetch https://github.com/tex-live/luatex.git which is apparently more than 1 GB during checkout.\r\n\r\nNote that also #3281 is true for me, but it's orthogonal and I'm actually glad that this other ticket was not addressed at this very moment. I figured out that I had 16 instances of `git` running, all started by buildbot in the last two hours. The internet connection where I'm now is horrible, so I was glad that those thousand megabytes kept being fetched after the timeout occured :) :) :) Of course, it would be nice to fix both.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4745/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4745/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4744", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4744/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4744/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4744/events", "html_url": "https://github.com/buildbot/buildbot/issues/4744", "id": 439103766, "node_id": "MDU6SXNzdWU0MzkxMDM3NjY=", "number": 4744, "title": "UnicodeDecodeError in addLogfile (python 3.7.3 worker)", "user": {"login": "vbraun", "id": 888729, "node_id": "MDQ6VXNlcjg4ODcyOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/888729?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vbraun", "html_url": "https://github.com/vbraun", "followers_url": "https://api.github.com/users/vbraun/followers", "following_url": "https://api.github.com/users/vbraun/following{/other_user}", "gists_url": "https://api.github.com/users/vbraun/gists{/gist_id}", "starred_url": "https://api.github.com/users/vbraun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vbraun/subscriptions", "organizations_url": "https://api.github.com/users/vbraun/orgs", "repos_url": "https://api.github.com/users/vbraun/repos", "events_url": "https://api.github.com/users/vbraun/events{/privacy}", "received_events_url": "https://api.github.com/users/vbraun/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 632499035, "node_id": "MDU6TGFiZWw2MzI0OTkwMzU=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bytes", "name": "bytes", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-05-01T08:46:52Z", "updated_at": "2019-06-16T12:02:20Z", "closed_at": "2019-06-16T12:02:19Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "One buildbot worker now dies in the middle of a build:\r\n~~~~\r\n2019-05-01 09:14:22+0200 [-] unexpected error in processEnded\r\n\tTraceback (most recent call last):\r\n\t  File \"/usr/lib64/python3.7/site-packages/twisted/internet/process.py\", line 985, in maybeCallProcessEnded\r\n\t    self.reapProcess()\r\n\t  File \"/usr/lib64/python3.7/site-packages/twisted/internet/process.py\", line 350, in reapProcess\r\n\t    self.processEnded(status)\r\n\t  File \"/usr/lib64/python3.7/site-packages/twisted/internet/_baseprocess.py\", line 52, in processEnded\r\n\t    self.maybeCallProcessEnded()\r\n\t  File \"/usr/lib64/python3.7/site-packages/twisted/internet/process.py\", line 987, in maybeCallProcessEnded\r\n\t    _BaseProcess.maybeCallProcessEnded(self)\r\n\t--- <exception caught here> ---\r\n\t  File \"/usr/lib64/python3.7/site-packages/twisted/internet/_baseprocess.py\", line 64, in maybeCallProcessEnded\r\n\t    proto.processEnded(Failure(reason))\r\n\t  File \"/usr/lib/python3.7/site-packages/buildbot_worker/runprocess.py\", line 252, in processEnded\r\n\t    self.command.finished(sig, rc)\r\n\t  File \"/usr/lib/python3.7/site-packages/buildbot_worker/runprocess.py\", line 784, in finished\r\n\t    w.stop()\r\n\t  File \"/usr/lib/python3.7/site-packages/buildbot_worker/runprocess.py\", line 131, in stop\r\n\t    self.poll()\r\n\t  File \"/usr/lib/python3.7/site-packages/buildbot_worker/runprocess.py\", line 166, in poll\r\n\t    self.command.addLogfile(self.name, data)\r\n\t  File \"/usr/lib/python3.7/site-packages/buildbot_worker/runprocess.py\", line 773, in addLogfile\r\n\t    self._addToBuffers(('log', name), data)\r\n\t  File \"/usr/lib/python3.7/site-packages/buildbot_worker/runprocess.py\", line 749, in _addToBuffers\r\n\t    self._sendBuffers()\r\n\t  File \"/usr/lib/python3.7/site-packages/buildbot_worker/runprocess.py\", line 731, in _sendBuffers\r\n\t    self._sendMessage(msg)\r\n\t  File \"/usr/lib/python3.7/site-packages/buildbot_worker/runprocess.py\", line 677, in _sendMessage\r\n\t    msg = self._collapseMsg(msg)\r\n\t  File \"/usr/lib/python3.7/site-packages/buildbot_worker/runprocess.py\", line 663, in _collapseMsg\r\n\t    m = bytes2unicode(m, self.builder.unicode_encoding)\r\n\t  File \"/usr/lib/python3.7/site-packages/buildbot_worker/compat.py\", line 87, in bytes2unicode\r\n\t    return text_type(x, encoding, errors)\r\n\tbuiltins.UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 9872: invalid start byte\r\n~~~~\r\nThe worker is fedora's buildbot-1.8.1 (python 3):\r\n~~~~\r\n[buildslave-sage@volker ~]$ rpm -qa | grep -i buildbot\r\nbuildbot-www-1.8.1-1.fc29.noarch\r\nbuildbot-master-1.8.1-1.fc29.noarch\r\nbuildbot-1.8.1-1.fc29.noarch\r\nbuildbot-worker-1.8.1-1.fc29.noarch\r\n~~~~\r\nWe do have some older successful builds with buildbot-worker-1.8.1, but python 3.7.3 was installed just after the last successful build", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4744/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4744/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4686", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4686/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4686/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4686/events", "html_url": "https://github.com/buildbot/buildbot/issues/4686", "id": 426394190, "node_id": "MDU6SXNzdWU0MjYzOTQxOTA=", "number": 4686, "title": "Schedulers does not trigger build if a different scheduler of same type triggered for the same commit", "user": {"login": "YngveNPettersen", "id": 3061808, "node_id": "MDQ6VXNlcjMwNjE4MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/3061808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/YngveNPettersen", "html_url": "https://github.com/YngveNPettersen", "followers_url": "https://api.github.com/users/YngveNPettersen/followers", "following_url": "https://api.github.com/users/YngveNPettersen/following{/other_user}", "gists_url": "https://api.github.com/users/YngveNPettersen/gists{/gist_id}", "starred_url": "https://api.github.com/users/YngveNPettersen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/YngveNPettersen/subscriptions", "organizations_url": "https://api.github.com/users/YngveNPettersen/orgs", "repos_url": "https://api.github.com/users/YngveNPettersen/repos", "events_url": "https://api.github.com/users/YngveNPettersen/events{/privacy}", "received_events_url": "https://api.github.com/users/YngveNPettersen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2019-03-28T09:46:00Z", "updated_at": "2021-07-29T00:11:15Z", "closed_at": "2021-07-29T00:11:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "Configuration: v2.0.1\r\n* a GitPoller for the repo URL, and the list of branches\r\n* Each scheduler is initialized with the name of the scheduler, a list of builders, and a ChangeFilter for the branch.\r\n* The schedulers in this case is either a SingleBranchScheduler or a schedulers.Nightly\r\n\r\nWe have a configuration, among other configurations, with two branches that follow the same commits, with one usually being ahead of the other, or they are on the same commit. The branch names are used to differentiate compile time customization.  Each of these branches have two schedulers,   a SingleBranchScheduler and a schedulers.Nightly.\r\n\r\nExpected behavior is that when one of the branches is move to a new commit, new builds are triggered for the relevant branch's new commit.\r\n\r\nActual behavior is that if one of the schedulers of a type have triggered a build for that commit, the other scheduler of the same type, for the other branch, will NOT trigger a build until the branch contains at least one commit that is not yet  part of the first scheduler's branch.\r\n\r\nIt seems like buildbot is triggering builds based of unique groups of (repository, scheduler_kind, commit) rather than the expected (repository, scheduler_name, branch, commit) group.\r\n\r\nThis seems to be a regression compared to the previous Chromium-developed 0.8.4-based buildbot we used before.\r\n\r\nOne possibility that might be useful to investigate is to check which name is used when associating the triggered commits with the scheduler. Is it the master.cfg configured name, or the default name member of the class? Note that the correct name is used in the properties for the triggered build.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4686/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4686/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4673", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4673/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4673/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4673/events", "html_url": "https://github.com/buildbot/buildbot/issues/4673", "id": 424613629, "node_id": "MDU6SXNzdWU0MjQ2MTM2Mjk=", "number": 4673, "title": "Sighup reconfiguration can disable gitpoller database connection", "user": {"login": "YngveNPettersen", "id": 3061808, "node_id": "MDQ6VXNlcjMwNjE4MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/3061808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/YngveNPettersen", "html_url": "https://github.com/YngveNPettersen", "followers_url": "https://api.github.com/users/YngveNPettersen/followers", "following_url": "https://api.github.com/users/YngveNPettersen/following{/other_user}", "gists_url": "https://api.github.com/users/YngveNPettersen/gists{/gist_id}", "starred_url": "https://api.github.com/users/YngveNPettersen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/YngveNPettersen/subscriptions", "organizations_url": "https://api.github.com/users/YngveNPettersen/orgs", "repos_url": "https://api.github.com/users/YngveNPettersen/repos", "events_url": "https://api.github.com/users/YngveNPettersen/events{/privacy}", "received_events_url": "https://api.github.com/users/YngveNPettersen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 653117444, "node_id": "MDU6TGFiZWw2NTMxMTc0NDQ=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/reconfigure", "name": "reconfigure", "color": "c5def5", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2019-03-24T13:32:47Z", "updated_at": "2021-03-18T21:03:15Z", "closed_at": "2021-03-18T21:03:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "We have had several incidents where sighup reconfiguration of the master have caused it to stop handling new commits; IIRC the reconfigurations have involved new branches and schedulers.\r\n\r\nThe pre-condition for the problem seems to be that the polling started or was ongoing at the time the reconfiguration operation was performed.\r\n\r\nThe problem does not seem to affect ongoing or scheduled jobs on the builders and workers, but to get the gitpolling working again a stop/restart operation have to be performed.\r\n\r\n~~There are also an possibility that this problem can cause handling of commits from a branch to become completely broken. Updates to the branch is  registered in git, the scheduler exists, but it does not look like the the changesource is handling the new commits.~~ (Moved to https://github.com/buildbot/buildbot/issues/4686 )\r\n\r\n~~After several attempts involving stop/restart of the master, creation of new branches and schedulers without any luck (although this may have been due to the new changesources not being ready, log information about state of a branch changesource  would be very useful so that we could know *when* the changesource is ready for use; this information would also be even more useful if it was available in the GUI). After these failed attempts I reverted my changes and returned to the old configuration for this branch and its two schedulers. The next day I restarted the master for other reasons, and suddenly the schedulers were finally working as they should.~~\r\n\r\nI have observered a database related exception during these incidents, this is the most recent one, which was likely involved in the above scheduler problem:\r\n\r\n```\r\n2019-03-16 13:02:31+0000 [-] while polling for changes\r\n  Traceback (most recent call last):\r\n    File \"sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1418, in _inlineCallbacks\r\n      result = g.send(result)\r\n    File \"sandbox/lib/python3.6/site-packages/buildbot/changes/gitpoller.py\", line 233, in poll\r\n      yield self.setState('lastRev', self.lastRev)\r\n    File \"sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1613, in unwindGenerator\r\n      return _cancellableInlineCallbacks(gen)\r\n    File \"sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1529, in _cancellableInlineCallbacks\r\n      _inlineCallbacks(None, g, status)\r\n  --- <exception caught here> ---\r\n    File \"sandbox/lib/python3.6/site-packages/buildbot/changes/gitpoller.py\", line 233, in poll\r\n      yield self.setState('lastRev', self.lastRev)\r\n    File \"sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\",\r\nline 1418, in _inlineCallbacks\r\n      result = g.send(result)\r\n    File \"sandbox/lib/python3.6/site-packages/buildbot/util/state.py\", line 43, in setState\r\n      yield self.master.db.state.setState(self._objectid, key, value)\r\n  builtins.AttributeError: 'NoneType' object has no attribute 'db'\r\n \r\n2019-03-16 13:02:31+0000 [-] Caught exception while deactivating ClusteredService(...)\r\n  Traceback (most recent call last):\r\n    File \"sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 654, in _runCallbacks\r\n      current.result = callback(current.result, *args, **kw)\r\n    File \"sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1475, in gotResult\r\n      _inlineCallbacks(r, g, status)\r\n    File \"sandbox/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1418, in _inlineCallbacks\r\n      result = g.send(result)\r\n    File \"sandbox/lib/python3.6/site-packages/buildbot/util/service.py\", line 341, in stopService\r\n      log.err(e, _why=\"Caught exception while deactivating ClusteredService(%s)\" % self.name)\r\n  --- <exception caught here> ---\r\n    File \"sandbox/lib/python3.6/site-packages/buildbot/util/service.py\", line 339, in stopService\r\n      yield self._unclaimService()\r\n    File \"sandbox/lib/python3.6/site-packages/buildbot/changes/base.py\", line 51, in _unclaimService\r\n      return self.master.data.updates.trySetChangeSourceMaster(self.serviceid,\r\n  builtins.AttributeError: 'NoneType' object has no attribute 'data'\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4673/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4673/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4647", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4647/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4647/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4647/events", "html_url": "https://github.com/buildbot/buildbot/issues/4647", "id": 419312881, "node_id": "MDU6SXNzdWU0MTkzMTI4ODE=", "number": 4647, "title": "No Docker image for 2.1.0", "user": {"login": "cjolowicz", "id": 653941, "node_id": "MDQ6VXNlcjY1Mzk0MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/653941?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjolowicz", "html_url": "https://github.com/cjolowicz", "followers_url": "https://api.github.com/users/cjolowicz/followers", "following_url": "https://api.github.com/users/cjolowicz/following{/other_user}", "gists_url": "https://api.github.com/users/cjolowicz/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjolowicz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjolowicz/subscriptions", "organizations_url": "https://api.github.com/users/cjolowicz/orgs", "repos_url": "https://api.github.com/users/cjolowicz/repos", "events_url": "https://api.github.com/users/cjolowicz/events{/privacy}", "received_events_url": "https://api.github.com/users/cjolowicz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-03-11T06:28:54Z", "updated_at": "2021-09-05T03:02:08Z", "closed_at": "2021-09-05T03:02:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "On https://hub.docker.com/r/buildbot/buildbot-master/tags, there is no tag for the current version 2.1.0 (and 2.0.1, for that matter).", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4647/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4647/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4642", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4642/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4642/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4642/events", "html_url": "https://github.com/buildbot/buildbot/issues/4642", "id": 418680566, "node_id": "MDU6SXNzdWU0MTg2ODA1NjY=", "number": 4642, "title": "If two schedulers have same builder and both are triggered, then they cancel each other", "user": {"login": "cmouse", "id": 1204643, "node_id": "MDQ6VXNlcjEyMDQ2NDM=", "avatar_url": "https://avatars.githubusercontent.com/u/1204643?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cmouse", "html_url": "https://github.com/cmouse", "followers_url": "https://api.github.com/users/cmouse/followers", "following_url": "https://api.github.com/users/cmouse/following{/other_user}", "gists_url": "https://api.github.com/users/cmouse/gists{/gist_id}", "starred_url": "https://api.github.com/users/cmouse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cmouse/subscriptions", "organizations_url": "https://api.github.com/users/cmouse/orgs", "repos_url": "https://api.github.com/users/cmouse/repos", "events_url": "https://api.github.com/users/cmouse/events{/privacy}", "received_events_url": "https://api.github.com/users/cmouse/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557428611, "node_id": "MDU6TGFiZWw1NTc0Mjg2MTE=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/scheduler", "name": "scheduler", "color": "bfd4f2", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-03-08T08:18:27Z", "updated_at": "2021-07-29T00:11:15Z", "closed_at": "2021-07-29T00:11:15Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Buildbot version: 2.0.1\r\nTwisted version: 18.9.0\r\n\r\nI have the following configuration\r\n```.py\r\n\r\ndef obox2_repo_filter_fn(repo):\r\n  return re.match(\"git@.*:[^/]*/obox2.git$\", repo)\r\n\r\ndef branch_not_2_x_repo_filter_fn(branch):\r\n  if re.match(\".*-2[.][0-9]$\", branch):\r\n    return False\r\n  return True\r\n\r\nc['schedulers'].append(schedulers.SingleBranchScheduler(\r\n                       name=\"obox2-master\",\r\n                       builderNames=[\"obox2-plugin-ci\",\"obox2-plugin-scanbuild-ci\",\"obox2-plugin-coverage-ci\"],\r\n                       change_filter=util.ChangeFilter(\r\n                         repository='git@git.dovecot.net:dovecot/obox2.git',\r\n                         branch='master'\r\n                       ),\r\n                       treeStableTimer=10,\r\n                       properties = {\r\n                         'docker_image' : 'registry.dovecot.net/dovecot:stretch-worker'\r\n                       }\r\n))\r\nc['schedulers'].append(schedulers.AnyBranchScheduler(\r\n                       name=\"obox2-ci\",\r\n                       builderNames=[\"obox2-plugin-ci\"],\r\n                       change_filter=util.ChangeFilter(\r\n                         repository_fn=obox2_repo_filter_fn,\r\n                         branch_fn=branch_not_2_x_repo_filter_fn\r\n                       ),\r\n                       treeStableTimer=10,\r\n                       properties = {\r\n                         'docker_image' : 'registry.dovecot.net/dovecot:stretch-worker'\r\n                       }\r\n))\r\n```\r\n\r\nWhen I commit changes into dovecot/obox2 master branch, the `obox2-plugin-ci` builder is not triggered, because both schedulers are triggering the same builder. If I change the branch filter to exclude master, then `obox2-plugin-ci` is triggered on master commit.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4642/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4642/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4575", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4575/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4575/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4575/events", "html_url": "https://github.com/buildbot/buildbot/issues/4575", "id": 404876386, "node_id": "MDU6SXNzdWU0MDQ4NzYzODY=", "number": 4575, "title": "Master can't shutdown when worker gets missing without TCP connection being severed", "user": {"login": "p12tic", "id": 1056711, "node_id": "MDQ6VXNlcjEwNTY3MTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1056711?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p12tic", "html_url": "https://github.com/p12tic", "followers_url": "https://api.github.com/users/p12tic/followers", "following_url": "https://api.github.com/users/p12tic/following{/other_user}", "gists_url": "https://api.github.com/users/p12tic/gists{/gist_id}", "starred_url": "https://api.github.com/users/p12tic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p12tic/subscriptions", "organizations_url": "https://api.github.com/users/p12tic/orgs", "repos_url": "https://api.github.com/users/p12tic/repos", "events_url": "https://api.github.com/users/p12tic/events{/privacy}", "received_events_url": "https://api.github.com/users/p12tic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557406037, "node_id": "MDU6TGFiZWw1NTc0MDYwMzc=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/worker", "name": "worker", "color": "bfd4f2", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-01-30T17:17:35Z", "updated_at": "2019-02-01T12:37:34Z", "closed_at": "2019-02-01T12:37:34Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Reproduction steps:\r\n\r\n - Create sample master config with a single worker.\r\n - `buildbot start path/master`\r\n - `buildbot-worker start path/worker`\r\n - `kill -SIGSTOP $(cat path/worker/twistd.pid)`\r\n - start build\r\n - `buildbot stop path/master`\r\n\r\nThe last step will say: `never saw process go away`", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4575/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4575/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4281", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4281/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4281/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4281/events", "html_url": "https://github.com/buildbot/buildbot/issues/4281", "id": 354881937, "node_id": "MDU6SXNzdWUzNTQ4ODE5Mzc=", "number": 4281, "title": "Undocumented required property", "user": {"login": "jugglinmike", "id": 677252, "node_id": "MDQ6VXNlcjY3NzI1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/677252?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jugglinmike", "html_url": "https://github.com/jugglinmike", "followers_url": "https://api.github.com/users/jugglinmike/followers", "following_url": "https://api.github.com/users/jugglinmike/following{/other_user}", "gists_url": "https://api.github.com/users/jugglinmike/gists{/gist_id}", "starred_url": "https://api.github.com/users/jugglinmike/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jugglinmike/subscriptions", "organizations_url": "https://api.github.com/users/jugglinmike/orgs", "repos_url": "https://api.github.com/users/jugglinmike/repos", "events_url": "https://api.github.com/users/jugglinmike/events{/privacy}", "received_events_url": "https://api.github.com/users/jugglinmike/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-08-28T20:01:33Z", "updated_at": "2021-03-01T20:32:08Z", "closed_at": "2021-03-01T20:32:04Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "[The documentation for the Trigger build step](http://docs.buildbot.net/current/manual/cfg-buildsteps.html#buildbot.steps.source.buildbot.steps.trigger.Trigger) describes the `sourceStamps` parameter with the following text:\r\n\r\n> Accepts a list of dictionaries containing the keys `branch`, `revision`, `repository`, `project`, and optionally `patch_level`, `patch_body`, `patch_subdir`, `patch_author` and `patch_comment` and creates the corresponding SourceStamps.\r\n\r\nHowever, if a property named `codebase` is not defined, the step fails with an exception:\r\n\r\n>     Traceback (most recent call last):\r\n>     Failure: exceptions.KeyError: 'codebase'\r\n\r\nDefining the `codebase` property as an empty string seems to satisfy the internals.\r\n\r\nShould this requirement be documented? Should the internals be refactored to support values which omit the property?\r\n\r\n- Python version: 2.7.12\r\n- Buildbot version: 1.1.0\r\n- Twisted version: 18.7.0", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4281/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4281/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4189", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/4189/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/4189/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/4189/events", "html_url": "https://github.com/buildbot/buildbot/issues/4189", "id": 338203682, "node_id": "MDU6SXNzdWUzMzgyMDM2ODI=", "number": 4189, "title": "Unicode error when using base change_hook with postgresql", "user": {"login": "rjarry", "id": 472286, "node_id": "MDQ6VXNlcjQ3MjI4Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/472286?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rjarry", "html_url": "https://github.com/rjarry", "followers_url": "https://api.github.com/users/rjarry/followers", "following_url": "https://api.github.com/users/rjarry/following{/other_user}", "gists_url": "https://api.github.com/users/rjarry/gists{/gist_id}", "starred_url": "https://api.github.com/users/rjarry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rjarry/subscriptions", "organizations_url": "https://api.github.com/users/rjarry/orgs", "repos_url": "https://api.github.com/users/rjarry/repos", "events_url": "https://api.github.com/users/rjarry/events{/privacy}", "received_events_url": "https://api.github.com/users/rjarry/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 558169710, "node_id": "MDU6TGFiZWw1NTgxNjk3MTA=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/db-postgres", "name": "db-postgres", "color": "1d76db", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-07-04T09:40:57Z", "updated_at": "2018-07-06T07:38:00Z", "closed_at": "2018-07-06T07:38:00Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I use the http base change hook to trigger builds.\r\n\r\nRecently, I noticed errors due to non ASCII characters in the author name (this is a wild guess as the full traceback is not available).\r\n\r\n```\r\n2018-07-03 20:23:22+0200 [_GenericHTTPChannelProtocol,109,127.0.0.1] WARNING: change source is using deprecated self.master.addChange method; this method will disappear in Buildbot-1.0.0\r\n2018-07-03 20:23:22+0200 [_GenericHTTPChannelProtocol,109,127.0.0.1] WARNING: change source is using deprecated addChange parameter 'when'\r\n2018-07-03 20:23:22+0200 [-] Got fatal Exception on DB\r\n        Traceback (most recent call last):\r\n        Failure: exceptions.UnicodeEncodeError: 'ascii' codec can't encode character u'\\xe9' in position 3: ordinal not in range(128)\r\n```\r\n\r\nThe problem only appears with postgresql, not sqlite.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/4189/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/4189/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3732", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3732/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3732/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3732/events", "html_url": "https://github.com/buildbot/buildbot/issues/3732", "id": 270856486, "node_id": "MDU6SXNzdWUyNzA4NTY0ODY=", "number": 3732, "title": "github change hook dialect not working with treq", "user": {"login": "morrone", "id": 178400, "node_id": "MDQ6VXNlcjE3ODQwMA==", "avatar_url": "https://avatars.githubusercontent.com/u/178400?v=4", "gravatar_id": "", "url": "https://api.github.com/users/morrone", "html_url": "https://github.com/morrone", "followers_url": "https://api.github.com/users/morrone/followers", "following_url": "https://api.github.com/users/morrone/following{/other_user}", "gists_url": "https://api.github.com/users/morrone/gists{/gist_id}", "starred_url": "https://api.github.com/users/morrone/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/morrone/subscriptions", "organizations_url": "https://api.github.com/users/morrone/orgs", "repos_url": "https://api.github.com/users/morrone/repos", "events_url": "https://api.github.com/users/morrone/events{/privacy}", "received_events_url": "https://api.github.com/users/morrone/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557422230, "node_id": "MDU6TGFiZWw1NTc0MjIyMzA=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/webhook", "name": "webhook", "color": "bfd4f2", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-11-03T01:26:32Z", "updated_at": "2018-10-10T12:55:41Z", "closed_at": "2018-10-10T12:55:41Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I am using buildbot 0.9.12., installed using \"pip install buildbot[bundle]\" in a virtualenv.\r\n\r\nI am finding that the 'github' change hook dialect appears not to work when the \"treq\" package is installed rather than \"txrequests\".  (By the way, it would be nice if the documentation for \"GitHub hook\" was updated to state that dependency.  Right now it is only documented in the \"buildbot.util.httpclientservice\", which most users won't know is implied by the github hook.)\r\n\r\nFor whatever reason, I tried installing treq first.  It looks like things are hanging in buildbot/www/hooks/github.py:_get_commit_msg() on this line:\r\n\r\n```data = yield res.json()```\r\n\r\nI manually dumped information about the URL that it was trying to retrieve, and I am able to use the curl command as the same user on the same node to retrieve the URL.  So I'm sure that my github repo doesn't require a token to access that information.\r\n\r\nEventually, I uninstalled \"treq\" and installed \"txrequests\" instead, and now the github change hook seems to be working correctly and generates changes as expected.\r\n\r\ntreq version 17.8.0\r\npython version 3.6\r\ntxrequests version 0.9.5\r\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3732/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3732/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3723", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3723/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3723/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3723/events", "html_url": "https://github.com/buildbot/buildbot/issues/3723", "id": 269356130, "node_id": "MDU6SXNzdWUyNjkzNTYxMzA=", "number": 3723, "title": "Hyper usage with buildbot-worker image generates fake docker error", "user": {"login": "pmatos", "id": 7911, "node_id": "MDQ6VXNlcjc5MTE=", "avatar_url": "https://avatars.githubusercontent.com/u/7911?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmatos", "html_url": "https://github.com/pmatos", "followers_url": "https://api.github.com/users/pmatos/followers", "following_url": "https://api.github.com/users/pmatos/following{/other_user}", "gists_url": "https://api.github.com/users/pmatos/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmatos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmatos/subscriptions", "organizations_url": "https://api.github.com/users/pmatos/orgs", "repos_url": "https://api.github.com/users/pmatos/repos", "events_url": "https://api.github.com/users/pmatos/events{/privacy}", "received_events_url": "https://api.github.com/users/pmatos/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557386829, "node_id": "MDU6TGFiZWw1NTczODY4Mjk=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/latent%20worker", "name": "latent worker", "color": "bfd4f2", "default": false, "description": null}, {"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-10-28T22:50:36Z", "updated_at": "2019-01-23T23:59:18Z", "closed_at": "2019-01-23T23:59:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "i have the following buildbot latent worker setup:\r\n```\r\nc['workers'] = [worker.HyperLatentWorker('hyper-latent',\r\n                                         password=None,\r\n                                         hyper_host='tcp://eu-central-1.hyper.sh:443',\r\n                                         image='buildbot/buildbot-worker',\r\n                                         masterFQDN='mybuildbot:9990',\r\n                                         hyper_accesskey='sdfsdf',\r\n                                         hyper_secretkey='laskdfaosfj',\r\n                                         hyper_size='s3',\r\n                                         build_wait_timeout=3)]\r\n```\r\n\r\nThe interesting thing is that this somehow trigger a docker error:\r\n```\r\n2017-10-29 00:32:09+0200 [-] DEBUG:urllib3.connectionpool:https://eu-central-1.hyper.sh:443 \"GET /v1.23/containers/json?filters=%7B%22name%22%3A+%5B%22buildboteb0b23-hyper-latent%22%5D%7D&trunc_cmd=0&size=0&limit=-1&all=1 HTTP/1.1\" 200 2\r\n2017-10-29 00:32:09+0200 [-] image: buildbot/buildbot-worker\r\n2017-10-29 00:32:09+0200 [-] name: buildboteb0b23-hyper-latent\r\n2017-10-29 00:32:09+0200 [-] DEBUG:urllib3.connectionpool:https://eu-central-1.hyper.sh:443 \"POST /v1.23/containers/create?name=buildboteb0b23-hyper-latent HTTP/1.1\" 404 47\r\n2017-10-29 00:32:09+0200 [-] while worker_prepare\r\n\tTraceback (most recent call last):\r\n\t  File \"/home/buildbot/ltbot/venv/lib/python3.5/site-packages/twisted/internet/defer.py\", line 653, in _runCallbacks\r\n\t    current.result = callback(current.result, *args, **kw)\r\n\t  File \"/home/buildbot/ltbot/venv/lib/python3.5/site-packages/twisted/internet/defer.py\", line 1442, in gotResult\r\n\t    _inlineCallbacks(r, g, deferred)\r\n\t  File \"/home/buildbot/ltbot/venv/lib/python3.5/site-packages/twisted/internet/defer.py\", line 1384, in _inlineCallbacks\r\n\t    result = result.throwExceptionIntoGenerator(g)\r\n\t  File \"/home/buildbot/ltbot/venv/lib/python3.5/site-packages/twisted/python/failure.py\", line 408, in throwExceptionIntoGenerator\r\n\t    return g.throw(self.type, self.value, self.tb)\r\n\t--- <exception caught here> ---\r\n\t  File \"/home/buildbot/ltbot/venv/lib/python3.5/site-packages/buildbot/process/build.py\", line 320, in startBuild\r\n\t    ready_or_failure = yield workerforbuilder.prepare(self)\r\n\t  File \"/home/buildbot/ltbot/venv/lib/python3.5/site-packages/twisted/internet/defer.py\", line 1384, in _inlineCallbacks\r\n\t    result = result.throwExceptionIntoGenerator(g)\r\n\t  File \"/home/buildbot/ltbot/venv/lib/python3.5/site-packages/twisted/python/failure.py\", line 408, in throwExceptionIntoGenerator\r\n\t    return g.throw(self.type, self.value, self.tb)\r\n\t  File \"/home/buildbot/ltbot/venv/lib/python3.5/site-packages/buildbot/worker/hyper.py\", line 129, in start_instance\r\n\t    yield self.deferToThread(self._thd_start_instance, image, size)\r\n\t  File \"/home/buildbot/ltbot/venv/lib/python3.5/site-packages/twisted/python/threadpool.py\", line 250, in inContext\r\n\t    result = inContext.theWork()\r\n\t  File \"/home/buildbot/ltbot/venv/lib/python3.5/site-packages/twisted/python/threadpool.py\", line 266, in <lambda>\r\n\t    inContext.theWork = lambda: context.call(ctx, func, *args, **kw)\r\n\t  File \"/home/buildbot/ltbot/venv/lib/python3.5/site-packages/twisted/python/context.py\", line 122, in callWithContext\r\n\t    return self.currentContext().callWithContext(ctx, func, *args, **kw)\r\n\t  File \"/home/buildbot/ltbot/venv/lib/python3.5/site-packages/twisted/python/context.py\", line 85, in callWithContext\r\n\t    return func(*args,**kw)\r\n\t  File \"/home/buildbot/ltbot/venv/lib/python3.5/site-packages/buildbot/worker/hyper.py\", line 163, in _thd_start_instance\r\n\t    name=self.getContainerName()\r\n\t  File \"/home/buildbot/ltbot/venv/lib/python3.5/site-packages/docker/api/container.py\", line 135, in create_container\r\n\t    return self.create_container_from_config(config, name)\r\n\t  File \"/home/buildbot/ltbot/venv/lib/python3.5/site-packages/docker/api/container.py\", line 146, in create_container_from_config\r\n\t    return self._result(res, True)\r\n\t  File \"/home/buildbot/ltbot/venv/lib/python3.5/site-packages/docker/client.py\", line 178, in _result\r\n\t    self._raise_for_status(response)\r\n\t  File \"/home/buildbot/ltbot/venv/lib/python3.5/site-packages/docker/client.py\", line 173, in _raise_for_status\r\n\t    raise errors.NotFound(e, response, explanation=explanation)\r\n\tdocker.errors.NotFound: 404 Client Error: Not Found (\"b'No such image: buildbot/buildbot-worker:latest'\")\r\n```\r\n\r\nObviously there's something else wrong the fact that `buildbot/buildbot-worker` does not exist. Just in case I actually pulled this image using docker cli but still get the error.\r\n\r\nMy guess is that something went wrong before due to this:\r\n```\r\n2017-10-29 00:32:09+0200 [-] DEBUG:urllib3.connectionpool:https://eu-central-1.hyper.sh:443 \"POST /v1.23/containers/create?name=buildboteb0b23-hyper-latent HTTP/1.1\" 404 47\r\n```\r\n\r\nIn my hyper console I don't see any container and it seems we got back a 404 error, so maybe that's it but I am not comfortable enough with hyper to understand all the terminology.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3723/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3723/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3694", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3694/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3694/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3694/events", "html_url": "https://github.com/buildbot/buildbot/issues/3694", "id": 265425852, "node_id": "MDU6SXNzdWUyNjU0MjU4NTI=", "number": 3694, "title": "IRC bot bytes vs Unicode issue on Python 3", "user": {"login": "vstinner", "id": 194129, "node_id": "MDQ6VXNlcjE5NDEyOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/194129?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vstinner", "html_url": "https://github.com/vstinner", "followers_url": "https://api.github.com/users/vstinner/followers", "following_url": "https://api.github.com/users/vstinner/following{/other_user}", "gists_url": "https://api.github.com/users/vstinner/gists{/gist_id}", "starred_url": "https://api.github.com/users/vstinner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vstinner/subscriptions", "organizations_url": "https://api.github.com/users/vstinner/orgs", "repos_url": "https://api.github.com/users/vstinner/repos", "events_url": "https://api.github.com/users/vstinner/events{/privacy}", "received_events_url": "https://api.github.com/users/vstinner/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 558173489, "node_id": "MDU6TGFiZWw1NTgxNzM0ODk=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/irc", "name": "irc", "color": "bfd4f2", "default": false, "description": null}, {"id": 632499035, "node_id": "MDU6TGFiZWw2MzI0OTkwMzU=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bytes", "name": "bytes", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2017-10-13T21:37:38Z", "updated_at": "2018-09-05T20:26:58Z", "closed_at": "2018-09-05T20:26:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "On the #pyhon-dev IRC channel, I noticed a \"b\" prefix in the IRC bot message:\r\n\r\n```\r\n22:40 -py-bb:#python-dev- b'Build s390x SLES 3.x #10 is complete:\r\nWarnings [\\x038warnings test (warnings)\\x0f] -\r\n          http://buildbot.python.org/all/#builders/16/builds/10'\r\n```\r\n\r\nIt seems like buildbot doesn't handle properly bytes vs Unicode in the IRC bot.\r\n\r\nTry maybe to run your IRC bot unit tests with python3 -bb?", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3694/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3694/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3688", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3688/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3688/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3688/events", "html_url": "https://github.com/buildbot/buildbot/issues/3688", "id": 263924285, "node_id": "MDU6SXNzdWUyNjM5MjQyODU=", "number": 3688, "title": "[grid_view] updating 0.9.10 to 0.9.12 leaves the grid with a single row", "user": {"login": "aureliendavid", "id": 7168263, "node_id": "MDQ6VXNlcjcxNjgyNjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7168263?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aureliendavid", "html_url": "https://github.com/aureliendavid", "followers_url": "https://api.github.com/users/aureliendavid/followers", "following_url": "https://api.github.com/users/aureliendavid/following{/other_user}", "gists_url": "https://api.github.com/users/aureliendavid/gists{/gist_id}", "starred_url": "https://api.github.com/users/aureliendavid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aureliendavid/subscriptions", "organizations_url": "https://api.github.com/users/aureliendavid/orgs", "repos_url": "https://api.github.com/users/aureliendavid/repos", "events_url": "https://api.github.com/users/aureliendavid/events{/privacy}", "received_events_url": "https://api.github.com/users/aureliendavid/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557399128, "node_id": "MDU6TGFiZWw1NTczOTkxMjg=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/web%20UI", "name": "web UI", "color": "bfd4f2", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2017-10-09T14:54:37Z", "updated_at": "2017-10-10T13:50:49Z", "closed_at": "2017-10-10T13:50:49Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hello, \r\n\r\nwith 0.9.10 I have a grid view that looks like this:\r\n\r\n![bbgrid1](https://user-images.githubusercontent.com/7168263/31344179-3637e388-ad12-11e7-9885-e9a55c58d668.png)\r\n\r\nafter updating to 0.9.12 (with pip) I get\r\n\r\n![bbgrid2](https://user-images.githubusercontent.com/7168263/31344195-4355c56c-ad12-11e7-81f6-6a3538824f44.png)\r\n\r\nany idea what happened?\r\n\r\nThanks in advance. ", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3688/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3688/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3664", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3664/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3664/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3664/events", "html_url": "https://github.com/buildbot/buildbot/issues/3664", "id": 261751881, "node_id": "MDU6SXNzdWUyNjE3NTE4ODE=", "number": 3664, "title": "buildbot.errors.PluginDBError: Unknown component name: HipChatStatusPush", "user": {"login": "avoine", "id": 192043, "node_id": "MDQ6VXNlcjE5MjA0Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/192043?v=4", "gravatar_id": "", "url": "https://api.github.com/users/avoine", "html_url": "https://github.com/avoine", "followers_url": "https://api.github.com/users/avoine/followers", "following_url": "https://api.github.com/users/avoine/following{/other_user}", "gists_url": "https://api.github.com/users/avoine/gists{/gist_id}", "starred_url": "https://api.github.com/users/avoine/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/avoine/subscriptions", "organizations_url": "https://api.github.com/users/avoine/orgs", "repos_url": "https://api.github.com/users/avoine/repos", "events_url": "https://api.github.com/users/avoine/events{/privacy}", "received_events_url": "https://api.github.com/users/avoine/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2017-09-29T19:48:36Z", "updated_at": "2020-12-31T19:08:32Z", "closed_at": "2020-12-31T19:08:32Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I'm trying to get the hipchat reporter to work but I have the following backtrace at startup.\r\nIs there a way I can debug this?\r\n\r\n<pre>\r\n        Traceback (most recent call last):\r\n          File \".../lib/python2.7/site-packages/twisted/python/threadpool.py\", line 266, in <lambda>\r\n            inContext.theWork = lambda: context.call(ctx, func, *args, **kw)\r\n          File \".../lib/python2.7/site-packages/twisted/python/context.py\", line 122, in callWithContext\r\n            return self.currentContext().callWithContext(ctx, func, *args, **kw)\r\n          File \".../lib/python2.7/site-packages/twisted/python/context.py\", line 85, in callWithContext\r\n            return func(*args,**kw)\r\n          File \".../lib/python2.7/site-packages/buildbot/config.py\", line 181, in loadConfig\r\n            self.basedir, self.configFileName)\r\n        --- <exception caught here> ---\r\n          File \".../lib/python2.7/site-packages/buildbot/config.py\", line 139, in loadConfigDict \r\n            execfile(filename, localDict)\r\n          File \".../lib/python2.7/site-packages/twisted/python/compat.py\", line 246, in execfile\r\n            exec(code, globals, locals)\r\n          File \"...sites/ciserver/master.cfg\", line 88, in <module> \r\n            hs = reporters.HipChatStatusPush('...', endpoint='https://api.hipchat.com')\r\n          File \".../lib/python2.7/site-packages/buildbot/plugins/db.py\", line 316, in __getattr__ \r\n            return getattr(self._tree, name)\r\n          File \".../lib/python2.7/site-packages/buildbot/plugins/db.py\", line 182, in __getattr__ \r\n            raise PluginDBError('Unknown component name: %s' % name)\r\n        buildbot.errors.PluginDBError: Unknown component name: HipChatStatusPush\r\n</pre>", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3664/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3664/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3657", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3657/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3657/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3657/events", "html_url": "https://github.com/buildbot/buildbot/issues/3657", "id": 261125596, "node_id": "MDU6SXNzdWUyNjExMjU1OTY=", "number": 3657, "title": "Console UI jumps to top of page when you click on a build", "user": {"login": "uglycoyote", "id": 2461007, "node_id": "MDQ6VXNlcjI0NjEwMDc=", "avatar_url": "https://avatars.githubusercontent.com/u/2461007?v=4", "gravatar_id": "", "url": "https://api.github.com/users/uglycoyote", "html_url": "https://github.com/uglycoyote", "followers_url": "https://api.github.com/users/uglycoyote/followers", "following_url": "https://api.github.com/users/uglycoyote/following{/other_user}", "gists_url": "https://api.github.com/users/uglycoyote/gists{/gist_id}", "starred_url": "https://api.github.com/users/uglycoyote/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/uglycoyote/subscriptions", "organizations_url": "https://api.github.com/users/uglycoyote/orgs", "repos_url": "https://api.github.com/users/uglycoyote/repos", "events_url": "https://api.github.com/users/uglycoyote/events{/privacy}", "received_events_url": "https://api.github.com/users/uglycoyote/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557915068, "node_id": "MDU6TGFiZWw1NTc5MTUwNjg=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/usability", "name": "usability", "color": "fbca04", "default": false, "description": null}, {"id": 557979200, "node_id": "MDU6TGFiZWw1NTc5NzkyMDA=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/console_view", "name": "console_view", "color": "c5def5", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-09-27T21:35:11Z", "updated_at": "2018-03-28T06:01:57Z", "closed_at": "2018-03-28T06:01:56Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "If the console view is long enough that you have to scroll down, when I click on a bubble (to view a build summary) it automatically scrolls back to the top of the console table.  This is annoying if you want to view a bunch of summaries that are all side by side but somewhere way down the page.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3657/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3657/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3646", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3646/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3646/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3646/events", "html_url": "https://github.com/buildbot/buildbot/issues/3646", "id": 259897632, "node_id": "MDU6SXNzdWUyNTk4OTc2MzI=", "number": 3646, "title": "SVNPoller stops abruptly", "user": {"login": "aj062", "id": 3098702, "node_id": "MDQ6VXNlcjMwOTg3MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3098702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aj062", "html_url": "https://github.com/aj062", "followers_url": "https://api.github.com/users/aj062/followers", "following_url": "https://api.github.com/users/aj062/following{/other_user}", "gists_url": "https://api.github.com/users/aj062/gists{/gist_id}", "starred_url": "https://api.github.com/users/aj062/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aj062/subscriptions", "organizations_url": "https://api.github.com/users/aj062/orgs", "repos_url": "https://api.github.com/users/aj062/repos", "events_url": "https://api.github.com/users/aj062/events{/privacy}", "received_events_url": "https://api.github.com/users/aj062/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557397635, "node_id": "MDU6TGFiZWw1NTczOTc2MzU=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/changesource", "name": "changesource", "color": "bfd4f2", "default": false, "description": null}, {"id": 558154265, "node_id": "MDU6TGFiZWw1NTgxNTQyNjU=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/needs%20reproducer", "name": "needs reproducer", "color": "f7c6c7", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-09-22T18:22:06Z", "updated_at": "2021-09-05T02:51:32Z", "closed_at": "2021-09-05T02:51:32Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I noticed that my buildbot instance (version 0.9.11) wasn't picking up changes from SVN repository. On looking at twistd.log files, I noticed that there was no SVNPoller related logs recently. It was working fine till yesterday and it stopped abruptly without any error messages in the logs.\r\n\r\nThese are the logs I see related to SVNPoller:\r\n```\r\n[~] grep SVNPoller twistd.log.1\r\n2017-09-21 23:53:16-0700 [-] SVNPoller: _process_changes 2379 .. 2379\r\n2017-09-21 23:53:16-0700 [-] SVNPoller: finished polling None\r\n2017-09-21 23:54:12-0700 [-] SVNPoller: polling\r\n2017-09-21 23:54:12-0700 [-] SVNPoller: repourl=https://myproject, root=https://myproject, so prefix=\r\n2017-09-21 23:54:15-0700 [-] SVNPoller: no changes\r\n2017-09-21 23:54:15-0700 [-] SVNPoller: _process_changes 2379 .. 2379\r\n2017-09-21 23:54:15-0700 [-] SVNPoller: finished polling None\r\n2017-09-21 23:55:12-0700 [-] SVNPoller: polling\r\n\r\n[~] grep SVNPoller twistd.log\r\n[~] \r\n\r\n```\r\n\r\nIt seems from logs like SVNPoller started polling, but never finished. Can it be stuck somewhere?\r\nCan the network request (svn info --xml --non-interactive  https://svn-repository) in https://git.io/vdJTw  hang forever in case of a network issue?", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3646/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3646/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3565", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3565/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3565/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3565/events", "html_url": "https://github.com/buildbot/buildbot/issues/3565", "id": 253911365, "node_id": "MDU6SXNzdWUyNTM5MTEzNjU=", "number": 3565, "title": "Interlocks in buildsteps may cause deadlock", "user": {"login": "chapuni", "id": 379295, "node_id": "MDQ6VXNlcjM3OTI5NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/379295?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chapuni", "html_url": "https://github.com/chapuni", "followers_url": "https://api.github.com/users/chapuni/followers", "following_url": "https://api.github.com/users/chapuni/following{/other_user}", "gists_url": "https://api.github.com/users/chapuni/gists{/gist_id}", "starred_url": "https://api.github.com/users/chapuni/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chapuni/subscriptions", "organizations_url": "https://api.github.com/users/chapuni/orgs", "repos_url": "https://api.github.com/users/chapuni/repos", "events_url": "https://api.github.com/users/chapuni/events{/privacy}", "received_events_url": "https://api.github.com/users/chapuni/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557418958, "node_id": "MDU6TGFiZWw1NTc0MTg5NTg=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/step", "name": "step", "color": "bfd4f2", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-08-30T08:02:04Z", "updated_at": "2017-09-29T06:51:20Z", "closed_at": "2017-09-29T06:51:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "When each builder has;\r\n\r\n- Same name and command lines\r\n- Same name of the interlock\r\n\r\nThey can easily deadlocks. I checked with bunch of \"sleep 10\" with the workerlock.\r\n\r\nAs far as I investigated, it was because since BuildStep had ComparableMixin.\r\nSee also compare_attrs in BuildStep, _BuildStepFactory, MasterLock and WorkerLock.\r\nWorkerLock has also ComparableMixin, it would match equality between different instances.\r\n\r\nI can locally resolved this issue to use \"is / not is\" instead of __eq__ to compare owner,\r\nin BaseLock::claim and BaseLock::waitUntilMaybeAvailable.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3565/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3565/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3563", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3563/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3563/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3563/events", "html_url": "https://github.com/buildbot/buildbot/issues/3563", "id": 253634392, "node_id": "MDU6SXNzdWUyNTM2MzQzOTI=", "number": 3563, "title": "Build not triggered", "user": {"login": "pohmelie", "id": 2385765, "node_id": "MDQ6VXNlcjIzODU3NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/2385765?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pohmelie", "html_url": "https://github.com/pohmelie", "followers_url": "https://api.github.com/users/pohmelie/followers", "following_url": "https://api.github.com/users/pohmelie/following{/other_user}", "gists_url": "https://api.github.com/users/pohmelie/gists{/gist_id}", "starred_url": "https://api.github.com/users/pohmelie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pohmelie/subscriptions", "organizations_url": "https://api.github.com/users/pohmelie/orgs", "repos_url": "https://api.github.com/users/pohmelie/repos", "events_url": "https://api.github.com/users/pohmelie/events{/privacy}", "received_events_url": "https://api.github.com/users/pohmelie/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557428611, "node_id": "MDU6TGFiZWw1NTc0Mjg2MTE=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/scheduler", "name": "scheduler", "color": "bfd4f2", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-08-29T12:12:16Z", "updated_at": "2021-07-28T23:52:07Z", "closed_at": "2021-07-28T23:52:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "Config with multiple schedulers does not trigger build. If I remove one scheduler, then build triggered. But for two schedulers no build triggered.\r\n``` python\r\nfrom buildbot.plugins import worker, changes, schedulers, util, steps\r\n\r\n\r\nREPO = \"git@git.int.kronshtadt.ru:ktrs-sdc/test-python-buildbot.git\"\r\nc = BuildmasterConfig = {}\r\nc[\"workers\"] = [worker.LocalWorker(\"worker\", max_builds=1)]\r\nc[\"protocols\"] = {\"pb\": {\"port\": 9989}}\r\nc[\"change_source\"] = [changes.GitPoller(repourl=REPO, branches=[\"master\"], pollInterval=10)]\r\nc[\"schedulers\"] = [\r\n    schedulers.AnyBranchScheduler(name=\"s1\", builderNames=[\"builder\"], properties=dict(foo=\"bar\")),\r\n    schedulers.AnyBranchScheduler(name=\"s2\", builderNames=[\"builder\"], properties=dict(foo=\"foo\")),\r\n]\r\nfactory = util.BuildFactory([steps.ShellCommand(name=\"test\", command=[\"echo\", \"test\"])])\r\nc[\"builders\"] = [util.BuilderConfig(name=\"builder\", workernames=[\"worker\"], factory=factory)]\r\nc[\"services\"] = []\r\nc[\"title\"] = \"Test buildbot\"\r\nc[\"buildbotURL\"] = \"http://localhost:8010/\"\r\nc[\"www\"] = dict(port=8010, plugins=dict(waterfall_view={}, console_view={}, grid_view={}))\r\nc[\"db\"] = dict(db_url=\"sqlite:///state.sqlite\")\r\n```\r\n```\r\n2017-08-29 14:59:31+0300 [-] gitpoller: processing changes from \"git@git.int.kronshtadt.ru:ktrs-sdc/test-python-buildbot.git\"\r\n2017-08-29 14:59:41+0300 [-] gitpoller: processing changes from \"git@git.int.kronshtadt.ru:ktrs-sdc/test-python-buildbot.git\"\r\n2017-08-29 14:59:41+0300 [-] gitpoller: processing 1 changes: ['20e32aca133787a9abfa91896d27bfd30249c7d7'] from \"git@git.int.kronshtadt.ru:ktrs-sdc/test-python-buildbot.git\" branch \"master\"\r\n2017-08-29 14:59:41+0300 [-] added change with revision 20e32aca133787a9abfa91896d27bfd30249c7d7 to database\r\n2017-08-29 14:59:42+0300 [-] added buildset 1 to database\r\n2017-08-29 14:59:42+0300 [-] added buildset 2 to database\r\n2017-08-29 14:59:51+0300 [-] gitpoller: processing changes from \"git@git.int.kronshtadt.ru:ktrs-sdc/test-python-buildbot.git\"\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3563/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3563/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3506", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3506/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3506/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3506/events", "html_url": "https://github.com/buildbot/buildbot/issues/3506", "id": 249357106, "node_id": "MDU6SXNzdWUyNDkzNTcxMDY=", "number": 3506, "title": "Clarify Gitlab change_request secret expectation", "user": {"login": "pmatos", "id": 7911, "node_id": "MDQ6VXNlcjc5MTE=", "avatar_url": "https://avatars.githubusercontent.com/u/7911?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmatos", "html_url": "https://github.com/pmatos", "followers_url": "https://api.github.com/users/pmatos/followers", "following_url": "https://api.github.com/users/pmatos/following{/other_user}", "gists_url": "https://api.github.com/users/pmatos/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmatos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmatos/subscriptions", "organizations_url": "https://api.github.com/users/pmatos/orgs", "repos_url": "https://api.github.com/users/pmatos/repos", "events_url": "https://api.github.com/users/pmatos/events{/privacy}", "received_events_url": "https://api.github.com/users/pmatos/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557422230, "node_id": "MDU6TGFiZWw1NTc0MjIyMzA=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/webhook", "name": "webhook", "color": "bfd4f2", "default": false, "description": null}, {"id": 568921941, "node_id": "MDU6TGFiZWw1Njg5MjE5NDE=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/py3", "name": "py3", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2017-08-10T14:03:05Z", "updated_at": "2017-08-18T17:56:38Z", "closed_at": "2017-08-18T17:56:38Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi,\r\n\r\nI noticed that my secret was not working. I had this in my config:\r\n```\r\n           'change_hook_dialects': { 'gitlab': { 'secret': 'UOziotZbojm' } }\r\n```\r\n\r\nHowever, asking gitlab to send this secret was resulting in `Invalid secret`. I added a couple of log messages in `gitlab.py`:\r\n```python\r\n        if expected_secret:\r\n            received_secret = request.getHeader(_HEADER_GITLAB_TOKEN)\r\n            log.msg('Received secret: \"{}\"'.format(received_secret))\r\n            log.msg('Expected secret: \"{}\"'.format(expected_secret))\r\n            if received_secret != expected_secret:\r\n                raise ValueError(\"Invalid secret\")\r\n```\r\n\r\nAnd I see the problem:\r\n```\r\n2017-08-10 15:55:51+0200 [_GenericHTTPChannelProtocol,0,127.0.0.1] Received secret: \"b'UOziotZbojm'\"\r\n2017-08-10 15:55:51+0200 [_GenericHTTPChannelProtocol,0,127.0.0.1] Expected secret: \"UOziotZbojm\"\r\n```\r\n\r\nWhat's the expectation here? Certainly not that the user should specify a bytestring given the documentation shows:\r\n```python\r\nc['www'] = dict(...,\r\n    change_hook_dialects={\r\n        'gitlab' : {\r\n            'secret': '...',\r\n        },\r\n    },\r\n)\r\n```\r\n\r\nWe either change the documentation, or convert the bytestring to a string before comparison. What's the consensus on this? I am happy to provide a patch either way.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3506/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3506/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3472", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3472/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3472/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3472/events", "html_url": "https://github.com/buildbot/buildbot/issues/3472", "id": 245598036, "node_id": "MDU6SXNzdWUyNDU1OTgwMzY=", "number": 3472, "title": "tried to complete 1 buildrequests, but only completed 0", "user": {"login": "lancelodliu", "id": 19603852, "node_id": "MDQ6VXNlcjE5NjAzODUy", "avatar_url": "https://avatars.githubusercontent.com/u/19603852?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lancelodliu", "html_url": "https://github.com/lancelodliu", "followers_url": "https://api.github.com/users/lancelodliu/followers", "following_url": "https://api.github.com/users/lancelodliu/following{/other_user}", "gists_url": "https://api.github.com/users/lancelodliu/gists{/gist_id}", "starred_url": "https://api.github.com/users/lancelodliu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lancelodliu/subscriptions", "organizations_url": "https://api.github.com/users/lancelodliu/orgs", "repos_url": "https://api.github.com/users/lancelodliu/repos", "events_url": "https://api.github.com/users/lancelodliu/events{/privacy}", "received_events_url": "https://api.github.com/users/lancelodliu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 19, "created_at": "2017-07-26T03:45:40Z", "updated_at": "2017-10-05T07:40:22Z", "closed_at": "2017-10-05T07:40:22Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This happens when **3** changes comes at a time. The first one got handled perfectly. Problem is the 2nd and 3rd change when the 2nd change was merged to 3rd and a `NotClaimedError` was raised. I use Perforce as CVS.\r\nand log is:\r\n```\r\n2017-07-26 11:39:39+0800 [-] added change with revision 98 to database\r\n2017-07-26 11:39:59+0800 [-] added buildset 324 to database\r\n2017-07-26 11:39:59+0800 [-] added change with revision 99 to database\r\n2017-07-26 11:40:19+0800 [-] starting build <Build runtests number:None results:success> using worker <WorkerForBuilder builder=u'runtests' worker=u'example-worker' state=AVAILABLE>\r\n2017-07-26 11:40:19+0800 [-] <Build runtests number:None results:success>.startBuild\r\n2017-07-26 11:40:21+0800 [-] added buildset 325 to database\r\n2017-07-26 11:40:22+0800 [-] acquireLocks(worker <Worker u'example-worker'>, locks [])\r\n2017-07-26 11:40:22+0800 [-] starting build <Build runtests number:295 results:success>.. pinging the worker <WorkerForBuilder builder=u'runtests' worker=u'example-worker' state=BUILDING>\r\n2017-07-26 11:40:22+0800 [-] sending ping\r\n2017-07-26 11:40:22+0800 [Broker,0,127.0.0.1] ping finished: success\r\n// Blabla...OMIT a lot P4 sync command\r\n2017-07-26 11:40:28+0800 [-]  step 'p4' complete: success (None)\r\n2017-07-26 11:40:28+0800 [-]  <Build runtests number:295 results:success>: build finished\r\n2017-07-26 11:40:28+0800 [-] releaseLocks(<Worker u'example-worker'>): []\r\n2017-07-26 11:40:29+0800 [-] tried to complete 1 buildrequests, but only completed 0\r\n2017-07-26 11:40:29+0800 [-] Got fatal Exception on DB\r\n\tTraceback (most recent call last):\r\n\tFailure: buildbot.db.buildrequests.NotClaimedError: \r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3472/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3472/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3460", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3460/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3460/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3460/events", "html_url": "https://github.com/buildbot/buildbot/issues/3460", "id": 244704541, "node_id": "MDU6SXNzdWUyNDQ3MDQ1NDE=", "number": 3460, "title": "Gerrit source step doesn't work well with multiple codebases", "user": {"login": "willlovett-arm", "id": 23216379, "node_id": "MDQ6VXNlcjIzMjE2Mzc5", "avatar_url": "https://avatars.githubusercontent.com/u/23216379?v=4", "gravatar_id": "", "url": "https://api.github.com/users/willlovett-arm", "html_url": "https://github.com/willlovett-arm", "followers_url": "https://api.github.com/users/willlovett-arm/followers", "following_url": "https://api.github.com/users/willlovett-arm/following{/other_user}", "gists_url": "https://api.github.com/users/willlovett-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/willlovett-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/willlovett-arm/subscriptions", "organizations_url": "https://api.github.com/users/willlovett-arm/orgs", "repos_url": "https://api.github.com/users/willlovett-arm/repos", "events_url": "https://api.github.com/users/willlovett-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/willlovett-arm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 482128964, "node_id": "MDU6TGFiZWw0ODIxMjg5NjQ=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/in%20progress", "name": "in progress", "color": "ededed", "default": false, "description": null}, {"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-07-21T15:28:03Z", "updated_at": "2021-09-05T00:46:28Z", "closed_at": "2021-09-05T00:46:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I have a project that consists of multiple codebases, usually with the same branch names, within a gerrit instance.\r\n\r\nMy GerritChangeSource monitors them and performs pre-commit testing on the project (on patchset-created events) by checking out each of these codebases using a Gerrit step.\r\n\r\nHowever, Gerrit.build.getProperty(\"event.patchSet.ref\") is not currently indexed by codebase, so every Gerrit step attempts to checkout the change ref, which fails on all but the modified codebase.\r\n\r\nI currently work around this in my buildbot config by subclassing Gerrit:\r\n\r\n```\r\nfrom buildbot.steps.source.gerrit import Gerrit\r\n\r\nclass MultiCodebaseGerrit(Gerrit):\r\n    def __init__(self, **kwargs):\r\n        Gerrit.__init__(self, **kwargs)\r\n\r\n    def startVC(self, branch, revision, patch):\r\n        if self.sourcestamp.codebase == self.codebase:\r\n            super(Gerrit, self).startVC(branch, revision, patch)\r\n        else:\r\n            super(Git, self).startVC(branch, revision, patch)\r\n```\r\n\r\n1. Am I missing some easier way of doing this?, and if not\r\n2. Is the patch below roughly the right way of fixing it?  If so, I'll create a pull request\r\n```\r\ndiff --git a/master/buildbot/steps/source/gerrit.py b/master/buildbot/steps/source/gerrit.py\r\nindex 979f77ce0..4c70ab184 100644\r\n--- a/master/buildbot/steps/source/gerrit.py\r\n+++ b/master/buildbot/steps/source/gerrit.py\r\n@@ -26,7 +26,11 @@ class Gerrit(Git):\r\n\r\n     def startVC(self, branch, revision, patch):\r\n         gerrit_branch = None\r\n-        if self.build.hasProperty(\"event.patchSet.ref\"):\r\n+        if self.sourcestamp.codebase != self.codebase:\r\n+            # The change is from a different codebase, so just check out the\r\n+            # head of the given branch\r\n+            pass\r\n+        elif self.build.hasProperty(\"event.patchSet.ref\"):\r\n             gerrit_branch = self.build.getProperty(\"event.patchSet.ref\")\r\n             self.updateSourceProperty(\"gerrit_branch\", gerrit_branch)\r\n         else:\r\n```\r\n\r\nThanks!\r\n\r\nWill Lovett", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3460/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3460/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3457", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3457/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3457/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3457/events", "html_url": "https://github.com/buildbot/buildbot/issues/3457", "id": 244561381, "node_id": "MDU6SXNzdWUyNDQ1NjEzODE=", "number": 3457, "title": "elapsed time for current build is negative", "user": {"login": "aj062", "id": 3098702, "node_id": "MDQ6VXNlcjMwOTg3MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3098702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aj062", "html_url": "https://github.com/aj062", "followers_url": "https://api.github.com/users/aj062/followers", "following_url": "https://api.github.com/users/aj062/following{/other_user}", "gists_url": "https://api.github.com/users/aj062/gists{/gist_id}", "starred_url": "https://api.github.com/users/aj062/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aj062/subscriptions", "organizations_url": "https://api.github.com/users/aj062/orgs", "repos_url": "https://api.github.com/users/aj062/repos", "events_url": "https://api.github.com/users/aj062/events{/privacy}", "received_events_url": "https://api.github.com/users/aj062/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557399128, "node_id": "MDU6TGFiZWw1NTczOTkxMjg=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/web%20UI", "name": "web UI", "color": "bfd4f2", "default": false, "description": null}, {"id": 557419407, "node_id": "MDU6TGFiZWw1NTc0MTk0MDc=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/easy", "name": "easy", "color": "0e8a16", "default": false, "description": null}, {"id": 798049821, "node_id": "MDU6TGFiZWw3OTgwNDk4MjE=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/good%20first%20issue", "name": "good first issue", "color": "62f794", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-07-21T04:29:14Z", "updated_at": "2022-11-06T11:17:07Z", "closed_at": "2022-11-06T11:17:07Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Frequently, while loading webpages, buildbot shows negative time for time elapsed for current build/step. It gets corrected automatically after few seconds. However, if buildbot is not very fast, this is very noticeable. Seems like some script taking long time to load and displaying negative time meanwhile.\r\n\r\nFew screenshots below.\r\n\r\n<img width=\"290\" alt=\"screen shot 2017-07-20 at 6 47 57 pm\" src=\"https://user-images.githubusercontent.com/3098702/28449022-5b899822-6d91-11e7-9c97-8d5bd959e631.png\">\r\n\r\n<img width=\"1262\" alt=\"screen shot 2017-07-20 at 9 20 18 pm\" src=\"https://user-images.githubusercontent.com/3098702/28449026-5e92a176-6d91-11e7-82d5-360c7fb7d2fa.png\">\r\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3457/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3457/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3452", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3452/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3452/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3452/events", "html_url": "https://github.com/buildbot/buildbot/issues/3452", "id": 243689779, "node_id": "MDU6SXNzdWUyNDM2ODk3Nzk=", "number": 3452, "title": "Github change hook incorrectly treats payload with bytes", "user": {"login": "maleadt", "id": 383068, "node_id": "MDQ6VXNlcjM4MzA2OA==", "avatar_url": "https://avatars.githubusercontent.com/u/383068?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maleadt", "html_url": "https://github.com/maleadt", "followers_url": "https://api.github.com/users/maleadt/followers", "following_url": "https://api.github.com/users/maleadt/following{/other_user}", "gists_url": "https://api.github.com/users/maleadt/gists{/gist_id}", "starred_url": "https://api.github.com/users/maleadt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maleadt/subscriptions", "organizations_url": "https://api.github.com/users/maleadt/orgs", "repos_url": "https://api.github.com/users/maleadt/repos", "events_url": "https://api.github.com/users/maleadt/events{/privacy}", "received_events_url": "https://api.github.com/users/maleadt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557422230, "node_id": "MDU6TGFiZWw1NTc0MjIyMzA=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/webhook", "name": "webhook", "color": "bfd4f2", "default": false, "description": null}, {"id": 568921941, "node_id": "MDU6TGFiZWw1Njg5MjE5NDE=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/py3", "name": "py3", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-07-18T11:51:15Z", "updated_at": "2017-09-08T19:29:47Z", "closed_at": "2017-09-08T18:57:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "Using the Github change hook, it seems like the decoded payload contains bytes instead of strings:\r\n\r\n```\r\n2017-07-18 13:37:22+0200 [-] {b'payload': [b'{\"ref\":\"refs/heads/master\",\"before\":\"3c41557e1a77291ca8b109d'\r\n2017-07-18 13:37:22+0200 [-]               b'd267cbd80dfa647ae\",\"after\":\"2d28d01c433ea620d4808ea0e7fb5ba3'\r\n...\r\n```\r\n\r\nSo indexing with a regular string `\"payload\"` throws a KeyError:\r\n\r\n```\r\n        Traceback (most recent call last):\r\n          File \"/opt/buildbot/lib/python3.5/site-packages/twisted/web/server.py\", line 235, in render\r\n            body = resrc.render(self)\r\n          File \"/opt/buildbot/lib/python3.5/site-packages/twisted/web/resource.py\", line 250, in render\r\n            return m(request)\r\n          File \"/opt/buildbot/lib/python3.5/site-packages/buildbot/www/change_hook.py\", line 81, in render_POST\r\n            d = self.getAndSubmitChanges(request)\r\n          File \"/opt/buildbot/lib/python3.5/site-packages/twisted/internet/defer.py\", line 1532, in unwindGenerator\r\n            return _inlineCallbacks(None, gen, Deferred())\r\n        --- <exception caught here> ---\r\n          File \"/opt/buildbot/lib/python3.5/site-packages/twisted/internet/defer.py\", line 1384, in _inlineCallbacks\r\n            result = result.throwExceptionIntoGenerator(g)\r\n          File \"/opt/buildbot/lib/python3.5/site-packages/twisted/python/failure.py\", line 393, in throwExceptionIntoGenerator\r\n            return g.throw(self.type, self.value, self.tb)\r\n          File \"/opt/buildbot/lib/python3.5/site-packages/buildbot/www/change_hook.py\", line 107, in getAndSubmitChanges\r\n            changes, src = yield self.getChanges(request)\r\n        builtins.KeyError: 'payload'\r\n```\r\n\r\nChanging the source [here](https://github.com/buildbot/buildbot/blob/08cf30663f317ad3c089a2d94b8bca5f98d830ef/master/buildbot/www/hooks/github.py#L101) to index with bytes and decode the results (ie. `json.loads(bytes2NativeString(request.args[b'payload'][0]))`) makes the change hook work again, but I lack the python experience to know how good of a fix that is.\r\n\r\n```\r\nbuildbot==0.9.9.post2\r\nbuildbot-console-view==0.9.9.post2\r\nbuildbot-waterfall-view==0.9.9.post2\r\nbuildbot-worker==0.9.9.post2\r\nbuildbot-www==0.9.9.post2\r\n\r\nPython 3.5.3\r\n\r\nDebian Jessie\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3452/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3452/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3448", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3448/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3448/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3448/events", "html_url": "https://github.com/buildbot/buildbot/issues/3448", "id": 243445787, "node_id": "MDU6SXNzdWUyNDM0NDU3ODc=", "number": 3448, "title": "exceptions.UnicodeDecodeError: invalid start byte", "user": {"login": "aj062", "id": 3098702, "node_id": "MDQ6VXNlcjMwOTg3MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3098702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aj062", "html_url": "https://github.com/aj062", "followers_url": "https://api.github.com/users/aj062/followers", "following_url": "https://api.github.com/users/aj062/following{/other_user}", "gists_url": "https://api.github.com/users/aj062/gists{/gist_id}", "starred_url": "https://api.github.com/users/aj062/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aj062/subscriptions", "organizations_url": "https://api.github.com/users/aj062/orgs", "repos_url": "https://api.github.com/users/aj062/repos", "events_url": "https://api.github.com/users/aj062/events{/privacy}", "received_events_url": "https://api.github.com/users/aj062/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557419407, "node_id": "MDU6TGFiZWw1NTc0MTk0MDc=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/easy", "name": "easy", "color": "0e8a16", "default": false, "description": null}, {"id": 632499035, "node_id": "MDU6TGFiZWw2MzI0OTkwMzU=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bytes", "name": "bytes", "color": "fbca04", "default": false, "description": null}, {"id": 798049821, "node_id": "MDU6TGFiZWw3OTgwNDk4MjE=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/good%20first%20issue", "name": "good first issue", "color": "62f794", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2017-07-17T16:05:05Z", "updated_at": "2019-01-19T06:13:06Z", "closed_at": "2019-01-19T06:13:06Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I am noticing this error in twisted.log every time I try to open console view (and the console view doesn't open, keeps showing loading image).\r\n\r\n2017-07-17 08:58:04-0700 [-] while handling API request\r\n\tTraceback (most recent call last):\r\n\t  File \"/usr/lib64/python2.7/site-packages/twisted/internet/defer.py\", line 1355, in gotResult\r\n\t    _inlineCallbacks(r, g, deferred)\r\n\t  File \"/usr/lib64/python2.7/site-packages/twisted/internet/defer.py\", line 1299, in _inlineCallbacks\r\n\t    result = g.send(result)\r\n\t  File \"/usr/lib/python2.7/site-packages/buildbot/www/rest.py\", line 453, in renderRest\r\n\t    request.write(data)\r\n\t  File \"/usr/lib64/python2.7/contextlib.py\", line 35, in __exit__\r\n\t    self.gen.throw(type, value, traceback)\r\n\t--- <exception caught here> ---\r\n\t  File \"/usr/lib/python2.7/site-packages/buildbot/www/rest.py\", line 141, in handleErrors\r\n\t    yield\r\n\t  File \"/usr/lib/python2.7/site-packages/buildbot/www/rest.py\", line 444, in renderRest\r\n\t    sort_keys=True, separators=(',', ':'))\r\n\t  File \"/usr/lib64/python2.7/json/__init__.py\", line 250, in dumps\r\n\t    sort_keys=sort_keys, **kw).encode(obj)\r\n\t  File \"/usr/lib64/python2.7/json/encoder.py\", line 209, in encode\r\n\t    chunks = list(chunks)\r\n\t  File \"/usr/lib64/python2.7/json/encoder.py\", line 434, in _iterencode\r\n\t    for chunk in _iterencode_dict(o, _current_indent_level):\r\n\t  File \"/usr/lib64/python2.7/json/encoder.py\", line 408, in _iterencode_dict\r\n\t    for chunk in chunks:\r\n\t  File \"/usr/lib64/python2.7/json/encoder.py\", line 332, in _iterencode_list\r\n\t    for chunk in chunks:\r\n\t  File \"/usr/lib64/python2.7/json/encoder.py\", line 408, in _iterencode_dict\r\n\t    for chunk in chunks:\r\n\t  File \"/usr/lib64/python2.7/json/encoder.py\", line 332, in _iterencode_list\r\n\t    for chunk in chunks:\r\n\t  File \"/usr/lib64/python2.7/json/encoder.py\", line 408, in _iterencode_dict\r\n\t    for chunk in chunks:\r\n\t  File \"/usr/lib64/python2.7/json/encoder.py\", line 390, in _iterencode_dict\r\n\t    yield _encoder(value)\r\n\texceptions.UnicodeDecodeError: 'utf8' codec can't decode byte 0x92 in position 15867: invalid start byte\r\n\r\n<img width=\"654\" alt=\"console_view_loading\" src=\"https://user-images.githubusercontent.com/3098702/28277397-b7c9fbec-6ace-11e7-90b4-abf3eb39a1bc.png\">\r\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3448/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3448/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3384", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3384/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3384/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3384/events", "html_url": "https://github.com/buildbot/buildbot/issues/3384", "id": 238718779, "node_id": "MDU6SXNzdWUyMzg3MTg3Nzk=", "number": 3384, "title": "sqlalchemy.exc.IntegrityError when setting properties", "user": {"login": "vigsterkr", "id": 30353, "node_id": "MDQ6VXNlcjMwMzUz", "avatar_url": "https://avatars.githubusercontent.com/u/30353?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vigsterkr", "html_url": "https://github.com/vigsterkr", "followers_url": "https://api.github.com/users/vigsterkr/followers", "following_url": "https://api.github.com/users/vigsterkr/following{/other_user}", "gists_url": "https://api.github.com/users/vigsterkr/gists{/gist_id}", "starred_url": "https://api.github.com/users/vigsterkr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vigsterkr/subscriptions", "organizations_url": "https://api.github.com/users/vigsterkr/orgs", "repos_url": "https://api.github.com/users/vigsterkr/repos", "events_url": "https://api.github.com/users/vigsterkr/events{/privacy}", "received_events_url": "https://api.github.com/users/vigsterkr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557406354, "node_id": "MDU6TGFiZWw1NTc0MDYzNTQ=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/database", "name": "database", "color": "bfd4f2", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-06-27T02:13:06Z", "updated_at": "2017-09-14T09:19:40Z", "closed_at": "2017-09-14T09:19:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "this is an error again that appeared when upgrading from 0.8.12 to 0.9.4.... \r\ni have couple of nightly jobs where i set various properties from the command line and then use those values to generate a new property.\r\n\r\ncurrently all these jobs fail with the following error:\r\n\r\n```\r\n2017-06-27 04:09:10+0200 [-] releaseLocks(SetPropertyFromCommand(property='DAY_TIMESTAMP', command='date +%Y%m%d%H%M', hideStepIf=True)): []\r\n2017-06-27 04:09:10+0200 [-]  step 'setproperty_2' complete: success (None)\r\n2017-06-27 04:09:10+0200 [-] Got fatal Exception on DB\r\n\tTraceback (most recent call last):\r\n\tFailure: sqlalchemy.exc.IntegrityError: (_mysql_exceptions.IntegrityError) (1062, \"Duplicate entry '259-SetProperty_1' for key 'steps_name'\") [SQL: u'INSERT INTO steps (number, name, buildid, started_at, complete_at, state_string, urls_json) VALUES (%s, %s, %s, %s, %s, %s, %s)'] [parameters: (4L, u'SetProperty_1', 259L, None, None, u'pending', '[]')]\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3384/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3384/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3382", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3382/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3382/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3382/events", "html_url": "https://github.com/buildbot/buildbot/issues/3382", "id": 238582688, "node_id": "MDU6SXNzdWUyMzg1ODI2ODg=", "number": 3382, "title": "EC2LatentWorker security_name", "user": {"login": "vigsterkr", "id": 30353, "node_id": "MDQ6VXNlcjMwMzUz", "avatar_url": "https://avatars.githubusercontent.com/u/30353?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vigsterkr", "html_url": "https://github.com/vigsterkr", "followers_url": "https://api.github.com/users/vigsterkr/followers", "following_url": "https://api.github.com/users/vigsterkr/following{/other_user}", "gists_url": "https://api.github.com/users/vigsterkr/gists{/gist_id}", "starred_url": "https://api.github.com/users/vigsterkr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vigsterkr/subscriptions", "organizations_url": "https://api.github.com/users/vigsterkr/orgs", "repos_url": "https://api.github.com/users/vigsterkr/repos", "events_url": "https://api.github.com/users/vigsterkr/events{/privacy}", "received_events_url": "https://api.github.com/users/vigsterkr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557386829, "node_id": "MDU6TGFiZWw1NTczODY4Mjk=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/latent%20worker", "name": "latent worker", "color": "bfd4f2", "default": false, "description": null}, {"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2017-06-26T15:34:21Z", "updated_at": "2017-10-31T09:48:42Z", "closed_at": "2017-10-31T09:48:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "when specifying `security_name='latent_buildbot_slave'` i'm getting the following error:\r\n\r\n```\r\nbotocore.exceptions.ClientError: An error occurred (InvalidGroupId.Malformed) when calling the DescribeSecurityGroups operation: Invalid id: \"latent_buildbot_slave\" (expecting \"sg-...\")\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3382/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3382/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3375", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3375/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3375/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3375/events", "html_url": "https://github.com/buildbot/buildbot/issues/3375", "id": 238461782, "node_id": "MDU6SXNzdWUyMzg0NjE3ODI=", "number": 3375, "title": "Exception on change.GitPoller on Windows", "user": {"login": "jacky-chuang", "id": 5125696, "node_id": "MDQ6VXNlcjUxMjU2OTY=", "avatar_url": "https://avatars.githubusercontent.com/u/5125696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jacky-chuang", "html_url": "https://github.com/jacky-chuang", "followers_url": "https://api.github.com/users/jacky-chuang/followers", "following_url": "https://api.github.com/users/jacky-chuang/following{/other_user}", "gists_url": "https://api.github.com/users/jacky-chuang/gists{/gist_id}", "starred_url": "https://api.github.com/users/jacky-chuang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jacky-chuang/subscriptions", "organizations_url": "https://api.github.com/users/jacky-chuang/orgs", "repos_url": "https://api.github.com/users/jacky-chuang/repos", "events_url": "https://api.github.com/users/jacky-chuang/events{/privacy}", "received_events_url": "https://api.github.com/users/jacky-chuang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557827489, "node_id": "MDU6TGFiZWw1NTc4Mjc0ODk=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/windows", "name": "windows", "color": "1d76db", "default": false, "description": null}, {"id": 568921941, "node_id": "MDU6TGFiZWw1Njg5MjE5NDE=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/py3", "name": "py3", "color": "0e8a16", "default": false, "description": null}, {"id": 632499035, "node_id": "MDU6TGFiZWw2MzI0OTkwMzU=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bytes", "name": "bytes", "color": "fbca04", "default": false, "description": null}, {"id": 669846634, "node_id": "MDU6TGFiZWw2Njk4NDY2MzQ=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/external_dep_bug", "name": "external_dep_bug", "color": "e99695", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2017-06-26T07:32:32Z", "updated_at": "2017-09-24T20:52:08Z", "closed_at": "2017-09-24T20:52:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI use Buildbot ( 0.9.8 ) and Twisted (==17.5.0) to run git poller. Config is below.\r\n\r\n```\r\n   c['change_source'].append(changes.GitPoller(\r\n    repourl='git@172.23.45.81:/home/git/201701_postrack_swfw_app', branch='master',pollinterval=300, pollAtLaunch=True,\r\n    gitbin=\"C:\\\\Program Files\\\\Git\\\\cmd\\\\git.exe\",\r\n    encoding=\"big5\"))\r\n```\r\n\r\n   But it always to get the following exception :\r\n  Can anybody tell what\u2019s going wrong ? thanks!\r\n\r\n  Jacky\r\n```\r\n2017-06-26 11:49:08+0800 [-] while polling for changes\r\nTraceback (most recent call last):\r\n  File \"d:\\jacky\\buildbot_virtualenv\\buildbot\\lib\\site-packages\\twisted\\internet\\defer.py\", line 459, in callback\r\n    self._startRunCallbacks(result)\r\n  File \"d:\\jacky\\buildbot_virtualenv\\buildbot\\lib\\site-packages\\twisted\\internet\\defer.py\", line 567, in _startRunCallbacks\r\n    self._runCallbacks()\r\n  File \"d:\\jacky\\buildbot_virtualenv\\buildbot\\lib\\site-packages\\twisted\\internet\\defer.py\", line 653, in _runCallbacks\r\n    current.result = callback(current.result, *args, **kw)\r\n  File \"d:\\jacky\\buildbot_virtualenv\\buildbot\\lib\\site-packages\\twisted\\internet\\defer.py\", line 1442, in gotResult\r\n    _inlineCallbacks(r, g, deferred)\r\n--- ---\r\n  File \"d:\\jacky\\buildbot_virtualenv\\buildbot\\lib\\site-packages\\twisted\\internet\\defer.py\", line 1386, in _inlineCallbacks\r\n    result = g.send(result)\r\n  File \"d:\\jacky\\buildbot_virtualenv\\buildbot\\lib\\site-packages\\buildbot\\changes\\gitpoller.py\", line 190, in poll\r\n    path=self.workdir)\r\n  File \"d:\\jacky\\buildbot_virtualenv\\buildbot\\lib\\site-packages\\buildbot\\changes\\gitpoller.py\", line 357, in _dovccmd\r\n    path=encodeArg(path), env=os.environ)\r\n  File \"d:\\jacky\\buildbot_virtualenv\\buildbot\\lib\\site-packages\\twisted\\internet\\utils.py\", line 174, in getProcessOutputAndValue\r\n    reactor)\r\n  File \"d:\\jacky\\buildbot_virtualenv\\buildbot\\lib\\site-packages\\twisted\\internet\\utils.py\", line 28, in _callProtocolWithDeferred\r\n    reactor.spawnProcess(p, executable, (executable,)+tuple(args), env, path)\r\n  File \"d:\\jacky\\buildbot_virtualenv\\buildbot\\lib\\site-packages\\twisted\\internet\\posixbase.py\", line 353, in spawnProcess\r\n    return Process(self, processProtocol, executable, args, env, path)\r\n  File \"d:\\jacky\\buildbot_virtualenv\\buildbot\\lib\\site-packages\\twisted\\internet_dumbwin32proc.py\", line 217, in init\r\n    doCreate()\r\n  File \"d:\\jacky\\buildbot_virtualenv\\buildbot\\lib\\site-packages\\twisted\\internet_dumbwin32proc.py\", line 214, in doCreate\r\n    command, cmdline, None, None, 1, flags, env, path, StartupInfo)\r\nbuiltins.TypeError: Objects of type 'bytes' can not be converted to Unicode.\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3375/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3375/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3374", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3374/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3374/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3374/events", "html_url": "https://github.com/buildbot/buildbot/issues/3374", "id": 238360031, "node_id": "MDU6SXNzdWUyMzgzNjAwMzE=", "number": 3374, "title": "GitHubAuth fails under Python 3.4", "user": {"login": "zware", "id": 6275069, "node_id": "MDQ6VXNlcjYyNzUwNjk=", "avatar_url": "https://avatars.githubusercontent.com/u/6275069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zware", "html_url": "https://github.com/zware", "followers_url": "https://api.github.com/users/zware/followers", "following_url": "https://api.github.com/users/zware/following{/other_user}", "gists_url": "https://api.github.com/users/zware/gists{/gist_id}", "starred_url": "https://api.github.com/users/zware/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zware/subscriptions", "organizations_url": "https://api.github.com/users/zware/orgs", "repos_url": "https://api.github.com/users/zware/repos", "events_url": "https://api.github.com/users/zware/events{/privacy}", "received_events_url": "https://api.github.com/users/zware/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 568921941, "node_id": "MDU6TGFiZWw1Njg5MjE5NDE=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/py3", "name": "py3", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-06-25T04:54:59Z", "updated_at": "2017-06-28T10:38:20Z", "closed_at": "2017-06-28T10:38:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Received this traceback in the log after clicking the 'Login via GitHub' link and authorizing the app:\r\n\r\n```\r\n2017-06-25 04:02:00+0000 [-] While rendering resource:\r\n        Traceback (most recent call last):\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/twisted/internet/defer.py\", line 1442, in gotResult\r\n            _inlineCallbacks(r, g, deferred)\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/twisted/internet/defer.py\", line 1432, in _inlineCallbacks\r\n            deferred.errback()\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/twisted/internet/defer.py\", line 500, in errback\r\n            self._startRunCallbacks(fail)\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/twisted/internet/defer.py\", line 567, in _startRunCallbacks\r\n            self._runCallbacks()\r\n        --- <exception caught here> ---\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/twisted/internet/defer.py\", line 653, in _runCallbacks\r\n            current.result = callback(current.result, *args, **kw)\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/buildbot/www/resource.py\", line 91, in failHttpError\r\n            f.trap(Error)\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/twisted/python/failure.py\", line 346, in trap\r\n            self.raiseException()\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/twisted/python/failure.py\", line 372, in raiseException\r\n            raise self.value.with_traceback(self.tb)\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/twisted/internet/defer.py\", line 653, in _runCallbacks\r\n            current.result = callback(current.result, *args, **kw)\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/buildbot/www/resource.py\", line 84, in failHttpRedirect\r\n            f.trap(Redirect)\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/twisted/python/failure.py\", line 346, in trap\r\n            self.raiseException()\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/twisted/python/failure.py\", line 372, in raiseException\r\n            raise self.value.with_traceback(self.tb)\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/twisted/internet/defer.py\", line 1384, in _inlineCallbacks\r\n            result = result.throwExceptionIntoGenerator(g)\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/twisted/python/failure.py\", line 393, in throwExceptionIntoGenerator\r\n            return g.throw(self.type, self.value, self.tb)\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/buildbot/www/oauth2.py\", line 55, in renderLogin\r\n            details = yield self.auth.verifyCode(code)\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/twisted/python/threadpool.py\", line 250, in inContext\r\n            result = inContext.theWork()\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/twisted/python/threadpool.py\", line 266, in <lambda>\r\n            inContext.theWork = lambda: context.call(ctx, func, *args, **kw)\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/twisted/python/context.py\", line 122, in callWithContext\r\n            return self.currentContext().callWithContext(ctx, func, *args, **kw)\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/twisted/python/context.py\", line 85, in callWithContext\r\n            return func(*args,**kw)\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/buildbot/www/oauth2.py\", line 163, in thd\r\n            session = self.createSessionFromToken(content)\r\n          File \"/data/buildbot/test-master/venv/lib/python3.4/site-packages/buildbot/www/oauth2.py\", line 119, in createSessionFromToken\r\n            s.params = {'access_token': token['access_token']}\r\n        builtins.TypeError: byte indices must be integers, not str\r\n```\r\n\r\nPython: 3.4.3 (Ubuntu 14.04 system python3; running from a venv)\r\nBuildbot: 0.9.8 (all deps latest)\r\nConfiguration: [this](https://github.com/rodrigc/buildmaster-config/blob/buildbot-nine/master/master.cfg)\r\n\r\nWorks fine (as far as I can tell; first time I've tried it) under Python 2.7.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3374/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3374/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3366", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3366/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3366/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3366/events", "html_url": "https://github.com/buildbot/buildbot/issues/3366", "id": 238256482, "node_id": "MDU6SXNzdWUyMzgyNTY0ODI=", "number": 3366, "title": "HGPoller fails with some Mercurial repositories", "user": {"login": "stevegcarpenter", "id": 14958992, "node_id": "MDQ6VXNlcjE0OTU4OTky", "avatar_url": "https://avatars.githubusercontent.com/u/14958992?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stevegcarpenter", "html_url": "https://github.com/stevegcarpenter", "followers_url": "https://api.github.com/users/stevegcarpenter/followers", "following_url": "https://api.github.com/users/stevegcarpenter/following{/other_user}", "gists_url": "https://api.github.com/users/stevegcarpenter/gists{/gist_id}", "starred_url": "https://api.github.com/users/stevegcarpenter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stevegcarpenter/subscriptions", "organizations_url": "https://api.github.com/users/stevegcarpenter/orgs", "repos_url": "https://api.github.com/users/stevegcarpenter/repos", "events_url": "https://api.github.com/users/stevegcarpenter/events{/privacy}", "received_events_url": "https://api.github.com/users/stevegcarpenter/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 632499035, "node_id": "MDU6TGFiZWw2MzI0OTkwMzU=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bytes", "name": "bytes", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-06-23T21:20:02Z", "updated_at": "2017-06-27T13:28:47Z", "closed_at": "2017-06-27T13:28:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "HGPoller crashes on some repositories when using Python3 based Buildbot. Using the same master.cfg file, Python2 based Buildbot masters don't experience the same crash. I tested this with two different Mercurial repositories on the Python3 based Buildbot and only one of those experienced the crash - I am not certain how to explain that detail, but the permissions on each repository were configured identically.\r\n\r\n[master.cfg.txt](https://github.com/buildbot/buildbot/files/1099078/master.cfg.txt)\r\n[err.txt](https://github.com/buildbot/buildbot/files/1099083/err.txt)\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3366/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3366/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3339", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3339/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3339/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3339/events", "html_url": "https://github.com/buildbot/buildbot/issues/3339", "id": 236918758, "node_id": "MDU6SXNzdWUyMzY5MTg3NTg=", "number": 3339, "title": "canStartBuild example (RemoteCommand) does not work ", "user": {"login": "nazarewk", "id": 3494992, "node_id": "MDQ6VXNlcjM0OTQ5OTI=", "avatar_url": "https://avatars.githubusercontent.com/u/3494992?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nazarewk", "html_url": "https://github.com/nazarewk", "followers_url": "https://api.github.com/users/nazarewk/followers", "following_url": "https://api.github.com/users/nazarewk/following{/other_user}", "gists_url": "https://api.github.com/users/nazarewk/gists{/gist_id}", "starred_url": "https://api.github.com/users/nazarewk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nazarewk/subscriptions", "organizations_url": "https://api.github.com/users/nazarewk/orgs", "repos_url": "https://api.github.com/users/nazarewk/repos", "events_url": "https://api.github.com/users/nazarewk/events{/privacy}", "received_events_url": "https://api.github.com/users/nazarewk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-06-19T14:55:27Z", "updated_at": "2017-06-23T00:55:12Z", "closed_at": "2017-06-23T00:55:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "`RemoteCommand` implementation has changed and `canStartBuild` [example](http://docs.buildbot.net/0.9.8/manual/customization.html#canstartbuild-functions) stopped working because `self.step is None` in [here](https://github.com/buildbot/buildbot/blob/a5237a9cc02740e474cb0b3b717ed7296889f708/master/buildbot/process/remotecommand.py#L278)", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3339/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3339/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3321", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3321/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3321/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3321/events", "html_url": "https://github.com/buildbot/buildbot/issues/3321", "id": 235853873, "node_id": "MDU6SXNzdWUyMzU4NTM4NzM=", "number": 3321, "title": "Base web hook fails with non ascii characters in payload", "user": {"login": "Frodox", "id": 3653069, "node_id": "MDQ6VXNlcjM2NTMwNjk=", "avatar_url": "https://avatars.githubusercontent.com/u/3653069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Frodox", "html_url": "https://github.com/Frodox", "followers_url": "https://api.github.com/users/Frodox/followers", "following_url": "https://api.github.com/users/Frodox/following{/other_user}", "gists_url": "https://api.github.com/users/Frodox/gists{/gist_id}", "starred_url": "https://api.github.com/users/Frodox/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Frodox/subscriptions", "organizations_url": "https://api.github.com/users/Frodox/orgs", "repos_url": "https://api.github.com/users/Frodox/repos", "events_url": "https://api.github.com/users/Frodox/events{/privacy}", "received_events_url": "https://api.github.com/users/Frodox/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557422230, "node_id": "MDU6TGFiZWw1NTc0MjIyMzA=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/webhook", "name": "webhook", "color": "bfd4f2", "default": false, "description": null}, {"id": 632499035, "node_id": "MDU6TGFiZWw2MzI0OTkwMzU=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bytes", "name": "bytes", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-06-14T11:53:03Z", "updated_at": "2017-06-28T12:10:50Z", "closed_at": "2017-06-28T12:10:50Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "buildbot-0.9.7\r\n\r\n```\r\n...buildbot-contrib/master/contrib$ ./post_build_request.py -w \"\u043f\u0440\u0438\u0432\u0435\u0442 \u043f\u0440\u0438\u0432\u0435\u0442 \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442\" -H bb-master -r kernel -P kernel -c \"\u043d\u0435 asci \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439\" -R \"test\"\r\n```\r\nand in `master/twisted.log`\r\n\r\n```\r\n2017-06-07 14:28:38+0300 [_GenericHTTPChannelProtocol,10,127.0.0.1] Attempting to load module buildbot.www.hooks.base\r\n2017-06-07 14:28:38+0300 [_GenericHTTPChannelProtocol,10,127.0.0.1] Got the following changes [{'category': None, 'codebase': None, 'repository': 'kernel', 'author': '\\xd0\\xbf\\xd1\\x80\\xd0\\xb8\\xd0\\xb2\\xd0\\xb5\\xd1\\x82 \\xd0\\xbf\\xd1\\x80\\xd0\\xb8\\xd0\\xb2\\xd0\\xb5\\xd1\\x82 \\xd0\\xbd\\xd0\\xb5 \\xd1\\x80\\xd0\\xb0\\xd0\\xb1\\xd0\\xbe\\xd1\\x82\\xd0\\xb0\\xd0\\xb5\\xd1\\x82', 'when': None, 'comments': u'\\u043d\\u0435 asci \\u043a\\u043e\\u043c\\u043c\\u0435\\u043d\\u0442\\u0430\\u0440\\u0438\\u0439', 'project': 'kernel', 'branch': None, 'revlink': None, 'properties': {}, 'files': [], 'revision': 'test'}]\r\n2017-06-07 14:28:38+0300 [_GenericHTTPChannelProtocol,10,127.0.0.1] Payload: {'project': ['kernel'], 'revision': ['test'], 'repository': ['kernel'], 'comments': ['\\xd0\\xbd\\xd0\\xb5 asci \\xd0\\xba\\xd0\\xbe\\xd0\\xbc\\xd0\\xbc\\xd0\\xb5\\xd0\\xbd\\xd1\\x82\\xd0\\xb0\\xd1\\x80\\xd0\\xb8\\xd0\\xb9'], 'author': ['\\xd0\\xbf\\xd1\\x80\\xd0\\xb8\\xd0\\xb2\\xd0\\xb5\\xd1\\x82 \\xd0\\xbf\\xd1\\x80\\xd0\\xb8\\xd0\\xb2\\xd0\\xb5\\xd1\\x82 \\xd0\\xbd\\xd0\\xb5 \\xd1\\x80\\xd0\\xb0\\xd0\\xb1\\xd0\\xbe\\xd1\\x82\\xd0\\xb0\\xd0\\xb5\\xd1\\x82']}\r\n2017-06-07 14:28:38+0300 [_GenericHTTPChannelProtocol,10,127.0.0.1] WARNING: change source is using deprecated self.master.addChange method; this method will disappear in Buildbot-1.0.0\r\n2017-06-07 14:28:38+0300 [_GenericHTTPChannelProtocol,10,127.0.0.1] adding changes from web hook\r\n        Traceback (most recent call last):\r\n          File \"/home/builder/buildbot/sandbox/lib/python2.7/site-packages/twisted/internet/defer.py\", line 1447, in unwindGenerator\r\n            return _inlineCallbacks(None, gen, Deferred())\r\n          File \"/home/builder/buildbot/sandbox/lib/python2.7/site-packages/twisted/internet/defer.py\", line 1301, in _inlineCallbacks\r\n            result = g.send(result)\r\n          File \"/home/builder/buildbot/sandbox/lib/python2.7/site-packages/buildbot/www/change_hook.py\", line 158, in submitChanges\r\n            change = yield self.master.addChange(src=src, **chdict)\r\n          File \"/home/builder/buildbot/sandbox/lib/python2.7/site-packages/twisted/internet/defer.py\", line 1447, in unwindGenerator\r\n            return _inlineCallbacks(None, gen, Deferred())\r\n        --- <exception caught here> ---\r\n          File \"/home/builder/buildbot/sandbox/lib/python2.7/site-packages/twisted/internet/defer.py\", line 1301, in _inlineCallbacks\r\n            result = g.send(result)\r\n          File \"/home/builder/buildbot/sandbox/lib/python2.7/site-packages/buildbot/master.py\", line 485, in addChange\r\n            kwargs[k] = ascii2unicode(kwargs[k])\r\n          File \"/home/builder/buildbot/sandbox/lib/python2.7/site-packages/buildbot/util/__init__.py\", line 239, in ascii2unicode\r\n            return bytes2unicode(x, encoding='ascii', errors=errors)\r\n          File \"/home/builder/buildbot/sandbox/lib/python2.7/site-packages/buildbot/util/__init__.py\", line 235, in bytes2unicode\r\n            return text_type(x, encoding, errors)\r\n        exceptions.UnicodeDecodeError: 'ascii' codec can't decode byte 0xd0 in position 0: ordinal not in range(128)\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3321/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3321/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3319", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3319/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3319/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3319/events", "html_url": "https://github.com/buildbot/buildbot/issues/3319", "id": 235823960, "node_id": "MDU6SXNzdWUyMzU4MjM5NjA=", "number": 3319, "title": "reporter.MailNotifier broken with Twisted 17.5.0", "user": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 558142871, "node_id": "MDU6TGFiZWw1NTgxNDI4NzE=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/email", "name": "email", "color": "bfd4f2", "default": false, "description": null}, {"id": 669846634, "node_id": "MDU6TGFiZWw2Njk4NDY2MzQ=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/external_dep_bug", "name": "external_dep_bug", "color": "e99695", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-06-14T09:51:30Z", "updated_at": "2017-09-24T20:52:08Z", "closed_at": "2017-09-24T20:52:08Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Fix already in twisted, but is not yet released https://github.com/twisted/twisted/pull/816\r\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3319/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3319/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3301", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3301/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3301/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3301/events", "html_url": "https://github.com/buildbot/buildbot/issues/3301", "id": 234178124, "node_id": "MDU6SXNzdWUyMzQxNzgxMjQ=", "number": 3301, "title": "Can't read non ascii charachers in logs from GitLab / Base web change hook (PY2)", "user": {"login": "Frodox", "id": 3653069, "node_id": "MDQ6VXNlcjM2NTMwNjk=", "avatar_url": "https://avatars.githubusercontent.com/u/3653069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Frodox", "html_url": "https://github.com/Frodox", "followers_url": "https://api.github.com/users/Frodox/followers", "following_url": "https://api.github.com/users/Frodox/following{/other_user}", "gists_url": "https://api.github.com/users/Frodox/gists{/gist_id}", "starred_url": "https://api.github.com/users/Frodox/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Frodox/subscriptions", "organizations_url": "https://api.github.com/users/Frodox/orgs", "repos_url": "https://api.github.com/users/Frodox/repos", "events_url": "https://api.github.com/users/Frodox/events{/privacy}", "received_events_url": "https://api.github.com/users/Frodox/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557422230, "node_id": "MDU6TGFiZWw1NTc0MjIyMzA=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/webhook", "name": "webhook", "color": "bfd4f2", "default": false, "description": null}, {"id": 632499035, "node_id": "MDU6TGFiZWw2MzI0OTkwMzU=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bytes", "name": "bytes", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-06-07T11:30:32Z", "updated_at": "2018-07-15T12:55:03Z", "closed_at": "2017-06-28T18:37:55Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "env:\r\n* distro: `CentOS 7.3`\r\n* `python-2.7.5-48.el7.x86_64`\r\n* `buildbot-0.9.7`\r\n* web hook setup\r\n```\r\nc['www'] = {\r\n        'port': 8010,\r\n        'plugins':dict(waterfall_view={}, console_view={}),\r\n        'change_hook_dialects': {\r\n            'base': True,\r\n            'gitlab' : True,\r\n        }\r\n}\r\n```\r\n\r\nI use GitLab (8.5) web hook changes and it works fine, except I can't read non acsii characters in `twisted.log`. It looks like:\r\n\r\n```\r\n2017-06-07 14:21:49+0300 [-] injected change Change(revision=u'cde4e528089b8cf2dceeaab33b32a5cabb1b90f6', who=u'\\u0418\\u0432\\u0430\\u043D\\u043E\\u0432 \\u041F\\u0451\\u0442\\u0440 <vit.ry@local>', branch=u'master', comments=u'fix: \\u043c\\u0435\\u043b\\u043a\\u0438\\u0435 \\u043a\\u043e\\u043c\\u043c\\u0435\\u043d\\u0442\\u044b \\u0438 todo\\n', when=1496834509, category=None, project=u'', repository=u'git@gitlab:ss/test.git', codebase=u'')\r\n```\r\n\r\nWell, it is completely not easy to dubug/develop. Any way to specify encoding fit gitlab-web-hook (like utf8) to use in everywhere? I'm free to test any suggestions and patches\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3301/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3301/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3215", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3215/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3215/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3215/events", "html_url": "https://github.com/buildbot/buildbot/issues/3215", "id": 229652945, "node_id": "MDU6SXNzdWUyMjk2NTI5NDU=", "number": 3215, "title": "Github status push does not process git url correctly", "user": {"login": "samvasko", "id": 2674600, "node_id": "MDQ6VXNlcjI2NzQ2MDA=", "avatar_url": "https://avatars.githubusercontent.com/u/2674600?v=4", "gravatar_id": "", "url": "https://api.github.com/users/samvasko", "html_url": "https://github.com/samvasko", "followers_url": "https://api.github.com/users/samvasko/followers", "following_url": "https://api.github.com/users/samvasko/following{/other_user}", "gists_url": "https://api.github.com/users/samvasko/gists{/gist_id}", "starred_url": "https://api.github.com/users/samvasko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/samvasko/subscriptions", "organizations_url": "https://api.github.com/users/samvasko/orgs", "repos_url": "https://api.github.com/users/samvasko/repos", "events_url": "https://api.github.com/users/samvasko/events{/privacy}", "received_events_url": "https://api.github.com/users/samvasko/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557443115, "node_id": "MDU6TGFiZWw1NTc0NDMxMTU=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/reporter", "name": "reporter", "color": "bfd4f2", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2017-05-18T12:26:39Z", "updated_at": "2021-01-03T17:40:39Z", "closed_at": "2021-01-03T17:40:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "When using URL with form `git@github.com:<org>/<repo>.git` \r\nthe github reporter sends a request to:\r\n`POST /repos/git@github.com:<org>/<repo>/statuses/<sha>`\r\nbut the actual url should be:\r\n`POST /repos/<org>/<repo>/statuses/<sha>`\r\n\r\n```\r\nBuildbot version: 0.9.7\r\nTwisted version: 17.1.0\r\n```", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3215/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3215/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3134", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3134/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3134/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3134/events", "html_url": "https://github.com/buildbot/buildbot/issues/3134", "id": 223192628, "node_id": "MDU6SXNzdWUyMjMxOTI2Mjg=", "number": 3134, "title": "Bitbucket push hook is not working: Twisted request.args dictionary is empty", "user": {"login": "thiagowfx", "id": 2840106, "node_id": "MDQ6VXNlcjI4NDAxMDY=", "avatar_url": "https://avatars.githubusercontent.com/u/2840106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thiagowfx", "html_url": "https://github.com/thiagowfx", "followers_url": "https://api.github.com/users/thiagowfx/followers", "following_url": "https://api.github.com/users/thiagowfx/following{/other_user}", "gists_url": "https://api.github.com/users/thiagowfx/gists{/gist_id}", "starred_url": "https://api.github.com/users/thiagowfx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thiagowfx/subscriptions", "organizations_url": "https://api.github.com/users/thiagowfx/orgs", "repos_url": "https://api.github.com/users/thiagowfx/repos", "events_url": "https://api.github.com/users/thiagowfx/events{/privacy}", "received_events_url": "https://api.github.com/users/thiagowfx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557422230, "node_id": "MDU6TGFiZWw1NTc0MjIyMzA=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/webhook", "name": "webhook", "color": "bfd4f2", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 33, "created_at": "2017-04-20T20:38:50Z", "updated_at": "2018-12-06T21:08:59Z", "closed_at": "2018-10-22T07:08:05Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I have set up a buildbot and a repository on Bitbucket and tried to enable its bitbucket push hook:\r\n\r\n1. In the bitbucket repo, I added the correct buildbot URL to send the hook to.\r\n2. In the buildbot master config, I added the correct parameter to c['www'] to activate the hook.\r\n\r\nHowever, it is not working. After some investigation, I see the problem is that the Twisted request.args dictionary (in `buildbot/www/hooks/bitbucket.py`) is empty.\r\n\r\nI realized that by adding a `log.msg(request.args)`. On the other hand, `request.requestHeaders` is not empty; it is set-up with the correct headers (I compared the logs with the bitbucket request in bitbucket and they match indeed).\r\n\r\nThe question is: why would the request arguments be empty? Is it an error from Twisted or from Buildbot? I even tried to send custom requests with simpler POST bodies, but in all cases `request.args` was still empty.\r\n\r\n* Python version: 2.7.6\r\n* Buildbot version: 0.9.6\r\n* Twisted version: 17.1.0", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3134/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3134/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3119", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3119/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3119/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3119/events", "html_url": "https://github.com/buildbot/buildbot/issues/3119", "id": 222154518, "node_id": "MDU6SXNzdWUyMjIxNTQ1MTg=", "number": 3119, "title": "Interlocks, infinite \"pending\"", "user": {"login": "Tramort", "id": 3002748, "node_id": "MDQ6VXNlcjMwMDI3NDg=", "avatar_url": "https://avatars.githubusercontent.com/u/3002748?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Tramort", "html_url": "https://github.com/Tramort", "followers_url": "https://api.github.com/users/Tramort/followers", "following_url": "https://api.github.com/users/Tramort/following{/other_user}", "gists_url": "https://api.github.com/users/Tramort/gists{/gist_id}", "starred_url": "https://api.github.com/users/Tramort/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Tramort/subscriptions", "organizations_url": "https://api.github.com/users/Tramort/orgs", "repos_url": "https://api.github.com/users/Tramort/repos", "events_url": "https://api.github.com/users/Tramort/events{/privacy}", "received_events_url": "https://api.github.com/users/Tramort/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 585740499, "node_id": "MDU6TGFiZWw1ODU3NDA0OTk=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/lock", "name": "lock", "color": "bfd4f2", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2017-04-17T15:24:41Z", "updated_at": "2021-01-03T17:44:26Z", "closed_at": "2021-01-03T17:44:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\nBuildbot 0.9.5 from pypi\r\nLittle code to reproduce:\r\n\r\n```\r\ntest_lock = util.WorkerLock(\"test_lock\", maxCount=1)\r\nc[\"builders\"] = []\r\n\r\nall_factory =  util.BuildFactory()\r\nfor i in range(1,4):\r\n    factory = util.BuildFactory()\r\n    factory.addStep(steps.ShellCommand(\r\n        command=[\"sleep\", str(10)], # bug\r\n        #command=[\"sleep\", str(10 + i)],  # no bug\r\n        locks=[test_lock.access(\"counting\")]\r\n    ))\r\n\r\n    c[\"builders\"].append(util.BuilderConfig(name=\"test\" + str(i), factory=factory, workernames=[\"build-worker\"]))\r\n\r\nall_factory.addStep(steps.Trigger(name=\"trigger test\", schedulerNames=[\"test_force\"]))\r\n\r\nc['schedulers'] = [schedulers.Triggerable(name=\"test_force\", builderNames=[\"test1\", \"test2\", \"test3\"]),\r\n                   schedulers.ForceScheduler(name=\"force_all\", builderNames=[\"test all\"])]\r\nc[\"builders\"].append(util.BuilderConfig(name=\"test all\", factory=all_factory, workernames=[\"build-worker\"]))\r\n\r\n```\r\nWhat to do:\r\nrun the \"test all\" builder via web-ui\r\n\r\n**What expect:**\r\nAll \"test\" builders would finish correctly one by one.\r\n\r\n**What have:**\r\nlast builder stay in infinite \"pending\" and can not be stopped.\r\n\r\nmaster twistd.log, when I try to stop via web-ui:\r\n```\r\n2017-04-17 14:52:03+0300 [_GenericHTTPChannelProtocol,11,127.0.0.1] while invoking <bound method Build.controlStopBuild of <Build test2 number:6 results:success>>\r\n\tTraceback (most recent call last):\r\n\t  File \"/home/maxim/Projects/tests_dev/buildbot/sandbox/local/lib/python2.7/site-packages/twisted/internet/defer.py\", line 1447, in unwindGenerator\r\n\t    return _inlineCallbacks(None, gen, Deferred())\r\n\t  File \"/home/maxim/Projects/tests_dev/buildbot/sandbox/local/lib/python2.7/site-packages/twisted/internet/defer.py\", line 1301, in _inlineCallbacks\r\n\t    result = g.send(result)\r\n\t  File \"/home/maxim/Projects/tests_dev/buildbot/sandbox/local/lib/python2.7/site-packages/buildbot/data/builds.py\", line 128, in actionStop\r\n\t    dict(reason=kwargs.get('reason', args.get('reason', 'no reason'))))\r\n\t  File \"/home/maxim/Projects/tests_dev/buildbot/sandbox/local/lib/python2.7/site-packages/buildbot/mq/simple.py\", line 47, in produce\r\n\t    qref.invoke(routingKey, data)\r\n\t--- <exception caught here> ---\r\n\t  File \"/home/maxim/Projects/tests_dev/buildbot/sandbox/local/lib/python2.7/site-packages/buildbot/mq/base.py\", line 55, in invoke\r\n\t    x = self.callback(routing_key, data)\r\n\t  File \"/home/maxim/Projects/tests_dev/buildbot/sandbox/local/lib/python2.7/site-packages/buildbot/process/build.py\", line 539, in controlStopBuild\r\n\t    return self.stopBuild(**params)\r\n\t  File \"/home/maxim/Projects/tests_dev/buildbot/sandbox/local/lib/python2.7/site-packages/buildbot/process/build.py\", line 555, in stopBuild\r\n\t    self.currentStep.interrupt(reason)\r\n\t  File \"/home/maxim/Projects/tests_dev/buildbot/sandbox/local/lib/python2.7/site-packages/buildbot/process/buildstep.py\", line 735, in interrupt\r\n\t    lock.stopWaitingUntilAvailable(self, access, d)\r\n\t  File \"/home/maxim/Projects/tests_dev/buildbot/sandbox/local/lib/python2.7/site-packages/buildbot/locks.py\", line 181, in stopWaitingUntilAvailable\r\n\t    assert (owner, access, d) in self.waiting\r\n\texceptions.AssertionError: \r\n```\r\n\r\n\r\n**Suggestions**\r\n\r\nbuildbot/locks.py:\r\n```\r\n    def claim(self, owner, access):\r\n        \"\"\" Claim the lock (lock must be available) \"\"\"\r\n        debuglog(\"%s claim(%s, %s)\" % (self, owner, access.mode))\r\n        assert owner is not None\r\n        assert self.isAvailable(owner, access), \"ask for isAvailable() first\"\r\n\r\n        assert isinstance(access, LockAccess)\r\n        assert access.mode in ['counting', 'exclusive']\r\n        self.waiting = [w for w in self.waiting if w[0] != owner]\r\n        self.owners.append((owner, access))\r\n        debuglog(\" %s is claimed '%s'\" % (self, access.mode))\r\n```\r\n`[w for w in self.waiting if w[0] != owner]` might remove more then one owner", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3119/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3119/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3060", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3060/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3060/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3060/events", "html_url": "https://github.com/buildbot/buildbot/issues/3060", "id": 215501055, "node_id": "MDU6SXNzdWUyMTU1MDEwNTU=", "number": 3060, "title": "console view stuck in loading animation", "user": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557915068, "node_id": "MDU6TGFiZWw1NTc5MTUwNjg=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/usability", "name": "usability", "color": "fbca04", "default": false, "description": null}, {"id": 557979200, "node_id": "MDU6TGFiZWw1NTc5NzkyMDA=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/console_view", "name": "console_view", "color": "c5def5", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-03-20T17:44:43Z", "updated_at": "2017-04-06T08:36:36Z", "closed_at": "2017-04-06T08:36:36Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "When there are no change yet in the buildbot system, the console view get stuck in the loading animation.\r\n\r\nThis is a bug that is often found by new users which trigger their first build manually.\r\n\r\nThe problem is that the data-module does not have way to detect if the list is empty or if it is not yet loaded. Need a fix in the data-module to provide this information in the collection\r\ncollection.isLoaded should be a good solution.\r\n\r\nThe thing is the problem disapear as soon as you use the change source, so it is really a one time problem. But this gives new users a bad experience, so we should fix it.", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3060/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3060/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3032", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3032/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3032/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3032/events", "html_url": "https://github.com/buildbot/buildbot/issues/3032", "id": 213297133, "node_id": "MDU6SXNzdWUyMTMyOTcxMzM=", "number": 3032, "title": "Setting timeout=None to the CopyDirectory step has no effect.", "user": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557418958, "node_id": "MDU6TGFiZWw1NTc0MTg5NTg=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/step", "name": "step", "color": "bfd4f2", "default": false, "description": null}, {"id": 557419407, "node_id": "MDU6TGFiZWw1NTc0MTk0MDc=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/easy", "name": "easy", "color": "0e8a16", "default": false, "description": null}, {"id": 798049821, "node_id": "MDU6TGFiZWw3OTgwNDk4MjE=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/good%20first%20issue", "name": "good first issue", "color": "62f794", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/buildbot/buildbot/milestones/5", "html_url": "https://github.com/buildbot/buildbot/milestone/5", "labels_url": "https://api.github.com/repos/buildbot/buildbot/milestones/5/labels", "id": 2374905, "node_id": "MDk6TWlsZXN0b25lMjM3NDkwNQ==", "number": 5, "title": "0.9.+", "description": null, "creator": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "open_issues": 108, "closed_issues": 73, "state": "closed", "created_at": "2017-03-09T16:35:26Z", "updated_at": "2021-09-05T03:17:11Z", "due_on": null, "closed_at": "2019-03-04T11:29:07Z"}, "comments": 4, "created_at": "2017-03-10T10:05:33Z", "updated_at": "2020-07-06T06:52:50Z", "closed_at": "2020-07-06T06:52:50Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This ticket is a migrated Trac ticket [3669](http://trac.buildbot.net/ticket/3669)\n\nPeople contributed to the original ticket: `benoit.allard@...`\nTicket created on: `Feb 28 2017`\nTicket last modified on: `Feb 28 2017`\n\n---\n\nAccording to the documentation, this should disable the timeout altogether.\n\nUnfortunately, the timeout value is given to the worker only if the value evaluates to 'True-ish'. The worker on its side, when not given a value uses 120sec. Making the timeout=None useless.\n\n\n---\n\n_Comment from_: @Ben\n_Date_: `Feb 28 2017`\n\nThe workaround is to use a bigger value, like 1200.\n\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3032/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3032/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3027", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3027/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3027/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3027/events", "html_url": "https://github.com/buildbot/buildbot/issues/3027", "id": 213297006, "node_id": "MDU6SXNzdWUyMTMyOTcwMDY=", "number": 3027, "title": "[Nine] HttpPushStatus fails on CheckConfig", "user": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557443115, "node_id": "MDU6TGFiZWw1NTc0NDMxMTU=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/reporter", "name": "reporter", "color": "bfd4f2", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/buildbot/buildbot/milestones/5", "html_url": "https://github.com/buildbot/buildbot/milestone/5", "labels_url": "https://api.github.com/repos/buildbot/buildbot/milestones/5/labels", "id": 2374905, "node_id": "MDk6TWlsZXN0b25lMjM3NDkwNQ==", "number": 5, "title": "0.9.+", "description": null, "creator": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "open_issues": 108, "closed_issues": 73, "state": "closed", "created_at": "2017-03-09T16:35:26Z", "updated_at": "2021-09-05T03:17:11Z", "due_on": null, "closed_at": "2019-03-04T11:29:07Z"}, "comments": 1, "created_at": "2017-03-10T10:04:59Z", "updated_at": "2018-11-04T23:44:27Z", "closed_at": "2018-11-04T23:44:27Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This ticket is a migrated Trac ticket [3625](http://trac.buildbot.net/ticket/3625)\n\nPeople contributed to the original ticket: @unknown_contributor, @tardyp\nTicket created on: `Oct 12 2016`\nTicket last modified on: `Feb 08 2017`\n\n---\n\nI've been trying to add an `[[HttpPushStatus]]` service to my buildbot but there was no way I could get it to work.\n\nUsing the very simple [from buildbot.plugins import reporters\nsp = reporters.[[HttpStatusPush]](serverUrl=\"http://example.com/submit\")\nc[[example shown in the doc|'services'].append(sp)]], I added the following lines to my master.cfg file:\n\n\n    from buildbot.plugins import reporters\n    \n    c[[= [|'services']]]\n    sp = reporters.[[HttpStatusPush]](serverUrl=\"http://localhost:16161/\")\n    c['services'].append(sp)\n\n\nThis causes the master.cfg file to fail on $ buildbot checkconfig master.cfg :\n\n\n    $ buildbot checkconfig master.cfg\n    :0: [[UserWarning]]: You do not have a working installation of the service_identity module: 'No module named service_identity'.  Please install it from <https://pypi.python.org/pypi/service_identity> and make sure all of its dependencies are satisfied.  Without the service_identity module and a recent enough pyOpenSSL to support it, Twisted can perform only rudimentary TLS client hostname verification.  Many valid certificate/hostname mappings may be rejected.\n    error while parsing config file:\n    Traceback (most recent call last):\n      File \"/Library/Python/2.7/site-packages/twisted/internet/defer.py\", line 149, in maybeDeferred\n        result = f(*args, **kw)\n      File \"/Library/Python/2.7/site-packages/buildbot/scripts/checkconfig.py\", line 57, in checkconfig\n        return _loadConfig(basedir=basedir, configFile=configFile, quiet=quiet)\n      File \"/Library/Python/2.7/site-packages/buildbot/scripts/checkconfig.py\", line 27, in _loadConfig\n        config.[[FileLoader]](basedir, configFile).loadConfig()\n      File \"/Library/Python/2.7/site-packages/buildbot/config.py\", line 161, in loadConfig\n        self.basedir, self.config[[FileName]])\n    --- <exception caught here> ---\n      File \"/Library/Python/2.7/site-packages/buildbot/config.py\", line 118, in load[[ConfigDict]]\n        exec(f, localDict)\n      File \"/Users/dgm/code/spideroak/buildbot-sandbox/master/master.cfg\", line 597, in <module>\n        sp = reporters.[[HttpStatusPush]](serverUrl=\"http://localhost:16161/\")\n      File \"/Library/Python/2.7/site-packages/buildbot/util/service.py\", line 122, in __init__\n        self.checkConfig(*args, **kwargs)\n    exceptions.[[TypeError]]: checkConfig() takes exactly 4 arguments (2 given)\n    \n    Configuration Errors:\n      error while parsing config file: checkConfig() takes exactly 4 arguments (2 given) (traceback in logfile)\n\n\nRemoving said lines allows the master.cfg file to pass checkconfig. I don't know if this is a bug in the Nine port or just a wrong documentation.\n\n\n---\n\n_Comment from_: @unknown_contributor\n_Date_: `Oct 13 2016`\n\nFurther investigating this:\n\nI managed to get things working by using:\n\n`sp = reporters.[[HttpStatusPush]](serverUrl=\"http://localhost:16161/\", user='diego', password='password')`\n\nIt seems like `user` and `password` are mandatory parameters in `[[HttpStatusPush]]`; however, the documentation is inconsistent in this regard, because the example shown does not include them.\n\n---\n_Comment from_: @tardyp\n_Date_: `Oct 18 2016`\n\nThis is a bug. user password should not be mandatory\n\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3027/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3027/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3021", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3021/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3021/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3021/events", "html_url": "https://github.com/buildbot/buildbot/issues/3021", "id": 213270634, "node_id": "MDU6SXNzdWUyMTMyNzA2MzQ=", "number": 3021, "title": "Inconsistency in foreign key when inserting entry in scheduler_changes table", "user": {"login": "mthalmei", "id": 293358, "node_id": "MDQ6VXNlcjI5MzM1OA==", "avatar_url": "https://avatars.githubusercontent.com/u/293358?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mthalmei", "html_url": "https://github.com/mthalmei", "followers_url": "https://api.github.com/users/mthalmei/followers", "following_url": "https://api.github.com/users/mthalmei/following{/other_user}", "gists_url": "https://api.github.com/users/mthalmei/gists{/gist_id}", "starred_url": "https://api.github.com/users/mthalmei/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mthalmei/subscriptions", "organizations_url": "https://api.github.com/users/mthalmei/orgs", "repos_url": "https://api.github.com/users/mthalmei/repos", "events_url": "https://api.github.com/users/mthalmei/events{/privacy}", "received_events_url": "https://api.github.com/users/mthalmei/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557428611, "node_id": "MDU6TGFiZWw1NTc0Mjg2MTE=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/scheduler", "name": "scheduler", "color": "bfd4f2", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-03-10T08:00:22Z", "updated_at": "2017-04-04T18:37:11Z", "closed_at": "2017-04-04T18:37:11Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The trac ticket http://trac.buildbot.net/ticket/3532 already adresses a problem when inserting entries into scheduler_changes table.\r\n\r\nAlthough this issue is fixed for SingleBranchScheduler it seems to be still unfixed for the Nightlyscheduler we are using and still getting the same errors.\r\n\r\nThis ticket is a migrated Trac ticket 3660", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3021/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3021/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3014", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/3014/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/3014/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/3014/events", "html_url": "https://github.com/buildbot/buildbot/issues/3014", "id": 213100111, "node_id": "MDU6SXNzdWUyMTMxMDAxMTE=", "number": 3014, "title": "Transferring Files with LocalWorker seems not working", "user": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/buildbot/buildbot/milestones/5", "html_url": "https://github.com/buildbot/buildbot/milestone/5", "labels_url": "https://api.github.com/repos/buildbot/buildbot/milestones/5/labels", "id": 2374905, "node_id": "MDk6TWlsZXN0b25lMjM3NDkwNQ==", "number": 5, "title": "0.9.+", "description": null, "creator": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "open_issues": 108, "closed_issues": 73, "state": "closed", "created_at": "2017-03-09T16:35:26Z", "updated_at": "2021-09-05T03:17:11Z", "due_on": null, "closed_at": "2019-03-04T11:29:07Z"}, "comments": 9, "created_at": "2017-03-09T16:57:04Z", "updated_at": "2018-02-02T09:12:31Z", "closed_at": "2018-02-02T09:12:31Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This ticket is a migrated Trac ticket [3628](http://trac.buildbot.net/ticket/3628)\n\nPeople contributed to the original ticket: @unknown_contributor, @sa2ajj\nTicket created on: `Oct 20 2016`\nTicket last modified on: `Oct 27 2016`\n\n---\n\nHi,\n\nI just update my buildbot to 0.9. And i convert my old Slave to [[LocalWorker]].\n\nBut now my builds are stuck during the copy process \"DirectoryUpload\" or \"!Multiple[[FileUpload]]\"\n\nI check the `twistd.log` and it looks like the first light files are copied but then the copy is stuck during a transfer of 5MB. The file has always a size of 3227648o.\n\nThanks for your help\n\n\n---\n\n\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/3014/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/3014/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/2973", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/2973/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/2973/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/2973/events", "html_url": "https://github.com/buildbot/buildbot/issues/2973", "id": 213098673, "node_id": "MDU6SXNzdWUyMTMwOTg2NzM=", "number": 2973, "title": "Gerrit reviews with length >1024 throw exceptions", "user": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557406354, "node_id": "MDU6TGFiZWw1NTc0MDYzNTQ=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/database", "name": "database", "color": "bfd4f2", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/buildbot/buildbot/milestones/5", "html_url": "https://github.com/buildbot/buildbot/milestone/5", "labels_url": "https://api.github.com/repos/buildbot/buildbot/milestones/5/labels", "id": 2374905, "node_id": "MDk6TWlsZXN0b25lMjM3NDkwNQ==", "number": 5, "title": "0.9.+", "description": null, "creator": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "open_issues": 108, "closed_issues": 73, "state": "closed", "created_at": "2017-03-09T16:35:26Z", "updated_at": "2021-09-05T03:17:11Z", "due_on": null, "closed_at": "2019-03-04T11:29:07Z"}, "comments": 1, "created_at": "2017-03-09T16:52:34Z", "updated_at": "2021-08-25T23:02:42Z", "closed_at": "2021-08-25T23:02:42Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This ticket is a migrated Trac ticket [3441](http://trac.buildbot.net/ticket/3441)\n\nPeople contributed to the original ticket: `dmitryh3@...`, @djmitche, @rutsky\nTicket created on: `Feb 05 2016`\nTicket last modified on: `Feb 14 2016`\n\n---\n\nLooks very similar to \nhttp://trac.buildbot.net/ticket/2367\n\n          File \"/home/wifi/virtualenv-buildmaster/local/lib/python2.7/site-packages/buildbot/db/base.py\", line 56, in check_length\n            % (col, col.type.length, value))\n        exceptions.[[RuntimeError]]: value for column change_properties.property_value is greater than max of 1024 characters:\n\nIt looks like that ticket did not update everything, at least not the change_properties table.\n\n\n---\n\n_Comment from_: @dustin\n_Date_: `Feb 09 2016`\n\nYes, this will require a database migration to change the column size.\n\n---\n_Comment from_: @rutsky\n_Date_: `Feb 09 2016`\n\nHm... And how is migration between eight and nine branch are synced?\n\n---\n_Comment from_: @dustin\n_Date_: `Feb 14 2016`\n\nDB migrations are not allowed in the eight branch.\n\nI don't think there will be further eight releases, but it would be OK to include a suggestion in the relnotes or documentation to modify the column size manually.\n\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/2973/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/2973/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/2961", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/2961/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/2961/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/2961/events", "html_url": "https://github.com/buildbot/buildbot/issues/2961", "id": 213098294, "node_id": "MDU6SXNzdWUyMTMwOTgyOTQ=", "number": 2961, "title": "[MOSS Project] Better handling of EC2 to avoid cost overruns", "user": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557386829, "node_id": "MDU6TGFiZWw1NTczODY4Mjk=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/latent%20worker", "name": "latent worker", "color": "bfd4f2", "default": false, "description": null}, {"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/buildbot/buildbot/milestones/5", "html_url": "https://github.com/buildbot/buildbot/milestone/5", "labels_url": "https://api.github.com/repos/buildbot/buildbot/milestones/5/labels", "id": 2374905, "node_id": "MDk6TWlsZXN0b25lMjM3NDkwNQ==", "number": 5, "title": "0.9.+", "description": null, "creator": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "open_issues": 108, "closed_issues": 73, "state": "closed", "created_at": "2017-03-09T16:35:26Z", "updated_at": "2021-09-05T03:17:11Z", "due_on": null, "closed_at": "2019-03-04T11:29:07Z"}, "comments": 2, "created_at": "2017-03-09T16:51:16Z", "updated_at": "2018-06-21T15:40:15Z", "closed_at": "2018-06-21T15:40:15Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This ticket is a migrated Trac ticket [3392](http://trac.buildbot.net/ticket/3392)\r\n\r\nPeople contributed to the original ticket: @djmitche\r\nTicket created on: `Dec 19 2015`\r\nTicket last modified on: `Jul 08 2016`\r\n\r\n---\r\n\r\nThis involves shutting down the instances, particularly when the master is stopped and/or crashes.  This will help users keep their EC2 costs contained.\r\n\r\nUsers should be able to rely on Buildbot to only spend the necesary amount on EC2 instances, without any surprises at the end of the month.  Successful completion of this project will address the known bugs below, but also provide some failsafe or monitoring mechanisms that an OSS project could use to head off any overbilling.\r\n\r\n## project scope\r\n\r\nCompleting this project will involve:\r\n\r\n* Establishing and documenting a recommended way to run Buildbot in EC2, encompassing worker configuration and startup\r\n* Providing support for shutting down an instance when it cannot connect to the master for a prolonged period (#2962) [edit: updated to reference GH issue @djmitche]\r\n* Correcting spot-instance handling so that instances are not \"lost\" by the buildbot master (#2874) [edit: updated to reference GH issue @djmitche]\r\n* Providing a failsafe method of managing EC2 instances that will reliably prevent over-provisioning and lost EC2 instances.  Proposals should outline one or more specific approaches to this problem.\r\n\r\n## bounty\r\n\r\nBounty: US$5,000 - see [[BountyProgram]]\r\n\r\n\r\n---\r\n\r\n_Comment from_: @dustin\r\n_Date_: `Dec 19 2015`\r\n\r\nThis bounty project is still under construction and additional components may be added.  We should have complete details in about a week.  The bounty amount is US$5000.\r\n\r\n---\r\n_Comment from_: @dustin\r\n_Date_: `Jul 08 2016`\r\n\r\nI've updated the bug description -- this bounty is ready for applications!\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/2961/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/2961/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/2958", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/2958/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/2958/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/2958/events", "html_url": "https://github.com/buildbot/buildbot/issues/2958", "id": 213098188, "node_id": "MDU6SXNzdWUyMTMwOTgxODg=", "number": 2958, "title": "tests fail with mock-1.3.0", "user": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557430434, "node_id": "MDU6TGFiZWw1NTc0MzA0MzQ=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/test%20improvement", "name": "test improvement", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/buildbot/buildbot/milestones/5", "html_url": "https://github.com/buildbot/buildbot/milestone/5", "labels_url": "https://api.github.com/repos/buildbot/buildbot/milestones/5/labels", "id": 2374905, "node_id": "MDk6TWlsZXN0b25lMjM3NDkwNQ==", "number": 5, "title": "0.9.+", "description": null, "creator": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "open_issues": 108, "closed_issues": 73, "state": "closed", "created_at": "2017-03-09T16:35:26Z", "updated_at": "2021-09-05T03:17:11Z", "due_on": null, "closed_at": "2019-03-04T11:29:07Z"}, "comments": 1, "created_at": "2017-03-09T16:50:57Z", "updated_at": "2017-07-08T20:50:46Z", "closed_at": "2017-07-08T20:50:45Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This ticket is a migrated Trac ticket [3378](http://trac.buildbot.net/ticket/3378)\n\nPeople contributed to the original ticket: @djmitche\nTicket created on: `Oct 29 2015`\nTicket last modified on: `Oct 29 2015`\n\n---\n\n\n    [ERROR]\n    Traceback (most recent call last):\n      File \"/home/dustin/code/buildbot/t/buildbot/sandbox/lib/python2.7/site-packages/twisted/internet/defer.py\", line 1128, in _inlineCallbacks\n        result = g.send(result)\n      File \"/home/dustin/code/buildbot/t/buildbot/master/buildbot/test/unit/test_data_builders.py\", line 226, in test__masterDeactivated\n        self.rtype.update[[BuilderList]].assert_called_with(10, [])\n      File \"/home/dustin/code/buildbot/t/buildbot/sandbox/lib/python2.7/site-packages/mock/mock.py\", line 937, in assert_called_with\n        six.raise_from([[AssertionError]](_error_message(cause)), cause)\n      File \"/home/dustin/code/buildbot/t/buildbot/sandbox/lib/python2.7/site-packages/six.py\", line 718, in raise_from\n        raise value\n    exceptions.[[AssertionError]]: Expected call: mock(10, [[    Actual call: mock(10, [|])]])\n    too many positional arguments\n    \n    buildbot.test.unit.test_data_builders.Builder.test__masterDeactivated\n    ===============================================================================\n    [ERROR]\n    Traceback (most recent call last):\n      File \"/home/dustin/code/buildbot/t/buildbot/sandbox/lib/python2.7/site-packages/twisted/internet/defer.py\", line 1128, in _inlineCallbacks\n        result = g.send(result)\n      File \"/home/dustin/code/buildbot/t/buildbot/master/buildbot/test/unit/test_reporters_mail.py\", line 400, in test_buildMessage_nominal\n        mn.find[[InterrestedUsersEmails]].assert_called_with([u'me@foo'])\n      File \"/home/dustin/code/buildbot/t/buildbot/sandbox/lib/python2.7/site-packages/mock/mock.py\", line 937, in assert_called_with\n        six.raise_from([[AssertionError]](_error_message(cause)), cause)\n      File \"/home/dustin/code/buildbot/t/buildbot/sandbox/lib/python2.7/site-packages/six.py\", line 718, in raise_from\n        raise value\n    exceptions.[[AssertionError]]: Expected call: mock([[    Actual call: mock([u'me@foo'|u'me@foo'])]])\n    too many positional arguments\n    \n    buildbot.test.unit.test_reporters_mail.[[TestMailNotifier]].test_buildMessage_nominal\n    ===============================================================================\n    [ERROR]\n    Traceback (most recent call last):\n      File \"/home/dustin/code/buildbot/t/buildbot/sandbox/lib/python2.7/site-packages/twisted/internet/defer.py\", line 1128, in _inlineCallbacks\n        result = g.send(result)\n      File \"/home/dustin/code/buildbot/t/buildbot/master/buildbot/test/unit/test_www_auth.py\", line 174, in test_render\n        self.rsrc.renderLogin.assert_called_with(mock.ANY)\n      File \"/home/dustin/code/buildbot/t/buildbot/sandbox/lib/python2.7/site-packages/mock/mock.py\", line 937, in assert_called_with\n        six.raise_from([[AssertionError]](_error_message(cause)), cause)\n      File \"/home/dustin/code/buildbot/t/buildbot/sandbox/lib/python2.7/site-packages/six.py\", line 718, in raise_from\n        raise value\n    exceptions.[[AssertionError]]: Expected call: mock(<ANY>)\n    Actual call: mock(<buildbot.test.util.www.[[FakeRequest]] object at 0x7f8b293f4850>)\n    too many positional arguments\n    \n    buildbot.test.unit.test_www_auth.[[LoginResource]].test_render\n\n\nLooks like a bug in mock?  Thankfully Travis doesn't have this version installed..\n\n\n---\n\n\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/2958/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/2958/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/2914", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/2914/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/2914/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/2914/events", "html_url": "https://github.com/buildbot/buildbot/issues/2914", "id": 213096606, "node_id": "MDU6SXNzdWUyMTMwOTY2MDY=", "number": 2914, "title": "If a latent slave spontaneously disconnects, buildbot will never try to start it.", "user": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557386829, "node_id": "MDU6TGFiZWw1NTczODY4Mjk=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/latent%20worker", "name": "latent worker", "color": "bfd4f2", "default": false, "description": null}, {"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/buildbot/buildbot/milestones/5", "html_url": "https://github.com/buildbot/buildbot/milestone/5", "labels_url": "https://api.github.com/repos/buildbot/buildbot/milestones/5/labels", "id": 2374905, "node_id": "MDk6TWlsZXN0b25lMjM3NDkwNQ==", "number": 5, "title": "0.9.+", "description": null, "creator": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "open_issues": 108, "closed_issues": 73, "state": "closed", "created_at": "2017-03-09T16:35:26Z", "updated_at": "2021-09-05T03:17:11Z", "due_on": null, "closed_at": "2019-03-04T11:29:07Z"}, "comments": 7, "created_at": "2017-03-09T16:46:05Z", "updated_at": "2018-08-01T16:17:48Z", "closed_at": "2018-08-01T12:31:26Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This ticket is a migrated Trac ticket [3170](http://trac.buildbot.net/ticket/3170)\n\nPeople contributed to the original ticket: @djmitche, @tomprince\nTicket created on: `Jan 21 2015`\nTicket last modified on: `Feb 08 2015`\n\n---\n\nIt appears this has something to do with buildbot thinking the slave is then disconnected, not latent.\n\n\n---\n\n_Comment from_: @dustin\n_Date_: `Feb 04 2015`\n\nDo you have logs or a repro recipe or something more concrete?\n\n---\n_Comment from_: @tom.prince\n_Date_: `Feb 04 2015`\n\n1. Have a buildbot with a latent slave.\n2. Trigger a build that starts the slave.\n3. Outside of buildbot, shutdown the slave, or otherwise forcibly disconnect it (destroy the VM).\n4. Trigger another build that should start the slave, and notice that the latent slave never starts.\n\nI haven't done this, but:\n5. Login via manhole, notice that the associated slavebuilder is disconnected, not `LATENT`.\n\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/2914/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/2914/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/2874", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/2874/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/2874/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/2874/events", "html_url": "https://github.com/buildbot/buildbot/issues/2874", "id": 213095155, "node_id": "MDU6SXNzdWUyMTMwOTUxNTU=", "number": 2874, "title": "Buildbot gives up on EC2 spot instance requests before EC2 does", "user": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557386829, "node_id": "MDU6TGFiZWw1NTczODY4Mjk=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/latent%20worker", "name": "latent worker", "color": "bfd4f2", "default": false, "description": null}, {"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "djmitche", "id": 28673, "node_id": "MDQ6VXNlcjI4Njcz", "avatar_url": "https://avatars.githubusercontent.com/u/28673?v=4", "gravatar_id": "", "url": "https://api.github.com/users/djmitche", "html_url": "https://github.com/djmitche", "followers_url": "https://api.github.com/users/djmitche/followers", "following_url": "https://api.github.com/users/djmitche/following{/other_user}", "gists_url": "https://api.github.com/users/djmitche/gists{/gist_id}", "starred_url": "https://api.github.com/users/djmitche/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/djmitche/subscriptions", "organizations_url": "https://api.github.com/users/djmitche/orgs", "repos_url": "https://api.github.com/users/djmitche/repos", "events_url": "https://api.github.com/users/djmitche/events{/privacy}", "received_events_url": "https://api.github.com/users/djmitche/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "djmitche", "id": 28673, "node_id": "MDQ6VXNlcjI4Njcz", "avatar_url": "https://avatars.githubusercontent.com/u/28673?v=4", "gravatar_id": "", "url": "https://api.github.com/users/djmitche", "html_url": "https://github.com/djmitche", "followers_url": "https://api.github.com/users/djmitche/followers", "following_url": "https://api.github.com/users/djmitche/following{/other_user}", "gists_url": "https://api.github.com/users/djmitche/gists{/gist_id}", "starred_url": "https://api.github.com/users/djmitche/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/djmitche/subscriptions", "organizations_url": "https://api.github.com/users/djmitche/orgs", "repos_url": "https://api.github.com/users/djmitche/repos", "events_url": "https://api.github.com/users/djmitche/events{/privacy}", "received_events_url": "https://api.github.com/users/djmitche/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/buildbot/buildbot/milestones/5", "html_url": "https://github.com/buildbot/buildbot/milestone/5", "labels_url": "https://api.github.com/repos/buildbot/buildbot/milestones/5/labels", "id": 2374905, "node_id": "MDk6TWlsZXN0b25lMjM3NDkwNQ==", "number": 5, "title": "0.9.+", "description": null, "creator": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "open_issues": 108, "closed_issues": 73, "state": "closed", "created_at": "2017-03-09T16:35:26Z", "updated_at": "2021-09-05T03:17:11Z", "due_on": null, "closed_at": "2019-03-04T11:29:07Z"}, "comments": 1, "created_at": "2017-03-09T16:41:35Z", "updated_at": "2018-01-09T17:08:24Z", "closed_at": "2018-01-09T17:08:24Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This ticket is a migrated Trac ticket [2935](http://trac.buildbot.net/ticket/2935)\n\nPeople contributed to the original ticket: @unknown_contributor, @djmitche\nTicket created on: `Oct 09 2014`\nTicket last modified on: `Dec 19 2015`\n\n---\n\nWhen Eight receives a spot request status code other than `pending-evaluation`, `pending-fulfillment`, or `fulfilled`, it concludes that the spot request has failed and gives up on it.  However, [[several status codes|http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-spot-instances-bid-status.html#spot-instances-bid-status-lifecycle]] are non-terminal, and EC2 may still fulfill the request at a later time.  Nine knows that `price-too-low` is non-terminal, and so cancels the request when giving up on it, but does not do this for other non-terminal status codes.\n\nAs a result, EC2 may launch instances that are not tracked by Buildbot.  These will remain running and costing money until the spot price exceeds the bid price, at which point EC2 will automatically terminate the instance.  To avoid this, Buildbot needs to cancel spot requests when it gives up on them.\n\n\n    2014-10-09 01:17:00-0400 [-] E[[C2LatentBuildSlave]] el6-amd64 requesting spot instance\n    2014-10-09 01:18:06-0400 [-] E[[C2LatentBuildSlave]] el6-amd64 has waited 1 minutes for spot request sir-022rlcrg\n    2014-10-09 01:18:37-0400 [-] E[[C2LatentBuildSlave]] el6-amd64 failed to fulfill spot request sir-022rlcrg with status capacity-oversubscribed\n    2014-10-09 01:18:37-0400 [-] Buildslave el6-amd64 detached from testsuite-el6-amd64\n    2014-10-09 01:18:37-0400 [-] while preparing slavebuilder:\n            Traceback (most recent call last):\n              File \"/home/buildbot/env/local/lib/python2.7/site-packages/twisted/internet/defer.py\", line 577, in _runCallbacks\n                current.result = callback(current.result, *args, **kw)\n              File \"/home/buildbot/env/local/lib/python2.7/site-packages/twisted/internet/defer.py\", line 1155, in gotResult\n                _inlineCallbacks(r, g, deferred)\n              File \"/home/buildbot/env/local/lib/python2.7/site-packages/twisted/internet/defer.py\", line 1097, in _inlineCallbacks\n                result = result.throw[[ExceptionIntoGenerator]](g)\n              File \"/home/buildbot/env/local/lib/python2.7/site-packages/twisted/python/failure.py\", line 389, in throw[[ExceptionIntoGenerator]]\n                return g.throw(self.type, self.value, self.tb)\n            --- <exception caught here> ---\n              File \"/home/buildbot/env/local/lib/python2.7/site-packages/buildbot/process/builder.py\", line 335, in _start[[BuildFor]]\n                ready = yield slavebuilder.prepare(self.builder_status, build)\n              File \"/home/buildbot/env/local/lib/python2.7/site-packages/twisted/python/threadpool.py\", line 196, in _worker\n                result = context.call(ctx, function, *args, **kwargs)\n              File \"/home/buildbot/env/local/lib/python2.7/site-packages/twisted/python/context.py\", line 118, in call[[WithContext]]\n                return self.currentContext().call[[WithContext]](ctx, func, *args, **kw)\n              File \"/home/buildbot/env/local/lib/python2.7/site-packages/twisted/python/context.py\", line 81, in call[[WithContext]]\n                return func(*args,**kw)\n              File \"/home/buildbot/env/local/lib/python2.7/site-packages/buildbot/buildslave/ec2.py\", line 364, in _request_spot_instance\n                request = self._wait_for_request(reservations[0])\n              File \"/home/buildbot/env/local/lib/python2.7/site-packages/buildbot/buildslave/ec2.py\", line 443, in _wait_for_request\n                request.id, request.status)\n            buildbot.interfaces.[[LatentBuildSlaveFailedToSubstantiate]]: (u'sir-022rlcrg', <Status: capacity-oversubscribed>)\n            \n    2014-10-09 01:18:37-0400 [-] slave <Build testsuite-el6-amd64> can't build <[[LatentSlaveBuilder]] builder='testsuite-el6-amd64'> after all; re-queueing the request\n    \n    [...]\n    \n    2014-10-09 01:32:37-0400 [Broker,32,127.0.0.1] slave 'el6-amd64' attaching from I[[Pv4Address]](TCP, '127.0.0.1', 59401)\n    2014-10-09 01:32:37-0400 [Broker,32,127.0.0.1] Slave el6-amd64 received connection while not trying to substantiate.  Disconnecting.\n\n\n\n\n---\n\n\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/2874/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/2874/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/2858", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/2858/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/2858/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/2858/events", "html_url": "https://github.com/buildbot/buildbot/issues/2858", "id": 213094553, "node_id": "MDU6SXNzdWUyMTMwOTQ1NTM=", "number": 2858, "title": "Forced build never completes", "user": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 558154265, "node_id": "MDU6TGFiZWw1NTgxNTQyNjU=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/needs%20reproducer", "name": "needs reproducer", "color": "f7c6c7", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/buildbot/buildbot/milestones/5", "html_url": "https://github.com/buildbot/buildbot/milestone/5", "labels_url": "https://api.github.com/repos/buildbot/buildbot/milestones/5/labels", "id": 2374905, "node_id": "MDk6TWlsZXN0b25lMjM3NDkwNQ==", "number": 5, "title": "0.9.+", "description": null, "creator": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "open_issues": 108, "closed_issues": 73, "state": "closed", "created_at": "2017-03-09T16:35:26Z", "updated_at": "2021-09-05T03:17:11Z", "due_on": null, "closed_at": "2019-03-04T11:29:07Z"}, "comments": 1, "created_at": "2017-03-09T16:39:46Z", "updated_at": "2017-08-04T13:37:23Z", "closed_at": "2017-08-04T13:37:23Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This ticket is a migrated Trac ticket [2813](http://trac.buildbot.net/ticket/2813)\n\nPeople contributed to the original ticket: `buildbot@...`, @djmitche\nTicket created on: `May 27 2014`\nTicket last modified on: `Jun 18 2014`\n\n---\n\nIt appears that a forced build will never complete _if_ a build is forced on a build slave with max_builds=1 and that slave is already running a build.  In the most recent case where I finally realized what might be happening, I was forcing a run of another build that runs on the same slave.\n\nThe build master appears to actually trigger the secondary build (which it shouldn't do because max_builds=1) but then ignores all output from that slave.  The slave finishes but the master ignores its results and, eventually, *all* builds will stall once that slave is scheduled for another build.  I can't guarantee that the next scheduled build is what triggers this state but the master will definitely get locked up at some point.\n\nOnce the system is in this state, the only way to fix it is to stop and restart the master.\n\n\n---\n\n_Comment from_: @dustin\n_Date_: `May 27 2014`\n\nCan you include some twistd.log output from the master to indicate what you're seeing?  I'm not sure how it could trigger a build and ignore the output..\n\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/2858/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/2858/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/buildbot/buildbot/issues/2843", "repository_url": "https://api.github.com/repos/buildbot/buildbot", "labels_url": "https://api.github.com/repos/buildbot/buildbot/issues/2843/labels{/name}", "comments_url": "https://api.github.com/repos/buildbot/buildbot/issues/2843/comments", "events_url": "https://api.github.com/repos/buildbot/buildbot/issues/2843/events", "html_url": "https://github.com/buildbot/buildbot/issues/2843", "id": 213094047, "node_id": "MDU6SXNzdWUyMTMwOTQwNDc=", "number": 2843, "title": "handle step interruption properly", "user": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 557387042, "node_id": "MDU6TGFiZWw1NTczODcwNDI=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/bug", "name": "bug", "color": "e60202", "default": true, "description": null}, {"id": 557418958, "node_id": "MDU6TGFiZWw1NTc0MTg5NTg=", "url": "https://api.github.com/repos/buildbot/buildbot/labels/step", "name": "step", "color": "bfd4f2", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/buildbot/buildbot/milestones/5", "html_url": "https://github.com/buildbot/buildbot/milestone/5", "labels_url": "https://api.github.com/repos/buildbot/buildbot/milestones/5/labels", "id": 2374905, "node_id": "MDk6TWlsZXN0b25lMjM3NDkwNQ==", "number": 5, "title": "0.9.+", "description": null, "creator": {"login": "tardyp", "id": 109859, "node_id": "MDQ6VXNlcjEwOTg1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/109859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tardyp", "html_url": "https://github.com/tardyp", "followers_url": "https://api.github.com/users/tardyp/followers", "following_url": "https://api.github.com/users/tardyp/following{/other_user}", "gists_url": "https://api.github.com/users/tardyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tardyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tardyp/subscriptions", "organizations_url": "https://api.github.com/users/tardyp/orgs", "repos_url": "https://api.github.com/users/tardyp/repos", "events_url": "https://api.github.com/users/tardyp/events{/privacy}", "received_events_url": "https://api.github.com/users/tardyp/received_events", "type": "User", "site_admin": false}, "open_issues": 108, "closed_issues": 73, "state": "closed", "created_at": "2017-03-09T16:35:26Z", "updated_at": "2021-09-05T03:17:11Z", "due_on": null, "closed_at": "2019-03-04T11:29:07Z"}, "comments": 1, "created_at": "2017-03-09T16:38:05Z", "updated_at": "2021-09-05T03:17:11Z", "closed_at": "2021-09-05T03:17:11Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This ticket is a migrated Trac ticket [2703](http://trac.buildbot.net/ticket/2703)\n\nPeople contributed to the original ticket: @djmitche, @tardyp\nTicket created on: `Feb 20 2014`\nTicket last modified on: `Feb 08 2015`\n\n---\n\nThere are some subtleties to handle step interrupts.\n\nFor shellcommands this works, but for master steps its more complex.\nespecially trigger would need special attention.\n\n\n    <tardyp> djmitche, in the case of a new style step, how are you supposed to interrupt a step?\n     tardyp converting Trigger to new style..\n    <+djmitche> tardyp: has that changed?\n    <tardyp> well if I run interrupt(), we are in the middle of run(), which would be yielding someting\n    <tardyp> old style step would just call self.finished() so can skip waiting\n    <+djmitche> interrupt will also interrupt a running command\n    <+djmitche> so this is only a problem when run() isn't executing a command\n    <tardyp> I realize that trigger's interrupt is badly written\n    <tardyp> it should cancel the requests\n    <tardyp> and stop the builds\n    <+djmitche> yes\n    <+djmitche> there should be some instructions for step authors who are not just executing commands to poll self.stopped or something like that\n    <tardyp> the first is easy, end the second need the stop rpc\n    <+djmitche> also, initiating a new command after an interrupt should immediately fail\n    <+djmitche> I don't think it necessarily should stop the triggered builds\n    <tardyp> well, we have hacks to do so, as my user were requesting this loud\n    <+djmitche> what if those requests got merged?\n    <tardyp> it make sense to release the buildfarm, when like use a single build can trigger douzens of parralel builds\n    <tardyp> the algo is to claim_cancel the buildrequests first\n    <tardyp> then if the buildrequests are claimed, get to the build status and stop it\n    <+djmitche> I suppose if we're collapsing requests instead, then if the request was collapsed, you just don't cancel a build\n    <tardyp> so I believe this works with the collapsing\n    <+djmitche> yeah\n    <tardyp> if it is callapsed then its claimed\n    <+djmitche> as long as it's via the data API I think that's OK :)\n\n\n\n---\n\n\n", "reactions": {"url": "https://api.github.com/repos/buildbot/buildbot/issues/2843/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/buildbot/buildbot/issues/2843/timeline", "performed_via_github_app": null, "state_reason": "completed"}]