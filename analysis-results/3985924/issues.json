[{"url": "https://api.github.com/repos/locustio/locust/issues/2341", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2341/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2341/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2341/events", "html_url": "https://github.com/locustio/locust/issues/2341", "id": 1684971048, "node_id": "I_kwDOABUGS85kbp4o", "number": 2341, "title": "Locust does not spawn the requested number of users", "user": {"login": "richardARPANET", "id": 38049750, "node_id": "MDQ6VXNlcjM4MDQ5NzUw", "avatar_url": "https://avatars.githubusercontent.com/u/38049750?v=4", "gravatar_id": "", "url": "https://api.github.com/users/richardARPANET", "html_url": "https://github.com/richardARPANET", "followers_url": "https://api.github.com/users/richardARPANET/followers", "following_url": "https://api.github.com/users/richardARPANET/following{/other_user}", "gists_url": "https://api.github.com/users/richardARPANET/gists{/gist_id}", "starred_url": "https://api.github.com/users/richardARPANET/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/richardARPANET/subscriptions", "organizations_url": "https://api.github.com/users/richardARPANET/orgs", "repos_url": "https://api.github.com/users/richardARPANET/repos", "events_url": "https://api.github.com/users/richardARPANET/events{/privacy}", "received_events_url": "https://api.github.com/users/richardARPANET/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-04-26T12:51:22Z", "updated_at": "2023-04-26T16:58:31Z", "closed_at": "2023-04-26T15:28:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "Number of users (peak concurrency): 10000\r\nSpawn rate: 500\r\n\r\nAs you can see below, only 2018 users are spawned, after many minutes. Why is this happening?\r\n\r\np.s. ignore failures 100%, there are no failures, this may be due to my custom class for  the User i'm using to send data over Kafka\r\n\r\nExpected:\r\n\r\n- 10,000 users spawned\r\n\r\n![image](https://user-images.githubusercontent.com/38049750/234579951-2ee5ba58-d1fe-4ed6-a94c-6d72eb8474be.png)\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2341/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2341/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2339", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2339/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2339/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2339/events", "html_url": "https://github.com/locustio/locust/issues/2339", "id": 1676112615, "node_id": "I_kwDOABUGS85j53Ln", "number": 2339, "title": "Google auth gets blocked due to gevent.monkey.patch_all", "user": {"login": "ysk24ok", "id": 3449164, "node_id": "MDQ6VXNlcjM0NDkxNjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3449164?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ysk24ok", "html_url": "https://github.com/ysk24ok", "followers_url": "https://api.github.com/users/ysk24ok/followers", "following_url": "https://api.github.com/users/ysk24ok/following{/other_user}", "gists_url": "https://api.github.com/users/ysk24ok/gists{/gist_id}", "starred_url": "https://api.github.com/users/ysk24ok/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ysk24ok/subscriptions", "organizations_url": "https://api.github.com/users/ysk24ok/orgs", "repos_url": "https://api.github.com/users/ysk24ok/repos", "events_url": "https://api.github.com/users/ysk24ok/events{/privacy}", "received_events_url": "https://api.github.com/users/ysk24ok/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-04-20T06:54:49Z", "updated_at": "2023-04-21T10:42:53Z", "closed_at": "2023-04-21T04:17:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nAs written in detail in `Steps to reproduce` section, authetication to Google is blocked due to `gevent.monkey.patch_all`.\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nLocust runs.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nLocust execution is blocked and does not proceed.\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\nI have a locustfile like this to fetch features of a single entity from Vertex AI Feature Store.\r\n\r\n```python\r\nimport logging\r\n\r\nfrom locust import User, task  # imported before `google.cloud.aiplatform`\r\nfrom google.cloud import aiplatform\r\n\r\nPROJECT: str = \"my-project\"\r\nLOCATION: str = \"my-location\"\r\nAPI_ENDPOINT: str = \"my-location-aiplatform.googleapis.com\"\r\nFEATURESTORE_ID: str = \"my-featurestore\"\r\nENTITY_TYPE_ID: str = \"entity\"\r\n\r\nlogging.basicConfig(level=logging.DEBUG)\r\n\r\n\r\nclass VertexAiFeatureStoreUser(User):\r\n\r\n    def __init__(self, *args, **kwargs):\r\n        super().__init__(*args, **kwargs)\r\n        client_options = {\"api_endpoint\": API_ENDPOINT}\r\n        self.client = aiplatform.gapic.FeaturestoreOnlineServingServiceClient(client_options=client_options)\r\n        self.entity_type = self.client.entity_type_path(PROJECT, LOCATION, FEATURESTORE_ID, ENTITY_TYPE_ID)\r\n        self.feature_ids = [\"feature1\", \"feature2\"]\r\n\r\n    @task\r\n    def read_online_feature(self):\r\n        entity_id = \"hoge\"\r\n        feature_selector = aiplatform.gapic.FeatureSelector(\r\n            id_matcher=aiplatform.gapic.IdMatcher(ids=self.feature_ids)\r\n        )\r\n        read_feature_values_request = aiplatform.gapic.ReadFeatureValuesRequest(\r\n            entity_type=self.entity_type, entity_id=entity_id, feature_selector=feature_selector\r\n        )\r\n        read_feature_values_response = self.client.read_feature_values(\r\n            request=read_feature_values_request\r\n        )\r\n        print(read_feature_values_response)\r\n```\r\n\r\nI ran locust command, but the execution was blocked and did not proceed. The feature store didn't receive any requests.\r\n\r\n```console\r\n% locust --user 1 -t 5s --headless\r\n[2023-04-20 15:33:47,017] C02F820TML85/INFO/locust.main: Run time limit set to 5 seconds\r\n[2023-04-20 15:33:47,018] C02F820TML85/INFO/locust.main: Starting Locust 2.15.1\r\nType     Name                                                                          # reqs      # fails |    Avg     Min     Max    Med |   req/s  failures/s\r\n--------|----------------------------------------------------------------------------|-------|-------------|-------|-------|-------|-------|--------|-----------\r\n--------|----------------------------------------------------------------------------|-------|-------------|-------|-------|-------|-------|--------|-----------\r\n         Aggregated                                                                         0     0(0.00%) |      0       0       0      0 |    0.00        0.00\r\n\r\n[2023-04-20 15:33:47,019] C02F820TML85/INFO/locust.runners: Ramping to 1 users at a rate of 1.00 per second\r\n[2023-04-20 15:33:47,880] C02F820TML85/INFO/locust.runners: All users spawned: {\"VertexAiFeatureStoreUser\": 1} (1 total users)\r\n```\r\n\r\nI tried commenting out locust to run the locustfile as a script.\r\n\r\n```python\r\nimport logging\r\n\r\n# from locust import User, task\r\nfrom google.cloud import aiplatform\r\n\r\nPROJECT: str = \"my-project\"\r\nLOCATION: str = \"my-location\"\r\nAPI_ENDPOINT: str = \"my-location-aiplatform.googleapis.com\"\r\nFEATURESTORE_ID: str = \"my-featurestore\"\r\nENTITY_TYPE_ID: str = \"entity\"\r\n\r\nlogging.basicConfig(level=logging.DEBUG)\r\n\r\n\r\n# class VertexAiFeatureStoreUser(User):\r\nclass VertexAiFeatureStoreUser:\r\n\r\n    def __init__(self, *args, **kwargs):\r\n        # super().__init__(*args, **kwargs)\r\n        client_options = {\"api_endpoint\": API_ENDPOINT}\r\n        self.client = aiplatform.gapic.FeaturestoreOnlineServingServiceClient(client_options=client_options)\r\n        self.entity_type = self.client.entity_type_path(PROJECT, LOCATION, FEATURESTORE_ID, ENTITY_TYPE_ID)\r\n        self.feature_ids = [\"feature1\", \"feature2\"]\r\n\r\n    # @task\r\n    def read_online_feature(self):\r\n        entity_id = \"hoge\"\r\n        feature_selector = aiplatform.gapic.FeatureSelector(\r\n            id_matcher=aiplatform.gapic.IdMatcher(ids=self.feature_ids)\r\n        )\r\n        read_feature_values_request = aiplatform.gapic.ReadFeatureValuesRequest(\r\n            entity_type=self.entity_type, entity_id=entity_id, feature_selector=feature_selector\r\n        )\r\n        read_feature_values_response = self.client.read_feature_values(\r\n            request=read_feature_values_request\r\n        )\r\n        print(read_feature_values_response)\r\n\r\nif __name__ == \"__main__\":\r\n    user = VertexAiFeatureStoreUser()\r\n    user.read_online_feature()\r\n```\r\n\r\nThen I confirmed the script worked fine.\r\n\r\n```console\r\n% python3 locustfile.py\r\nDEBUG:google.auth._default:Checking None for explicit credentials as part of auth process...\r\nDEBUG:google.auth._default:Checking Cloud SDK credentials as part of auth process...\r\nDEBUG:google.auth.transport.requests:Making request: POST https://oauth2.googleapis.com/token\r\nDEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): oauth2.googleapis.com:443\r\nDEBUG:urllib3.connectionpool:https://oauth2.googleapis.com:443 \"POST /token HTTP/1.1\" 200 None\r\nheader {\r\n  entity_type: REDACTED\r\n  feature_descriptors {\r\n    id: \"feature1\"\r\n  }\r\n  feature_descriptors {\r\n    id: \"feature2\"\r\n  }\r\n}\r\nentity_view {\r\n  REDACTED\r\n}\r\n```\r\n\r\nNext I tried adding `gevent.monkey.patch_all()` to the head of the file which is executed in `locust/__init__.py`.\r\n\r\n```py\r\nfrom gevent import monkey\r\n\r\nmonkey.patch_all()\r\n\r\nimport logging\r\n\r\n#from locust import User, task\r\nfrom google.cloud import aiplatform\r\n...\r\n```\r\n\r\nThe execution was blocked again.\r\n\r\n```console\r\n% python3 locustfile.py\r\nDEBUG:google.auth._default:Checking None for explicit credentials as part of auth process...\r\nDEBUG:google.auth._default:Checking Cloud SDK credentials as part of auth process...\r\nDEBUG:google.auth.transport.requests:Making request: POST https://oauth2.googleapis.com/token\r\n```\r\n\r\nSo I suspect the monkey patching is the root cause.\r\n\r\nAlso I confirmed that running locust against other Google Cloud products such as Bigtable failed due to the same reason.\r\n\r\n### Environment\r\n\r\n- OS: macOS Monterey 12.6.2\r\n- Python version: 3.10.2\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds) 2.15.1\r\n- Locust command line that you ran: Written above.\r\n- Locust file contents (anonymized if necessary): Written above.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2339/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2339/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2335", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2335/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2335/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2335/events", "html_url": "https://github.com/locustio/locust/issues/2335", "id": 1666366901, "node_id": "I_kwDOABUGS85jUr21", "number": 2335, "title": "parallel requests with different params", "user": {"login": "STsariuk", "id": 37350526, "node_id": "MDQ6VXNlcjM3MzUwNTI2", "avatar_url": "https://avatars.githubusercontent.com/u/37350526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/STsariuk", "html_url": "https://github.com/STsariuk", "followers_url": "https://api.github.com/users/STsariuk/followers", "following_url": "https://api.github.com/users/STsariuk/following{/other_user}", "gists_url": "https://api.github.com/users/STsariuk/gists{/gist_id}", "starred_url": "https://api.github.com/users/STsariuk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/STsariuk/subscriptions", "organizations_url": "https://api.github.com/users/STsariuk/orgs", "repos_url": "https://api.github.com/users/STsariuk/repos", "events_url": "https://api.github.com/users/STsariuk/events{/privacy}", "received_events_url": "https://api.github.com/users/STsariuk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-04-13T12:54:59Z", "updated_at": "2023-04-13T16:33:22Z", "closed_at": "2023-04-13T16:33:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, I want to execute parallel requests with different parameters. Parameters are in the list, but when I run the test it is running only with the last parameter from the list.\r\nHow I can resolve it?\r\n\r\n`from locust import task\r\nfrom gevent.pool import Group\r\n\r\n\r\nclass MyClass():\r\n    @task\r\n    def get_data(self):\r\n        pool = Group()\r\n\r\n        currency = [{'network': 'network', 'currency': 'ETH'},\r\n                    {'network': 'network', 'currency': 'BTC'}]\r\n\r\n        [pool.spawn(lambda: self.get_crypto_price(networks=i.get('network'), currency_type=i.get('currency'),\r\n                     name_param=i.get('currency'))) for i in currency]\r\n\t\tpool.join()`", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2335/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2335/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2327", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2327/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2327/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2327/events", "html_url": "https://github.com/locustio/locust/issues/2327", "id": 1637032415, "node_id": "I_kwDOABUGS85hkyHf", "number": 2327, "title": "After about 12 hours, the graph stops", "user": {"login": "Plaoo", "id": 24716454, "node_id": "MDQ6VXNlcjI0NzE2NDU0", "avatar_url": "https://avatars.githubusercontent.com/u/24716454?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Plaoo", "html_url": "https://github.com/Plaoo", "followers_url": "https://api.github.com/users/Plaoo/followers", "following_url": "https://api.github.com/users/Plaoo/following{/other_user}", "gists_url": "https://api.github.com/users/Plaoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/Plaoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Plaoo/subscriptions", "organizations_url": "https://api.github.com/users/Plaoo/orgs", "repos_url": "https://api.github.com/users/Plaoo/repos", "events_url": "https://api.github.com/users/Plaoo/events{/privacy}", "received_events_url": "https://api.github.com/users/Plaoo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2023-03-23T08:02:04Z", "updated_at": "2023-03-24T10:52:20Z", "closed_at": "2023-03-24T09:55:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nHi everyone, I would like to monitor a server for a few days, however in the last two tests I noticed that after about 12 hours the graph stops, from the logs I don't see anything, so I guess it's a problem with the web ui.\r\n\r\n![locust_stop](https://user-images.githubusercontent.com/24716454/227138539-699e1c19-5e56-4941-ae2d-bcc4ffba54d4.png)\r\n\r\nlogs\r\n```\r\n[2023-03-22 18:05:28,617] dev-server/WARNING/locust.main: System open file limit '1024' is below minimum setting '10000'.\r\nIt's not high enough for load testing, and the OS didn't allow locust to increase it by itself.\r\nSee https://github.com/locustio/locust/wiki/Installation#increasing-maximum-number-of-open-files-limit for more info.\r\n[2023-03-22 18:05:28,617] dev-server/INFO/locust.main: Starting web interface at http://0.0.0.0:8089 (accepting connections from all network interfaces)\r\n[2023-03-22 18:05:28,651] dev-server/INFO/locust.main: Starting Locust 2.15.1\r\n[2023-03-22 18:05:43,818] dev-server/INFO/locust.runners: Ramping to 5 users at a rate of 1.00 per second\r\n[2023-03-22 18:05:47,823] dev-server/INFO/locust.runners: All users spawned: {\"GetFromCircuitID\": 5} (5 total users)\r\n[2023-03-23 08:50:17,166] dev-server/INFO/locust.runners: Ramping to 5 users at a rate of 1.00 per second\r\n[2023-03-23 08:50:21,171] dev-server/INFO/locust.runners: All users spawned: {\"GetFromCircuitID\": 5} (5 total users)\r\n```\r\nYou can see from the log that there is no error or warning, the reboot was done by me\r\n### Environment\r\n\r\n- OS: \"Ubuntu\" 20.04.5 LTS (Focal Fossa)\r\n- Python version: 3.9.5\r\n- Locust version: 2.15.1\r\n- Locust command line that you ran: locust\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2327/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2327/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2310", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2310/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2310/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2310/events", "html_url": "https://github.com/locustio/locust/issues/2310", "id": 1602923490, "node_id": "I_kwDOABUGS85fiqvi", "number": 2310, "title": "FastHttpUser fails to handle gzip response", "user": {"login": "taitelman", "id": 8079496, "node_id": "MDQ6VXNlcjgwNzk0OTY=", "avatar_url": "https://avatars.githubusercontent.com/u/8079496?v=4", "gravatar_id": "", "url": "https://api.github.com/users/taitelman", "html_url": "https://github.com/taitelman", "followers_url": "https://api.github.com/users/taitelman/followers", "following_url": "https://api.github.com/users/taitelman/following{/other_user}", "gists_url": "https://api.github.com/users/taitelman/gists{/gist_id}", "starred_url": "https://api.github.com/users/taitelman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/taitelman/subscriptions", "organizations_url": "https://api.github.com/users/taitelman/orgs", "repos_url": "https://api.github.com/users/taitelman/repos", "events_url": "https://api.github.com/users/taitelman/events{/privacy}", "received_events_url": "https://api.github.com/users/taitelman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-02-28T12:01:11Z", "updated_at": "2023-03-30T01:58:20Z", "closed_at": "2023-03-30T01:58:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nLocust 2.12.1\r\n\r\nsending HTTPS DELETE command \r\n```response=client.delete(f\"/api/v3/somepath/{id}\"...)```\r\n\r\nto some web service that returns this response (HTTP 204 , no body):\r\n\r\n```\r\ncache-control: no-store,no-cache,must-revalidate,proxy-revalidate,no-cache,max-age=0,no-store  \r\ncf-cache-status: DYNAMIC  cf-ray: 8a08fe91f86691ed-FRA  \r\ncontent-encoding: gzip  \r\ncontent-security-policy: default-src 'none'  \r\ncontent-type: application/json; charset=utf-8  \r\ndate: Tue,28 Feb 2023 11:59:30 GMT  \r\nexpires: 0  \r\npragma: no-cache  \r\nstrict-transport-security: max-age=31536000; includeSubDomains; preload  \r\nsurrogate-control: no-store  \r\nvary: Accept-Encoding  \r\n```\r\nlocust print this:\r\n\r\n```\r\ndocker-compose-worker-1  |   File \"/opt/app-root/lib/locust/contrib/fasthttp.py\", line 258, in delete\r\ndocker-compose-worker-1  |     return self.request(\"DELETE\", url, **kwargs)\r\ndocker-compose-worker-1  |   File \"/opt/app-root/lib/locust/contrib/fasthttp.py\", line 233, in request\r\ndocker-compose-worker-1  |     request_meta[\"response_length\"] = len(response.content or \"\")\r\ndocker-compose-worker-1  |   File \"/opt/app-root/lib/geventhttpclient/useragent.py\", line 203, in content\r\ndocker-compose-master-1  | [2023-02-28 11:55:50,499] 7a4b89ca4cca/INFO/locust.runners: Worker 5e5ab66b262a_1dcc5647a47042499fe683a76dbcee3a (index 0) reported that it has stopped, removing from running workers\r\ndocker-compose-worker-1  |     self._cached_content = self._content()\r\ndocker-compose-worker-1  |   File \"/opt/app-root/lib/locust/contrib/fasthttp.py\", line 433, in _content\r\ndocker-compose-worker-1  |     return super()._content()\r\ndocker-compose-worker-1  |   File \"/opt/app-root/lib/geventhttpclient/useragent.py\", line 214, in _content\r\ndocker-compose-worker-1  |     ret = self.unzipped(gzip=True)\r\ndocker-compose-worker-1  |   File \"/opt/app-root/lib/geventhttpclient/useragent.py\", line 185, in unzipped\r\ndocker-compose-worker-1  |     return zlib.decompress(bodystr, 16 + zlib.MAX_WBITS)\r\ndocker-compose-worker-1  | zlib.error: Error -5 while decompressing data: incomplete or truncated stream\r\ndocker-compose-worker-1  | \r\ndocker-compose-master-1  | [2023-02-28 11:55:50,712] 7a4b89ca4cca/INFO/root: Test stopped from Master. Rep\r\n```\r\n\r\nHTTP GET and POST works well for gzip\r\n\r\n### Expected behavior\r\nDELETE `getContent()` should not throw exception\r\n\r\n### Actual behavior\r\nsee above\r\n\r\n### Steps to reproduce\r\nnot sure\r\n\r\n### Environment\r\n\r\n- OS: redhat 8+\r\n- Python version:  3.8\r\n- Locust version:  2.12.1\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2310/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2310/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2307", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2307/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2307/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2307/events", "html_url": "https://github.com/locustio/locust/issues/2307", "id": 1600198761, "node_id": "I_kwDOABUGS85fYRhp", "number": 2307, "title": "\"Download as PNG\" text gets cut off", "user": {"login": "allison-strandberg", "id": 55810428, "node_id": "MDQ6VXNlcjU1ODEwNDI4", "avatar_url": "https://avatars.githubusercontent.com/u/55810428?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allison-strandberg", "html_url": "https://github.com/allison-strandberg", "followers_url": "https://api.github.com/users/allison-strandberg/followers", "following_url": "https://api.github.com/users/allison-strandberg/following{/other_user}", "gists_url": "https://api.github.com/users/allison-strandberg/gists{/gist_id}", "starred_url": "https://api.github.com/users/allison-strandberg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allison-strandberg/subscriptions", "organizations_url": "https://api.github.com/users/allison-strandberg/orgs", "repos_url": "https://api.github.com/users/allison-strandberg/repos", "events_url": "https://api.github.com/users/allison-strandberg/events{/privacy}", "received_events_url": "https://api.github.com/users/allison-strandberg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-02-26T20:57:59Z", "updated_at": "2023-02-26T23:10:21Z", "closed_at": "2023-02-26T23:10:21Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Describe the bug\r\nWhen hovering over the download icon on a chart, text appears reading \"Download as PNG\". This text is cut off by the right edge of the chart.\r\n\r\n### Expected behavior\r\nThe full \"Download as PNG\" text should be visible.\r\n\r\n### Actual behavior\r\nThis text is cut off by the right edge of the chart.\r\n<img width=\"1440\" alt=\"Screen Shot 2023-02-26 at 2 44 36 PM\" src=\"https://user-images.githubusercontent.com/55810428/221436500-b49437f0-741e-4ed6-8613-08d30c8a81c3.png\">\r\n\r\n### Steps to reproduce\r\nAfter running a test in the Web UI, go to the Charts tab.\r\nHover over a chart's download icon in the top right.\r\n\r\n### Environment\r\n\r\n- OS: Mac OS Monterey Version 12.5\r\n- Python version: 3.9.13\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds) 2.14.1\r\n- Locust command line that you ran: `locust`\r\n- Locust file contents (anonymized if necessary):\r\n```python\r\nfrom locust import HttpUser, task\r\n\r\nclass PostmanEchoUser(HttpUser):\r\n    host = \"https://postman-echo.com\"\r\n\r\n    @task\r\n    def hello_world(self):\r\n        self.client.get(\"/get\")\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2307/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2307/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2302", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2302/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2302/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2302/events", "html_url": "https://github.com/locustio/locust/issues/2302", "id": 1595461039, "node_id": "I_kwDOABUGS85fGM2v", "number": 2302, "title": "New worker fails to connect until master restart", "user": {"login": "ykvch", "id": 6299601, "node_id": "MDQ6VXNlcjYyOTk2MDE=", "avatar_url": "https://avatars.githubusercontent.com/u/6299601?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ykvch", "html_url": "https://github.com/ykvch", "followers_url": "https://api.github.com/users/ykvch/followers", "following_url": "https://api.github.com/users/ykvch/following{/other_user}", "gists_url": "https://api.github.com/users/ykvch/gists{/gist_id}", "starred_url": "https://api.github.com/users/ykvch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ykvch/subscriptions", "organizations_url": "https://api.github.com/users/ykvch/orgs", "repos_url": "https://api.github.com/users/ykvch/repos", "events_url": "https://api.github.com/users/ykvch/events{/privacy}", "received_events_url": "https://api.github.com/users/ykvch/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-02-22T16:55:43Z", "updated_at": "2023-02-27T19:55:46Z", "closed_at": "2023-02-27T19:55:45Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Issue description\r\n---\r\n* When existing worker tries reconnecting to master occasionally an exception is shown on master host:\r\n```\r\nlocust-1  | Traceback (most recent call last):\r\nlocust-1  |   File \"src/gevent/greenlet.py\", line 908, in gevent._gevent_cgreenlet.Greenlet.run\r\nlocust-1  |   File \"/opt/venv/lib/python3.10/site-packages/locust/runners.py\", line 1090, in client_listener\r\nlocust-1  |     self.clients[msg.node_id].state = STATE_SPAWNING\r\nlocust-1  |   File \"/opt/venv/lib/python3.10/site-packages/locust/runners.py\", line 639, in __getitem__\r\nlocust-1  |     return self._worker_nodes[k]\r\nlocust-1  | KeyError: 'worker.perf.local_881aaac5d5124549a12e8ccc01c3d36b'\r\nlocust-1  | 2023-02-20T12:22:08Z <Greenlet at 0x7fa740e77f60: <bound method MasterRunner.client_listener of <locust.runners.MasterRunner object at 0x7fa740dea4a0>>> failed with KeyError\r\nlocust-1  | \r\nlocust-1  | [2023-02-20 12:22:08,909] locust.perf.local/CRITICAL/locust.runners: Unhandled exception in greenlet: <Greenlet at 0x7fa740e77f60: <bound method MasterRunner.client_listener of <locust.runners.Ma\r\nsterRunner object at 0x7fa740dea4a0>>>\r\nlocust-1  | Traceback (most recent call last):\r\nlocust-1  |   File \"src/gevent/greenlet.py\", line 908, in gevent._gevent_cgreenlet.Greenlet.run\r\nlocust-1  |   File \"/opt/venv/lib/python3.10/site-packages/locust/runners.py\", line 1090, in client_listener\r\nlocust-1  |     self.clients[msg.node_id].state = STATE_SPAWNING\r\nlocust-1  |   File \"/opt/venv/lib/python3.10/site-packages/locust/runners.py\", line 639, in __getitem__\r\nlocust-1  |     return self._worker_nodes[k]\r\nlocust-1  | KeyError: 'worker.perf.local_881aaac5d5124549a12e8ccc01c3d36b'\r\n```\r\n\r\n* After that no new workers are able to connect to master.\r\n* Master restart is required.\r\n\r\nFix proposal\r\n---\r\nrunners.py:1090:\r\n```\r\ntry:\r\n    self.clients[msg.node_id].state = STATE_SPAWNING\r\nexcept KeyError:\r\n    logger.warning(f\"Got spawning message from unknown worker {msg.node_id}. Asking worker to quit.\")\r\n    self.server.send_to_client(Message(\"quit\", None, msg.node_id))\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2302/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2302/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2300", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2300/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2300/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2300/events", "html_url": "https://github.com/locustio/locust/issues/2300", "id": 1593825780, "node_id": "I_kwDOABUGS85e_9n0", "number": 2300, "title": "Total requests per second in graph is vastly different from actual stats", "user": {"login": "ErikSchlyter", "id": 692418, "node_id": "MDQ6VXNlcjY5MjQxOA==", "avatar_url": "https://avatars.githubusercontent.com/u/692418?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ErikSchlyter", "html_url": "https://github.com/ErikSchlyter", "followers_url": "https://api.github.com/users/ErikSchlyter/followers", "following_url": "https://api.github.com/users/ErikSchlyter/following{/other_user}", "gists_url": "https://api.github.com/users/ErikSchlyter/gists{/gist_id}", "starred_url": "https://api.github.com/users/ErikSchlyter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ErikSchlyter/subscriptions", "organizations_url": "https://api.github.com/users/ErikSchlyter/orgs", "repos_url": "https://api.github.com/users/ErikSchlyter/repos", "events_url": "https://api.github.com/users/ErikSchlyter/events{/privacy}", "received_events_url": "https://api.github.com/users/ErikSchlyter/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901882, "node_id": "MDU6TGFiZWwxNjM1OTAxODgy", "url": "https://api.github.com/repos/locustio/locust/labels/wontfix", "name": "wontfix", "color": "ddcccc", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2023-02-21T17:07:58Z", "updated_at": "2023-02-22T21:31:37Z", "closed_at": "2023-02-22T20:16:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nI was monitoring a distributed load test with 24 attached workers, and the chart in the web UI showed the current load to be around 150 request/second. When collecting the logs afterwards to print them in my own gnuplot, I noticed my graphs showing around 450-500 request/second. I inspected the generated report, and the report itself states the aggregated average request/second to be 421.3, which is vastly different from what the chart is showing.\r\n\r\n### Expected behavior\r\nThe chart in the web UI should show a good approximation of the amount of request/second.\r\n\r\n### Actual behavior\r\n![total_requests_per_second_1676991856](https://user-images.githubusercontent.com/692418/220405187-f68468fb-d82e-4dd4-abdb-445332df528d.png)\r\n![Screenshot 2023-02-21 171944](https://user-images.githubusercontent.com/692418/220405220-dbbff61c-ef88-4475-adad-524fcbfa3870.png)\r\n\r\n### Steps to reproduce\r\nConduct a distributed load test from 24 attached workers, running in individual Docker containers throughout western Sweden. The actual test code was sending HTTPS POST-request towards 2 separate web services.\r\n\r\n### Environment\r\n\r\n- OS: Docker contained based on python:3.11.1-alpine3.17\r\n- Python version: 3.11.1\r\n- Locust version: 2.14.2\r\n- Locust command line that you ran: locust -f locustfiles --worker --master-host my-ssh-tunnel-proxy --master-port 5557\r\n- Locust file contents (anonymized if necessary):\r\n```python\r\nimport locust\r\n\r\n\r\nclass SoapUser(locust.FastHttpUser):\r\n    abstract = True\r\n    key_cert_file = None # needs to be set in sub-class\r\n\r\n    def __init__(self, environment):\r\n        super().__init__(environment=environment)\r\n\r\n        def _create_default_context():\r\n            context = gevent.ssl.create_default_context()\r\n            context.check_hostname = False\r\n            context.verify_mode = gevent.ssl.CERT_NONE\r\n            if not self.key_cert_file is None:\r\n                context.load_cert_chain(certfile=self.key_cert_file)\r\n            return context\r\n\r\n        self.client.client.clientpool.client_args['ssl_context_factory'] = _create_default_context\r\n\r\n    def request(self, url, action, data):\r\n        headers = {\r\n            \"ContentType\": \"application/xml\",\r\n            \"SOAPAction\": action\r\n        }\r\n        return self.client.request('POST', url=url, headers=headers, data=data, catch_response=True)\r\n\r\nclass xyz(SoapUser):\r\n    wait_time = locust.constant(1)\r\n\r\n    key_cert_file = '/mnt/secret/secret.pem' \r\n\r\n    def request(self, path, action, payload):\r\n        \"\"\"Send request and verify that we get resultCode OK in return\"\"\"\r\n        with super().request(path, action, payload) as response:\r\n            if response.status_code == 200 and not \"<resultCode>OK</resultCode>\" in response.text:\r\n                response.failure(\"Did not receive resultCode OK\")\r\n\r\n    @locust.task\r\n    def get_xyz_1(self):\r\n        self.request( path='/xyz/1', action='\"xyz\"', payload=f\"\"\" <soapenv:Envelope xyzxyzxyz>anonymized</soapenv:Envelope> \"\"\")\r\n\r\n    @locust.task\r\n    def get_xyz_2(self):\r\n        self.request( path='/xyz/2', action='\"xyz\"', payload=f\"\"\" <soapenv:Envelope xyzxyz>anonymized</soapenv:Envelope> \"\"\")\r\n```\r\n\r\nPlease let me know if there's any other detail I can contribute. I have anonymized the actual XML content in the HTTP post, but this should show the gist of it.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2300/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2300/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2296", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2296/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2296/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2296/events", "html_url": "https://github.com/locustio/locust/issues/2296", "id": 1562069488, "node_id": "I_kwDOABUGS85dG0nw", "number": 2296, "title": "Response 403 only on FastHttpUser", "user": {"login": "belinux", "id": 601149, "node_id": "MDQ6VXNlcjYwMTE0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/601149?v=4", "gravatar_id": "", "url": "https://api.github.com/users/belinux", "html_url": "https://github.com/belinux", "followers_url": "https://api.github.com/users/belinux/followers", "following_url": "https://api.github.com/users/belinux/following{/other_user}", "gists_url": "https://api.github.com/users/belinux/gists{/gist_id}", "starred_url": "https://api.github.com/users/belinux/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/belinux/subscriptions", "organizations_url": "https://api.github.com/users/belinux/orgs", "repos_url": "https://api.github.com/users/belinux/repos", "events_url": "https://api.github.com/users/belinux/events{/privacy}", "received_events_url": "https://api.github.com/users/belinux/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-01-30T09:32:27Z", "updated_at": "2023-02-08T14:20:50Z", "closed_at": "2023-02-08T14:20:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nAny request to an url under CloudFront AWS returns status code 403, but this happens only with FastHttpUser, with HttpUser the status code is 200.\r\n\r\n### Expected behavior\r\nNot status code 403 on requests to CF with FastHttpUser\r\n\r\n### Actual behavior\r\nUsing FastHttpUser, all requests to urls under CloudFront AWS returns status code 403.\r\n\r\n### Steps to reproduce\r\n- find a url behind cloudfront\r\n- setup a locustfile using FastHttpUser, it returns 403\r\n- Change the user to HttpUser, it returns 200\r\n\r\n### Environment\r\n\r\n- OS: Archlinux\r\n- Python version: 3.10.9\r\n- Locust version: 2.14.2\r\n- Locust command line that you ran: python locust.py\r\n- Locust file contents: \r\n\r\n```\r\nfrom locust import FastHttpUser, task\r\nfrom locust import run_single_user\r\n\r\n\r\nclass CloudFrontWebsiteUser(FastHttpUser):\r\n    host = 'https://www.akamai.com/fr'\r\n\r\n    @task\r\n    def index(self):\r\n        self.client.get(\r\n            url='/',\r\n            name='/',\r\n            timeout=30,\r\n            allow_redirects=False,\r\n            headers={\r\n                'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/109.0',\r\n                'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8',\r\n                'Accept-Language': 'en-US,en;q=0.5',\r\n                'Accept-Encoding': 'gzip, deflate, br',\r\n                'DNT': '1',\r\n                'Connection': 'keep-alive',\r\n                'Upgrade-Insecure-Requests': '1',\r\n                'Sec-Fetch-Dest': 'document',\r\n                'Sec-Fetch-Mode': 'navigate',\r\n                'Sec-Fetch-Site': 'none',\r\n                'Sec-Fetch-User': '?1',\r\n                'Pragma': 'no-cache',\r\n                'Cache-Control': 'no-cache'\r\n            },\r\n        )\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    run_single_user(CloudFrontWebsiteUser)\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2296/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2296/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2294", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2294/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2294/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2294/events", "html_url": "https://github.com/locustio/locust/issues/2294", "id": 1561147278, "node_id": "I_kwDOABUGS85dDTeO", "number": 2294, "title": "Locust fails to install on a Mac with dependency on Greenlet 2.0.2", "user": {"login": "mpas", "id": 139094, "node_id": "MDQ6VXNlcjEzOTA5NA==", "avatar_url": "https://avatars.githubusercontent.com/u/139094?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpas", "html_url": "https://github.com/mpas", "followers_url": "https://api.github.com/users/mpas/followers", "following_url": "https://api.github.com/users/mpas/following{/other_user}", "gists_url": "https://api.github.com/users/mpas/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpas/subscriptions", "organizations_url": "https://api.github.com/users/mpas/orgs", "repos_url": "https://api.github.com/users/mpas/repos", "events_url": "https://api.github.com/users/mpas/events{/privacy}", "received_events_url": "https://api.github.com/users/mpas/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-01-29T06:32:15Z", "updated_at": "2023-01-29T09:23:17Z", "closed_at": "2023-01-29T07:15:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nLocust fails to install on a Mac 12.6.2 (Monterey) using Poetry with dependency on greenlet-2.0.2. Results is an error `greenlet-2.0.2-cp310-cp310-macosx_11_0_x86_64.whl is not a supported wheel on this platform`.\r\n\r\nHaving a simple `pyproject.toml` and running `poetry install` on this project results in a error on `greenlet-2.0.2`.\r\nFixing greenlet to 2.0.1 solves this problem.\r\n\r\n### Expected behavior\r\nHaving a simple pyproject.toml that contains a reference to Locust:\r\n```\r\n[tool.poetry]\r\nname = \"locust-test-install\"\r\nversion = \"0.1.0\"\r\ndescription = \"\"\r\nauthors = [\"Your Name <you@example.com>\"]\r\nreadme = \"README.md\"\r\n\r\n[tool.poetry.dependencies]\r\npython = \"~3.10\"\r\nlocust = \"^2.14.2\"\r\n```\r\n\r\nRunning `poetry install` should install Locust.\r\n\r\n### Actual behavior\r\n\r\n![image](https://user-images.githubusercontent.com/139094/215310253-730f8ecd-a1e7-4eca-ab92-0d7e9a0104f2.png)\r\n\r\n\r\n### Steps to reproduce\r\n1. Install poetry\r\n2. Create `pyproject.toml` with the following content:\r\n```\r\n[tool.poetry]\r\nname = \"locust-test-install\"\r\nversion = \"0.1.0\"\r\ndescription = \"\"\r\nauthors = [\"Your Name <you@example.com>\"]\r\nreadme = \"README.md\"\r\n\r\n[tool.poetry.dependencies]\r\npython = \"~3.10\"\r\nlocust = \"^2.14.2\"\r\n```\r\n3. Run `poetry install`\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: Mac 12.6.2 (Monterey)\r\n- Python version: 3.10.2\r\n- Locust version: 12.14.2\r\n- Locust command line that you ran: NA\r\n- Locust file contents (anonymized if necessary): NA", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2294/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2294/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2292", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2292/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2292/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2292/events", "html_url": "https://github.com/locustio/locust/issues/2292", "id": 1555577856, "node_id": "I_kwDOABUGS85cuDwA", "number": 2292, "title": "Cannot run on MacBook Air M2", "user": {"login": "efmoyano", "id": 5316473, "node_id": "MDQ6VXNlcjUzMTY0NzM=", "avatar_url": "https://avatars.githubusercontent.com/u/5316473?v=4", "gravatar_id": "", "url": "https://api.github.com/users/efmoyano", "html_url": "https://github.com/efmoyano", "followers_url": "https://api.github.com/users/efmoyano/followers", "following_url": "https://api.github.com/users/efmoyano/following{/other_user}", "gists_url": "https://api.github.com/users/efmoyano/gists{/gist_id}", "starred_url": "https://api.github.com/users/efmoyano/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/efmoyano/subscriptions", "organizations_url": "https://api.github.com/users/efmoyano/orgs", "repos_url": "https://api.github.com/users/efmoyano/repos", "events_url": "https://api.github.com/users/efmoyano/events{/privacy}", "received_events_url": "https://api.github.com/users/efmoyano/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-01-24T19:52:01Z", "updated_at": "2023-02-06T02:00:53Z", "closed_at": "2023-02-06T02:00:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nJust installed locust in 2022 MacBook Air M2 and got this error\r\n`Traceback (most recent call last):\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.11/bin/locust\", line 5, in <module>\r\n    from locust.main import main\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/locust/__init__.py\", line 18, in <module>\r\n    from .contrib.fasthttp import FastHttpUser\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/locust/contrib/fasthttp.py\", line 19, in <module>\r\n    from geventhttpclient._parser import HTTPParseError\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/geventhttpclient/__init__.py\", line 5, in <module>\r\n    from geventhttpclient.client import HTTPClient\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/geventhttpclient/client.py\", line 10, in <module>\r\n    from geventhttpclient.response import HTTPConnectionClosed\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/geventhttpclient/response.py\", line 3, in <module>\r\n    from geventhttpclient._parser import HTTPResponseParser\r\nImportError: dlopen(/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/geventhttpclient/_parser.cpython-311-darwin.so, 0x0002): tried: '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/geventhttpclient/_parser.cpython-311-darwin.so' (mach-o file, but is an incompatible architecture (have 'arm64', need 'x86_64')), '/System/Volumes/Preboot/Cryptexes/OS/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/geventhttpclient/_parser.cpython-311-darwin.so' (no such file), '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/geventhttpclient/_parser.cpython-311-darwin.so' (mach-o file, but is an incompatible architecture (have 'arm64', need 'x86_64'))\r\n`\r\n\r\n### Expected behavior\r\nRun on current architecture \r\n\r\n### Actual behavior\r\nCrash\r\n\r\n### Steps to reproduce\r\nInstalled with steps from installation page\r\n`$ pip3 install locust` \r\n\r\n\r\n### Environment\r\n\r\n- OS: Ventura 13.1\r\n- Python version: 3.11.1\r\n- Locust version: latest\r\n- Locust command line that you ran: locust -V\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2292/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2292/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2287", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2287/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2287/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2287/events", "html_url": "https://github.com/locustio/locust/issues/2287", "id": 1532733708, "node_id": "I_kwDOABUGS85bW6kM", "number": 2287, "title": "90% is lower than average.", "user": {"login": "tchaton", "id": 12861981, "node_id": "MDQ6VXNlcjEyODYxOTgx", "avatar_url": "https://avatars.githubusercontent.com/u/12861981?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tchaton", "html_url": "https://github.com/tchaton", "followers_url": "https://api.github.com/users/tchaton/followers", "following_url": "https://api.github.com/users/tchaton/following{/other_user}", "gists_url": "https://api.github.com/users/tchaton/gists{/gist_id}", "starred_url": "https://api.github.com/users/tchaton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tchaton/subscriptions", "organizations_url": "https://api.github.com/users/tchaton/orgs", "repos_url": "https://api.github.com/users/tchaton/repos", "events_url": "https://api.github.com/users/tchaton/events{/privacy}", "received_events_url": "https://api.github.com/users/tchaton/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-01-13T18:22:59Z", "updated_at": "2023-01-13T18:54:24Z", "closed_at": "2023-01-13T18:53:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\nIt seems weird that 90% requests time is lower than the average time. \r\n\r\n<img width=\"888\" alt=\"Screenshot 2023-01-13 at 19 22 05\" src=\"https://user-images.githubusercontent.com/12861981/212392013-582ea8df-b5f1-4b9e-b8b9-8fa00ea85805.png\">\r\n\r\n\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version:\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds)\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2287/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2287/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2286", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2286/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2286/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2286/events", "html_url": "https://github.com/locustio/locust/issues/2286", "id": 1531645082, "node_id": "I_kwDOABUGS85bSwya", "number": 2286, "title": "use locust as a library ,but how to do config ?", "user": {"login": "chlinwei", "id": 17353718, "node_id": "MDQ6VXNlcjE3MzUzNzE4", "avatar_url": "https://avatars.githubusercontent.com/u/17353718?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chlinwei", "html_url": "https://github.com/chlinwei", "followers_url": "https://api.github.com/users/chlinwei/followers", "following_url": "https://api.github.com/users/chlinwei/following{/other_user}", "gists_url": "https://api.github.com/users/chlinwei/gists{/gist_id}", "starred_url": "https://api.github.com/users/chlinwei/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chlinwei/subscriptions", "organizations_url": "https://api.github.com/users/chlinwei/orgs", "repos_url": "https://api.github.com/users/chlinwei/repos", "events_url": "https://api.github.com/users/chlinwei/events{/privacy}", "received_events_url": "https://api.github.com/users/chlinwei/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-01-13T03:14:19Z", "updated_at": "2023-03-30T01:58:25Z", "closed_at": "2023-03-30T01:58:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "In the beginning, I want to package the locust app with my own code , this is my code like this \r\n\r\n\r\n```\r\nimport sys\r\nif __name__ == \"__main__\":\r\n    import os\r\n    args = ' '.join(sys.argv[1:])\r\n    os.system(\"locust %s\" %(args))\r\n```\r\nso I can execute it  with the command 'python main.py -f xxx.py ', then I use the pyinstaller to package my code.\r\nI use the command 'pyinstaller main.py', but it doesn't work, then I  use the locust as lib to do my work  , I can use the \r\npyinstaller  to package my code properly,  but I don't know how to do the setting about the locust, the locust.conf is not \r\nworking anymore. I try use the environment variable , but is still not working.\r\nI just want to config the locust  when I use the locust as a lib.\r\n\r\n```\r\nos.environ[\"LOCUST_USERS\"] = \"2\"\r\nos.environ[\"LOCUST_HOST\"] = \"http://localhost:8888\"\r\nenv = Environment(user_classes=[NativeApp,Test],events=events)\r\n# runner = env.create_local_runner()\r\nrunner = env.create_master_runner(\"*\",5557)\r\n```\r\n\r\n\r\nI find a another way to do it ,like below . In this way , I can use the locust.conf to do some setting. but some config is working ,some is not working . \r\n\r\n```\r\nparse = locust.argument_parser.get_parser()\r\np = parse.parse_args()\r\nenv = Environment(user_classes=[NativeApp,Test],parsed_options=p,events=events)\r\n```\r\n\r\nlocust.conf:\r\nhost = https://10.25.66.181\r\n**users = 5**\r\n**spawn-rate = 1**\r\ncsv = result\r\nclass-picker = true\r\n\r\n\r\nThe bold  text is working ,another is not working .\r\nI am a little bit confusing .\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2286/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2286/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2283", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2283/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2283/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2283/events", "html_url": "https://github.com/locustio/locust/issues/2283", "id": 1521623484, "node_id": "I_kwDOABUGS85asiG8", "number": 2283, "title": "PyPI Link on Locust Homepage Points to Old Version", "user": {"login": "egauk", "id": 66831578, "node_id": "MDQ6VXNlcjY2ODMxNTc4", "avatar_url": "https://avatars.githubusercontent.com/u/66831578?v=4", "gravatar_id": "", "url": "https://api.github.com/users/egauk", "html_url": "https://github.com/egauk", "followers_url": "https://api.github.com/users/egauk/followers", "following_url": "https://api.github.com/users/egauk/following{/other_user}", "gists_url": "https://api.github.com/users/egauk/gists{/gist_id}", "starred_url": "https://api.github.com/users/egauk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/egauk/subscriptions", "organizations_url": "https://api.github.com/users/egauk/orgs", "repos_url": "https://api.github.com/users/egauk/repos", "events_url": "https://api.github.com/users/egauk/events{/privacy}", "received_events_url": "https://api.github.com/users/egauk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 4880157816, "node_id": "LA_kwDOABUGS88AAAABIuFMeA", "url": "https://api.github.com/repos/locustio/locust/labels/no-changelog", "name": "no-changelog", "color": "dddddd", "default": false, "description": "If set, the issue won't show up in the Changelog"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-01-05T23:39:57Z", "updated_at": "2023-01-07T10:24:50Z", "closed_at": "2023-01-07T10:24:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nLocust.io homepage PyPI link is incorrect/outdated\r\n\r\n### Expected behavior\r\nLink should point to https://pypi.org/project/locust/ and old listing should be removed from PyPI\r\n\r\n### Actual behavior\r\nLink points to https://pypi.python.org/pypi/locustio and shows that locustio 0.999 is the latest version\r\n\r\n### Steps to reproduce\r\n\r\n1. Browse to https://locust.io\r\n2. Scroll to bottom of page (Installation section) and click the PyPI link\r\n\r\n### Environment\r\nn/a", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2283/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2283/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2282", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2282/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2282/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2282/events", "html_url": "https://github.com/locustio/locust/issues/2282", "id": 1517560906, "node_id": "I_kwDOABUGS85adCRK", "number": 2282, "title": "2.14.1 release missing py.typed file", "user": {"login": "alicederyn", "id": 979369, "node_id": "MDQ6VXNlcjk3OTM2OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/979369?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alicederyn", "html_url": "https://github.com/alicederyn", "followers_url": "https://api.github.com/users/alicederyn/followers", "following_url": "https://api.github.com/users/alicederyn/following{/other_user}", "gists_url": "https://api.github.com/users/alicederyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/alicederyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alicederyn/subscriptions", "organizations_url": "https://api.github.com/users/alicederyn/orgs", "repos_url": "https://api.github.com/users/alicederyn/repos", "events_url": "https://api.github.com/users/alicederyn/events{/privacy}", "received_events_url": "https://api.github.com/users/alicederyn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2023-01-03T15:34:21Z", "updated_at": "2023-01-04T12:20:23Z", "closed_at": "2023-01-04T10:23:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nmypy is complaining that locust 2.14.1 is \"missing library stubs or py.typed marker\". I checked and, indeed, the `py.typed` file is in 2.14.0 but not 2.14.1.\r\n\r\n### Expected behavior\r\nWheel contains `locust/py.typed`\r\n\r\n### Actual behavior\r\nWheel does not contain `locust/py.typed`\r\n\r\n### Steps to reproduce\r\n```bash\r\n$ python -m venv venv\r\n$ . venv/bin/activate\r\n$ python -m pip install locust==2.14.0\r\n$ ls venv/lib/python3.*/site-packages/locust/py.typed\r\nvenv/.../py.typed\r\n$ python -m pip install locust==2.14.1\r\n$ ls venv/lib/python3.*/site-packages/locust/py.typed\r\nls: cannot access 'venv/.../py.typed': No such file or directory\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2282/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2282/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2280", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2280/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2280/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2280/events", "html_url": "https://github.com/locustio/locust/issues/2280", "id": 1509164974, "node_id": "I_kwDOABUGS85Z9Aeu", "number": 2280, "title": "when I put a directory in the LOCUST_LOCUSTFILE environment variable, the shape class is read in duplicate.", "user": {"login": "lgs6813", "id": 48649100, "node_id": "MDQ6VXNlcjQ4NjQ5MTAw", "avatar_url": "https://avatars.githubusercontent.com/u/48649100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lgs6813", "html_url": "https://github.com/lgs6813", "followers_url": "https://api.github.com/users/lgs6813/followers", "following_url": "https://api.github.com/users/lgs6813/following{/other_user}", "gists_url": "https://api.github.com/users/lgs6813/gists{/gist_id}", "starred_url": "https://api.github.com/users/lgs6813/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lgs6813/subscriptions", "organizations_url": "https://api.github.com/users/lgs6813/orgs", "repos_url": "https://api.github.com/users/lgs6813/repos", "events_url": "https://api.github.com/users/lgs6813/events{/privacy}", "received_events_url": "https://api.github.com/users/lgs6813/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-12-23T10:22:54Z", "updated_at": "2023-01-22T02:03:28Z", "closed_at": "2023-01-22T02:03:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nWhen I put a directory in the LOCUST_LOCUSTFILE environment variable, the shape class is read in duplicate.\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nRead Shape Class properly. \r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\noutputs \"Duplicate shape classes: xxx\" log.\r\nhttps://github.com/locustio/locust/blob/7591ed233a25687c3e7b1d386da86f0334cff90a/locust/main.py#L74\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\nI don't know why but There is nothing wrong with listing the files.(Like LOCUST_LOCUSTFILE: test1.py, test2.py..)\r\n\r\n\r\n### Environment\r\n\r\n- OS: Linux\r\n- Python version: locustio/locust latest docker version\r\n- Locust version: 2.14.0", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2280/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2280/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2279", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2279/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2279/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2279/events", "html_url": "https://github.com/locustio/locust/issues/2279", "id": 1508805328, "node_id": "I_kwDOABUGS85Z7orQ", "number": 2279, "title": "SetuptoolsDeprecationWarning when building with setuptools/65.5.0", "user": {"login": "sandrotosi", "id": 346648, "node_id": "MDQ6VXNlcjM0NjY0OA==", "avatar_url": "https://avatars.githubusercontent.com/u/346648?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sandrotosi", "html_url": "https://github.com/sandrotosi", "followers_url": "https://api.github.com/users/sandrotosi/followers", "following_url": "https://api.github.com/users/sandrotosi/following{/other_user}", "gists_url": "https://api.github.com/users/sandrotosi/gists{/gist_id}", "starred_url": "https://api.github.com/users/sandrotosi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sandrotosi/subscriptions", "organizations_url": "https://api.github.com/users/sandrotosi/orgs", "repos_url": "https://api.github.com/users/sandrotosi/repos", "events_url": "https://api.github.com/users/sandrotosi/events{/privacy}", "received_events_url": "https://api.github.com/users/sandrotosi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-12-23T02:46:00Z", "updated_at": "2022-12-23T13:08:22Z", "closed_at": "2022-12-23T13:08:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nSetuptoolsDeprecationWarning are displayed when building with setuptools/65.5.0\r\n\r\n### Expected behavior\r\nno warnings are displayed\r\n\r\n### Actual behavior\r\n```\r\n...\r\nrunning install_scripts\r\nInstalling locust script to /build/locust-2.12.1/debian/python3-locust/usr/bin\r\nI: pybuild base:240: /usr/bin/python3 setup.py install --root /build/locust-2.12.1/debian/python3-locust \r\n/usr/lib/python3/dist-packages/setuptools/config/setupcfg.py:508: SetuptoolsDeprecationWarning: The license_file parameter is deprecated, use license_files instead.\r\n  warnings.warn(msg, warning_class)\r\nrunning install\r\n/usr/lib/python3/dist-packages/setuptools/command/install.py:34: SetuptoolsDeprecationWarning: setup.py install is deprecated. Use build and pip and other standards-based tools.\r\n  warnings.warn(\r\nrunning build\r\nrunning build_py\r\nrunning egg_info\r\nwriting locust.egg-info/PKG-INFO\r\nwriting dependency_links to locust.egg-info/dependency_links.txt\r\nwriting entry points to locust.egg-info/entry_points.txt\r\nwriting requirements to locust.egg-info/requires.txt\r\nwriting top-level names to locust.egg-info/top_level.txt\r\nreading manifest file 'locust.egg-info/SOURCES.txt'\r\nreading manifest template 'MANIFEST.in'\r\nadding license file 'LICENSE'\r\nwriting manifest file 'locust.egg-info/SOURCES.txt'\r\n/usr/lib/python3/dist-packages/setuptools/command/build_py.py:202: SetuptoolsDeprecationWarning:     Installing 'locust.static' as data is deprecated, please list it in `packages`.\r\n    !!\r\n\r\n\r\n    ############################\r\n    # Package would be ignored #\r\n    ############################\r\n    Python recognizes 'locust.static' as an importable package,\r\n    but it is not listed in the `packages` configuration of setuptools.\r\n\r\n    'locust.static' has been automatically added to the distribution only\r\n    because it may contain data files, but this behavior is likely to change\r\n    in future versions of setuptools (and therefore is considered deprecated).\r\n\r\n    Please make sure that 'locust.static' is included as a package by using\r\n    the `packages` configuration field or the proper discovery methods\r\n    (for example by using `find_namespace_packages(...)`/`find_namespace:`\r\n    instead of `find_packages(...)`/`find:`).\r\n\r\n    You can read more about \"package discovery\" and \"data files\" on setuptools\r\n    documentation page.\r\n\r\n\r\n!!\r\n\r\n  check.warn(importable)\r\n/usr/lib/python3/dist-packages/setuptools/command/build_py.py:202: SetuptoolsDeprecationWarning:     Installing 'locust.static.css' as data is deprecated, please list it in `packages`.\r\n    !!\r\n\r\n\r\n    ############################\r\n    # Package would be ignored #\r\n    ############################\r\n    Python recognizes 'locust.static.css' as an importable package,\r\n    but it is not listed in the `packages` configuration of setuptools.\r\n\r\n    'locust.static.css' has been automatically added to the distribution only\r\n    because it may contain data files, but this behavior is likely to change\r\n    in future versions of setuptools (and therefore is considered deprecated).\r\n\r\n    Please make sure that 'locust.static.css' is included as a package by using\r\n    the `packages` configuration field or the proper discovery methods\r\n    (for example by using `find_namespace_packages(...)`/`find_namespace:`\r\n    instead of `find_packages(...)`/`find:`).\r\n\r\n    You can read more about \"package discovery\" and \"data files\" on setuptools\r\n    documentation page.\r\n\r\n\r\n!!\r\n\r\n  check.warn(importable)\r\n/usr/lib/python3/dist-packages/setuptools/command/build_py.py:202: SetuptoolsDeprecationWarning:     Installing 'locust.static.img' as data is deprecated, please list it in `packages`.\r\n    !!\r\n\r\n\r\n    ############################\r\n    # Package would be ignored #\r\n    ############################\r\n    Python recognizes 'locust.static.img' as an importable package,\r\n    but it is not listed in the `packages` configuration of setuptools.\r\n\r\n    'locust.static.img' has been automatically added to the distribution only\r\n    because it may contain data files, but this behavior is likely to change\r\n    in future versions of setuptools (and therefore is considered deprecated).\r\n\r\n    Please make sure that 'locust.static.img' is included as a package by using\r\n    the `packages` configuration field or the proper discovery methods\r\n    (for example by using `find_namespace_packages(...)`/`find_namespace:`\r\n    instead of `find_packages(...)`/`find:`).\r\n\r\n    You can read more about \"package discovery\" and \"data files\" on setuptools\r\n    documentation page.\r\n\r\n\r\n!!\r\n\r\n  check.warn(importable)\r\n/usr/lib/python3/dist-packages/setuptools/command/build_py.py:202: SetuptoolsDeprecationWarning:     Installing 'locust.static.sass' as data is deprecated, please list it in `packages`.\r\n    !!\r\n\r\n\r\n    ############################\r\n    # Package would be ignored #\r\n    ############################\r\n    Python recognizes 'locust.static.sass' as an importable package,\r\n    but it is not listed in the `packages` configuration of setuptools.\r\n\r\n    'locust.static.sass' has been automatically added to the distribution only\r\n    because it may contain data files, but this behavior is likely to change\r\n    in future versions of setuptools (and therefore is considered deprecated).\r\n\r\n    Please make sure that 'locust.static.sass' is included as a package by using\r\n    the `packages` configuration field or the proper discovery methods\r\n    (for example by using `find_namespace_packages(...)`/`find_namespace:`\r\n    instead of `find_packages(...)`/`find:`).\r\n\r\n    You can read more about \"package discovery\" and \"data files\" on setuptools\r\n    documentation page.\r\n\r\n\r\n!!\r\n\r\n  check.warn(importable)\r\n/usr/lib/python3/dist-packages/setuptools/command/build_py.py:202: SetuptoolsDeprecationWarning:     Installing 'locust.templates' as data is deprecated, please list it in `packages`.\r\n    !!\r\n\r\n\r\n    ############################\r\n    # Package would be ignored #\r\n    ############################\r\n    Python recognizes 'locust.templates' as an importable package,\r\n    but it is not listed in the `packages` configuration of setuptools.\r\n\r\n    'locust.templates' has been automatically added to the distribution only\r\n    because it may contain data files, but this behavior is likely to change\r\n    in future versions of setuptools (and therefore is considered deprecated).\r\n\r\n    Please make sure that 'locust.templates' is included as a package by using\r\n    the `packages` configuration field or the proper discovery methods\r\n    (for example by using `find_namespace_packages(...)`/`find_namespace:`\r\n    instead of `find_packages(...)`/`find:`).\r\n\r\n    You can read more about \"package discovery\" and \"data files\" on setuptools\r\n    documentation page.\r\n\r\n\r\n!!\r\n\r\n  check.warn(importable)\r\nrunning install_lib\r\n...\r\n```\r\n\r\n### Steps to reproduce\r\nrun and `setup.py` command\r\n\r\n### Environment\r\n\r\n- OS: debian unstable\r\n- Python version: 3.10 and 3.11\r\n- Locust version: 2.12.1\r\n- Locust command line that you ran: N/A\r\n- Locust file contents (anonymized if necessary): N/A", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2279/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2279/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2277", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2277/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2277/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2277/events", "html_url": "https://github.com/locustio/locust/issues/2277", "id": 1504348601, "node_id": "I_kwDOABUGS85Zqom5", "number": 2277, "title": "Error installing locust using pipenv as a --", "user": {"login": "vijayverma2003", "id": 75606993, "node_id": "MDQ6VXNlcjc1NjA2OTkz", "avatar_url": "https://avatars.githubusercontent.com/u/75606993?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vijayverma2003", "html_url": "https://github.com/vijayverma2003", "followers_url": "https://api.github.com/users/vijayverma2003/followers", "following_url": "https://api.github.com/users/vijayverma2003/following{/other_user}", "gists_url": "https://api.github.com/users/vijayverma2003/gists{/gist_id}", "starred_url": "https://api.github.com/users/vijayverma2003/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vijayverma2003/subscriptions", "organizations_url": "https://api.github.com/users/vijayverma2003/orgs", "repos_url": "https://api.github.com/users/vijayverma2003/repos", "events_url": "https://api.github.com/users/vijayverma2003/events{/privacy}", "received_events_url": "https://api.github.com/users/vijayverma2003/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-12-20T10:42:26Z", "updated_at": "2022-12-21T08:11:48Z", "closed_at": "2022-12-21T07:46:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "Installing locust...\r\n\u2819 Installing locust...[31m[1mError: [0m An error occurred while installing [32mlocust[0m!\r\nError text: Collecting locust\r\n  Using cached locust-2.14.0-py3-none-any.whl (825 kB)\r\nCollecting ConfigArgParse>=1.0\r\n  Using cached ConfigArgParse-1.5.3-py3-none-any.whl (20 kB)\r\nCollecting flask>=2.0.0\r\n  Using cached Flask-2.2.2-py3-none-any.whl (101 kB)\r\nCollecting pyzmq!=23.0.0,>=22.2.1\r\n  Using cached pyzmq-24.0.1-cp310-cp310-macosx_10_15_universal2.whl (1.8 MB)\r\nCollecting typing-extensions>=3.7.4.3\r\n  Using cached typing_extensions-4.4.0-py3-none-any.whl (26 kB)\r\nCollecting geventhttpclient>=2.0.2\r\n  Using cached geventhttpclient-2.0.8-cp310-cp310-macosx_11_0_arm64.whl (42 kB)\r\nCollecting Flask-BasicAuth>=0.2.0\r\n  Using cached Flask-BasicAuth-0.2.0.tar.gz (16 kB)\r\n  Preparing metadata (setup.py): started\r\n  Preparing metadata (setup.py): finished with status 'done'\r\nRequirement already satisfied: requests>=2.23.0 in /Users/vijay/.local/share/virtualenvs/v-Z7kjsnkl/lib/python3.10/site-packages (from \r\nlocust->-r /var/folders/m4/72hy_b8d3dj79xnn1lfg07sm0000gn/T/pipenv-zghdk5j0-requirements/pipenv-e_dnt2vu-requirement.txt (line 1)) \r\n(2.28.1)\r\nCollecting roundrobin>=0.0.2\r\n  Using cached roundrobin-0.0.4.tar.gz (3.4 kB)\r\n  Preparing metadata (setup.py): started\r\n  Preparing metadata (setup.py): finished with status 'done'\r\nCollecting Flask-Cors>=3.0.10\r\n  Using cached Flask_Cors-3.0.10-py2.py3-none-any.whl (14 kB)\r\nCollecting Werkzeug>=2.0.0\r\n  Using cached Werkzeug-2.2.2-py3-none-any.whl (232 kB)\r\nCollecting msgpack>=0.6.2\r\n  Using cached msgpack-1.0.4-cp310-cp310-macosx_11_0_arm64.whl (69 kB)\r\nCollecting gevent>=20.12.1\r\n  Using cached gevent-22.10.2.tar.gz (6.6 MB)\r\n  Installing build dependencies: started\r\n  Installing build dependencies: finished with status 'error'\r\n\r\n\u2839 Installing locust...[36m  error: subprocess-exited-with-error\r\n  \r\n  \u00d7 pip subprocess to install build dependencies did not run successfully.\r\n  \u2502 exit code: 1\r\n  \u2570\u2500> [240 lines of output]\r\n      Collecting setuptools>=40.8.0\r\n        Using cached setuptools-65.6.3-py3-none-any.whl (1.2 MB)\r\n      Collecting Cython>=3.0a11\r\n        Using cached Cython-3.0.0a11-py2.py3-none-any.whl (1.1 MB)\r\n      Collecting cffi>=1.12.3\r\n        Using cached cffi-1.15.1-cp310-cp310-macosx_11_0_arm64.whl (174 kB)\r\n      Collecting greenlet>=2.0.0\r\n        Using cached greenlet-2.0.1.tar.gz (163 kB)\r\n        Preparing metadata (setup.py): started\r\n        Preparing metadata (setup.py): finished with status 'done'\r\n      Collecting pycparser\r\n        Using cached pycparser-2.21-py2.py3-none-any.whl (118 kB)\r\n      Building wheels for collected packages: greenlet\r\n        Building wheel for greenlet (setup.py): started\r\n        Building wheel for greenlet (setup.py): finished with status 'error'\r\n        error: subprocess-exited-with-error\r\n      \r\n        \u00d7 python setup.py bdist_wheel did not run successfully.\r\n        \u2502 exit code: 1\r\n        \u2570\u2500> [97 lines of output]\r\n            running bdist_wheel\r\n            running build\r\n            running build_py\r\n            creating build\r\n            creating build/lib.macosx-10.9-universal2-cpython-310\r\n            creating build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/__init__.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            creating build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/__init__.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            creating build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_version.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_weakref.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_gc.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/leakcheck.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_generator.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_greenlet_trash.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_throw.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_tracing.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_cpp.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_contextvars.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_greenlet.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_extension_interface.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/__init__.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_generator_nested.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_stack_saved.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_leaks.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            running egg_info\r\n            writing src/greenlet.egg-info/PKG-INFO\r\n            writing dependency_links to src/greenlet.egg-info/dependency_links.txt\r\n            writing requirements to src/greenlet.egg-info/requires.txt\r\n            writing top-level names to src/greenlet.egg-info/top_level.txt\r\n            reading manifest file 'src/greenlet.egg-info/SOURCES.txt'\r\n            reading manifest template 'MANIFEST.in'\r\n            warning: no previously-included files found matching 'benchmarks/*.json'\r\n            no previously-included directories found matching 'docs/_build'\r\n            warning: no files found matching '*.py' under directory 'appveyor'\r\n            warning: no previously-included files matching '*.pyc' found anywhere in distribution\r\n            warning: no previously-included files matching '*.pyd' found anywhere in distribution\r\n            warning: no previously-included files matching '*.so' found anywhere in distribution\r\n            warning: no previously-included files matching '.coverage' found anywhere in distribution\r\n            adding license file 'LICENSE'\r\n            adding license file 'LICENSE.PSF'\r\n            adding license file 'AUTHORS'\r\n            writing manifest file 'src/greenlet.egg-info/SOURCES.txt'\r\n            copying src/greenlet/greenlet.cpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_allocator.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_compiler_compat.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_cpython_compat.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_exceptions.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_greenlet.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_internal.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_refs.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_slp_switch.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_thread_state.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_thread_state_dict_cleanup.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_thread_support.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/slp_platformselect.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/platform/setup_switch_x64_masm.cmd -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_aarch64_gcc.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_alpha_unix.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_amd64_unix.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_arm32_gcc.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_arm32_ios.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_arm64_masm.asm -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_arm64_masm.obj -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_arm64_msvc.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_csky_gcc.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_m68k_gcc.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_mips_unix.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_ppc64_aix.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_ppc64_linux.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_ppc_aix.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_ppc_linux.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_ppc_macosx.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_ppc_unix.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_riscv_unix.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_s390_unix.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_sparc_sun_gcc.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_x32_unix.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_x64_masm.asm -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_x64_masm.obj -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_x64_msvc.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_x86_msvc.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_x86_unix.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/tests/_test_extension.c -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/_test_extension_cpp.cpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            warning: build_py: byte-compiling is disabled, skipping.\r\n      \r\n            running build_ext\r\n            building 'greenlet._greenlet' extension\r\n            creating build/temp.macosx-10.9-universal2-cpython-310\r\n            creating build/temp.macosx-10.9-universal2-cpython-310/src\r\n            creating build/temp.macosx-10.9-universal2-cpython-310/src/greenlet\r\n            clang -Wno-unused-result -Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -arch arm64 \r\n-arch x86_64 -g -I/Users/vijay/.local/share/virtualenvs/v-Z7kjsnkl/include \r\n-I/Library/Frameworks/Python.framework/Versions/3.10/include/python3.10 -c src/greenlet/greenlet.cpp -o \r\nbuild/temp.macosx-10.9-universal2-cpython-310/src/greenlet/greenlet.o --std=gnu++11\r\n            xcrun: error: invalid active developer path (/Library/Developer/CommandLineTools), missing xcrun at: \r\n/Library/Developer/CommandLineTools/usr/bin/xcrun\r\n            error: command '/usr/bin/clang' failed with exit code 1\r\n            \r\n      \r\n        note: This error originates from a subprocess, and is likely not a problem with pip.\r\n        ERROR: Failed building wheel for greenlet\r\n        Running setup.py clean for greenlet\r\n      Failed to build greenlet\r\n      Installing collected packages: setuptools, pycparser, greenlet, Cython, cffi\r\n        Running setup.py install for greenlet: started\r\n        Running setup.py install for greenlet: finished with status 'error'\r\n        error: subprocess-exited-with-error\r\n      \r\n        \u00d7 Running setup.py install for greenlet did not run successfully.\r\n        \u2502 exit code: 1\r\n        \u2570\u2500> [99 lines of output]\r\n            running install\r\n            /Users/vijay/.local/share/virtualenvs/v-Z7kjsnkl/lib/python3.10/site-packages/setuptools/command/install.py:34: \r\nSetuptoolsDeprecationWarning: setup.py install is deprecated. Use build and pip and other standards-based tools.\r\n              warnings.warn(\r\n            running build\r\n            running build_py\r\n            creating build\r\n            creating build/lib.macosx-10.9-universal2-cpython-310\r\n            creating build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/__init__.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            creating build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/__init__.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            creating build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_version.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_weakref.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_gc.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/leakcheck.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_generator.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_greenlet_trash.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_throw.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_tracing.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_cpp.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_contextvars.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_greenlet.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_extension_interface.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/__init__.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_generator_nested.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_stack_saved.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/test_leaks.py -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            running egg_info\r\n            writing src/greenlet.egg-info/PKG-INFO\r\n            writing dependency_links to src/greenlet.egg-info/dependency_links.txt\r\n            writing requirements to src/greenlet.egg-info/requires.txt\r\n            writing top-level names to src/greenlet.egg-info/top_level.txt\r\n            reading manifest file 'src/greenlet.egg-info/SOURCES.txt'\r\n            reading manifest template 'MANIFEST.in'\r\n            warning: no previously-included files found matching 'benchmarks/*.json'\r\n            no previously-included directories found matching 'docs/_build'\r\n            warning: no files found matching '*.py' under directory 'appveyor'\r\n            warning: no previously-included files matching '*.pyc' found anywhere in distribution\r\n            warning: no previously-included files matching '*.pyd' found anywhere in distribution\r\n            warning: no previously-included files matching '*.so' found anywhere in distribution\r\n            warning: no previously-included files matching '.coverage' found anywhere in distribution\r\n            adding license file 'LICENSE'\r\n            adding license file 'LICENSE.PSF'\r\n            adding license file 'AUTHORS'\r\n            writing manifest file 'src/greenlet.egg-info/SOURCES.txt'\r\n            copying src/greenlet/greenlet.cpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_allocator.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_compiler_compat.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_cpython_compat.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_exceptions.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_greenlet.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_internal.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_refs.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_slp_switch.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_thread_state.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_thread_state_dict_cleanup.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/greenlet_thread_support.hpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/slp_platformselect.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet\r\n            copying src/greenlet/platform/setup_switch_x64_masm.cmd -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_aarch64_gcc.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_alpha_unix.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_amd64_unix.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_arm32_gcc.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_arm32_ios.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_arm64_masm.asm -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_arm64_masm.obj -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_arm64_msvc.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_csky_gcc.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_m68k_gcc.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_mips_unix.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_ppc64_aix.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_ppc64_linux.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_ppc_aix.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_ppc_linux.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_ppc_macosx.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_ppc_unix.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_riscv_unix.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_s390_unix.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_sparc_sun_gcc.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_x32_unix.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_x64_masm.asm -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_x64_masm.obj -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_x64_msvc.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_x86_msvc.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/platform/switch_x86_unix.h -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/platform\r\n            copying src/greenlet/tests/_test_extension.c -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            copying src/greenlet/tests/_test_extension_cpp.cpp -> build/lib.macosx-10.9-universal2-cpython-310/greenlet/tests\r\n            warning: build_py: byte-compiling is disabled, skipping.\r\n      \r\n            running build_ext\r\n            building 'greenlet._greenlet' extension\r\n            creating build/temp.macosx-10.9-universal2-cpython-310\r\n            creating build/temp.macosx-10.9-universal2-cpython-310/src\r\n            creating build/temp.macosx-10.9-universal2-cpython-310/src/greenlet\r\n            clang -Wno-unused-result -Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -arch arm64 \r\n-arch x86_64 -g -I/Users/vijay/.local/share/virtualenvs/v-Z7kjsnkl/include \r\n-I/Library/Frameworks/Python.framework/Versions/3.10/include/python3.10 -c src/greenlet/greenlet.cpp -o \r\nbuild/temp.macosx-10.9-universal2-cpython-310/src/greenlet/greenlet.o --std=gnu++11\r\n            xcrun: error: invalid active developer path (/Library/Developer/CommandLineTools), missing xcrun at: \r\n/Library/Developer/CommandLineTools/usr/bin/xcrun\r\n            error: command '/usr/bin/clang' failed with exit code 1\r\n            \r\n      \r\n        note: This error originates from a subprocess, and is likely not a problem with pip.\r\n      error: legacy-install-failure\r\n      \r\n      \u00d7 Encountered error while trying to install package.\r\n      \u2570\u2500> greenlet\r\n      \r\n      note: This is an issue with the package mentioned above, not pip.\r\n      hint: See above for output from the failure.\r\n      \r\n  \r\n  note: This error originates from a subprocess, and is likely not a problem with pip.\r\nerror: subprocess-exited-with-error\r\n\r\n\u00d7 pip subprocess to install build dependencies did not run successfully.\r\n\u2502 exit code: 1\r\n\u2570\u2500> See above for output.\r\n\r\nnote: This error originates from a subprocess, and is likely not a problem with pip.\r\n[0m\r\n\u2718 Installation Failed", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2277/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2277/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2270", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2270/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2270/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2270/events", "html_url": "https://github.com/locustio/locust/issues/2270", "id": 1481320163, "node_id": "I_kwDOABUGS85YSybj", "number": 2270, "title": "Run different user_classes in same LoadTestShape", "user": {"login": "AdiTasa", "id": 67008486, "node_id": "MDQ6VXNlcjY3MDA4NDg2", "avatar_url": "https://avatars.githubusercontent.com/u/67008486?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AdiTasa", "html_url": "https://github.com/AdiTasa", "followers_url": "https://api.github.com/users/AdiTasa/followers", "following_url": "https://api.github.com/users/AdiTasa/following{/other_user}", "gists_url": "https://api.github.com/users/AdiTasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/AdiTasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AdiTasa/subscriptions", "organizations_url": "https://api.github.com/users/AdiTasa/orgs", "repos_url": "https://api.github.com/users/AdiTasa/repos", "events_url": "https://api.github.com/users/AdiTasa/events{/privacy}", "received_events_url": "https://api.github.com/users/AdiTasa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-12-07T08:24:54Z", "updated_at": "2022-12-14T10:53:49Z", "closed_at": "2022-12-14T10:27:20Z", "author_association": "NONE", "active_lock_reason": null, "body": null, "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2270/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2270/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2268", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2268/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2268/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2268/events", "html_url": "https://github.com/locustio/locust/issues/2268", "id": 1477453112, "node_id": "I_kwDOABUGS85YECU4", "number": 2268, "title": "Use of old term \"slaves\" on marketing site", "user": {"login": "smzelek", "id": 11831150, "node_id": "MDQ6VXNlcjExODMxMTUw", "avatar_url": "https://avatars.githubusercontent.com/u/11831150?v=4", "gravatar_id": "", "url": "https://api.github.com/users/smzelek", "html_url": "https://github.com/smzelek", "followers_url": "https://api.github.com/users/smzelek/followers", "following_url": "https://api.github.com/users/smzelek/following{/other_user}", "gists_url": "https://api.github.com/users/smzelek/gists{/gist_id}", "starred_url": "https://api.github.com/users/smzelek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/smzelek/subscriptions", "organizations_url": "https://api.github.com/users/smzelek/orgs", "repos_url": "https://api.github.com/users/smzelek/repos", "events_url": "https://api.github.com/users/smzelek/events{/privacy}", "received_events_url": "https://api.github.com/users/smzelek/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 4880157816, "node_id": "LA_kwDOABUGS88AAAABIuFMeA", "url": "https://api.github.com/repos/locustio/locust/labels/no-changelog", "name": "no-changelog", "color": "dddddd", "default": false, "description": "If set, the issue won't show up in the Changelog"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-12-05T21:15:56Z", "updated_at": "2022-12-06T12:49:04Z", "closed_at": "2022-12-06T12:49:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "https://locust.io/static/img/screenshot_0.12.1.png\r\nThe locust.io marketing site has a screenshot displayed in the hero banner that still uses the term \"Slaves\" instead of \"Workers\", showing an out-of-date version of the Locust UI.\r\n\r\nI tried to go fix myself and open a PR, but the code for the marketing site does not appear to be public (possibly it's in a CMS or a private repo?)\r\n\r\n<img width=\"1009\" alt=\"Screen Shot 2022-12-05 at 1 13 22 PM\" src=\"https://user-images.githubusercontent.com/11831150/205744094-52508e70-5bfc-4053-afcb-511193e37f6c.png\">\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2268/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2268/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2265", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2265/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2265/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2265/events", "html_url": "https://github.com/locustio/locust/issues/2265", "id": 1470772026, "node_id": "I_kwDOABUGS85XqjM6", "number": 2265, "title": "locust.io is down", "user": {"login": "lsb", "id": 45281, "node_id": "MDQ6VXNlcjQ1Mjgx", "avatar_url": "https://avatars.githubusercontent.com/u/45281?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lsb", "html_url": "https://github.com/lsb", "followers_url": "https://api.github.com/users/lsb/followers", "following_url": "https://api.github.com/users/lsb/following{/other_user}", "gists_url": "https://api.github.com/users/lsb/gists{/gist_id}", "starred_url": "https://api.github.com/users/lsb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lsb/subscriptions", "organizations_url": "https://api.github.com/users/lsb/orgs", "repos_url": "https://api.github.com/users/lsb/repos", "events_url": "https://api.github.com/users/lsb/events{/privacy}", "received_events_url": "https://api.github.com/users/lsb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-12-01T06:46:39Z", "updated_at": "2022-12-01T09:18:41Z", "closed_at": "2022-12-01T09:18:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "The website returns a 503 with a Heroku error :(", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2265/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 1, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2265/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2264", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2264/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2264/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2264/events", "html_url": "https://github.com/locustio/locust/issues/2264", "id": 1469620319, "node_id": "I_kwDOABUGS85XmKBf", "number": 2264, "title": "Locust sent no request sometimes when run more then one test at same time", "user": {"login": "Fire-Knight", "id": 42604945, "node_id": "MDQ6VXNlcjQyNjA0OTQ1", "avatar_url": "https://avatars.githubusercontent.com/u/42604945?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Fire-Knight", "html_url": "https://github.com/Fire-Knight", "followers_url": "https://api.github.com/users/Fire-Knight/followers", "following_url": "https://api.github.com/users/Fire-Knight/following{/other_user}", "gists_url": "https://api.github.com/users/Fire-Knight/gists{/gist_id}", "starred_url": "https://api.github.com/users/Fire-Knight/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Fire-Knight/subscriptions", "organizations_url": "https://api.github.com/users/Fire-Knight/orgs", "repos_url": "https://api.github.com/users/Fire-Knight/repos", "events_url": "https://api.github.com/users/Fire-Knight/events{/privacy}", "received_events_url": "https://api.github.com/users/Fire-Knight/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-11-30T13:14:13Z", "updated_at": "2022-11-30T15:51:17Z", "closed_at": "2022-11-30T14:12:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n### Describe the bug\r\nIt seems cannot run two test.py by locust at same time\r\nI want to simulation two different person to do pressure test, they both exec same test file and behavior different by cmd argument.\r\nI run  `locust -f locustExec_test.py --headless -t=10 --html=locust-0.html` in one terminal and `locust -f locustExec_test.py --headless -t=10 --html=locust-1.html` in another terminal, herer I omit some argument.\r\n\r\n### Expected behavior\r\nI expect both termianl run locust normally, like this, \r\n![image](https://user-images.githubusercontent.com/42604945/204802337-94a30a64-2914-4f73-b2dc-dc523235f195.png)\r\n\r\n\r\n\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nHowever, sometimes, they only sent several request, even sent no request, especially when I run one Immediately after another started.\r\n![image](https://user-images.githubusercontent.com/42604945/204802883-8dede724-ec01-411b-8d93-f11683ef46b9.png)\r\n\r\n\r\n### Steps to reproduce\r\nI'm sorry that you cannot access my server, but I can show you my test file in end.\r\n\r\n### Environment\r\n\r\n\r\n- OS: windows 10\r\n- Python version: 3.8.8\r\n- Locust version: 2.10.1\r\n- Locust command line that you ran: `locust -f locustExec_test.py --headless -t=10 --html=locust-0.html`, `locust -f locustExec_test.py --headless -t=10 --html=locust-1.html`\r\n- Locust file contents :\r\n\r\n```\r\nfrom locust import HttpUser, task\r\nimport json\r\n# request list\r\ntest_list = ['{ \"path\": \"/api/v1/travelservice/trips/left\",\"method\": \"POST\",\"argument\": {\"startingPlace\":\"Xu Zhou2\",\"endPlace\":\"Xu Zhou2\",\"departureTime\":\"2017-00-08\"},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/verifycode/generate\",\"method\": \"GET\",\"argument\": {},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/verifycode/generate\",\"method\": \"GET\",\"argument\": {},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/travelservice/trips/left\",\"method\": \"POST\",\"argument\": {\"startingPlace\":\"Wu Xi2\",\"endPlace\":\"Su Zhou\",\"departureTime\":\"2022-06-22\"},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/client_ticket_book.html?tripId=D1345&from=Shang%20Hai&to=Su%20Zhou&seatType=2&seat_price=50.0&date=2022-06-22\",\"method\": \"GET\",\"argument\": {},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/assuranceservice/assurances/types\",\"method\": \"GET\",\"argument\": {},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/verifycode/generate\",\"method\": \"GET\",\"argument\": {},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/users/login\",\"method\": \"POST\",\"argument\": {\"username\":\"yfmldervssyovdjue\",\"password\":\"111111\",\"verificationCode\":0},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/verifycode/generate\",\"method\": \"GET\",\"argument\": {},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/travelservice/trips/left\",\"method\": \"POST\",\"argument\": {\"startingPlace\":\"Shang Hai\",\"endPlace\":\"Su Zhou\",\"departureTime\":\"2022-06-22\"},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/assuranceservice/assurances/types\",\"method\": \"GET\",\"argument\": {},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/foodservice/foods/2022-06-22/Shang%20Hai/Su%20Zhou/D1345\",\"method\": \"GET\",\"argument\": {},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/contactservice/contacts/account/4d2a46c7-71cb-4cf1-b5bb-b68406d9da6f\",\"method\": \"GET\",\"argument\": {},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/preserveservice/preserve\",\"method\": \"POST\",\"argument\": {\"accountId\":\"4d2a46c7-71cb-4cf1-b5bb-b68406d9da6f\",\"contactsId\":\"f0ba1dd0-adae-4c9e-b198-a957a2b59db6\",\"tripId\":\"D1345\",\"seatType\":\"2\",\"date\":\"2022-06-22\",\"from\":\"Shang Hai\",\"to\":\"Su Zhou\",\"assurance\":\"0\",\"foodType\":1,\"foodName\":\"Bone Soup\",\"foodPrice\":2.5,\"stationName\":\"\",\"storeName\":\"\"},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/preserveservice/preserve\",\"method\": \"POST\",\"argument\": {\"accountId\":\"s4zobr7mxydr1glrsckyu0bqwat\",\"contactsId\":\"l7rin3jpgyltnbtag9cj-pksx-tdla2kmlha5cq\",\"tripId\":\"D1345\",\"seatType\":\"2\",\"date\":\"2024-07-25\",\"from\":\"Shang Hai\",\"to\":\"Su Zhou\",\"assurance\":\"0\",\"foodType\":\"\",\"foodName\":\"Bone Soup\",\"foodPrice\":\"\",\"stationName\":\"\",\"storeName\":\"\",\"handleDate\":\"2000-03-10\",\"consigneeName\":\"11\",\"consigneePhone\":\"11111\",\"consigneeWeight\":\"\",\"isWithin\":\"\"},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/client_ticket_book.html?tripId=D1345&from=Shang%20Hai&to=Su%20Zhou&seatType=2&seat_price=50.0&date=2022-06-22\",\"method\": \"GET\",\"argument\": {},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/assuranceservice/assurances/types\",\"method\": \"GET\",\"argument\": {},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/foodservice/foods/2022-06-22/Shang%20Hai/Su%20Zhou/D1345\",\"method\": \"GET\",\"argument\": {},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/contactservice/contacts/account/4d2a46c7-71cb-4cf1-b5bb-b68406d9da6f\",\"method\": \"GET\",\"argument\": {},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/preserveservice/preserve\",\"method\": \"POST\",\"argument\": {\"accountId\":\"4d2a46c7-71cb-4cf1-b5bb-b68406d9da6f\",\"contactsId\":\"st7i0s6d-qaevrip9flcpwbfvvdy3escu3cmbm4\",\"tripId\":\"ow1q4\",\"seatType\":\"\",\"date\":\"2002-10-27\",\"from\":\"fthh\",\"to\":\"rzsuo\",\"assurance\":-18,\"foodType\":\"\",\"foodName\":\"Bone Soup\",\"foodPrice\":\"\",\"stationName\":\"\",\"storeName\":\"\",\"handleDate\":\"2002-06-04\",\"consigneeName\":\"\",\"consigneePhone\":\"\",\"consigneeWeight\":\"\",\"isWithin\":\"\"},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/preserveservice/preserve\",\"method\": \"POST\",\"argument\": {\"accountId\":\"4d2a46c7-71cb-4cf1-b5bb-b68406d9da6f\",\"contactsId\":\"4700346f-afb8-490c-b2fe-d32dc35b458f\",\"tripId\":\"tDgr5\",\"seatType\":0,\"date\":\"2003-01-24\",\"from\":\"mqaezs\",\"to\":\"Su Zhou\",\"assurance\":-4,\"foodType\":\"\",\"foodName\":\"Bone Soup\",\"foodPrice\":\"\",\"stationName\":\"\",\"storeName\":\"\",\"handleDate\":\"2022-06-22\",\"consigneeName\":\"\",\"consigneePhone\":\"\",\"consigneeWeight\":\"\",\"isWithin\":\"\"},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/consignservice/consigns/account/4d2a46c7-71cb-4cf1-b5bb-b68406d9da6f\",\"method\": \"GET\",\"argument\": {},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/verifycode/generate\",\"method\": \"GET\",\"argument\": {},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/verifycode/generate\",\"method\": \"GET\",\"argument\": {},\"argInUrl\": \"false\"}',\r\n'{ \"path\": \"/api/v1/travelservice/trips/left\",\"method\": \"POST\",\"argument\": {\"startingPlace\":\"Nan Jing2\",\"endPlace\":\"Xu Zhou2\",\"departureTime\":\"2001-07-09\"},\"argInUrl\": \"false\"}']\r\n\r\nclass WebsiteUser(HttpUser):\r\n\r\n    @task\r\n    def about(self): \r\n        # send request one by one\r\n        for test in test_list:\r\n            test_json = json.loads(test)\r\n            path = test_json['path']\r\n            argument = test_json['argument']\r\n            method = test_json['method']\r\n            header = {'my_token': 1, 'Task_ID': 2, 'Test_ID': 3}\r\n            if method == 'POST':\r\n                self.client.post(path, json=argument, headers = header)\r\n            else:\r\n                self.client.get(path)\r\n    \r\n    host = \"http://133.133.135.182:32677\"\r\n    min_wait = 1000\r\n    max_wait = 5000\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2264/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2264/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2263", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2263/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2263/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2263/events", "html_url": "https://github.com/locustio/locust/issues/2263", "id": 1465472975, "node_id": "I_kwDOABUGS85XWVfP", "number": 2263, "title": "locust 2.13.0 failed to run", "user": {"login": "willysr", "id": 240100, "node_id": "MDQ6VXNlcjI0MDEwMA==", "avatar_url": "https://avatars.githubusercontent.com/u/240100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/willysr", "html_url": "https://github.com/willysr", "followers_url": "https://api.github.com/users/willysr/followers", "following_url": "https://api.github.com/users/willysr/following{/other_user}", "gists_url": "https://api.github.com/users/willysr/gists{/gist_id}", "starred_url": "https://api.github.com/users/willysr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/willysr/subscriptions", "organizations_url": "https://api.github.com/users/willysr/orgs", "repos_url": "https://api.github.com/users/willysr/repos", "events_url": "https://api.github.com/users/willysr/events{/privacy}", "received_events_url": "https://api.github.com/users/willysr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-11-27T15:18:00Z", "updated_at": "2022-11-30T17:46:11Z", "closed_at": "2022-11-30T17:46:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nI tried to build locust 2.13.0 on slackware-current but it failed to run with the following error message\r\n\r\n```\r\nlocust \r\nTraceback (most recent call last):\r\n  File \"/usr/bin/locust\", line 33, in <module>\r\n    sys.exit(load_entry_point('locust==2.13.0', 'console_scripts', 'locust')())\r\n  File \"/usr/bin/locust\", line 25, in importlib_load_entry_point\r\n    return next(matches).load()\r\n  File \"/usr/lib64/python3.9/importlib/metadata.py\", line 86, in load\r\n    module = import_module(match.group('module'))\r\n  File \"/usr/lib64/python3.9/importlib/__init__.py\", line 127, in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\n  File \"<frozen importlib._bootstrap>\", line 1030, in _gcd_import\r\n  File \"<frozen importlib._bootstrap>\", line 1007, in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 972, in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 228, in _call_with_frames_removed\r\n  File \"<frozen importlib._bootstrap>\", line 1030, in _gcd_import\r\n  File \"<frozen importlib._bootstrap>\", line 1007, in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 986, in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 680, in _load_unlocked\r\n  File \"<frozen importlib._bootstrap_external>\", line 850, in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 228, in _call_with_frames_removed\r\n  File \"/usr/lib64/python3.9/site-packages/locust/__init__.py\", line 18, in <module>\r\n    from .contrib.fasthttp import FastHttpUser\r\n  File \"/usr/lib64/python3.9/site-packages/locust/contrib/fasthttp.py\", line 24, in <module>\r\n    from locust.env import Environment\r\n  File \"/usr/lib64/python3.9/site-packages/locust/env.py\", line 16, in <module>\r\n    from .runners import Runner, LocalRunner, MasterRunner, WorkerRunner\r\n  File \"/usr/lib64/python3.9/site-packages/locust/runners.py\", line 43, in <module>\r\n    import psutil\r\n  File \"/usr/lib64/python3.9/site-packages/psutil/__init__.py\", line 102, in <module>\r\n    from . import _pslinux as _psplatform\r\n  File \"/usr/lib64/python3.9/site-packages/psutil/_pslinux.py\", line 87, in <module>\r\n    PAGESIZE = cext_posix.getpagesize()\r\nAttributeError: module 'psutil._psutil_posix' has no attribute 'getpagesize'\r\n```\r\n\r\ni have psutil 5.9.4, which is the latest version \r\n\r\n### Expected behavior\r\nlocust run normally\r\n\r\n### Actual behavior\r\nlocust failed to run\r\n\r\n### Steps to reproduce\r\nbuild all dependencies of locust and locust 2.13.0\r\n\r\n### Environment\r\n\r\n- OS: Slackware-Current\r\n- Python version: 3.9.15\r\n- Locust version: 2.13.0\r\n- Locust command line that you ran: locust", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2263/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2263/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2257", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2257/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2257/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2257/events", "html_url": "https://github.com/locustio/locust/issues/2257", "id": 1451836835, "node_id": "I_kwDOABUGS85WiUWj", "number": 2257, "title": "Locust never finishes starting", "user": {"login": "jkoorts", "id": 10402021, "node_id": "MDQ6VXNlcjEwNDAyMDIx", "avatar_url": "https://avatars.githubusercontent.com/u/10402021?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jkoorts", "html_url": "https://github.com/jkoorts", "followers_url": "https://api.github.com/users/jkoorts/followers", "following_url": "https://api.github.com/users/jkoorts/following{/other_user}", "gists_url": "https://api.github.com/users/jkoorts/gists{/gist_id}", "starred_url": "https://api.github.com/users/jkoorts/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jkoorts/subscriptions", "organizations_url": "https://api.github.com/users/jkoorts/orgs", "repos_url": "https://api.github.com/users/jkoorts/repos", "events_url": "https://api.github.com/users/jkoorts/events{/privacy}", "received_events_url": "https://api.github.com/users/jkoorts/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-11-16T15:45:36Z", "updated_at": "2022-11-18T11:20:16Z", "closed_at": "2022-11-18T11:20:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi I read the documentation:\r\n\r\nPut the code in a file named locustfile.py in your current directory and run locust:\r\n\r\nI do that it then says Starting Locust 2.13.0\r\n\r\nThe documentation then says \"Once you\u2019ve started Locust, open up a browser\"\r\n\r\nBut nothing is printed after Starting Locust 2.13.0. Is it hanging at the starting phase and never goes to started?\r\n\r\nWhen is it started?", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2257/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2257/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2256", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2256/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2256/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2256/events", "html_url": "https://github.com/locustio/locust/issues/2256", "id": 1451830217, "node_id": "I_kwDOABUGS85WiSvJ", "number": 2256, "title": "Extend typing of \"task\" property of a locust user", "user": {"login": "samuelspagl", "id": 46893256, "node_id": "MDQ6VXNlcjQ2ODkzMjU2", "avatar_url": "https://avatars.githubusercontent.com/u/46893256?v=4", "gravatar_id": "", "url": "https://api.github.com/users/samuelspagl", "html_url": "https://github.com/samuelspagl", "followers_url": "https://api.github.com/users/samuelspagl/followers", "following_url": "https://api.github.com/users/samuelspagl/following{/other_user}", "gists_url": "https://api.github.com/users/samuelspagl/gists{/gist_id}", "starred_url": "https://api.github.com/users/samuelspagl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/samuelspagl/subscriptions", "organizations_url": "https://api.github.com/users/samuelspagl/orgs", "repos_url": "https://api.github.com/users/samuelspagl/repos", "events_url": "https://api.github.com/users/samuelspagl/events{/privacy}", "received_events_url": "https://api.github.com/users/samuelspagl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-11-16T15:41:32Z", "updated_at": "2023-01-27T02:02:40Z", "closed_at": "2023-01-27T02:02:40Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nCreating a dictionary of `Callable,int` for the `tasks` attribute of a locust user is failing common python linters. (for example \"mypy\")\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nThe type hinting should be inline with the comment:\r\n```\r\n    Collection of python callables and/or TaskSet classes that the Locust user(s) will run.\r\n\r\n    If tasks is a list, the task to be performed will be picked randomly.\r\n\r\n    If tasks is a *(callable,int)* list of two-tuples, or a {callable:int} dict,\r\n    the task to be performed will be picked randomly, but each task will be weighted\r\n    according to its corresponding int value. So in the following case, *ThreadPage* will\r\n    be fifteen times more likely to be picked than *write_post*::\r\n```\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nResulting mypy error:\r\n```bash\r\nMypy: Incompatible types in assignment (expression has type \"Dict[Callable[..., None], Any]\", base class \"User\" defined the type as \"List[Union[TaskSet, Callable[..., Any]]]\") [assignment]\r\n```\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\nI'm using as IDE and also have the `mypy` plugin active, therefore this error is shown in the IDE itself.\r\nBut it should also be possible to just start the linting process for these lines.\r\n```python\r\nclass SomeUser(FastHttpUser):\r\n    tasks = {\r\n        some_task_1: 12,\r\n        some_task_2: 4,\r\n        some_task_3: 6\r\n    }\r\n...\r\n```\r\n\r\n\r\n### Solution\r\n\r\nExtend the typing in the `user` class with the following: \r\n```python\r\nfrom\r\n    tasks: List[TaskSet | Callable]  = []\r\nto\r\n    tasks: List[TaskSet | Callable]  | dict[Callable, int] | Tuple = []\r\n```\r\n\r\n\r\n### Environment\r\n\r\n- OS: MacOS\r\n- Python version: 3.10\r\n- Locust version: 2.13.0\r\n\r\n\r\nLooking forward to your comments. :) \r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2256/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2256/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2253", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2253/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2253/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2253/events", "html_url": "https://github.com/locustio/locust/issues/2253", "id": 1450099928, "node_id": "I_kwDOABUGS85WbsTY", "number": 2253, "title": "docs: Small errors in docs", "user": {"login": "jscanlannyc", "id": 62957582, "node_id": "MDQ6VXNlcjYyOTU3NTgy", "avatar_url": "https://avatars.githubusercontent.com/u/62957582?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jscanlannyc", "html_url": "https://github.com/jscanlannyc", "followers_url": "https://api.github.com/users/jscanlannyc/followers", "following_url": "https://api.github.com/users/jscanlannyc/following{/other_user}", "gists_url": "https://api.github.com/users/jscanlannyc/gists{/gist_id}", "starred_url": "https://api.github.com/users/jscanlannyc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jscanlannyc/subscriptions", "organizations_url": "https://api.github.com/users/jscanlannyc/orgs", "repos_url": "https://api.github.com/users/jscanlannyc/repos", "events_url": "https://api.github.com/users/jscanlannyc/events{/privacy}", "received_events_url": "https://api.github.com/users/jscanlannyc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-11-15T17:00:11Z", "updated_at": "2022-12-05T19:21:19Z", "closed_at": "2022-12-05T17:48:08Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi,\r\n\r\nThank you all so much for all your hard work on this project. I recently used this for a demonstration and was amazed by its power an elegance, and would like to give back however I can.\r\n\r\nI encountered two small issues in the docs which that I would like to address. I will gladly issue a pull request for the bugs and changes mentioned in this issue. I felt it was courtesy to raise this issue first before issuing the pull request to ensure it would be acknowledged and accepted.\r\n\r\n\r\n### Describe the bug\r\n\r\nhttps://docs.locust.io/en/stable/extending-locust.html#run-a-background-greenlet\r\n\r\nThere are two python errors in the code provided on this page, which is generated by https://github.com/locustio/locust/blob/master/docs/extending-locust.rst:\r\n\r\n#### Bug 1\r\n\r\nThe first example is as follows:\r\n\r\n```\r\nfrom locust import events\r\n\r\n@events.request.add_listener\r\ndef my_request_handler(request_type, name, response_time, response_length, response,\r\n                       context, exception, start_time, url, **kwargs):\r\n    if exception:\r\n        print(f\"Request to {name} failed with exception {exception}\")\r\n    else:\r\n        print(f\"Successfully made a request to: {name})\r\n        print(f\"The response was {response.text}\")\r\n ```\r\n\r\nThe  \"Successfully made a request to\" f-string is invalid. Running this sample code will raise an error at runtime.\r\n\r\n#### Bug 2\r\n\r\nIn `Running a background greenlet` in \r\n\r\n```\r\nfrom locust import events\r\nfrom locust.runners import STATE_STOPPING, STATE_STOPPED, STATE_CLEANUP, MasterRunner, LocalRunner\r\n\r\ndef checker(environment):\r\n    while not environment.runner.state in [STATE_STOPPING, STATE_STOPPED, STATE_CLEANUP]:\r\n        time.sleep(1)\r\n        if environment.runner.stats.total.fail_ratio > 0.2:\r\n            print(f\"fail ratio was {environment.runner.stats.total.fail_ratio}, quitting\")\r\n            environment.runner.quit()\r\n            return\r\n\r\n\r\n@events.init.add_listener\r\ndef on_locust_init(environment, **_kwargs):\r\n    # dont run this on workers, we only care about the aggregated numbers\r\n    if isinstance(environment.runner, MasterRunner) or isinstance(environment.runner, LocalRunner):\r\n        gevent.spawn(checker, environment)\r\n  ```\r\n  \r\n  This sample code will fail in `on_locust_init` as it does not import `gevent` before using it. Running this code will raise an error at runtime.\r\n\r\n### Expected behavior\r\nThe code should be  copy-and-pasteable from the docs without much modification to work. In both instances these are whole self-contained tasks and not classes.\r\n\r\n### Actual behavior\r\nThe code fails when copy-pasting into a new locust task file.\r\n\r\n### Steps to reproduce\r\n1. After installing locust, copy and paste the code into a locustfile.py and run `locust`.\r\n\r\n### Suggested Fixes\r\n\r\n#### Bug 1\r\n\r\nChange invalid f-string to:\r\n```\r\nprint(f\"Successfully made a request to: {name}\")\r\n```\r\n\r\n#### Bug 2\r\n\r\nImport gevent, which gets installed as a dependency of locust. \r\n\r\n```\r\nimport gevent\r\nfrom locust import events\r\nfrom locust.runners import STATE_STOPPING, STATE_STOPPED, STATE_CLEANUP, MasterRunner, LocalRunner\r\n```\r\n\r\nI again will gladly volunteer to make this change and issue a pull request.\r\n\r\n### Environment\r\n\r\n- OS: Mac OS Big Sur 11.6.8\r\n- Python version: 3.10.8\r\n- Locust version: 2.13.0\r\n- Locust command line that you ran: locust\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2253/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2253/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2252", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2252/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2252/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2252/events", "html_url": "https://github.com/locustio/locust/issues/2252", "id": 1449138450, "node_id": "I_kwDOABUGS85WYBkS", "number": 2252, "title": "locust does't installing in python 3.11", "user": {"login": "alexandremariano4", "id": 89090315, "node_id": "MDQ6VXNlcjg5MDkwMzE1", "avatar_url": "https://avatars.githubusercontent.com/u/89090315?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexandremariano4", "html_url": "https://github.com/alexandremariano4", "followers_url": "https://api.github.com/users/alexandremariano4/followers", "following_url": "https://api.github.com/users/alexandremariano4/following{/other_user}", "gists_url": "https://api.github.com/users/alexandremariano4/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexandremariano4/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexandremariano4/subscriptions", "organizations_url": "https://api.github.com/users/alexandremariano4/orgs", "repos_url": "https://api.github.com/users/alexandremariano4/repos", "events_url": "https://api.github.com/users/alexandremariano4/events{/privacy}", "received_events_url": "https://api.github.com/users/alexandremariano4/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-11-15T04:15:28Z", "updated_at": "2022-11-15T07:49:39Z", "closed_at": "2022-11-15T07:48:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "I trying to install locust on python 3.11 version but i can't", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2252/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2252/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2251", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2251/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2251/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2251/events", "html_url": "https://github.com/locustio/locust/issues/2251", "id": 1447635942, "node_id": "I_kwDOABUGS85WSSvm", "number": 2251, "title": "Segmentation fault", "user": {"login": "danielzhangau", "id": 41173132, "node_id": "MDQ6VXNlcjQxMTczMTMy", "avatar_url": "https://avatars.githubusercontent.com/u/41173132?v=4", "gravatar_id": "", "url": "https://api.github.com/users/danielzhangau", "html_url": "https://github.com/danielzhangau", "followers_url": "https://api.github.com/users/danielzhangau/followers", "following_url": "https://api.github.com/users/danielzhangau/following{/other_user}", "gists_url": "https://api.github.com/users/danielzhangau/gists{/gist_id}", "starred_url": "https://api.github.com/users/danielzhangau/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/danielzhangau/subscriptions", "organizations_url": "https://api.github.com/users/danielzhangau/orgs", "repos_url": "https://api.github.com/users/danielzhangau/repos", "events_url": "https://api.github.com/users/danielzhangau/events{/privacy}", "received_events_url": "https://api.github.com/users/danielzhangau/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-11-14T08:47:53Z", "updated_at": "2023-01-28T12:06:22Z", "closed_at": "2022-12-30T02:00:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nI am testing my code by running multiple users, segmentation faults start happening when 5 users.\r\n\r\n### Expected behavior\r\nNo segfault. I am expecting more information to debug this error.\r\n\r\n### Actual behavior\r\nwhen I spawned the concurrent user to a certain point, the segmentation fault will happen for no reason. \r\n\r\n### Environment\r\n\r\n- OS: MacOS Monterey version 12.6\r\n- Python version: 3.9.13\r\n- Locust version: 0.13.0\r\n- Locust command line that you ran: `locust`\r\n- Locust file contents (anonymized if necessary):\r\n![Screen Shot 2022-11-14 at 6 44 56 pm](https://user-images.githubusercontent.com/41173132/201614997-32d76b02-e600-4fd4-9dfd-3e6d7a439a36.png)\r\n![Screen Shot 2022-11-14 at 6 44 14 pm](https://user-images.githubusercontent.com/41173132/201615066-08fc91d0-60bc-4791-bab4-3f167e43f3bd.png)\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2251/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2251/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2250", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2250/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2250/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2250/events", "html_url": "https://github.com/locustio/locust/issues/2250", "id": 1446883951, "node_id": "I_kwDOABUGS85WPbJv", "number": 2250, "title": "Mass monkeypatching leads to boto3 incompatibility and infinite recursion in pytest (when used as lib)", "user": {"login": "inpv", "id": 68565248, "node_id": "MDQ6VXNlcjY4NTY1MjQ4", "avatar_url": "https://avatars.githubusercontent.com/u/68565248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/inpv", "html_url": "https://github.com/inpv", "followers_url": "https://api.github.com/users/inpv/followers", "following_url": "https://api.github.com/users/inpv/following{/other_user}", "gists_url": "https://api.github.com/users/inpv/gists{/gist_id}", "starred_url": "https://api.github.com/users/inpv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/inpv/subscriptions", "organizations_url": "https://api.github.com/users/inpv/orgs", "repos_url": "https://api.github.com/users/inpv/repos", "events_url": "https://api.github.com/users/inpv/events{/privacy}", "received_events_url": "https://api.github.com/users/inpv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-11-13T11:40:59Z", "updated_at": "2022-12-30T02:00:19Z", "closed_at": "2022-12-30T02:00:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nI know this [issue](https://github.com/gevent/gevent/issues/1016) has been referenced before, but it seems that re-patching all modules with the exception of Python's native SSL with:\r\n```\r\nfrom gevent import monkey\r\nmonkey.patch_all(ssl=False)\r\n```\r\nin the beginning of a Python test file doesn't lead to any positive results when using locust as library in pytest if boto3 is also installed.\r\n\r\nI wanted to introduce pytest load testing in a PR to a repo that I cloned. Chose locust for integration and extension capabilities.\r\nWrote a simple [function](https://github.com/inpv/cvat/blob/inpv_test_task_mass_user_register/tests/python/rest_api/test_load_register.py) to use locust as library based on the example in the docs, checked that the test works as expected, but if I try to launch all REST API tests with locust installed, half of them fail because of mass monkeypatching that locust introduces in the [init](https://github.com/locustio/locust/blob/b64b9a6082451be74f94bf96406315fa819fcd1c/locust/__init__.py#L11) file. So I disabled ssl monkeypatching explicitly like I wrote above. Now this\r\n```\r\n.env/lib/python3.9/site-packages/locust/__init__.py:11\r\n  /home/inpv/Development/cvat/.env/lib/python3.9/site-packages/locust/__init__.py:11: MonkeyPatchWarning: Monkey-patching ssl after ssl has already been imported may lead to errors, including RecursionError on Python 3.6. It may also silently lead to incorrect behaviour on Python 3.7. Please monkey-patch earlier. See https://github.com/gevent/gevent/issues/1016. Modules that had direct imports (NOT patched): ['urllib3.util (/home/inpv/Development/cvat/.env/lib/python3.9/site-packages/urllib3/util/__init__.py)', 'urllib3.util.ssl_ (/home/inpv/Development/cvat/.env/lib/python3.9/site-packages/urllib3/util/ssl_.py)']. \r\n    monkey.patch_all()\r\n```\r\nwarning is gone, but there is another:\r\n```\r\n.env/lib/python3.9/site-packages/locust/__init__.py:11\r\n  /home/inpv/Development/cvat/.env/lib/python3.9/site-packages/locust/__init__.py:11: MonkeyPatchWarning: Patching more than once will result in the union of all True parameters being patched\r\n    monkey.patch_all()\r\n```\r\n\r\nand the recursion error still is there. If I try to launch a REST API test that otherwise passes without a `locust` import, regardless of SSL is re-patched or not, the [test](https://github.com/inpv/cvat/blob/inpv_test_task_mass_user_register/tests/python/rest_api/test_resource_import_export.py) that utilizes AWS s3 buckets on `boto3` will yield an error like this:\r\n```\r\ntests/python/rest_api/test_resource_import_export.py:290: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\ntests/python/rest_api/test_resource_import_export.py:75: in wrapper\r\n    client = define_client()\r\ntests/python/rest_api/test_resource_import_export.py:45: in define_client\r\n    s3 = boto3.resource(\r\n.env/lib/python3.9/site-packages/boto3/__init__.py:102: in resource\r\n    return _get_default_session().resource(*args, **kwargs)\r\n.env/lib/python3.9/site-packages/boto3/session.py:384: in resource\r\n    client = self.client(\r\n.env/lib/python3.9/site-packages/boto3/session.py:258: in client\r\n    return self._session.create_client(\r\n.env/lib/python3.9/site-packages/botocore/session.py:847: in create_client\r\n    client = client_creator.create_client(\r\n.env/lib/python3.9/site-packages/botocore/client.py:86: in create_client\r\n    client_args = self._get_client_args(\r\n.env/lib/python3.9/site-packages/botocore/client.py:355: in _get_client_args\r\n    return args_creator.get_client_args(\r\n.env/lib/python3.9/site-packages/botocore/args.py:99: in get_client_args\r\n    endpoint = endpoint_creator.create_endpoint(\r\n.env/lib/python3.9/site-packages/botocore/endpoint.py:293: in create_endpoint\r\n    http_session = http_session_cls(\r\n.env/lib/python3.9/site-packages/botocore/httpsession.py:203: in __init__\r\n    self._manager = PoolManager(**self._get_pool_manager_kwargs())\r\n.env/lib/python3.9/site-packages/botocore/httpsession.py:222: in _get_pool_manager_kwargs\r\n    'ssl_context': self._get_ssl_context(),\r\n.env/lib/python3.9/site-packages/botocore/httpsession.py:231: in _get_ssl_context\r\n    return create_urllib3_context()\r\n.env/lib/python3.9/site-packages/botocore/httpsession.py:77: in create_urllib3_context\r\n    context.options |= options\r\n/usr/lib/python3.9/ssl.py:603: in options\r\n    super(SSLContext, SSLContext).options.__set__(self, value)\r\n/usr/lib/python3.9/ssl.py:603: in options\r\n    super(SSLContext, SSLContext).options.__set__(self, value)\r\nE   RecursionError: maximum recursion depth exceeded while calling a Python object\r\n!!! Recursion detected (same locals & position)\r\n```\r\nBecause of this error the CI build fails with infinite recursion and I will never pass the `isort` linter checks with such a setup (for a good reason, actually). Is locust incompatible with boto3 using AWS s3 buckets or am I missing something? Why is SSL context creation called twice?\r\n\r\nP.S. I've seen people face similar [errors](https://github.com/boto/boto3/issues/3365) on boto3 with different modules with no resolution but patching boto3 themselves, yet I decided to create the report here because imo mass monkeypatching may lead to this infinite recursion problem.\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nLocust and gevent usage doesn't corrupt tests that utilize boto3 AWS s3 buckets.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nThe tests with boto3 usage fail with infinite recursion errors.\r\n\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\nInstall latest locust\r\nInstall boto3 and botocore\r\nCreate a test with an AWS s3 bucket usage\r\nLaunch this test\r\n\r\n### Environment\r\n\r\n- OS: Arch Linux latest\r\n- Python version: 3.9 in venv\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds) 2.13.0\r\n- Locust command line that you ran: usage as library, see links above\r\n- Locust file contents (anonymized if necessary): usage as library, see links above", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2250/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2250/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2249", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2249/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2249/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2249/events", "html_url": "https://github.com/locustio/locust/issues/2249", "id": 1444538605, "node_id": "I_kwDOABUGS85WGejt", "number": 2249, "title": "Issue installing on M1 Mac", "user": {"login": "humbertowoody", "id": 8785685, "node_id": "MDQ6VXNlcjg3ODU2ODU=", "avatar_url": "https://avatars.githubusercontent.com/u/8785685?v=4", "gravatar_id": "", "url": "https://api.github.com/users/humbertowoody", "html_url": "https://github.com/humbertowoody", "followers_url": "https://api.github.com/users/humbertowoody/followers", "following_url": "https://api.github.com/users/humbertowoody/following{/other_user}", "gists_url": "https://api.github.com/users/humbertowoody/gists{/gist_id}", "starred_url": "https://api.github.com/users/humbertowoody/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/humbertowoody/subscriptions", "organizations_url": "https://api.github.com/users/humbertowoody/orgs", "repos_url": "https://api.github.com/users/humbertowoody/repos", "events_url": "https://api.github.com/users/humbertowoody/events{/privacy}", "received_events_url": "https://api.github.com/users/humbertowoody/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-11-10T20:46:08Z", "updated_at": "2022-11-13T19:34:29Z", "closed_at": "2022-11-13T18:58:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nDefault Locust installation is not working under M1 Mac.\r\n\r\nAlready read:\r\n- https://github.com/locustio/locust/issues/2115\r\n- https://github.com/locustio/locust/issues/1949\r\n\r\nI tried switching `gevent` versions to those shown on those PRs comments but failed to install  (`clang` compiler issues on other packages) on my machine. I include a log of the issue on the _Steps to Reproduce_, but here's a `pip freeze`'s output: \r\n\r\n```sh\r\nBrotli==1.0.9\r\ncertifi==2022.9.24\r\ncharset-normalizer==2.1.1\r\nclick==8.1.3\r\nConfigArgParse==1.5.3\r\nFlask==2.2.2\r\nFlask-BasicAuth==0.2.0\r\nFlask-Cors==3.0.10\r\ngevent==22.10.2\r\ngeventhttpclient==2.0.8\r\ngreenlet==2.0.1\r\nidna==3.4\r\nitsdangerous==2.1.2\r\nJinja2==3.1.2\r\nlocust==2.13.0\r\nMarkupSafe==2.1.1\r\nmsgpack==1.0.4\r\npsutil==5.9.4\r\npyzmq==24.0.1\r\nrequests==2.28.1\r\nroundrobin==0.0.4\r\nsix==1.16.0\r\ntyping_extensions==4.4.0\r\nurllib3==1.26.12\r\nWerkzeug==2.2.2\r\nzope.event==4.5.0\r\nzope.interface==5.5.1\r\n```\r\n\r\n### Expected behavior\r\nLocust to be installed and working on ARM-based Mac.\r\n\r\n### Actual behavior\r\nShows an issue with g-event.\r\n\r\n### Steps to reproduce\r\n```sh\r\n$ python3 -m venv ./venv && source ./venv/bin/activate && pip --version && python --version && uname -a && pip install locust && locust\r\n\r\n\r\npip 22.2.2 from /Users/humbertowoody/Proyectos/pago46/swarm-tester/venv/lib/python3.10/site-packages/pip (python 3.10)\r\nPython 3.10.8\r\nDarwin gojira.local 22.1.0 Darwin Kernel Version 22.1.0: Sun Oct  9 20:14:30 PDT 2022; root:xnu-8792.41.9~2/RELEASE_ARM64_T8103 arm64\r\nCollecting locust\r\n  Using cached locust-2.13.0-py3-none-any.whl (823 kB)\r\nCollecting psutil>=5.6.7\r\n  Using cached psutil-5.9.4-cp38-abi3-macosx_11_0_arm64.whl (244 kB)\r\nCollecting gevent>=20.12.1\r\n  Using cached gevent-22.10.2-cp310-cp310-macosx_10_9_universal2.whl (1.9 MB)\r\nCollecting Flask-BasicAuth>=0.2.0\r\n  Using cached Flask_BasicAuth-0.2.0-py3-none-any.whl\r\nCollecting typing-extensions>=3.7.4.3\r\n  Using cached typing_extensions-4.4.0-py3-none-any.whl (26 kB)\r\nCollecting geventhttpclient>=2.0.2\r\n  Using cached geventhttpclient-2.0.8-cp310-cp310-macosx_11_0_arm64.whl (42 kB)\r\nCollecting roundrobin>=0.0.2\r\n  Using cached roundrobin-0.0.4-py3-none-any.whl\r\nCollecting Werkzeug>=2.0.0\r\n  Using cached Werkzeug-2.2.2-py3-none-any.whl (232 kB)\r\nCollecting requests>=2.23.0\r\n  Using cached requests-2.28.1-py3-none-any.whl (62 kB)\r\nCollecting flask>=2.0.0\r\n  Using cached Flask-2.2.2-py3-none-any.whl (101 kB)\r\nCollecting ConfigArgParse>=1.0\r\n  Using cached ConfigArgParse-1.5.3-py3-none-any.whl (20 kB)\r\nCollecting pyzmq!=23.0.0,>=22.2.1\r\n  Using cached pyzmq-24.0.1-cp310-cp310-macosx_10_15_universal2.whl (1.8 MB)\r\nCollecting Flask-Cors>=3.0.10\r\n  Using cached Flask_Cors-3.0.10-py2.py3-none-any.whl (14 kB)\r\nCollecting msgpack>=0.6.2\r\n  Using cached msgpack-1.0.4-cp310-cp310-macosx_11_0_arm64.whl (69 kB)\r\nCollecting Jinja2>=3.0\r\n  Using cached Jinja2-3.1.2-py3-none-any.whl (133 kB)\r\nCollecting click>=8.0\r\n  Using cached click-8.1.3-py3-none-any.whl (96 kB)\r\nCollecting itsdangerous>=2.0\r\n  Using cached itsdangerous-2.1.2-py3-none-any.whl (15 kB)\r\nCollecting Six\r\n  Using cached six-1.16.0-py2.py3-none-any.whl (11 kB)\r\nCollecting zope.event\r\n  Using cached zope.event-4.5.0-py2.py3-none-any.whl (6.8 kB)\r\nCollecting zope.interface\r\n  Using cached zope.interface-5.5.1-cp310-cp310-macosx_12_0_arm64.whl\r\nRequirement already satisfied: setuptools in ./venv/lib/python3.10/site-packages (from gevent>=20.12.1->locust) (65.4.1)\r\nCollecting greenlet>=2.0.0\r\n  Using cached greenlet-2.0.1-cp310-cp310-macosx_12_0_arm64.whl\r\nCollecting certifi\r\n  Using cached certifi-2022.9.24-py3-none-any.whl (161 kB)\r\nCollecting brotli\r\n  Using cached Brotli-1.0.9-cp310-cp310-macosx_10_9_universal2.whl (786 kB)\r\nCollecting idna<4,>=2.5\r\n  Using cached idna-3.4-py3-none-any.whl (61 kB)\r\nCollecting charset-normalizer<3,>=2\r\n  Using cached charset_normalizer-2.1.1-py3-none-any.whl (39 kB)\r\nCollecting urllib3<1.27,>=1.21.1\r\n  Using cached urllib3-1.26.12-py2.py3-none-any.whl (140 kB)\r\nCollecting MarkupSafe>=2.1.1\r\n  Using cached MarkupSafe-2.1.1-cp310-cp310-macosx_10_9_universal2.whl (17 kB)\r\nInstalling collected packages: roundrobin, msgpack, brotli, zope.interface, zope.event, urllib3, typing-extensions, Six, pyzmq, psutil, MarkupSafe, itsdangerous, idna, greenlet, ConfigArgParse, click, charset-normalizer, certifi, Werkzeug, requests, Jinja2, gevent, geventhttpclient, flask, Flask-Cors, Flask-BasicAuth, locust\r\nSuccessfully installed ConfigArgParse-1.5.3 Flask-BasicAuth-0.2.0 Flask-Cors-3.0.10 Jinja2-3.1.2 MarkupSafe-2.1.1 Six-1.16.0 Werkzeug-2.2.2 brotli-1.0.9 certifi-2022.9.24 charset-normalizer-2.1.1 click-8.1.3 flask-2.2.2 gevent-22.10.2 geventhttpclient-2.0.8 greenlet-2.0.1 idna-3.4 itsdangerous-2.1.2 locust-2.13.0 msgpack-1.0.4 psutil-5.9.4 pyzmq-24.0.1 requests-2.28.1 roundrobin-0.0.4 typing-extensions-4.4.0 urllib3-1.26.12 zope.event-4.5.0 zope.interface-5.5.1\r\n\r\n[notice] A new release of pip available: 22.2.2 -> 22.3.1\r\n[notice] To update, run: pip install --upgrade pip\r\nTraceback (most recent call last):\r\n  File \"/Users/humbertowoody/Proyectos/pago46/swarm-tester/venv/bin/locust\", line 5, in <module>\r\n    from locust.main import main\r\n  File \"/Users/humbertowoody/Proyectos/pago46/swarm-tester/venv/lib/python3.10/site-packages/locust/__init__.py\", line 9, in <module>\r\n    from gevent import monkey\r\n  File \"/Users/humbertowoody/Proyectos/pago46/swarm-tester/venv/lib/python3.10/site-packages/gevent/__init__.py\", line 86, in <module>\r\n    from gevent._hub_local import get_hub\r\n  File \"/Users/humbertowoody/Proyectos/pago46/swarm-tester/venv/lib/python3.10/site-packages/gevent/_hub_local.py\", line 101, in <module>\r\n    import_c_accel(globals(), 'gevent.__hub_local')\r\n  File \"/Users/humbertowoody/Proyectos/pago46/swarm-tester/venv/lib/python3.10/site-packages/gevent/_util.py\", line 148, in import_c_accel\r\n    mod = importlib.import_module(cname)\r\n  File \"/opt/homebrew/Cellar/python@3.10/3.10.8/Frameworks/Python.framework/Versions/3.10/lib/python3.10/importlib/__init__.py\", line 126, in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\nImportError: dlopen(/Users/humbertowoody/Proyectos/pago46/swarm-tester/venv/lib/python3.10/site-packages/gevent/_gevent_c_hub_local.cpython-310-darwin.so, 0x0002): tried: '/Users/humbertowoody/Proyectos/pago46/swarm-tester/venv/lib/python3.10/site-packages/gevent/_gevent_c_hub_local.cpython-310-darwin.so' (mach-o file, but is an incompatible architecture (have 'x86_64', need 'arm64')), '/System/Volumes/Preboot/Cryptexes/OS/Users/humbertowoody/Proyectos/pago46/swarm-tester/venv/lib/python3.10/site-packages/gevent/_gevent_c_hub_local.cpython-310-darwin.so' (no such file), '/Users/humbertowoody/Proyectos/pago46/swarm-tester/venv/lib/python3.10/site-packages/gevent/_gevent_c_hub_local.cpython-310-darwin.so' (mach-o file, but is an incompatible architecture (have 'x86_64', need 'arm64'))\r\n```\r\n\r\nMy assumption is that I need to _lock_ some dependencies versions (`gevent` from what I read) in order to make it work but I'm unsure as to how to find the ones that should/would work on my setup. Also I tried updating `pip` to the patch version bump, but it made no difference on resolving `gevent`'s version.\r\n\r\n### Environment\r\n\r\n- OS: MacOS Ventura 13.0.1\r\n- Python version: 3.10.8\r\n- Locust version: 2.13.0\r\n- Locust command line that you ran: `locust` (expected help and/or error message)\r\n- Locust file contents (anonymized if necessary): don't even have a locustfile.py yet, was following installation instructions on locust.io. Thanks in advance! ", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2249/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2249/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2243", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2243/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2243/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2243/events", "html_url": "https://github.com/locustio/locust/issues/2243", "id": 1434894483, "node_id": "I_kwDOABUGS85VhsCT", "number": 2243, "title": "'Namespace' object has no attribute 'stop_timeout' in version 2.13.0", "user": {"login": "klazuka", "id": 84525, "node_id": "MDQ6VXNlcjg0NTI1", "avatar_url": "https://avatars.githubusercontent.com/u/84525?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klazuka", "html_url": "https://github.com/klazuka", "followers_url": "https://api.github.com/users/klazuka/followers", "following_url": "https://api.github.com/users/klazuka/following{/other_user}", "gists_url": "https://api.github.com/users/klazuka/gists{/gist_id}", "starred_url": "https://api.github.com/users/klazuka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klazuka/subscriptions", "organizations_url": "https://api.github.com/users/klazuka/orgs", "repos_url": "https://api.github.com/users/klazuka/repos", "events_url": "https://api.github.com/users/klazuka/events{/privacy}", "received_events_url": "https://api.github.com/users/klazuka/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-11-03T15:53:00Z", "updated_at": "2022-11-07T14:08:13Z", "closed_at": "2022-11-05T11:59:16Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\nAfter upgrading to 2.13.0, we started seeing the following error:\r\n```\r\n  File \"/path/to/app/venv/lib/python3.9/site-packages/locust/env.py\", line 84, in __init__\r\n    self.stop_timeout = float(parsed_options.stop_timeout)\r\nAttributeError: 'Namespace' object has no attribute 'stop_timeout'\r\n```\r\n\r\nWe are using Locust as a library, and when creating the Locust `Environment`, we are passing in a `Namespace` object for `parsed_options`. In old versions of Locust, we did not need to pass `stop_timeout`, but now it appears that we do. Is this intentional?\r\n\r\n### Expected behavior\r\nExisting code should continue to work after a minor version upgrade.\r\n\r\n### Actual behavior\r\nAn `AttributeError` exception is raised from within Locust.\r\n\r\n### Steps to reproduce\r\n\r\n```\r\nfrom argparse import Namespace\r\nfrom locust.env import Environment\r\nparsed_options = Namespace(timeout=42)\r\nEnvironment(parsed_options=parsed_options)\r\n```\r\n\r\n^ the above works in 2.12.0 but fails in 2.13.0\r\n\r\n### Environment\r\n\r\n- OS: Linux\r\n- Python version: 3.9.11\r\n- Locust version: 2.13.0\r\n- Locust command line that you ran: n/a\r\n- Locust file contents (anonymized if necessary): n/a", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2243/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2243/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2242", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2242/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2242/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2242/events", "html_url": "https://github.com/locustio/locust/issues/2242", "id": 1434468913, "node_id": "I_kwDOABUGS85VgEIx", "number": 2242, "title": "On distributed setup tick() doesn't get called every second", "user": {"login": "korayal", "id": 313801, "node_id": "MDQ6VXNlcjMxMzgwMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/313801?v=4", "gravatar_id": "", "url": "https://api.github.com/users/korayal", "html_url": "https://github.com/korayal", "followers_url": "https://api.github.com/users/korayal/followers", "following_url": "https://api.github.com/users/korayal/following{/other_user}", "gists_url": "https://api.github.com/users/korayal/gists{/gist_id}", "starred_url": "https://api.github.com/users/korayal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/korayal/subscriptions", "organizations_url": "https://api.github.com/users/korayal/orgs", "repos_url": "https://api.github.com/users/korayal/repos", "events_url": "https://api.github.com/users/korayal/events{/privacy}", "received_events_url": "https://api.github.com/users/korayal/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-11-03T11:00:22Z", "updated_at": "2022-12-30T02:00:21Z", "closed_at": "2022-12-30T02:00:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nI have a custom shape similar to the [Stages shape](https://github.com/locustio/locust/blob/master/examples/custom_shape/stages.py) example. But I also added logging to observe every tick() call.\r\n\r\nWhen I run in distributed setup, I am not seeing that `TICKING` log every second after the test starts.\r\n\r\n### Expected behavior\r\nThe `tick()` method of the shape should be called every second, regardless of the current user count.\r\n\r\n### Actual behavior\r\n`tick()` method only gets called when targeted user_count of a shape has been reached.\r\n\r\n### Steps to reproduce\r\n\r\nFirst run:\r\n```\r\nlocust -f locust_test.py --headless --host http://nope  --only-summary\r\n```\r\nObserve `TICKING` logs for 40 seconds, and the process gets terminated:\r\n```\r\n[2022-11-03 13:58:35,139] C02FP2YUMD6T/INFO/locust.runners: Shape test starting. User count and spawn rate are ignored for this type of load test\r\n[2022-11-03 13:58:35,140] C02FP2YUMD6T/INFO/locust.runners: Shape worker starting\r\n[2022-11-03 13:58:35,140] C02FP2YUMD6T/INFO/root: TICKING: 0\r\n[2022-11-03 13:58:35,140] C02FP2YUMD6T/INFO/locust.runners: Shape test updating to 15 users at 1.00 spawn rate\r\n[2022-11-03 13:58:35,140] C02FP2YUMD6T/INFO/root: TICKING: 0\r\n[2022-11-03 13:58:35,140] C02FP2YUMD6T/INFO/locust.runners: Ramping to 15 users at a rate of 1.00 per second\r\n[2022-11-03 13:58:36,141] C02FP2YUMD6T/INFO/root: TICKING: 1\r\n[2022-11-03 13:58:37,143] C02FP2YUMD6T/INFO/root: TICKING: 2\r\n[2022-11-03 13:58:38,144] C02FP2YUMD6T/INFO/root: TICKING: 3\r\n[2022-11-03 13:58:39,147] C02FP2YUMD6T/INFO/root: TICKING: 4\r\n[2022-11-03 13:58:40,147] C02FP2YUMD6T/INFO/root: TICKING: 5\r\n[2022-11-03 13:58:41,147] C02FP2YUMD6T/INFO/root: TICKING: 6\r\n[2022-11-03 13:58:42,148] C02FP2YUMD6T/INFO/root: TICKING: 7\r\n[2022-11-03 13:58:43,149] C02FP2YUMD6T/INFO/root: TICKING: 8\r\n[2022-11-03 13:58:44,149] C02FP2YUMD6T/INFO/root: TICKING: 9\r\n[2022-11-03 13:58:45,150] C02FP2YUMD6T/INFO/root: TICKING: 10\r\n[2022-11-03 13:58:45,150] C02FP2YUMD6T/INFO/locust.runners: Shape test updating to 25 users at 1.00 spawn rate\r\n[2022-11-03 13:58:45,151] C02FP2YUMD6T/INFO/root: TICKING: 11\r\n[2022-11-03 13:58:45,152] C02FP2YUMD6T/INFO/locust.runners: Ramping to 25 users at a rate of 1.00 per second\r\n[2022-11-03 13:58:46,152] C02FP2YUMD6T/INFO/root: TICKING: 12\r\n[2022-11-03 13:58:47,152] C02FP2YUMD6T/INFO/root: TICKING: 13\r\n[2022-11-03 13:58:48,153] C02FP2YUMD6T/INFO/root: TICKING: 14\r\n[2022-11-03 13:58:49,153] C02FP2YUMD6T/INFO/root: TICKING: 15\r\n[2022-11-03 13:58:50,154] C02FP2YUMD6T/INFO/root: TICKING: 16\r\n[2022-11-03 13:58:51,154] C02FP2YUMD6T/INFO/root: TICKING: 17\r\n[2022-11-03 13:58:52,154] C02FP2YUMD6T/INFO/root: TICKING: 18\r\n[2022-11-03 13:58:53,155] C02FP2YUMD6T/INFO/root: TICKING: 19\r\n[2022-11-03 13:58:54,155] C02FP2YUMD6T/INFO/root: TICKING: 20\r\n[2022-11-03 13:58:55,155] C02FP2YUMD6T/INFO/root: TICKING: 21\r\n[2022-11-03 13:58:55,156] C02FP2YUMD6T/INFO/locust.runners: Shape test stopping\r\n[2022-11-03 13:58:55,158] C02FP2YUMD6T/INFO/locust.main: --run-time limit reached, shutting down\r\n[2022-11-03 13:58:55,158] C02FP2YUMD6T/INFO/locust.main: Starting Locust 2.13.0\r\n[2022-11-03 13:58:55,158] C02FP2YUMD6T/INFO/locust.main: Shutting down (exit code 0)\r\n```\r\n\r\nThen run:\r\n```\r\nlocust -f locust_test.py --headless --host http://nope --master --expect-workers 1 --only-summary\r\n```\r\nand on a separate terminal\r\n```\r\nlocust -f locust_test.py --headless --host http://nope --worker --master-host localhost\r\n```\r\nThen observe that tick gets called only when the target shape is accomplished:\r\n```\r\n[2022-11-03 13:56:00,509] korayal/INFO/root: Waiting for workers to be ready, 0 of 1 connected\r\n[2022-11-03 13:56:01,511] korayal/INFO/root: Waiting for workers to be ready, 0 of 1 connected\r\n[2022-11-03 13:56:02,513] korayal/INFO/root: Waiting for workers to be ready, 0 of 1 connected\r\n[2022-11-03 13:56:03,518] korayal/INFO/root: Waiting for workers to be ready, 0 of 1 connected\r\n[2022-11-03 13:56:04,522] korayal/INFO/root: Waiting for workers to be ready, 0 of 1 connected\r\n[2022-11-03 13:56:05,522] korayal/INFO/root: Waiting for workers to be ready, 0 of 1 connected\r\n[2022-11-03 13:56:06,526] korayal/INFO/root: Waiting for workers to be ready, 0 of 1 connected\r\n[2022-11-03 13:56:06,665] korayal/INFO/locust.runners: Worker korayal_1f7729705dcf4a4f85fdde83930709f3 (index 0) reported as ready. 1 workers connected.\r\n[2022-11-03 13:56:07,528] korayal/INFO/locust.runners: Shape test starting. User count and spawn rate are ignored for this type of load test\r\n[2022-11-03 13:56:07,528] korayal/INFO/locust.runners: Shape worker starting\r\n[2022-11-03 13:56:07,528] korayal/INFO/root: TICKING: 0\r\n[2022-11-03 13:56:07,528] korayal/INFO/locust.runners: Shape test updating to 15 users at 1.00 spawn rate\r\n[2022-11-03 13:56:07,528] korayal/INFO/locust.runners: Sending spawn jobs of 15 users at 1.00 spawn rate to 1 ready workers\r\n[2022-11-03 13:56:21,629] korayal/INFO/locust.runners: All users spawned: {\"WebsiteUser\": 15} (15 total users)\r\n[2022-11-03 13:56:21,629] korayal/INFO/root: TICKING: 15\r\n[2022-11-03 13:56:21,629] korayal/INFO/locust.runners: Shape test updating to 25 users at 1.00 spawn rate\r\n[2022-11-03 13:56:21,629] korayal/INFO/locust.runners: Sending spawn jobs of 25 users at 1.00 spawn rate to 1 ready workers\r\n[2022-11-03 13:56:30,734] korayal/INFO/locust.runners: All users spawned: {\"WebsiteUser\": 25} (25 total users)\r\n[2022-11-03 13:56:30,734] korayal/INFO/root: TICKING: 25\r\n[2022-11-03 13:56:30,734] korayal/INFO/locust.runners: Shape test stopping\r\n[2022-11-03 13:56:30,738] korayal/INFO/locust.runners: Worker 'korayal_1f7729705dcf4a4f85fdde83930709f3' (index 0) quit. 0 workers ready.\r\n[2022-11-03 13:56:30,738] korayal/INFO/locust.runners: The last worker quit, stopping test.\r\n[2022-11-03 13:56:31,237] korayal/INFO/locust.main: --run-time limit reached, shutting down\r\n[2022-11-03 13:56:31,742] korayal/INFO/locust.main: Starting Locust 2.13.0\r\n[2022-11-03 13:56:32,242] korayal/INFO/locust.main: Shutting down (exit code 0)\r\n```\r\n\r\n### Environment\r\n\r\n- OS: MacOS\r\n- Python version: 3.10.8\r\n- Locust version: 2.13.0\r\n\r\n- Locust file contents (anonymized if necessary):\r\n``` python\r\n# locust_test.py\r\n\r\nfrom locust import HttpUser, TaskSet, task, constant\r\nfrom locust import LoadTestShape\r\nimport logging\r\n\r\n\r\nclass UserTasks(TaskSet):\r\n    @task\r\n    def get_root(self):\r\n        return True\r\n\r\n\r\nclass WebsiteUser(HttpUser):\r\n    wait_time = constant(5)\r\n    tasks = [UserTasks]\r\n\r\n\r\nclass StagesShape(LoadTestShape):\r\n    \"\"\"\r\n    A simply load test shape class that has different user and spawn_rate at\r\n    different stages.\r\n    Keyword arguments:\r\n        stages -- A list of dicts, each representing a stage with the following keys:\r\n            duration -- When this many seconds pass the test is advanced to the next stage\r\n            users -- Total user count\r\n            spawn_rate -- Number of users to start/stop per second\r\n            stop -- A boolean that can stop that test at a specific stage\r\n        stop_at_end -- Can be set to stop once all stages have run.\r\n    \"\"\"\r\n\r\n    stages = [\r\n        {\"duration\": 10, \"users\": 15, \"spawn_rate\": 1},\r\n        {\"duration\": 20, \"users\": 25, \"spawn_rate\": 1},\r\n    ]\r\n\r\n    def tick(self):\r\n        logging.info(f\"TICKING: {self.runner.user_count}\")\r\n        run_time = self.get_run_time()\r\n\r\n        for stage in self.stages:\r\n            if run_time < stage[\"duration\"]:\r\n                tick_data = (stage[\"users\"], stage[\"spawn_rate\"])\r\n                return tick_data\r\n\r\n        return None\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2242/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2242/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2241", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2241/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2241/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2241/events", "html_url": "https://github.com/locustio/locust/issues/2241", "id": 1431997491, "node_id": "I_kwDOABUGS85VWowz", "number": 2241, "title": "Locust can't seem to process custom SQLAlchemy ChoiceType?", "user": {"login": "theochit", "id": 17465880, "node_id": "MDQ6VXNlcjE3NDY1ODgw", "avatar_url": "https://avatars.githubusercontent.com/u/17465880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/theochit", "html_url": "https://github.com/theochit", "followers_url": "https://api.github.com/users/theochit/followers", "following_url": "https://api.github.com/users/theochit/following{/other_user}", "gists_url": "https://api.github.com/users/theochit/gists{/gist_id}", "starred_url": "https://api.github.com/users/theochit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/theochit/subscriptions", "organizations_url": "https://api.github.com/users/theochit/orgs", "repos_url": "https://api.github.com/users/theochit/repos", "events_url": "https://api.github.com/users/theochit/events{/privacy}", "received_events_url": "https://api.github.com/users/theochit/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-11-01T19:48:35Z", "updated_at": "2022-11-01T21:21:58Z", "closed_at": "2022-11-01T21:21:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nI have a model that uses ChoiceType like an enum for my API. When I try to import this model into my `locustfile.py`, i get errors like this:\r\n```    \r\nfrom sqlalchemy_utils import ChoiceType\r\n  File \"/Users/theo/.local/share/virtualenvs/optis2-data-service-iqC41Vso/lib/python3.9/site-packages/sqlalchemy_utils/__init__.py\", line 59, in <module>\r\n    from .types import (  # noqa\r\n  File \"/Users/theo/.local/share/virtualenvs/optis2-data-service-iqC41Vso/lib/python3.9/site-packages/sqlalchemy_utils/types/__init__.py\", line 42, in <module>\r\n    from .uuid import UUIDType  # noqa\r\n  File \"/Users/theo/.local/share/virtualenvs/optis2-data-service-iqC41Vso/lib/python3.9/site-packages/sqlalchemy_utils/types/uuid.py\", line 8, in <module>\r\n    sqlalchemy_version = tuple([int(v) for v in __version__.split(\".\")])\r\n  File \"/Users/theo/.local/share/virtualenvs/optis2-data-service-iqC41Vso/lib/python3.9/site-packages/sqlalchemy_utils/types/uuid.py\", line 8, in <listcomp>\r\n    sqlalchemy_version = tuple([int(v) for v in __version__.split(\".\")])\r\nValueError: invalid literal for int() with base 10: '0b2'\r\n```\r\n\r\nIf I remove any imports that involve this ChoiceType enum, locust seems to run fine. Most importantly I want to be able to import a pydantic schema that uses this type, so I can provide the endpoint I'm load testing with a proper object.\r\n\r\nIs there anything I can do to support this? ", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2241/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2241/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2236", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2236/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2236/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2236/events", "html_url": "https://github.com/locustio/locust/issues/2236", "id": 1420997219, "node_id": "I_kwDOABUGS85UsrJj", "number": 2236, "title": "Response codes of 0 are not being reported as request events, but are reported as an HTTP failure", "user": {"login": "jmfiola", "id": 29436153, "node_id": "MDQ6VXNlcjI5NDM2MTUz", "avatar_url": "https://avatars.githubusercontent.com/u/29436153?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jmfiola", "html_url": "https://github.com/jmfiola", "followers_url": "https://api.github.com/users/jmfiola/followers", "following_url": "https://api.github.com/users/jmfiola/following{/other_user}", "gists_url": "https://api.github.com/users/jmfiola/gists{/gist_id}", "starred_url": "https://api.github.com/users/jmfiola/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jmfiola/subscriptions", "organizations_url": "https://api.github.com/users/jmfiola/orgs", "repos_url": "https://api.github.com/users/jmfiola/repos", "events_url": "https://api.github.com/users/jmfiola/events{/privacy}", "received_events_url": "https://api.github.com/users/jmfiola/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-10-24T15:13:29Z", "updated_at": "2022-11-16T02:14:54Z", "closed_at": "2022-11-16T02:14:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nIf there is some response code of 0, then it is not reported as a request event, but it is reported as an HTTP failure\r\n\r\n### Expected behavior\r\nThe response is recorded as both a request event and a failure\r\n\r\n### Actual behavior\r\nit is not reported as a request event, but it is reported as an HTTP failure\r\n\r\n### Steps to reproduce\r\nCreate some request where the host responds with a 0 and raises the following error in event: `requests.exceptions.ConnectionError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))`\r\n\r\n### Environment\r\n\r\n- OS: Mac OS monterey\r\n- Python version: 3.10\r\n- Locust version: 2.8.6\r\n- Locust command line that you ran: N/A\r\n- Locust file contents (anonymized if necessary): N/A", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2236/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2236/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2232", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2232/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2232/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2232/events", "html_url": "https://github.com/locustio/locust/issues/2232", "id": 1415236780, "node_id": "I_kwDOABUGS85UWsys", "number": 2232, "title": "`LoadTestShape` not included in the API docs", "user": {"login": "rijenkii", "id": 5338332, "node_id": "MDQ6VXNlcjUzMzgzMzI=", "avatar_url": "https://avatars.githubusercontent.com/u/5338332?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rijenkii", "html_url": "https://github.com/rijenkii", "followers_url": "https://api.github.com/users/rijenkii/followers", "following_url": "https://api.github.com/users/rijenkii/following{/other_user}", "gists_url": "https://api.github.com/users/rijenkii/gists{/gist_id}", "starred_url": "https://api.github.com/users/rijenkii/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rijenkii/subscriptions", "organizations_url": "https://api.github.com/users/rijenkii/orgs", "repos_url": "https://api.github.com/users/rijenkii/repos", "events_url": "https://api.github.com/users/rijenkii/events{/privacy}", "received_events_url": "https://api.github.com/users/rijenkii/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-10-19T16:00:50Z", "updated_at": "2022-10-19T16:29:00Z", "closed_at": "2022-10-19T16:29:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n`LoadTestShape` is not included in the [`/docs/api.rst`](https://github.com/locustio/locust/blob/master/docs/api.rst) file.\r\n\r\n### Expected behavior\r\nN/A\r\n\r\n### Actual behavior\r\nN/A\r\n\r\n### Steps to reproduce\r\n1. https://docs.locust.io/en/latest/api.html\r\n2. Ctrl+F \"LoadTestShape\"\r\n\r\n### Environment\r\nN/A", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2232/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2232/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2230", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2230/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2230/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2230/events", "html_url": "https://github.com/locustio/locust/issues/2230", "id": 1412714265, "node_id": "I_kwDOABUGS85UNE8Z", "number": 2230, "title": "File upload unsuccessful with client.post but works with requests.post", "user": {"login": "fayasbasha", "id": 99861946, "node_id": "U_kgDOBfPFug", "avatar_url": "https://avatars.githubusercontent.com/u/99861946?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fayasbasha", "html_url": "https://github.com/fayasbasha", "followers_url": "https://api.github.com/users/fayasbasha/followers", "following_url": "https://api.github.com/users/fayasbasha/following{/other_user}", "gists_url": "https://api.github.com/users/fayasbasha/gists{/gist_id}", "starred_url": "https://api.github.com/users/fayasbasha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fayasbasha/subscriptions", "organizations_url": "https://api.github.com/users/fayasbasha/orgs", "repos_url": "https://api.github.com/users/fayasbasha/repos", "events_url": "https://api.github.com/users/fayasbasha/events{/privacy}", "received_events_url": "https://api.github.com/users/fayasbasha/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-10-18T07:30:43Z", "updated_at": "2022-11-10T12:27:14Z", "closed_at": "2022-10-25T09:09:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "File upload with same set of parameters in requests works whereas in locust client.post is unable to upload a file and returns 500 everytime", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2230/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2230/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2226", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2226/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2226/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2226/events", "html_url": "https://github.com/locustio/locust/issues/2226", "id": 1410325594, "node_id": "I_kwDOABUGS85UD9xa", "number": 2226, "title": "ERROR: Failed building wheel for gevent when installing Locust", "user": {"login": "tuna0909", "id": 42055071, "node_id": "MDQ6VXNlcjQyMDU1MDcx", "avatar_url": "https://avatars.githubusercontent.com/u/42055071?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tuna0909", "html_url": "https://github.com/tuna0909", "followers_url": "https://api.github.com/users/tuna0909/followers", "following_url": "https://api.github.com/users/tuna0909/following{/other_user}", "gists_url": "https://api.github.com/users/tuna0909/gists{/gist_id}", "starred_url": "https://api.github.com/users/tuna0909/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tuna0909/subscriptions", "organizations_url": "https://api.github.com/users/tuna0909/orgs", "repos_url": "https://api.github.com/users/tuna0909/repos", "events_url": "https://api.github.com/users/tuna0909/events{/privacy}", "received_events_url": "https://api.github.com/users/tuna0909/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-10-16T00:13:15Z", "updated_at": "2022-10-16T08:52:27Z", "closed_at": "2022-10-16T08:48:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nERROR: Could not build wheels for gevent, which is required to install pyproject.toml-based projects when install Locust\r\n\r\n### Expected behavior\r\nLocust is installed successfully \r\n\r\n### Actual behavior\r\n\u2718 Installation Failed \r\n\r\n```\r\ntu@Yans-MacBook-Pro locust-py % pipenv install locust\r\nInstalling locust...\r\nError:  An error occurred while installing locust!\r\nError text: Collecting locust\r\n  Using cached locust-2.12.2-py3-none-any.whl (823 kB)\r\nCollecting roundrobin>=0.0.2\r\n  Using cached roundrobin-0.0.4-py3-none-any.whl\r\nCollecting typing-extensions>=3.7.4.3\r\n  Using cached typing_extensions-4.4.0-py3-none-any.whl (26 kB)\r\nCollecting gevent>=20.12.1\r\n  Using cached gevent-22.10.1.tar.gz (6.5 MB)\r\n  Installing build dependencies: started\r\n  Installing build dependencies: finished with status 'done'\r\n  Getting requirements to build wheel: started\r\n  Getting requirements to build wheel: finished with status 'done'\r\n  Installing backend dependencies: started\r\n  Installing backend dependencies: finished with status 'done'\r\n  Preparing metadata (pyproject.toml): started\r\n  Preparing metadata (pyproject.toml): finished with status 'done'\r\nCollecting flask>=2.0.0\r\n  Using cached Flask-2.2.2-py3-none-any.whl (101 kB)\r\nCollecting msgpack>=0.6.2\r\n  Using cached msgpack-1.0.4-cp310-cp310-macosx_10_9_x86_64.whl (74 kB)\r\nCollecting pyzmq!=23.0.0,>=22.2.1\r\n  Using cached pyzmq-24.0.1-cp310-cp310-macosx_10_15_universal2.whl (1.8 MB)\r\nCollecting Werkzeug>=2.0.0\r\n  Using cached Werkzeug-2.2.2-py3-none-any.whl (232 kB)\r\nCollecting geventhttpclient>=2.0.2\r\n  Using cached geventhttpclient-2.0.8-cp310-cp310-macosx_10_9_x86_64.whl (42 kB)\r\nCollecting Flask-Cors>=3.0.10\r\n  Using cached Flask_Cors-3.0.10-py2.py3-none-any.whl (14 kB)\r\nCollecting requests>=2.23.0\r\n  Using cached requests-2.28.1-py3-none-any.whl (62 kB)\r\nCollecting ConfigArgParse>=1.0\r\n  Using cached ConfigArgParse-1.5.3-py3-none-any.whl (20 kB)\r\nCollecting Flask-BasicAuth>=0.2.0\r\n  Using cached Flask_BasicAuth-0.2.0-py3-none-any.whl\r\nCollecting psutil>=5.6.7\r\n  Using cached psutil-5.9.2-cp310-cp310-macosx_10_9_x86_64.whl (239 kB)\r\nCollecting Jinja2>=3.0\r\n  Using cached Jinja2-3.1.2-py3-none-any.whl (133 kB)\r\nCollecting click>=8.0\r\n  Using cached click-8.1.3-py3-none-any.whl (96 kB)\r\nCollecting itsdangerous>=2.0\r\n  Using cached itsdangerous-2.1.2-py3-none-any.whl (15 kB)\r\nCollecting Six\r\n  Using cached six-1.16.0-py2.py3-none-any.whl (11 kB)\r\nCollecting zope.interface\r\n  Using cached zope.interface-5.5.0-cp310-cp310-macosx_11_0_x86_64.whl (210 kB)\r\nCollecting greenlet<2.0,>=1.1.3\r\n  Using cached greenlet-1.1.3.post0-cp310-cp310-macosx_10_15_x86_64.whl (93 kB)\r\nCollecting zope.event\r\n  Using cached zope.event-4.5.0-py2.py3-none-any.whl (6.8 kB)\r\nRequirement already satisfied: setuptools in /Users/tu/.local/share/virtualenvs/locust-py--yU_S3D0/lib/python3.10/site-packages (from gevent>=20.12.1->locust->-r /var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pipenv-_sjpy_em-requirements/pipenv-k3yuverh-requirement.txt (line 1)) (65.3.0)\r\nCollecting brotli\r\n  Using cached Brotli-1.0.9-cp310-cp310-macosx_10_9_x86_64.whl (421 kB)\r\nCollecting certifi\r\n  Using cached certifi-2022.9.24-py3-none-any.whl (161 kB)\r\nCollecting charset-normalizer<3,>=2\r\n  Using cached charset_normalizer-2.1.1-py3-none-any.whl (39 kB)\r\nCollecting idna<4,>=2.5\r\n  Using cached idna-3.4-py3-none-any.whl (61 kB)\r\nCollecting urllib3<1.27,>=1.21.1\r\n  Using cached urllib3-1.26.12-py2.py3-none-any.whl (140 kB)\r\nCollecting MarkupSafe>=2.1.1\r\n  Using cached MarkupSafe-2.1.1-cp310-cp310-macosx_10_9_x86_64.whl (13 kB)\r\nBuilding wheels for collected packages: gevent\r\n  Building wheel for gevent (pyproject.toml): started\r\n  Building wheel for gevent (pyproject.toml): finished with status 'error'\r\nFailed to build gevent\r\n\r\n  error: subprocess-exited-with-error\r\n  \r\n  \u00d7 Building wheel for gevent (pyproject.toml) did not run successfully.\r\n  \u2502 exit code: 1\r\n  \u2570\u2500> [351 lines of output]\r\n      running bdist_wheel\r\n      running build\r\n      running build_py\r\n      creating build\r\n      creating build/lib.macosx-10.9-universal2-cpython-310\r\n      creating build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/queue.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_greenlet_primitives.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/greenlet.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/backdoor.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/time.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_semaphore.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/pywsgi.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_tracer.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_hub_local.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_imap.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/event.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/server.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/thread.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_util_py2.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/signal.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_monitor.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_ssl3.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/util.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/builtins.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/events.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/local.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/threadpool.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/subprocess.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_socketcommon.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/timeout.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/os.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/__init__.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_interfaces.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/selectors.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/core.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_ssl2.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/fileobject.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/contextvars.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_fileobjectcommon.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/hub.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_socket2.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/threading.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/win32util.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/resolver_ares.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/baseserver.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_waiter.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_hub_primitives.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_fileobjectposix.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_util.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/ares.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/lock.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_sslgte279.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_socket3.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/monkey.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_patcher.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_abstract_linkable.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/exceptions.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/select.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_compat.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_threading.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_config.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/ssl.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/socket.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/pool.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_ident.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/resolver_thread.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      copying src/gevent/_tblib.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent\r\n      creating build/lib.macosx-10.9-universal2-cpython-310/gevent/libuv\r\n      copying src/gevent/libuv/_corecffi_build.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/libuv\r\n      copying src/gevent/libuv/__init__.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/libuv\r\n      copying src/gevent/libuv/loop.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/libuv\r\n      copying src/gevent/libuv/watcher.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/libuv\r\n      creating build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__issue639.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__socket_dns.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__core.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__issue330.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__issue112.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__socket.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__subprocess_poll.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__threading.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__core_async.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/_imports_at_top_level.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__select.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__iwait.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__socketpair.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__monkey_sigchld.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/lock_tests.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__core_stat.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__makefile_ref.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__ssl.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__issue1686.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__greenness.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__example_udp_client.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__examples.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__util.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__core_watcher.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__monkey_module_run.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__example_wsgiserver_ssl.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__ares_timeout.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__socket_dns6.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test___ident.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__threading_vs_settrace.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__issue230.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__timeout.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__close_backend_fd.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__sleep0.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__monkey_hub_in_thread.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__monkey_futures_thread.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__threading_no_monkey.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__os.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__threading_patched_local.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__all__.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__issue607.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__hub_join.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test___monkey_patching.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__import_wait.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__socket_send_memoryview.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__server_pywsgi.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__fileobject.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__monkey_builtins_future.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__monkey_select.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/_blocks_at_top_level.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__import_blocking_in_greenlet.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__core_callback.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__issue_728.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__monkey_sigchld_2.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__threading_monkey_in_thread.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__example_udp_server.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/__init__.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__destroy.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__threadpool.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__monkey_sigchld_3.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__monkey.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/known_failures.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/_imports_imports_at_top_level.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__subprocess.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__threading_before_monkey.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__api.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__hub_join_timeout.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__monkey_multiple_imports.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__joinall.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__monkey_logging.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__nondefaultloop.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__core_loop_run.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__example_wsgiserver.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__greenletset.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__backdoor.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__GreenletExit.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__refcount.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__refcount_core.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__hub.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__doctests.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__greenlet.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test___config.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__resolver_dnspython.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/_import_wait.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__destroy_default_loop.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__core_timer.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__issues461_471.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__issue6.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__events.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__greenio.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__environ.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__getaddrinfo_import.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__example_webproxy.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__threading_native_before_monkey.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__local.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__api_timeout.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__issue467.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__threading_holding_lock_while_monkey.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__monkey_selectors.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__socket_close.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__pool.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__order.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test___monitor.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__issue600.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__memleak.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__execmodules.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__contextvars.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__example_portforwarder.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__systemerror.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__exc_info.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__socket_ex.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__socket_errors.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__lock.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__server.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__issue1864.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__socket_timeout.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__pywsgi.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__semaphore.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__core_fork.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__monkey_ssl_warning3.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__loop_callback.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/getaddrinfo_module.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__threadpool_executor_patched.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__subprocess_interrupted.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__real_greenlet.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__selectors.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__ares_host_result.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__monkey_ssl_warning2.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__example_echoserver.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/_import_import_patch.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/__main__.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__queue.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__socket_ssl.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__monkey_ssl_warning.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__threading_2.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__event.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__signal.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/_import_patch.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__compat.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__monkey_queue.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test__thread.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      creating build/lib.macosx-10.9-universal2-cpython-310/gevent/_ffi\r\n      copying src/gevent/_ffi/callback.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/_ffi\r\n      copying src/gevent/_ffi/__init__.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/_ffi\r\n      copying src/gevent/_ffi/loop.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/_ffi\r\n      copying src/gevent/_ffi/watcher.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/_ffi\r\n      creating build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/skipping.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/patched_tests_setup.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/exception.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/params.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/leakcheck.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/travis.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/support.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/testcase.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/util.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/monkey_test.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/switching.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/__init__.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/hub.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/timing.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/six.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/sysinfo.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/resources.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/sockets.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/modules.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/openfiles.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/errorhandler.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/testrunner.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      copying src/gevent/testing/flaky.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing\r\n      creating build/lib.macosx-10.9-universal2-cpython-310/gevent/libev\r\n      copying src/gevent/libev/_corecffi_build.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/libev\r\n      copying src/gevent/libev/__init__.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/libev\r\n      copying src/gevent/libev/corecffi.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/libev\r\n      copying src/gevent/libev/watcher.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/libev\r\n      creating build/lib.macosx-10.9-universal2-cpython-310/gevent/resolver\r\n      copying src/gevent/resolver/thread.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/resolver\r\n      copying src/gevent/resolver/dnspython.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/resolver\r\n      copying src/gevent/resolver/__init__.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/resolver\r\n      copying src/gevent/resolver/_addresses.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/resolver\r\n      copying src/gevent/resolver/ares.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/resolver\r\n      copying src/gevent/resolver/blocking.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/resolver\r\n      copying src/gevent/resolver/_hostsfile.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/resolver\r\n      creating build/lib.macosx-10.9-universal2-cpython-310/gevent/tests/monkey_package\r\n      copying src/gevent/tests/monkey_package/threadpool_no_monkey.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests/monkey_package\r\n      copying src/gevent/tests/monkey_package/__init__.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests/monkey_package\r\n      copying src/gevent/tests/monkey_package/issue1526_with_monkey.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests/monkey_package\r\n      copying src/gevent/tests/monkey_package/issue1526_no_monkey.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests/monkey_package\r\n      copying src/gevent/tests/monkey_package/threadpool_monkey_patches.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests/monkey_package\r\n      copying src/gevent/tests/monkey_package/issue302monkey.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests/monkey_package\r\n      copying src/gevent/tests/monkey_package/script.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests/monkey_package\r\n      copying src/gevent/tests/monkey_package/__main__.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests/monkey_package\r\n      copying src/gevent/tests/sha256.pem -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/nullcert.pem -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/https_svn_python_org_root.pem -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/wrongcert.pem -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/keycert.pem -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/2_7_keycert.pem -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/badkey.pem -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/badcert.pem -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/server.crt -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test_server.crt -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/tests_that_dont_monkeypatch.txt -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/tests_that_dont_do_leakchecks.txt -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/hosts_file.txt -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/tests_that_dont_use_resolver.txt -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/test_server.key -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      copying src/gevent/tests/server.key -> build/lib.macosx-10.9-universal2-cpython-310/gevent/tests\r\n      creating build/lib.macosx-10.9-universal2-cpython-310/gevent/testing/coveragesite\r\n      copying src/gevent/testing/coveragesite/sitecustomize.py -> build/lib.macosx-10.9-universal2-cpython-310/gevent/testing/coveragesite\r\n      warning: build_py: byte-compiling is disabled, skipping.\r\n      \r\n      running build_ext\r\n      generating cffi module 'build/temp.macosx-10.9-universal2-cpython-310/gevent.libuv._corecffi.c'\r\n      creating build/temp.macosx-10.9-universal2-cpython-310\r\n      Running '(cd  \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-install-ean31kds/gevent_31ac438a728f499f901036ad42433a34/deps/libev\"  && sh ./configure -C > configure-output.txt )' in /private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-install-ean31kds/gevent_31ac438a728f499f901036ad42433a34\r\n      configure: error: in `/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-install-ean31kds/gevent_31ac438a728f499f901036ad42433a34/deps/libev':\r\n      configure: error: C compiler cannot create executables\r\n      See `config.log' for more details\r\n      Traceback (most recent call last):\r\n        File \"/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/pipenv/patched/pip/_vendor/pep517/in_process/_in_process.py\", line 363, in <module>\r\n          main()\r\n        File \"/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/pipenv/patched/pip/_vendor/pep517/in_process/_in_process.py\", line 345, in main\r\n          json_out['return_val'] = hook(**hook_input['kwargs'])\r\n        File \"/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/pipenv/patched/pip/_vendor/pep517/in_process/_in_process.py\", line 261, in build_wheel\r\n          return _build_backend().build_wheel(wheel_directory, config_settings,\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-build-env-4ay0um8z/overlay/lib/python3.10/site-packages/setuptools/build_meta.py\", line 412, in build_wheel\r\n          return self._build_with_temp_dir(['bdist_wheel'], '.whl',\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-build-env-4ay0um8z/overlay/lib/python3.10/site-packages/setuptools/build_meta.py\", line 397, in _build_with_temp_dir\r\n          self.run_setup()\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-build-env-4ay0um8z/overlay/lib/python3.10/site-packages/setuptools/build_meta.py\", line 335, in run_setup\r\n          exec(code, locals())\r\n        File \"<string>\", line 494, in <module>\r\n        File \"<string>\", line 360, in run_setup\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-build-env-4ay0um8z/overlay/lib/python3.10/site-packages/setuptools/__init__.py\", line 87, in setup\r\n          return distutils.core.setup(**attrs)\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-build-env-4ay0um8z/overlay/lib/python3.10/site-packages/setuptools/_distutils/core.py\", line 185, in setup\r\n          return run_commands(dist)\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-build-env-4ay0um8z/overlay/lib/python3.10/site-packages/setuptools/_distutils/core.py\", line 201, in run_commands\r\n          dist.run_commands()\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-build-env-4ay0um8z/overlay/lib/python3.10/site-packages/setuptools/_distutils/dist.py\", line 968, in run_commands\r\n          self.run_command(cmd)\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-build-env-4ay0um8z/overlay/lib/python3.10/site-packages/setuptools/dist.py\", line 1217, in run_command\r\n          super().run_command(command)\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-build-env-4ay0um8z/overlay/lib/python3.10/site-packages/setuptools/_distutils/dist.py\", line 987, in run_command\r\n          cmd_obj.run()\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-build-env-4ay0um8z/normal/lib/python3.10/site-packages/wheel/bdist_wheel.py\", line 299, in run\r\n          self.run_command('build')\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-build-env-4ay0um8z/overlay/lib/python3.10/site-packages/setuptools/_distutils/cmd.py\", line 319, in run_command\r\n          self.distribution.run_command(command)\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-build-env-4ay0um8z/overlay/lib/python3.10/site-packages/setuptools/dist.py\", line 1217, in run_command\r\n          super().run_command(command)\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-build-env-4ay0um8z/overlay/lib/python3.10/site-packages/setuptools/_distutils/dist.py\", line 987, in run_command\r\n          cmd_obj.run()\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-build-env-4ay0um8z/overlay/lib/python3.10/site-packages/setuptools/_distutils/command/build.py\", line 132, in run\r\n          self.run_command(cmd_name)\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-build-env-4ay0um8z/overlay/lib/python3.10/site-packages/setuptools/_distutils/cmd.py\", line 319, in run_command\r\n          self.distribution.run_command(command)\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-build-env-4ay0um8z/overlay/lib/python3.10/site-packages/setuptools/dist.py\", line 1217, in run_command\r\n          super().run_command(command)\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-build-env-4ay0um8z/overlay/lib/python3.10/site-packages/setuptools/_distutils/dist.py\", line 987, in run_command\r\n          cmd_obj.run()\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-build-env-4ay0um8z/overlay/lib/python3.10/site-packages/cffi/setuptools_ext.py\", line 143, in run\r\n          ext.sources[0] = make_mod(self.build_temp, pre_run)\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-build-env-4ay0um8z/overlay/lib/python3.10/site-packages/cffi/setuptools_ext.py\", line 128, in make_mod\r\n          pre_run(ext, ffi)\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-install-ean31kds/gevent_31ac438a728f499f901036ad42433a34/_setuputils.py\", line 381, in pre_run\r\n          action()\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-install-ean31kds/gevent_31ac438a728f499f901036ad42433a34/_setuplibev.py\", line 55, in configure_libev\r\n          system(libev_configure_command)\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-install-ean31kds/gevent_31ac438a728f499f901036ad42433a34/_setuputils.py\", line 195, in system\r\n          if _system(cmd, cwd=cwd, env=env, **kwargs):\r\n        File \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-install-ean31kds/gevent_31ac438a728f499f901036ad42433a34/_setuputils.py\", line 191, in _system\r\n          return check_call(cmd, cwd=cwd, env=env, **kwargs)\r\n        File \"/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/subprocess.py\", line 369, in check_call\r\n          raise CalledProcessError(retcode, cmd)\r\n      subprocess.CalledProcessError: Command '(cd  \"/private/var/folders/n3/f_f4s9_16v11k9n402fn_lyc0000gn/T/pip-install-ean31kds/gevent_31ac438a728f499f901036ad42433a34/deps/libev\"  && sh ./configure -C > configure-output.txt )' returned non-zero exit status 77.\r\n      [end of output]\r\n  \r\n  note: This error originates from a subprocess, and is likely not a problem with pip.\r\n  ERROR: Failed building wheel for gevent\r\nERROR: Could not build wheels for gevent, which is required to install pyproject.toml-based projects\r\n```\r\n\r\n### Steps to reproduce\r\n1. Install the latest Python 3.10.8 on MacBook Pro (Retina, 15-inch, Mid 2015) \r\n2. Install pipenv \r\n3. Add a new locust project (folder)\r\n4. From the console of the root project, run \"pipenv install locust\"\r\n\r\n### Notes\r\n\r\n- It has the same issues when using \"pip3 install -U locust\" or trying installing on my wife Macbook\r\n### Environment\r\n\r\n- OS: macOS Monterey Version 12.6 \r\n- Python version: Python 3.10.8, pip 22.3, pipenv, version 2022.10.12\r\n- Locust version: locust 2.12.1, locust 2.12.2\r\n- Locust command line that you ran: pipenv install locust or pip3 install -U locust\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2226/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2226/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2223", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2223/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2223/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2223/events", "html_url": "https://github.com/locustio/locust/issues/2223", "id": 1408882884, "node_id": "I_kwDOABUGS85T-djE", "number": 2223, "title": "ImportError: cannot import name 'OrderedDict' from 'typing'", "user": {"login": "jinghaifeng1", "id": 20569882, "node_id": "MDQ6VXNlcjIwNTY5ODgy", "avatar_url": "https://avatars.githubusercontent.com/u/20569882?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jinghaifeng1", "html_url": "https://github.com/jinghaifeng1", "followers_url": "https://api.github.com/users/jinghaifeng1/followers", "following_url": "https://api.github.com/users/jinghaifeng1/following{/other_user}", "gists_url": "https://api.github.com/users/jinghaifeng1/gists{/gist_id}", "starred_url": "https://api.github.com/users/jinghaifeng1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jinghaifeng1/subscriptions", "organizations_url": "https://api.github.com/users/jinghaifeng1/orgs", "repos_url": "https://api.github.com/users/jinghaifeng1/repos", "events_url": "https://api.github.com/users/jinghaifeng1/events{/privacy}", "received_events_url": "https://api.github.com/users/jinghaifeng1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-10-14T07:13:49Z", "updated_at": "2022-10-19T01:48:04Z", "closed_at": "2022-10-19T01:48:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\npytnon : 3.7.0\r\nlocust: 2.12.1   2.10.1\r\n\r\nWhen I started locust with this configuration, I get an error\r\n\r\nTraceback (most recent call last):\r\n  File \"d:\\jhf\\software\\python\\python370\\lib\\runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"d:\\jhf\\software\\python\\python370\\lib\\runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"D:\\jhf\\software\\python\\python370\\Scripts\\locust.exe\\__main__.py\", line 5, in <module>\r\n  File \"d:\\jhf\\software\\python\\python370\\lib\\site-packages\\locust\\__init__.py\", line 18, in <module>\r\n    from .contrib.fasthttp import FastHttpUser\r\n  File \"d:\\jhf\\software\\python\\python370\\lib\\site-packages\\locust\\contrib\\fasthttp.py\", line 24, in <module>\r\n    from locust.env import Environment\r\n  File \"d:\\jhf\\software\\python\\python370\\lib\\site-packages\\locust\\env.py\", line 15, in <module>\r\n    from .stats import RequestStats, StatsCSV\r\n  File \"d:\\jhf\\software\\python\\python370\\lib\\site-packages\\locust\\stats.py\", line 15, in <module>\r\n    from typing import (\r\nImportError: cannot import name 'OrderedDict' from 'typing' (d:\\jhf\\software\\python\\python370\\lib\\typing.py)\r\n\r\n### Suggestion for repairing\r\nin   python370\\lib\\site-packages\\locust\\stats.py \r\n\r\ndel  import   OrderedDict as OrderedDictType, \r\n\r\nreplace  326 line   \"OrderedDictType\"   to  \"OrderedDict\"\r\n\r\n### Environment\r\n\r\n- OS: windwos 10\r\n- Python version: 3.7.0\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds) 2.12.1    2.10.1\r\n- Locust command line that you ran: locust.exe --master -f collect.py --web-host=\"XXXXXXXXX\"\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2223/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2223/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2222", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2222/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2222/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2222/events", "html_url": "https://github.com/locustio/locust/issues/2222", "id": 1408880608, "node_id": "I_kwDOABUGS85T-c_g", "number": 2222, "title": "Why my URL won't update in this demo", "user": {"login": "chenqinggang001", "id": 74290987, "node_id": "MDQ6VXNlcjc0MjkwOTg3", "avatar_url": "https://avatars.githubusercontent.com/u/74290987?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chenqinggang001", "html_url": "https://github.com/chenqinggang001", "followers_url": "https://api.github.com/users/chenqinggang001/followers", "following_url": "https://api.github.com/users/chenqinggang001/following{/other_user}", "gists_url": "https://api.github.com/users/chenqinggang001/gists{/gist_id}", "starred_url": "https://api.github.com/users/chenqinggang001/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chenqinggang001/subscriptions", "organizations_url": "https://api.github.com/users/chenqinggang001/orgs", "repos_url": "https://api.github.com/users/chenqinggang001/repos", "events_url": "https://api.github.com/users/chenqinggang001/events{/privacy}", "received_events_url": "https://api.github.com/users/chenqinggang001/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-10-14T07:11:57Z", "updated_at": "2022-10-14T09:32:14Z", "closed_at": "2022-10-14T09:32:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nhttp://localhost:8089/1\r\nhttp://localhost:8089/2\r\nhttp://localhost:8089/3\r\nhttp://localhost:8089/4\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n![image](https://user-images.githubusercontent.com/74290987/195784428-23a81db5-bf5b-4e45-bc04-fded675f0d50.png)\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n```python\r\nimport gevent\r\nfrom flask import Response\r\nfrom locust import task, SequentialTaskSet, FastHttpUser, events, between\r\n\r\n\r\n@events.init.add_listener\r\ndef locust_init(environment, runner, **kwargs):\r\n    print(\"locust init event received\")\r\n    if environment.web_ui and runner:\r\n        @environment.web_ui.app.route(\"/1\")\r\n        def index1():\r\n            return Response(\"1\".encode(), content_type=\"application/json\")\r\n\r\n        @environment.web_ui.app.route(\"/2\")\r\n        def index2():\r\n            return Response(\"2\".encode(), content_type=\"application/json\")\r\n\r\n        @environment.web_ui.app.route(\"/3\")\r\n        def index3():\r\n            return Response(\"3\".encode(), content_type=\"application/json\")\r\n\r\n        @environment.web_ui.app.route(\"/4\")\r\n        def index4():\r\n            return Response(\"4\".encode(), content_type=\"application/json\")\r\n\r\n\r\nclass LoadIndexTask(SequentialTaskSet):\r\n\r\n    def __init__(self, parent):\r\n        super().__init__(parent)\r\n        self.new_req = None\r\n\r\n    def concurrent_request(self, _req):\r\n        with self.client.request(_req[\"request\"][\"method\"], _req[\"request\"][\"url\"], catch_response=True) as response:\r\n            print(_req[\"request\"][\"url\"])\r\n            if 0 < response.status_code < 400:\r\n                response.success()\r\n            else:\r\n                response.failure(f\"Response code is {response.status_code}\")\r\n\r\n    def init_pool(self, _req, fun):\r\n        pool = gevent.pool.Pool()\r\n        for i in _req:\r\n            pool.spawn(fun, i)\r\n        pool.join()\r\n\r\n    @task\r\n    def step01_index_task(self):\r\n        self.new_req = [\r\n            {\r\n                \"request\": {\r\n                    \"method\": \"GET\",\r\n                    \"url\": \"http://localhost:8089/1\",\r\n                }\r\n            },\r\n            {\r\n                \"request\": {\r\n                    \"method\": \"GET\",\r\n                    \"url\": \"http://localhost:8089/2\",\r\n                }\r\n            }\r\n        ]\r\n        self.init_pool(self.new_req, self.concurrent_request)\r\n\r\n    @task\r\n    def step02_login_task(self):\r\n        self.init_pool(self.new_req, self.concurrent_request)\r\n        self.new_req = [\r\n            {\r\n                \"request\": {\r\n                    \"method\": \"GET\",\r\n                    \"url\": \"http://localhost:8089/3\",\r\n                }\r\n            },\r\n            {\r\n                \"request\": {\r\n                    \"method\": \"GET\",\r\n                    \"url\": \"http://localhost:8089/4\",\r\n                }\r\n            }\r\n        ]\r\n\r\n\r\nclass LoadIndexUser(FastHttpUser):\r\n    wait_time = between(1, 3)\r\n    host = \"http://localhost:8089\"\r\n    tasks = [LoadIndexTask]\r\n\r\n```\r\n\r\n### Environment\r\n\r\n- OS:  windows\r\n- Python version: 3.10.5\r\n- Locust version:  2.12.1 (please dont file issues for anything but the most recent release or prerelease builds)  \r\n- Locust command line that you ran:\r\n`python.exe -m locust -f D:\\projects\\locustfiles\\test.py --master --master-bind-host=127.0.0.1 --skip-log-setup --class-picker`\r\n- Locust file contents (anonymized if necessary):\r\n`python.exe -m locust -f D:\\projects\\locustfiles\\test.py --worker --master-host=127.0.0.1 --skip-log-setup --class-picker `\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2222/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2222/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2220", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2220/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2220/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2220/events", "html_url": "https://github.com/locustio/locust/issues/2220", "id": 1403766788, "node_id": "I_kwDOABUGS85Tq8gE", "number": 2220, "title": "StatsEntry Exception on csv full history", "user": {"login": "piercefreeman", "id": 1712066, "node_id": "MDQ6VXNlcjE3MTIwNjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1712066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/piercefreeman", "html_url": "https://github.com/piercefreeman", "followers_url": "https://api.github.com/users/piercefreeman/followers", "following_url": "https://api.github.com/users/piercefreeman/following{/other_user}", "gists_url": "https://api.github.com/users/piercefreeman/gists{/gist_id}", "starred_url": "https://api.github.com/users/piercefreeman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/piercefreeman/subscriptions", "organizations_url": "https://api.github.com/users/piercefreeman/orgs", "repos_url": "https://api.github.com/users/piercefreeman/repos", "events_url": "https://api.github.com/users/piercefreeman/events{/privacy}", "received_events_url": "https://api.github.com/users/piercefreeman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-10-10T22:20:02Z", "updated_at": "2022-11-05T02:16:21Z", "closed_at": "2022-11-05T02:16:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\nIt appears that there's a regression of https://github.com/locustio/locust/issues/1531 under certain circumstances (see below for reproduction case). This was also reported by @Pryanga in that thread. When csv-full-history is disabled, no crashes occur.\r\n\r\n### Expected behavior\r\n\r\nStats should log successfully when csv full history is enabled. Note that this is easy to fix via a init time callback to enable the response times cache, but I don't believe this should be required:\r\n\r\n```\r\nfrom locust import events\r\n\r\n@events.init.add_listener\r\ndef on_locust_init(environment, **_kwargs):\r\n    environment.stats.use_response_times_cache = True\r\n```\r\n\r\n### Actual behavior\r\n\r\nException raised that still allows the locust workers to continue.\r\n\r\n```\r\n2022-10-10T22:13:24Z <Greenlet at 0x106ef4820: <bound method StatsCSVFileWriter.stats_writer of <locust.stats.StatsCSVFileWriter object at 0x106eeaef0>>> failed with ValueError\r\n\r\n  File \"src/gevent/greenlet.py\", line 908, in gevent._gevent_cgreenlet.Greenlet.run\r\n  File \"/Users/piercefreeman/Library/Caches/pypoetry/virtualenvs/proxy-benchmarks-kCo5MCsR-py3.10/lib/python3.10/site-packages/locust/stats.py\", line 1069, in stats_writer\r\n    self._stats_history_data_rows(self.stats_history_csv_writer, now)\r\n  File \"/Users/piercefreeman/Library/Caches/pypoetry/virtualenvs/proxy-benchmarks-kCo5MCsR-py3.10/lib/python3.10/site-packages/locust/stats.py\", line 1114, in _stats_history_data_rows\r\n    self._percentile_fields(stats_entry, use_current=self.full_history),\r\n  File \"/Users/piercefreeman/Library/Caches/pypoetry/virtualenvs/proxy-benchmarks-kCo5MCsR-py3.10/lib/python3.10/site-packages/locust/stats.py\", line 938, in _percentile_fields\r\n    return [int(stats_entry.get_current_response_time_percentile(x) or 0) for x in self.percentiles_to_report]\r\n  File \"/Users/piercefreeman/Library/Caches/pypoetry/virtualenvs/proxy-benchmarks-kCo5MCsR-py3.10/lib/python3.10/site-packages/locust/stats.py\", line 938, in <listcomp>\r\n    return [int(stats_entry.get_current_response_time_percentile(x) or 0) for x in self.percentiles_to_report]\r\n  File \"/Users/piercefreeman/Library/Caches/pypoetry/virtualenvs/proxy-benchmarks-kCo5MCsR-py3.10/lib/python3.10/site-packages/locust/stats.py\", line 611, in get_current_response_time_percentile\r\n    raise ValueError(\r\nValueError: StatsEntry.use_response_times_cache must be set to True if we should be able to calculate the _current_ response time percentile\r\n```\r\n\r\n### Steps to reproduce\r\n\r\n```\r\nfrom locust import task, FastHttpUser\r\n\r\nclass WebsiteUser(FastHttpUser):\r\n    @task\r\n    def index(self):\r\n        self.client.get(\"/handle\")\r\n```\r\n\r\n```\r\nlocustfile = load_test.py\r\nheadless = true\r\nhost = http://localhost:3010\r\nusers = 100\r\nspawn-rate = 10\r\n\r\ncsv = no_proxy\r\ncsv-full-history = true\r\n```\r\n\r\n```\r\nfrom subprocess import Popen\r\n\r\ntry:\r\n    server_process = Popen(\"go run .\", shell=True, cwd=get_asset_path(\"speed-test/server\"))\r\n\r\n    spawn_processes = 5\r\n    run_time = \"1m\"\r\n\r\n    # Launch the coordination server\r\n    # This will wait to launch until N processes have connected\r\n    main_process = Popen(f\"poetry run locust --run-time {run_time} --master --expect-workers {spawn_processes} --config=no_proxy_load_locust.conf\", shell=True, cwd=get_asset_path(\"speed-test/locust\"))\r\n\r\n    worker_processes = [\r\n        Popen(\"poetry run locust --worker --config=no_proxy_load_locust.conf\", shell=True, cwd=get_asset_path(\"speed-test/locust\"))\r\n        for _ in range(spawn_processes)\r\n    ]\r\n\r\n    print(\"Will load...\")\r\n\r\n    main_process.wait()\r\nfinally:\r\n    server_process.terminate()\r\n    main_process.terminate()\r\n    for process in worker_processes:\r\n        process.terminate()\r\n\r\n```\r\n\r\n### Environment\r\n\r\n- OS: OSX\r\n- Python version: 3.10.4\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds)\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2220/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2220/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2206", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2206/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2206/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2206/events", "html_url": "https://github.com/locustio/locust/issues/2206", "id": 1376878229, "node_id": "I_kwDOABUGS85SEX6V", "number": 2206, "title": "workers do not get parsed_options before @event.init", "user": {"login": "aathan", "id": 24279435, "node_id": "MDQ6VXNlcjI0Mjc5NDM1", "avatar_url": "https://avatars.githubusercontent.com/u/24279435?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aathan", "html_url": "https://github.com/aathan", "followers_url": "https://api.github.com/users/aathan/followers", "following_url": "https://api.github.com/users/aathan/following{/other_user}", "gists_url": "https://api.github.com/users/aathan/gists{/gist_id}", "starred_url": "https://api.github.com/users/aathan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aathan/subscriptions", "organizations_url": "https://api.github.com/users/aathan/orgs", "repos_url": "https://api.github.com/users/aathan/repos", "events_url": "https://api.github.com/users/aathan/events{/privacy}", "received_events_url": "https://api.github.com/users/aathan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-09-17T21:32:53Z", "updated_at": "2022-11-05T02:16:23Z", "closed_at": "2022-11-05T02:16:23Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\nI suppose it's debatable whether this is a feature or a bug, but it's likely to burn a lot of new users of locust. The init event is available in workers and the master. However, it's called so early in workers (before they connect to the master and get its parsed_options) that those values are probably not what you'd expect. It also means you have to repeat the options on every command line in order to make the values available in the workers early enough.\r\n\r\n### Expected behavior\r\nparsed_options should be available before the init event, or there should be an init-like event that happens a bit later than init, once the worker is connected to the master.\r\n\r\n### Actual behavior\r\nsee description\r\n\r\n### Steps to reproduce\r\n@events.init_command_line_parser.add_listener\r\ndef _(parser):\r\n    parser.add_argument(\"--my_param\", type=str, env_var=\"MY_PARAM\", default=\"whatever\", help=\"my_param_help\")\r\n\r\nthen pass that parameter, and try to access it within @event.init in a worker...\r\n\r\n### Environment\r\nall\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2206/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2206/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2204", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2204/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2204/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2204/events", "html_url": "https://github.com/locustio/locust/issues/2204", "id": 1376115650, "node_id": "I_kwDOABUGS85SBdvC", "number": 2204, "title": "Editing a running test in the Web UI with class-picker restarts user count back at 0", "user": {"login": "edmundlam", "id": 2623895, "node_id": "MDQ6VXNlcjI2MjM4OTU=", "avatar_url": "https://avatars.githubusercontent.com/u/2623895?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edmundlam", "html_url": "https://github.com/edmundlam", "followers_url": "https://api.github.com/users/edmundlam/followers", "following_url": "https://api.github.com/users/edmundlam/following{/other_user}", "gists_url": "https://api.github.com/users/edmundlam/gists{/gist_id}", "starred_url": "https://api.github.com/users/edmundlam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edmundlam/subscriptions", "organizations_url": "https://api.github.com/users/edmundlam/orgs", "repos_url": "https://api.github.com/users/edmundlam/repos", "events_url": "https://api.github.com/users/edmundlam/events{/privacy}", "received_events_url": "https://api.github.com/users/edmundlam/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2022-09-16T15:36:37Z", "updated_at": "2022-09-20T18:48:08Z", "closed_at": "2022-09-20T18:48:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nWhen I edit a running load test in the Web UI with `class-picker` active, it restarts the users back at 0 users and ramps up to the desired count. \r\n\r\nThis is different from the behaviour without `--class-picker`, where if I edit to go from 10 to 20 users, it will merely add 10 more users on top of the existing 10.\r\n\r\nChecking the code in `web.py`, it seems that if class-picker is active, the code will always restart the runners.\r\n\r\n``` python\r\ndef swarm() -> Response:\r\n            assert request.method == \"POST\"\r\n\r\n            [...]\r\n\r\n            # Loading UserClasses & ShapeClasses if Locust is running with UserClass Picker\r\n            if self.userclass_picker_is_active:\r\n\r\n                [...]\r\n\r\n                # Stopping Runners and setting user dispatchers to None so that they\r\n                # are recreated with the appropriate UserClasses\r\n                self._stop_runners()\r\n```\r\n\r\nI'm wondering if we can skip the restarting of the runners if the user classes requested in the `POST /swarm` request are the same as those currently running. Especially since the \"Edit\" form for a running task doesn't let you change the class of users!\r\n\r\nIf this is something that you would agree to, I would be willing to open a PR to contribute the change. Thanks!\r\n\r\n### Expected behavior\r\nWhen using --class-picker, increasing from 10 to 20 will add 10 more users\r\n\r\n### Actual behavior\r\nWhen using --class-picker, increasing from 10 to 20 users will start from 0 again, and ramp up to 20 users.\r\n\r\n### Steps to reproduce\r\n1. Run locust with --class-picker\r\n2. Start a test with X users\r\n3. Edit the test to set it to X + 3 users\r\n4. Problem is that users start back from 0, instead of staying at X and adding 3 users.\r\n\r\nYou can also run without --class-picker to see that the expected behaviour occurs when `--class-picker` is not set. \r\n\r\n### Environment\r\n\r\n- OS: MacOS\r\n- Python version: 3.9.7\r\n- Locust version: 2.12.0\r\n- Locust command line that you ran: `locust -f tests/load/locustfile.py --config tests/load/locust.conf` # with `class-picker = true` in the conf\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2204/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2204/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2203", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2203/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2203/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2203/events", "html_url": "https://github.com/locustio/locust/issues/2203", "id": 1374169710, "node_id": "I_kwDOABUGS85R6Cpu", "number": 2203, "title": "command line options parsed incorrectly", "user": {"login": "VetchM", "id": 40849489, "node_id": "MDQ6VXNlcjQwODQ5NDg5", "avatar_url": "https://avatars.githubusercontent.com/u/40849489?v=4", "gravatar_id": "", "url": "https://api.github.com/users/VetchM", "html_url": "https://github.com/VetchM", "followers_url": "https://api.github.com/users/VetchM/followers", "following_url": "https://api.github.com/users/VetchM/following{/other_user}", "gists_url": "https://api.github.com/users/VetchM/gists{/gist_id}", "starred_url": "https://api.github.com/users/VetchM/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/VetchM/subscriptions", "organizations_url": "https://api.github.com/users/VetchM/orgs", "repos_url": "https://api.github.com/users/VetchM/repos", "events_url": "https://api.github.com/users/VetchM/events{/privacy}", "received_events_url": "https://api.github.com/users/VetchM/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-09-15T08:51:31Z", "updated_at": "2022-10-25T02:18:11Z", "closed_at": "2022-10-25T02:18:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nI'm trying to use following `docker-compose` file to run headless mode locust, but every time i ran i got error: `/ERROR/locust.main: Unknown User(s)`. It used to work when i using `docker-compose` file in the docs(https://docs.locust.io/en/stable/running-in-docker.html?#docker-compose)\r\n```yaml\r\nversion: '3'\r\n\r\nservices:\r\n  master:\r\n    image: locustio/locust\r\n    ports:\r\n     - \"8089:8089\"\r\n    volumes:\r\n      - /home/load-test/locust:/mnt/locust\r\n    command: -f /mnt/locust/${LOCUST_FILE} \\\r\n             -H ${LOAD_HOST} \\\r\n             --headless \\\r\n             --users 1000 \\\r\n             --spawn-rate 10 \\ \r\n             --run-time 30m \\\r\n             --master \\\r\n             --html /mnt/locust/${NODE}.html \\\r\n             --stop-timeout 99 \\\r\n             ${NODE}\r\n\r\n  worker:\r\n    image: locustio/locust\r\n    volumes:\r\n      - /home/load-test/locust:/mnt/locust\r\n    command: -f /mnt/locust/${LOCUST_FILE} --worker --master-host master\r\n```\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nRunning correctly\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n```python\r\n/ERROR/locust.main: Unknown User(s):  --run-time,  --headless,  --stop-timeout,  --spawn-rate,  Test_node,  -H, 30m, /mnt/locust/Test_node.html, 10,  --master,  --users,  --html, 99, 1000, http://localhost:7554\r\n```\r\n\r\nThe order of options is different every time i ran:\r\n\r\n```python\r\n/ERROR/locust.main: Unknown User(s): 99, http://localhost:7554, 30m,  --stop-timeout,  --html,  --spawn-rate,  Test_node,  --headless,  --users,  -H,  --master, 10, /mnt/locust/Test_node.html,  --run-time, 1000\r\n```\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\nUsing above`docker-compose` file with this cmd:\r\n` LOCUST_FILE=locustfile.py LOAD_HOST=http://localhost:7554 NODE=Test_node docker-compose up`\r\n### Environment\r\n\r\n- OS: Linux version 5.4.0-109-generic (buildd@ubuntu) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.1))\r\n- Python version: Python 3.9.13\r\n- Locust version: locust 2.11.1\r\n- Locust command line that you ran: \r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2203/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2203/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2192", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2192/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2192/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2192/events", "html_url": "https://github.com/locustio/locust/issues/2192", "id": 1368849441, "node_id": "I_kwDOABUGS85Rlvwh", "number": 2192, "title": "Class picker incorrectly populates Parsed Options", "user": {"login": "Vino4", "id": 14026415, "node_id": "MDQ6VXNlcjE0MDI2NDE1", "avatar_url": "https://avatars.githubusercontent.com/u/14026415?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Vino4", "html_url": "https://github.com/Vino4", "followers_url": "https://api.github.com/users/Vino4/followers", "following_url": "https://api.github.com/users/Vino4/following{/other_user}", "gists_url": "https://api.github.com/users/Vino4/gists{/gist_id}", "starred_url": "https://api.github.com/users/Vino4/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Vino4/subscriptions", "organizations_url": "https://api.github.com/users/Vino4/orgs", "repos_url": "https://api.github.com/users/Vino4/repos", "events_url": "https://api.github.com/users/Vino4/events{/privacy}", "received_events_url": "https://api.github.com/users/Vino4/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2022-09-11T06:40:53Z", "updated_at": "2022-10-06T15:23:16Z", "closed_at": "2022-10-06T15:23:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nWhen using the Web UI's class picker, Parsed Options are incorrectly populated\r\n\r\n### Expected behavior\r\nEach name of a picked class is available as a single item in the `environment.parsed_options.user_classes` list \r\nExample when selecting the class \"PurchaseUser\":\r\n![image](https://user-images.githubusercontent.com/14026415/189515433-b0991191-2685-49ec-b52b-e1c6eb0b8e9d.png)\r\n\r\n### Actual behavior\r\nWhen choosing classes through class picker, the name of the class is broken into characters. Each character is present as its own item in the `environment.parsed_options.user_classes` list.\r\nExample when selecting the class \"PurchaseUser\":\r\n![image](https://user-images.githubusercontent.com/14026415/189515340-10c3a26e-a6bd-4321-878e-3300e372cd94.png)\r\n\r\n\r\n### Steps to reproduce\r\n- Start locust with the --class-picker option and **without** specifying a user class through the CLI\r\n- Select a class from the class picker menu and start the test\r\n- Access the `environment.parsed_options.user_classes` list in the `test_start` listener\r\n```\r\n@events.test_start.add_listener\r\ndef on_test_start(environment, **__):\r\n    user_classes = environment.parsed_options.user_classes\r\n    log.info(user_classes)\r\n```\r\n\r\n### Environment\r\n\r\n- OS: MacOS Big Sur (11.4)\r\n- Python version: 3.7.9\r\n- Locust version: 2.12.0\r\n- Locust command line that you ran: `locust --class-picker`\r\n- Locust file contents (anonymized if necessary):\r\n```\r\nimport logging\r\nimport time\r\nfrom locust import HttpUser, task, between, events\r\n\r\nlog = logging.getLogger(__name__)\r\n\r\n@events.test_start.add_listener\r\ndef on_test_start(environment, **_):\r\n    user_classes = environment.parsed_options.user_classes\r\n    log.info(user_classes)\r\n\r\nclass PurchaseUser(HttpUser):\r\n    wait_time = between(1, 5)\r\n\r\n    @task\r\n    def hello_world(self):\r\n        self.client.get(\"/hello\")\r\n        self.client.get(\"/world\")\r\n\r\n    @task(3)\r\n    def view_items(self):\r\n        for item_id in range(10):\r\n            self.client.get(f\"/item?id={item_id}\", name=\"/item\")\r\n            time.sleep(1)\r\n\r\n    def on_start(self):\r\n        self.client.post(\"/login\", json={\"username\":\"foo\", \"password\":\"bar\"})\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2192/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2192/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2191", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2191/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2191/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2191/events", "html_url": "https://github.com/locustio/locust/issues/2191", "id": 1367940217, "node_id": "I_kwDOABUGS85RiRx5", "number": 2191, "title": "Events listeners from all locust files being executed when running a single UserClass", "user": {"login": "leonardoggallardo", "id": 58090602, "node_id": "MDQ6VXNlcjU4MDkwNjAy", "avatar_url": "https://avatars.githubusercontent.com/u/58090602?v=4", "gravatar_id": "", "url": "https://api.github.com/users/leonardoggallardo", "html_url": "https://github.com/leonardoggallardo", "followers_url": "https://api.github.com/users/leonardoggallardo/followers", "following_url": "https://api.github.com/users/leonardoggallardo/following{/other_user}", "gists_url": "https://api.github.com/users/leonardoggallardo/gists{/gist_id}", "starred_url": "https://api.github.com/users/leonardoggallardo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/leonardoggallardo/subscriptions", "organizations_url": "https://api.github.com/users/leonardoggallardo/orgs", "repos_url": "https://api.github.com/users/leonardoggallardo/repos", "events_url": "https://api.github.com/users/leonardoggallardo/events{/privacy}", "received_events_url": "https://api.github.com/users/leonardoggallardo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1993314533, "node_id": "MDU6TGFiZWwxOTkzMzE0NTMz", "url": "https://api.github.com/repos/locustio/locust/labels/cantfix", "name": "cantfix", "color": "dddddd", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2022-09-09T14:47:31Z", "updated_at": "2022-09-19T11:03:52Z", "closed_at": "2022-09-19T11:03:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nWhen running locust with the new class-picker feature to choose the class to be executed the event listeners from all files are being executed, not just the ones inside the same file as the picked UserClass. \r\nThe use case for this is being able to use `@events.test_start.add_listener` and `@events.init.add_listener` to do independent setups for each test with the new class-picker.\r\n\r\n[Thread on slack for reference](https://locustio.slack.com/archives/C3NUJ61DJ/p1662660090631699)\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nI'd expect that only event listeners inside the same file of the selected UserClass get executed.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nEvent listeners of all files are being executed.\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n1. Create two separated locustfiles (each one representing a different test)\r\n2. On each locustfile add `@events.test_start.add_listener` methods to setup anything before test run\r\n3. Execute the files in any of the ways below:\r\n    a. By running locust with class-picker\r\n    b. By running locust with multiple files and selecting the UserClass\r\n4. Observe the events on both files being executed on test start\r\n\r\n### Environment\r\n\r\n- OS: macOS\r\n- Python version: 3.10\r\n- Locust version: 2.12.0\r\n- Locust command line that you ran: `locust -f . --class-picker` or `locust -f scenario_one.py scenario_two.py ScenarioOneUser`\r\n- Locust file contents: https://gist.github.com/leonardoggallardo/db95cb365c9ec6f23f10247afe764d6a", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2191/reactions", "total_count": 4, "+1": 4, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2191/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2187", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2187/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2187/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2187/events", "html_url": "https://github.com/locustio/locust/issues/2187", "id": 1364765424, "node_id": "I_kwDOABUGS85RWKrw", "number": 2187, "title": "Docker container does not refresh test on code change", "user": {"login": "Gerben-T", "id": 26112463, "node_id": "MDQ6VXNlcjI2MTEyNDYz", "avatar_url": "https://avatars.githubusercontent.com/u/26112463?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Gerben-T", "html_url": "https://github.com/Gerben-T", "followers_url": "https://api.github.com/users/Gerben-T/followers", "following_url": "https://api.github.com/users/Gerben-T/following{/other_user}", "gists_url": "https://api.github.com/users/Gerben-T/gists{/gist_id}", "starred_url": "https://api.github.com/users/Gerben-T/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Gerben-T/subscriptions", "organizations_url": "https://api.github.com/users/Gerben-T/orgs", "repos_url": "https://api.github.com/users/Gerben-T/repos", "events_url": "https://api.github.com/users/Gerben-T/events{/privacy}", "received_events_url": "https://api.github.com/users/Gerben-T/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-09-07T14:35:24Z", "updated_at": "2022-09-18T19:16:20Z", "closed_at": "2022-09-18T19:16:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nNot sure if it is a bug or it needs to be a feature request, but when running the docker image using a `volume` it doesn't recognize code changes to test files until I restart the container.\r\n\r\n### Expected behavior\r\nWhen I change the code of one of the test files, Locust should load those changes. When I restart my test from the web UI it should run the new file instead of the old one.\r\n\r\n### Actual behavior\r\nWhen starting the test in the web UI it runs my old code as if it was never changed.\r\n\r\n### Steps to reproduce\r\n1. Start docker container using a volume to bind the locust test to the container\r\n2. Run the test once\r\n3. Add new code to the test (for example a new `POST` call)\r\n4. Run the test again by clicking STOP and New test in the web UI (don't restart the container)\r\n5. Notice that the new code was not ran but instead the old code was.\r\n\r\n### Environment\r\n\r\n- OS: Windows\r\n- Python version: 3.9\r\n- Locust version: 2.11.1\r\n- Locust command line that you ran: `-f /mnt/locust/locustfiles --web-port 80` (but this is in my docker-compose.yml)\r\n- Locust file contents (anonymized if necessary): N/A", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2187/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2187/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2185", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2185/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2185/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2185/events", "html_url": "https://github.com/locustio/locust/issues/2185", "id": 1362739303, "node_id": "I_kwDOABUGS85ROcBn", "number": 2185, "title": "Wait_time `constant_throughput` not working for low users?", "user": {"login": "emmaCullen", "id": 61304599, "node_id": "MDQ6VXNlcjYxMzA0NTk5", "avatar_url": "https://avatars.githubusercontent.com/u/61304599?v=4", "gravatar_id": "", "url": "https://api.github.com/users/emmaCullen", "html_url": "https://github.com/emmaCullen", "followers_url": "https://api.github.com/users/emmaCullen/followers", "following_url": "https://api.github.com/users/emmaCullen/following{/other_user}", "gists_url": "https://api.github.com/users/emmaCullen/gists{/gist_id}", "starred_url": "https://api.github.com/users/emmaCullen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/emmaCullen/subscriptions", "organizations_url": "https://api.github.com/users/emmaCullen/orgs", "repos_url": "https://api.github.com/users/emmaCullen/repos", "events_url": "https://api.github.com/users/emmaCullen/events{/privacy}", "received_events_url": "https://api.github.com/users/emmaCullen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-09-06T05:47:28Z", "updated_at": "2022-09-18T19:14:10Z", "closed_at": "2022-09-18T19:14:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n\r\n### Describe the bug\r\nIf I set the following locust config, I see an RPS of 126. From the docs I would expect to see a much lower RPS, as the 10 users execute their tasks every 100s, so would have thought it would be more like RPS of 10-20?\r\n\r\nusers: 10\r\nspawn_rate: 10\r\nconstant_throughput: 0.01\r\nworkers: 3\r\nduration: 100s\r\n\r\nThere is one request per task.\r\n\r\n### Expected behavior\r\nFrom the docs I would expect to see a much lower RPS, as the 10 users execute their tasks every 100s, so would have thought it would be more like RPS of 10-20?\r\n\r\n### Actual behavior\r\nIf I set the config above, I see an RPS of 126. \r\n\r\n### Steps to reproduce\r\nWe have a local framework to do our PNV. Am not sure what would be most helpful to provide, here is the code that adds our wait_time in the locust master:\r\n\r\n```\r\nimport pickle\r\n\r\nfrom locust import User, events, env, constant_throughput, constant\r\n\r\nimport ghz\r\n\r\n\r\nclass GHZLocust(User):\r\n    def get_wait_time():\r\n        try:\r\n            throughput = ghz.get_env_vars()[\"PNV_LOCUST_CONST_THROUGHPUT\"]\r\n            return constant_throughput(float(throughput))\r\n        except KeyError:\r\n            return constant(0)\r\n\r\n    wait_time = get_wait_time()\r\n\r\n   @events.init.add_listener\r\n    def _(environment: env.Environment, **kw):\r\n        env_vars = ghz.get_env_vars()\r\n        ghz.check_env_vars(\r\n     .......and so on.......\r\n```\r\n\r\n\r\n### Environment\r\n\r\n- OS: K8s\r\n- Python version: 3.8\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds): 2.9.0\r\n- Locust command line that you ran: \r\n```\r\n      - args:\r\n        - --master\r\n        - -H\r\n        - http://0.0.0.0:8089\r\n        - --headless\r\n        - --expect-workers\r\n        - \"3\"\r\n        - --users\r\n        - \"10\"\r\n        - --spawn-rate\r\n        - \"10\"\r\n        - --stop-timeout\r\n        - \"0\"\r\n        - --run-time\r\n        - 100s\r\n        command:\r\n        - locust\r\n ```\r\n- Locust file contents (anonymized if necessary):\r\n\r\n```\r\nimport pickle\r\n\r\nfrom locust import User, events, env, constant_throughput, constant\r\n\r\nimport ghz\r\n\r\n\r\nclass GHZLocust(User):\r\n    def get_wait_time():\r\n        try:\r\n            throughput = ghz.get_env_vars()[\"PNV_LOCUST_CONST_THROUGHPUT\"]\r\n            return constant_throughput(float(throughput))\r\n        except KeyError:\r\n            return constant(0)\r\n\r\n    wait_time = get_wait_time()\r\n\r\n    @events.init.add_listener\r\n    def _(environment: env.Environment, **kw):\r\n        env_vars = ghz.get_env_vars()\r\n        ghz.check_env_vars(\r\n            [\"***\", \"***\", \"***\"],\r\n            env_vars)\r\n        print(f\"Using env vars: {env_vars}\")\r\n\r\n    @events.quitting.add_listener\r\n    def _(environment: env.Environment, **kw):\r\n        print(\"Processing ghz output\")\r\n        pickle.dumps(environment.stats)\r\n        env_vars = ghz.get_env_vars()\r\n\r\n        for i in range(0, 100):\r\n            while True:\r\n                try:\r\n                    ghz.process(\r\n                        env_vars,\r\n                        environment.stats.entries.values(),\r\n                        environment.stats.errors.values())\r\n                except:  # noqa: E722\r\n                    continue\r\n                exit(0)\r\n                return\r\n\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2185/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2185/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2178", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2178/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2178/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2178/events", "html_url": "https://github.com/locustio/locust/issues/2178", "id": 1354729927, "node_id": "I_kwDOABUGS85Qv4nH", "number": 2178, "title": "Locust doesn't accept a package directory as specified in the documentation \ud83d\udc1b ", "user": {"login": "jrnp97", "id": 26009859, "node_id": "MDQ6VXNlcjI2MDA5ODU5", "avatar_url": "https://avatars.githubusercontent.com/u/26009859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jrnp97", "html_url": "https://github.com/jrnp97", "followers_url": "https://api.github.com/users/jrnp97/followers", "following_url": "https://api.github.com/users/jrnp97/following{/other_user}", "gists_url": "https://api.github.com/users/jrnp97/gists{/gist_id}", "starred_url": "https://api.github.com/users/jrnp97/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jrnp97/subscriptions", "organizations_url": "https://api.github.com/users/jrnp97/orgs", "repos_url": "https://api.github.com/users/jrnp97/repos", "events_url": "https://api.github.com/users/jrnp97/events{/privacy}", "received_events_url": "https://api.github.com/users/jrnp97/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-08-29T18:45:31Z", "updated_at": "2022-08-29T20:05:53Z", "closed_at": "2022-08-29T19:28:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nLocust doesn't accept python package as valid value for `-f` config option as specified on documentation.\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nDetect the user classes on `__init__.py` module of a python package.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nIs a directory error.\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) -->\r\nSmall repo as example: https://github.com/jrnp97/example-error\r\nSteps described on: \r\n![alt-text](https://github.com/jrnp97/example-error/raw/da9fb6f22020e1bea86a6efb17b31a90f6ed9909/Screen%20Shot%202022-08-29%20at%202.59.40%20PM.png)\r\n\r\n\r\n### Environment\r\n\r\n- OS: MacOs Big Sur \r\n- Python version: 3.8.1\r\n- Locust version: 2.10.0\r\n- Locust command line that you ran: `locust -H https://example.com --headless -u 1 -r 0.5 -t 5s -f package_dir/`\r\n- Locust file contentes (anonymized if necessary): https://github.com/jrnp97/example-error", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2178/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2178/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2176", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2176/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2176/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2176/events", "html_url": "https://github.com/locustio/locust/issues/2176", "id": 1354140281, "node_id": "I_kwDOABUGS85Qtop5", "number": 2176, "title": "Parser - Unexpected token ':'", "user": {"login": "RoeyMichaeli", "id": 99681692, "node_id": "U_kgDOBfEFnA", "avatar_url": "https://avatars.githubusercontent.com/u/99681692?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RoeyMichaeli", "html_url": "https://github.com/RoeyMichaeli", "followers_url": "https://api.github.com/users/RoeyMichaeli/followers", "following_url": "https://api.github.com/users/RoeyMichaeli/following{/other_user}", "gists_url": "https://api.github.com/users/RoeyMichaeli/gists{/gist_id}", "starred_url": "https://api.github.com/users/RoeyMichaeli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RoeyMichaeli/subscriptions", "organizations_url": "https://api.github.com/users/RoeyMichaeli/orgs", "repos_url": "https://api.github.com/users/RoeyMichaeli/repos", "events_url": "https://api.github.com/users/RoeyMichaeli/events{/privacy}", "received_events_url": "https://api.github.com/users/RoeyMichaeli/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-08-29T11:32:08Z", "updated_at": "2022-08-29T20:37:41Z", "closed_at": "2022-08-29T16:29:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nTry to pass a json to the locust file through the parser, by way of custom arguments.\r\n`os.system('locust -f ' + locust_py + ' --config ' + locust_conf + ' --context ' + jsonpickle.encode(context))`\r\n\r\nThe json in question:\r\n`{\"py/object\": \"Context.Context\", \"manager_username\": \"xxx\", \"manager_password\": \"xxx\", \"manager_appversion\": \"xxx\"}`\r\n\r\nIn addition, the error message would not show if command inserted via python, and the locust would not even crash, just excepted and moved on with the rest of the program.\r\nI had to copy the command, and manually insert it in terminal to receive the error message.\r\n\r\n```\r\n@events.init_command_line_parser.add_listener\r\n    def _(parser):\r\n        print(1)\r\n```\r\n\r\nThe 1 would print, so it passed cmd, but the one on init did not, so the parser crashed.\r\n\r\n### Expected behavior\r\nExpected the parser to accept the json string, so I could decode it in locust.py\r\nExpected the parser to show error message when locust command ran by way of os.system()\r\n\r\n### Actual behavior\r\nNo error message in python.\r\nError message received via terminal.\r\n```\r\nAt line:1 char:140\r\n+ ... api-tester\\Scripts\\locust.conf --context {\"py/object\": \"Contex ...\r\n+                                                                 \r\n+ Unexpected token ':' in expression or statement.\r\n    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException\r\n    + FullyQualifiedErrorId : UnexpectedToken\r\n```\r\n\r\n### Steps to reproduce\r\nCreate a Json string, add custom argument listener to the parser, add Json string as argument\r\n\r\n### Environment\r\n\r\n- OS: Win 10\r\n- Python version: 3.10.5\r\n- Locust version: 2.11\r\n- Locust command line that you ran: `locust -f C:\\GitHub\\sendiman-api-tester\\Scripts\\locust.py --config C:\\GitHub\\sendiman-api-tester\\Scripts\\locust.conf --context {\"py/object\": \"Context.Context\", \"manager_username\": \"xxx\", \"manager_password\": \"xxx\", \"manager_appversion\": \"xxx\"}`\r\n- Locust file contents (anonymized if necessary): \r\n\r\n\r\n```\r\nfrom locust import HttpUser, task, constant, events\r\nimport jsonpickle\r\n\r\nclass ManagerUser(HttpUser):\r\n    wait_time = constant(10)\r\n\r\n    @events.init_command_line_parser.add_listener\r\n    def _(parser):\r\n        print(1)\r\n        parser.add_argument(\"--context\", type=str, env_var=\"LOCUST_CONTEXT\", default=None, help=\"context help\")\r\n        #parser.add_argument(\"--manager_password\", type=str, env_var=\"LOCUST_MANAGER_PASSWORD\", default=None, help=\"manager_password help\")\r\n        #parser.add_argument(\"--manager_appversion\", type=str, env_var=\"LOCUST_MANAGER_APPVERSION\", default=None, help=\"manager_appversion help\")\r\n\r\n    @events.init.add_listener\r\n    def _(environment, **kw):\r\n        print(2)\r\n    \r\n    @events.test_start.add_listener\r\n    def _(environment, **kw):\r\n        print(3)\r\n        print(\"Custom argument supplied: %s\" % jsonpickle.decode(environment.parsed_options.context).manager_username)\r\n    \r\n    def on_start(self):\r\n        print(4)\r\n        context = jsonpickle.decode(self.environment.parsed_options.context)\r\n\r\n        self.manager_username = context.manager_username\r\n        self.manager_password = context.manager_password\r\n        self.manager_appversion = context.manager_appversion\r\n    @task   \r\n    def login_to_logout(self):\r\n        self.client.post(\"/manager/login\", json={\r\n            \"username\":self.manager_username, \r\n            \"password\":self.manager_password, \r\n            \"app_version\":self.manager_appversion})\r\n\r\n        self.client.get(\"/manager/logout\")\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2176/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2176/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2170", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2170/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2170/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2170/events", "html_url": "https://github.com/locustio/locust/issues/2170", "id": 1347881781, "node_id": "I_kwDOABUGS85QVws1", "number": 2170, "title": "WebUI `Edit running load test` not carried `user_classes` when enabled `--class-picker`", "user": {"login": "alterhu2020", "id": 5029046, "node_id": "MDQ6VXNlcjUwMjkwNDY=", "avatar_url": "https://avatars.githubusercontent.com/u/5029046?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alterhu2020", "html_url": "https://github.com/alterhu2020", "followers_url": "https://api.github.com/users/alterhu2020/followers", "following_url": "https://api.github.com/users/alterhu2020/following{/other_user}", "gists_url": "https://api.github.com/users/alterhu2020/gists{/gist_id}", "starred_url": "https://api.github.com/users/alterhu2020/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alterhu2020/subscriptions", "organizations_url": "https://api.github.com/users/alterhu2020/orgs", "repos_url": "https://api.github.com/users/alterhu2020/repos", "events_url": "https://api.github.com/users/alterhu2020/events{/privacy}", "received_events_url": "https://api.github.com/users/alterhu2020/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-08-23T12:35:38Z", "updated_at": "2022-08-26T06:23:15Z", "closed_at": "2022-08-26T06:23:15Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n1. Run the web ui with option `--class-picker`, and it contains two userclass scripts(locustfile1.py,locustfile2.py), here we only pickup the `locustfile1.py` as the locust userclass\r\n2. When the script is running,  from the top right click the `Edit running load test` and it only show custom the concurrent user,  spawn rate and host, no options of `UserClasses` and `ShapeClass`\r\n3. Then click the `Start swarming` button\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nIt should only run  `locustfile1.py` user class\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nIt had run all the userclasses, including `locustfile1.py` and `locustfile2.py`\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\nSee above description\r\n### Environment\r\n\r\n- OS:\r\n- Python version: 3.10.2\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds) 2.11.0\r\n- Locust command line that you ran: `locust -f /scripts --class-picker`\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2170/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2170/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2167", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2167/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2167/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2167/events", "html_url": "https://github.com/locustio/locust/issues/2167", "id": 1347023013, "node_id": "I_kwDOABUGS85QSfCl", "number": 2167, "title": "stats_logger always reports to stdout/stderr, even when --print-stats is not set", "user": {"login": "pniederlag", "id": 85458, "node_id": "MDQ6VXNlcjg1NDU4", "avatar_url": "https://avatars.githubusercontent.com/u/85458?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pniederlag", "html_url": "https://github.com/pniederlag", "followers_url": "https://api.github.com/users/pniederlag/followers", "following_url": "https://api.github.com/users/pniederlag/following{/other_user}", "gists_url": "https://api.github.com/users/pniederlag/gists{/gist_id}", "starred_url": "https://api.github.com/users/pniederlag/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pniederlag/subscriptions", "organizations_url": "https://api.github.com/users/pniederlag/orgs", "repos_url": "https://api.github.com/users/pniederlag/repos", "events_url": "https://api.github.com/users/pniederlag/events{/privacy}", "received_events_url": "https://api.github.com/users/pniederlag/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-08-22T21:43:23Z", "updated_at": "2022-11-01T02:18:05Z", "closed_at": "2022-11-01T02:18:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\n```\r\nlocust --master \\ \r\n--logfile reports/locust.log \\\r\n--csv reports/stats \\\r\n--html ${REPORT_DIR}/report.htm \\\r\n```\r\n\r\n(--print-stats is NOT set)\r\n\r\nunless I use --skip-log-setup my console is messed up with loads of stats of the loadtest, --print-stats is NOT set. adding --print-summary i can at least skip outpout while the test is run but still console gets clumsy once exiting locust.\r\n\r\n### Expected behavior\r\n\r\nlogging stats, and infos, warnings and errors should end up in files according to the configured setup.\r\n\r\n### Actual behavior\r\n\r\nlogging must be disabled alltogether by --skip-log-setup or logs will pollute the console.\r\n\r\n### Steps to reproduce\r\n\r\ncode above should be sufficient to see the effect.\r\n\r\n### Workaround\r\n\r\n```\r\n    # custom code to remove insane console log\r\n    # the stats_logger will always report to stdout/stderr and can't be disable without dropping support for --logfile setup alltogether\r\n    @events.test_start.add_listener\r\n    def setup_logging(environment, **kwargs):\r\n        if isinstance(environment.runner, MasterRunner):\r\n            locust_logger = logging.getLogger('locust')\r\n            stats_logger = logging.getLogger('locust.stats_logger')\r\n            locust_logger.warning('custom code for removing %s handler from stats_logger'%str(len(stats_logger.handlers)))\r\n            stats_logger.handlers.clear()\r\n```\r\n\r\n### proposal for proper fix\r\n\r\nhttps://github.com/locustio/locust/blob/fd9f5c49f57d437385e1cdc0d2515ffef9e92240/locust/log.py\r\n\r\nhas code that sets up the stats_logger and other logging options, it should provide some means to disable the console printing of the stats_logger. \r\n\r\nOne approach would be to add a --no-print-stats option on this if this does not interfere with the --csv <prefix> option that should NOT be tangled here.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2167/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2167/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2166", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2166/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2166/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2166/events", "html_url": "https://github.com/locustio/locust/issues/2166", "id": 1345632720, "node_id": "I_kwDOABUGS85QNLnQ", "number": 2166, "title": "Shape runner attr is always none", "user": {"login": "alteryx-sezell", "id": 31324922, "node_id": "MDQ6VXNlcjMxMzI0OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/31324922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alteryx-sezell", "html_url": "https://github.com/alteryx-sezell", "followers_url": "https://api.github.com/users/alteryx-sezell/followers", "following_url": "https://api.github.com/users/alteryx-sezell/following{/other_user}", "gists_url": "https://api.github.com/users/alteryx-sezell/gists{/gist_id}", "starred_url": "https://api.github.com/users/alteryx-sezell/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alteryx-sezell/subscriptions", "organizations_url": "https://api.github.com/users/alteryx-sezell/orgs", "repos_url": "https://api.github.com/users/alteryx-sezell/repos", "events_url": "https://api.github.com/users/alteryx-sezell/events{/privacy}", "received_events_url": "https://api.github.com/users/alteryx-sezell/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-08-21T23:58:01Z", "updated_at": "2022-09-29T02:18:52Z", "closed_at": "2022-09-29T02:18:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n### Describe the bug\r\nThe LoadTestShape's attr called `runner` is always `None`. \r\nI am running locust as a library, instantiating the shape class then using the start_shape method to launch it (code below).\r\n\r\n### Expected behavior\r\nI was expecting the runner attr to be set with an instance of the runner that is using it. \r\nI wanted the runner instance because really I wanted the environment object, which leads me to the stats. My custom shape would like to use some information in the stats object to make decisions in the tick method.\r\n\r\n### Actual behavior\r\nFor the entire test, the runner attr seems to None. \r\n\r\n### Steps to reproduce\r\nHere is the launch code\r\n\r\n```\r\ndef launch_locust_test(user_classes, **kwargs) -> Environment:\r\n    shape = kwargs.get(\"shape\") or \"Default\"\r\n    logger.debug(f\"Shape selected is {shape}\")\r\n\r\n    if type(user_classes) != list:\r\n        user_classes = [user_classes]\r\n\r\n    logger.debug(f\"Launch received kwargs: {kwargs}\")\r\n\r\n    env = Environment(user_classes=user_classes)\r\n    env.influxdb = kwargs.get(\"influxdb\")\r\n    env.create_local_runner()\r\n    env.runner.stats.reset_all()\r\n    gevent.spawn(locust.stats.stats_history, env.runner)\r\n    env.grasshopper_listeners = GrasshopperListeners(environment=env)\r\n\r\n    # env.shape_class is actually supplied a shape *instance* despite the attr name\r\n    env.shape_class = _get_shape_instance(shape, **kwargs)\r\n\r\n    # fetch runtime from the shape, might be different than the\r\n    # value in kwargs\r\n    runtime = env.shape_class.configured_runtime\r\n    logger.info(\r\n        f\"Starting shape {shape} with runtime of {env.shape_class.configured_runtime}\"\r\n    )\r\n    env.runner.start_shape()\r\n    gevent.spawn_later(runtime, lambda: env.runner.quit())\r\n    env.runner.greenlet.join()\r\n\r\n    return env\r\n```\r\nif it matters, which I don't think it does, the launch code is called from a pytest test and kwargs are just all of the command line parameters that are defined in our conftest file.\r\n\r\nAnd here is my shape definition\r\n```\r\nclass Iterations(LoadTestShape):\r\n    \"\"\"Shape that will run for a specified number of iterations or limit is reached.\"\"\"\r\n\r\n    DEFAULT_RUNTIME_LIMIT = 60\r\n\r\n    def __init__(self, *args, **kwargs):\r\n        self.iterations = kwargs.get(\"iterations\") or 1\r\n        self.runtime = kwargs.get(\"runtime_limit\") or self.DEFAULT_RUNTIME_LIMIT\r\n        self._configured_runtime = self.runtime\r\n        super().__init__(*args, **kwargs)\r\n\r\n    def tick(self):\r\n        elapsed_run_time = round(self.get_run_time())\r\n        if self.runner:\r\n            current_iteration = self.runner.environment.stats.num_iterations\r\n        else:\r\n            current_iteration = 0\r\n        logger.info(f\"runner is = {self.runner}\")\r\n        logger.info(\r\n            f\"Tick with current_iteration={current_iteration} elapsed {elapsed_run_time} and iteration limit {self.iterations}\"\r\n        )\r\n        if elapsed_run_time >= self.runtime or current_iteration >= self.iterations:\r\n            return None\r\n        else:\r\n            return self.users, self.spawn_rate\r\n``` \r\n\r\nObviously, I can set the runner attr myself in the launch code, but I was expecting locust to handle that in `start_shape` and I was hesitant to override the value of an attr that I didn't create.  Seems like if it isn't going to set the value, it should be removed from the class? or if this only something that happens when you launch locust with start_shape and if I'd done it via the command line and let locust create the shape instance, it would be set?\r\n\r\nIn case it's not obvious, I am setting num_iterations in custom a @task decorator that wraps your @task and increments the iteration count stored in the stats object (similar to the k6 idea of iteration `one user executing a task once == a single iteration`). We'd like this because we often want to make sure that we get a minimum number of iterations when we run a test, so that we know that the p90 or p95 values are valid for the test. \r\n\r\n### Environment\r\n\r\n- OS: os x (monterey)\r\n- Python version: Python 3.9.13\r\n- Locust version:  2.11.0\r\n- Locust command line that you ran: ran as library (code above)\r\n- Locust file contents (anonymized if necessary): simplified version of my locust file, using pytest as well\r\n```\r\nclass MyJourney(HttpUser):\r\n    wait_time = between(min_wait=20, max_wait=30)\r\n    defaults = {\r\n        \"job_timeout\": 24 * 60 * 60,  # 24h\r\n    }\r\n\r\n    @task\r\n    def my_journey(self):\r\n        logger.info(\"Starting MyJourney\")\r\n       # do the actual locust test with self.client\r\n        \r\n@px\r\ndef test_myjourney(environment, px_args, journey_args):\r\n    MyJourney.scenario_args.update(environment)\r\n    MyJourney.scenario_args.update(journey_args)\r\n    locust_env = launch_locust_test(MyJourney, **px_args)\r\n    return locust_env\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2166/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2166/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2163", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2163/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2163/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2163/events", "html_url": "https://github.com/locustio/locust/issues/2163", "id": 1341094425, "node_id": "I_kwDOABUGS85P73oZ", "number": 2163, "title": "why response times chart always no data when i use docker in master/slave?", "user": {"login": "HongFei1998", "id": 32254020, "node_id": "MDQ6VXNlcjMyMjU0MDIw", "avatar_url": "https://avatars.githubusercontent.com/u/32254020?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HongFei1998", "html_url": "https://github.com/HongFei1998", "followers_url": "https://api.github.com/users/HongFei1998/followers", "following_url": "https://api.github.com/users/HongFei1998/following{/other_user}", "gists_url": "https://api.github.com/users/HongFei1998/gists{/gist_id}", "starred_url": "https://api.github.com/users/HongFei1998/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HongFei1998/subscriptions", "organizations_url": "https://api.github.com/users/HongFei1998/orgs", "repos_url": "https://api.github.com/users/HongFei1998/repos", "events_url": "https://api.github.com/users/HongFei1998/events{/privacy}", "received_events_url": "https://api.github.com/users/HongFei1998/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-08-17T02:49:39Z", "updated_at": "2022-09-07T02:18:46Z", "closed_at": "2022-09-07T02:18:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "As mentioned in the question, when I used Windows to start the master and Docker to start the worker to work, Response Times Chart always showed no data at about the 9th collection point. I tried to change Locust version, but it didn't work. This won't happen if my worker is also on one Windows\r\n\r\n\u5982\u9898\uff0c\u5f53\u6211\u4f7f\u7528windows\u542f\u52a8master\uff0cdocker\u542f\u52a8worker\u8fdb\u884c\u5de5\u4f5c\u65f6\uff0cresponse times chart\u5728\u5230\u5927\u6982\u7b2c9\u4e2a\u6536\u96c6\u70b9\u65f6\u5019\u603b\u4f1a\u663e\u793ano data\uff0c\u6211\u5c1d\u8bd5\u6362locust\u7684\u7248\u672c\uff0c\u4f46\u662f\u8fd9\u5e76\u4e0d\u8d77\u4f5c\u7528\uff0c\u5982\u679c\u6211\u7684worker\u4e5f\u662f\u5728\u540c\u4e00\u53f0windows\u4e0a\u5219\u4e0d\u4f1a\u51fa\u73b0\u6b64\u60c5\u51b5\r\n\r\nlocust version 2.11.0\r\npython version 3.8.13\r\nmaster in win10\r\nworker in centos's docker container\r\n\r\n![image](https://user-images.githubusercontent.com/32254020/185023403-7a1b2310-60a7-4b7c-8b18-75015108d5e3.png)\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2163/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2163/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2162", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2162/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2162/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2162/events", "html_url": "https://github.com/locustio/locust/issues/2162", "id": 1340191006, "node_id": "I_kwDOABUGS85P4bEe", "number": 2162, "title": "Statistics are not generating correctly when we run load tests with > 1 user & spawn rate as 2.", "user": {"login": "balaji2711", "id": 15344129, "node_id": "MDQ6VXNlcjE1MzQ0MTI5", "avatar_url": "https://avatars.githubusercontent.com/u/15344129?v=4", "gravatar_id": "", "url": "https://api.github.com/users/balaji2711", "html_url": "https://github.com/balaji2711", "followers_url": "https://api.github.com/users/balaji2711/followers", "following_url": "https://api.github.com/users/balaji2711/following{/other_user}", "gists_url": "https://api.github.com/users/balaji2711/gists{/gist_id}", "starred_url": "https://api.github.com/users/balaji2711/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/balaji2711/subscriptions", "organizations_url": "https://api.github.com/users/balaji2711/orgs", "repos_url": "https://api.github.com/users/balaji2711/repos", "events_url": "https://api.github.com/users/balaji2711/events{/privacy}", "received_events_url": "https://api.github.com/users/balaji2711/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2022-08-16T11:13:48Z", "updated_at": "2022-09-21T15:44:03Z", "closed_at": "2022-09-21T15:44:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "Statistics are not generating correctly when we run load tests with > 1 user & spawn rate as 2. Actually, tests are running fine only statistics is not consistent.\r\n\r\nLocust version: 2.11.0\r\n\r\nGetting the below error in the console window -\r\n\r\n  File \"C:\\Python310\\lib\\site-packages\\gevent\\pywsgi.py\", line 999, in handle_one_response\r\n    self.run_application()\r\n  File \"C:\\Python310\\lib\\site-packages\\gevent\\pywsgi.py\", line 945, in run_application\r\n    self.result = self.application(self.environ, self.start_response)\r\n  File \"C:\\Python310\\lib\\site-packages\\flask\\app.py\", line 2548, in __call__\r\n    return self.wsgi_app(environ, start_response)\r\n  File \"C:\\Python310\\lib\\site-packages\\flask\\app.py\", line 2528, in wsgi_app\r\n    response = self.handle_exception(e)\r\n  File \"C:\\Users\\Balaji.Gopi\\AppData\\Roaming\\Python\\Python310\\site-packages\\flask_cors\\extension.py\", line 165, in wrapped_function\r\n    return cors_after_request(app.make_response(f(*args, **kwargs)))\r\n  File \"C:\\Python310\\lib\\site-packages\\flask\\app.py\", line 2525, in wsgi_app\r\n    response = self.full_dispatch_request()\r\n  File \"C:\\Python310\\lib\\site-packages\\flask\\app.py\", line 1822, in full_dispatch_request\r\n    rv = self.handle_user_exception(e)\r\n  File \"C:\\Users\\Balaji.Gopi\\AppData\\Roaming\\Python\\Python310\\site-packages\\flask_cors\\extension.py\", line 165, in wrapped_function\r\n    return cors_after_request(app.make_response(f(*args, **kwargs)))\r\n  File \"C:\\Python310\\lib\\site-packages\\flask\\app.py\", line 1820, in full_dispatch_request\r\n    rv = self.dispatch_request()\r\n  File \"C:\\Python310\\lib\\site-packages\\flask\\app.py\", line 1796, in dispatch_request\r\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)\r\n  File \"C:\\Users\\Balaji.Gopi\\AppData\\Roaming\\Python\\Python310\\site-packages\\locust\\web.py\", line 478, in wrapper\r\n    return view_func(*args, **kwargs)\r\n  File \"C:\\Users\\Balaji.Gopi\\AppData\\Roaming\\Python\\Python310\\site-packages\\locust\\util\\cache.py\", line 20, in wrapper\r\n    cache[\"result\"] = func(*args, **kwargs)\r\n  File \"C:\\Users\\Balaji.Gopi\\AppData\\Roaming\\Python\\Python310\\site-packages\\locust\\web.py\", line 331, in request_stats\r\n    for s in chain(sort_stats(environment.runner.stats.entries), [environment.runner.stats.total]):\r\n  **File \"C:\\Users\\Balaji.Gopi\\AppData\\Roaming\\Python\\Python310\\site-packages\\locust\\stats.py\", line 850, in sort_stats\r\n    return [stats[key] for key in sorted(stats.keys())]\r\nTypeError: '<' not supported between instances of 'NoneType' and 'str'**\r\n2022-08-16T10:47:08Z {'REMOTE_ADDR': '::1', 'REMOTE_PORT': '50665', 'HTTP_HOST': 'localhost:8089', (hidden keys: 31)} failed with TypeError\r\n\r\nLocust screen-shot for your reference -\r\n\r\n![image](https://user-images.githubusercontent.com/15344129/184865781-1b61d970-4221-44be-b0df-c2274638c2e1.png)\r\n\r\nWhen I refresh a page, the status Running shows as 10 users but statistics are not shown and I can see the details under **Charts**\r\n\r\n![image](https://user-images.githubusercontent.com/15344129/184868748-303b2ef4-fc2e-454a-9eea-921095dfbf9b.png)\r\n\r\n![image](https://user-images.githubusercontent.com/15344129/184869116-522b70aa-88f3-463e-9df9-c463cdffad0a.png)\r\n\r\n\r\nAny help or suggestion would be appreciated. Thanks.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2162/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2162/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2154", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2154/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2154/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2154/events", "html_url": "https://github.com/locustio/locust/issues/2154", "id": 1332227472, "node_id": "I_kwDOABUGS85PaC2Q", "number": 2154, "title": "Not able to achieve high RPS (3000 users, 20 workers, 32 vcpu-64 GB RAM)", "user": {"login": "prabhatsharma", "id": 4242188, "node_id": "MDQ6VXNlcjQyNDIxODg=", "avatar_url": "https://avatars.githubusercontent.com/u/4242188?v=4", "gravatar_id": "", "url": "https://api.github.com/users/prabhatsharma", "html_url": "https://github.com/prabhatsharma", "followers_url": "https://api.github.com/users/prabhatsharma/followers", "following_url": "https://api.github.com/users/prabhatsharma/following{/other_user}", "gists_url": "https://api.github.com/users/prabhatsharma/gists{/gist_id}", "starred_url": "https://api.github.com/users/prabhatsharma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/prabhatsharma/subscriptions", "organizations_url": "https://api.github.com/users/prabhatsharma/orgs", "repos_url": "https://api.github.com/users/prabhatsharma/repos", "events_url": "https://api.github.com/users/prabhatsharma/events{/privacy}", "received_events_url": "https://api.github.com/users/prabhatsharma/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-08-08T18:19:51Z", "updated_at": "2022-08-08T22:02:07Z", "closed_at": "2022-08-08T20:54:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\nI tried many things to get higher RPS but am unable to go any higher than 750 requests per second.\r\n\r\nMy details \r\n- 20 workers. Even with 10 workers RPS is similar.\r\n- 3000 users. even with 1000 users RPS is similar\r\n- spawn rate of 20\r\n- app being tested is running on  c7g.8xlarge with 32 vcpu and 64GB RAM\r\n- locust runners are running in different nodes than app server being tested.\r\n- Am using FastHttpUser\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nI should be able to achieve higher RPS with higher number of workers and users.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nGetting limited to ~750 RPS\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\nI am running the setup in a kubernetes cluster. You can see my setup details at https://github.com/zinclabs/artist/tree/main/k8s\r\n\r\n\r\n### Environment\r\n\r\nI have added 2 test reports as well for better understanding.\r\n\r\n- OS: Linux\r\n- Python version: 3.10\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds)\r\n- Locust command line that you ran: using GUI\r\n- Locust file contents (anonymized if necessary): https://github.com/zinclabs/artist/blob/main/locustfile.py\r\n- Test report 1 - [10_worker_c7g.4xlarge.pdf](https://github.com/locustio/locust/files/9284104/10_worker_c7g.4xlarge.pdf)\r\n- Test report 2 - [20_worker_c7g.8xlarge.pdf](https://github.com/locustio/locust/files/9284105/20_worker_c7g.8xlarge.pdf)", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2154/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2154/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2149", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2149/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2149/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2149/events", "html_url": "https://github.com/locustio/locust/issues/2149", "id": 1328521697, "node_id": "I_kwDOABUGS85PL6Hh", "number": 2149, "title": "Not able to run locust into the pipline.", "user": {"login": "mpandeyTR", "id": 92417537, "node_id": "U_kgDOBYIuAQ", "avatar_url": "https://avatars.githubusercontent.com/u/92417537?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpandeyTR", "html_url": "https://github.com/mpandeyTR", "followers_url": "https://api.github.com/users/mpandeyTR/followers", "following_url": "https://api.github.com/users/mpandeyTR/following{/other_user}", "gists_url": "https://api.github.com/users/mpandeyTR/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpandeyTR/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpandeyTR/subscriptions", "organizations_url": "https://api.github.com/users/mpandeyTR/orgs", "repos_url": "https://api.github.com/users/mpandeyTR/repos", "events_url": "https://api.github.com/users/mpandeyTR/events{/privacy}", "received_events_url": "https://api.github.com/users/mpandeyTR/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-08-04T12:06:47Z", "updated_at": "2022-08-05T10:19:29Z", "closed_at": "2022-08-05T06:23:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am running locust into aws pipline and i am encountering gaierror(-2, 'Name does not resolve')  and all the requests are failing.\r\n\r\nType     Name                                                                          # reqs      # fails |    Avg     Min     Max    Med |   req/s  failures/s\r\n--------|----------------------------------------------------------------------------|-------|-------------|-------|-------|-------|-------|--------|-----------\r\nPOST     URL                                                                                   55  55(100.00%) |      4       1      89      3 |    6.03        6.03\r\n--------|----------------------------------------------------------------------------|-------|-------------|-------|-------|-------|-------|--------|-----------\r\n         Aggregated                                                                        55  55(100.00%) |      4       1      89      3 |    6.03        6.03", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2149/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2149/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2147", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2147/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2147/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2147/events", "html_url": "https://github.com/locustio/locust/issues/2147", "id": 1326464906, "node_id": "I_kwDOABUGS85PED-K", "number": 2147, "title": "Flask 2.2.0 Update breaks request_stats_full_history_csv in web.py", "user": {"login": "mikenester", "id": 19849309, "node_id": "MDQ6VXNlcjE5ODQ5MzA5", "avatar_url": "https://avatars.githubusercontent.com/u/19849309?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mikenester", "html_url": "https://github.com/mikenester", "followers_url": "https://api.github.com/users/mikenester/followers", "following_url": "https://api.github.com/users/mikenester/following{/other_user}", "gists_url": "https://api.github.com/users/mikenester/gists{/gist_id}", "starred_url": "https://api.github.com/users/mikenester/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mikenester/subscriptions", "organizations_url": "https://api.github.com/users/mikenester/orgs", "repos_url": "https://api.github.com/users/mikenester/repos", "events_url": "https://api.github.com/users/mikenester/events{/privacy}", "received_events_url": "https://api.github.com/users/mikenester/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-08-02T22:28:02Z", "updated_at": "2022-08-04T08:55:47Z", "closed_at": "2022-08-04T08:55:47Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Describe the bug\r\nFlask released version 2.2.0 yesterday, August 1st, and it appears to have removed the `cache_timeout` kwarg from `send_file`: [diff link](https://github.com/pallets/flask/compare/2.1.3...2.2.0#diff-1f51c8ded4d4ff7e13badab599ef22436c529c2b5f9c25dc6250c1f9fd985440L507). This causes the test `test_request_stats_full_history_csv` to fail since `request_stats_full_history_csv` [uses that kwarg](https://github.com/locustio/locust/blob/master/locust/web.py#L247)\r\n\r\nWhen running `tox -e py39` locally, this issue doesn't occur, but I noticed it's installing Flask version 2.1.2. That test fails when ran via Github Actions, on my forked (and up-to-date) [master branch of Locust](https://github.com/mikenester/locust/actions/runs/2783869348)\r\n\r\nI repeated the steps manually\r\n\r\n### Expected behavior\r\n`test_request_stats_full_history_csv` method and the **stats/requests_full_history/csv** endpoint can be used with Flask 2.2.0\r\n\r\n### Actual behavior\r\nInternal Server Error\r\n\r\n### Steps to reproduce\r\n\r\n1. Run `python3 -m pip install flask==2.2.0`\r\n2. Run `locust -f locustfiles/locustfile1.py --csv web_test --csv-full-history`\r\n3. Run the test against any host and stop if after it a cycle or two\r\n4. Navigate to http://localhost:8089/stats/requests_full_history/csv\r\n\r\nInternal server error is shown with the stack trace at the bottom of this write up.\r\nThis issue does not occur with flask 2.1.2\r\n\r\n### Environment\r\n\r\n- OS: macOS Monterey w/ M1\r\n- Python version: 3.9.13\r\n- Locust version: 2.10.1 (up-to-date master branch)\r\n- Locust command line that you ran: `locust -f locustfiles/locustfile1.py --csv web_test --csv-full-history`\r\n- Locust file contents (anonymized if necessary): n/a\r\n\r\n\r\n#### Error Stack Trace\r\n```\r\nTraceback (most recent call last):\r\n  File \"/opt/homebrew/lib/python3.9/site-packages/gevent/pywsgi.py\", line 999, in handle_one_response\r\n    self.run_application()\r\n  File \"/opt/homebrew/lib/python3.9/site-packages/gevent/pywsgi.py\", line 945, in run_application\r\n    self.result = self.application(self.environ, self.start_response)\r\n  File \"/opt/homebrew/lib/python3.9/site-packages/flask/app.py\", line 2486, in __call__\r\n    return self.wsgi_app(environ, start_response)\r\n  File \"/opt/homebrew/lib/python3.9/site-packages/flask/app.py\", line 2466, in wsgi_app\r\n    response = self.handle_exception(e)\r\n  File \"/opt/homebrew/lib/python3.9/site-packages/flask_cors/extension.py\", line 165, in wrapped_function\r\n    return cors_after_request(app.make_response(f(*args, **kwargs)))\r\n  File \"/opt/homebrew/lib/python3.9/site-packages/flask/app.py\", line 2463, in wsgi_app\r\n    response = self.full_dispatch_request()\r\n  File \"/opt/homebrew/lib/python3.9/site-packages/flask/app.py\", line 1760, in full_dispatch_request\r\n    rv = self.handle_user_exception(e)\r\n  File \"/opt/homebrew/lib/python3.9/site-packages/flask_cors/extension.py\", line 165, in wrapped_function\r\n    return cors_after_request(app.make_response(f(*args, **kwargs)))\r\n  File \"/opt/homebrew/lib/python3.9/site-packages/flask/app.py\", line 1758, in full_dispatch_request\r\n    rv = self.dispatch_request()\r\n  File \"/opt/homebrew/lib/python3.9/site-packages/flask/app.py\", line 1734, in dispatch_request\r\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)\r\n  File \"/opt/homebrew/lib/python3.9/site-packages/locust/web.py\", line 433, in wrapper\r\n    return view_func(*args, **kwargs)\r\n  File \"/opt/homebrew/lib/python3.9/site-packages/locust/web.py\", line 241, in request_stats_full_history_csv\r\n    return send_file(\r\nTypeError: send_file() got an unexpected keyword argument 'cache_timeout'\r\n2022-08-02T22:19:16Z {'REMOTE_ADDR': '::1', 'REMOTE_PORT': '53516', 'HTTP_HOST': 'localhost:8089', (hidden keys: 34)} failed with TypeError\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2147/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2147/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2144", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2144/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2144/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2144/events", "html_url": "https://github.com/locustio/locust/issues/2144", "id": 1322138003, "node_id": "I_kwDOABUGS85OzjmT", "number": 2144, "title": "[SocketIOUser] - I have provided the code to turn off the SSL certification but still, I'm getting an SSL certification error", "user": {"login": "balaji2711", "id": 15344129, "node_id": "MDQ6VXNlcjE1MzQ0MTI5", "avatar_url": "https://avatars.githubusercontent.com/u/15344129?v=4", "gravatar_id": "", "url": "https://api.github.com/users/balaji2711", "html_url": "https://github.com/balaji2711", "followers_url": "https://api.github.com/users/balaji2711/followers", "following_url": "https://api.github.com/users/balaji2711/following{/other_user}", "gists_url": "https://api.github.com/users/balaji2711/gists{/gist_id}", "starred_url": "https://api.github.com/users/balaji2711/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/balaji2711/subscriptions", "organizations_url": "https://api.github.com/users/balaji2711/orgs", "repos_url": "https://api.github.com/users/balaji2711/repos", "events_url": "https://api.github.com/users/balaji2711/events{/privacy}", "received_events_url": "https://api.github.com/users/balaji2711/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2022-07-29T11:36:02Z", "updated_at": "2022-07-29T18:53:39Z", "closed_at": "2022-07-29T18:53:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi All,\r\n\r\nI have provided the code to turn off the SSL certification but still, I'm getting an SSL certification error. Please find the below code -\r\n\r\nclass TestLocust(SocketIOUser):\r\n   \r\n    @task\r\n    def my_task(self):\r\n        self.connect(\"wss://javascript.info/article/websocket/demo/hello\", header=[\"XMLDecode\", {\"cert_req\": ssl.CERT_NONE}])\r\n        self.send('hello[\"subscribe\",{\"url\":\"/article/websocket/demo/hello\",\"sendInitialUpdate\": true, \"message\":\"helloworld\"}]')     \r\n\r\n    def on_message(self, message):\r\n        self.my_value = message\r\n\r\nError Message:\r\nssl.SSLCertVerificationError: [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: certificate has expired (_ssl.c:997)\r\n\r\n**Any help or suggestion would be appreciated. Thanks in advance.**", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2144/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2144/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2141", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2141/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2141/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2141/events", "html_url": "https://github.com/locustio/locust/issues/2141", "id": 1318653245, "node_id": "I_kwDOABUGS85OmQ09", "number": 2141, "title": "generator already executing", "user": {"login": "stampedeboss", "id": 8243029, "node_id": "MDQ6VXNlcjgyNDMwMjk=", "avatar_url": "https://avatars.githubusercontent.com/u/8243029?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stampedeboss", "html_url": "https://github.com/stampedeboss", "followers_url": "https://api.github.com/users/stampedeboss/followers", "following_url": "https://api.github.com/users/stampedeboss/following{/other_user}", "gists_url": "https://api.github.com/users/stampedeboss/gists{/gist_id}", "starred_url": "https://api.github.com/users/stampedeboss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stampedeboss/subscriptions", "organizations_url": "https://api.github.com/users/stampedeboss/orgs", "repos_url": "https://api.github.com/users/stampedeboss/repos", "events_url": "https://api.github.com/users/stampedeboss/events{/privacy}", "received_events_url": "https://api.github.com/users/stampedeboss/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2022-07-26T19:15:45Z", "updated_at": "2022-10-14T07:28:52Z", "closed_at": "2022-10-14T07:28:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n022-07-26 18:51:06,429 |      locust.runners | CRITICAL| Unhandled exception in greenlet: <Greenlet at 0x7fa78408ee60: <bound method MasterRunner.heartbeat_worker of <locust.runners.MasterRunner object at 0x7fa7969cf910>>>\r\nTraceback (most recent call last):\r\n  File \"src/gevent/greenlet.py\", line 906, in gevent._gevent_cgreenlet.Greenlet.run\r\n  File \"/usr/local/lib/python3.10/site-packages/locust/runners.py\", line 946, in heartbeat_worker\r\n    self.start(user_count=self.target_user_count, spawn_rate=self.spawn_rate)\r\n  File \"/usr/local/lib/python3.10/site-packages/locust/runners.py\", line 757, in start\r\n    for dispatched_users in self._users_dispatcher:\r\n  File \"/usr/local/lib/python3.10/site-packages/locust/dispatch.py\", line 114, in __next__\r\n    users_on_workers = next(self._dispatcher_generator)\r\nValueError: generator already executing\r\n\r\n\r\n### Expected behavior\r\nNo exception\r\n\r\n### Actual behavior\r\nTest dies\r\n\r\n### Steps to reproduce\r\nRunning distributed\r\n022-07-26 18:33:52,156 |            workload | INFO    | Test Requested: Stepped\r\n2022-07-26 18:33:52,156 |            workload | INFO    | Total Users: 1500\r\n2022-07-26 18:33:52,156 |            workload | INFO    | Test Duration: 900.0\r\n2022-07-26 18:33:52,156 |            workload | INFO    | Step Duration: 12.0\r\n2022-07-26 18:33:52,156 |            workload | INFO    | Users per Step: 30\r\n2022-07-26 18:33:52,156 |            workload | INFO    | User Spawn Rate: 2.5\r\n2022-07-26 18:33:52,233 |         locust.main | INFO    | Starting web interface at http://0.0.0.0:8089 (accepting connections from all network interfaces)\r\n2022-07-26 18:33:52,247 |         locust.main | INFO    | Starting Locust 2.10.1\r\n2022-07-26 18:48:40,998 |            workload | INFO    | Test Requested: step_tick - User Count (30, 2.5)\r\n2022-07-26 18:48:52,315 |            workload | INFO    | Test Requested: step_tick - User Count (30, 2.5)\r\n2022-07-26 18:48:53,316 |            workload | INFO    | Test Requested: step_tick - User Count (60, 2.5)\r\n2022-07-26 18:49:04,619 |            workload | INFO    | Test Requested: step_tick - User Count (60, 2.5)\r\n2022-07-26 18:49:05,620 |            workload | INFO    | Test Requested: step_tick - User Count (90, 2.5)\r\n2022-07-26 18:49:16,963 |            workload | INFO    | Test Requested: step_tick - User Count (90, 2.5)\r\n2022-07-26 18:49:17,964 |            workload | INFO    | Test Requested: step_tick - User Count (120, 2.5)\r\n2022-07-26 18:49:29,275 |            workload | INFO    | Test Requested: step_tick - User Count (150, 2.5)\r\n2022-07-26 18:49:40,586 |            workload | INFO    | Test Requested: step_tick - User Count (150, 2.5)\r\n2022-07-26 18:49:41,587 |            workload | INFO    | Test Requested: step_tick - User Count (180, 2.5)\r\n2022-07-26 18:49:52,908 |            workload | INFO    | Test Requested: step_tick - User Count (180, 2.5)\r\n2022-07-26 18:49:53,909 |            workload | INFO    | Test Requested: step_tick - User Count (210, 2.5)\r\n2022-07-26 18:50:05,215 |            workload | INFO    | Test Requested: step_tick - User Count (240, 2.5)\r\n2022-07-26 18:50:16,521 |            workload | INFO    | Test Requested: step_tick - User Count (240, 2.5)\r\n2022-07-26 18:50:17,523 |            workload | INFO    | Test Requested: step_tick - User Count (270, 2.5)\r\n2022-07-26 18:50:28,830 |            workload | INFO    | Test Requested: step_tick - User Count (270, 2.5)\r\n2022-07-26 18:50:29,831 |            workload | INFO    | Test Requested: step_tick - User Count (300, 2.5)\r\n2022-07-26 18:50:41,132 |            workload | INFO    | Test Requested: step_tick - User Count (330, 2.5)\r\n2022-07-26 18:50:52,424 |            workload | INFO    | Test Requested: step_tick - User Count (330, 2.5)\r\n2022-07-26 18:50:53,425 |            workload | INFO    | Test Requested: step_tick - User Count (360, 2.5)\r\n2022-07-26 18:51:05,652 |            workload | INFO    | Test Requested: step_tick - User Count (390, 2.5)\r\n2022-07-26 18:51:06,429 |      locust.runners | CRITICAL| Unhandled exception in greenlet: <Greenlet at 0x7fa78408ee60: <bound method MasterRunner.heartbeat_worker of <locust.runners.MasterRunner object at 0x7fa7969cf910>>>\r\nTraceback (most recent call last):\r\n  File \"src/gevent/greenlet.py\", line 906, in gevent._gevent_cgreenlet.Greenlet.run\r\n  File \"/usr/local/lib/python3.10/site-packages/locust/runners.py\", line 946, in heartbeat_worker\r\n    self.start(user_count=self.target_user_count, spawn_rate=self.spawn_rate)\r\n  File \"/usr/local/lib/python3.10/site-packages/locust/runners.py\", line 757, in start\r\n    for dispatched_users in self._users_dispatcher:\r\n  File \"/usr/local/lib/python3.10/site-packages/locust/dispatch.py\", line 114, in __next__\r\n    users_on_workers = next(self._dispatcher_generator)\r\nValueError: generator already executing\r\n2022-0\r\n\r\n### Environment\r\n\r\n- OS: linux\r\n- Python version: 3.10.5\r\n- Locust version: 2.10.1\r\n- Locust command line that you ran: usr/local/bin/locust -f /opt/locust/locustfile.py --config /opt/locust/locust.conf --master\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2141/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2141/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2135", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2135/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2135/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2135/events", "html_url": "https://github.com/locustio/locust/issues/2135", "id": 1311336021, "node_id": "I_kwDOABUGS85OKWZV", "number": 2135, "title": "\"New test\" with different number of users", "user": {"login": "bsypniewski", "id": 83775196, "node_id": "MDQ6VXNlcjgzNzc1MTk2", "avatar_url": "https://avatars.githubusercontent.com/u/83775196?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bsypniewski", "html_url": "https://github.com/bsypniewski", "followers_url": "https://api.github.com/users/bsypniewski/followers", "following_url": "https://api.github.com/users/bsypniewski/following{/other_user}", "gists_url": "https://api.github.com/users/bsypniewski/gists{/gist_id}", "starred_url": "https://api.github.com/users/bsypniewski/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bsypniewski/subscriptions", "organizations_url": "https://api.github.com/users/bsypniewski/orgs", "repos_url": "https://api.github.com/users/bsypniewski/repos", "events_url": "https://api.github.com/users/bsypniewski/events{/privacy}", "received_events_url": "https://api.github.com/users/bsypniewski/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2022-07-20T15:24:24Z", "updated_at": "2022-08-07T19:09:57Z", "closed_at": "2022-08-07T19:09:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "It seems likes a bug to me, but please correct me if I'm wrong. It seems that after clicking on \"new test\" and giving lower amount of users to be created, Locust still uses some of the users created on first run.\r\n\r\n### Describe the bug\r\nExample:\r\nWhen i start locust and create (total) 5 users with 5 users per sec, I get correct amount of users/requests. That is correct. Then i click Stop (in the UI).\r\nAfter clicking on \"New test\" and specifying lower amount of users(total 1 and 1 per sec), Locust still starts 4 users in total and execute tasks - but in console i can see that 1 user was spawned\r\n\r\nCode:\r\n```\r\nimport logging\r\nimport time\r\nimport uuid\r\nfrom locust import task, HttpUser, SequentialTaskSet, constant_pacing, task, events\r\nfrom locust.exception import StopUser\r\n\r\nlogging.basicConfig(level=logging.DEBUG)\r\nlogger = logging.getLogger(\"locust\")\r\n\r\nclass UserTasks(SequentialTaskSet):\r\n    wait_time = constant_pacing(1)\r\n\r\n    @task\r\n    def test_api_one(self):\r\n        logger.info(f\"Task1: {self.parent.user_id}\")\r\n        time.sleep(1)\r\n\r\n    @task\r\n    def test_api_two(self):\r\n        logger.info(f\"Task2: {self.parent.user_id}\")\r\n        time.sleep(1)\r\n    \r\n    @task\r\n    def test_api_three(self):\r\n        self.interrupt(False)\r\n\r\nclass WebsiteUser(HttpUser):\r\n    host = \"http://local\"\r\n    wait_time = constant_pacing(5)\r\n    tasks = [UserTasks]\r\n\r\n    def on_start(self):\r\n        self.user_id = str(uuid.uuid4())\r\n        logger.info(f\"START USER: {self.user_id}\")\r\n\r\n    def on_stop(self):\r\n        logger.info(f\"STOP USER: {self.user_id}\")\r\n```\r\n\r\n### Expected behaviour\r\nI would expect that if i run new test with lower number of users - from 5 to 1 users, Locust will just create 1 user and run (spawn) only that one.\r\n\r\nYou can see it on the screenshot:\r\n\r\n\r\n### Environment\r\n\r\n- OS: docker with python 3.9\r\n- Python version: 3.9\r\n- Locust 2.9.0\r\n- locust -f temp.py\r\n\r\n![Screenshot 2022-07-20 at 16 21 47](https://user-images.githubusercontent.com/83775196/180020920-6ceb807a-26b3-4de6-b849-e65629ce54fb.png)\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2135/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2135/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2129", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2129/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2129/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2129/events", "html_url": "https://github.com/locustio/locust/issues/2129", "id": 1299034860, "node_id": "I_kwDOABUGS85NbbLs", "number": 2129, "title": "HttpUser on_stop method could not be called via debugger ", "user": {"login": "SamPosh", "id": 21053120, "node_id": "MDQ6VXNlcjIxMDUzMTIw", "avatar_url": "https://avatars.githubusercontent.com/u/21053120?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SamPosh", "html_url": "https://github.com/SamPosh", "followers_url": "https://api.github.com/users/SamPosh/followers", "following_url": "https://api.github.com/users/SamPosh/following{/other_user}", "gists_url": "https://api.github.com/users/SamPosh/gists{/gist_id}", "starred_url": "https://api.github.com/users/SamPosh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SamPosh/subscriptions", "organizations_url": "https://api.github.com/users/SamPosh/orgs", "repos_url": "https://api.github.com/users/SamPosh/repos", "events_url": "https://api.github.com/users/SamPosh/events{/privacy}", "received_events_url": "https://api.github.com/users/SamPosh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-07-08T13:36:08Z", "updated_at": "2022-08-24T02:17:34Z", "closed_at": "2022-08-24T02:17:34Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nWhen debugging from Vscode, there is no option to call on_stop method in HttpUser. If i click ctrl+c it stops as keyboard interrupted. There must be a way to trigger on_stop\r\n\r\n### Expected behavior\r\nWhen we click ctrl+c ,it should run on_stop method code \r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2129/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2129/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2128", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2128/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2128/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2128/events", "html_url": "https://github.com/locustio/locust/issues/2128", "id": 1294544013, "node_id": "I_kwDOABUGS85NKSyN", "number": 2128, "title": "Users are not distributed equally across workers.", "user": {"login": "guysv", "id": 32539816, "node_id": "MDQ6VXNlcjMyNTM5ODE2", "avatar_url": "https://avatars.githubusercontent.com/u/32539816?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guysv", "html_url": "https://github.com/guysv", "followers_url": "https://api.github.com/users/guysv/followers", "following_url": "https://api.github.com/users/guysv/following{/other_user}", "gists_url": "https://api.github.com/users/guysv/gists{/gist_id}", "starred_url": "https://api.github.com/users/guysv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guysv/subscriptions", "organizations_url": "https://api.github.com/users/guysv/orgs", "repos_url": "https://api.github.com/users/guysv/repos", "events_url": "https://api.github.com/users/guysv/events{/privacy}", "received_events_url": "https://api.github.com/users/guysv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2022-07-05T16:56:45Z", "updated_at": "2022-07-08T10:50:12Z", "closed_at": "2022-07-07T12:12:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nRunning locust in k8s across hundreds of workers, I peeked the workers UI tab and wondered why do some workers report to run several users, when most of the cluster is still not running a single user.\r\n\r\n### Expected behavior\r\nI expected the users to be equally distributed across my workers\r\n\r\n### Actual behavior\r\nI ran this test with 600 workers\r\n<img width=\"1377\" alt=\"image\" src=\"https://user-images.githubusercontent.com/32539816/177377688-aea0859f-9de3-42c8-972d-4ece8d219d4c.png\">\r\n\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\nI guess it reproduces with a high number of workers?\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: k8s\r\n- Python version: locust latest official docker image\r\n- Locust version: locust latest official docker image\r\n- Locust command line that you ran: `args: [\"-f\", \"/loadtest/locustfile.py\", \"--worker\", \"--master-host\", \"locust-master\"]`\r\n- Locust file contents (anonymized if necessary):\r\n```\r\nfrom locust import HttpUser, task\r\nimport subprocess\r\n\r\nclass LoadTestUser(HttpUser):\r\n    @task\r\n    def do_test(self):\r\n        urlfile = subprocess.check_output([\"bash\", \"-c\", \"find /loadtest/urlfiles -type f | shuf | head -n 1\"]).rstrip()\r\n        with open(urlfile) as f:\r\n            urls = [l.rstrip() for l in f.readlines()]\r\n        for u in urls:\r\n            self.client.get(u, verify=False)\r\n```\r\n\r\nBasically the test fetches a random url list for a single flow in our system, and probes all the URLs.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2128/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2128/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2126", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2126/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2126/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2126/events", "html_url": "https://github.com/locustio/locust/issues/2126", "id": 1292793133, "node_id": "I_kwDOABUGS85NDnUt", "number": 2126, "title": "HTML Report does not correctly escape statistics data", "user": {"login": "herrmanntom", "id": 9271558, "node_id": "MDQ6VXNlcjkyNzE1NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/9271558?v=4", "gravatar_id": "", "url": "https://api.github.com/users/herrmanntom", "html_url": "https://github.com/herrmanntom", "followers_url": "https://api.github.com/users/herrmanntom/followers", "following_url": "https://api.github.com/users/herrmanntom/following{/other_user}", "gists_url": "https://api.github.com/users/herrmanntom/gists{/gist_id}", "starred_url": "https://api.github.com/users/herrmanntom/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/herrmanntom/subscriptions", "organizations_url": "https://api.github.com/users/herrmanntom/orgs", "repos_url": "https://api.github.com/users/herrmanntom/repos", "events_url": "https://api.github.com/users/herrmanntom/events{/privacy}", "received_events_url": "https://api.github.com/users/herrmanntom/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-07-04T08:09:35Z", "updated_at": "2022-07-18T06:45:47Z", "closed_at": "2022-07-18T06:45:47Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Describe the bug\r\nIn case your statistics include html, or html-like content, then the html report breaks in various ways.\r\nFor example, one could:\r\n- include \"place holders\" in custom names for requests that happen to have angle brackets in them (`name=\"/api/user/<userId>/info\"`)\r\n- custom error messages might contain (parts of) the request text, which then might contain html (`response.failure(\"failed with payload: ' + response.text)`)\r\n\r\n### Expected behavior\r\nall html entities within user controlled parts of the statistics must be properly encoded, so that report can be viewed correctly with such data inside\r\n\r\n### Actual behavior\r\ndata is not encoded, report breaks\r\n\r\n### Steps to reproduce\r\nMark a response as failed with this message:\r\n`response.failure(\"<title>\")`\r\nthen generate html report\r\nLook at \"failure\" table. It will break after this entry. Also remaining content after this line is broken (so graphs are missing etc)\r\n\r\n### Environment\r\n\r\n- OS: Fedora 36\r\n- Python version: 3.9\r\n- Locust version: 2.10.1\r\n- Locust command line that you ran: locust -f testcases.py\r\n- Locust file contents (anonymized if necessary): (see above for relevant parts)", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2126/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2126/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2122", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2122/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2122/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2122/events", "html_url": "https://github.com/locustio/locust/issues/2122", "id": 1285793656, "node_id": "I_kwDOABUGS85Mo6d4", "number": 2122, "title": "`client.post` \"name\" parameter does not affect FastHttpUser failures stats", "user": {"login": "Sawiq", "id": 35547519, "node_id": "MDQ6VXNlcjM1NTQ3NTE5", "avatar_url": "https://avatars.githubusercontent.com/u/35547519?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Sawiq", "html_url": "https://github.com/Sawiq", "followers_url": "https://api.github.com/users/Sawiq/followers", "following_url": "https://api.github.com/users/Sawiq/following{/other_user}", "gists_url": "https://api.github.com/users/Sawiq/gists{/gist_id}", "starred_url": "https://api.github.com/users/Sawiq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Sawiq/subscriptions", "organizations_url": "https://api.github.com/users/Sawiq/orgs", "repos_url": "https://api.github.com/users/Sawiq/repos", "events_url": "https://api.github.com/users/Sawiq/events{/privacy}", "received_events_url": "https://api.github.com/users/Sawiq/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-06-27T13:15:50Z", "updated_at": "2022-08-24T02:17:38Z", "closed_at": "2022-08-24T02:17:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n* User class being a subclass of `FastHttpUser`\r\n* Requests renamed somehow, eg.:\r\n```\r\nself.client.get(\r\n    f\"/books/{id}\",\r\n    name=\"/books/ID\"\r\n)\r\n```\r\n* Endpoints returns status other than 2xx\r\n\r\n### Expected behavior\r\nReported errors like\r\n\r\n> \"BadStatusCode(https://example.com/books/ID', code=401)\"\r\n\r\n### Actual behavior\r\nReported errors like\r\n\r\n> \"BadStatusCode(https://example.com/books/1', code=401)\"\r\n> \"BadStatusCode(https://example.com/books/2', code=401)\"\r\n> \"BadStatusCode(https://example.com/books/3', code=401)\"\r\n> \"BadStatusCode(https://example.com/books/4', code=401)\"\r\netc. `name` parameter seems to not work.\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: Linux (Mint, CentOS)\r\n- Python version: 3.10.5 (compiled from source as well as from distribution repositories)\r\n- Locust version: locust 2.9.0\r\n- Locust command line that you ran: `locust -f $1 --master --expect-workers=7`\r\n- Locust file contents (anonymized if necessary): in the examples", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2122/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2122/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2118", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2118/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2118/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2118/events", "html_url": "https://github.com/locustio/locust/issues/2118", "id": 1276516831, "node_id": "I_kwDOABUGS85MFhnf", "number": 2118, "title": "Locust torture testing websocket single node runs normally, when using distributed runtime, the slave node state will change from running state to missing state", "user": {"login": "huhengzhang", "id": 75507654, "node_id": "MDQ6VXNlcjc1NTA3NjU0", "avatar_url": "https://avatars.githubusercontent.com/u/75507654?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huhengzhang", "html_url": "https://github.com/huhengzhang", "followers_url": "https://api.github.com/users/huhengzhang/followers", "following_url": "https://api.github.com/users/huhengzhang/following{/other_user}", "gists_url": "https://api.github.com/users/huhengzhang/gists{/gist_id}", "starred_url": "https://api.github.com/users/huhengzhang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huhengzhang/subscriptions", "organizations_url": "https://api.github.com/users/huhengzhang/orgs", "repos_url": "https://api.github.com/users/huhengzhang/repos", "events_url": "https://api.github.com/users/huhengzhang/events{/privacy}", "received_events_url": "https://api.github.com/users/huhengzhang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1993314533, "node_id": "MDU6TGFiZWwxOTkzMzE0NTMz", "url": "https://api.github.com/repos/locustio/locust/labels/cantfix", "name": "cantfix", "color": "dddddd", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-06-20T07:51:53Z", "updated_at": "2022-06-22T13:51:58Z", "closed_at": "2022-06-22T12:46:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nSame script single node torture testing websocket protocol when everything works\r\n![image](https://user-images.githubusercontent.com/75507654/174549797-99314c5c-3b0e-4b34-bf14-cdaf1e87d5a2.png)\r\n\r\nThen when using distributed torture testing, the running state of the slave node will change from running to missing and only one slave node will be kept at the end\r\n![image](https://user-images.githubusercontent.com/75507654/174550134-392bc3af-a67d-4998-bf9e-c8191c9bba4d.png)\r\n\r\nFailed two slave nodes, occupying process cpu to 100%\r\n![image](https://user-images.githubusercontent.com/75507654/174550199-501e0c00-1172-40e2-9d42-b286413bda0e.png)\r\n\r\nMasternode log:\r\n![image](https://user-images.githubusercontent.com/75507654/174550375-cc421138-6c11-4be6-9e13-1dfa436d1fda.png)\r\n\r\nInvalid slave log\uff1a\r\n\r\n![image](https://user-images.githubusercontent.com/75507654/174550567-9a4420e7-5ffb-45dc-95db-01dee8f39905.png)\r\n\r\nNormal slave log\uff1a\r\n![image](https://user-images.githubusercontent.com/75507654/174550784-0944203f-1535-4bd0-9ad6-0c64eff2a808.png)\r\n\r\n\r\n\r\n\r\n\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: linux \r\n- Python version:  3.7.9\r\n- Locust version:   2.8.6\r\n- Locust command line that you ran: locust -f user_server.py --master   locust -f user_server.py --worker --master-host=127.0.0.1\r\n- Locust file contents (anonymized if necessary):\r\n\r\nclass MyTcpTask(TaskSet):\r\n\r\n    def on_start(self):\r\n        username = self.user.user_name_data.get_nowait()\r\n        uin = self.user.uin_data.get_nowait()\r\n        login_res = self.user_register(username)\r\n        session_id = login_res.get('data').get('session_id')\r\n        area_id = login_res.get('data').get('area_list')[0].get('area_id')\r\n        self.auth_res = self.user_auth(session_id, uin, area_id)\r\n        self.map_len = len(self.user.map_id)\r\n        self.map_index = self.map_len\r\n        # \u53d1\u9001\u767b\u5f55\u534f\u8bae\r\n        self.url = self.auth_res.get('data').get('gateway_ip')\r\n        self.SessionKey = self.auth_res.get('data').get('session_key')\r\n        self.group_id = self.auth_res.get('data').get('group_id')\r\n        self.GameID = self.auth_res.get('data').get('game_id')\r\n        self.uin = self.auth_res.get('data').get('uin')\r\n        self.client.connect(self.url)\r\n\r\n\r\n    @task\r\n    def login_server(self):\r\n        MsgID = 600001\r\n        SubMsgID = 0\r\n        my_data = {'context': 'helloworld'}\r\n        start_time = time.time()\r\n        self.client.send(my_data)\r\n\r\n        result = self.client.on_receive(\"0\")\r\n        end_time = time.time()\r\n        total_time = int((end_time - start_time) * 1000)\r\n        name = proto_dic.get(str(MsgID)).get(\"protocol_name\")\r\n        logging.info(f\"login server result is {result}\")\r\n        if result['resultID'] == 0:\r\n            success_call(name=name, recvText=result, total_time=total_time)\r\n        else:\r\n            fail_call(name=name, recvText=result, total_time=total_time)\r\n\r\n\r\n    def user_register(self, username):\r\n        \"\"\"\r\n         \u7528\u6237\u767b\u5f55\r\n        \"\"\"\r\n        response = requests.get(url=\"\", params=params)\r\n        #logging.info(f'user login result is {response.json()}')\r\n        return response.json()\r\n\r\n\r\n    def user_auth(self, session_id, uin, area_id):\r\n        \"\"\"\r\n        \u7528\u6237\u8ba4\u8bc1\r\n        \"\"\"\r\n        response = requests.get(url=\"\", params=params)\r\n        return response.json()\r\n\r\nclass MyUser(WSUser):\r\n    tasks = [MyTcpTask]\r\n    wait_time = between(0.01, 0.01)\r\n\r\n    user_data = ['18527295673_0,589746', '13915780038_1,589747', '18139788755_2,589748', '13094592411_3,589749', '18646942540_4,589750', '14593939387_5,589751', '13121492103_6,589752', '18918148166_7,589753', '15846453803_8,589754', '18100835958_9,589755', '15298371732_10,589756']\r\n    user_name_data = queue.Queue()\r\n    uin_data = queue.Queue()\r\n    map_id = [1, 1001]\r\n\r\n    for i in user_data:\r\n        user_name_data.put_nowait(i.split(\",\")[0])\r\n        uin_data.put_nowait(i.split(\",\")[1])\r\n\r\nCustom extension websocket client side code:\r\n\r\n\r\nclass WSClient(object):\r\n\r\n    def __init__(self):\r\n        self.ws = None\r\n    # \u5efa\u7acb\u8fde\u63a5\r\n    def connect(self, url):\r\n        logging.info(f\"url is {url}\")\r\n        self.ws = create_connection(url)\r\n        print(self.ws.getstatus())\r\n\r\n\r\n    def on_receive(self, subMsgID):\r\n        while True:\r\n            try:\r\n                # \u5904\u7406\u54cd\u5e94\u6570\u636e\r\n                message = self.ws.recv()\r\n                # logging.info(f'receive ws is : {msg_result}')\r\n                if str(SUbMsgID) == subMsgID:\r\n                    return msg_result\r\n            except Exception as e:\r\n                logging.error(e)\r\n\r\n\r\n    def send(self, Uin=None, SessionKey=None, MsgID=None, GameID=None, GroupID=None, Seq=None, SubMsgID=None,\r\n             body: dict = None):\r\n      \r\n        self.ws.send(send_data)\r\n\r\n    # \u5173\u95ed\u8fde\u63a5\r\n    def close(self):\r\n        self.ws.close()\r\n        # logging.info(\"\u5173\u95ed\u8fde\u63a5\u6210\u529f\")\r\n\r\n\r\nclass WSUser(User):\r\n    \"\"\"\r\n    A minimal Locust user class that provides an XmlRpcClient to its subclasses\r\n    \"\"\"\r\n    abstract = True  # dont instantiate this as an actual user when running Locust\r\n    def __init__(self, environment):\r\n        super().__init__(environment)\r\n        self.client = WSClient()\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2118/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2118/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2115", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2115/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2115/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2115/events", "html_url": "https://github.com/locustio/locust/issues/2115", "id": 1271056203, "node_id": "I_kwDOABUGS85LwsdL", "number": 2115, "title": "Can't install locust on M1 Mac", "user": {"login": "NitzanShifrin", "id": 42731841, "node_id": "MDQ6VXNlcjQyNzMxODQx", "avatar_url": "https://avatars.githubusercontent.com/u/42731841?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NitzanShifrin", "html_url": "https://github.com/NitzanShifrin", "followers_url": "https://api.github.com/users/NitzanShifrin/followers", "following_url": "https://api.github.com/users/NitzanShifrin/following{/other_user}", "gists_url": "https://api.github.com/users/NitzanShifrin/gists{/gist_id}", "starred_url": "https://api.github.com/users/NitzanShifrin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NitzanShifrin/subscriptions", "organizations_url": "https://api.github.com/users/NitzanShifrin/orgs", "repos_url": "https://api.github.com/users/NitzanShifrin/repos", "events_url": "https://api.github.com/users/NitzanShifrin/events{/privacy}", "received_events_url": "https://api.github.com/users/NitzanShifrin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2022-06-14T16:27:11Z", "updated_at": "2022-10-07T02:17:54Z", "closed_at": "2022-10-07T02:17:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "Error when installing locust - problem with gevent\r\n\r\nRequirement already satisfied: pyzmq>=22.2.1 in /Users/nshifrin/Library/Python/3.8/lib/python/site-packages (from locust->-r BusLoadTest/requirements.txt (line 1)) (22.3.0)\r\nCollecting gevent>=20.12.1\r\n  Using cached gevent-21.12.0.tar.gz (6.2 MB)\r\n  Installing build dependencies ... done\r\n  Getting requirements to build wheel ... done\r\n  Preparing metadata (pyproject.toml) ... error\r\n  error: subprocess-exited-with-error\r\n  \r\n  \u00d7 Preparing metadata (pyproject.toml) did not run successfully.\r\n  \u2502 exit code: 1\r\n  \r\nImportError: dlopen(/private/var/folders/yt/yzcjd_217bx_jqc12n70kt0m0000gn/T/pip-build-env-fi2yc_2l/overlay/lib/python3.8/site-packages/_cffi_backend.cpython-38-darwin.so, 0x0002): tried: '/private/var/folders/yt/yzcjd_217bx_jqc12n70kt0m0000gn/T/pip-build-env-fi2yc_2l/overlay/lib/python3.8/site-packages/_cffi_backend.cpython-38-darwin.so' (mach-o file, but is an incompatible architecture (have 'x86_64', need 'arm64e')), '/usr/local/lib/_cffi_backend.cpython-38-darwin.so' (no such file), '/usr/lib/_cffi_backend.cpython-38-darwin.so' (no such file)\r\n\r\n\r\n### Environment\r\n- OS: Mac Monterey 12.2.1\r\n- Python version: 3.8\r\n- Locust version: latest and 2.8.3\r\n- Locust command line that you ran: pip3 install locust", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2115/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2115/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2114", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2114/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2114/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2114/events", "html_url": "https://github.com/locustio/locust/issues/2114", "id": 1270384300, "node_id": "I_kwDOABUGS85LuIas", "number": 2114, "title": " Remove \"missing\" workers from the counter", "user": {"login": "yashwanth5amagi", "id": 79246435, "node_id": "MDQ6VXNlcjc5MjQ2NDM1", "avatar_url": "https://avatars.githubusercontent.com/u/79246435?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yashwanth5amagi", "html_url": "https://github.com/yashwanth5amagi", "followers_url": "https://api.github.com/users/yashwanth5amagi/followers", "following_url": "https://api.github.com/users/yashwanth5amagi/following{/other_user}", "gists_url": "https://api.github.com/users/yashwanth5amagi/gists{/gist_id}", "starred_url": "https://api.github.com/users/yashwanth5amagi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yashwanth5amagi/subscriptions", "organizations_url": "https://api.github.com/users/yashwanth5amagi/orgs", "repos_url": "https://api.github.com/users/yashwanth5amagi/repos", "events_url": "https://api.github.com/users/yashwanth5amagi/events{/privacy}", "received_events_url": "https://api.github.com/users/yashwanth5amagi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635903137, "node_id": "MDU6TGFiZWwxNjM1OTAzMTM3", "url": "https://api.github.com/repos/locustio/locust/labels/duplicate", "name": "duplicate", "color": "9cea8c", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-06-14T07:35:43Z", "updated_at": "2022-06-14T09:05:47Z", "closed_at": "2022-06-14T09:05:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "When a worker is deleted from the list of workers connected to master instance, the count on the dashboard of master shows same and in workers tab, the deleted worker status shows as missing. This affects the users getting created when a test starts. ", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2114/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2114/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2111", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2111/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2111/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2111/events", "html_url": "https://github.com/locustio/locust/issues/2111", "id": 1265965919, "node_id": "I_kwDOABUGS85LdRtf", "number": 2111, "title": "\"Stop\" hang on \"stopping\" state  when there are more than one workers in distributed mode.", "user": {"login": "xllalitha", "id": 76480195, "node_id": "MDQ6VXNlcjc2NDgwMTk1", "avatar_url": "https://avatars.githubusercontent.com/u/76480195?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xllalitha", "html_url": "https://github.com/xllalitha", "followers_url": "https://api.github.com/users/xllalitha/followers", "following_url": "https://api.github.com/users/xllalitha/following{/other_user}", "gists_url": "https://api.github.com/users/xllalitha/gists{/gist_id}", "starred_url": "https://api.github.com/users/xllalitha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xllalitha/subscriptions", "organizations_url": "https://api.github.com/users/xllalitha/orgs", "repos_url": "https://api.github.com/users/xllalitha/repos", "events_url": "https://api.github.com/users/xllalitha/events{/privacy}", "received_events_url": "https://api.github.com/users/xllalitha/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-06-09T11:05:57Z", "updated_at": "2022-07-03T14:52:30Z", "closed_at": "2022-07-03T14:52:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "Observed an  issue after clicking \"stop\" load test from web console of master node. \"stop\" status change to \"stopping\" status and hang there without reaching \"stopped\" state. When there is only 1 worker,  it reaches properly to \"stopped\" state.. I had to restart locust master again to restart load test when it was hung on \"stopping\" state. Issue repeats when I have more than one worker.\r\n\r\nI experienced this issue first when running master and workers on AWS fargate containers .Interestingly, there were no errors logged in master and worker containers  after pressing stop button. With just single worker container, Stop status properly move to \"stopped\" on web console master. Having more than 1 worker cause this issue.\r\n\r\nLater I could  reproduce this issue on local  machine without even docker. \r\n\r\nWhen I run locust master and 2 workers from my local MacBook itself, I am experiencing this issue. \r\nThere are no errors thrown after clicking \"stop\".  With 1 worker, it work fine and move to \"stopped\" status.\r\n\r\nHow to reproduce in local MacBook\r\n\r\n1. Start Locust master from one terminal with below command\r\n \r\n  locust -f my_locustfile.py  --master\r\n\r\n2. Start 2 locust workers from another 2 terminals with below command\r\n\r\n  locust -f my_locustfile.py  --worker.\r\n\r\n (Ignored \"--master-host\"  parameter here as it is local run. In AWS Fargate setup, we have that parameter)\r\n\r\nAfter this master web console(http://0.0.0.0:8089/) shows 2 workers connected, also load test work fine.  When click on \"stop\" it changes to \"stopping\" and never come to \"stopped\".  \r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2111/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2111/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2109", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2109/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2109/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2109/events", "html_url": "https://github.com/locustio/locust/issues/2109", "id": 1260030881, "node_id": "I_kwDOABUGS85LGouh", "number": 2109, "title": "Requests made by client is not wrapping correctly `cert` parameter", "user": {"login": "gabriel-farache", "id": 3036508, "node_id": "MDQ6VXNlcjMwMzY1MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/3036508?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gabriel-farache", "html_url": "https://github.com/gabriel-farache", "followers_url": "https://api.github.com/users/gabriel-farache/followers", "following_url": "https://api.github.com/users/gabriel-farache/following{/other_user}", "gists_url": "https://api.github.com/users/gabriel-farache/gists{/gist_id}", "starred_url": "https://api.github.com/users/gabriel-farache/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gabriel-farache/subscriptions", "organizations_url": "https://api.github.com/users/gabriel-farache/orgs", "repos_url": "https://api.github.com/users/gabriel-farache/repos", "events_url": "https://api.github.com/users/gabriel-farache/events{/privacy}", "received_events_url": "https://api.github.com/users/gabriel-farache/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2022-06-03T15:12:10Z", "updated_at": "2022-12-03T01:58:58Z", "closed_at": "2022-12-03T01:58:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nWhen using `client` with `cert` and `verify` arguments to make  https requests, these arguments seems to NOT be given to `request` when executing the request\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nAs per https://github.com/locustio/locust/issues/468#issuecomment-608948112, the client should wrap and pass the `cert` arguments to `requests`\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nWhen using `client` with `cert` and `verify` arguments to make  https requests, I got a 401 status but when I use directly `request` to make the request, I get a 200 status\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\nThis returns 401\r\n`r = self.client.post(\r\n                f\"https://<url>\",\r\n                headers={\"Content-Type\": \"application/json\"}, json=json,\r\n                cert=(<path to pem cert file>, <path to key file>), verify=<path to ca pem file>)`\r\nThis returns 200\r\n`r = requests.post(\r\n                f\"https://<url>\",\r\n                headers={\"Content-Type\": \"application/json\"}, json=json,\r\n                cert=(<path to pem cert file>, <path to key file>), verify=<path to ca pem file>)`\r\n\r\nMy server is sending 401 when it receives requests not authenticated by a certificate so this behaviour is nominal.\r\n\r\n\r\n### Environment\r\n\r\n- OS: Fedora\r\n- Python version: 3.8\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds) locust 2.8.6 (I got this version even after running `pip3 install -U locust`)\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2109/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2109/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2108", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2108/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2108/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2108/events", "html_url": "https://github.com/locustio/locust/issues/2108", "id": 1258199205, "node_id": "I_kwDOABUGS85K_pil", "number": 2108, "title": "Locust workers running on separate VM are not able to connect to master when master is composed with DOCKER. ", "user": {"login": "jotsd9001", "id": 106752885, "node_id": "U_kgDOBlzrdQ", "avatar_url": "https://avatars.githubusercontent.com/u/106752885?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jotsd9001", "html_url": "https://github.com/jotsd9001", "followers_url": "https://api.github.com/users/jotsd9001/followers", "following_url": "https://api.github.com/users/jotsd9001/following{/other_user}", "gists_url": "https://api.github.com/users/jotsd9001/gists{/gist_id}", "starred_url": "https://api.github.com/users/jotsd9001/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jotsd9001/subscriptions", "organizations_url": "https://api.github.com/users/jotsd9001/orgs", "repos_url": "https://api.github.com/users/jotsd9001/repos", "events_url": "https://api.github.com/users/jotsd9001/events{/privacy}", "received_events_url": "https://api.github.com/users/jotsd9001/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-06-02T13:36:13Z", "updated_at": "2022-07-18T02:18:11Z", "closed_at": "2022-07-18T02:18:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "When i run master (on VM1) as docker image the locust does not strt on port 5557 which makes workers (on VM2) not able to connect to master\r\nOn Netstat we are able to see that VM 2  (with workers) tries to sync but the sync never gets complete with VM1(Master).", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2108/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2108/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2105", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2105/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2105/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2105/events", "html_url": "https://github.com/locustio/locust/issues/2105", "id": 1244813003, "node_id": "I_kwDOABUGS85KMlbL", "number": 2105, "title": "debugger dosn't recognize `--host` when using `python -m locustfile`", "user": {"login": "huangjj27", "id": 8068443, "node_id": "MDQ6VXNlcjgwNjg0NDM=", "avatar_url": "https://avatars.githubusercontent.com/u/8068443?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huangjj27", "html_url": "https://github.com/huangjj27", "followers_url": "https://api.github.com/users/huangjj27/followers", "following_url": "https://api.github.com/users/huangjj27/following{/other_user}", "gists_url": "https://api.github.com/users/huangjj27/gists{/gist_id}", "starred_url": "https://api.github.com/users/huangjj27/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huangjj27/subscriptions", "organizations_url": "https://api.github.com/users/huangjj27/orgs", "repos_url": "https://api.github.com/users/huangjj27/repos", "events_url": "https://api.github.com/users/huangjj27/events{/privacy}", "received_events_url": "https://api.github.com/users/huangjj27/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-05-23T08:57:42Z", "updated_at": "2022-06-27T19:56:26Z", "closed_at": "2022-05-24T01:07:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nWriting a locust file test for both test environment and production. When running `python -m locustfile --host=my.test.env.ip`, it keeps reminding me about \"You must specify the base host. Either in the host attribute in the User class, or on the command line using the --host option.\"\r\n\r\n### Expected behavior\r\nI pass the `--host`, and the debugger should get it!\r\n\r\n### Actual behavior\r\nIt keeps reminding me about \"You must specify the base host. Either in the host attribute in the User class, or on the command line using the --host option.\"\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: Windows 10\r\n- Python version: Python 3.10.1\r\n- Locust version: 2.8.6, 2.9.0\r\n- Locust command line that you ran: `python -m locustfile --host=some.online.service.ip`\r\n- Locust file contents (anonymized if necessary):\r\n```py\r\n# locustfile.py\r\nfrom locust import FastHttpUser, run_single_user\r\n\r\nclass MyUser(FastHttpUser):\r\n    pass\r\n\r\nif __name__ == \"__main__\":\r\n    run_single_user(MyUser)\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2105/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2105/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2103", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2103/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2103/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2103/events", "html_url": "https://github.com/locustio/locust/issues/2103", "id": 1243128534, "node_id": "I_kwDOABUGS85KGKLW", "number": 2103, "title": "Installation is broken via pip", "user": {"login": "omonimus1", "id": 23085146, "node_id": "MDQ6VXNlcjIzMDg1MTQ2", "avatar_url": "https://avatars.githubusercontent.com/u/23085146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omonimus1", "html_url": "https://github.com/omonimus1", "followers_url": "https://api.github.com/users/omonimus1/followers", "following_url": "https://api.github.com/users/omonimus1/following{/other_user}", "gists_url": "https://api.github.com/users/omonimus1/gists{/gist_id}", "starred_url": "https://api.github.com/users/omonimus1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omonimus1/subscriptions", "organizations_url": "https://api.github.com/users/omonimus1/orgs", "repos_url": "https://api.github.com/users/omonimus1/repos", "events_url": "https://api.github.com/users/omonimus1/events{/privacy}", "received_events_url": "https://api.github.com/users/omonimus1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-05-20T13:09:18Z", "updated_at": "2022-07-03T14:52:55Z", "closed_at": "2022-07-03T14:52:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "when doing   ```pip3 install locust```\r\nI receive: ValueError: not enough values to unpack (expected 4, got 3);\r\nI tried also:\r\n* With pip (and not pip3)\r\n* Indicating the version ==2.9.0", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2103/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2103/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2099", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2099/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2099/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2099/events", "html_url": "https://github.com/locustio/locust/issues/2099", "id": 1241582073, "node_id": "I_kwDOABUGS85KAQn5", "number": 2099, "title": "Locust is not starting with pyzmq 23.0.0", "user": {"login": "marcinh", "id": 6491818, "node_id": "MDQ6VXNlcjY0OTE4MTg=", "avatar_url": "https://avatars.githubusercontent.com/u/6491818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marcinh", "html_url": "https://github.com/marcinh", "followers_url": "https://api.github.com/users/marcinh/followers", "following_url": "https://api.github.com/users/marcinh/following{/other_user}", "gists_url": "https://api.github.com/users/marcinh/gists{/gist_id}", "starred_url": "https://api.github.com/users/marcinh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marcinh/subscriptions", "organizations_url": "https://api.github.com/users/marcinh/orgs", "repos_url": "https://api.github.com/users/marcinh/repos", "events_url": "https://api.github.com/users/marcinh/events{/privacy}", "received_events_url": "https://api.github.com/users/marcinh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-05-19T10:43:58Z", "updated_at": "2022-05-26T01:52:40Z", "closed_at": "2022-05-19T17:09:50Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nWith latest ZMQ release (23.0.0) Locust stopped working - following error appears on Master:\r\n```\r\nlocust-master: File \"/root/.local/share/virtualenvs/locust-1T7N9san/bin/locust\", line 8, in <module>\r\nlocust-master: sys.exit(main())\r\nlocust-master: File \"/root/.local/share/virtualenvs/locust-1T7N9san/lib/python3.9/site-packages/locust/main.py\", line 230, in main\r\nlocust-master: runner = environment.create_master_runner(\r\nlocust-master: File \"/root/.local/share/virtualenvs/locust-1T7N9san/lib/python3.9/site-packages/locust/env.py\", line 138, in create_master_runner\r\nlocust-master: return self._create_runner(\r\nlocust-master: File \"/root/.local/share/virtualenvs/locust-1T7N9san/lib/python3.9/site-packages/locust/env.py\", line 116, in _create_runner\r\nlocust-master: self.runner = runner_class(self, *args, **kwargs)\r\nlocust-master: File \"/root/.local/share/virtualenvs/locust-1T7N9san/lib/python3.9/site-packages/locust/runners.py\", line 619, in __init__\r\nlocust-master: self.server = rpc.Server(master_bind_host, master_bind_port)\r\nlocust-master: File \"/root/.local/share/virtualenvs/locust-1T7N9san/lib/python3.9/site-packages/locust/rpc/zmqrpc.py\", line 58, in __init__\r\nlocust-master: BaseSocket.__init__(self, zmq.ROUTER)\r\nlocust-master: AttributeError: module 'zmq.green' has no attribute 'ROUTER'\r\n```\r\nand similar on worker:\r\n```\r\nlocust-worker_four: Traceback (most recent call last):\r\nlocust-worker_four: File \"/root/.local/share/virtualenvs/locust-1T7N9san/bin/locust\", line 8, in <module>\r\nlocust-worker_four: sys.exit(main())\r\nlocust-worker_four: File \"/root/.local/share/virtualenvs/locust-1T7N9san/lib/python3.9/site-packages/locust/main.py\", line 236, in main\r\nlocust-worker_four: runner = environment.create_worker_runner(options.master_host, options.master_port)\r\nlocust-worker_four: File \"/root/.local/share/virtualenvs/locust-1T7N9san/lib/python3.9/site-packages/locust/env.py\", line 154, in create_worker_runner\r\nlocust-worker_four: return self._create_runner(\r\nlocust-worker_four: File \"/root/.local/share/virtualenvs/locust-1T7N9san/lib/python3.9/site-packages/locust/env.py\", line 116, in _create_runner\r\nlocust-worker_four: self.runner = runner_class(self, *args, **kwargs)\r\nlocust-worker_four: File \"/root/.local/share/virtualenvs/locust-1T7N9san/lib/python3.9/site-packages/locust/runners.py\", line 1051, in __init__\r\nlocust-worker_four: self.client = rpc.Client(master_host, master_port, self.client_id)\r\nlocust-worker_four: File \"/root/.local/share/virtualenvs/locust-1T7N9san/lib/python3.9/site-packages/locust/rpc/zmqrpc.py\", line 71, in __init__\r\nlocust-worker_four: BaseSocket.__init__(self, zmq.DEALER)\r\nlocust-worker_four: AttributeError: module 'zmq.green' has no attribute 'DEALER'\r\n```\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\nInstall Locust with inclusion of latest ZMQ release - start master o start worker\r\n\r\n### Environment\r\n\r\n- OS: CentOS\r\n- Python version: 3.9\r\n- Locust version: 2.8.4\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2099/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2099/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2098", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2098/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2098/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2098/events", "html_url": "https://github.com/locustio/locust/issues/2098", "id": 1239642377, "node_id": "I_kwDOABUGS85J43EJ", "number": 2098, "title": "can't import locust in jupyterlab", "user": {"login": "adaaaaaa", "id": 23206387, "node_id": "MDQ6VXNlcjIzMjA2Mzg3", "avatar_url": "https://avatars.githubusercontent.com/u/23206387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adaaaaaa", "html_url": "https://github.com/adaaaaaa", "followers_url": "https://api.github.com/users/adaaaaaa/followers", "following_url": "https://api.github.com/users/adaaaaaa/following{/other_user}", "gists_url": "https://api.github.com/users/adaaaaaa/gists{/gist_id}", "starred_url": "https://api.github.com/users/adaaaaaa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adaaaaaa/subscriptions", "organizations_url": "https://api.github.com/users/adaaaaaa/orgs", "repos_url": "https://api.github.com/users/adaaaaaa/repos", "events_url": "https://api.github.com/users/adaaaaaa/events{/privacy}", "received_events_url": "https://api.github.com/users/adaaaaaa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-05-18T08:55:37Z", "updated_at": "2022-07-03T14:53:25Z", "closed_at": "2022-07-03T14:53:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "python:3.10.4\r\njupyterlab:3.4.0 and 3.4.2\r\nipykernel:6.13.0\r\n\r\nno error reported and the ipykernel keep busy...", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2098/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2098/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2097", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2097/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2097/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2097/events", "html_url": "https://github.com/locustio/locust/issues/2097", "id": 1235388007, "node_id": "I_kwDOABUGS85JooZn", "number": 2097, "title": "Charts are not available in the HTML report when running in headless mode", "user": {"login": "sprudel79", "id": 10754010, "node_id": "MDQ6VXNlcjEwNzU0MDEw", "avatar_url": "https://avatars.githubusercontent.com/u/10754010?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sprudel79", "html_url": "https://github.com/sprudel79", "followers_url": "https://api.github.com/users/sprudel79/followers", "following_url": "https://api.github.com/users/sprudel79/following{/other_user}", "gists_url": "https://api.github.com/users/sprudel79/gists{/gist_id}", "starred_url": "https://api.github.com/users/sprudel79/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sprudel79/subscriptions", "organizations_url": "https://api.github.com/users/sprudel79/orgs", "repos_url": "https://api.github.com/users/sprudel79/repos", "events_url": "https://api.github.com/users/sprudel79/events{/privacy}", "received_events_url": "https://api.github.com/users/sprudel79/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2022-05-13T15:23:47Z", "updated_at": "2023-04-20T14:47:51Z", "closed_at": "2022-08-24T02:17:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi everyone, \r\n\r\nthanks for all the efforts in this amazing tool. I am trying to run a headless load test with locust (2.8.6) that should produce a HTML report showing exactly the same stuff as with the UI execution. The command looks like this:\r\n\r\n``` bash\r\nlocust -f mytest.py --headless --users 5 --spawn-rate 1 -i 100 -t 1 --html report.html --print-stats -L INFO --logfile report.log\r\n```\r\n\r\n(Please note that I am using the locust plugin to stop after 100 requests) The test is running fine and the HTML will also be created. However the report only contains the two tables Request Statistics + Response Time Statistics\r\nBut below \"Final ratio\" there's nothing displayed. I've tried multiple browsers but the result is the same. I can also see in the console an error \r\n\"Uncaught TypeError: Cannot read properties of undefined (reading 'getAttribute')\"\r\n\r\nIs this a locust bug (it could be eventually the older JQuery version in the HTML file) ? \r\nOr is there anything wrong with my command? \r\n\r\nThanks in advance!\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2097/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2097/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2095", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2095/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2095/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2095/events", "html_url": "https://github.com/locustio/locust/issues/2095", "id": 1228968517, "node_id": "I_kwDOABUGS85JQJJF", "number": 2095, "title": "Wrong message on rebalance", "user": {"login": "EzR1d3r", "id": 36864517, "node_id": "MDQ6VXNlcjM2ODY0NTE3", "avatar_url": "https://avatars.githubusercontent.com/u/36864517?v=4", "gravatar_id": "", "url": "https://api.github.com/users/EzR1d3r", "html_url": "https://github.com/EzR1d3r", "followers_url": "https://api.github.com/users/EzR1d3r/followers", "following_url": "https://api.github.com/users/EzR1d3r/following{/other_user}", "gists_url": "https://api.github.com/users/EzR1d3r/gists{/gist_id}", "starred_url": "https://api.github.com/users/EzR1d3r/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/EzR1d3r/subscriptions", "organizations_url": "https://api.github.com/users/EzR1d3r/orgs", "repos_url": "https://api.github.com/users/EzR1d3r/repos", "events_url": "https://api.github.com/users/EzR1d3r/events{/privacy}", "received_events_url": "https://api.github.com/users/EzR1d3r/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-05-08T19:30:07Z", "updated_at": "2023-02-06T06:14:00Z", "closed_at": "2022-07-19T02:17:42Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nIn distributed mode with several workers If a worker is crushed, we got message \"Spawning is complete and report waittime is expired, but not all reports received from workers\". It is not clear was the users spawned by remained workers or not.\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nNormal message \"All users spawned'.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) -->\r\n\r\n1. Start master runner with 2 expected workers in config.\r\n2. Start 2 workers.\r\n3. Wait until all user are spawned.\r\n4. Kill one worker.\r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version: **3.8 / 3.9**\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds) **2.8.6**\r\n- Locust command line that you ran:\r\n```\r\nlocust --config=master.conf\r\nlocust --worker\r\n```\r\n- Locust file contents (anonymized if necessary):\r\n\r\n```\r\nclass User1(HttpUser):\r\n    wait_time = constant(0.1)\r\n    @task\r\n    def hello_world(self):\r\n        self.client.get(\"/\")\r\n\r\n\r\nclass User2(HttpUser):\r\n    wait_time = constant(0.1)\r\n    @task\r\n    def hello_world(self):\r\n        self.client.get(\"/\")\r\n```\r\n\r\nmaster.conf\r\n```\r\nmaster = true\r\nhost = http://127.0.0.1:8000/\r\nexpect-workers = 2\r\nheadless = true\r\nusers = 20\r\nspawn-rate = 20\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2095/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2095/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2094", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2094/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2094/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2094/events", "html_url": "https://github.com/locustio/locust/issues/2094", "id": 1228927463, "node_id": "I_kwDOABUGS85JP_Hn", "number": 2094, "title": "How to do different types of performance test in locust", "user": {"login": "clarajose27", "id": 79144089, "node_id": "MDQ6VXNlcjc5MTQ0MDg5", "avatar_url": "https://avatars.githubusercontent.com/u/79144089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/clarajose27", "html_url": "https://github.com/clarajose27", "followers_url": "https://api.github.com/users/clarajose27/followers", "following_url": "https://api.github.com/users/clarajose27/following{/other_user}", "gists_url": "https://api.github.com/users/clarajose27/gists{/gist_id}", "starred_url": "https://api.github.com/users/clarajose27/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/clarajose27/subscriptions", "organizations_url": "https://api.github.com/users/clarajose27/orgs", "repos_url": "https://api.github.com/users/clarajose27/repos", "events_url": "https://api.github.com/users/clarajose27/events{/privacy}", "received_events_url": "https://api.github.com/users/clarajose27/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-05-08T16:16:55Z", "updated_at": "2022-05-08T19:35:27Z", "closed_at": "2022-05-08T19:34:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version:\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds)\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2094/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2094/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2091", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2091/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2091/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2091/events", "html_url": "https://github.com/locustio/locust/issues/2091", "id": 1226973051, "node_id": "I_kwDOABUGS85JIh97", "number": 2091, "title": "Users with `fixed_count` not being relocated after rebalance", "user": {"login": "andydunstall", "id": 29143656, "node_id": "MDQ6VXNlcjI5MTQzNjU2", "avatar_url": "https://avatars.githubusercontent.com/u/29143656?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andydunstall", "html_url": "https://github.com/andydunstall", "followers_url": "https://api.github.com/users/andydunstall/followers", "following_url": "https://api.github.com/users/andydunstall/following{/other_user}", "gists_url": "https://api.github.com/users/andydunstall/gists{/gist_id}", "starred_url": "https://api.github.com/users/andydunstall/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andydunstall/subscriptions", "organizations_url": "https://api.github.com/users/andydunstall/orgs", "repos_url": "https://api.github.com/users/andydunstall/repos", "events_url": "https://api.github.com/users/andydunstall/events{/privacy}", "received_events_url": "https://api.github.com/users/andydunstall/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2022-05-05T17:25:46Z", "updated_at": "2022-05-09T06:13:27Z", "closed_at": "2022-05-09T06:13:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nRunning Locust with multiple workers, where `UserA` has `fixed_count = 1` and `UserB` has no weight attributes.\r\n\r\nAs expected when starting 4 workers and 8 users, 1 `UserA` is started with 7 `UserB`s. Though when the worker `UserA` is running on is terminated, Locust rebalances such that theres now 8 `UserB`s and no `UserA`s. The same issue seems sometimes occur when just scaling up the number of workers, triggering a rebalance.\r\n\r\nAdding some logs to the code, looks like `self._try_dispatch_fixed` is `False` on the rebalance ([dispatch.py#L387](https://github.com/locustio/locust/blob/master/locust/dispatch.py#L387)) - which is only set to `True` when it first runs or when the number of users is reduced.\r\n\r\nI'm happy have a go at fixing this - though adding issue for visibility.\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n```python\r\n# locustfile.py\r\nclass UserA:\r\n  fixed_count = 1\r\n  # ...\r\n\r\nclass UserB:\r\n  # ...\r\n```\r\n\r\n1. Add 4 workers\r\n2. Add 1 user: This adds a single `UserA` as expected\r\n4. Add 7 more users: This adds 7 `UserB`s as expected\r\n5. Terminate the worker running the single `UserA`\r\n6. After the rebalance now have 8 `UserB`s and no `UserA`s\r\n7. Adding 2 more users (taking total to 10) still has no `UserA`s\r\n\r\n```\r\nAll users spawned: {\"UserA\": 1, \"UserB\": 0} (1 total users)\r\nAll users spawned: {\"UserA\": 1, \"UserB\": 7} (8 total users)\r\nAll users spawned: {\"UserA\": 0, \"UserB\": 10} (10 total users)\r\n```\r\n\r\n### Environment\r\n\r\n- OS: `python:3.9` container\r\n- Locust version: running `master`\r\n- Locust command line that you ran: `/usr/local/bin/python /usr/local/bin/locust --master --locustfile .../locustfile.py`\r\n- Locust file contents (anonymized if necessary)\r\n```python\r\nclass UserA:\r\n  fixed_count = 1\r\n  # ...\r\n\r\nclass UserB:\r\n  # ...\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2091/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2091/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2087", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2087/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2087/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2087/events", "html_url": "https://github.com/locustio/locust/issues/2087", "id": 1223378562, "node_id": "I_kwDOABUGS85I60aC", "number": 2087, "title": "jinja2.exceptions.TemplateAssertionError: no test named 'boolean' when attempting to visit UI", "user": {"login": "SethTales", "id": 34636186, "node_id": "MDQ6VXNlcjM0NjM2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/34636186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SethTales", "html_url": "https://github.com/SethTales", "followers_url": "https://api.github.com/users/SethTales/followers", "following_url": "https://api.github.com/users/SethTales/following{/other_user}", "gists_url": "https://api.github.com/users/SethTales/gists{/gist_id}", "starred_url": "https://api.github.com/users/SethTales/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SethTales/subscriptions", "organizations_url": "https://api.github.com/users/SethTales/orgs", "repos_url": "https://api.github.com/users/SethTales/repos", "events_url": "https://api.github.com/users/SethTales/events{/privacy}", "received_events_url": "https://api.github.com/users/SethTales/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-05-02T21:23:51Z", "updated_at": "2022-05-06T07:22:12Z", "closed_at": "2022-05-06T07:22:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nAfter running the `locust` command, I see:\r\n\r\n```\r\n[2022-05-02 14:19:44,219] CCI-PF310CHF/INFO/locust.main: Starting web interface at http://0.0.0.0:8089 (accepting connections from all network interfaces)\r\n[2022-05-02 14:19:44,227] CCI-PF310CHF/INFO/locust.main: Starting Locust 2.8.6\r\n```\r\n\r\nthen, when I got to visit the UI at `http://localhost:8089`, it generates the following stacktrace:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/sethtales/.local/lib/python3.8/site-packages/gevent/pywsgi.py\", line 999, in handle_one_response\r\n    self.run_application()\r\n  File \"/home/sethtales/.local/lib/python3.8/site-packages/gevent/pywsgi.py\", line 945, in run_application\r\n    self.result = self.application(self.environ, self.start_response)\r\n  File \"/home/sethtales/.local/lib/python3.8/site-packages/flask/app.py\", line 2095, in __call__\r\n    return self.wsgi_app(environ, start_response)\r\n  File \"/home/sethtales/.local/lib/python3.8/site-packages/flask/app.py\", line 2080, in wsgi_app\r\n    response = self.handle_exception(e)\r\n  File \"/home/sethtales/.local/lib/python3.8/site-packages/flask_cors/extension.py\", line 165, in wrapped_function\r\n    return cors_after_request(app.make_response(f(*args, **kwargs)))\r\n  File \"/home/sethtales/.local/lib/python3.8/site-packages/flask/app.py\", line 2077, in wsgi_app\r\n    response = self.full_dispatch_request()\r\n  File \"/home/sethtales/.local/lib/python3.8/site-packages/flask/app.py\", line 1525, in full_dispatch_request\r\n    rv = self.handle_user_exception(e)\r\n  File \"/home/sethtales/.local/lib/python3.8/site-packages/flask_cors/extension.py\", line 165, in wrapped_function\r\n    return cors_after_request(app.make_response(f(*args, **kwargs)))\r\n  File \"/home/sethtales/.local/lib/python3.8/site-packages/flask/app.py\", line 1523, in full_dispatch_request\r\n    rv = self.dispatch_request()\r\n  File \"/home/sethtales/.local/lib/python3.8/site-packages/flask/app.py\", line 1509, in dispatch_request\r\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)\r\n  File \"/home/sethtales/.local/lib/python3.8/site-packages/locust/web.py\", line 399, in wrapper\r\n    return view_func(*args, **kwargs)\r\n  File \"/home/sethtales/.local/lib/python3.8/site-packages/locust/web.py\", line 135, in index\r\n    return render_template(\"index.html\", **self.template_args)\r\n  File \"/home/sethtales/.local/lib/python3.8/site-packages/flask/templating.py\", line 149, in render_template\r\n    ctx.app.jinja_env.get_or_select_template(template_name_or_list),\r\n  File \"/usr/lib/python3/dist-packages/jinja2/environment.py\", line 869, in get_or_select_template\r\n    return self.get_template(template_name_or_list, parent, globals)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/environment.py\", line 830, in get_template\r\n    return self._load_template(name, self.make_globals(globals))\r\n  File \"/usr/lib/python3/dist-packages/jinja2/environment.py\", line 804, in _load_template\r\n    template = self.loader.load(self, name, globals)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/loaders.py\", line 125, in load\r\n    code = environment.compile(source, name, filename)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/environment.py\", line 591, in compile\r\n    self.handle_exception(exc_info, source_hint=source_hint)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/environment.py\", line 780, in handle_exception\r\n    reraise(exc_type, exc_value, tb)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/_compat.py\", line 37, in reraise\r\n    raise value.with_traceback(tb)\r\n  File \"/home/sethtales/.local/lib/python3.8/site-packages/locust/templates/index.html\", line 85, in <module>\r\n    {% if not ((value is none) or (value is boolean)) %}\r\n  File \"/usr/lib/python3/dist-packages/jinja2/environment.py\", line 542, in _generate\r\n    return generate(source, self, name, filename, defer_init=defer_init,\r\n  File \"/usr/lib/python3/dist-packages/jinja2/compiler.py\", line 82, in generate\r\n    generator.visit(node)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/visitor.py\", line 38, in visit\r\n    return f(node, *args, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/compiler.py\", line 754, in visit_Template\r\n    self.blockvisit(node.body, frame)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/compiler.py\", line 378, in blockvisit\r\n    self.visit(node, frame)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/visitor.py\", line 38, in visit\r\n    return f(node, *args, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/compiler.py\", line 1122, in visit_For\r\n    self.blockvisit(node.body, loop_frame)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/compiler.py\", line 378, in blockvisit\r\n    self.visit(node, frame)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/visitor.py\", line 38, in visit\r\n    return f(node, *args, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/compiler.py\", line 1157, in visit_If\r\n    self.visit(node.test, if_frame)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/visitor.py\", line 38, in visit\r\n    return f(node, *args, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/compiler.py\", line 70, in new_func\r\n    return f(self, node, frame, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/compiler.py\", line 1497, in visitor\r\n    self.visit(node.node, frame)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/visitor.py\", line 38, in visit\r\n    return f(node, *args, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/compiler.py\", line 70, in new_func\r\n    return f(self, node, frame, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/compiler.py\", line 1484, in visitor\r\n    self.visit(node.right, frame)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/visitor.py\", line 38, in visit\r\n    return f(node, *args, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/compiler.py\", line 70, in new_func\r\n    return f(self, node, frame, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/compiler.py\", line 1607, in visit_Test\r\n    self.fail('no test named %r' % node.name, node.lineno)\r\n  File \"/usr/lib/python3/dist-packages/jinja2/compiler.py\", line 315, in fail\r\n    raise TemplateAssertionError(msg, lineno, self.name, self.filename)\r\njinja2.exceptions.TemplateAssertionError: no test named 'boolean'\r\n2022-05-02T21:19:47Z {'REMOTE_ADDR': '::1', 'REMOTE_PORT': '54720', 'HTTP_HOST': 'localhost:8089', (hidden keys: 33)} failed with TemplateAssertionError\r\n```\r\n\r\n### Expected behavior\r\nI should be able to visit the UI\r\n\r\n### Actual behavior\r\nDescribed above\r\n\r\n### Steps to reproduce\r\nInstall locust, attempt to run and it does not work\r\n\r\n### Environment\r\n\r\n- OS: Windows 10, using WSL\r\n- Python version: 3.8.10\r\n- Locust version: 2.8.6\r\n- Locust command line that you ran: `locust`\r\n- Locust file contents (anonymized if necessary): \r\n```\r\nimport time\r\nfrom locust import HttpUser, task, between\r\nimport csv\r\n\r\nclass Last30DaysJobAggUser(HttpUser):\r\n    wait_time = between(0,1)\r\n    request_params = []\r\n\r\n    @task\r\n    def get_job_aggregated_items_all_branches(self):\r\n        for params in self.request_params:\r\n            self.client.get(f'http://127.0.0.1:8085/resource-usage/{params[\"org_id\"]}/{params[\"project_id\"]}/workflows/{params[\"wf_name\"]}/jobs&reporting-window=last-30-days')\r\n\r\n    def on_start(self):\r\n        with open('../last_30_days_most_jobs.csv') as input:\r\n            reader = csv.reader(input, delimiter=',')\r\n            next(reader, None) # skip headers\r\n            for row in reader:\r\n                request_params = {}\r\n                request_params[\"org_id\"] = row[0]\r\n                request_params[\"project_id\"] = row[1]\r\n                request_params[\"wf_name\"] = row[2]\r\n                self.request_params.append(request_params)\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2087/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2087/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2086", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2086/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2086/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2086/events", "html_url": "https://github.com/locustio/locust/issues/2086", "id": 1223208593, "node_id": "I_kwDOABUGS85I6K6R", "number": 2086, "title": "Rewrite main.py", "user": {"login": "max-rocket-internet", "id": 8859277, "node_id": "MDQ6VXNlcjg4NTkyNzc=", "avatar_url": "https://avatars.githubusercontent.com/u/8859277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/max-rocket-internet", "html_url": "https://github.com/max-rocket-internet", "followers_url": "https://api.github.com/users/max-rocket-internet/followers", "following_url": "https://api.github.com/users/max-rocket-internet/following{/other_user}", "gists_url": "https://api.github.com/users/max-rocket-internet/gists{/gist_id}", "starred_url": "https://api.github.com/users/max-rocket-internet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/max-rocket-internet/subscriptions", "organizations_url": "https://api.github.com/users/max-rocket-internet/orgs", "repos_url": "https://api.github.com/users/max-rocket-internet/repos", "events_url": "https://api.github.com/users/max-rocket-internet/events{/privacy}", "received_events_url": "https://api.github.com/users/max-rocket-internet/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-05-02T18:32:37Z", "updated_at": "2022-08-31T02:18:08Z", "closed_at": "2022-08-31T02:18:08Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "If you're not super familiar with the project then [main.py](https://github.com/locustio/locust/blob/master/locust/main.py) is very hard to read \ud83d\ude42\r\n\r\nThere's so many conditions, places where the flow stops (or does not stop depending on more conditions), function definitions and logic is all mixed together.\r\n\r\nI think it could be improved somewhat? \r\n\r\n(I'm not volunteering \ud83d\ude05)", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2086/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2086/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2078", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2078/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2078/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2078/events", "html_url": "https://github.com/locustio/locust/issues/2078", "id": 1211164535, "node_id": "I_kwDOABUGS85IMOd3", "number": 2078, "title": "Wrong exception value when failure appears in on_stop method", "user": {"login": "marcinh", "id": 6491818, "node_id": "MDQ6VXNlcjY0OTE4MTg=", "avatar_url": "https://avatars.githubusercontent.com/u/6491818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marcinh", "html_url": "https://github.com/marcinh", "followers_url": "https://api.github.com/users/marcinh/followers", "following_url": "https://api.github.com/users/marcinh/following{/other_user}", "gists_url": "https://api.github.com/users/marcinh/gists{/gist_id}", "starred_url": "https://api.github.com/users/marcinh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marcinh/subscriptions", "organizations_url": "https://api.github.com/users/marcinh/orgs", "repos_url": "https://api.github.com/users/marcinh/repos", "events_url": "https://api.github.com/users/marcinh/events{/privacy}", "received_events_url": "https://api.github.com/users/marcinh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-04-21T14:58:32Z", "updated_at": "2022-07-01T02:19:08Z", "closed_at": "2022-07-01T02:19:08Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nWhen on_stop method contains any HTTP request (POST,GET,etc.) and this request fails with any connection related error - not HTTPError, eg. ConnectionError, this error is not visible in GUI, but the InterruptTaskSet error which cause on_stop to be called.\r\n![image](https://user-images.githubusercontent.com/6491818/164485752-a9e57c32-9ef5-4e83-b0d5-a4a6fa26a565.png)\r\n\r\n\r\n### Expected behavior\r\nHTTP request should be failed with proper exception, eg ConnectionError\r\n![image](https://user-images.githubusercontent.com/6491818/164485976-de405972-e951-44cc-92ed-51b8b7f66ac3.png)\r\n\r\n\r\n### Actual behavior\r\nHTTP request is failed with InterruptTaskSet exception:\r\n![image](https://user-images.githubusercontent.com/6491818/164486071-c1b31d24-662e-4577-a28d-b6e5c5aa331b.png)\r\n\r\n### Steps to reproduce\r\nExecute following python file that contains TestAdapter simulating raising ConnectionError\r\n\r\ntest.py:\r\n```\r\nfrom locust import task, HttpUser, constant_pacing, SequentialTaskSet\r\nfrom requests import ConnectionError\r\nfrom requests.adapters import HTTPAdapter\r\n\r\n\r\nclass TestAdapter(HTTPAdapter):\r\n    def send(self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None):\r\n        # Simulate raising ConnectionError\r\n        raise ConnectionError(request.url)\r\n\r\n\r\nclass OnStopSteps(SequentialTaskSet):\r\n    @task\r\n    def another_user(self):\r\n        self.interrupt(reschedule=False)\r\n\r\n    def on_stop(self):\r\n        self.client.post('logout', name='logout')\r\n\r\n    def on_stop_working(self):\r\n        # when we replace on_stop with this content it works as designed\r\n        with self.client.post('logout', name='logout', catch_response=True):\r\n            pass\r\n\r\n\r\nclass TestUser(HttpUser):\r\n    host = 'https://mocked-api.com'\r\n    tasks = [OnStopSteps]\r\n    wait_time = constant_pacing(10)\r\n\r\n    def __init__(self, *args, **kwargs):\r\n        super().__init__(*args, **kwargs)\r\n        self.client.mount('https', TestAdapter())\r\n\r\n```\r\n### Environment\r\n\r\n- OS: Windows, Centos\r\n- Python version: 3.9\r\n- Locust version: 2.8.4\r\n- Locust command line that you ran: locust -f test.py\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2078/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2078/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2076", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2076/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2076/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2076/events", "html_url": "https://github.com/locustio/locust/issues/2076", "id": 1209227920, "node_id": "I_kwDOABUGS85IE1qQ", "number": 2076, "title": "Add test support for Arm64 ", "user": {"login": "odidev", "id": 40816837, "node_id": "MDQ6VXNlcjQwODE2ODM3", "avatar_url": "https://avatars.githubusercontent.com/u/40816837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/odidev", "html_url": "https://github.com/odidev", "followers_url": "https://api.github.com/users/odidev/followers", "following_url": "https://api.github.com/users/odidev/following{/other_user}", "gists_url": "https://api.github.com/users/odidev/gists{/gist_id}", "starred_url": "https://api.github.com/users/odidev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/odidev/subscriptions", "organizations_url": "https://api.github.com/users/odidev/orgs", "repos_url": "https://api.github.com/users/odidev/repos", "events_url": "https://api.github.com/users/odidev/events{/privacy}", "received_events_url": "https://api.github.com/users/odidev/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-04-20T06:37:03Z", "updated_at": "2022-07-07T08:57:30Z", "closed_at": "2022-07-07T08:57:30Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "\r\nHi Team, \r\n\r\nI tried testing locust package on **Arm64** architectures but it is generating `2 errors with 5 failed, 1 skipped` from total of **445 test cases** for the **tox** test command with the assertion errors locally: \r\n\r\n``` \r\n\r\n====================================================================== \r\n\r\nFAIL: test_webserver (locust.test.test_main.StandaloneIntegrationTests) \r\n\r\n---------------------------------------------------------------------- \r\n\r\nTraceback (most recent call last): \r\n\r\n  File \"/locust/locust/test/test_main.py\", line 310, in test_webserver \r\n\r\n    self.assertIn(\"Starting web interface at\", stderr) \r\n\r\nAssertionError: 'Starting web interface at' not found in ''  \r\n\r\n---------------------------------------------------------------------- \r\n\r\n``` \r\n\r\nWhile on **amd64**, I am getting `Ran 445 tests OK (skipped=1)`.  \r\n\r\nAlso we have raised a PR for docker images where we got a suggestion to change the **version of flask** refer [comment](https://github.com/locustio/locust/pull/1889#issuecomment-936337793) in order to **test**. \r\n\r\n**PR link:** https://github.com/locustio/locust/pull/1889 \r\n\r\nAbout a month ago when I tried with GHA it was `Ran 440 tests FAILED (failures=15, errors=9, skipped=1)` for arm64 with different assertion errors, currently **the tox command fails** for arm64.  \r\n\r\nAs per the above [comment](https://github.com/locustio/locust/pull/1889#issuecomment-936337793) suggestion there is still no proper support for the arm on GH so we can't just add it to the matrix build, so I also tried with TravisCI where again the tox command fails for arm64.\r\n\r\n[Cyberw](https://github.com/cyberw) Could you please share your feedback regarding this and suggest what can be done to test it over ARM64 server? \r\n\r\nThanks in advance.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2076/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2076/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2075", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2075/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2075/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2075/events", "html_url": "https://github.com/locustio/locust/issues/2075", "id": 1208490698, "node_id": "I_kwDOABUGS85ICBrK", "number": 2075, "title": "Output is not saved to CSV when using LoadTestShape", "user": {"login": "eldaduzman", "id": 55621402, "node_id": "MDQ6VXNlcjU1NjIxNDAy", "avatar_url": "https://avatars.githubusercontent.com/u/55621402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eldaduzman", "html_url": "https://github.com/eldaduzman", "followers_url": "https://api.github.com/users/eldaduzman/followers", "following_url": "https://api.github.com/users/eldaduzman/following{/other_user}", "gists_url": "https://api.github.com/users/eldaduzman/gists{/gist_id}", "starred_url": "https://api.github.com/users/eldaduzman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eldaduzman/subscriptions", "organizations_url": "https://api.github.com/users/eldaduzman/orgs", "repos_url": "https://api.github.com/users/eldaduzman/repos", "events_url": "https://api.github.com/users/eldaduzman/events{/privacy}", "received_events_url": "https://api.github.com/users/eldaduzman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-04-19T14:59:32Z", "updated_at": "2022-05-02T18:53:26Z", "closed_at": "2022-05-02T18:53:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nWhen I use `LoadTestShape` the output is not fully saved to the csv file.\r\n\r\nRunning the following script:\r\n\r\n\r\nThen open the file 1_stats_history.csv\r\n\r\n### Expected behavior\r\nAggregated results per second\r\n\r\n### Actual behavior\r\nOnly one second is listed\r\n```\r\nTimestamp,User Count,Type,Name,Requests/s,Failures/s,50%,66%,75%,80%,90%,95%,98%,99%,99.9%,99.99%,100%,Total Request Count,Total Failure Count,Total Median Response Time,Total Average Response Time,Total Min Response Time,Total Max Response Time,Total Average Content Size\r\n\r\n1650379714,0,,Aggregated,137.100000,0.000000,320,480,560,620,1100,1600,2500,3100,4000,4100,4100,4894,0,320.0,520.2181464853838,185.3720999788493,4064.4731000065804,16707.96240294238\r\n\r\n```\r\n\r\n### Environment\r\n\r\n- OS:  Windows\r\n- Python version: 3.10.2\r\n- Locust version:2.8.6\r\n- Locust command line that you ran: locust -f locust\\locustfile.py  --headless --csv=1\r\n- Locust file contents (anonymized if necessary):\r\n```\r\n\"\"\"locust file\"\"\"\r\nimport math\r\nfrom typing import Generator\r\n\r\nfrom locust import HttpUser, task, constant, LoadTestShape\r\n\r\n\r\nclass WebsiteUser(HttpUser):\r\n    \"\"\"users container\"\"\"\r\n\r\n    wait_time = constant(1)\r\n    host = \"https://google.com\"\r\n    data: Generator\r\n\r\n    @task(1)\r\n    def simple_get(self):\r\n        \"\"\"performs get\"\"\"\r\n        self.client.get(\"\")\r\n\r\n\r\nclass StepLoadShape(LoadTestShape):\r\n    \"\"\"\r\n    A step load shape\r\n\r\n\r\n    Keyword arguments:\r\n\r\n        step_time -- Time between steps\r\n        step_load -- User increase amount at each step\r\n        spawn_rate -- Users to stop/start per second at every step\r\n        time_limit -- Time limit in seconds\r\n\r\n    \"\"\"\r\n\r\n    step_time = 10\r\n    step_load = 50\r\n    spawn_rate = 50\r\n    time_limit = 50\r\n\r\n    def tick(self):\r\n        run_time = self.get_run_time()\r\n\r\n        if run_time > self.time_limit:\r\n            return None\r\n\r\n        current_step = math.floor(run_time / self.step_time) + 1\r\n        return (current_step * self.step_load, self.spawn_rate)\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2075/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2075/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2074", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2074/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2074/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2074/events", "html_url": "https://github.com/locustio/locust/issues/2074", "id": 1206163556, "node_id": "I_kwDOABUGS85H5Jhk", "number": 2074, "title": "main documentation page redirects to insecure URL", "user": {"login": "rmcloughlin", "id": 4472381, "node_id": "MDQ6VXNlcjQ0NzIzODE=", "avatar_url": "https://avatars.githubusercontent.com/u/4472381?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmcloughlin", "html_url": "https://github.com/rmcloughlin", "followers_url": "https://api.github.com/users/rmcloughlin/followers", "following_url": "https://api.github.com/users/rmcloughlin/following{/other_user}", "gists_url": "https://api.github.com/users/rmcloughlin/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmcloughlin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmcloughlin/subscriptions", "organizations_url": "https://api.github.com/users/rmcloughlin/orgs", "repos_url": "https://api.github.com/users/rmcloughlin/repos", "events_url": "https://api.github.com/users/rmcloughlin/events{/privacy}", "received_events_url": "https://api.github.com/users/rmcloughlin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901882, "node_id": "MDU6TGFiZWwxNjM1OTAxODgy", "url": "https://api.github.com/repos/locustio/locust/labels/wontfix", "name": "wontfix", "color": "ddcccc", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-04-16T16:48:53Z", "updated_at": "2022-04-16T21:35:09Z", "closed_at": "2022-04-16T20:27:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "On the https://locust.io/ page, \"Documentation\" is a link to\r\n\r\nhttps://docs.locust.io/ (secure)\r\n\r\nwhich redirects to\r\n\r\nhttp://docs.locust.io/en/stable/ (insecure)\r\n\r\nInstead it should redirect to https://docs.locust.io/en/stable/ (secure)", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2074/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2074/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2071", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2071/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2071/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2071/events", "html_url": "https://github.com/locustio/locust/issues/2071", "id": 1201890413, "node_id": "I_kwDOABUGS85Ho2Rt", "number": 2071, "title": "Endpoint /tasks returns 404 when serving locust under non-root path", "user": {"login": "benispeti", "id": 10531758, "node_id": "MDQ6VXNlcjEwNTMxNzU4", "avatar_url": "https://avatars.githubusercontent.com/u/10531758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/benispeti", "html_url": "https://github.com/benispeti", "followers_url": "https://api.github.com/users/benispeti/followers", "following_url": "https://api.github.com/users/benispeti/following{/other_user}", "gists_url": "https://api.github.com/users/benispeti/gists{/gist_id}", "starred_url": "https://api.github.com/users/benispeti/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/benispeti/subscriptions", "organizations_url": "https://api.github.com/users/benispeti/orgs", "repos_url": "https://api.github.com/users/benispeti/repos", "events_url": "https://api.github.com/users/benispeti/events{/privacy}", "received_events_url": "https://api.github.com/users/benispeti/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635903137, "node_id": "MDU6TGFiZWwxNjM1OTAzMTM3", "url": "https://api.github.com/repos/locustio/locust/labels/duplicate", "name": "duplicate", "color": "9cea8c", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-04-12T13:54:55Z", "updated_at": "2022-05-09T08:26:01Z", "closed_at": "2022-05-09T08:25:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nOur server hosts several applications, so I'm hosting locust service under the `<hostname>/locust` URL. Locust looks good at first, but the `/tasks` request are all failing at the background with a 404 response.\r\n\r\n### Expected behavior\r\nPage loads without error. Backend calls respects the base path.\r\n\r\n### Actual behavior\r\n`/tasks` requests are going to wrong path. Requests are sent to `<hostname>/tasks`, but they should go to `<hostname>/locust/tasks`. If I manually navigate to `<hostname>/locust/tasks`, then it works fine, but locust frontend sends the requests to wrong path.\r\n\r\n![image](https://user-images.githubusercontent.com/10531758/162979084-d1b3b2f2-3710-4cdd-8f9a-30e0f869bd30.png)\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: Docker\r\n- Python version:\r\n- Locust version: 2.8.5\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2071/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2071/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2069", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2069/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2069/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2069/events", "html_url": "https://github.com/locustio/locust/issues/2069", "id": 1197101135, "node_id": "I_kwDOABUGS85HWlBP", "number": 2069, "title": "Issue to install locust-plugins inside locust container when using the locust docker image version 2.8.6", "user": {"login": "teixeira-fernando", "id": 32043860, "node_id": "MDQ6VXNlcjMyMDQzODYw", "avatar_url": "https://avatars.githubusercontent.com/u/32043860?v=4", "gravatar_id": "", "url": "https://api.github.com/users/teixeira-fernando", "html_url": "https://github.com/teixeira-fernando", "followers_url": "https://api.github.com/users/teixeira-fernando/followers", "following_url": "https://api.github.com/users/teixeira-fernando/following{/other_user}", "gists_url": "https://api.github.com/users/teixeira-fernando/gists{/gist_id}", "starred_url": "https://api.github.com/users/teixeira-fernando/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/teixeira-fernando/subscriptions", "organizations_url": "https://api.github.com/users/teixeira-fernando/orgs", "repos_url": "https://api.github.com/users/teixeira-fernando/repos", "events_url": "https://api.github.com/users/teixeira-fernando/events{/privacy}", "received_events_url": "https://api.github.com/users/teixeira-fernando/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-04-08T09:50:16Z", "updated_at": "2022-04-08T13:25:43Z", "closed_at": "2022-04-08T12:03:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nWhen I started to use the latest 2.8.6 locust docker image, I had some issues when trying to install locust-plugins library inside the container, with my own Dockerfile. When I used the version 2.8.5, everything worked fine.\r\n\r\nThe error that is returned says that there is a permission issue in the installation process: \r\n```\r\n[2022-04-08T09:26:11.225Z] ERROR: Could not install packages due to an OSError: [Errno 13] Permission denied: '/opt/venv/lib/python3.9/site-packages/locust/__init__.py'\r\n```\r\n\r\n### Expected behavior\r\nWe should be able to install other python libraries, including locust-plugins, inside the locust container using the pip command. \r\n\r\n### Actual behavior\r\n```\r\n[2022-04-08T09:25:36.237Z] + docker-compose up --scale worker=4 --force-recreate --exit-code-from=master\r\n[2022-04-08T09:25:36.237Z] /usr/lib/python2.7/site-packages/requests/__init__.py:91: RequestsDependencyWarning: urllib3 (1.25.3) or chardet (2.2.1) doesn't match a supported version!\r\n[2022-04-08T09:25:36.237Z]   RequestsDependencyWarning)\r\n[2022-04-08T09:25:36.496Z] using --exit-code-from implies --abort-on-container-exit\r\n[2022-04-08T09:25:36.496Z] Building worker\r\n[2022-04-08T09:25:36.496Z] Step 1/4 : FROM locustio/locust\r\n[2022-04-08T09:25:36.496Z]  ---> 532edcc29d52\r\n[2022-04-08T09:25:36.496Z] Step 2/4 : RUN pip3 install python-dotenv\r\n[2022-04-08T09:25:36.496Z]  ---> Using cache\r\n[2022-04-08T09:25:36.496Z]  ---> a97320f218ff\r\n[2022-04-08T09:25:36.496Z] Step 3/4 : RUN pip3 install locust-plugins\r\n[2022-04-08T09:25:36.496Z]  ---> Running in 62882230dddc\r\n[2022-04-08T09:25:39.056Z] Collecting locust-plugins\r\n[2022-04-08T09:25:39.056Z]   Downloading locust_plugins-2.6.4-py3-none-any.whl (1.4 MB)\r\n[2022-04-08T09:25:39.056Z]      \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 1.4/1.4 MB 20.8 MB/s eta 0:00:00\r\n....\r\n[2022-04-08T09:26:03.903Z]   Running setup.py install for python-autoviv: started\r\n[2022-04-08T09:26:04.965Z]   Running setup.py install for python-autoviv: finished with status 'done'\r\n[2022-04-08T09:26:04.965Z]   Running setup.py install for paho-mqtt: started\r\n[2022-04-08T09:26:05.905Z]   Running setup.py install for paho-mqtt: finished with status 'done'\r\n[2022-04-08T09:26:11.225Z]   Attempting uninstall: locust\r\n[2022-04-08T09:26:11.225Z]     Found existing installation: locust 2.8.5\r\n[2022-04-08T09:26:11.225Z]     Uninstalling locust-2.8.5:\r\n[2022-04-08T09:26:11.225Z]       Successfully uninstalled locust-2.8.5\r\n[2022-04-08T09:26:11.225Z]   WARNING: No metadata found in /opt/venv/lib/python3.9/site-packages\r\n[2022-04-08T09:26:11.225Z]   Rolling back uninstall of locust\r\n[2022-04-08T09:26:11.225Z]   Moving to /opt/venv/bin/locust\r\n[2022-04-08T09:26:11.225Z]    from /tmp/pip-uninstall-28kaiecd/locust\r\n[2022-04-08T09:26:11.225Z]   Moving to /opt/venv/lib/python3.9/site-packages/locust-2.8.5.dist-info/\r\n[2022-04-08T09:26:11.225Z]    from /opt/venv/lib/python3.9/site-packages/~ocust-2.8.5.dist-info\r\n[2022-04-08T09:26:11.225Z]   Moving to /opt/venv/lib/python3.9/site-packages/locust/\r\n[2022-04-08T09:26:11.225Z]    from /opt/venv/lib/python3.9/site-packages/~ocust\r\n[2022-04-08T09:26:11.225Z] ERROR: Could not install packages due to an OSError: [Errno 13] Permission denied: '/opt/venv/lib/python3.9/site-packages/locust/__init__.py'\r\n[2022-04-08T09:26:11.225Z] Check the permissions.\r\n[2022-04-08T09:26:11.225Z] \r\n[2022-04-08T09:26:11.225Z] Service 'worker' failed to build: The command '/bin/sh -c pip3 install locust-plugins' returned a non-zero code: 1\r\n```\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\nThis is my Docker file that I used to reproduce the error:\r\n\r\n```\r\nFROM locustio/locust\r\nRUN pip3 install python-dotenv\r\nRUN pip3 install locust-plugins\r\n```\r\n\r\nIf you try to build it, it will take the latest version 2.8.6, and the error described above will happen.\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: Windows 10 Enterprise (OS build 19042.1466)\r\n- Python version: Not applicable\r\n- Locust version: 2.8.6", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2069/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2069/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2065", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2065/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2065/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2065/events", "html_url": "https://github.com/locustio/locust/issues/2065", "id": 1190113161, "node_id": "I_kwDOABUGS85G76-J", "number": 2065, "title": "ImportError: cannot import name 'events' from 'locust.clients'", "user": {"login": "vallamost", "id": 25071166, "node_id": "MDQ6VXNlcjI1MDcxMTY2", "avatar_url": "https://avatars.githubusercontent.com/u/25071166?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vallamost", "html_url": "https://github.com/vallamost", "followers_url": "https://api.github.com/users/vallamost/followers", "following_url": "https://api.github.com/users/vallamost/following{/other_user}", "gists_url": "https://api.github.com/users/vallamost/gists{/gist_id}", "starred_url": "https://api.github.com/users/vallamost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vallamost/subscriptions", "organizations_url": "https://api.github.com/users/vallamost/orgs", "repos_url": "https://api.github.com/users/vallamost/repos", "events_url": "https://api.github.com/users/vallamost/events{/privacy}", "received_events_url": "https://api.github.com/users/vallamost/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-04-01T17:59:49Z", "updated_at": "2022-04-08T07:45:11Z", "closed_at": "2022-04-08T07:45:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\nWhen I installed locust in my Python 3.10 virtual environment using `pip3 install locust`, I get an import error when trying to use the locust CLI. Locust installs at version 2.8.5, I can't seem to get it to upgrade any further.\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\nNo import error should exist, the `locust` command should return back helpful output.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n```\r\n\u2570\u2500ian@macbook$ locust            \r\nTraceback (most recent call last):\r\n  File \"/Users/gxdt/.pyenv/versions/3.10.0/bin/locust\", line 8, in <module>\r\n    sys.exit(main())\r\n  File \"/Users/gxdt/.pyenv/versions/3.10.0/lib/python3.10/site-packages/locust/main.py\", line 125, in main\r\n    docstring, user_classes, shape_class = load_locustfile(locustfile)\r\n  File \"/Users/gxdt/.pyenv/versions/3.10.0/lib/python3.10/site-packages/locust/main.py\", line 82, in load_locustfile\r\n    imported = source.load_module()\r\n  File \"<frozen importlib._bootstrap_external>\", line 548, in _check_name_wrapper\r\n  File \"<frozen importlib._bootstrap_external>\", line 1063, in load_module\r\n  File \"<frozen importlib._bootstrap_external>\", line 888, in load_module\r\n  File \"<frozen importlib._bootstrap>\", line 290, in _load_module_shim\r\n  File \"<frozen importlib._bootstrap>\", line 719, in _load\r\n  File \"<frozen importlib._bootstrap>\", line 688, in _load_unlocked\r\n  File \"<frozen importlib._bootstrap_external>\", line 883, in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 241, in _call_with_frames_removed\r\n  File \"/Users/gxdt/Desktop/Repos/vault-load-testing/locustfile.py\", line 1, in <module>\r\n    from locusts.key_value import KeyValueLocust\r\n  File \"/Users/gxdt/Desktop/Repos/vault-load-testing/locusts/__init__.py\", line 2, in <module>\r\n    from locust.clients import ResponseContextManager, HttpSession, RequestException, events, CatchResponseError\r\nImportError: cannot import name 'events' from 'locust.clients' (/Users/gxdt/.pyenv/versions/3.10.0/lib/python3.10/site-packages/locust/clients.py)\r\n```\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n`$ pip3 install locust`\r\n`$ locust`\r\n\r\n### Environment\r\n\r\n- OS: OSX Monterey 12.2.1\r\n- Python version: 3.10\r\n- Locust version: 2.8.5\r\n- Locust command line that you ran: `locust`\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2065/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2065/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2063", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2063/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2063/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2063/events", "html_url": "https://github.com/locustio/locust/issues/2063", "id": 1187825516, "node_id": "I_kwDOABUGS85GzMds", "number": 2063, "title": "ERROR/locust.runners: An old (pre 2.0) worker tried to connect (xxxx). That's not going to work.", "user": {"login": "shiyong1989", "id": 42859196, "node_id": "MDQ6VXNlcjQyODU5MTk2", "avatar_url": "https://avatars.githubusercontent.com/u/42859196?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shiyong1989", "html_url": "https://github.com/shiyong1989", "followers_url": "https://api.github.com/users/shiyong1989/followers", "following_url": "https://api.github.com/users/shiyong1989/following{/other_user}", "gists_url": "https://api.github.com/users/shiyong1989/gists{/gist_id}", "starred_url": "https://api.github.com/users/shiyong1989/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shiyong1989/subscriptions", "organizations_url": "https://api.github.com/users/shiyong1989/orgs", "repos_url": "https://api.github.com/users/shiyong1989/repos", "events_url": "https://api.github.com/users/shiyong1989/events{/privacy}", "received_events_url": "https://api.github.com/users/shiyong1989/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-03-31T09:56:02Z", "updated_at": "2022-03-31T11:58:59Z", "closed_at": "2022-03-31T11:58:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "When I use boomer as a worker to connect to locust-master, the locust show this log:\r\nERROR/locust.runners: An old (pre 2.0) worker tried to connect (xxx). That's not going to work.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2063/reactions", "total_count": 2, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 1, "heart": 0, "rocket": 1, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2063/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2061", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2061/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2061/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2061/events", "html_url": "https://github.com/locustio/locust/issues/2061", "id": 1184550494, "node_id": "I_kwDOABUGS85Gms5e", "number": 2061, "title": "New jinja2 pinning makes it impossible to build our codebase", "user": {"login": "kramer65", "id": 596581, "node_id": "MDQ6VXNlcjU5NjU4MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/596581?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kramer65", "html_url": "https://github.com/kramer65", "followers_url": "https://api.github.com/users/kramer65/followers", "following_url": "https://api.github.com/users/kramer65/following{/other_user}", "gists_url": "https://api.github.com/users/kramer65/gists{/gist_id}", "starred_url": "https://api.github.com/users/kramer65/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kramer65/subscriptions", "organizations_url": "https://api.github.com/users/kramer65/orgs", "repos_url": "https://api.github.com/users/kramer65/repos", "events_url": "https://api.github.com/users/kramer65/events{/privacy}", "received_events_url": "https://api.github.com/users/kramer65/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-03-29T09:08:48Z", "updated_at": "2022-05-05T17:25:03Z", "closed_at": "2022-05-05T17:25:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "This isn't a bug in the codebase of locust per se, but rather a [new jinja2 pinning here](https://github.com/locustio/locust/commit/b85fbbfbac5c61db972c1727a69ad60fb93a91ca) which makes it impossible to use locust in our codebase in which a different library requires a version of jinja2 higher than 3.1.0.\r\n\r\nIs there a way that we can get rid of this pinning in locust? Or is there any known workaround?", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2061/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2061/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2058", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2058/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2058/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2058/events", "html_url": "https://github.com/locustio/locust/issues/2058", "id": 1181076145, "node_id": "I_kwDOABUGS85GZcqx", "number": 2058, "title": "Bad file descriptor (C:\\projects\\libzmq\\src\\epoll.cpp:100", "user": {"login": "Mountains-and-rivers", "id": 15889219, "node_id": "MDQ6VXNlcjE1ODg5MjE5", "avatar_url": "https://avatars.githubusercontent.com/u/15889219?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mountains-and-rivers", "html_url": "https://github.com/Mountains-and-rivers", "followers_url": "https://api.github.com/users/Mountains-and-rivers/followers", "following_url": "https://api.github.com/users/Mountains-and-rivers/following{/other_user}", "gists_url": "https://api.github.com/users/Mountains-and-rivers/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mountains-and-rivers/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mountains-and-rivers/subscriptions", "organizations_url": "https://api.github.com/users/Mountains-and-rivers/orgs", "repos_url": "https://api.github.com/users/Mountains-and-rivers/repos", "events_url": "https://api.github.com/users/Mountains-and-rivers/events{/privacy}", "received_events_url": "https://api.github.com/users/Mountains-and-rivers/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-03-25T17:53:31Z", "updated_at": "2022-07-07T08:56:05Z", "closed_at": "2022-07-07T08:56:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "environment:\r\n```\r\nos: windows 11\r\npython version: 3.7.3\r\nlocust version:  2.8.4\r\n```\r\nlocust install:\r\n```\r\n(venv) C:\\Users\\Users\\PycharmProjects\\testlocust>pip3 install locust \r\nCollecting locust\r\n  Using cached locust-2.8.4-py3-none-any.whl (805 kB)\r\nCollecting Flask-Cors>=3.0.10\r\n  Using cached Flask_Cors-3.0.10-py2.py3-none-any.whl (14 kB)\r\nCollecting msgpack>=0.6.2\r\n  Using cached msgpack-1.0.3-cp37-cp37m-win_amd64.whl (68 kB)\r\nCollecting psutil>=5.6.7\r\n  Using cached psutil-5.9.0-cp37-cp37m-win_amd64.whl (246 kB)\r\nCollecting Werkzeug>=2.0.0\r\n  Using cached Werkzeug-2.0.3-py3-none-any.whl (289 kB)\r\nCollecting Flask-BasicAuth>=0.2.0\r\n  Using cached Flask_BasicAuth-0.2.0-py3-none-any.whl\r\nCollecting flask>=2.0.0\r\n  Using cached Flask-2.0.3-py3-none-any.whl (95 kB)\r\nCollecting pywin32\r\n  Using cached pywin32-303-cp37-cp37m-win_amd64.whl (9.2 MB)\r\nCollecting typing-extensions>=3.7.4.3\r\n  Using cached typing_extensions-4.1.1-py3-none-any.whl (26 kB)\r\nCollecting itsdangerous>=2.0\r\n  Using cached itsdangerous-2.1.2-py3-none-any.whl (15 kB)\r\nCollecting Jinja2>=3.0\r\n  Using cached Jinja2-3.1.0-py3-none-any.whl (132 kB)\r\nCollecting click>=7.1.2\r\n  Using cached click-8.0.4-py3-none-any.whl (97 kB)\r\nCollecting importlib-metadata\r\n  Using cached importlib_metadata-4.11.3-py3-none-any.whl (18 kB)\r\nCollecting colorama\r\n  Using cached colorama-0.4.4-py2.py3-none-any.whl (16 kB)\r\nCollecting Six\r\n  Using cached six-1.16.0-py2.py3-none-any.whl (11 kB)\r\nCollecting zope.event\r\n  Using cached zope.event-4.5.0-py2.py3-none-any.whl (6.8 kB)\r\nCollecting cffi>=1.12.2\r\n  Using cached cffi-1.15.0-cp37-cp37m-win_amd64.whl (179 kB)\r\nCollecting zope.interface\r\n  Using cached zope.interface-5.4.0-cp37-cp37m-win_amd64.whl (210 kB)\r\nRequirement already satisfied: setuptools in c:\\users\\Users\\pycharmprojects\\testlocust\\venv\\lib\\site-packages (from gevent>=20.12.1->locust) (57.0.0)\r\nCollecting greenlet<2.0,>=1.1.0\r\n  Using cached greenlet-1.1.2-cp37-cp37m-win_amd64.whl (101 kB)\r\nCollecting pycparser\r\n  Using cached pycparser-2.21-py2.py3-none-any.whl (118 kB)\r\nCollecting brotli\r\n  Using cached Brotli-1.0.9-cp37-cp37m-win_amd64.whl (365 kB)\r\nCollecting certifi\r\n  Using cached certifi-2021.10.8-py2.py3-none-any.whl (149 kB)\r\nCollecting MarkupSafe>=2.0\r\n  Using cached MarkupSafe-2.1.1-cp37-cp37m-win_amd64.whl (17 kB)\r\nCollecting urllib3<1.27,>=1.21.1\r\n  Using cached urllib3-1.26.9-py2.py3-none-any.whl (138 kB)\r\nCollecting charset-normalizer~=2.0.0\r\n  Using cached charset_normalizer-2.0.12-py3-none-any.whl (39 kB)\r\nCollecting idna<4,>=2.5\r\n  Using cached idna-3.3-py3-none-any.whl (61 kB)\r\nCollecting zipp>=0.5\r\n  Using cached zipp-3.7.0-py3-none-any.whl (5.3 kB)\r\nInstalling collected packages: zipp, typing-extensions, pycparser, MarkupSafe, importlib-metadata, colorama, zope.interface, zope.event, Werkzeug, Jinja2, itsdangerous, greenlet, click, cffi, urllib3, Six, idna, gevent, flask, charset-normalizer, certifi, brotli, roundrobin, requests, pyzmq, pywin32, psutil, msgpack, geventhttpclient, Flask-Cors, Flask-BasicAuth, ConfigArgParse, locust\r\nSuccessfully installed ConfigArgParse-1.5.3 Flask-BasicAuth-0.2.0 Flask-Cors-3.0.10 Jinja2-3.1.0 MarkupSafe-2.1.1 Six-1.16.0 Werkzeug-2.0.3 brotli-1.0.9 certifi-2021.10.8 cffi-1.15.0 charset-normalizer-2.0.12 click-8.0.4 colorama-0.4.4\r\n flask-2.0.3 gevent-21.12.0 geventhttpclient-1.5.3 greenlet-1.1.2 idna-3.3 importlib-metadata-4.11.3 itsdangerous-2.1.2 locust-2.8.4 msgpack-1.0.3 psutil-5.9.0 pycparser-2.21 pywin32-303 pyzmq-22.3.0 requests-2.27.1 roundrobin-0.0.2 typing-extensions-4.1.1 urllib3-1.26.9 zipp-3.7.0 zope.event-4.5.0 zope.interface-5.4.0\r\n\r\n```\r\n\r\nmy code locustflask.py :\r\n```\r\nfrom locust import HttpUser, task, constant,SequentialTaskSet,TaskSet,events\r\nimport logging as log\r\nimport json\r\n\r\n@events.test_start.add_listener\r\ndef on_start(**kwargs):\r\n    log.info(\"A test will start...\")\r\n\r\n@events.test_stop.add_listener\r\ndef on_stop(**kwargs):\r\n    log.info(\"A test is ending...\")\r\n\r\nWEB_HEADER = None\r\nclass SetTask(TaskSet):\r\n    @task(1)\r\n    def getLogDetail(self):\r\n        deatil_url = \"/auth/online?page=0&size=10&sort=id%2Cdesc\"\r\n        with self.client.request(method='GET',\r\n                                 url=deatil_url,\r\n                                 headers=WEB_HEADER,\r\n                                 name='get log detail') as response:\r\n            log.info(response.text)\r\n    @task\r\n    def stop(self):\r\n        self.interrupt()\r\nclass FlaskTask(SequentialTaskSet): \r\n    def on_start(self):\r\n        res = self.client.request(method='GET', url=\"/auth/code\",name=\"get code\")\r\n        uuid = res.json()['uuid']\r\n        headers = {\r\n            \"content-type\": \"application/json;charset=UTF-8\",\r\n        }\r\n        datda_info = {\r\n            \"code\": \"8\",\r\n            \"password\": \"B0GdcVWB+XtTwsyBjzoRkn8VnSgtPVKpl8mp7AuQ+BTeU030grUkRwmOHXFCjEhKXB7yezBS7dFEJ63ykR2piQ==\",\r\n            \"username\": \"admin\",\r\n            \"uuid\": uuid\r\n        }\r\n        with self.client.request(method='POST',url=\"/auth/login\", headers=headers, catch_response=True,data=json.dumps(datda_info),name=\"get token\") as response:\r\n            self.token = response.json()['token']\r\n            if response.status_code == 200:\r\n                self.token = response.json()['token']\r\n                response.success()\r\n            else:\r\n                response.failure(\"get token error\")\r\n            global WEB_HEADER\r\n            WEB_HEADER = {\r\n                \"Authorization\": self.token\r\n            }\r\n    tasks = [SetTask]\r\n    @task\r\n    def getUserDetail(self):\r\n        deatil_url = \"/api/dictDetail?dictName=user_status&page=0&size=9999\"\r\n        with self.client.request(method='GET',\r\n                                 url=deatil_url,\r\n                                 headers=WEB_HEADER,\r\n                                 name='get user detail') as response:\r\n            log.info(response.text)\r\n\r\ndef function_task():\r\n    log.info(\"This is the function task\")\r\n\r\nclass FlaskUser(HttpUser):\r\n    host = 'http://192.168.31.243:8888'\r\n    wait_time = constant(1) \r\n    #wait_time = between(1,3) \r\n    tasks = [FlaskTask]\r\n```\r\nwhen i exec :\r\n```\r\nlocust -f locustflask.py --master\r\n\r\n```\r\n\r\ni got error:\r\n\r\n```\r\nBad file descriptor (C:\\projects\\libzmq\\src\\epoll.cpp:100\r\n```\r\n\r\nother:\r\ni test in centos 8.3 ,it's ok. so what happens in windows 11?", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2058/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2058/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2057", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2057/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2057/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2057/events", "html_url": "https://github.com/locustio/locust/issues/2057", "id": 1180660041, "node_id": "I_kwDOABUGS85GX3FJ", "number": 2057, "title": "Exception in `init` event doesn't terminate process", "user": {"login": "letmaik", "id": 530988, "node_id": "MDQ6VXNlcjUzMDk4OA==", "avatar_url": "https://avatars.githubusercontent.com/u/530988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/letmaik", "html_url": "https://github.com/letmaik", "followers_url": "https://api.github.com/users/letmaik/followers", "following_url": "https://api.github.com/users/letmaik/following{/other_user}", "gists_url": "https://api.github.com/users/letmaik/gists{/gist_id}", "starred_url": "https://api.github.com/users/letmaik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/letmaik/subscriptions", "organizations_url": "https://api.github.com/users/letmaik/orgs", "repos_url": "https://api.github.com/users/letmaik/repos", "events_url": "https://api.github.com/users/letmaik/events{/privacy}", "received_events_url": "https://api.github.com/users/letmaik/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-03-25T11:10:33Z", "updated_at": "2022-06-05T02:15:41Z", "closed_at": "2022-06-05T02:15:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nExceptions raised in `init` event listeners don't lead locust to exit. This seems odd given that failing initialization code likely leads to subsequent failures that would then mask the initial issue.\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nExceptions in event listeners should, especially `init` should exit locust. If that is undesirable for some reason, then there should be an \"official\" way to trigger shutdown by manually try-except wrapping and calling some locust function.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nExceptions get dumped to console but otherwise don't influence the rest of the execution.\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n```py\r\n@events.init.add_listener\r\ndef on_locust_init(environment, **kwargs):\r\n  # ...some code that raises an exception\r\n```\r\n\r\n### Environment\r\n\r\n- OS: Ubuntu 20.04\r\n- Python version: 3.8\r\n- Locust version: 2.8.4\r\n- Locust command line that you ran: `locust`\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2057/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2057/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2056", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2056/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2056/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2056/events", "html_url": "https://github.com/locustio/locust/issues/2056", "id": 1180648530, "node_id": "I_kwDOABUGS85GX0RS", "number": 2056, "title": "`Environment.host` is `None` in `init` event", "user": {"login": "letmaik", "id": 530988, "node_id": "MDQ6VXNlcjUzMDk4OA==", "avatar_url": "https://avatars.githubusercontent.com/u/530988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/letmaik", "html_url": "https://github.com/letmaik", "followers_url": "https://api.github.com/users/letmaik/followers", "following_url": "https://api.github.com/users/letmaik/following{/other_user}", "gists_url": "https://api.github.com/users/letmaik/gists{/gist_id}", "starred_url": "https://api.github.com/users/letmaik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/letmaik/subscriptions", "organizations_url": "https://api.github.com/users/letmaik/orgs", "repos_url": "https://api.github.com/users/letmaik/repos", "events_url": "https://api.github.com/users/letmaik/events{/privacy}", "received_events_url": "https://api.github.com/users/letmaik/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901882, "node_id": "MDU6TGFiZWwxNjM1OTAxODgy", "url": "https://api.github.com/repos/locustio/locust/labels/wontfix", "name": "wontfix", "color": "ddcccc", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-03-25T11:03:07Z", "updated_at": "2022-03-25T13:37:39Z", "closed_at": "2022-03-25T11:53:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nIt seems there's no way to write initialization code that is guaranteed to run after the host is known. A work-around is to always specify `-H` on the command line and use it in the `init` event.\r\nThe docs at https://docs.locust.io/en/stable/api.html#locust.env.Environment.host also don't mention that this property can be `None`. Similarly, https://docs.locust.io/en/stable/api.html#locust.event.Events.init gives the impression that the event is called after everything is known, particularly the environment.\r\n\r\n### Expected behavior\r\nInitialization logic should know what the target host is and I expect that `Environment.host` is known in the `init` event.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nWhen not specifying `-H` on the command line, then `environment.host` is `None` within the `init` event.\r\n\r\n### Steps to reproduce\r\n\r\n```py\r\n@events.init.add_listener\r\ndef on_locust_init(environment, **kwargs):\r\n    print(environment.host) # None\r\n```\r\n\r\nStart with `locust`.\r\n\r\n### Environment\r\n\r\n- OS: Ubuntu 20.04\r\n- Python version: 3.8\r\n- Locust version: 2.8.4\r\n- Locust command line that you ran: `locust`\r\n- Locust file contents (anonymized if necessary): See above", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2056/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2056/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2053", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2053/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2053/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2053/events", "html_url": "https://github.com/locustio/locust/issues/2053", "id": 1174431992, "node_id": "I_kwDOABUGS85GAGj4", "number": 2053, "title": "Run in docker: ERROR/locust.runners: RPCError found when receiving from client: ZMQ network broken", "user": {"login": "zhangboyi", "id": 40347463, "node_id": "MDQ6VXNlcjQwMzQ3NDYz", "avatar_url": "https://avatars.githubusercontent.com/u/40347463?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zhangboyi", "html_url": "https://github.com/zhangboyi", "followers_url": "https://api.github.com/users/zhangboyi/followers", "following_url": "https://api.github.com/users/zhangboyi/following{/other_user}", "gists_url": "https://api.github.com/users/zhangboyi/gists{/gist_id}", "starred_url": "https://api.github.com/users/zhangboyi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zhangboyi/subscriptions", "organizations_url": "https://api.github.com/users/zhangboyi/orgs", "repos_url": "https://api.github.com/users/zhangboyi/repos", "events_url": "https://api.github.com/users/zhangboyi/events{/privacy}", "received_events_url": "https://api.github.com/users/zhangboyi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-03-20T03:52:33Z", "updated_at": "2022-06-06T02:14:56Z", "closed_at": "2022-06-06T02:14:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nit cann not work when running in docker.\r\n\r\n\r\n```text\r\n[+] Running 3/0\r\n \u283f Container myexample-master-3  Created                                                                                                                                                                           0.0s\r\n \u283f Container myexample-worker-2  Created                                                                                                                                                                           0.0s\r\n \u283f Container myexample-worker-3  Created                                                                                                                                                                           0.0s\r\nAttaching to myexample-master-3, myexample-worker-2, myexample-worker-3\r\nmyexample-master-3  | [2022-03-20 04:43:43,888] 374ef93331c9/INFO/locust.main: Starting web interface at http://0.0.0.0:8089 (accepting connections from all network interfaces)\r\nmyexample-worker-3  | 0\r\nmyexample-worker-3  | I'm on a worker or standalone node\r\nmyexample-worker-2  | 0\r\nmyexample-worker-2  | I'm on a worker or standalone node\r\nmyexample-worker-3  | [2022-03-20 04:43:43,890] 55e0acab805b/INFO/locust.main: Starting Locust 2.8.4\r\nmyexample-worker-2  | [2022-03-20 04:43:43,890] 37541a5124ca/INFO/locust.main: Starting Locust 2.8.4\r\nmyexample-master-3  | 0\r\nmyexample-master-3  | I'm on master node\r\nmyexample-master-3  | [2022-03-20 04:43:43,901] 374ef93331c9/INFO/locust.main: Starting Locust 2.8.4\r\nmyexample-master-3  | [2022-03-20 04:43:51,069] 374ef93331c9/WARNING/locust.runners: You can't start a distributed test before at least one worker processes has connected\r\nmyexample-worker-2  | [2022-03-20 04:56:13,710] 37541a5124ca/INFO/locust.util.exception_handler: Exception found on retry 1: -- retry after 1s\r\nmyexample-worker-3  | [2022-03-20 04:56:13,710] 55e0acab805b/INFO/locust.util.exception_handler: Exception found on retry 1: -- retry after 1s\r\nmyexample-worker-3  | [2022-03-20 04:56:13,710] 55e0acab805b/ERROR/locust.util.exception_handler: ZMQ sent failure\r\nmyexample-worker-3  | Traceback (most recent call last):\r\nmyexample-worker-3  |   File \"/opt/venv/lib/python3.9/site-packages/locust/rpc/zmqrpc.py\", line 20, in send\r\nmyexample-worker-3  |     self.socket.send(msg.serialize(), zmq.NOBLOCK)\r\nmyexample-worker-3  |   File \"/opt/venv/lib/python3.9/site-packages/zmq/green/core.py\", line 216, in send\r\nmyexample-worker-3  |     msg = super(_Socket, self).send(data, flags, copy, track, **kwargs)\r\nmyexample-worker-3  |   File \"/opt/venv/lib/python3.9/site-packages/zmq/sugar/socket.py\", line 547, in send\r\nmyexample-worker-3  |     return super(Socket, self).send(data, flags=flags, copy=copy, track=track)\r\nmyexample-worker-3  |   File \"zmq/backend/cython/socket.pyx\", line 718, in zmq.backend.cython.socket.Socket.send\r\nmyexample-worker-3  |   File \"zmq/backend/cython/socket.pyx\", line 765, in zmq.backend.cython.socket.Socket.send\r\nmyexample-worker-3  |   File \"zmq/backend/cython/socket.pyx\", line 247, in zmq.backend.cython.socket._send_copy\r\nmyexample-worker-3  |   File \"zmq/backend/cython/socket.pyx\", line 242, in zmq.backend.cython.socket._send_copy\r\nmyexample-worker-3  |   File \"zmq/backend/cython/checkrc.pxd\", line 22, in zmq.backend.cython.checkrc._check_rc\r\nmyexample-worker-3  | zmq.error.Again: Resource temporarily unavailable\r\nmyexample-worker-3  | \r\n\r\n\r\n```\r\n\r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version:python3.8\r\n- Locust version: 2.8.4\r\n- Locust command line that you ran: docker-compose -f run_by_locust.yaml up --scale worker=2\r\n- Locust file contents (anonymized if necessary):\r\ndocker-compose.yml\r\n```yaml\r\nversion: '3'\r\n\r\nservices:\r\n  master:\r\n    image: locustio/locust:latest\r\n    ports:\r\n      - 8089:8089\r\n    volumes:\r\n      - ./:/myexample\r\n    command: -f /myexample/locustfile.py WebsiteUser --master\r\n\r\n  worker:\r\n    image: locustio/locust:latest\r\n    links:\r\n      - master\r\n    volumes:\r\n      - ./:/myexample\r\n    command: -f /myexample/locustfile.py WebsiteUser --worker --master-host=127.0.0.1\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2053/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2053/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2046", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2046/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2046/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2046/events", "html_url": "https://github.com/locustio/locust/issues/2046", "id": 1165043088, "node_id": "I_kwDOABUGS85FcSWQ", "number": 2046, "title": "Web UI stuck on \"STOPPING\"", "user": {"login": "the--dud", "id": 913780, "node_id": "MDQ6VXNlcjkxMzc4MA==", "avatar_url": "https://avatars.githubusercontent.com/u/913780?v=4", "gravatar_id": "", "url": "https://api.github.com/users/the--dud", "html_url": "https://github.com/the--dud", "followers_url": "https://api.github.com/users/the--dud/followers", "following_url": "https://api.github.com/users/the--dud/following{/other_user}", "gists_url": "https://api.github.com/users/the--dud/gists{/gist_id}", "starred_url": "https://api.github.com/users/the--dud/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/the--dud/subscriptions", "organizations_url": "https://api.github.com/users/the--dud/orgs", "repos_url": "https://api.github.com/users/the--dud/repos", "events_url": "https://api.github.com/users/the--dud/events{/privacy}", "received_events_url": "https://api.github.com/users/the--dud/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2022-03-10T10:34:15Z", "updated_at": "2022-06-10T02:15:37Z", "closed_at": "2022-06-10T02:15:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nRunning locust 2.8.3 on GCP cluster, with docker images python:3.10.2-slim-buster.\r\nI have 1 master and 5 workers. When I press Stop in the web UI, it get's stuck saying STOPPING, and never changes to STOPPED.\r\nThis makes it look like the workers are still working, but they are not actually. The workers have stopped and are in ready state.\r\n\r\nLogs from master:\r\n```\r\n[2022-03-10 10:21:36,680] locust-master-57bfcc5445-n62pd/INFO/locust.main: Starting web interface at http://0.0.0.0:8089 (accepting connections from all network interfaces)\r\n[2022-03-10 10:21:36,693] locust-master-57bfcc5445-n62pd/INFO/locust.main: Starting Locust 2.8.3\r\n[2022-03-10 10:21:51,492] locust-master-57bfcc5445-n62pd/INFO/locust.runners: Client 'locust-worker-69669f574d-ncvf5_11614c89a3914fd8a4ae11a8365f046d' reported as ready. Currently 1 clients ready to swarm.\r\n[2022-03-10 10:21:52,267] locust-master-57bfcc5445-n62pd/INFO/locust.runners: Client 'locust-worker-69669f574d-tqxqv_70ac83470e4845f495190d98489e30c1' reported as ready. Currently 2 clients ready to swarm.\r\n[2022-03-10 10:21:54,416] locust-master-57bfcc5445-n62pd/INFO/locust.runners: Client 'locust-worker-69669f574d-m9fc5_912176e2721949ab95871d8c9f29977b' reported as ready. Currently 3 clients ready to swarm.\r\n[2022-03-10 10:21:55,716] locust-master-57bfcc5445-n62pd/INFO/locust.runners: Client 'locust-worker-69669f574d-4fltb_4bfda0642dbe4463bd7c1bc3bda676d8' reported as ready. Currently 4 clients ready to swarm.\r\n[2022-03-10 10:21:57,329] locust-master-57bfcc5445-n62pd/INFO/locust.runners: Client 'locust-worker-69669f574d-775nk_7c6fa568b8d2456399d05edfdb171152' reported as ready. Currently 5 clients ready to swarm.\r\n[2022-03-10 10:22:20,491] locust-master-57bfcc5445-n62pd/INFO/locust.runners: Sending spawn jobs of 10 users at 10.00 spawn rate to 5 ready clients\r\n[2022-03-10 10:22:20,575] locust-master-57bfcc5445-n62pd/INFO/locust.runners: All users spawned: {\"AuthUser\": 10} (10 total users)\r\n[2022-03-10 10:22:41,006] locust-master-57bfcc5445-n62pd/INFO/locust.runners: Removing locust-worker-69669f574d-m9fc5_912176e2721949ab95871d8c9f29977b client from running clients\r\n[2022-03-10 10:22:41,006] locust-master-57bfcc5445-n62pd/INFO/locust.runners: Client 'locust-worker-69669f574d-m9fc5_912176e2721949ab95871d8c9f29977b' reported as ready. Currently 5 clients ready to swarm.\r\n[2022-03-10 10:22:41,006] locust-master-57bfcc5445-n62pd/INFO/locust.runners: Removing locust-worker-69669f574d-ncvf5_11614c89a3914fd8a4ae11a8365f046d client from running clients\r\n[2022-03-10 10:22:41,007] locust-master-57bfcc5445-n62pd/INFO/locust.runners: Client 'locust-worker-69669f574d-ncvf5_11614c89a3914fd8a4ae11a8365f046d' reported as ready. Currently 5 clients ready to swarm.\r\n[2022-03-10 10:22:41,007] locust-master-57bfcc5445-n62pd/INFO/locust.runners: Removing locust-worker-69669f574d-775nk_7c6fa568b8d2456399d05edfdb171152 client from running clients\r\n[2022-03-10 10:22:41,007] locust-master-57bfcc5445-n62pd/INFO/locust.runners: Client 'locust-worker-69669f574d-775nk_7c6fa568b8d2456399d05edfdb171152' reported as ready. Currently 5 clients ready to swarm.\r\n[2022-03-10 10:22:41,007] locust-master-57bfcc5445-n62pd/INFO/locust.runners: Removing locust-worker-69669f574d-tqxqv_70ac83470e4845f495190d98489e30c1 client from running clients\r\n[2022-03-10 10:22:41,007] locust-master-57bfcc5445-n62pd/INFO/locust.runners: Removing locust-worker-69669f574d-4fltb_4bfda0642dbe4463bd7c1bc3bda676d8 client from running clients\r\n[2022-03-10 10:22:41,007] locust-master-57bfcc5445-n62pd/INFO/locust.runners: Client 'locust-worker-69669f574d-4fltb_4bfda0642dbe4463bd7c1bc3bda676d8' reported as ready. Currently 4 clients ready to swarm.\r\n[2022-03-10 10:22:41,007] locust-master-57bfcc5445-n62pd/INFO/locust.runners: Client 'locust-worker-69669f574d-tqxqv_70ac83470e4845f495190d98489e30c1' reported as ready. Currently 5 clients ready to swarm.\r\n```\r\n\r\nResponse from https://auth-locust.signicat.dev/stats/requests\r\n```\r\n{\r\n  \"current_response_time_percentile_50\": null, \r\n  \"current_response_time_percentile_95\": null, \r\n  \"errors\": [], \r\n  \"fail_ratio\": 0.0, \r\n  \"state\": \"stopping\", \r\n  \"stats\": [\r\n    {\r\n      \"avg_content_length\": 2635.0, \r\n      \"avg_response_time\": 118.18601360375231, \r\n      \"current_fail_per_sec\": 0.0, \r\n      \"current_rps\": 2.8, \r\n      \"max_response_time\": 297.0, \r\n      \"median_response_time\": 100, \r\n      \"method\": \"GET\", \r\n      \"min_response_time\": 8.0, \r\n      \"name\": HIDDEN, \r\n      \"ninetieth_response_time\": 200.0, \r\n      \"ninety_ninth_response_time\": 300.0, \r\n      \"num_failures\": 0, \r\n      \"num_requests\": 55, \r\n      \"safe_name\":HIDDEN\r\n    }, \r\n    {\r\n      \"avg_content_length\": 922.0, \r\n      \"avg_response_time\": 171.46125374446538, \r\n      \"current_fail_per_sec\": 0.0, \r\n      \"current_rps\": 3.1, \r\n      \"max_response_time\": 401.0, \r\n      \"median_response_time\": 190.0, \r\n      \"method\": \"GET\", \r\n      \"min_response_time\": 13.0, \r\n      \"name\": HIDDEN, \r\n      \"ninetieth_response_time\": 290.0, \r\n      \"ninety_ninth_response_time\": 400.0, \r\n      \"num_failures\": 0, \r\n      \"num_requests\": 55, \r\n      \"safe_name\": HIDDEN\r\n    }, \r\n    {\r\n      \"avg_content_length\": 8432.0, \r\n      \"avg_response_time\": 574.5072794367848, \r\n      \"current_fail_per_sec\": 0.0, \r\n      \"current_rps\": 10.9, \r\n      \"max_response_time\": 5829.0, \r\n      \"median_response_time\": 410.0, \r\n      \"method\": \"GET\", \r\n      \"min_response_time\": 119.0, \r\n      \"name\": HIDDEN, \r\n      \"ninetieth_response_time\": 610.0, \r\n      \"ninety_ninth_response_time\": 5000.0, \r\n      \"num_failures\": 0, \r\n      \"num_requests\": 197, \r\n      \"safe_name\": HIDDEN\r\n    }, \r\n    {\r\n      \"avg_content_length\": 898.0, \r\n      \"avg_response_time\": 164.27931896370345, \r\n      \"current_fail_per_sec\": 0.0, \r\n      \"current_rps\": 27.6, \r\n      \"max_response_time\": 459.0, \r\n      \"median_response_time\": 180.0, \r\n      \"method\": \"POST\", \r\n      \"min_response_time\": 8.0, \r\n      \"name\": HIDDEN\r\n      \"ninetieth_response_time\": 280.0, \r\n      \"ninety_ninth_response_time\": 390.0, \r\n      \"num_failures\": 0, \r\n      \"num_requests\": 448, \r\n      \"safe_name\": HIDDEN\r\n    }, \r\n    {\r\n      \"avg_content_length\": 2992.1099337748346, \r\n      \"avg_response_time\": 268.4843293363414, \r\n      \"current_fail_per_sec\": 0.0, \r\n      \"current_rps\": 44.4, \r\n      \"max_response_time\": 5829.0, \r\n      \"median_response_time\": 200.0, \r\n      \"method\": null, \r\n      \"min_response_time\": 8.0, \r\n      \"name\": \"Aggregated\", \r\n      \"ninetieth_response_time\": 420.0, \r\n      \"ninety_ninth_response_time\": 2600.0, \r\n      \"num_failures\": 0, \r\n      \"num_requests\": 755, \r\n      \"safe_name\": \"Aggregated\"\r\n    }\r\n  ], \r\n  \"total_rps\": 44.4, \r\n  \"user_count\": 0, \r\n  \"workers\": [\r\n    {\r\n      \"cpu_usage\": 0.0, \r\n      \"id\": \"locust-worker-69669f574d-m9fc5_912176e2721949ab95871d8c9f29977b\", \r\n      \"memory_usage\": 52801536, \r\n      \"state\": \"ready\", \r\n      \"user_count\": 0\r\n    }, \r\n    {\r\n      \"cpu_usage\": 0.0, \r\n      \"id\": \"locust-worker-69669f574d-ncvf5_11614c89a3914fd8a4ae11a8365f046d\", \r\n      \"memory_usage\": 52969472, \r\n      \"state\": \"ready\", \r\n      \"user_count\": 0\r\n    }, \r\n    {\r\n      \"cpu_usage\": 0.2, \r\n      \"id\": \"locust-worker-69669f574d-775nk_7c6fa568b8d2456399d05edfdb171152\", \r\n      \"memory_usage\": 53260288, \r\n      \"state\": \"ready\", \r\n      \"user_count\": 0\r\n    }, \r\n    {\r\n      \"cpu_usage\": 0.0, \r\n      \"id\": \"locust-worker-69669f574d-4fltb_4bfda0642dbe4463bd7c1bc3bda676d8\", \r\n      \"memory_usage\": 53157888, \r\n      \"state\": \"ready\", \r\n      \"user_count\": 0\r\n    }, \r\n    {\r\n      \"cpu_usage\": 0.2, \r\n      \"id\": \"locust-worker-69669f574d-tqxqv_70ac83470e4845f495190d98489e30c1\", \r\n      \"memory_usage\": 52875264, \r\n      \"state\": \"ready\", \r\n      \"user_count\": 0\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n### Expected behavior\r\nAfter saying STOPPING for a while, I expect it to say STOPPED.\r\n\r\n### Actual behavior\r\nNever says STOPPED, only STOPPING.\r\n\r\n### Steps to reproduce\r\n\r\n1. Setup 1 master and 5 workers\r\n2. Open web UI\r\n3. Start test\r\n4. Let it run for a while\r\n5. Stop test\r\n6. Observe that status is stuck on STOPPING and never goes to STOPPED.\r\n\r\n### Environment\r\n\r\n- OS: python:3.10.2-slim-buster\r\n- Python version: python:3.10.2-slim-buster\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds)\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2046/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2046/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2045", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2045/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2045/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2045/events", "html_url": "https://github.com/locustio/locust/issues/2045", "id": 1162426018, "node_id": "I_kwDOABUGS85FSTai", "number": 2045, "title": "Memory leak in master node when running Locust in Kubernetes ", "user": {"login": "samjacobclift", "id": 1868592, "node_id": "MDQ6VXNlcjE4Njg1OTI=", "avatar_url": "https://avatars.githubusercontent.com/u/1868592?v=4", "gravatar_id": "", "url": "https://api.github.com/users/samjacobclift", "html_url": "https://github.com/samjacobclift", "followers_url": "https://api.github.com/users/samjacobclift/followers", "following_url": "https://api.github.com/users/samjacobclift/following{/other_user}", "gists_url": "https://api.github.com/users/samjacobclift/gists{/gist_id}", "starred_url": "https://api.github.com/users/samjacobclift/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/samjacobclift/subscriptions", "organizations_url": "https://api.github.com/users/samjacobclift/orgs", "repos_url": "https://api.github.com/users/samjacobclift/repos", "events_url": "https://api.github.com/users/samjacobclift/events{/privacy}", "received_events_url": "https://api.github.com/users/samjacobclift/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-03-08T09:32:59Z", "updated_at": "2022-05-19T02:16:49Z", "closed_at": "2022-05-19T02:16:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nWe are experiencing a memory leak in our master node when running locust in Kubernetes over a long period of time. We can see that the MiB used by the service roughly increases by 2MiB per hour. Importantly it doesn't seem to stop increasing, we've noticed the issue as our master pod will OOM.\r\n\r\nWe've added some [tracemalloc](https://docs.python.org/3/library/tracemalloc.html) logging into our service to try and spot the problem, you can see some sample output below\r\n\r\n```shell\r\n\u2502  #1: /usr/local/lib/python3.9/site-packages/locust/stats.py:frame.lineno: 4007.5 KiB                                                   \u2502\r\n\u2502     r = {                                                                                                                             \u2502\r\n\u2502  #2: /usr/local/lib/python3.9/linecache.py:frame.lineno: 741.6 KiB                                                                     \u2502\r\n\u2502   lines = fp.readlines()                                                                                                            \u2502\r\n\u2502  #3: /usr/local/lib/python3.9/site-packages/locust/stats.py:frame.lineno: 634.5 KiB                                                    \u2502\r\n\u2502     \"time\": datetime.datetime.utcnow().strftime(\"%H:%M:%S\"),                                                                          \u2502\r\n\u2502  #4: <frozen importlib._bootstrap_external>:frame.lineno: 108.2 KiB                                                                    \u2502\r\n\u2502  #5: /usr/local/lib/python3.9/site-packages/locust/stats.py:frame.lineno: 93.6 KiB                                                     \u2502\r\n\u2502     stats.history.append(r)                                                                                                           \u2502\r\n\u2502 #6: /usr/local/lib/python3.9/_weakrefset.py:frame.lineno: 87.8 KiB                                                                    \u2502\r\n\u2502      self.data = set()                                                                                                                 \u2502\r\n\u2502 #7: /usr/local/lib/python3.9/tracemalloc.py:frame.lineno: 81.5 KiB                                                                    \u2502\r\n\u2502     traces = _get_traces()                                                                                                            \u2502\r\n\u2502 #8: /usr/local/lib/python3.9/tracemalloc.py:frame.lineno: 70.4 KiB                                                                    \u2502\r\n\u2502     return (self.size, self.count, self.traceback)                                                                                    \u2502\r\n\u2502 #9: /usr/local/lib/python3.9/_weakrefset.py:frame.lineno: 65.0 KiB                                                                    \u2502\r\n\u2502      def _remove(item, selfref=ref(self)):                                                                                             \u2502\r\n\u2502 #10: /usr/local/lib/python3.9/_weakrefset.py:frame.lineno: 59.3 KiB                                                                   \u2502\r\n\u2502   self._iterating = set()                                                                                                           \u2502\r\n\u2502 1130 other: 954.4 KiB                                                                                                                 \u2502\r\n\u2502 Total allocated size: 6903.8 KiB\r\n```\r\n\r\nThe root cause seems to be an issue in `locust/stats.py` although I can't specifically see why that would be a problem. \r\n\r\nWe can work around this just by letting the OOM do its thing and restart the pod but felt it was worth reporting here.\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nMemory use doesn't gradually increase over time in master nodes\r\n\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nMemory use does gradually increase over time in master nodes\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\nDeployment containing a worker and master to Kubernetes, best bet will be to use the recommended helm chart. (Although we didn't use that)\r\n\r\n### Environment\r\n\r\n- OS: python3.9.6-slim docker image\r\n- Python version: 3.9.6\r\n- Locust version: 2.8.3\r\n- Locust command line that you ran: `locust --locustfile=src/locustfile.py --master`\r\n- Locust file contents (anonymized if necessary):\r\n\r\n```python\r\n# Set-up options and hooks:\r\ntest_context().add_listeners(events)\r\nevents.init.add_listener(init_listener_probe_endpoints)\r\nevents.init.add_listener(init_prometheus_metrics)\r\nevents.init.add_listener(init_listener_stale_worker_coordination)\r\nevents.init.add_listener(init_listener_stop_after_duration)\r\nevents.test_stop.add_listener(test_stop_listener_save_run_information)\r\n\r\n\r\nclass LogBasedLoadTest(FastHttpUser):\r\n    wait_time = between(1, 1)\r\n\r\n    connection_timeout = 3.0\r\n    network_timeout = 3.0\r\n\r\n    @task\r\n    def make_request(self) -> None:\r\n        context = test_context()\r\n        if not context.ready():\r\n            return\r\n        request_spec = context.pick_request()\r\n        try:\r\n            self.perform(request_spec)\r\n        except AssertionError as exc:\r\n            _LOGGER.error(str(exc))\r\n            self.client.environment.runner.greenlet.kill(block=True)\r\n\r\n    def perform(self, request_spec: RequestSpec) -> None:\r\n        name = request_spec[\"name\"]\r\n        request = request_spec[\"request\"]\r\n        method = getattr(self.client, request[\"method\"].lower())\r\n        method(\r\n            request[\"path\"],\r\n            headers=request[\"headers\"],\r\n            name=name,\r\n        )\r\n\r\n\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2045/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2045/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2043", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2043/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2043/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2043/events", "html_url": "https://github.com/locustio/locust/issues/2043", "id": 1161048506, "node_id": "I_kwDOABUGS85FNDG6", "number": 2043, "title": "Syntax Error ", "user": {"login": "mositafan10", "id": 58276825, "node_id": "MDQ6VXNlcjU4Mjc2ODI1", "avatar_url": "https://avatars.githubusercontent.com/u/58276825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mositafan10", "html_url": "https://github.com/mositafan10", "followers_url": "https://api.github.com/users/mositafan10/followers", "following_url": "https://api.github.com/users/mositafan10/following{/other_user}", "gists_url": "https://api.github.com/users/mositafan10/gists{/gist_id}", "starred_url": "https://api.github.com/users/mositafan10/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mositafan10/subscriptions", "organizations_url": "https://api.github.com/users/mositafan10/orgs", "repos_url": "https://api.github.com/users/mositafan10/repos", "events_url": "https://api.github.com/users/mositafan10/events{/privacy}", "received_events_url": "https://api.github.com/users/mositafan10/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-03-07T08:14:41Z", "updated_at": "2022-03-07T12:10:13Z", "closed_at": "2022-03-07T11:45:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "There is a problem with locust and Anaconda.\r\nI download locust package from anaconda.org and then move it to offline server. There i install the package with conda and installment finish successfully but when i insert in cmd an exception throw:\r\n\r\n\r\nTraceback (most recent call last):\r\nFile \"C:\\ProgramData\\Anaconda2\\Scripts\\locust-script.py\", line 5, in\r\nfrom locust.main import main\r\nFile \"C:\\ProgramData\\Anaconda2\\lib\\site-packages\\locust_init_.py\", line 14, in\r\nfrom .user.sequential_taskset import SequentialTaskSet\r\nFile \"C:\\ProgramData\\Anaconda2\\lib\\site-packages\\gevent\\builtins.py\", line 96, in import\r\nresult = import(*args, **kwargs)\r\nFile \"C:\\ProgramData\\Anaconda2\\lib\\site-packages\\locust\\user_init.py\", line 1, in\r\nfrom .task import task, tag, TaskSet\r\nFile \"C:\\ProgramData\\Anaconda2\\lib\\site-packages\\gevent\\builtins.py\", line 96, in import\r\nresult = _import(*args, **kwargs)\r\nFile \"C:\\ProgramData\\Anaconda2\\lib\\site-packages\\locust\\user\\task.py\", line 24\r\ndef task(weight: TaskT) -> TaskT:\r\n^\r\nSyntaxError: invalid syntax\r\n\r\n\r\nPython version is 3.6.5 and locust 2.8.3\r\n\r\nWhat is the problem ?", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2043/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2043/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2037", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2037/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2037/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2037/events", "html_url": "https://github.com/locustio/locust/issues/2037", "id": 1157857619, "node_id": "I_kwDOABUGS85FA4FT", "number": 2037, "title": "The latest docker image has a lot of vulnerabilities", "user": {"login": "tmokmss", "id": 7490655, "node_id": "MDQ6VXNlcjc0OTA2NTU=", "avatar_url": "https://avatars.githubusercontent.com/u/7490655?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmokmss", "html_url": "https://github.com/tmokmss", "followers_url": "https://api.github.com/users/tmokmss/followers", "following_url": "https://api.github.com/users/tmokmss/following{/other_user}", "gists_url": "https://api.github.com/users/tmokmss/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmokmss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmokmss/subscriptions", "organizations_url": "https://api.github.com/users/tmokmss/orgs", "repos_url": "https://api.github.com/users/tmokmss/repos", "events_url": "https://api.github.com/users/tmokmss/events{/privacy}", "received_events_url": "https://api.github.com/users/tmokmss/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1993314533, "node_id": "MDU6TGFiZWwxOTkzMzE0NTMz", "url": "https://api.github.com/repos/locustio/locust/labels/cantfix", "name": "cantfix", "color": "dddddd", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-03-03T01:11:54Z", "updated_at": "2022-03-03T08:38:41Z", "closed_at": "2022-03-03T08:38:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nWhen I run `trivy`, I get lots of finidings due to base image `debian 11.2`\r\n\r\n```\r\nlocust (debian 11.2)\r\nTotal: 100 (UNKNOWN: 5, LOW: 69, MEDIUM: 6, HIGH: 9, CRITICAL: 11)\r\n```\r\n\r\n### Expected behavior\r\nNo findings are reported.\r\n\r\n### Actual behavior\r\nThe actual findings are here: https://pastebin.pl/view/7218b865\r\n\r\n### Steps to reproduce\r\nInstall trivy and run `trivy image locustio/locust`\r\n\r\n### Environment\r\n\r\n- OS: macOS\r\n- Python version: n/a\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds) 2.8.3\r\n- Locust command line that you ran: n/a\r\n- Locust file contents (anonymized if necessary): n/a", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2037/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2037/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2036", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2036/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2036/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2036/events", "html_url": "https://github.com/locustio/locust/issues/2036", "id": 1157296082, "node_id": "I_kwDOABUGS85E-u_S", "number": 2036, "title": "Multiple resetting connection after RPCError", "user": {"login": "marcinh", "id": 6491818, "node_id": "MDQ6VXNlcjY0OTE4MTg=", "avatar_url": "https://avatars.githubusercontent.com/u/6491818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marcinh", "html_url": "https://github.com/marcinh", "followers_url": "https://api.github.com/users/marcinh/followers", "following_url": "https://api.github.com/users/marcinh/following{/other_user}", "gists_url": "https://api.github.com/users/marcinh/gists{/gist_id}", "starred_url": "https://api.github.com/users/marcinh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marcinh/subscriptions", "organizations_url": "https://api.github.com/users/marcinh/orgs", "repos_url": "https://api.github.com/users/marcinh/repos", "events_url": "https://api.github.com/users/marcinh/events{/privacy}", "received_events_url": "https://api.github.com/users/marcinh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-03-02T14:49:17Z", "updated_at": "2022-07-07T08:56:54Z", "closed_at": "2022-07-07T08:56:54Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Description\r\nWhen there is something wrong with communication master-worker (RPCError caught)), connection is being reset (new RPC server created) multiple times (actually after every heartbeat interval) until new message from worker appears. So when there is only single worker and RPCError is caught - connection is being reset infinitely.\r\n\r\n### Expected behavior\r\nAfter catching RPCError connection should be reset once\r\n\r\n### Actual behavior\r\nConnection is being reset every single second (heartbeat interval) until new message from worker arrives or new worker appears\r\n\r\n### Steps to reproduce\r\nSetup locust master + single worker, trigger RPCError communication error somehow.\r\n\r\n### Possible solution\r\nCurrently connection_reset() method in MasterRunner is called in heartbeat_worker thread when connection_broken flag is set. Once this flag is set to True connection reset bill be done in a loop until this flag is set to false (what is done in client listener thread). So the possible solution is to move setting connection_broken flag to false into connection_reset() method itself\r\n\r\n```\r\n    def reset_connection(self):\r\n        logger.info(\"Reset connection to worker\")\r\n        try:\r\n            self.server.close()\r\n            self.server = rpc.Server(self.master_bind_host, self.master_bind_port)\r\n            self.connection_broken = False\r\n        except RPCError as e:\r\n            logger.error(f\"Temporary failure when resetting connection: {e}, will retry later.\")\r\n```\r\n\r\n### Environment\r\n\r\n- OS: Centos\r\n- Python version: 3.9\r\n- Locust version: 2.8.2", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2036/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2036/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2035", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2035/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2035/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2035/events", "html_url": "https://github.com/locustio/locust/issues/2035", "id": 1156267623, "node_id": "I_kwDOABUGS85E6z5n", "number": 2035, "title": "FastHttpUser client does persist the auth headers across requests like Httpuser's client", "user": {"login": "nlazouzihc", "id": 98062855, "node_id": "U_kgDOBdhSBw", "avatar_url": "https://avatars.githubusercontent.com/u/98062855?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nlazouzihc", "html_url": "https://github.com/nlazouzihc", "followers_url": "https://api.github.com/users/nlazouzihc/followers", "following_url": "https://api.github.com/users/nlazouzihc/following{/other_user}", "gists_url": "https://api.github.com/users/nlazouzihc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nlazouzihc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nlazouzihc/subscriptions", "organizations_url": "https://api.github.com/users/nlazouzihc/orgs", "repos_url": "https://api.github.com/users/nlazouzihc/repos", "events_url": "https://api.github.com/users/nlazouzihc/events{/privacy}", "received_events_url": "https://api.github.com/users/nlazouzihc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-03-02T02:54:47Z", "updated_at": "2022-05-13T02:17:06Z", "closed_at": "2022-05-13T02:17:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "With HttpUser, i can set the `client.headers` to store auth token..etc then issue new client requests without having to specify headers in the request. something like this >>\r\n`self.client.headers = self.api_headers self.client.post(\"reports\", data=somedata, name=\"something\")`\r\n\r\nFastHttpUser on the other hand will not honor the preset headers, thus forcing me to specify the headers for every subsequent call.\r\n`self.client.post(\"reports\", data=somedata, headers=self.api_headers, name=\"something\")`\r\n\r\nThe documentation states :\r\n\r\n`This class creates a client attribute on instantiation which is an HTTP client with support for keeping a user session between requests.`\r\n\r\nSounds like a bug to me.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2035/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2035/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2029", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2029/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2029/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2029/events", "html_url": "https://github.com/locustio/locust/issues/2029", "id": 1149281618, "node_id": "I_kwDOABUGS85EgKVS", "number": 2029, "title": "Task ratio calculations in the html report are incorrect", "user": {"login": "eliezershindler", "id": 34885341, "node_id": "MDQ6VXNlcjM0ODg1MzQx", "avatar_url": "https://avatars.githubusercontent.com/u/34885341?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eliezershindler", "html_url": "https://github.com/eliezershindler", "followers_url": "https://api.github.com/users/eliezershindler/followers", "following_url": "https://api.github.com/users/eliezershindler/following{/other_user}", "gists_url": "https://api.github.com/users/eliezershindler/gists{/gist_id}", "starred_url": "https://api.github.com/users/eliezershindler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eliezershindler/subscriptions", "organizations_url": "https://api.github.com/users/eliezershindler/orgs", "repos_url": "https://api.github.com/users/eliezershindler/repos", "events_url": "https://api.github.com/users/eliezershindler/events{/privacy}", "received_events_url": "https://api.github.com/users/eliezershindler/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-02-24T13:20:06Z", "updated_at": "2022-05-08T02:16:16Z", "closed_at": "2022-05-08T02:16:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "Version: 2.8.2\r\n\r\nScenario:\r\n\r\nI have a user which extends a BaseUser, which in turn extends HttpUser, that defines 3 tasks, each with equal weighting. The static HTML file(note, not the web console), produces the following ratio results:\r\n<img width=\"491\" alt=\"image\" src=\"https://user-images.githubusercontent.com/34885341/155531002-49c37d49-8f4d-421b-8056-af8bb9c2e1f6.png\">\r\n\r\nGiven that 'SafeUserV2'  executes 100% of the requests, then the individual ratios of tasks executed by that user should add up to 100%", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2029/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2029/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2026", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2026/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2026/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2026/events", "html_url": "https://github.com/locustio/locust/issues/2026", "id": 1147137698, "node_id": "I_kwDOABUGS85EX-6i", "number": 2026, "title": "Could not find any locustfile! Ensure file ends in '.py' and see --help for available options.", "user": {"login": "Kaiser-DMr", "id": 58213021, "node_id": "MDQ6VXNlcjU4MjEzMDIx", "avatar_url": "https://avatars.githubusercontent.com/u/58213021?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Kaiser-DMr", "html_url": "https://github.com/Kaiser-DMr", "followers_url": "https://api.github.com/users/Kaiser-DMr/followers", "following_url": "https://api.github.com/users/Kaiser-DMr/following{/other_user}", "gists_url": "https://api.github.com/users/Kaiser-DMr/gists{/gist_id}", "starred_url": "https://api.github.com/users/Kaiser-DMr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Kaiser-DMr/subscriptions", "organizations_url": "https://api.github.com/users/Kaiser-DMr/orgs", "repos_url": "https://api.github.com/users/Kaiser-DMr/repos", "events_url": "https://api.github.com/users/Kaiser-DMr/events{/privacy}", "received_events_url": "https://api.github.com/users/Kaiser-DMr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-02-22T16:44:25Z", "updated_at": "2022-02-22T17:10:14Z", "closed_at": "2022-02-22T17:07:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version:\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds)\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2026/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2026/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2020", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2020/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2020/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2020/events", "html_url": "https://github.com/locustio/locust/issues/2020", "id": 1141521230, "node_id": "I_kwDOABUGS85ECjtO", "number": 2020, "title": "runner-j2nyww-s-project-33093087-concurrent-0/ERROR/locust.main: Unknown User(s):", "user": {"login": "samshuv1", "id": 99896722, "node_id": "U_kgDOBfRNkg", "avatar_url": "https://avatars.githubusercontent.com/u/99896722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/samshuv1", "html_url": "https://github.com/samshuv1", "followers_url": "https://api.github.com/users/samshuv1/followers", "following_url": "https://api.github.com/users/samshuv1/following{/other_user}", "gists_url": "https://api.github.com/users/samshuv1/gists{/gist_id}", "starred_url": "https://api.github.com/users/samshuv1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/samshuv1/subscriptions", "organizations_url": "https://api.github.com/users/samshuv1/orgs", "repos_url": "https://api.github.com/users/samshuv1/repos", "events_url": "https://api.github.com/users/samshuv1/events{/privacy}", "received_events_url": "https://api.github.com/users/samshuv1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-02-17T15:52:30Z", "updated_at": "2022-04-29T02:16:51Z", "closed_at": "2022-04-29T02:16:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "stages:\r\n   - test\r\n\r\npostman_tests:\r\n   stage: test\r\n   image:\r\n      name: python:3.9-slim\r\n      entrypoint: [\"\"]\r\n   script:\r\n      - python --version\r\n      - pip install locust\r\n      - locust -V\r\n      - pip install virtualenv\r\n      - virtualenv venv\r\n      - source venv/bin/activate\r\n      - locust -f app.py --headless -u 1 -r 1 -t 10s --print-stats --csv Run1.csv --csv-full-history -- host\r\nplease let me know how to fix this, im new to this\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2020/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2020/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2018", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2018/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2018/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2018/events", "html_url": "https://github.com/locustio/locust/issues/2018", "id": 1139658483, "node_id": "I_kwDOABUGS85D7c7z", "number": 2018, "title": "In the case of Web mode and users greater than 1, the chart still adds data after using the quit () method", "user": {"login": "1031089692", "id": 34932578, "node_id": "MDQ6VXNlcjM0OTMyNTc4", "avatar_url": "https://avatars.githubusercontent.com/u/34932578?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1031089692", "html_url": "https://github.com/1031089692", "followers_url": "https://api.github.com/users/1031089692/followers", "following_url": "https://api.github.com/users/1031089692/following{/other_user}", "gists_url": "https://api.github.com/users/1031089692/gists{/gist_id}", "starred_url": "https://api.github.com/users/1031089692/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1031089692/subscriptions", "organizations_url": "https://api.github.com/users/1031089692/orgs", "repos_url": "https://api.github.com/users/1031089692/repos", "events_url": "https://api.github.com/users/1031089692/events{/privacy}", "received_events_url": "https://api.github.com/users/1031089692/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2022-02-16T07:56:28Z", "updated_at": "2022-04-29T02:16:52Z", "closed_at": "2022-04-29T02:16:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nWhen the requested data is limited, I will actively call quit () to exit after the number of requests is completed.\r\nHowever, in the web mode, and when the user setting is greater than 1,  the chart still adds data after using the quit () method\r\n```\r\nclass Task(TaskSet):\r\n\r\n    @task(1)\r\n    def check(self):\r\n        line = self.user.queueData.get()\r\n        if line is not None:\r\n            with self.client.post(\"/Issue/\", headers={\"Authorization\": Authorization}, catch_response=True,\r\n                                  verify=False,\r\n                                  name=\"check\") as response:\r\n                if response.status_code == 200:\r\n                    response.success()\r\n                else:\r\n                    response.failure(f'Failed! {response.text}')\r\n        else:\r\n            logging.info(\"The queue data has been used up\uff5e\uff5e\uff5e\")\r\n            self.user.environment.runner.quit()\r\n\r\n\r\nclass websitUser(HttpUser):\r\n    tasks = [Task]\r\n    host = \"http://127.0.0.1:8080/\"\r\n    wait_time = between(0, 0)\r\n    queueData = queue.Queue()\r\n    file_handle = open('mock_list', mode='r')\r\n    for line in file_handle:\r\n        queueData.put(line)\r\n    queueData.put(None)\r\n```\r\n\r\n![E1BCD074AC736B1F3634FE59EB5CC0D9](https://user-images.githubusercontent.com/34932578/154219355-83216f73-c27b-410e-a935-9afc292f025b.jpg)\r\n\r\nshown in the image above\uff0cquit () has cleared the user, but the chart is still adding data statistics. This will cause the abscissa of the chart to be inconsistent with the actual test time\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nStop statistics after using quit()\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nthe chart still adds data after using the quit () method\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n1\u3001In the task method, the quit () method is called when the number of requests reaches\r\n2\u3001Start the locust service using web mode\r\n3\u3001The number of users is set to be greater than 1\r\n### Environment\r\n\r\n- OS:mac 10.15.7\r\n- Python version:3.7.0\r\n- Locust version: 2.5.0\r\n- Locust command line that you ran:locust -f link_test.py --stop-timeout 10\r\n- Locust file contents (anonymized if necessary)shown in the image above\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2018/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2018/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2017", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2017/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2017/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2017/events", "html_url": "https://github.com/locustio/locust/issues/2017", "id": 1137639643, "node_id": "I_kwDOABUGS85DzwDb", "number": 2017, "title": "CSV report in Chinese and not English", "user": {"login": "lisenet", "id": 8998418, "node_id": "MDQ6VXNlcjg5OTg0MTg=", "avatar_url": "https://avatars.githubusercontent.com/u/8998418?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lisenet", "html_url": "https://github.com/lisenet", "followers_url": "https://api.github.com/users/lisenet/followers", "following_url": "https://api.github.com/users/lisenet/following{/other_user}", "gists_url": "https://api.github.com/users/lisenet/gists{/gist_id}", "starred_url": "https://api.github.com/users/lisenet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lisenet/subscriptions", "organizations_url": "https://api.github.com/users/lisenet/orgs", "repos_url": "https://api.github.com/users/lisenet/repos", "events_url": "https://api.github.com/users/lisenet/events{/privacy}", "received_events_url": "https://api.github.com/users/lisenet/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2022-02-14T17:48:13Z", "updated_at": "2022-02-16T19:02:05Z", "closed_at": "2022-02-16T17:58:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\nWhen requesting statistics CSV download (http://127.0.0.1:8089/stats/requests/csv), the report is in Chinese and not English.\r\n\r\n### Expected behavior\r\nReport in English.\r\n\r\n### Actual behavior\r\nGenerated report CSV is in Chinese.\r\n\r\n### Steps to reproduce\r\n\r\nStart locust, run any test, click on the \"Download Data\" tab, choose \"Download request statistics CSV\".\r\n\r\n### Environment\r\n\r\n- OS: Ubuntu 18.04 LTS\r\n- Python version: 3.6.9\r\n- Locust version: 2.8.1\r\n- Locust command line that you ran: locust\r\n- Locust file contents (anonymized if necessary):\r\n\r\n```\r\nimport time\r\nfrom locust import HttpUser, task, between, constant\r\n\r\nclass QuickstartUser(HttpUser):\r\n    wait_time = between(1, 5)\r\n\r\n    @task\r\n    def view_items(self):\r\n        self.client.get(\"/administer-site.htm\")\r\n        self.client.get(\"/documentPack.htm?documentPackId=1\")\r\n        self.client.get(\"/documentPack.htm?documentPackId=2\")\r\n        wait_time = constant(1)\r\n\r\n    def on_start(self):\r\n        self.client.post(\"/login.htm\", json={\"username\":\"redacted\", \"password\":\"redacted\"})\r\n\r\n    def on_stop(self):\r\n        self.client.post(\"/login.htm?action=signOut\")\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2017/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2017/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2015", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2015/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2015/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2015/events", "html_url": "https://github.com/locustio/locust/issues/2015", "id": 1137074680, "node_id": "I_kwDOABUGS85DxmH4", "number": 2015, "title": "Issue to install python libraries inside locust container when using the locust docker image version 2.8.1", "user": {"login": "teixeira-fernando", "id": 32043860, "node_id": "MDQ6VXNlcjMyMDQzODYw", "avatar_url": "https://avatars.githubusercontent.com/u/32043860?v=4", "gravatar_id": "", "url": "https://api.github.com/users/teixeira-fernando", "html_url": "https://github.com/teixeira-fernando", "followers_url": "https://api.github.com/users/teixeira-fernando/followers", "following_url": "https://api.github.com/users/teixeira-fernando/following{/other_user}", "gists_url": "https://api.github.com/users/teixeira-fernando/gists{/gist_id}", "starred_url": "https://api.github.com/users/teixeira-fernando/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/teixeira-fernando/subscriptions", "organizations_url": "https://api.github.com/users/teixeira-fernando/orgs", "repos_url": "https://api.github.com/users/teixeira-fernando/repos", "events_url": "https://api.github.com/users/teixeira-fernando/events{/privacy}", "received_events_url": "https://api.github.com/users/teixeira-fernando/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-02-14T10:14:52Z", "updated_at": "2022-02-14T11:08:40Z", "closed_at": "2022-02-14T11:01:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nWhen I started to use the latest 2.8.1 locust docker image, I had some issues when trying to install other python libraries inside the container, with my own Dockerfile. When I used the version 2.7.3, everything worked fine.\r\n\r\nThe error that is returned says that there is a permission issue in the installation process: \r\n```\r\n[2022-02-14T08:04:31.832Z] ERROR: Could not install packages due to an OSError: [Errno 13] Permission denied: '/opt/venv/lib/python3.9/site-packages/dotenv'\r\n```\r\n\r\n### Expected behavior\r\nWe should be able to install other python libraries inside the locust container using the pip command. \r\n\r\n### Actual behavior\r\n```\r\n[2022-02-14T08:04:17.739Z] + docker-compose up --scale worker=4 --force-recreate --exit-code-from=master\r\n[2022-02-14T08:04:18.003Z] /usr/lib/python2.7/site-packages/requests/__init__.py:91: RequestsDependencyWarning: urllib3 (1.25.3) or chardet (2.2.1) doesn't match a supported version!\r\n[2022-02-14T08:04:18.003Z]   RequestsDependencyWarning)\r\n[2022-02-14T08:04:18.952Z] using --exit-code-from implies --abort-on-container-exit\r\n[2022-02-14T08:04:18.952Z] Creating network \"loadtest_default\" with the default driver\r\n[2022-02-14T08:04:18.952Z] Building worker\r\n[2022-02-14T08:04:19.214Z] Step 1/4 : FROM locustio/locust\r\n[2022-02-14T08:04:20.611Z] latest: Pulling from locustio/locust\r\n[2022-02-14T08:04:30.628Z] Digest: sha256:8a5ee67f76fa08fbf1126be514d2d11a9dd580d2168815edf26e55d0d5014e65\r\n[2022-02-14T08:04:30.628Z] Status: Downloaded newer image for locustio/locust:latest\r\n[2022-02-14T08:04:30.628Z]  ---> 4f8ce510a092\r\n[2022-02-14T08:04:30.628Z] Step 2/4 : RUN pip3 install python-dotenv\r\n[2022-02-14T08:04:30.628Z]  ---> Running in 8cc93894c9be\r\n[2022-02-14T08:04:31.569Z] Collecting python-dotenv\r\n[2022-02-14T08:04:31.569Z]   Downloading python_dotenv-0.19.2-py2.py3-none-any.whl (17 kB)\r\n[2022-02-14T08:04:31.832Z] Installing collected packages: python-dotenv\r\n[2022-02-14T08:04:31.832Z] ERROR: Could not install packages due to an OSError: [Errno 13] Permission denied: '/opt/venv/lib/python3.9/site-packages/dotenv'\r\n[2022-02-14T08:04:31.832Z] Check the permissions.\r\n[2022-02-14T08:04:31.832Z] \r\n[2022-02-14T08:04:32.094Z] WARNING: You are using pip version 21.2.4; however, version 22.0.3 is available.\r\n[2022-02-14T08:04:32.094Z] You should consider upgrading via the '/opt/venv/bin/python -m pip install --upgrade pip' command.\r\n[2022-02-14T08:04:32.358Z] Service 'worker' failed to build: The command '/bin/sh -c pip3 install python-dotenv' returned a non-zero code: 1\r\n```\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\nThis is my Docker file that I used to reproduce the error:\r\n\r\n```\r\nFROM locustio/locust\r\nRUN pip3 install python-dotenv\r\nRUN pip3 install locust-plugins\r\n```\r\n\r\nIf you try to build it, it will take the latest version 2.8.1, and the error described above will happen.\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: Windows 10 Enterprise (OS build 19042.1466)\r\n- Python version: Not applicable\r\n- Locust version: 2.8.1", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2015/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2015/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2008", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2008/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2008/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2008/events", "html_url": "https://github.com/locustio/locust/issues/2008", "id": 1132732899, "node_id": "I_kwDOABUGS85DhCHj", "number": 2008, "title": "Load being distributed to missing workers too Version 2.7.4.dev14", "user": {"login": "radhakrishnaakamat", "id": 40797434, "node_id": "MDQ6VXNlcjQwNzk3NDM0", "avatar_url": "https://avatars.githubusercontent.com/u/40797434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/radhakrishnaakamat", "html_url": "https://github.com/radhakrishnaakamat", "followers_url": "https://api.github.com/users/radhakrishnaakamat/followers", "following_url": "https://api.github.com/users/radhakrishnaakamat/following{/other_user}", "gists_url": "https://api.github.com/users/radhakrishnaakamat/gists{/gist_id}", "starred_url": "https://api.github.com/users/radhakrishnaakamat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/radhakrishnaakamat/subscriptions", "organizations_url": "https://api.github.com/users/radhakrishnaakamat/orgs", "repos_url": "https://api.github.com/users/radhakrishnaakamat/repos", "events_url": "https://api.github.com/users/radhakrishnaakamat/events{/privacy}", "received_events_url": "https://api.github.com/users/radhakrishnaakamat/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2022-02-11T15:13:48Z", "updated_at": "2022-02-14T03:57:04Z", "closed_at": "2022-02-13T18:51:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "When running Locust in a distributed mode in Kubernetes, if the pod restarts then the worker status gets changed to missing. I can see that  spawning distributes the users equally to all workers, but in this case it distributes to missing workers as well which leads to reduced spwaning rate.\r\nKindly help!!\r\nI have made some changes by adding Kubernetes support natively, have shared the details in slack channel. kindly suggest on how we can take this further.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2008/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2008/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2006", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2006/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2006/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2006/events", "html_url": "https://github.com/locustio/locust/issues/2006", "id": 1131640634, "node_id": "I_kwDOABUGS85Dc3c6", "number": 2006, "title": "error: ambiguous option: --expect-worker could match --expect-workers, --expect-workers-max-wait", "user": {"login": "hdzys", "id": 45445106, "node_id": "MDQ6VXNlcjQ1NDQ1MTA2", "avatar_url": "https://avatars.githubusercontent.com/u/45445106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hdzys", "html_url": "https://github.com/hdzys", "followers_url": "https://api.github.com/users/hdzys/followers", "following_url": "https://api.github.com/users/hdzys/following{/other_user}", "gists_url": "https://api.github.com/users/hdzys/gists{/gist_id}", "starred_url": "https://api.github.com/users/hdzys/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hdzys/subscriptions", "organizations_url": "https://api.github.com/users/hdzys/orgs", "repos_url": "https://api.github.com/users/hdzys/repos", "events_url": "https://api.github.com/users/hdzys/events{/privacy}", "received_events_url": "https://api.github.com/users/hdzys/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-02-11T03:55:13Z", "updated_at": "2022-02-11T07:40:28Z", "closed_at": "2022-02-11T06:59:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nlocust -f D:\\ProgramFiles\\cover_app_platform\\app\\file_upload\\ios_live\\20211020-192356\\ios_live.py  --master  --master-bind-port 9800 --headless -u 10 -r 2 --expect-worker 2 --expect-workers-max-wait 1 -t 10s -s 10 \r\nlocust: error: ambiguous option: --expect-worker could match --expect-workers, --expect-workers-max-wait\r\nso~\r\n--expect-worker\r\n--expect-workers-max-wait \r\nAre these two parameters used in this way\uff1f\r\n\r\n### Environment\r\n\r\n- OS: windows 10 \r\n- Python version:  Python 3.7.4\r\n- Locust version:  locust 2.7.3\r\n- Locust command line that you ran: locust -f D:\\ProgramFiles\\cover_app_platform\\app\\file_upload\\ios_live\\20211020-192356\\ios_live.py  --master  --master-bind-port 9800 --headless -u 10 -r 2 --expect-worker 2 --expect-workers-max-wait 1 -t 10s -s 10 \r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2006/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2006/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/2002", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/2002/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/2002/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/2002/events", "html_url": "https://github.com/locustio/locust/issues/2002", "id": 1127808743, "node_id": "I_kwDOABUGS85DOP7n", "number": 2002, "title": "Hi My scripts have started to fail with the same error as below, was fine until last week", "user": {"login": "Newbie112222", "id": 51801670, "node_id": "MDQ6VXNlcjUxODAxNjcw", "avatar_url": "https://avatars.githubusercontent.com/u/51801670?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Newbie112222", "html_url": "https://github.com/Newbie112222", "followers_url": "https://api.github.com/users/Newbie112222/followers", "following_url": "https://api.github.com/users/Newbie112222/following{/other_user}", "gists_url": "https://api.github.com/users/Newbie112222/gists{/gist_id}", "starred_url": "https://api.github.com/users/Newbie112222/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Newbie112222/subscriptions", "organizations_url": "https://api.github.com/users/Newbie112222/orgs", "repos_url": "https://api.github.com/users/Newbie112222/repos", "events_url": "https://api.github.com/users/Newbie112222/events{/privacy}", "received_events_url": "https://api.github.com/users/Newbie112222/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-02-08T22:06:54Z", "updated_at": "2022-02-09T21:25:01Z", "closed_at": "2022-02-09T21:25:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi All,\r\nAll my scripts have started failing with the same error as below. This was working fine until last week and no changes have been made to the script. Also 0 requests are being sent.\r\n\r\nError:\r\n Error: [2022-02-08 21:48:28,739] xxxxx.internal/ERROR/locust.user.task: [Errno Expecting value] : 0\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.7/site-packages/requests/models.py\", line 910, in json\r\n    return complexjson.loads(self.text, **kwargs)\r\n  File \"/usr/lib64/python3.7/site-packages/simplejson/__init__.py\", line 488, in loads\r\n    return _default_decoder.decode(s)\r\n  File \"/usr/lib64/python3.7/site-packages/simplejson/decoder.py\", line 374, in decode\r\n    obj, end = self.raw_decode(s)\r\n  File \"/usr/lib64/python3.7/site-packages/simplejson/decoder.py\", line 393, in raw_decode\r\n    return self.scan_once(s, idx=_w(s, idx).end())\r\nsimplejson.scanner.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.7/site-packages/locust/user/task.py\", line 296, in run\r\n    self.execute_next_task()\r\n  File \"/usr/local/lib/python3.7/site-packages/locust/user/task.py\", line 321, in execute_next_task\r\n    self.execute_task(self._task_queue.pop(0))\r\n  File \"/usr/local/lib/python3.7/site-packages/locust/user/task.py\", line 434, in execute_task\r\n    task(self.user)\r\n  File \"/usr/local/Locust/Scripts/test.py\", line 19, in launch_URL\r\n    if (\"Accounts\") in response.json():\r\n  File \"/usr/local/lib/python3.7/site-packages/requests/models.py\", line 917, in json\r\n    raise RequestsJSONDecodeError(e.msg, e.doc, e.pos)\r\nrequests.exceptions.JSONDecodeError: [Errno Expecting value] : 0\r\n\r\n\r\n- OS: Amazon Linux 2 (ec2 instance)\r\n- Python version: Python 3.7.9\r\n- Locust version: locust 2.7.3\r\n- Locust command line that you ran:\r\nlocust -f test.py --headless -u 1 -r 1 --run-time 45 --html=test1.html\r\n\r\nLocust file contents (anonymized if necessary):\r\n\r\n\r\n\r\nfrom locust import HttpUser,task, between, constant\r\n\r\nclass UserBehavior(HttpUser):\r\n    wait_time=constant(1)\r\n    host=\"https://google.com\"\r\n\r\n    @task\r\n    def launch_URL(self):\r\n        token = \"XXXXXXX\"\r\n\r\n        headers={\r\n        \"Content-Type\":\"application/json\",\r\n        \"Authorization\":\"Bearer \" + token,\r\n        \"id\":\"test_test\"}\r\n\r\n        with self.client.get(\"/maps\",headers=headers,catch_response=True) as response:\r\n        #print(response.json())\r\n        #Passing the request after validating the response from API\r\n            if (\"Accounts\") in response.json():\r\n                if response.status_code == 200:\r\n                    response.success()\r\n                else:\r\n                    response.failure(\"HTTP 200OK not received\")\r\n            else:\r\n                response.failure(\"Valid response not returned\")\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/2002/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/2002/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1998", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1998/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1998/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1998/events", "html_url": "https://github.com/locustio/locust/issues/1998", "id": 1124390912, "node_id": "I_kwDOABUGS85DBNgA", "number": 1998, "title": "Stats CSV is overwritten on autoquit", "user": {"login": "jjrm", "id": 11521672, "node_id": "MDQ6VXNlcjExNTIxNjcy", "avatar_url": "https://avatars.githubusercontent.com/u/11521672?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jjrm", "html_url": "https://github.com/jjrm", "followers_url": "https://api.github.com/users/jjrm/followers", "following_url": "https://api.github.com/users/jjrm/following{/other_user}", "gists_url": "https://api.github.com/users/jjrm/gists{/gist_id}", "starred_url": "https://api.github.com/users/jjrm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jjrm/subscriptions", "organizations_url": "https://api.github.com/users/jjrm/orgs", "repos_url": "https://api.github.com/users/jjrm/repos", "events_url": "https://api.github.com/users/jjrm/events{/privacy}", "received_events_url": "https://api.github.com/users/jjrm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-02-04T16:31:25Z", "updated_at": "2022-02-07T19:15:24Z", "closed_at": "2022-02-07T12:45:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n### Describe the bug\r\nThe Stats CSV is overwritten with just the header information after the locust process exits.  Prior to the process exiting, the Stats CSV contain the proper information (see screenshots below).  Before Autoquit, the size of results_stats.csv is 471B, after it is down to 290B.  Upon inspection, the CSV is overwritten with just the header information.\r\n\r\nPrior to Autoquit\r\n![image](https://user-images.githubusercontent.com/11521672/152565144-94c0bef7-fafc-47b1-9bd6-89a86a20b9fc.png)\r\n\r\nAfter Autoquit\r\n![image](https://user-images.githubusercontent.com/11521672/152565256-a61f1bee-6a0f-4bac-b71f-431c738416ef.png)\r\n\r\n### Expected behavior\r\nStats CSV should not be overwritten.\r\n\r\n### Actual behavior\r\nStats CSV is overwritten.\r\n\r\n### Steps to reproduce\r\nDeploy Locust test using the Delivery Hero Helm charts.\r\n\r\n### Environment\r\nUsing Delivery Hero Helm Charts for Locust (AKS)\r\n\r\n```\r\nimage:\r\n  tag: \"2.7.2\"\r\n\r\nmaster:\r\n  args: [\"--autostart\", \"--autoquit\", \"180\", \"-u\", \"1\", \"-r\", \"1\", \"-t\", \"120s\", \"--expect-workers\", \"1\", \"--csv\", \"/mnt/locust/results/results\"]\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1998/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1998/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1995", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1995/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1995/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1995/events", "html_url": "https://github.com/locustio/locust/issues/1995", "id": 1123400030, "node_id": "I_kwDOABUGS85C9ble", "number": 1995, "title": "locust:2.7.1 exits when clicking \"Stop Tests\" in the UI", "user": {"login": "fluxx-sleblanc", "id": 54335701, "node_id": "MDQ6VXNlcjU0MzM1NzAx", "avatar_url": "https://avatars.githubusercontent.com/u/54335701?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fluxx-sleblanc", "html_url": "https://github.com/fluxx-sleblanc", "followers_url": "https://api.github.com/users/fluxx-sleblanc/followers", "following_url": "https://api.github.com/users/fluxx-sleblanc/following{/other_user}", "gists_url": "https://api.github.com/users/fluxx-sleblanc/gists{/gist_id}", "starred_url": "https://api.github.com/users/fluxx-sleblanc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fluxx-sleblanc/subscriptions", "organizations_url": "https://api.github.com/users/fluxx-sleblanc/orgs", "repos_url": "https://api.github.com/users/fluxx-sleblanc/repos", "events_url": "https://api.github.com/users/fluxx-sleblanc/events{/privacy}", "received_events_url": "https://api.github.com/users/fluxx-sleblanc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-02-03T18:06:21Z", "updated_at": "2022-02-03T20:17:28Z", "closed_at": "2022-02-03T20:15:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nWhen using the 2.7.1 docker image, locust exits with code 0 upon clicking \"Stop Tests\" in the UI. \r\nWe swapped in 2.7.0 with the same locustfile and config, and the problem was fixed.\r\n\r\n### Expected behavior\r\nLocust should continue running (as it does in 2.7.0) after clicking \"Stop Tests\". \r\n\r\n### Actual behavior\r\nCannot run multiple tests, as after each test locust exits, therefore we can't compare results from previous runs.\r\n\r\n### Steps to reproduce\r\n\r\n1. Run locust:2.7.1 docker image\r\n2. Browse to the UI\r\n3. Start tests\r\n4. Stop tests\r\n5. Observe that locust has exited\r\n\r\n### Environment\r\n\r\n- OS:  locustio:locust:2.7.1 docker image\r\n- Python version: 3.9 (locustio:locust:2.7.1 docker image)\r\n- Locust version: 2.7.1\r\n- Locust command line that you ran: `locust --config=/home/locust/master.conf`\r\n- Locust file contents (anonymized if necessary):\r\n\r\n```\r\nimport time\r\nimport os\r\nfrom locust import HttpUser, FastHttpUser, task, events\r\nfrom locust.runners import MasterRunner\r\nfrom kubernetes import client, config\r\nfrom kubernetes.stream import stream\r\n\r\n\r\nAPI_TOKEN = \"\"  # currently not used\r\n\r\n\r\n# Basic requests that sleep - for testing queue latency with Puma\r\nclass SleepUser(FastHttpUser):\r\n    network_timeout = 300\r\n\r\n    @task(3)\r\n    def sleep_one(self):\r\n        self.client.get(\"/sleep?time=1\", verify=False)\r\n\r\n    @task(2)\r\n    def sleep_five(self):\r\n        self.client.get(\"/sleep?time=5\", verify=False)\r\n\r\n    @task(5)\r\n    def sleep_half(self):\r\n        self.client.get(\"/sleep?time=0.5\", verify=False)\r\n\r\n    @task(1)\r\n    def sleep_thirty(self):\r\n        self.client.get(\"/sleep?time=30\", verify=False)\r\n\r\n\r\n# Hook that runs when locust starts\r\n@events.test_start.add_listener\r\ndef on_test_start(environment, **kwargs):\r\n    print(\"Starting on_test_start hook\")\r\n    generate_api_token_script = # removed\r\n    success, output = execute_on_app_pod(generate_api_token_script)\r\n    global API_TOKEN\r\n    API_TOKEN = [line for line in output.split('\\n') if 'PERFAPITOKEN:' in line][1].replace('PERFAPITOKEN:', '')\r\n\r\n\r\ndef execute_on_app_pod(command):\r\n    # removed - function that executes commands on an in-cluster k8s pod\r\n```\r\n\r\nlocust conf:\r\n```\r\nusers = 100\r\nspawn-rate = 10\r\nweb-host: *\r\nweb-port: 8089\r\n```\r\n\r\nenv vars:\r\nLOCUST_HOST= # url we're testing\r\nLOCUST_LOCUSTFILE=/home/locust/locustfile.py\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1995/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1995/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1987", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1987/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1987/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1987/events", "html_url": "https://github.com/locustio/locust/issues/1987", "id": 1116704309, "node_id": "I_kwDOABUGS85Cj441", "number": 1987, "title": "Documentation Update Centos Python Dependencies", "user": {"login": "r1ddl3", "id": 36551465, "node_id": "MDQ6VXNlcjM2NTUxNDY1", "avatar_url": "https://avatars.githubusercontent.com/u/36551465?v=4", "gravatar_id": "", "url": "https://api.github.com/users/r1ddl3", "html_url": "https://github.com/r1ddl3", "followers_url": "https://api.github.com/users/r1ddl3/followers", "following_url": "https://api.github.com/users/r1ddl3/following{/other_user}", "gists_url": "https://api.github.com/users/r1ddl3/gists{/gist_id}", "starred_url": "https://api.github.com/users/r1ddl3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/r1ddl3/subscriptions", "organizations_url": "https://api.github.com/users/r1ddl3/orgs", "repos_url": "https://api.github.com/users/r1ddl3/repos", "events_url": "https://api.github.com/users/r1ddl3/events{/privacy}", "received_events_url": "https://api.github.com/users/r1ddl3/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901882, "node_id": "MDU6TGFiZWwxNjM1OTAxODgy", "url": "https://api.github.com/repos/locustio/locust/labels/wontfix", "name": "wontfix", "color": "ddcccc", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-01-27T20:24:50Z", "updated_at": "2022-01-29T13:28:06Z", "closed_at": "2022-01-29T13:28:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nIf you try and install using the recommended \"pip3 install locust\" on Centos 7 (and 8 as far as I can tell) the install fails. You need to make sure you have \"gcc\" and \"python3-devel\" installed first and then do \"pip3 install locust --user\"\r\n\r\n### Environment\r\n\r\n- OS: Centos 7/8\r\n- Python version: 3.6\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds)\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1987/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1987/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1986", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1986/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1986/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1986/events", "html_url": "https://github.com/locustio/locust/issues/1986", "id": 1116128138, "node_id": "I_kwDOABUGS85ChsOK", "number": 1986, "title": "`test_start` event triggered multiple times on workers", "user": {"login": "jacksmith15", "id": 22217353, "node_id": "MDQ6VXNlcjIyMjE3MzUz", "avatar_url": "https://avatars.githubusercontent.com/u/22217353?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jacksmith15", "html_url": "https://github.com/jacksmith15", "followers_url": "https://api.github.com/users/jacksmith15/followers", "following_url": "https://api.github.com/users/jacksmith15/following{/other_user}", "gists_url": "https://api.github.com/users/jacksmith15/gists{/gist_id}", "starred_url": "https://api.github.com/users/jacksmith15/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jacksmith15/subscriptions", "organizations_url": "https://api.github.com/users/jacksmith15/orgs", "repos_url": "https://api.github.com/users/jacksmith15/repos", "events_url": "https://api.github.com/users/jacksmith15/events{/privacy}", "received_events_url": "https://api.github.com/users/jacksmith15/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2022-01-27T12:03:06Z", "updated_at": "2022-04-13T06:00:11Z", "closed_at": "2022-04-13T06:00:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n\r\nWhen running locust in distributed mode, the `test_start` handler gets triggered every time new users are spawned, rather than once running once at the start of the test.\r\n\r\nThis only seems to occur if there is a `test_start` handler which takes longer than the interval between spawn events (I think 1s?).\r\n\r\nThis is problematic if the test needs to load test data from an external source and share it between the users.\r\n\r\nTo give an example of a concrete use case:\r\n- I want the test to access load logs from an external source and replay them.\r\n- These logs are valid for the lifetime of a test (rather than process or user) - so they can be shared between users on a worker.\r\n- When I trigger the test the log data-store gets hammered by duplicated requests (load testing the wrong thing! :sweat_smile:).\r\n\r\n### Expected behavior\r\n\r\nThe `test_start` event handlers should be triggered once when the test begins, allowing e.g. expensive test data loading operations to occur only once.\r\n\r\n### Actual behavior\r\n\r\nThe `test_start` event handlers are triggered multiple times, with all but the final handler being killed prematurely.\r\n\r\n### Steps to reproduce\r\n\r\nGiven the following locustfile:\r\n\r\n```python\r\nimport time\r\n\r\nfrom locust import HttpUser, events, runners, task\r\n\r\n\r\nCOUNT = 0\r\n\r\n@events.test_start.add_listener\r\ndef test_start_worker(environment, **kwargs):\r\n    if not isinstance(environment.runner, runners.WorkerRunner):\r\n        return\r\n    global COUNT\r\n    COUNT += 1\r\n    print(f\"'test_start' triggered {COUNT} times.\")\r\n    time.sleep(1)  # Same result with `gevent.sleep`. Less than 1 second works fine, >=1 second causes the described behaviour.\r\n\r\n\r\nclass HelloWorldUser(HttpUser):\r\n    @task\r\n    def hello_world(self):\r\n        self.client.get(\"/hello\")\r\n        self.client.get(\"/world\")\r\n```\r\n\r\nAnd the following `docker-compose.yml`\r\n```yaml\r\nversion: '3'\r\n\r\nservices:\r\n  master:\r\n    image: locustio/locust:2.5.1\r\n    ports:\r\n    - \"8089:8089\"\r\n    volumes:\r\n    - ./:/mnt/locust\r\n    command: -f /mnt/locust/locustfile.py --master -H http://master:8089 --headless -u 10 -r 1 --run-time 1m --expect-workers 1\r\n\r\n  worker:\r\n    image: locustio/locust:2.5.1\r\n    volumes:\r\n    - ./:/mnt/locust\r\n    command: -f /mnt/locust/locustfile.py --worker --master-host master\r\n```\r\n\r\nRun\r\n```shell\r\ndocker-compose up -d\r\n```\r\n\r\nAnd the logs for the worker will display:\r\n\r\n```\r\nworker_1  | [2022-01-27 11:56:19,677] 26ff2afeca30/INFO/locust.main: Starting Locust 2.5.1\r\nworker_1  | 'test_start' triggered 1 times.\r\nworker_1  | 'test_start' triggered 2 times.\r\nworker_1  | 'test_start' triggered 3 times.\r\nworker_1  | 'test_start' triggered 4 times.\r\nworker_1  | 'test_start' triggered 5 times.\r\nworker_1  | 'test_start' triggered 6 times.\r\nworker_1  | 'test_start' triggered 7 times.\r\nworker_1  | 'test_start' triggered 8 times.\r\nworker_1  | 'test_start' triggered 9 times.\r\nworker_1  | 'test_start' triggered 10 times.\r\n```\r\n\r\n### Environment\r\n\r\n- OS: Ubuntu 21.10\r\n- Python version: 3.9.9\r\n- Locust version: 2.5.1\r\n- Locust command line that you ran: As described by `docker-compose.yml`\r\n- Locust file contents (anonymized if necessary): Shown above\r\n- docker-compose version 1.27.4\r\n- Docker version 20.10.7", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1986/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1986/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1984", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1984/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1984/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1984/events", "html_url": "https://github.com/locustio/locust/issues/1984", "id": 1115773724, "node_id": "I_kwDOABUGS85CgVsc", "number": 1984, "title": "Response time graph does not work for distributed configuration", "user": {"login": "hmliu6", "id": 25401850, "node_id": "MDQ6VXNlcjI1NDAxODUw", "avatar_url": "https://avatars.githubusercontent.com/u/25401850?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hmliu6", "html_url": "https://github.com/hmliu6", "followers_url": "https://api.github.com/users/hmliu6/followers", "following_url": "https://api.github.com/users/hmliu6/following{/other_user}", "gists_url": "https://api.github.com/users/hmliu6/gists{/gist_id}", "starred_url": "https://api.github.com/users/hmliu6/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hmliu6/subscriptions", "organizations_url": "https://api.github.com/users/hmliu6/orgs", "repos_url": "https://api.github.com/users/hmliu6/repos", "events_url": "https://api.github.com/users/hmliu6/events{/privacy}", "received_events_url": "https://api.github.com/users/hmliu6/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901882, "node_id": "MDU6TGFiZWwxNjM1OTAxODgy", "url": "https://api.github.com/repos/locustio/locust/labels/wontfix", "name": "wontfix", "color": "ddcccc", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-01-27T04:54:59Z", "updated_at": "2022-03-28T11:43:30Z", "closed_at": "2022-03-19T06:19:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nThe response time graph is only available for first few seconds, and shows no data afterward.\r\nThe statistics page shows that all response time data are normal.\r\nThe JSON returned from master shows that the current_response_time_xxxx fields are in **null**\r\n\r\nThe symptome looks exactly the same as this old issue https://github.com/locustio/locust/issues/1182\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nThe response time should keep displaying and not in no data.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n![locust-chart](https://user-images.githubusercontent.com/25401850/151294017-5156502a-ff4a-4932-9935-798236a2fa4a.png)\r\n![locust-stat](https://user-images.githubusercontent.com/25401850/151294029-df93760f-8a0f-434f-8e62-5e48887226ac.png)\r\n![locust-stat-requests](https://user-images.githubusercontent.com/25401850/151294032-b861224c-18a1-4e1d-9a54-b353738d875f.png)\r\n\r\nNo explicit error log or exception found on the locust master log and also the browser console log.\r\n![locust-master-log](https://user-images.githubusercontent.com/25401850/151294312-5220fba7-f5f5-481f-bb8d-5498c83f63af.png)\r\n![broswer-console](https://user-images.githubusercontent.com/25401850/151294326-7fc66fed-fde2-4323-ba4b-5646492f5b8e.png)\r\n\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\nUpdate locust to latest version\r\nDeploy in master workers configuration on kubernetes\r\n\r\n### Environment\r\n\r\n- OS: Centos 7\r\n- Python version: Python 3.6.8\r\n- Locust version: 2.6.0", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1984/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1984/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1981", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1981/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1981/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1981/events", "html_url": "https://github.com/locustio/locust/issues/1981", "id": 1112898897, "node_id": "I_kwDOABUGS85CVX1R", "number": 1981, "title": "Error when executing Environment.runner.start_shape", "user": {"login": "linhngocle2000", "id": 62800032, "node_id": "MDQ6VXNlcjYyODAwMDMy", "avatar_url": "https://avatars.githubusercontent.com/u/62800032?v=4", "gravatar_id": "", "url": "https://api.github.com/users/linhngocle2000", "html_url": "https://github.com/linhngocle2000", "followers_url": "https://api.github.com/users/linhngocle2000/followers", "following_url": "https://api.github.com/users/linhngocle2000/following{/other_user}", "gists_url": "https://api.github.com/users/linhngocle2000/gists{/gist_id}", "starred_url": "https://api.github.com/users/linhngocle2000/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/linhngocle2000/subscriptions", "organizations_url": "https://api.github.com/users/linhngocle2000/orgs", "repos_url": "https://api.github.com/users/linhngocle2000/repos", "events_url": "https://api.github.com/users/linhngocle2000/events{/privacy}", "received_events_url": "https://api.github.com/users/linhngocle2000/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-01-24T16:52:49Z", "updated_at": "2022-04-05T02:05:52Z", "closed_at": "2022-04-05T02:05:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nI'm using locust as library and experimenting with custom load shape.\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nLoad increasing by 10 users every 30 seconds.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nThe following error is shown when I run the code:\r\n```\r\n  File \"\\path_to_locustfile\", line 44, in <module>\r\n    env.runner.start_shape()\r\n  File \"\\path_to_file\\locust\\runners.py\", line 384, in start_shape\r\n    self.environment.shape_class.reset_time()\r\nTypeError: reset_time() missing 1 required positional argument: 'self'\r\n```\r\n\r\n```\r\n  File \"\\path_to_file\\locust\\runners.py\", line 389, in shape_worker\r\n    new_state = self.environment.shape_class.tick()\r\nTypeError: tick() missing 1 required positional argument: 'self'\r\n```\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\nThis is my code:\r\n```\r\nimport gevent\r\nimport math\r\nfrom locust import HttpUser, task, between, constant\r\nfrom locust.env import Environment\r\nfrom locust.stats import stats_printer, stats_history\r\nfrom locust.log import setup_logging\r\nfrom locust.shape import LoadTestShape\r\n\r\nsetup_logging(\"INFO\", None)\r\n\r\n\r\nclass StepLoadShape(LoadTestShape):\r\n\r\n    step_time = 30\r\n    step_load = 10\r\n    spawn_rate = 10\r\n    time_limit = 600\r\n\r\n    def tick(self):\r\n        run_time = self.get_run_time()\r\n\r\n        if run_time > self.time_limit:\r\n            return None\r\n\r\n        current_step = math.floor(run_time / self.step_time) + 1\r\n        return (current_step * self.step_load, self.spawn_rate)\r\n\r\n\r\nclass User(HttpUser):\r\n    wait_time = constant(1)\r\n\r\n    @task\r\n    def my_task(self):\r\n        self.client.get(\"/\")\r\n\r\n\r\nenv = Environment(user_classes=[User], shape_class=StepLoadShape, host=\"https://docs.locust.io/\")\r\nenv.create_local_runner()\r\ngevent.spawn(stats_printer(env.stats))\r\ngevent.spawn(stats_history, env.runner)\r\nenv.runner.start_shape()\r\ngevent.spawn_later(600, lambda: env.runner.quit())\r\nenv.runner.greenlet.join()\r\n```\r\n\r\n### Environment\r\n\r\n- OS: Windows 10 Pro\r\n- Python version: Python 3.9\r\n- Locust version: 2.6.0\r\n- Locust command line that you ran: `python /path_to_file`\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1981/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1981/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1980", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1980/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1980/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1980/events", "html_url": "https://github.com/locustio/locust/issues/1980", "id": 1112713781, "node_id": "I_kwDOABUGS85CUqo1", "number": 1980, "title": "Update Changelog to 2.6.0 version", "user": {"login": "pauloxnet", "id": 521097, "node_id": "MDQ6VXNlcjUyMTA5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/521097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pauloxnet", "html_url": "https://github.com/pauloxnet", "followers_url": "https://api.github.com/users/pauloxnet/followers", "following_url": "https://api.github.com/users/pauloxnet/following{/other_user}", "gists_url": "https://api.github.com/users/pauloxnet/gists{/gist_id}", "starred_url": "https://api.github.com/users/pauloxnet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pauloxnet/subscriptions", "organizations_url": "https://api.github.com/users/pauloxnet/orgs", "repos_url": "https://api.github.com/users/pauloxnet/repos", "events_url": "https://api.github.com/users/pauloxnet/events{/privacy}", "received_events_url": "https://api.github.com/users/pauloxnet/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-01-24T14:21:51Z", "updated_at": "2022-01-24T15:25:55Z", "closed_at": "2022-01-24T15:19:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nThe Changelog is not aligned with the 2.6.0 release\r\n\r\n### Expected behavior\r\nI expect to see latest changes in the file Changelog\r\n\r\n### Actual behavior\r\nThe latest changes in the Changelog are stuck to version 2.5.1\r\n\r\n### Steps to reproduce\r\nOpen the file a read\r\nhttps://github.com/locustio/locust/blob/master/CHANGELOG.md\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1980/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1980/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1971", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1971/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1971/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1971/events", "html_url": "https://github.com/locustio/locust/issues/1971", "id": 1103579370, "node_id": "I_kwDOABUGS85Bx0jq", "number": 1971, "title": "Quitting master doesnt prevent its heartbeat_worker greenlet from trying to re-establish connections", "user": {"login": "cyberw", "id": 1134328, "node_id": "MDQ6VXNlcjExMzQzMjg=", "avatar_url": "https://avatars.githubusercontent.com/u/1134328?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cyberw", "html_url": "https://github.com/cyberw", "followers_url": "https://api.github.com/users/cyberw/followers", "following_url": "https://api.github.com/users/cyberw/following{/other_user}", "gists_url": "https://api.github.com/users/cyberw/gists{/gist_id}", "starred_url": "https://api.github.com/users/cyberw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cyberw/subscriptions", "organizations_url": "https://api.github.com/users/cyberw/orgs", "repos_url": "https://api.github.com/users/cyberw/repos", "events_url": "https://api.github.com/users/cyberw/events{/privacy}", "received_events_url": "https://api.github.com/users/cyberw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-01-14T12:37:13Z", "updated_at": "2022-04-11T02:11:53Z", "closed_at": "2022-04-11T02:11:53Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "```\r\n[2022-01-14 13:20:02,660] perftest04/INFO/locust.main: Cleaning up runner...\r\n[2022-01-14 13:20:02,651] master-machine/INFO/locust.runners: Client 'perftest04_1acb085b6d9a4d22b6ba31f0cedb5f0d' quit. Currently 0 clients connected.\r\n[2022-01-14 13:20:02,717] perftest04/INFO/locust.main: Shutting down (exit code 0), bye.\r\n[2022-01-14 13:20:02,717] perftest04/INFO/locust.main: Cleaning up runner...\r\n[2022-01-14 13:20:02,710] master-machine/INFO/locust.runners: Client 'perftest04_808d502f37ec43a4978766d95fe5ae5e' quit. Currently 0 clients connected.\r\n[2022-01-14 13:20:02,811] master-machine/ERROR/locust.runners: RPCError found when receiving from client: ZMQ network broken\r\n[2022-01-14 13:20:02,812] master-machine/INFO/locust.main: Shutting down (exit code 0), bye.\r\n[2022-01-14 13:20:02,812] master-machine/INFO/locust.main: Cleaning up runner...\r\n[2022-01-14 13:20:02,812] master-machine/INFO/locust.util.exception_handler: Exception found on retry 1: -- retry after 1s\r\n[2022-01-14 13:20:02,812] master-machine/ERROR/locust.util.exception_handler: ZMQ sent failure\r\nTraceback (most recent call last):\r\n  File \"/Users/myusername/git/locust/locust/rpc/zmqrpc.py\", line 27, in send_to_client\r\n    self.socket.send_multipart([msg.node_id.encode(), msg.serialize()])\r\n  File \"/usr/local/lib/python3.9/site-packages/zmq/green/core.py\", line 275, in send_multipart\r\n    msg = super(_Socket, self).send_multipart(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.9/site-packages/zmq/sugar/socket.py\", line 589, in send_multipart\r\n    self.send(msg, SNDMORE | flags, copy=copy, track=track)\r\n  File \"/usr/local/lib/python3.9/site-packages/zmq/green/core.py\", line 228, in send\r\n    msg = super(_Socket, self).send(data, flags, copy, track)\r\n  File \"/usr/local/lib/python3.9/site-packages/zmq/sugar/socket.py\", line 541, in send\r\n    return super(Socket, self).send(data, flags=flags, copy=copy, track=track)\r\n  File \"zmq/backend/cython/socket.pyx\", line 718, in zmq.backend.cython.socket.Socket.send\r\n  File \"zmq/backend/cython/socket.pyx\", line 759, in zmq.backend.cython.socket.Socket.send\r\n  File \"zmq/backend/cython/socket.pyx\", line 135, in zmq.backend.cython.socket._check_closed\r\nzmq.error.ZMQError: Socket operation on non-socket\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/myusername/git/locust/locust/util/exception_handler.py\", line 13, in wrapper\r\n    return function(*args, **kwargs)\r\n  File \"/Users/myusername/git/locust/locust/rpc/zmqrpc.py\", line 29, in send_to_client\r\n    raise RPCError(\"ZMQ sent failure\") from e\r\nlocust.exception.RPCError: ZMQ sent failure\r\n[2022-01-14 13:20:03,219] perftest03/INFO/locust.main: Shutting down (exit code 0), bye.\r\n[2022-01-14 13:20:03,219] perftest03/INFO/locust.main: Cleaning up runner...\r\n[2022-01-14 13:20:03,839] master-machine/INFO/locust.util.exception_handler: Exception found on retry 2: -- retry after 3s\r\n[2022-01-14 13:20:03,839] master-machine/ERROR/locust.util.exception_handler: ZMQ sent failure\r\nTraceback (most recent call last):\r\n  File \"/Users/myusername/git/locust/locust/rpc/zmqrpc.py\", line 27, in send_to_client\r\n    self.socket.send_multipart([msg.node_id.encode(), msg.serialize()])\r\n  File \"/usr/local/lib/python3.9/site-packages/zmq/green/core.py\", line 275, in send_multipart\r\n    msg = super(_Socket, self).send_multipart(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.9/site-packages/zmq/sugar/socket.py\", line 589, in send_multipart\r\n    self.send(msg, SNDMORE | flags, copy=copy, track=track)\r\n  File \"/usr/local/lib/python3.9/site-packages/zmq/green/core.py\", line 228, in send\r\n    msg = super(_Socket, self).send(data, flags, copy, track)\r\n  File \"/usr/local/lib/python3.9/site-packages/zmq/sugar/socket.py\", line 541, in send\r\n    return super(Socket, self).send(data, flags=flags, copy=copy, track=track)\r\n  File \"zmq/backend/cython/socket.pyx\", line 718, in zmq.backend.cython.socket.Socket.send\r\n  File \"zmq/backend/cython/socket.pyx\", line 759, in zmq.backend.cython.socket.Socket.send\r\n  File \"zmq/backend/cython/socket.pyx\", line 135, in zmq.backend.cython.socket._check_closed\r\nzmq.error.ZMQError: Socket operation on non-socket\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/myusername/git/locust/locust/util/exception_handler.py\", line 13, in wrapper\r\n    return function(*args, **kwargs)\r\n  File \"/Users/myusername/git/locust/locust/rpc/zmqrpc.py\", line 29, in send_to_client\r\n    raise RPCError(\"ZMQ sent failure\") from e\r\nlocust.exception.RPCError: ZMQ sent failure\r\n[2022-01-14 13:20:06,841] master-machine/INFO/locust.util.exception_handler: Exception found on retry 3: -- retry after 5s\r\n[2022-01-14 13:20:06,841] master-machine/ERROR/locust.util.exception_handler: ZMQ sent failure\r\nTraceback (most recent call last):\r\n  File \"/Users/myusername/git/locust/locust/rpc/zmqrpc.py\", line 27, in send_to_client\r\n    self.socket.send_multipart([msg.node_id.encode(), msg.serialize()])\r\n  File \"/usr/local/lib/python3.9/site-packages/zmq/green/core.py\", line 275, in send_multipart\r\n    msg = super(_Socket, self).send_multipart(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.9/site-packages/zmq/sugar/socket.py\", line 589, in send_multipart\r\n    self.send(msg, SNDMORE | flags, copy=copy, track=track)\r\n  File \"/usr/local/lib/python3.9/site-packages/zmq/green/core.py\", line 228, in send\r\n    msg = super(_Socket, self).send(data, flags, copy, track)\r\n  File \"/usr/local/lib/python3.9/site-packages/zmq/sugar/socket.py\", line 541, in send\r\n    return super(Socket, self).send(data, flags=flags, copy=copy, track=track)\r\n  File \"zmq/backend/cython/socket.pyx\", line 718, in zmq.backend.cython.socket.Socket.send\r\n  File \"zmq/backend/cython/socket.pyx\", line 759, in zmq.backend.cython.socket.Socket.send\r\n  File \"zmq/backend/cython/socket.pyx\", line 135, in zmq.backend.cython.socket._check_closed\r\nzmq.error.ZMQError: Socket operation on non-socket\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/myusername/git/locust/locust/util/exception_handler.py\", line 13, in wrapper\r\n    return function(*args, **kwargs)\r\n  File \"/Users/myusername/git/locust/locust/rpc/zmqrpc.py\", line 29, in send_to_client\r\n    raise RPCError(\"ZMQ sent failure\") from e\r\nlocust.exception.RPCError: ZMQ sent failure\r\n[2022-01-14 13:20:11,846] master-machine/INFO/locust.util.exception_handler: Retry failed after 3 times.\r\nTraceback (most recent call last):\r\n  File \"/Users/myusername/git/locust/locust/rpc/zmqrpc.py\", line 27, in send_to_client\r\n    self.socket.send_multipart([msg.node_id.encode(), msg.serialize()])\r\n  File \"/usr/local/lib/python3.9/site-packages/zmq/green/core.py\", line 275, in send_multipart\r\n    msg = super(_Socket, self).send_multipart(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.9/site-packages/zmq/sugar/socket.py\", line 589, in send_multipart\r\n    self.send(msg, SNDMORE | flags, copy=copy, track=track)\r\n  File \"/usr/local/lib/python3.9/site-packages/zmq/green/core.py\", line 228, in send\r\n    msg = super(_Socket, self).send(data, flags, copy, track)\r\n  File \"/usr/local/lib/python3.9/site-packages/zmq/sugar/socket.py\", line 541, in send\r\n    return super(Socket, self).send(data, flags=flags, copy=copy, track=track)\r\n  File \"zmq/backend/cython/socket.pyx\", line 718, in zmq.backend.cython.socket.Socket.send\r\n  File \"zmq/backend/cython/socket.pyx\", line 759, in zmq.backend.cython.socket.Socket.send\r\n  File \"zmq/backend/cython/socket.pyx\", line 135, in zmq.backend.cython.socket._check_closed\r\nzmq.error.ZMQError: Socket operation on non-socket\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/locust\", line 33, in <module>\r\n    sys.exit(load_entry_point('locust', 'console_scripts', 'locust')())\r\n  File \"/Users/myusername/git/locust/locust/main.py\", line 483, in main\r\n    shutdown()\r\n  File \"/Users/myusername/git/locust/locust/main.py\", line 453, in shutdown\r\n    runner.quit()\r\n  File \"/Users/myusername/git/locust/locust/runners.py\", line 821, in quit\r\n    self.server.send_to_client(Message(\"quit\", None, client.id))\r\n  File \"/Users/myusername/git/locust/locust/util/exception_handler.py\", line 13, in wrapper\r\n    return function(*args, **kwargs)\r\n  File \"/Users/myusername/git/locust/locust/rpc/zmqrpc.py\", line 29, in send_to_client\r\n    raise RPCError(\"ZMQ sent failure\") from e\r\nlocust.exception.RPCError: ZMQ sent failure\r\n2022-01-14:13:20:11,969 INFO [swarm:436] Load gen master process finished (return code 1)\r\n```\r\n@delulu I think this was introduced in your code a long time ago, but for some reason I started seeing it just now (perhaps after switching from RHEL to Ubuntu for my workers?). I have a fix that I will PR very soon.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1971/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1971/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1969", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1969/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1969/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1969/events", "html_url": "https://github.com/locustio/locust/issues/1969", "id": 1100493368, "node_id": "I_kwDOABUGS85BmDI4", "number": 1969, "title": "Locust while running as library with grpc client not outputting stats", "user": {"login": "saurabhsharma721", "id": 14283388, "node_id": "MDQ6VXNlcjE0MjgzMzg4", "avatar_url": "https://avatars.githubusercontent.com/u/14283388?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saurabhsharma721", "html_url": "https://github.com/saurabhsharma721", "followers_url": "https://api.github.com/users/saurabhsharma721/followers", "following_url": "https://api.github.com/users/saurabhsharma721/following{/other_user}", "gists_url": "https://api.github.com/users/saurabhsharma721/gists{/gist_id}", "starred_url": "https://api.github.com/users/saurabhsharma721/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saurabhsharma721/subscriptions", "organizations_url": "https://api.github.com/users/saurabhsharma721/orgs", "repos_url": "https://api.github.com/users/saurabhsharma721/repos", "events_url": "https://api.github.com/users/saurabhsharma721/events{/privacy}", "received_events_url": "https://api.github.com/users/saurabhsharma721/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-01-12T15:44:44Z", "updated_at": "2022-03-13T13:26:59Z", "closed_at": "2022-03-13T13:26:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nGrpc client not creating stats while running in library mode\r\n\r\n### Expected behavior\r\nStats should be created and available both in csv files and in api.\r\n\r\n### Actual behavior\r\nThe Csv files generated and logs created will have zero stats output\r\n\r\n   locust test have completed running\r\n   ```\r\n   Test run completed.\r\n   requests after run : 0\r\n   Failures after run : 0\r\n   ```\r\n\r\n### Steps to reproduce\r\n\r\nThe code is available here in github repo \r\n\r\nhttps://github.com/saurabhsharma721/grpc_locust_stats_repro_prj\r\n\r\n### Environment\r\n\r\n- OS: mac\r\n- Python version: 3.8.5\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds): 2.24\r\n- Locust file contents (anonymized if necessary): Code available here : https://github.com/saurabhsharma721/grpc_locust_stats_repro_prj/blob/main/grpc/locust_driver.py\r\n\r\nI see we have similar question on SO but want to check where to place request events inside the test. A code snippet will help", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1969/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1969/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1968", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1968/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1968/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1968/events", "html_url": "https://github.com/locustio/locust/issues/1968", "id": 1094933853, "node_id": "I_kwDOABUGS85BQ11d", "number": 1968, "title": "The locust report count number was different to redis", "user": {"login": "ToddCombs", "id": 54100114, "node_id": "MDQ6VXNlcjU0MTAwMTE0", "avatar_url": "https://avatars.githubusercontent.com/u/54100114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ToddCombs", "html_url": "https://github.com/ToddCombs", "followers_url": "https://api.github.com/users/ToddCombs/followers", "following_url": "https://api.github.com/users/ToddCombs/following{/other_user}", "gists_url": "https://api.github.com/users/ToddCombs/gists{/gist_id}", "starred_url": "https://api.github.com/users/ToddCombs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ToddCombs/subscriptions", "organizations_url": "https://api.github.com/users/ToddCombs/orgs", "repos_url": "https://api.github.com/users/ToddCombs/repos", "events_url": "https://api.github.com/users/ToddCombs/events{/privacy}", "received_events_url": "https://api.github.com/users/ToddCombs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635903137, "node_id": "MDU6TGFiZWwxNjM1OTAzMTM3", "url": "https://api.github.com/repos/locustio/locust/labels/duplicate", "name": "duplicate", "color": "9cea8c", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-01-06T03:33:00Z", "updated_at": "2022-01-07T11:41:45Z", "closed_at": "2022-01-07T06:45:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\n![16414383632780](https://user-images.githubusercontent.com/54100114/148323367-82b20805-0a27-438b-b09e-63a8d1e16694.png)\r\n\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: Windows 10 \u5bb6\u5ead\u4e2d\u6587\u7248 20H2\r\n- Python version: 3.8.8\r\n- Locust version: 2.5.0\r\n- Locust command line that you ran:locust -f demo\\Locust_demo\\sy.py\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1968/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1968/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1961", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1961/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1961/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1961/events", "html_url": "https://github.com/locustio/locust/issues/1961", "id": 1083056557, "node_id": "I_kwDOABUGS85AjiGt", "number": 1961, "title": "Incorrect \"All users spawned\" log messages when running distributed", "user": {"login": "cyberw", "id": 1134328, "node_id": "MDQ6VXNlcjExMzQzMjg=", "avatar_url": "https://avatars.githubusercontent.com/u/1134328?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cyberw", "html_url": "https://github.com/cyberw", "followers_url": "https://api.github.com/users/cyberw/followers", "following_url": "https://api.github.com/users/cyberw/following{/other_user}", "gists_url": "https://api.github.com/users/cyberw/gists{/gist_id}", "starred_url": "https://api.github.com/users/cyberw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cyberw/subscriptions", "organizations_url": "https://api.github.com/users/cyberw/orgs", "repos_url": "https://api.github.com/users/cyberw/repos", "events_url": "https://api.github.com/users/cyberw/events{/privacy}", "received_events_url": "https://api.github.com/users/cyberw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-12-17T09:31:12Z", "updated_at": "2022-02-28T01:54:15Z", "closed_at": "2022-02-28T01:54:15Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "When running distributed, we print the wrong numbers, e.g. \r\n\r\n    All users spawned: {\"UserSubclass\": 2} (2 total users)\r\n\r\nWhen the desired (and actual) final user count was 3.\r\n\r\nHere's a test case that exhibits this (not 100% of the time, but almost) https://github.com/locustio/locust/commit/4f7b37ab187a7c084e3c0fda6d23f2adf10345c3\r\n\r\nMaybe we are printing the numbers from the previous step, or we must wait until the next worker report comes in before printing? It seems to only happens with at least 5 workers (!?)\r\n\r\nThis issue seems to have been around for a while (maybe since 2.0)\r\n\r\n@mboutet , do you have time to take a look?", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1961/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1961/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1959", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1959/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1959/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1959/events", "html_url": "https://github.com/locustio/locust/issues/1959", "id": 1078439673, "node_id": "I_kwDOABUGS85AR675", "number": 1959, "title": "Docs: Missing locustfile.py in code structure example", "user": {"login": "Hritik14", "id": 7457065, "node_id": "MDQ6VXNlcjc0NTcwNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/7457065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Hritik14", "html_url": "https://github.com/Hritik14", "followers_url": "https://api.github.com/users/Hritik14/followers", "following_url": "https://api.github.com/users/Hritik14/following{/other_user}", "gists_url": "https://api.github.com/users/Hritik14/gists{/gist_id}", "starred_url": "https://api.github.com/users/Hritik14/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Hritik14/subscriptions", "organizations_url": "https://api.github.com/users/Hritik14/orgs", "repos_url": "https://api.github.com/users/Hritik14/repos", "events_url": "https://api.github.com/users/Hritik14/events{/privacy}", "received_events_url": "https://api.github.com/users/Hritik14/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-12-13T11:56:52Z", "updated_at": "2021-12-13T13:41:30Z", "closed_at": "2021-12-13T13:41:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nIn the following section, a `locustfile.py` is missing\r\nhttps://github.com/locustio/locust/blame/abca230842661606e00433a0df91927ebf23ec9c/docs/writing-a-locustfile.rst#L625-L636\r\n\r\n\r\n### Expected behavior\r\nThere should be a `locustfile.py` which would import classes from `locustfiles` directory\r\n\r\n### Actual behavior\r\nThere's no `locustfile.py` in the docs\r\n\r\n### Steps to reproduce\r\n```\r\n(;) ; ls -l\r\ntotal 0\r\ndrwxr-xr-x  3 neo  wheel   96 Dec 13 17:22 common\r\ndrwxr-xr-x  3 neo  wheel   96 Dec 13 17:22 locustfiles\r\ndrwxr-xr-x  7 neo  wheel  224 Dec 13 17:21 venv\r\n(;) ; tree -I venv\r\n.\r\n\u251c\u2500\u2500 common\r\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 __init__.py\r\n\u2514\u2500\u2500 locustfiles\r\n    \u2514\u2500\u2500 locustfile.py\r\n\r\n2 directories, 2 files\r\n(;) ; locust\r\nCould not find any locustfile! Ensure file ends in '.py' and see --help for available options.\r\n(;) ;\r\n```\r\n\r\n### Environment\r\n\r\n- OS: MacOS\r\n- Python version: Python 3.10.0\r\n- Locust version: locust 2.5.1\r\n- Locust command line that you ran: locust\r\n- Locust file contents (anonymized if necessary): no locustfile present, only `locustfiles` directory present", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1959/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1959/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1957", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1957/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1957/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1957/events", "html_url": "https://github.com/locustio/locust/issues/1957", "id": 1075927050, "node_id": "I_kwDOABUGS85AIVgK", "number": 1957, "title": "Error when setting multiple host values", "user": {"login": "maksymivash", "id": 59840688, "node_id": "MDQ6VXNlcjU5ODQwNjg4", "avatar_url": "https://avatars.githubusercontent.com/u/59840688?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maksymivash", "html_url": "https://github.com/maksymivash", "followers_url": "https://api.github.com/users/maksymivash/followers", "following_url": "https://api.github.com/users/maksymivash/following{/other_user}", "gists_url": "https://api.github.com/users/maksymivash/gists{/gist_id}", "starred_url": "https://api.github.com/users/maksymivash/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maksymivash/subscriptions", "organizations_url": "https://api.github.com/users/maksymivash/orgs", "repos_url": "https://api.github.com/users/maksymivash/repos", "events_url": "https://api.github.com/users/maksymivash/events{/privacy}", "received_events_url": "https://api.github.com/users/maksymivash/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-12-09T19:32:40Z", "updated_at": "2021-12-09T21:28:50Z", "closed_at": "2021-12-09T21:25:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nWe need to send load on multiple hosts simultaneously, unfortunately locust throws an exception with versions 2.2.0, 2.4.0, 2.5.0.\r\nEverything was working as expected with v2.1.0\r\n\r\n### Expected behavior\r\nLocust should send requests to both hosts.\r\n\r\n### Actual behavior\r\nException thrown\r\nTrace:\r\n```\r\nmaster_1  | [2021-12-09 19:29:05,641] faae8a51425b/INFO/locust.runners: Ramping to 4 users at a rate of 4.00 per second\r\nmaster_1  | Traceback (most recent call last):\r\nmaster_1  |   File \"src/gevent/greenlet.py\", line 906, in gevent._gevent_cgreenlet.Greenlet.run\r\nmaster_1  |   File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 490, in <lambda>\r\nmaster_1  |     lambda: super(LocalRunner, self).start(user_count, spawn_rate, wait=wait)\r\nmaster_1  |   File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 346, in start\r\nmaster_1  |     self.spawn_users(user_classes_spawn_count, wait)\r\nmaster_1  |   File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 221, in spawn_users\r\nmaster_1  |     new_users += spawn(user_class, spawn_count)\r\nmaster_1  |   File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 210, in spawn\r\nmaster_1  |     new_user = self.user_classes_by_name[user_class](self.environment)\r\nmaster_1  |   File \"/usr/local/lib/python3.8/site-packages/locust/contrib/fasthttp.py\", line 311, in __init__\r\nmaster_1  |     raise LocustError(\"Invalid host (`%s`), must be a valid base URL. E.g. http://example.com\" % self.host)\r\nmaster_1  | locust.exception.LocustError: Invalid host (``), must be a valid base URL. E.g. http://example.com\r\nmaster_1  | 2021-12-09T19:29:05Z <Greenlet at 0x7faaf9ddcd00: <lambda>> failed with LocustError\r\nmaster_1  |\r\nmaster_1  | [2021-12-09 19:29:05,643] faae8a51425b/CRITICAL/locust.runners: Unhandled exception in greenlet: <Greenlet at 0x7faaf9ddcd00: <lambda>>\r\nmaster_1  | Traceback (most recent call last):\r\nmaster_1  |   File \"src/gevent/greenlet.py\", line 906, in gevent._gevent_cgreenlet.Greenlet.run\r\nmaster_1  |   File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 490, in <lambda>\r\nmaster_1  |     lambda: super(LocalRunner, self).start(user_count, spawn_rate, wait=wait)\r\nmaster_1  |   File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 346, in start\r\nmaster_1  |     self.spawn_users(user_classes_spawn_count, wait)\r\nmaster_1  |   File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 221, in spawn_users\r\nmaster_1  |     new_users += spawn(user_class, spawn_count)\r\nmaster_1  |   File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 210, in spawn\r\nmaster_1  |     new_user = self.user_classes_by_name[user_class](self.environment)\r\nmaster_1  |   File \"/usr/local/lib/python3.8/site-packages/locust/contrib/fasthttp.py\", line 311, in __init__\r\nmaster_1  |     raise LocustError(\"Invalid host (`%s`), must be a valid base URL. E.g. http://example.com\" % self.host)\r\nmaster_1  | locust.exception.LocustError: Invalid host (``), must be a valid base URL. E.g. http://example.com\r\n```\r\n\r\n### Steps to reproduce\r\nLocustfile:\r\n```\r\nfrom locust import task\r\n\r\nfrom locust.contrib.fasthttp import FastHttpUser\r\n\r\n\r\nclass HealthzOnlyAPIdev(FastHttpUser):\r\n    host = \"https://api.dev.example.com\"\r\n\r\n    @task(1)\r\n    def healthz(self):\r\n        path = \"/healthz\"\r\n        self.client.get(\r\n            path=path,\r\n            name=f\"{self.client.base_url}{path}\",\r\n        )\r\n\r\n\r\nclass HealthzOnlyAPIstagef(FastHttpUser):\r\n    host = \"https://api.stagef.example.com\"\r\n\r\n    @task(1)\r\n    def healthz(self):\r\n        path = \"/healthz\"\r\n        self.client.get(\r\n            path=path,\r\n            name=f\"{self.client.base_url}{path}\",\r\n        )\r\n```\r\n\r\n### Environment\r\n\r\n- OS: Docker/Mac\r\n- Python version: 3.9\r\n- Locust version: 2.5.0\r\n- Locust command line that you ran: `locust -f healthz.py -u 4 -r 4`\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1957/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1957/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1953", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1953/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1953/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1953/events", "html_url": "https://github.com/locustio/locust/issues/1953", "id": 1072998806, "node_id": "I_kwDOABUGS84_9KmW", "number": 1953, "title": "After running the locust, on UI can not see any aggregation report, although the request is successful", "user": {"login": "Aiu-Spring", "id": 69794450, "node_id": "MDQ6VXNlcjY5Nzk0NDUw", "avatar_url": "https://avatars.githubusercontent.com/u/69794450?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Aiu-Spring", "html_url": "https://github.com/Aiu-Spring", "followers_url": "https://api.github.com/users/Aiu-Spring/followers", "following_url": "https://api.github.com/users/Aiu-Spring/following{/other_user}", "gists_url": "https://api.github.com/users/Aiu-Spring/gists{/gist_id}", "starred_url": "https://api.github.com/users/Aiu-Spring/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Aiu-Spring/subscriptions", "organizations_url": "https://api.github.com/users/Aiu-Spring/orgs", "repos_url": "https://api.github.com/users/Aiu-Spring/repos", "events_url": "https://api.github.com/users/Aiu-Spring/events{/privacy}", "received_events_url": "https://api.github.com/users/Aiu-Spring/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-12-07T07:12:14Z", "updated_at": "2021-12-08T10:43:26Z", "closed_at": "2021-12-08T07:45:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nAfter pycharm executes the lock command, it goes to localhost: 8089 to configure concurrency and starts the pressure test. However, after the pressure test, the aggregation report page does not display any requests, although pycharm detects that the requests are successful\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nIt is hoped that the aggregation report can be displayed normally, and the data output by other performance is normal. The aggregation report can be generated and downloaded normally\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nNo requests are displayed, and it is unclear at the UI level how well the request action performs\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS:Window10\r\n- Python version:3.9.7\r\n- Locust version: 2.5.0\r\n- Locust command line that you ran:locust -f .\\loadtest\\Loadtest-Suite.py\r\n- Locust file contents (anonymized if necessary):\r\n`class GetResume(TaskSet):\r\n    @task  \r\n    def get_collection_id(self):\r\n        headers = {\r\n            \"Accept\": \"application/json\"\r\n        }\r\n        params = {\r\n            \"c\": \"web\",\r\n            \"pageNumber\": 0,\r\n            \"pageSize\": 2\r\n        }\r\n        response = self.client.get(\"xxxxxxx\", params=params,\r\n                                   headers=headers,\r\n                                   catch_response=True, verify=False)\r\n        for i in range(1, 1000):\r\n            print(f\"test time is {i}\" + \" status_code is:\" + str(response.status_code))\r\n        if \"Success\" in response.text:\r\n            response.success()\r\n        else:\r\n            response.failure(\"failed\")\r\n\r\nclass Website(HttpUser):\r\n    tasks = [GetResume]\r\n    min_wait = 1000\r\n    max_wait = 2000\r\n    host = \"xxxxxxxxx\"`\r\n![image](https://user-images.githubusercontent.com/69794450/144982931-dfac5874-3b94-4fa8-9dbf-dc6243754703.png)\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1953/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1953/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1952", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1952/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1952/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1952/events", "html_url": "https://github.com/locustio/locust/issues/1952", "id": 1071503333, "node_id": "I_kwDOABUGS84_3dfl", "number": 1952, "title": "[FIXED] Not able to run locust due to \"No module named pkg_resources\" issue on Manjaro (Arch based Linux)", "user": {"login": "wlad", "id": 64201310, "node_id": "MDQ6VXNlcjY0MjAxMzEw", "avatar_url": "https://avatars.githubusercontent.com/u/64201310?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wlad", "html_url": "https://github.com/wlad", "followers_url": "https://api.github.com/users/wlad/followers", "following_url": "https://api.github.com/users/wlad/following{/other_user}", "gists_url": "https://api.github.com/users/wlad/gists{/gist_id}", "starred_url": "https://api.github.com/users/wlad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wlad/subscriptions", "organizations_url": "https://api.github.com/users/wlad/orgs", "repos_url": "https://api.github.com/users/wlad/repos", "events_url": "https://api.github.com/users/wlad/events{/privacy}", "received_events_url": "https://api.github.com/users/wlad/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-12-05T16:42:19Z", "updated_at": "2022-02-04T07:43:47Z", "closed_at": "2022-02-04T07:43:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nI've install locust inside a venv via `pip install locust`.  Running `locust -f myfile.py` failed with \"**No module named pkg_resources**\" error. Trying to update setuptools as recommended on Stackoverflow I managed to break my system's pip/setuptools. At that point setuptools version was 56.0.0 - I guess this version is not compatible with locust's dependencies(?)\r\n\r\nBelow are the steps how I managed to fix pip/setuptools issue which allowed to run locust successfully after installation.\r\n\r\n1. deactivated and removed used venv\r\n2. fixed pip via `python3 -m ensurepip --default-pip` and `python -m ensurepip --upgrade` (that seems to have updated setuptools as well - version 57.4.0). But you can also try `python3 -m pip install --upgrade pip setuptools wheel`)\r\n3. created a new venv `python -m venv ~/.venvs/locust`\r\n4. activated locust venv `~/.venvs/locust/bin/activate`\r\n5. installed locust `pip install -U locust --no-cache-dir`\r\n6. run locust with success\r\n\r\n\r\n### Environment\r\n\r\n\r\n- OS: Manjaro 21.1.6 Pahvo (Arch Linux)\r\n- Kernel: x86_64 Linux 5.13.19-2-MANJARO\r\n- Python version: 3.9\r\n- Locust version: 2.5.0\r\n- Locust command line that you ran: `locust -f myfile.py`", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1952/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1952/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1949", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1949/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1949/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1949/events", "html_url": "https://github.com/locustio/locust/issues/1949", "id": 1067451231, "node_id": "I_kwDOABUGS84_oANf", "number": 1949, "title": "Locust install issue - M1 Mac", "user": {"login": "sukhcha-in", "id": 26461527, "node_id": "MDQ6VXNlcjI2NDYxNTI3", "avatar_url": "https://avatars.githubusercontent.com/u/26461527?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sukhcha-in", "html_url": "https://github.com/sukhcha-in", "followers_url": "https://api.github.com/users/sukhcha-in/followers", "following_url": "https://api.github.com/users/sukhcha-in/following{/other_user}", "gists_url": "https://api.github.com/users/sukhcha-in/gists{/gist_id}", "starred_url": "https://api.github.com/users/sukhcha-in/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sukhcha-in/subscriptions", "organizations_url": "https://api.github.com/users/sukhcha-in/orgs", "repos_url": "https://api.github.com/users/sukhcha-in/repos", "events_url": "https://api.github.com/users/sukhcha-in/events{/privacy}", "received_events_url": "https://api.github.com/users/sukhcha-in/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2021-11-30T16:43:42Z", "updated_at": "2021-12-15T06:23:12Z", "closed_at": "2021-12-14T15:51:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nInstallation fails on M1 Mac\r\n`gevent` fails to install\r\n\r\n### Steps to reproduce\r\n```\r\nsukh@Sukhchains-Mac-mini Locust % python3 -m venv venv\r\nsukh@Sukhchains-Mac-mini Locust % source venv/bin/activate\r\n(venv) sukh@Sukhchains-Mac-mini Locust % pip3 install locust\r\nCollecting locust\r\n  Using cached locust-2.5.0-py3-none-any.whl (795 kB)\r\nCollecting ConfigArgParse>=1.0\r\n  Using cached ConfigArgParse-1.5.3-py3-none-any.whl (20 kB)\r\nCollecting msgpack>=0.6.2\r\n  Using cached msgpack-1.0.3.tar.gz (123 kB)\r\nCollecting Werkzeug>=2.0.0\r\n  Using cached Werkzeug-2.0.2-py3-none-any.whl (288 kB)\r\nCollecting roundrobin>=0.0.2\r\n  Using cached roundrobin-0.0.2.tar.gz (2.4 kB)\r\nCollecting typing-extensions>=3.7.4.3\r\n  Using cached typing_extensions-4.0.0-py3-none-any.whl (22 kB)\r\nCollecting Flask-BasicAuth>=0.2.0\r\n  Using cached Flask-BasicAuth-0.2.0.tar.gz (16 kB)\r\nCollecting requests>=2.9.1\r\n  Using cached requests-2.26.0-py2.py3-none-any.whl (62 kB)\r\nCollecting flask>=2.0.0\r\n  Using cached Flask-2.0.2-py3-none-any.whl (95 kB)\r\nCollecting gevent>=20.9.0\r\n  Using cached gevent-21.8.0.tar.gz (6.2 MB)\r\n  Installing build dependencies ... error\r\n  ERROR: Command errored out with exit status 1:\r\n   command: /Users/sukh/Documents/Python/Locust/venv/bin/python3 /Users/sukh/Documents/Python/Locust/venv/lib/python3.8/site-packages/pip install --ignore-installed --no-user --prefix /private/var/folders/js/7507s78n4_j84zhwv9l_2tzh0000gn/T/pip-build-env-96300qvd/overlay --no-warn-script-location --no-binary :none: --only-binary :none: -i https://pypi.org/simple -- 'setuptools >= 40.8.0' wheel 'Cython >= 3.0a9' 'cffi >= 1.12.3 ; platform_python_implementation == '\"'\"'CPython'\"'\"'' 'greenlet >= 0.4.17, < 2.0 ; platform_python_implementation == '\"'\"'CPython'\"'\"''\r\n       cwd: None\r\n  Complete output (29 lines):\r\n  Collecting setuptools>=40.8.0\r\n    Using cached setuptools-59.4.0-py3-none-any.whl (952 kB)\r\n  Collecting wheel\r\n    Using cached wheel-0.37.0-py2.py3-none-any.whl (35 kB)\r\n  Collecting Cython>=3.0a9\r\n    Using cached Cython-3.0.0a9-py2.py3-none-any.whl (1.1 MB)\r\n  Collecting cffi>=1.12.3\r\n    Using cached cffi-1.15.0.tar.gz (484 kB)\r\n      ERROR: Command errored out with exit status 1:\r\n       command: /Users/sukh/Documents/Python/Locust/venv/bin/python3 -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'/private/var/folders/js/7507s78n4_j84zhwv9l_2tzh0000gn/T/pip-install-7kyh8j18/cffi/setup.py'\"'\"'; __file__='\"'\"'/private/var/folders/js/7507s78n4_j84zhwv9l_2tzh0000gn/T/pip-install-7kyh8j18/cffi/setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' egg_info --egg-base /private/var/folders/js/7507s78n4_j84zhwv9l_2tzh0000gn/T/pip-pip-egg-info-f1xkpk4j\r\n           cwd: /private/var/folders/js/7507s78n4_j84zhwv9l_2tzh0000gn/T/pip-install-7kyh8j18/cffi/\r\n      Complete output (13 lines):\r\n      Traceback (most recent call last):\r\n        File \"<string>\", line 1, in <module>\r\n        File \"/private/var/folders/js/7507s78n4_j84zhwv9l_2tzh0000gn/T/pip-install-7kyh8j18/cffi/setup.py\", line 147, in <module>\r\n          use_pkg_config()\r\n        File \"/private/var/folders/js/7507s78n4_j84zhwv9l_2tzh0000gn/T/pip-install-7kyh8j18/cffi/setup.py\", line 111, in use_pkg_config\r\n          _ask_pkg_config(include_dirs,       '--cflags-only-I', '-I', sysroot=True)\r\n        File \"/private/var/folders/js/7507s78n4_j84zhwv9l_2tzh0000gn/T/pip-install-7kyh8j18/cffi/setup.py\", line 23, in _ask_pkg_config\r\n          p = subprocess.Popen([pkg_config, option, 'libffi'],\r\n        File \"/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.8/lib/python3.8/subprocess.py\", line 858, in __init__\r\n          self._execute_child(args, executable, preexec_fn, close_fds,\r\n        File \"/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.8/lib/python3.8/subprocess.py\", line 1704, in _execute_child\r\n          raise child_exception_type(errno_num, err_msg, err_filename)\r\n      NotADirectoryError: [Errno 20] Not a directory: 'pkg-config'\r\n      ----------------------------------------\r\n  ERROR: Command errored out with exit status 1: python setup.py egg_info Check the logs for full command output.\r\n  WARNING: You are using pip version 20.2.3; however, version 21.3.1 is available.\r\n  You should consider upgrading via the '/Users/sukh/Documents/Python/Locust/venv/bin/python3 -m pip install --upgrade pip' command.\r\n  ----------------------------------------\r\nERROR: Command errored out with exit status 1: /Users/sukh/Documents/Python/Locust/venv/bin/python3 /Users/sukh/Documents/Python/Locust/venv/lib/python3.8/site-packages/pip install --ignore-installed --no-user --prefix /private/var/folders/js/7507s78n4_j84zhwv9l_2tzh0000gn/T/pip-build-env-96300qvd/overlay --no-warn-script-location --no-binary :none: --only-binary :none: -i https://pypi.org/simple -- 'setuptools >= 40.8.0' wheel 'Cython >= 3.0a9' 'cffi >= 1.12.3 ; platform_python_implementation == '\"'\"'CPython'\"'\"'' 'greenlet >= 0.4.17, < 2.0 ; platform_python_implementation == '\"'\"'CPython'\"'\"'' Check the logs for full command output.\r\n```\r\n\r\n### Environment\r\n\r\n- OS: macOS on M1\r\n- Python version: 3.8.9", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1949/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1949/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1947", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1947/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1947/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1947/events", "html_url": "https://github.com/locustio/locust/issues/1947", "id": 1066171974, "node_id": "I_kwDOABUGS84_jH5G", "number": 1947, "title": "Locust does not stop all users", "user": {"login": "marcinh", "id": 6491818, "node_id": "MDQ6VXNlcjY0OTE4MTg=", "avatar_url": "https://avatars.githubusercontent.com/u/6491818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marcinh", "html_url": "https://github.com/marcinh", "followers_url": "https://api.github.com/users/marcinh/followers", "following_url": "https://api.github.com/users/marcinh/following{/other_user}", "gists_url": "https://api.github.com/users/marcinh/gists{/gist_id}", "starred_url": "https://api.github.com/users/marcinh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marcinh/subscriptions", "organizations_url": "https://api.github.com/users/marcinh/orgs", "repos_url": "https://api.github.com/users/marcinh/repos", "events_url": "https://api.github.com/users/marcinh/events{/privacy}", "received_events_url": "https://api.github.com/users/marcinh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2021-11-29T15:24:13Z", "updated_at": "2022-03-04T16:38:48Z", "closed_at": "2022-03-04T16:38:48Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Describe the bug\r\nWhen there is more than 1 user defined in locust file, Locust does not stop users correctly - there are always 10%-20% left in running state. I'm adding the scenario, that causes problem - there is a background task that periodically checks the number of users and print sit to console.\r\n\r\n### Expected behavior\r\nAll users stopped correctly\r\n\r\n### Actual behavior\r\nNot all users stopped\r\n\r\n### Steps to reproduce\r\nRun scenario attached (containing 2 user classes)\r\n\r\n### Environment\r\n\r\n- OS: Windows/MAC\r\n- Python version: 3.9\r\n- Locust version: 2.5\r\n- Locust command line that you ran: locust -f bug_scenario.py\r\n- Locust file contents (anonymized if necessary):\r\n\r\n```\r\nfrom logging import getLogger\r\nfrom random import randrange\r\n\r\nfrom gevent import sleep, spawn\r\nfrom locust import task, constant_pacing, SequentialTaskSet, events, User\r\nfrom locust.env import Environment\r\n\r\nlogger = getLogger('Scenario')\r\n\r\n\r\ndef add_request_event(request_type, name, duration, length=0, response=None, context=None, exception=None):\r\n    events.request.fire(\r\n        request_type=request_type,\r\n        name=name,\r\n        response_time=duration,\r\n        response_length=length,\r\n        response=response,\r\n        context=context or {},\r\n        exception=exception\r\n    )\r\n\r\n\r\ndef run_environment_checker(environment: Environment):\r\n    while True:\r\n        user_count = environment.runner.user_count\r\n        logger.info(f'User count: {user_count}')\r\n        sleep(3)\r\n\r\n\r\n@events.init.add_listener\r\ndef hadle_environment_checker(environment: Environment, **_):\r\n    spawn(lambda: run_environment_checker(environment))\r\n\r\n\r\nclass TestScenario(SequentialTaskSet):\r\n\r\n    def __init__(self, parent):\r\n        super().__init__(parent)\r\n\r\n    def on_start(self):\r\n        logger.info('on_start')\r\n\r\n    @task\r\n    def open_homepage(self):\r\n        add_request_event(\r\n            request_type='PUT',\r\n            name='3d',\r\n            duration=randrange(1000),\r\n            length=randrange(1000)\r\n        )\r\n\r\n    @task\r\n    def open_dashboard(self):\r\n        add_request_event(\r\n            request_type='GET',\r\n            name='2d',\r\n            duration=randrange(1000),\r\n            length=randrange(1000)\r\n        )\r\n\r\n    @task\r\n    def get_open_positions(self):\r\n        add_request_event(\r\n            request_type='POST',\r\n            name='1d',\r\n            duration=randrange(1000),\r\n            length=randrange(1000)\r\n        )\r\n\r\n    def on_stop(self):\r\n        logger.info('on_stop')\r\n\r\n\r\nclass ExampleUser(User):\r\n    tasks = [TestScenario]\r\n    wait_time = constant_pacing(10)\r\n\r\n\r\nclass ExampleUser2(ExampleUser):\r\n    pass\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1947/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1947/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1946", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1946/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1946/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1946/events", "html_url": "https://github.com/locustio/locust/issues/1946", "id": 1065552878, "node_id": "I_kwDOABUGS84_gwvu", "number": 1946, "title": "locust requests dropped suddenly", "user": {"login": "zhjunqin", "id": 7519482, "node_id": "MDQ6VXNlcjc1MTk0ODI=", "avatar_url": "https://avatars.githubusercontent.com/u/7519482?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zhjunqin", "html_url": "https://github.com/zhjunqin", "followers_url": "https://api.github.com/users/zhjunqin/followers", "following_url": "https://api.github.com/users/zhjunqin/following{/other_user}", "gists_url": "https://api.github.com/users/zhjunqin/gists{/gist_id}", "starred_url": "https://api.github.com/users/zhjunqin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zhjunqin/subscriptions", "organizations_url": "https://api.github.com/users/zhjunqin/orgs", "repos_url": "https://api.github.com/users/zhjunqin/repos", "events_url": "https://api.github.com/users/zhjunqin/events{/privacy}", "received_events_url": "https://api.github.com/users/zhjunqin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-11-29T03:02:31Z", "updated_at": "2021-11-30T08:57:59Z", "closed_at": "2021-11-30T08:33:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\nWhen I do benchmark with new locust 2.5.0 version, the req/s sent by locust dropped randomly to nearly zero, then back to normal again.\r\n\r\nSuch behavior not happend in old locust-io package.\r\n\r\n```\r\n Name                                                                              # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n grpc host:5555                           9399     0(0.00%)  |       7       7      27       7  |  120.50    0.00\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                                          9399     0(0.00%)  |       7       7      27       7  |  120.50    0.00\r\n\r\n Name                                                                              # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n grpc host:5555                           9677     0(0.00%)  |       7       7      27       7  |  120.10    0.00\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                                          9677     0(0.00%)  |       7       7      27       7  |  120.10    0.00\r\n\r\n Name                                                                              # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n grpc host:5555                           9821     0(0.00%)  |       7       7      27       7  |   26.20    0.00\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                                          9821     0(0.00%)  |       7       7      27       7  |   26.20    0.00\r\n\r\n Name                                                                              # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n grpc host:5555                          10102     0(0.00%)  |       7       7      27       7  |    2.10    0.00\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                                         10102     0(0.00%)  |       7       7      27       7  |    2.10    0.00\r\n\r\n Name                                                                              # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n grpc host:5555                          10381     0(0.00%)  |       7       7      27       7  |   33.10    0.00\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                                         10381     0(0.00%)  |       7       7      27       7  |   33.10    0.00\r\n\r\n Name                                                                              # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n grpc host:5555                          10659     0(0.00%)  |       7       7      27       7  |   57.30    0.00\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                                         10659     0(0.00%)  |       7       7      27       7  |   57.30    0.00\r\n\r\n Name                                                                              # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n grpc host:5555                        10938     0(0.00%)  |       7       7      27       7  |   81.50    0.00\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                                         10938     0(0.00%)  |       7       7      27       7  |   81.50    0.00\r\n\r\n Name                                                                              # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n grpc host:5555                         11218     0(0.00%)  |       7       7      27       7  |  117.70    0.00\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                                         11218     0(0.00%)  |       7       7      27       7  |  117.70    0.00\r\n\r\n Name                                                                              # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n grpc host:5555                         11496     0(0.00%)  |       7       7      27       7  |  120.90    0.00\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                                         11496     0(0.00%)  |       7       7      27       7  |  120.90    0.00\r\n```\r\n\r\ncode looks like:\r\n\r\n```\r\n# -*- coding:utf-8 -*-\r\nfrom locust import Locust, TaskSet, task, events, User\r\nfrom locust import  between\r\n\r\nclass ApiUser(User):\r\n    wait_time = between(0.090, 0.110)\r\n\r\n    @task\r\n    def get_prediction(self):\r\n            channel = grpc.insecure_channel(HOST)\r\n            stub = prediction_service_pb2_grpc.PredictionServiceStub(channel)\r\n            request = predict_pb2.PredictRequest()\r\n            request.model_spec.name = \"test\"\r\n            request.model_spec.signature_name = 'test'\r\n            build_request(request, 100)\r\n            start_time = time.time()\r\n            try:\r\n                result = stub.Predict(request, 20.0)\r\n            except Exception as e:\r\n                total_time = int((time.time() - start_time) * 1000)\r\n                events.request_failure.fire(request_type=\"grpc\", name=HOST, response_time=total_time, exception=e)\r\n            else:\r\n                total_time = int((time.time() - start_time) * 1000)\r\n                events.request_success.fire(request_type=\"grpc\", name=HOST, response_time=total_time, response_length=0)\r\n```\r\n\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS:  Linux\r\n- Python version:  `3.8`\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds) `2.5.0`\r\n- Locust command line that you ran: `locust -f benchmark.py  --users 50  --spawn-rate  5  -t 10m  --headless`\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1946/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1946/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1944", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1944/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1944/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1944/events", "html_url": "https://github.com/locustio/locust/issues/1944", "id": 1063388163, "node_id": "I_kwDOABUGS84_YgQD", "number": 1944, "title": "--html doesnt work in web mode", "user": {"login": "charlielinz", "id": 65207965, "node_id": "MDQ6VXNlcjY1MjA3OTY1", "avatar_url": "https://avatars.githubusercontent.com/u/65207965?v=4", "gravatar_id": "", "url": "https://api.github.com/users/charlielinz", "html_url": "https://github.com/charlielinz", "followers_url": "https://api.github.com/users/charlielinz/followers", "following_url": "https://api.github.com/users/charlielinz/following{/other_user}", "gists_url": "https://api.github.com/users/charlielinz/gists{/gist_id}", "starred_url": "https://api.github.com/users/charlielinz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/charlielinz/subscriptions", "organizations_url": "https://api.github.com/users/charlielinz/orgs", "repos_url": "https://api.github.com/users/charlielinz/repos", "events_url": "https://api.github.com/users/charlielinz/events{/privacy}", "received_events_url": "https://api.github.com/users/charlielinz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-11-25T10:12:18Z", "updated_at": "2022-01-30T12:17:02Z", "closed_at": "2022-01-30T12:17:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\nThere is no any setting description about the html option in doc. Only said it \"Store HTML report file\". No any value example.\r\nI tried \"true\", \"html_prefix_like_csv\" and it doesn't work. Can any one tell me what value should I set and where would be the report saved, and is there any way to customized the report html format?\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: MacOS\r\n- Python version: 3.9.0\r\n- Locust version: 2.5.0\r\n- Locust command line that you ran: locust\r\n- Locust file contents (anonymized if necessary): i set html = report.html in locust.config", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1944/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1944/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1941", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1941/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1941/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1941/events", "html_url": "https://github.com/locustio/locust/issues/1941", "id": 1056598982, "node_id": "I_kwDOABUGS84--mvG", "number": 1941, "title": "Website needs a meta image", "user": {"login": "johncarter-phntm", "id": 79816505, "node_id": "MDQ6VXNlcjc5ODE2NTA1", "avatar_url": "https://avatars.githubusercontent.com/u/79816505?v=4", "gravatar_id": "", "url": "https://api.github.com/users/johncarter-phntm", "html_url": "https://github.com/johncarter-phntm", "followers_url": "https://api.github.com/users/johncarter-phntm/followers", "following_url": "https://api.github.com/users/johncarter-phntm/following{/other_user}", "gists_url": "https://api.github.com/users/johncarter-phntm/gists{/gist_id}", "starred_url": "https://api.github.com/users/johncarter-phntm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/johncarter-phntm/subscriptions", "organizations_url": "https://api.github.com/users/johncarter-phntm/orgs", "repos_url": "https://api.github.com/users/johncarter-phntm/repos", "events_url": "https://api.github.com/users/johncarter-phntm/events{/privacy}", "received_events_url": "https://api.github.com/users/johncarter-phntm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-11-17T20:23:34Z", "updated_at": "2022-01-29T14:33:57Z", "closed_at": "2022-01-29T14:33:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "I noticed the website (https://locust.io/ ) is missing a meta image, so different platforms guess differently as to what the image should be.\r\n\r\nGoogle chat for example is picking Armin Ronacher's avatar image, which is confusing:\r\n![image](https://user-images.githubusercontent.com/79816505/142276509-ca3286b0-b3a0-45b6-b438-526bfff26dfe.png)", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1941/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 1, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1941/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1936", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1936/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1936/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1936/events", "html_url": "https://github.com/locustio/locust/issues/1936", "id": 1054671028, "node_id": "I_kwDOABUGS84-3QC0", "number": 1936, "title": "Number of Requests sent shown in locust is different from the requests sent", "user": {"login": "vamsigutta", "id": 19907690, "node_id": "MDQ6VXNlcjE5OTA3Njkw", "avatar_url": "https://avatars.githubusercontent.com/u/19907690?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vamsigutta", "html_url": "https://github.com/vamsigutta", "followers_url": "https://api.github.com/users/vamsigutta/followers", "following_url": "https://api.github.com/users/vamsigutta/following{/other_user}", "gists_url": "https://api.github.com/users/vamsigutta/gists{/gist_id}", "starred_url": "https://api.github.com/users/vamsigutta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vamsigutta/subscriptions", "organizations_url": "https://api.github.com/users/vamsigutta/orgs", "repos_url": "https://api.github.com/users/vamsigutta/repos", "events_url": "https://api.github.com/users/vamsigutta/events{/privacy}", "received_events_url": "https://api.github.com/users/vamsigutta/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2021-11-16T09:52:59Z", "updated_at": "2022-01-29T01:48:53Z", "closed_at": "2022-01-29T01:48:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Description\r\nThe number of requests sent shown in the web ui and cli are different that the requests sent. I have set a configuration of 100 users peak concurrency with spawn rate of 10 users/second. The api was to modify reduce a single value count from a value in db. When tried to match the number of requests with the value in db there is a difference of 100, i.e the last second requests are not found\r\n![image](https://user-images.githubusercontent.com/19907690/141961787-6110fe63-b350-4ae3-a175-e49868e5d82f.png)\r\nI have created a count value in the code to check the actual number of requests\r\n![image](https://user-images.githubusercontent.com/19907690/141962117-ee908e4a-fdf0-49ce-82ac-1934c232ccc3.png)\r\nThe count value matched but not the aggregated value\r\n\r\n### Expected behavior\r\nThe Expected behavior is that the number requests sent should be the same value as the number of requests actually sent\r\n\r\n### Actual behavior\r\nThe last second requests are not taken into account\r\n\r\n### Steps to reproduce\r\n1. Create an API to reduce a count from the DB from 5000 with a value of 1 per request\r\n2. Create a load test in locust to trigger this API\r\n3. Create a configuration or run for specified time and match the number of requests + value in db is not equal to 5000\r\n\r\n### Environment\r\n\r\n- OS: Windows\r\n- Python version: 3.10.0\r\n- Locust version:  2.4.1\r\n- Locust command line that you ran: locust -f benchmark.py\r\n- Locust file contents (anonymized if necessary): shown in the image above", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1936/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1936/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1930", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1930/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1930/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1930/events", "html_url": "https://github.com/locustio/locust/issues/1930", "id": 1050367564, "node_id": "I_kwDOABUGS84-m1ZM", "number": 1930, "title": "Doc Issue | docker-compose.yml pointing to /mnt/locust and Dockerfile using /home/locust", "user": {"login": "pnfnp", "id": 38131266, "node_id": "MDQ6VXNlcjM4MTMxMjY2", "avatar_url": "https://avatars.githubusercontent.com/u/38131266?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnfnp", "html_url": "https://github.com/pnfnp", "followers_url": "https://api.github.com/users/pnfnp/followers", "following_url": "https://api.github.com/users/pnfnp/following{/other_user}", "gists_url": "https://api.github.com/users/pnfnp/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnfnp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnfnp/subscriptions", "organizations_url": "https://api.github.com/users/pnfnp/orgs", "repos_url": "https://api.github.com/users/pnfnp/repos", "events_url": "https://api.github.com/users/pnfnp/events{/privacy}", "received_events_url": "https://api.github.com/users/pnfnp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-11-10T22:22:22Z", "updated_at": "2022-01-11T08:27:56Z", "closed_at": "2022-01-11T08:27:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "The file [docker-compose.yml](https://github.com/locustio/locust/blob/master/examples/docker-compose/docker-compose.yml) is pointing to `/mnt/locust/` while the file [Dockerfile](https://github.com/locustio/locust/blob/master/Dockerfile) is using `WORKDIR /home/locust`\r\n\r\nWouldn't be better to change the `WORKDIR /home/locust` to `WORKDIR /home/locust`?\r\nOr either change the example file to use `/home/locust` instead?\r\n\r\nThanks.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1930/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1930/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1924", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1924/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1924/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1924/events", "html_url": "https://github.com/locustio/locust/issues/1924", "id": 1041851678, "node_id": "I_kwDOABUGS84-GWUe", "number": 1924, "title": "module 'signal' has no attribute 'SIGWINCH'  on 2.4.2    ", "user": {"login": "thylinner", "id": 24264017, "node_id": "MDQ6VXNlcjI0MjY0MDE3", "avatar_url": "https://avatars.githubusercontent.com/u/24264017?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thylinner", "html_url": "https://github.com/thylinner", "followers_url": "https://api.github.com/users/thylinner/followers", "following_url": "https://api.github.com/users/thylinner/following{/other_user}", "gists_url": "https://api.github.com/users/thylinner/gists{/gist_id}", "starred_url": "https://api.github.com/users/thylinner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thylinner/subscriptions", "organizations_url": "https://api.github.com/users/thylinner/orgs", "repos_url": "https://api.github.com/users/thylinner/repos", "events_url": "https://api.github.com/users/thylinner/events{/privacy}", "received_events_url": "https://api.github.com/users/thylinner/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-11-02T03:40:42Z", "updated_at": "2021-11-02T07:08:51Z", "closed_at": "2021-11-02T07:08:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n(windows only?)\r\npip install  2.4.2   >>>  locust -f start.py --master    >>>       \r\n signal.signal(signal.SIGWINCH, resize_handler)\r\nAttributeError: module 'signal' has no attribute 'SIGWINCH'\r\npip install  2.4.1  >>> locust -f start.py --master    >>>       ok\r\n\r\n\"On Windows, signal() can only be called with SIGABRT, SIGFPE, SIGILL, SIGINT, SIGSEGV, or SIGTERM. A ValueError will be raised in any other case.\" --- find in baidu\r\n\r\n### Environment\r\n\r\n- OS:nt\r\n- Python version:3.9.5\r\n- Locust version: 2.4.2\r\n- Locust command line that you ran:   locust -f start.py --master  \r\n- Locust file contents (anonymized if necessary): ", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1924/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1924/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1923", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1923/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1923/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1923/events", "html_url": "https://github.com/locustio/locust/issues/1923", "id": 1041802539, "node_id": "I_kwDOABUGS84-GKUr", "number": 1923, "title": "The response time is not accurate and the timeout setting is not effective", "user": {"login": "4672192zq", "id": 47803360, "node_id": "MDQ6VXNlcjQ3ODAzMzYw", "avatar_url": "https://avatars.githubusercontent.com/u/47803360?v=4", "gravatar_id": "", "url": "https://api.github.com/users/4672192zq", "html_url": "https://github.com/4672192zq", "followers_url": "https://api.github.com/users/4672192zq/followers", "following_url": "https://api.github.com/users/4672192zq/following{/other_user}", "gists_url": "https://api.github.com/users/4672192zq/gists{/gist_id}", "starred_url": "https://api.github.com/users/4672192zq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/4672192zq/subscriptions", "organizations_url": "https://api.github.com/users/4672192zq/orgs", "repos_url": "https://api.github.com/users/4672192zq/repos", "events_url": "https://api.github.com/users/4672192zq/events{/privacy}", "received_events_url": "https://api.github.com/users/4672192zq/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-11-02T01:43:53Z", "updated_at": "2021-11-02T10:54:11Z", "closed_at": "2021-11-02T10:54:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n![image](https://user-images.githubusercontent.com/47803360/139773070-2ced2d5e-84dd-4050-b21d-24e86e053c46.png)\r\n![Uploading image.png\u2026]()\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version:\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds)\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1923/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1923/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1921", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1921/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1921/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1921/events", "html_url": "https://github.com/locustio/locust/issues/1921", "id": 1040979447, "node_id": "I_kwDOABUGS84-DBX3", "number": 1921, "title": "the report cant show the right String", "user": {"login": "4672192zq", "id": 47803360, "node_id": "MDQ6VXNlcjQ3ODAzMzYw", "avatar_url": "https://avatars.githubusercontent.com/u/47803360?v=4", "gravatar_id": "", "url": "https://api.github.com/users/4672192zq", "html_url": "https://github.com/4672192zq", "followers_url": "https://api.github.com/users/4672192zq/followers", "following_url": "https://api.github.com/users/4672192zq/following{/other_user}", "gists_url": "https://api.github.com/users/4672192zq/gists{/gist_id}", "starred_url": "https://api.github.com/users/4672192zq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/4672192zq/subscriptions", "organizations_url": "https://api.github.com/users/4672192zq/orgs", "repos_url": "https://api.github.com/users/4672192zq/repos", "events_url": "https://api.github.com/users/4672192zq/events{/privacy}", "received_events_url": "https://api.github.com/users/4672192zq/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-11-01T09:47:43Z", "updated_at": "2022-02-01T01:50:40Z", "closed_at": "2022-02-01T01:50:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n![N$EC R)BMW3DOP$EZL(1RDH](https://user-images.githubusercontent.com/47803360/139653275-fd53a924-c7c4-4262-abf2-f12f0cf32c62.jpg)\r\nwrong response text{response.text}\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version:\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds)\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1921/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1921/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1919", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1919/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1919/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1919/events", "html_url": "https://github.com/locustio/locust/issues/1919", "id": 1039361547, "node_id": "I_kwDOABUGS84982YL", "number": 1919, "title": "cant close the port    ", "user": {"login": "4672192zq", "id": 47803360, "node_id": "MDQ6VXNlcjQ3ODAzMzYw", "avatar_url": "https://avatars.githubusercontent.com/u/47803360?v=4", "gravatar_id": "", "url": "https://api.github.com/users/4672192zq", "html_url": "https://github.com/4672192zq", "followers_url": "https://api.github.com/users/4672192zq/followers", "following_url": "https://api.github.com/users/4672192zq/following{/other_user}", "gists_url": "https://api.github.com/users/4672192zq/gists{/gist_id}", "starred_url": "https://api.github.com/users/4672192zq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/4672192zq/subscriptions", "organizations_url": "https://api.github.com/users/4672192zq/orgs", "repos_url": "https://api.github.com/users/4672192zq/repos", "events_url": "https://api.github.com/users/4672192zq/events{/privacy}", "received_events_url": "https://api.github.com/users/4672192zq/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-10-29T09:21:47Z", "updated_at": "2021-11-01T08:48:29Z", "closed_at": "2021-10-30T11:03:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n![image](https://user-images.githubusercontent.com/47803360/139410424-03679ed0-3ff4-498e-84e0-c850c493542b.png)\r\n![image](https://user-images.githubusercontent.com/47803360/139410513-06dac3ec-fd30-48f5-bf85-62158a671b30.png)\r\n![image](https://user-images.githubusercontent.com/47803360/139410558-8fec6177-8a7b-41ac-b4d0-4d50fe12831f.png)\r\n\r\n\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nAuto shutdown service stop. Give a parameter\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\ncant close the port\r\n### Steps to reproduce\r\n[full-log (1).txt](https://github.com/locustio/locust/files/7440626/full-log.1.txt)\r\n\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version:\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds)\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1919/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1919/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1915", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1915/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1915/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1915/events", "html_url": "https://github.com/locustio/locust/issues/1915", "id": 1036251673, "node_id": "I_kwDOABUGS849w_IZ", "number": 1915, "title": "Exception then test stops if run in headless mode and autoquit != -1", "user": {"login": "EzR1d3r", "id": 36864517, "node_id": "MDQ6VXNlcjM2ODY0NTE3", "avatar_url": "https://avatars.githubusercontent.com/u/36864517?v=4", "gravatar_id": "", "url": "https://api.github.com/users/EzR1d3r", "html_url": "https://github.com/EzR1d3r", "followers_url": "https://api.github.com/users/EzR1d3r/followers", "following_url": "https://api.github.com/users/EzR1d3r/following{/other_user}", "gists_url": "https://api.github.com/users/EzR1d3r/gists{/gist_id}", "starred_url": "https://api.github.com/users/EzR1d3r/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/EzR1d3r/subscriptions", "organizations_url": "https://api.github.com/users/EzR1d3r/orgs", "repos_url": "https://api.github.com/users/EzR1d3r/repos", "events_url": "https://api.github.com/users/EzR1d3r/events{/privacy}", "received_events_url": "https://api.github.com/users/EzR1d3r/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-10-26T12:42:00Z", "updated_at": "2022-01-19T17:12:26Z", "closed_at": "2022-01-19T17:12:26Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\nException then test stops\r\nvenv\\lib\\site-packages\\locust\\main.py\", line 327, in stop_and_optionally_quit\r\n    web_ui.stop()\r\nAttributeError: 'NoneType' object has no attribute 'stop'\r\n\r\n### Expected behavior\r\nStop without exception\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\nRun test in destributed mode with headless = true and autoquit = 0.\r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version: 3.9\r\n- Locust version: 2.4.0\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1915/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1915/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1910", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1910/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1910/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1910/events", "html_url": "https://github.com/locustio/locust/issues/1910", "id": 1032188401, "node_id": "I_kwDOABUGS849hfHx", "number": 1910, "title": "KeyboardInterrupt does not gracefully exit custom load shape", "user": {"login": "ghost", "id": 10137, "node_id": "MDQ6VXNlcjEwMTM3", "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghost", "html_url": "https://github.com/ghost", "followers_url": "https://api.github.com/users/ghost/followers", "following_url": "https://api.github.com/users/ghost/following{/other_user}", "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghost/subscriptions", "organizations_url": "https://api.github.com/users/ghost/orgs", "repos_url": "https://api.github.com/users/ghost/repos", "events_url": "https://api.github.com/users/ghost/events{/privacy}", "received_events_url": "https://api.github.com/users/ghost/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-10-21T08:08:54Z", "updated_at": "2022-01-01T01:53:34Z", "closed_at": "2022-01-01T01:53:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n### Describe the bug\r\nKeyboardInterrupt does not gracefully exit custom load shape.\r\n\r\n### Expected behavior\r\nA report should be generated after Ctrl-C, like with a normal test case.\r\n\r\n### Actual behavior\r\nThe program crashes:\r\n\r\n```\r\n[2021-10-21 10:07:23,218] user-vm/INFO/locust.runners: Shape worker starting\r\n[2021-10-21 10:07:23,218] user-vm/INFO/locust.runners: Shape test updating to 10 users at 10.00 spawn rate\r\n[2021-10-21 10:07:23,218] user-vm/INFO/locust.runners: Ramping to 10 users at a rate of 10.00 per second\r\n[2021-10-21 10:07:23,219] user-vm/INFO/locust.runners: All users spawned: {\"WebsiteUser\": 10} (10 total users)\r\n^CKeyboardInterrupt\r\n2021-10-21T08:07:24Z\r\nTraceback (most recent call last):\r\n  File \"/home/user/.local/bin/locust\", line 8, in <module>\r\n    sys.exit(main())\r\n  File \"/home/user/.local/lib/python3.7/site-packages/locust/main.py\", line 383, in main\r\n    start_automatic_run()\r\n  File \"/home/user/.local/lib/python3.7/site-packages/locust/main.py\", line 370, in start_automatic_run\r\n    environment.runner.shape_greenlet.join()\r\n  File \"src/gevent/greenlet.py\", line 831, in gevent._gevent_cgreenlet.Greenlet.join\r\n  File \"src/gevent/greenlet.py\", line 857, in gevent._gevent_cgreenlet.Greenlet.join\r\n  File \"src/gevent/greenlet.py\", line 846, in gevent._gevent_cgreenlet.Greenlet.join\r\n  File \"src/gevent/_greenlet_primitives.py\", line 61, in gevent._gevent_c_greenlet_primitives.SwitchOutGreenletWithLoop.switch\r\n  File \"src/gevent/_greenlet_primitives.py\", line 61, in gevent._gevent_c_greenlet_primitives.SwitchOutGreenletWithLoop.switch\r\n  File \"src/gevent/_greenlet_primitives.py\", line 65, in gevent._gevent_c_greenlet_primitives.SwitchOutGreenletWithLoop.switch\r\n  File \"src/gevent/_gevent_c_greenlet_primitives.pxd\", line 35, in gevent._gevent_c_greenlet_primitives._greenlet_switch\r\nKeyboardInterrupt\r\n\r\n```\r\n\r\n### Steps to reproduce\r\nUse [this example](https://github.com/locustio/locust/blob/master/examples/custom_shape/step_load.py) from this very repo, launched as `locust --headless -f step_load.py --host https://localhost`:\r\n\r\n### Environment\r\n\r\n- OS: Linux\r\n- Python version: 3.7.3\r\n- Locust version: 2.4.1\r\n- Locust command line that you ran:`locust --headless -f step_load.py --host https://localhost`\r\n- Locust file contents (anonymized if necessary):  https://github.com/locustio/locust/blob/master/examples/custom_shape/step_load.py", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1910/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1910/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1909", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1909/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1909/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1909/events", "html_url": "https://github.com/locustio/locust/issues/1909", "id": 1032186085, "node_id": "I_kwDOABUGS849hejl", "number": 1909, "title": "the report cant show the right time", "user": {"login": "4672192zq", "id": 47803360, "node_id": "MDQ6VXNlcjQ3ODAzMzYw", "avatar_url": "https://avatars.githubusercontent.com/u/47803360?v=4", "gravatar_id": "", "url": "https://api.github.com/users/4672192zq", "html_url": "https://github.com/4672192zq", "followers_url": "https://api.github.com/users/4672192zq/followers", "following_url": "https://api.github.com/users/4672192zq/following{/other_user}", "gists_url": "https://api.github.com/users/4672192zq/gists{/gist_id}", "starred_url": "https://api.github.com/users/4672192zq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/4672192zq/subscriptions", "organizations_url": "https://api.github.com/users/4672192zq/orgs", "repos_url": "https://api.github.com/users/4672192zq/repos", "events_url": "https://api.github.com/users/4672192zq/events{/privacy}", "received_events_url": "https://api.github.com/users/4672192zq/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-10-21T08:06:27Z", "updated_at": "2021-10-28T17:31:07Z", "closed_at": "2021-10-28T17:31:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n![image](https://user-images.githubusercontent.com/47803360/138236838-6d62d47c-aa4d-4de7-b714-d94b7dff639a.png)\r\n![image](https://user-images.githubusercontent.com/47803360/138236861-d318f852-da06-41e9-abcb-fa18d47166c7.png)\r\nthis picture is right time  i am in china\r\n\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nWrong time zone reported\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version:\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds)\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1909/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1909/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1908", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1908/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1908/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1908/events", "html_url": "https://github.com/locustio/locust/issues/1908", "id": 1031179083, "node_id": "I_kwDOABUGS849dotL", "number": 1908, "title": "cant show html chart version locust 2.4.0", "user": {"login": "4672192zq", "id": 47803360, "node_id": "MDQ6VXNlcjQ3ODAzMzYw", "avatar_url": "https://avatars.githubusercontent.com/u/47803360?v=4", "gravatar_id": "", "url": "https://api.github.com/users/4672192zq", "html_url": "https://github.com/4672192zq", "followers_url": "https://api.github.com/users/4672192zq/followers", "following_url": "https://api.github.com/users/4672192zq/following{/other_user}", "gists_url": "https://api.github.com/users/4672192zq/gists{/gist_id}", "starred_url": "https://api.github.com/users/4672192zq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/4672192zq/subscriptions", "organizations_url": "https://api.github.com/users/4672192zq/orgs", "repos_url": "https://api.github.com/users/4672192zq/repos", "events_url": "https://api.github.com/users/4672192zq/events{/privacy}", "received_events_url": "https://api.github.com/users/4672192zq/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-10-20T09:24:57Z", "updated_at": "2021-10-21T16:35:18Z", "closed_at": "2021-10-21T16:35:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nHeadless mode cannot view charts-html\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nThe generated htlm can be displayed normally\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n![image](https://user-images.githubusercontent.com/47803360/138066589-6cfc194d-9fbb-4142-9683-1c54917e8528.png)\r\n\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n`from locust import HttpUser,TaskSet,between,task,FastHttpUser\r\n\r\nfrom locust import LoadTestShape\r\n\r\n\r\n\r\nheaders = {\"Content-Type\": \"application/json\", \"app_id\": \"101\"}\r\nclass UserBehavior(TaskSet):\r\n\r\n    def on_start(self):\r\n        pass\r\n    @task\r\n    def test_health(self):\r\n        '''\u67e5\u8be2\u5168\u90e8'''\r\n\r\n        url = '/statapi/health'\r\n\r\n        with self.client.get(url,catch_response=True,timeout=3) as response:\r\n            # print(\"=====\", response)\r\n            if response.status_code!=200:\r\n                response.failure('Failed!')\r\n\r\n\r\n    def on_stop(self):\r\n        pass\r\n\r\n\r\n\r\n\r\nclass MyCustomShape(LoadTestShape):\r\n\r\n\r\n    stages = [\r\n        {\"time\": 10, \"users\": 100, \"spawn_rate\": 50},\r\n        {\"time\": 30, \"users\": 200, \"spawn_rate\": 50},\r\n\r\n    ]\r\n    def tick(self):\r\n        run_time = self.get_run_time()\r\n        print(\"run_time:\",run_time)\r\n        for stage in self.stages:\r\n\r\n            if run_time < stage['time']:\r\n                print('11111',stage['time'])\r\n                tick_data = (stage['users'],stage['spawn_rate'])\r\n                print('tick_data', tick_data)\r\n                return tick_data\r\n        return None\r\n\r\n\r\n        # return None\r\nclass WebsiteUser(FastHttpUser):\r\n    tasks = [UserBehavior]\r\n\r\n    wait_time = between(1, 1)\r\n`\r\n### Environment\r\n\r\n- OS:\r\n- Python version:3.9\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds)\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1908/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1908/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1906", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1906/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1906/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1906/events", "html_url": "https://github.com/locustio/locust/issues/1906", "id": 1028254601, "node_id": "I_kwDOABUGS849SeuJ", "number": 1906, "title": "No longer logging interval stats when using LoadTestShape after 2.1.x", "user": {"login": "dbfx", "id": 182394, "node_id": "MDQ6VXNlcjE4MjM5NA==", "avatar_url": "https://avatars.githubusercontent.com/u/182394?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbfx", "html_url": "https://github.com/dbfx", "followers_url": "https://api.github.com/users/dbfx/followers", "following_url": "https://api.github.com/users/dbfx/following{/other_user}", "gists_url": "https://api.github.com/users/dbfx/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbfx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbfx/subscriptions", "organizations_url": "https://api.github.com/users/dbfx/orgs", "repos_url": "https://api.github.com/users/dbfx/repos", "events_url": "https://api.github.com/users/dbfx/events{/privacy}", "received_events_url": "https://api.github.com/users/dbfx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-10-17T08:22:59Z", "updated_at": "2021-10-18T12:31:42Z", "closed_at": "2021-10-18T12:31:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nIf I use any LoadTestShape test in 2.1.0 it will log interval statistics (CSV) every X seconds depending on CSV_STATS_INTERVAL_SEC.\r\n\r\nHowever, from 2.2 (up to and including 2.4) it will not log the interval stats. \r\n\r\n### Expected behavior\r\nShould see output like so: \r\n```\r\n Aggregated                                                                            48     0(0.00%)  |     331      75    1089      99  |    2.10    0.00\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n GET /                                                                                 48     0(0.00%)  |     331      75    1089      99  |    2.10    0.00\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n Name                                                                              # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n\r\n Aggregated                                                                            44     0(0.00%)  |     353      75    1089     100  |    2.10    0.00\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n GET /                                                                                 44     0(0.00%)  |     353      75    1089     100  |    2.10    0.00\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n```\r\n\r\n### Actual behavior\r\nYou see the shape launching debug info, but no aggregated stats etc.\r\n\r\n### Steps to reproduce\r\nUse any LoadTestShape test, for example: \r\n```\r\nimport math\r\nfrom locust import HttpUser, TaskSet, task, between\r\nfrom locust import LoadTestShape\r\n\r\nclass QuickstartUser(HttpUser):\r\n    wait_time = between(5, 9)\r\n\r\n    @task(1)\r\n    def index_page(self):\r\n        self.client.get(\"/\")\r\n\r\n\r\nclass DoubleWave(LoadTestShape):\r\n    \"\"\"\r\n    A shape to imitate some specific user behavior. In this example, midday\r\n    and evening meal times. First peak of users appear at time_limit/3 and\r\n    second peak appears at 2*time_limit/3\r\n    Settings:\r\n        min_users -- minimum users\r\n        peak_one_users -- users in first peak\r\n        peak_two_users -- users in second peak\r\n        time_limit -- total length of test\r\n    \"\"\"\r\n\r\n    min_users = 20\r\n    peak_one_users = 60\r\n    peak_two_users = 40\r\n    time_limit = 300\r\n\r\n    def tick(self):\r\n        run_time = round(self.get_run_time())\r\n\r\n        if run_time < self.time_limit:\r\n            user_count = (\r\n                (self.peak_one_users - self.min_users)\r\n                * math.e ** -(((run_time / (self.time_limit / 10 * 2 / 3)) - 5) ** 2)\r\n                + (self.peak_two_users - self.min_users)\r\n                * math.e ** -(((run_time / (self.time_limit / 10 * 2 / 3)) - 10) ** 2)\r\n                + self.min_users\r\n            )\r\n            return (round(user_count), round(user_count))\r\n        else:\r\n            return None    \r\n```\r\n\r\n### Environment\r\n\r\n- OS: Linux\r\n- Python version: 3\r\n- Locust version: 2.2, 2.4\r\n- Locust command line that you ran: ```/usr/local/bin/locust -f ./shape.py --host https://testsite:443 --headless --csv=mycsv --csv-full-history -LDEBUG```\r\n- Locust file contents (anonymized if necessary): above", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1906/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1906/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1905", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1905/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1905/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1905/events", "html_url": "https://github.com/locustio/locust/issues/1905", "id": 1024745272, "node_id": "I_kwDOABUGS849FF84", "number": 1905, "title": "Locust logs everything to stderr", "user": {"login": "KasimAhmic", "id": 1304204, "node_id": "MDQ6VXNlcjEzMDQyMDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1304204?v=4", "gravatar_id": "", "url": "https://api.github.com/users/KasimAhmic", "html_url": "https://github.com/KasimAhmic", "followers_url": "https://api.github.com/users/KasimAhmic/followers", "following_url": "https://api.github.com/users/KasimAhmic/following{/other_user}", "gists_url": "https://api.github.com/users/KasimAhmic/gists{/gist_id}", "starred_url": "https://api.github.com/users/KasimAhmic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/KasimAhmic/subscriptions", "organizations_url": "https://api.github.com/users/KasimAhmic/orgs", "repos_url": "https://api.github.com/users/KasimAhmic/repos", "events_url": "https://api.github.com/users/KasimAhmic/events{/privacy}", "received_events_url": "https://api.github.com/users/KasimAhmic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901882, "node_id": "MDU6TGFiZWwxNjM1OTAxODgy", "url": "https://api.github.com/repos/locustio/locust/labels/wontfix", "name": "wontfix", "color": "ddcccc", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-10-13T03:57:09Z", "updated_at": "2021-10-20T14:37:49Z", "closed_at": "2021-10-20T07:59:16Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nAs far as I can tell, 100% of the output for Locust is logged to stderr and I've not found a way to change this behavior.\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nI would expect the DEBUG, INFO, and WARN levels to be logged to stdout and the ERROR, FATAL, and CRITICAL levels to be logged to stderr.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nAll data is logged to stderr.\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\nCan be reproduced in an IDE such as PyCharm that will highlight the text red to denote stderr output. Below is basic example of what I'm doing with Node.js to run Locust.\r\n\r\n```javascript\r\nconst { spawn } = require('child_process');\r\n\r\nconst process = spawn('python', ['-u', '-m', 'locust']);\r\n\r\nprocess.stdout.on('data', (data) => console.log('STDOUT', data));\r\nprocess.stderr.on('data', (data) => console.log('STDERR', data));\r\n```\r\n\r\n### Environment\r\n\r\n- OS: Windows 10 (Build 19043)\r\n- Python version: Python 3.9\r\n- Locust version: 2.2.3\r\n- Locust command line that you ran: `python -m locust`\r\n- Locust file contents (anonymized if necessary):\r\n```python\r\nfrom locust import task, FastHttpUser\r\nimport logging\r\n\r\n\r\nclass User(FastHttpUser):\r\n    wait_time = 5\r\n\r\n    @task\r\n    def todos(self):\r\n        logging.info(\"Starting request for todos\")\r\n        response = self.client.get(path=\"https://jsonplaceholder.typicode.com/todos/1\")\r\n        logging.info(response.text)\r\n\r\n    @task\r\n    def posts(self):\r\n        logging.info(\"Starting request for posts\")\r\n        response = self.client.get(path=\"https://jsonplaceholder.typicode.com/posts/1\")\r\n        logging.info(response.text)\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1905/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1905/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1903", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1903/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1903/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1903/events", "html_url": "https://github.com/locustio/locust/issues/1903", "id": 1022508689, "node_id": "I_kwDOABUGS8488j6R", "number": 1903, "title": "multipart-form upload fails after 1st run", "user": {"login": "Atharex", "id": 2872241, "node_id": "MDQ6VXNlcjI4NzIyNDE=", "avatar_url": "https://avatars.githubusercontent.com/u/2872241?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Atharex", "html_url": "https://github.com/Atharex", "followers_url": "https://api.github.com/users/Atharex/followers", "following_url": "https://api.github.com/users/Atharex/following{/other_user}", "gists_url": "https://api.github.com/users/Atharex/gists{/gist_id}", "starred_url": "https://api.github.com/users/Atharex/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Atharex/subscriptions", "organizations_url": "https://api.github.com/users/Atharex/orgs", "repos_url": "https://api.github.com/users/Atharex/repos", "events_url": "https://api.github.com/users/Atharex/events{/privacy}", "received_events_url": "https://api.github.com/users/Atharex/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-10-11T10:05:37Z", "updated_at": "2021-10-11T10:18:58Z", "closed_at": "2021-10-11T10:18:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nI have created a locustfile.py and locust.conf to interact with a service, which expects a multipart/form-data upload of a raw image. (i.e. in curl terminology -- `curl -X POST -H \"Content-Type: multipart/form-data\" -F \"binData=@image.jpg\" <endpoint>`)\r\n\r\nThis simple requests script, which does the same action works correctly:\r\n```\r\nimport requests\r\n\r\nurl = \"<endpoint>\"\r\nimage = \"image.jpg\"\r\nfiles = {\"binData\": (\"image.jpg\", open(image, \"rb\"), \"image/jpeg\")}\r\nresponse = requests.post(url, files=files)\r\n```\r\nWhen I try a similar `locustfile.py`:\r\n```\r\nfrom locust import HttpUser, task, events\r\nfiles = {'binData': (\"image.jpg\", open('image.jpg', 'rb'), \"image/jpeg\")}\r\nclass QuickstartUser(HttpUser):\r\n    @task\r\n    def model_predictions(self):\r\n        response = self.client.post(\"/<api-endpoint>\", files=files)\r\n        print(response.request.body)\r\n```\r\n\r\nI get only the 1st request to execute correctly, but all the subsequent ones to fail, because the request body seems to be missing the image data.\r\n\r\nThis is how the responses look like:\r\n\r\n```\r\n[2021-10-11 09:59:45,238] benchmark-7ctq2-1739884279/INFO/locust.runners: Ramping to 1 users at a rate of 1.00 per second\r\n[2021-10-11 09:59:45,239] benchmark-7ctq2-1739884279/INFO/locust.runners: All users spawned: {\"QuickstartUser\": 1} (1 total users)\r\nb'--6bbe8965f14970343b22e227719cc59f\\r\\nContent-Disposition: form-data; name=\"binData\"; filename=\"image.jpg\"\\r\\nContent-Type: image/jpeg\\r\\n\\r\\n\\xff\\xd8\\xff\\xe0\\x00\\x10JFIF\\x00\\x01\\x01\\x00\\x00\\x01\\x00\\x01\\x00\\x00\\xff\\xdb\\x00\\x84\\x00\\t\\x06\\x07\\x12\\x11\\x12\\x10\\x12\\x11\\x12\\x12\\x12\\x10\\x11\\x13\\x15\\x15\\x15\\x13\\x18\\x11\\x13\\x15\\x15\\x16\\x18\\x15\\x18\\x17\\x17\\x15\\x16\\x13\\x15\\x18 ( \\x18\\x1a%\\x1b\\x13\\x17!1!%)+...\\x17\\x1f383,7(-.+\\x01\\n\\n\\n\\x05\\x05\\x05\\x0e\\x05\\x05\\x0e+\\x19\\x13\\x19++++++++++++++++++++++++++++++++++++++++++++++++++\\xff\\xc0\\x00\\x11\\x08\\x00\\xe1\\x00\\xe0\\x03\\x01\"\\x00\\x02\\x11\\x01\\x03\\x11\\x01\\xff\\xc4\\x00\\x1c\\x00\\x01\\x00\\x02\\x02\\x03\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x05\\x06\\x04\\x07\\x01\\x03\\x08\\x02\\xff\\xc4\\x00J\\x10\\x00\\x01\\x03\\x01\\x02\\x07\\n\\x0b\\x05\\x07\\x04\\x03\\x01\\x00\\x00\\x00\\x01\\x00\\x02\\x03\\x04\\x05\\x11\\x06\\x12!4Qt\\xd3\\x14\\x161ATa\\x92\\x94\\xb4\\xd1\\x13\"#$2BCRSUq\\x073r\\x91\\xb1\\x155s\\x82\\x93\\xb2\\xb3Db\\x81\\xa1\\xa2\\xc1\\xd2%\\xff\\xc4\\x00\\x14\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xff\\xc4\\x00\\x14\\x11\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xff\\xda\\x00\\x0c\\x03\\x01\\x00\\x02\\x11\\x03\\x11\\x00?\\x00\\xd9-\\xa8\\xae\\x9e\\xa2\\xb1\\x90\\xcfO\\x14T\\xf21\\x8d\\x0f\\xa6|\\x8e8\\xd12BK\\x84\\x8d\\xe3~\\x8e%\\x91\\xb8\\xed>WI\\xd4\\xa4\\xdb.p{:\\xb5u\\x88\\xbb4*}\\x05\\x7fq\\xda|\\xae\\x93\\xa9I\\xb6M\\xc7i\\xf2\\xbaN\\xa5&\\xd9X\\x11\\x05\\x7fq\\xda|\\xae\\x93\\xa9I\\xb6M\\xc7i\\xf2\\xbaN\\xa5&\\xd9X\\x11\\x05\\x7fq\\xda|\\xae\\x93\\xa9I\\xb6M\\xc7i\\xf2\\xbaN\\xa5&\\xd9X\\x11\\x05\\x7fq\\xda|\\xae\\x93\\xa9I\\xb6M\\xc7i\\xf2\\xbaN\\xa5&\\xd9X\\x11\\x05\\x7fq\\xda|\\xae\\x93\\xa9I\\xb6M\\xc7i\\xf2\\xbaN\\xa5&\\xd9X\\x11\\x05\\x7fq\\xda|\\xae\\x93\\xa9I\\xb6M\\xc7i\\xf2\\xbaN\\xa5&\\xd9X\\x11\\x05\\x7fq\\xda|\\xae\\x93\\xa9I\\xb6M\\xc7i\\xf2\\xbaN\\xa5&\\xd9X\\x11\\x05\\x7fq\\xda|\\xae\\x93\\xa9I\\xb6M\\xc7i\\xf2\\xbaN\\xa5&\\xd9X\\x11\\x05\\x7fq\\xda|\\xae\\x93\\xa9I\\xb6M\\xc7i\\xf2\\xbaN\\xa5&\\xd9X\\x11\\x05\\x7fq\\xda|\\xae\\x93\\xa9I\\xb6M\\xc7i\\xf2\\xbaN\\xa5&\\xd9X\\x11\\x05\\x7fq\\xda|\\xae\\x93\\xa9I\\xb6M\\xc7i\\xf2\\xbaN\\xa5&\\xd9X\\x11\\x05\\x7fq\\xda|\\xae\\x93\\xa9I\\xb6M\\xc7i\\xf2\\xbaN\\xa5&\\xd9X\\x11\\x05\\x7fq\\xda|\\xae\\x93\\xa9I\\xb6X\\xee\\xa8\\xae\\x82\\xa2\\x8d\\x93OO,U\\x12=\\x8e\\x0c\\xa6|n\\x18\\xb1>@C\\x8c\\x8e\\xe3f\\x8e5hP\\x18C\\x9dYZ\\xc4\\xbd\\x9ad\\x0c\\x1e\\xce\\xad]b.\\xcd\\n\\x9fP\\x18=\\x9dZ\\xba\\xc4]\\x9a\\x15>\\x80\\x88\\x88\\x08\\x88\\x80\\x88\\x88\\x08\\x88\\x80\\x88\\x88\\x08\\x88\\x80\\x88\\x88\\x08\\x88\\x80\\x88\\x88\\x08\\x88\\x80\\x88\\x88\\x08\\x88\\x80\\xa00\\x87:\\xb2\\xb5\\x89{4\\xca}@a\\x0euek\\x12\\xf6i\\x900{:\\xb5u\\x88\\xbb4*}@`\\xf6uj\\xeb\\x11vhT\\xfa\\x02\" \"\"\\x02\" \"\"\\x02\" \"\"\\x02.\\x1d\\xc0V+\\xa5u\\xc7/\\xe8\\x83-\\x14-\\xa7]#\"\\x91\\xcdu\\xcekI\\x06\\xe1\\xdc\\xaara%P\\x07\\xca\\xf1{\\x8c\\xeeA\\xb1\\x91k\\xab\\x13\\t*\\xa4\\xa8\\x85\\x8f\\x96\\xf69\\xe0\\x11\\x88\\xc1x\\xfa\\x80\\xb6\\x03\\\\oA\\xda\\x88\\x88\\x08\\x88\\x80\\x88\\x88\\n\\x03\\x08s\\xab+X\\x97\\xb3L\\xa7\\xd4\\x06\\x10\\xe7VV\\xb1/f\\x99\\x03\\x07\\xb3\\xabWX\\x8b\\xb3B\\xa7\\xd4\\x06\\x0fgV\\xae\\xb1\\x17f\\x85O\\xa0\"\"\\x02\" \"\"\\x02\" \"\\x15]\\xa8\\xaa\\x901\\xe4=\\xd7\\x86\\xbb\\x8c\\xe8(\\'\\xe575\\xdfB\\xa1\\xe7\\xabxk\\x88q\\xbc4\\x9e-\\x0bO\\xd6\\xe1%h\\x8aC\\xba\\xa7\\xbf\\xc1\\xbb/\\x84w\\xbaV\\xbd8ch\\x91\\x96\\xba\\xa7(\\xf8\\xaeA\\xb2\\xe6\\xc2\\xea\\xfcG\\x1d\\xd5%\\xf8\\xa4\\xf03G\\xd1Ujp\\xee\\xd3\\x0cy\\x15\\xb3^\\x1aO\\x04z?\\n\\xa3\\x9b^\\xa0\\x8b\\xbc4\\x97]\\xef\\x15\\xd3\\x1dK\\xc9\\x00\\xb8\\x90M\\xc4_\\x92\\xe4\\x16\\x19~\\xd0\\xadG\\x02\\xd7V\\xcaZE\\xc4\\\\\\xce\\xe5\\x86p\\xba\\xbb\\x94\\xbf\\xf2or\\xea\\x8e\\x16^<V\\xfeAvT\\xd3\\xb01\\xe45\\xb7\\x86\\x9e!\\xa1\\x06~\\x0e\\xe1Ef\\xe9\\xa7\\xf3\\x87\\xfd\\xe0\\xe2or\\xdc\\x98\\'\\x84\\x15R\\xd5\\xd3\\xb2I\\xde\\xe69\\xce\\xbd\\xa7\\x16\\xe3\\xe28\\xf1\\r!y\\xda\\x92B\\xd7\\xb1\\xcd$8\\x1c\\x84p\\x85|\\xfb:\\xb4\\xa66\\x95\\x102\\xbc\\x82\\xf7\\xde1\\x8f\\xc2\\x91\\x07\\xa8\\x11DPN\\xe2\\xf6\\x82\\xe2F\\\\\\x97\\xf3)t\\x04D@DD\\x05\\x01\\x849\\xd5\\x95\\xacK\\xd9\\xa6S\\xea\\x03\\x08s\\xab+X\\x97\\xb3L\\x81\\x83\\xd9\\xd5\\xab\\xacE\\xd9\\xa1S\\xea\\x03\\x07\\xb3\\xabWX\\x8b\\xb3B\\xa7\\xd0\\x11\\x11\\x01\\x11\\x10\\x11\\x11\\x01a\\x97\\x1b\\xf8O\\x0e\\x95\\x98\\xb5\\xd5U\\xa30\\x92@%x\\x01\\xee\\x03\\xc6>\\xf1AM\\xa8\\xb5\\xeaq\\x9f\\xe7\\x13\\xfaN\\xf6\\xd2i<\\xebX\\x9bz\\xae\\xec\\xee\\xab\\x83\\x94\\xcd\\xff\\x00\\xd2\\xc6\\xab\\xb6*1\\xe4\\xf2\\xd2zn\\xf5\\x8e\\x92\\xa3q\\xce\\x92\\x83\\xbc\\xd7\\xccE\\xc6Y\\x08<^\\x11\\xd7~\\xab\\xa2\\xf5\\xc2\\xe5\\xbc#\\xea\\x10}C\\xe97\\xea?Uo\\xc1jf:\\xb6\\x8d\\xaec\\x0bMD@\\x82\\xd0A\\x05\\xc2\\xf0G\\x1a\\xc4\\xb1i\"uM3K\\x18Z\\xe9\\xe1\\x04\\x10. \\xc8\\xd0A\\xe6^\\x8b\\xa2\\xc1z\\x16I\\x1b\\x99IN\\xd75\\xe0\\xb5\\xc2&\\x82\\x089\\x087p\\xa0:\\xc1\\xa4\\xe4\\xb4\\xff\\x00\\xd0\\x8f\\xb9B\\xe1\\x85\\x8fL\\xda\\n\\xf76\\x9e\\x06\\xb9\\xb4\\xb3\\x90D,\\x04\\x11\\x1b\\xae \\x81\\x90\\xab\\xfd\\\\\\r\\x0cq\\r\\x17\\xdd\\xa1S\\xb0\\xd4\\x7f\\xf9\\xf6\\x86\\xa9?\\xf8\\xdc\\x83\\xcb!Z>\\xcd\\x9e\\x7fi\\xd1\\xe5>\\x9b\\xf8\\xcf\\xc3z\\xab\\x85f\\xfb5\\xfd\\xe7G\\xf8\\x9f\\xfe7\\xa0\\xf4\\xa5\\x8a\\xe3\\xe1\\x99\\x94\\xfa\\xdc|\\xc5Y\\xd5^\\xc4\\xfb\\xe6\\x7f7\\xf6\\x95h@DD\\x04D@P\\x18C\\x9dYZ\\xc4\\xbd\\x9ae>\\xa00\\x87:\\xb2\\xb5\\x89{4\\xc8\\x18=\\x9dZ\\xba\\xc4]\\x9a\\x15>\\xa00{:\\xb5u\\x88\\xbb4*}\\x01\\x11\\x10\\x11\\x11\\x01\\x11\\x10p\\xbc\\xe1k\\xd7\\xc8**G\\x85x\\xbayE\\xde\\x11\\xde\\xfb\\xb9\\xd7\\xa4\\x14\\x14\\x94qc\\x1f\\'\\x1f\\t\\xf5\\x1b\\xa7\\xe8\\x83\\xc7\\xb2\\x9f\\x19\\xdfS\\xfa\\xae\\x1b\\xc2>\\xa1n\\xc9)\\xa3\\xc6w\\x88\\xcfH\\xfa\\x8d\\xd3\\xf4W\\x86PCx\\xf2Qp\\x8ff\\xce\\xe4\\x1eu\\xa7lx\\xec\\xf4=&\\xe8\\xd2\\x15\\xb2\\x96\\x8e\\x1cx\\xfc\\x9c^\\x9b}F\\xe9\\x0b\\x7fGA\\r\\xe3\\xc8\\xc5\\xc2=\\x9b;\\x94\\x9e\\xe1\\x8b\\xe1G\\xd0or\\n\\xfc6%({H\\xa6\\xa7\\x048\\x10D1\\x82\\x089\\x08\\xc8\\xac\\xc26\\xe8\\x1f\\x90\\\\\\xe2\\r\\x03\\xf2_H0\\xad\\x93t\\x12\\xdd\\x90\\xe2\\x95\\xad0\\xb2Wn*\\xdf\\x19\\xd9\\xb4\\xdcg\\xdcr\\xd8\\xf8C\\x9bO\\xf8\\n\\xd4\\xb8L\\xef3\\xab\\xcb\\xfe\\x9e^?\\xf6\\x14\\x1a$+7\\xd9\\xaf\\xef:?\\xc4\\xff\\x00\\xf1\\xbdVB\\xb3}\\x9a\\xfe\\xf3\\xa3\\xfcO\\xff\\x00\\x1b\\xd0zN\\xc4\\xfb\\xe6\\x7f7\\xf6\\x95hU{\\x13\\xef\\x99\\xfc\\xdf\\xdaU\\xa1\\x01\\x11\\x10\\x11\\x11\\x01@a\\x0euek\\x12\\xf6i\\x94\\xfa\\x80\\xc2\\x1c\\xea\\xca\\xd6%\\xec\\xd3 `\\xf6uj\\xeb\\x11vhT\\xfa\\x80\\xc1\\xec\\xea\\xd5\\xd6\"\\xec\\xd0\\xa9\\xf4\\x04D@DD\\x04D@K\\x91\\x10|\\xe2\\r\\x03\\xf2\\\\\\xdc\\x17(\\x81r,[M\\xdeFk\\x8e_\\x06\\xff\\x00\\xed+U\\xee\\xa9>#\\xfan\\xefA\\xb7\\x91i\\x9d\\xd7\\'\\xc4\\x93\\xfa\\x8e\\xef\\\\n\\xb9>$\\x9f\\xd4wz\\r\\x99\\x86y\\x8d_\\xf0\\x9c\\xb4\\x1d\\xb0|\\x84\\xff\\x00\\xc2\\x7f\\xf6\\x95c\\xb7*\\xa44\\xf3\\x03#\\xc8\\xc4>\\xbb\\xbb\\xd6\\xbb\\xaey\\xf0re>\\x83\\xb8\\xce\\x84\\x15ef\\xfb5\\xfd\\xe7G\\xf8\\x9f\\xfe7\\xa8+7\\xefc\\xfcAl\\xdf\\xb3x\\xdb\\xfbN\\x8b\\xc5o\\xa6\\xfe!\\xf0\\xde\\x83qX\\x9f|\\xcf\\xe6\\xfe\\xd2\\xad+\\xad\\x91\\xb4\\x1c\\x80\\x0f\\xf8\\x0b\\xb1\\x01\\x11\\x10\\x11\\x11\\x01@a\\x0euek\\x12\\xf6i\\x94\\xfa\\x80\\xc2\\x1c\\xea\\xca\\xd6%\\xec\\xd3 `\\xf6uj\\xeb\\x11vhT\\xfa\\x80\\xc1\\xec\\xea\\xd5\\xd6\"\\xec\\xd0\\xa9\\xf4\\x04D@DD\\x04E\\xc5\\xe89_8\\xe3H\\xfc\\xd6>\\xe8g\\xbe\\xce\\x93UB{R\\x9c=\\xd7\\xcf\\x06G;\\xdbG\\xa4\\xf3\\xa0\\xb5\\x9a\\x96e\\xf1\\xd9\\xd3oz\\xaa\\xd5T\\xb3\\x12O\\x1d\\xbe\\x83\\xbdq\\xa0\\xf3\\xaf7U\\xb5\\x85\\xf2\\x1f\\x14\\xde\\xf7h\\xd2V\\x08\\xb3f\\xf82\\xff\\x00M\\xfd\\xc8.US\\x1f\\x06\\xff\\x00\\x18\\xfa\\x0e\\xf5\\xb9\\x8a\\xa3\\x07\\xbbK\\xbf2\\xa4\\xd9c\\xd4^<\\xda~\\x11\\xec$\\xeeR\\x11\\xd8\\xd5W\\x8f5\\xaa\\xe1\\x1f\\xe9\\xa6\\xd3\\xf8PWN?\\xfb\\xff\\x00\\xf2_>\\x11\\xdaO\\xe6V\\xcb\\xad\\xb3\\xe7\\x11\\xc8L3\\x00\\x18\\xec\\xbe\\t\\xfa\\x0f2\\xd7\\x8fa\\xb8\\xe4<\\x1a\\n\\x0cs!\\xd2\\x7f2\\xb9\\x84\\xf8\\xcd\\xfa\\x85\\xf0\\xbe\\xa3\\xe1\\x1fP\\x82\\xe3\\x80\\x97~\\xd1\\xa1\\xbe\\xeb\\xbc;\\x7fB\\xbd%A\\x8b\\xe1\\x19v-\\xf7\\xf3h+\\xcb\\x98;#EU9.h\\x02Ay$\\x00>\\xa5n\\\\\\x14\\xad\\x88\\xd5\\xc1t\\xb1_\\x8c}\\xa3=\\xd7s\\xa0\\xdbH\\xb1\\xa2\\x9d\\x84\\x80\\x1e\\xd2t\\x07\\x02VE\\xe89DD\\x04D@P\\x18C\\x9dYZ\\xc4\\xbd\\x9ae>\\xa00\\x87:\\xb2\\xb5\\x89{4\\xc8\\x18=\\x9dZ\\xba\\xc4]\\x9a\\x15>\\xa00{:\\xb5u\\x88\\xbb4*}\\x01\\x11\\x10\\x11\\x12\\xf4\\x1c^\\xa3\\x1dlS\\x02A\\xa8\\x80\\x10H#\\xc2\\xb2\\xf0G\\x089VC\\xabb\\x04\\x83,`\\x83\\x94xF\\xde>\\xa2\\xf5\\xa4\\xed\\n\\xc8\\xbc,\\xdeR?\\xbd\\x7f\\xb4o\\xbcy\\xd0O\\xbf\\x08\\xe8\\xb1\\x8f\\x9d\\xd2\\xf0\\x9fo\\x1e\\x9f\\xaa\\xd0V\\xbb\\xc3\\xa7\\xa8sH-2\\xc8A\\x06\\xf0Aq\\xb8\\x83\\xa1tN<g~#\\xfa\\xae\\xd1f\\xceE\\xe2\\x19H<~\\r\\xfd\\xc8\\x11\\xd1Kx\\xf2Rp\\x8fQ\\xdd\\xcb{Ce\\xd4c7\\xc8M\\xc2=\\x9b\\xf4\\xfd\\x15.\\x0b6\\x7f\\x13\\xc8O\\xea\\xfb\\x199\\xb9\\x97\\xa2@98PAS\\xd3H\\x1e\\xc2X\\xf0\\x03\\x81\\'\\x14\\xe9VW\\xcc\\xd0\\t.\\x00\\x00M\\xf7\\x85\\xf35C\\x03\\\\K\\xda\\x00\\x07.0\\xd0\\xa0k-8<\\x1c\\x9e^\\x1fA\\xde\\xd6?t\\xf3\\xa0\\xc1\\xb6\\xf0\\x92\\x89\\xd4\\xd5 VS\\x12`\\x94\\x00*#$\\x92\\xc7\\\\\\x06\\\\\\xab\\xcd\\xd5\\x15\\x0c1\\xb8\\x07\\xb4\\x92\\xd3\\x93\\x18hY\\x0f\\x91\\xbe\\x0c\\xe5m\\xf8\\x87\\x8chU\\xe8\\xe0y \\x068\\x92@\\x004\\x92N\\x80\\x10|\\xc5\\x13\\x9cCZ\\xd2\\xe7\\x1c\\x80\\x00I?@8VQ\\xb2j\\x06S\\x04\\xd7\\x7f\\t\\xfd\\xcac\\x06\\xac\\xaa\\x81UNL\\x13\\x80$\\x1e\\xc6M\\x07\\x99l\\xca\\xba\\t\\xb1\\x1f\\xe4e\\xf4O\\xb2~\\x8f\\xa2\\r*\\xfa9\\x00$\\xc6\\xf0\\x07\\t,p\\x03\\xeanR\\xf8\\x11;#\\xae\\xa6|\\x8ek\\x18\\xd7:\\xf78\\x86\\xb4x\\x8e\\x19I\\xc8\\x15\\x9e\\xd7\\xb3\\'\\xf02\\xf9\\t\\xfd\\x03\\xecd\\xeeTw\\xd9U\\x00^`\\x98\\x01\\xc2LO\\x03\\xf4A\\xe8l\\x1d\\xc2*-\\xd1\\x1f\\x9d\\xd3z\\xde\\xde?t\\xf3\\xab\\xd5%\\xb9J\\xf7b\\xb2\\xa6\\x9d\\xee\\xb8\\x9b\\x9b4d\\xe4\\xe6\\x05y\\x1e\\xc6\\x81\\xcd\\x99\\x8es\\\\\\xd6\\x8cl\\xa5\\xa4\\x0e\\x03\\xc6V\\xc4\\xc0\\x9a\\xa8\\xdbT\\xd2\\xe9#h\\xc4~R\\xf6\\x81\\xc1\\xa4\\x94\\x1e\\x82\\x15\\xb1\\xfcFt\\xda\\xb9\\xddQ\\xfb\\xec\\xe9\\x05C\\x82\\xd4\\xa7\\xc6\\x1e^\\x0f\\xebG\\xde\\xb2\\xc5\\xabO\\xf1\\xe0\\xfe\\xb4}\\xe8.l\\x9d\\xae\\xc8\\x1c\\xd2t\\x02\\n\\xecU\\xbc\\x1f\\xac\\x89\\xf2\\xdc\\xc9#{\\xb1\\t\\xb9\\xb25\\xc6\\xeb\\xc6[\\x81VD\\x05\\x01\\x849\\xd5\\x95\\xacK\\xd9\\xa6S\\xea\\x03\\x08s\\xab+X\\x97\\xb3L\\x81\\x83\\xd9\\xd5\\xab\\xacE\\xd9\\xa1S\\xea\\x03\\x07\\xb3\\xabWX\\x8b\\xb3B\\xa7\\xd0\\x11\\x11\\x01aIh\\xc2\\xd2C\\xa5\\x888\\x1b\\x8824\\x11\\xf5\\x17\\xac\\xd5\\xa7\\xf0\\x92\\xdd\\xa5e]K_<Msep-/\\x00\\x83\\x7f\\x01A\\rm\\xda\\xf4\\xdb\\xa6\\xa7\\xcb\\xc1\\xf7\\xf2\\xfbV{\\xe7\\x9di\\xfa\\xfc\\xb2JFP^\\xf2\\x0f\\x15\\xd7\\x9b\\x88+\\xb2\\xda\\x91\\xae\\xa8\\xa9sH-t\\xd2\\x10G\\x01\\x05\\xe4\\x82\\x17[\\x8eO\\xf8A lJ\\xa23Z\\x8e\\x0f\\x81/r\\xdd\\x96}\\x9f?\\x81\\x84x)~\\xe9\\x9e\\xcd\\xfe\\xe8\\xe6]1[\\xf4\\xb8\\xad\\xf3\\x88\\xbd\\x11\\xeb\\x8d\\n\\xe1O\\x86\\x96pk\\x01\\xad\\xa6\\x045\\xa0\\x8f\\n\\xde \\x10M\\xc7V\\xc0\\x05\\xf27 \\x1e\\xb0_R\\xe1\\x15\\x1e+\\xbc\\xee\\x9b\\x80\\xfbx\\xf4}V\\xbb\\x93\\x0bh<o;\\x83\\x8f\\xda\\x05\\xac\\xe5\\xb5 \\xc5w\\x95g\\x01\\xf5\\x86\\x84\\x1bV\\xd6\\xc2J\\'S\\xce\\x05e)&\\x19\\x00\\x02\\xa2\"I-7\\x00/ZT\\xcf\\x19\\x17\\x070\\x92.\\x02\\xf1z\\x80\\x89\\xb8\\xd8\\xadh\\xbd\\xce\\xb8\\x01\\xc6I\\xc8\\x00Rt\\x98;W\\xe1#\\xf3y}6\\xfa\\xbc\\xe1\\x06,\\x16=N3F\\xe7\\x9e\\xfca\\xec_\\xa7\\xe8\\xae\\x98;`V6\\xaa\\x94\\xba\\x92\\xa4\\x01<d\\x93O(\\x00\\x07\\x0b\\xc97d[\\x16\\x8e\\xc2\\xaa\\x12\\xc6L\\x12\\x80$i\\'\\x17\\x888^V\\xc4\\x86\\x17c7\\xc57^\\x10D\\xd9\\xd4\\xd2\\tc%\\x8f\\x00;)-7+C\\xf8\\x0f\\xd1}\"\\x08\\xbbB7\\x18\\xe4\\x008\\x92\\xd3p\\x00\\xaaU\\xbfg\\xce\\xeayCb\\x95\\xc4\\x81p\\x11\\xbc\\x93\\x94p\\x0b\\x96\\xc9D\\x1ek\\xc2K\\n\\xafs\\xc9\\xe6\\xb5<-\\xf6\\x12{\\xc3\\x99Qj\\xac\\x8a\\x86\\xb6\\xf7S\\xce\\xd1x\\xcaa\\x90\\x0f\\xcc\\x85\\xeb\\xcc!\\x85\\xcf\\x81\\xedcK\\x9cKn\\x03\\x87#\\x81Z\\xe7\\tl*\\xa9 -d\\x12\\xb9\\xd8\\xcd7\\x06\\xe5\\xc8Py\\xfbqK\\xf0\\xa4\\xe8;\\xb9e\\xd9v\\\\\\xef\\x905\\x90J\\xf7\\\\|Q\\x13\\xdcrs\\x00\\xb6F\\xf4\\xab\\xf9$\\xfd\\x05`\\xc0\\\\\\x1d\\xac\\x8a\\xad\\x8f\\x96\\x9aV02A\\x8c[p\\xbc\\x8c\\x88#~\\xc5lz\\x88m\"\\xf9i\\xe6\\x89\\x9b\\x9aQ\\x8c\\xf8^\\xc6\\xde_\\x15\\xc2\\xf2.\\xbf!\\xc9\\xcc\\xb7\\xc2\\x8c\\xb3\\xa1p}\\xe4\\x10.?\\xfaRh\\n\\x03\\x08s\\xab+X\\x97\\xb3L\\xa7\\xd4\\x06\\x10\\xe7VV\\xb1/f\\x99\\x03\\x07\\xb3\\xabWX\\x8b\\xb3B\\xa7\\xd4\\x06\\x0fgV\\xae\\xb1\\x17f\\x85O\\xa0\"\"\\x0e\\x17\\x95~\\xd0 q\\xb4\\xed\\x13vCR\\xfd\\x1c\\xcb\\xd5K\\xcf\\x98e\\x82\\xb5\\xd2W\\xd6\\xc9\\x1d$\\xef\\x8d\\xf3\\xbc\\xb5\\xc1\\x97\\x82\\t\\xc8B\\rI(\\xf1\\x9d\\xf5?\\xaa\\xfa\\xc6\\nf\\xab\\x05+\\xb1\\xdf\\xe6\\xb3_\\x8c\\xefS\\x9c\\xac3`\\xd5|\\t:(3\\xdb_\\x1eO\\x1c\\x7f\\xda\\xea5\\xb1\\xfb\\xc3\\xfe\\xd7F\\xf7*\\xf9<\\xbd\\x15\\x9c\\xdc\\x03\\xb4\\xc8\\x04P\\xd4\\x10E\\xe0\\xf83\\xc0PF\\xfe\\xc8\\x9c\\xf0Fr\\xf3\\xb7\\xbde\\xb7\\x04k\\x8d\\xc0S\\xba\\xf3\\xfe\\xe6w\\xad\\x81\\x1e\\t\\xd7\\xdc\\xdf4\\x9f\\x80z\\x8a\\xe5\\r\\x87R\\x1c\\xdf!&G\\x0fW\\x9d\\x06\\xa6\\xb3>\\xce\\xedF\\xcd\\x0b\\x8d\\x1b\\xc0l\\xac$\\xe3\\xc5\\xc0\\x1c\\t\\xf5\\x96\\xd9\\x83\\x06\\xaa\\xc3\\xd8L\\x0e\\xb89\\xa4\\xf8\\xcc\\xd29\\xd5\\xee:w\\xe3\\x0f\\x14\\xf0\\x8e.u-r\\x0en_H\\x88\\x08\\x88\\x80\\x88\\x88\\x0b\\x82\\xb9D\\x1c\"\\xe5\\x10\\x11\\x11\\x01@a\\x0euek\\x12\\xf6i\\x94\\xfa\\x80\\xc2\\x1c\\xea\\xca\\xd6%\\xec\\xd3 `\\xf6uj\\xeb\\x11vhT\\xfa\\x80\\xc1\\xec\\xea\\xd5\\xd6\"\\xec\\xd0\\xa9\\xf4\\x04D@X\\xcf\\x8c\\xderq\\xac\\x94AB\\xad\\xb1*\\x1d$\\x84D\\xe2\\x0b\\xdcA\\xbd\\xbc\\x04\\x9b\\xb8\\xd5f\\\\\\x13\\xae%\\xden\\xfc\\xa4\\xfa\\xd1\\xe9\\xfcKq\\xae\\x10j\\xad\\xec\\xd6]\\xf7\\x0e\\xe93\\xbd_\\xe9i^\\x19\\x18- \\x864\\x11\\x93\\x84\\x01z\\x97D\\x1d!\\x87B\\xeeD@DD\\x04D@DD\\x04D@DD\\x04D@DD\\x05\\x01\\x849\\xd5\\x95\\xacK\\xd9\\xa6S\\xea\\x03\\x08s\\xab+X\\x97\\xb3L\\x81\\x83\\xd9\\xd5\\xab\\xacE\\xd9\\xa1S\\xea\\x03\\x07\\xb3\\xabWX\\x8b\\xb3B\\xa7\\xd0\\x11\\x11\\x01\\x11\\x10\\x11\\x11\\x01\\x11\\x10\\x11\\x11\\x01\\x11\\x10\\x11\\x11\\x01\\x11\\x10\\x11\\x11\\x01\\x11\\x10\\x11\\x11\\x01\\x11\\x10\\x14\\x06\\x10\\xe7VV\\xb1/f\\x99O\\xa8\\x0c!\\xce\\xac\\xadb^\\xcd2\\x06\\x0fgV\\xae\\xb1\\x17f\\x85O\\xaa\\x9c5\\x15\\x14\\xd5U\\xe4QTL\\xc9\\xa5\\x8d\\xec|n\\x83\\x14\\x81\\x0cl>\\x9c\\x8d7\\xde\\xc3\\xc4\\xb37\\xc1?\\xcbkzT\\x9bT\\x16\\x04U\\xfd\\xf0O\\xf2\\xda\\xde\\x95&\\xd57\\xc1?\\xcbkzT\\x9bT\\x16\\x04U\\xfd\\xf0O\\xf2\\xda\\xde\\x95&\\xd57\\xc1?\\xcbkzT\\x9bT\\x16\\x04U\\xfd\\xf0O\\xf2\\xda\\xde\\x95&\\xd57\\xc1?\\xcbkzT\\x9bT\\x16\\x04U\\xfd\\xf0O\\xf2\\xda\\xde\\x95&\\xd57\\xc1?\\xcbkzT\\x9bT\\x16\\x04U\\xfd\\xf0O\\xf2\\xda\\xde\\x95&\\xd57\\xc1?\\xcbkzT\\x9bT\\x16\\x04U\\xfd\\xf0O\\xf2\\xda\\xde\\x95&\\xd57\\xc1?\\xcbkzT\\x9bT\\x16\\x04U\\xfd\\xf0O\\xf2\\xda\\xde\\x95&\\xd57\\xc1?\\xcbkzT\\x9bT\\x16\\x04U\\xfd\\xf0O\\xf2\\xda\\xde\\x95&\\xd57\\xc1?\\xcbkzT\\x9bT\\x16\\x04U\\xfd\\xf0O\\xf2\\xda\\xde\\x95&\\xd57\\xc1?\\xcbkzT\\x9bT\\x16\\x04U\\xfd\\xf0O\\xf2\\xda\\xde\\x95&\\xd57\\xc1?\\xcbkzT\\x9bT\\x16\\x04U\\xfd\\xf0O\\xf2\\xda\\xde\\x95&\\xd57\\xc1?\\xcbkzT\\x9bT\\x16\\x04U\\xfd\\xf0O\\xf2\\xda\\xde\\x95&\\xd57\\xc1?\\xcbkzT\\x9bT\\x16\\x05\\x01\\x849\\xd5\\x95\\xacK\\xd9\\xa6\\\\o\\x82\\x7f\\x96\\xd6\\xf4\\xa96\\xab\\x0ej\\x8a\\x8a\\x9a\\xaa\\x02h\\xaa!d2\\xc8\\xf7\\xbeGA\\x8a\\x01\\x86F\\x0fBG\\x1b\\xefx\\xe2AlDD\\x04D@DD\\x04D@DD\\x04D@DD\\x04D@DD\\x04D@DD\\x04D@DD\\x04DA\\xff\\xd9\\r\\n--6bbe8965f14970343b22e227719cc59f--\\r\\n'\r\nb'--45d3287786dca6d69b82df020ce4ab07\\r\\nContent-Disposition: form-data; name=\"binData\"; filename=\"image.jpg\"\\r\\nContent-Type: image/jpeg\\r\\n\\r\\n\\r\\n--45d3287786dca6d69b82df020ce4ab07--\\r\\n'\r\nb'--f1eaccb058fe1d8d7f3bcc5389de2112\\r\\nContent-Disposition: form-data; name=\"binData\"; filename=\"image.jpg\"\\r\\nContent-Type: image/jpeg\\r\\n\\r\\n\\r\\n--f1eaccb058fe1d8d7f3bcc5389de2112--\\r\\n'\r\nb'--a029e39cee74f9b19b033093e140a4fd\\r\\nContent-Disposition: form-data; name=\"binData\"; filename=\"image.jpg\"\\r\\nContent-Type: image/jpeg\\r\\n\\r\\n\\r\\n--a029e39cee74f9b19b033093e140a4fd--\\r\\n'\r\nb'--56683ac8d05d1c9ea57f1af7086b7b5c\\r\\nContent-Disposition: form-data; name=\"binData\"; filename=\"image.jpg\"\\r\\nContent-Type: image/jpeg\\r\\n\\r\\n\\r\\n--56683ac8d05d1c9ea57f1af7086b7b5c--\\r\\n'\r\nb'--0d011ec030b22e6619d08fde8e878667\\r\\nContent-Disposition: form-data; name=\"binData\"; filename=\"image.jpg\"\\r\\nContent-Type: image/jpeg\\r\\n\\r\\n\\r\\n--0d011ec030b22e6619d08fde8e878667--\\r\\n'\r\nb'--0caededa3c6206c24ef341ec07491f58\\r\\nContent-Disposition: form-data; name=\"binData\"; filename=\"image.jpg\"\\r\\nContent-Type: image/jpeg\\r\\n\\r\\n\\r\\n--0caededa3c6206c24ef341ec07491f58--\\r\\n'\r\nb'--0700f899d045613b9adcf463fc509bd5\\r\\nContent-Disposition: form-data; name=\"binData\"; filename=\"image.jpg\"\\r\\nContent-Type: image/jpeg\\r\\n\\r\\n\\r\\n--0700f899d045613b9adcf463fc509bd5--\\r\\n'\r\nb'--fa5d4ce5bd12fa56f5951646a24e5c38\\r\\nContent-Disposition: form-data; name=\"binData\"; filename=\"image.jpg\"\\r\\nContent-Type: image/jpeg\\r\\n\\r\\n\\r\\n--fa5d4ce5bd12fa56f5951646a24e5c38--\\r\\n'\r\nb'--dbfa753e6c61b1eea71595c29b75a0ce\\r\\nContent-Disposition: form-data; name=\"binData\"; filename=\"image.jpg\"\\r\\nContent-Type: image/jpeg\\r\\n\\r\\n\\r\\n--dbfa753e6c61b1eea71595c29b75a0ce--\\r\\n'\r\nb'--921e67643a430fefeff56396c50014ee\\r\\nContent-Disposition: form-data; name=\"binData\"; filename=\"image.jpg\"\\r\\nContent-Type: image/jpeg\\r\\n\\r\\n\\r\\n--921e67643a430fefeff56396c50014ee--\\r\\n'\r\n```\r\n\r\nWhy is the image body with the binary payload missing in all requests folllowing the 1st one? Is there a configuration I need to set additionally?\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1903/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1903/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1899", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1899/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1899/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1899/events", "html_url": "https://github.com/locustio/locust/issues/1899", "id": 1021812247, "node_id": "I_kwDOABUGS848554X", "number": 1899, "title": "Can't install locust", "user": {"login": "honey123john", "id": 91235255, "node_id": "MDQ6VXNlcjkxMjM1MjU1", "avatar_url": "https://avatars.githubusercontent.com/u/91235255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/honey123john", "html_url": "https://github.com/honey123john", "followers_url": "https://api.github.com/users/honey123john/followers", "following_url": "https://api.github.com/users/honey123john/following{/other_user}", "gists_url": "https://api.github.com/users/honey123john/gists{/gist_id}", "starred_url": "https://api.github.com/users/honey123john/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/honey123john/subscriptions", "organizations_url": "https://api.github.com/users/honey123john/orgs", "repos_url": "https://api.github.com/users/honey123john/repos", "events_url": "https://api.github.com/users/honey123john/events{/privacy}", "received_events_url": "https://api.github.com/users/honey123john/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-10-09T21:37:05Z", "updated_at": "2021-11-14T23:24:05Z", "closed_at": "2021-11-14T23:23:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "![err](https://user-images.githubusercontent.com/91235255/136674279-c652166d-a30e-4f9d-bb6f-dd794db816f3.PNG)\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1899/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1899/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1898", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1898/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1898/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1898/events", "html_url": "https://github.com/locustio/locust/issues/1898", "id": 1021811780, "node_id": "I_kwDOABUGS84855xE", "number": 1898, "title": "Can't install locust", "user": {"login": "honey123john", "id": 91235255, "node_id": "MDQ6VXNlcjkxMjM1MjU1", "avatar_url": "https://avatars.githubusercontent.com/u/91235255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/honey123john", "html_url": "https://github.com/honey123john", "followers_url": "https://api.github.com/users/honey123john/followers", "following_url": "https://api.github.com/users/honey123john/following{/other_user}", "gists_url": "https://api.github.com/users/honey123john/gists{/gist_id}", "starred_url": "https://api.github.com/users/honey123john/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/honey123john/subscriptions", "organizations_url": "https://api.github.com/users/honey123john/orgs", "repos_url": "https://api.github.com/users/honey123john/repos", "events_url": "https://api.github.com/users/honey123john/events{/privacy}", "received_events_url": "https://api.github.com/users/honey123john/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635903137, "node_id": "MDU6TGFiZWwxNjM1OTAzMTM3", "url": "https://api.github.com/repos/locustio/locust/labels/duplicate", "name": "duplicate", "color": "9cea8c", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-10-09T21:34:37Z", "updated_at": "2021-10-09T21:53:40Z", "closed_at": "2021-10-09T21:53:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in Locust. Remember, the developers of Locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n\r\nAlways make sure you are running an up to date Locust version (pip3 install -U locust)\r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version:\r\n- Locust version: (please dont file issues for anything but the most recent release or prerelease builds)\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1898/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1898/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1896", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1896/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1896/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1896/events", "html_url": "https://github.com/locustio/locust/issues/1896", "id": 1010682326, "node_id": "I_kwDOABUGS848PcnW", "number": 1896, "title": "RPS doesn't fall to 0 after test has finished if raise StopUser() in on_stop() method", "user": {"login": "Grosha", "id": 10774541, "node_id": "MDQ6VXNlcjEwNzc0NTQx", "avatar_url": "https://avatars.githubusercontent.com/u/10774541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Grosha", "html_url": "https://github.com/Grosha", "followers_url": "https://api.github.com/users/Grosha/followers", "following_url": "https://api.github.com/users/Grosha/following{/other_user}", "gists_url": "https://api.github.com/users/Grosha/gists{/gist_id}", "starred_url": "https://api.github.com/users/Grosha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Grosha/subscriptions", "organizations_url": "https://api.github.com/users/Grosha/orgs", "repos_url": "https://api.github.com/users/Grosha/repos", "events_url": "https://api.github.com/users/Grosha/events{/privacy}", "received_events_url": "https://api.github.com/users/Grosha/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-09-29T08:55:58Z", "updated_at": "2021-11-14T23:28:02Z", "closed_at": "2021-11-14T23:28:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n<!-- I have a suite where a user must send some task set just once and finish his life so I use `raise StopUser()` in `on_stop()` method. After all users finish their job on UI RPS doesn't fall to 0 - it shows probably last saved information-->\r\n<img width=\"1904\" alt=\"Screenshot 2021-09-29 at 11 35 08\" src=\"https://user-images.githubusercontent.com/10774541/135234079-9cc65d01-8537-4ffc-9f12-08b903f60e2d.png\">\r\n\r\n### Expected behavior\r\nWhen 0 users work must be 0 RPS because nobody sends requests\r\n\r\n### Actual behavior\r\nWhen 0 users work shows the same saved result with RPS. And it will present till I click the stop button\r\n\r\n### Steps to reproduce\r\n1. Create a class that inherits from SequentialTaskSet \r\n2. Do something on_start() method\r\n3. Raise StopUser() in on_stop() method\r\n\r\n### Environment\r\n\r\n- OS: Ubuntu 20.04.2 LTS / MacOs BigSur v:11.6\r\n- Python version:3.8.5\r\n- Locust version: 2.2.2/2.2.3\r\n- Locust command line that you ran: locust -f file.py / locust --config=local.yml\r\n- Locust file contents (anonymized if necessary):\r\n\r\n```\r\nlogger = logging.getLogger(__name__)\r\nusers = []\r\n\r\n\r\ndef init_env_configurations():\r\n    if os.getenv('ENV_TYPE') == EnvType.DEV:\r\n        logger.debug(f\"ENV is {EnvType.DEV}\")\r\n        users.extend(read_files(Resources.DEV_USERS))\r\n    elif os.getenv('ENV_TYPE') == EnvType.QA:\r\n        logger.debug(f\"ENV is {EnvType.QA}\")\r\n        users.extend(read_files(Resources.QA_USERS))\r\n    elif os.getenv('ENV_TYPE') == EnvType.PROD:\r\n        logger.debug(f\"ENV is {EnvType.PROD}\")\r\n        users.extend(read_files(Resources.PROD_USERS))\r\n\r\n\r\n@events.test_start.add_listener\r\ndef init_locust_configuration(**kwargs):\r\n    init_env_configurations()\r\n\r\n\r\nclass StartSomethingWithUser(SequentialTaskSet):\r\n    wait_time = between(1, 2)\r\n\r\n    def __init__(self, *args, **kwargs):\r\n        super().__init__(*args, **kwargs)\r\n        self.user_access_token = None\r\n\r\n    def on_start(self):\r\n        logging.info(f\"Len: {len(users)}\")\r\n        if len(users) > 0:\r\n            user_params = users.pop().rstrip(\"\\n\").split(\",\")\r\n            logging.info(f\"User params:: {user_params}\")\r\n\r\n            phone = user_params[1]\r\n            body = {test_body}\r\n            with self.client.post(api_call, json=body, catch_response=True, name=\"Authorise user\") as authorise_user:\r\n                if authorise_user.status_code != 200:\r\n                    log_error(authorise_user)\r\n                    raise StopUser()\r\n                else:\r\n                    log_data(authorise_user)\r\n                    self.user_access_token = authorise_user.json()[\"session\"][\"accessToken\"]\r\n                    self.client.headers.update({\"Authorization\": f\"Bearer {self.user_access_token}\", \"Accept-Language\": \"EN\"})\r\n        else:\r\n            logging.info(\"There are no users\")\r\n            raise StopUser()\r\n\r\n    @task()\r\n    def start_something(self):\r\n        with self.client.post(aoi_call, catch_response=True, name=\"start_something\") as start_something:\r\n            if start_something.status_code != 201:\r\n                log_error(start_something)\r\n                raise StopUser()\r\n            else:\r\n                log_data(start_something)\r\n\r\n    @task()\r\n    def on_stop(self):\r\n        raise StopUser()\r\n```\r\n```\r\nclass UserLoader(HttpUser):\r\n    wait_time = between(1, 2)\r\n    tasks = {StartSomethingWithUser:  1}\r\n    host = os.getenv(\"URL\")\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1896/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1896/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1893", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1893/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1893/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1893/events", "html_url": "https://github.com/locustio/locust/issues/1893", "id": 1007913265, "node_id": "I_kwDOABUGS848E4kx", "number": 1893, "title": "Locust will not work, if there is a custom 'run' @task / function ", "user": {"login": "joerg1985", "id": 16140691, "node_id": "MDQ6VXNlcjE2MTQwNjkx", "avatar_url": "https://avatars.githubusercontent.com/u/16140691?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joerg1985", "html_url": "https://github.com/joerg1985", "followers_url": "https://api.github.com/users/joerg1985/followers", "following_url": "https://api.github.com/users/joerg1985/following{/other_user}", "gists_url": "https://api.github.com/users/joerg1985/gists{/gist_id}", "starred_url": "https://api.github.com/users/joerg1985/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joerg1985/subscriptions", "organizations_url": "https://api.github.com/users/joerg1985/orgs", "repos_url": "https://api.github.com/users/joerg1985/repos", "events_url": "https://api.github.com/users/joerg1985/events{/privacy}", "received_events_url": "https://api.github.com/users/joerg1985/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-09-27T09:26:25Z", "updated_at": "2021-09-27T19:50:25Z", "closed_at": "2021-09-27T19:50:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nThere are some magic methods with common names, like \"run\".\r\nCreating a @task with those name will totally break locust, see example below.\r\n\r\n### Expected behavior\r\nMagic methods should use some kind of prefix or not common names to avoid name clashes.\r\n\r\n### Actual behavior\r\nLocust will not try to rerun the task, the run task is executed only once.\r\n\r\n### Steps to reproduce\r\n````\r\nclass Dummy(HttpUser):\r\n    @task\r\n    def run(self):\r\n\t# a failing test script\r\n        raise RuntimeError(\"failed to run\")\r\n````\r\n\r\n### Environment\r\n\r\n- OS: Mixed\r\n- Python version: 3.8\r\n- Locust version: 2.2.3\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1893/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1893/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1892", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1892/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1892/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1892/events", "html_url": "https://github.com/locustio/locust/issues/1892", "id": 1007855379, "node_id": "I_kwDOABUGS848EqcT", "number": 1892, "title": "CatchResponseError  <locust.contrib.fasthttp.ResponseContextManager object at 0x7f8e6bf22a68>", "user": {"login": "unkangfutable", "id": 49712805, "node_id": "MDQ6VXNlcjQ5NzEyODA1", "avatar_url": "https://avatars.githubusercontent.com/u/49712805?v=4", "gravatar_id": "", "url": "https://api.github.com/users/unkangfutable", "html_url": "https://github.com/unkangfutable", "followers_url": "https://api.github.com/users/unkangfutable/followers", "following_url": "https://api.github.com/users/unkangfutable/following{/other_user}", "gists_url": "https://api.github.com/users/unkangfutable/gists{/gist_id}", "starred_url": "https://api.github.com/users/unkangfutable/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/unkangfutable/subscriptions", "organizations_url": "https://api.github.com/users/unkangfutable/orgs", "repos_url": "https://api.github.com/users/unkangfutable/repos", "events_url": "https://api.github.com/users/unkangfutable/events{/privacy}", "received_events_url": "https://api.github.com/users/unkangfutable/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-09-27T08:29:08Z", "updated_at": "2021-12-07T01:52:22Z", "closed_at": "2021-12-07T01:52:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nwhen use FastHttpUser&Distributed load generation for request , i got an unexcepted response which named \"<locust.contrib.fasthttp.ResponseContextManager object at 0x7f8e6bf22a68>\"\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nthe right response code and message\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n![1632730606818_BC3D5070-96F6-4070-8232-D5AFA7BFAB56](https://user-images.githubusercontent.com/49712805/134872302-35f40813-7db5-4c42-a073-f843d8de97c8.png)\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n```\r\nall_locusts_spawned = Semaphore()\r\nall_locusts_spawned.acquire()\r\n\r\n\r\n@events.spawning_complete.add_listener\r\ndef on_hatch_complete(**kwargs):\r\n    all_locusts_spawned.release()  # \r\n\r\nf_path = os.path.abspath(os.path.dirname(os.getcwd()))\r\nsys.path.append(f_path)\r\n\r\n#\r\n\r\n\r\nclass MyTaskSet(SequentialTaskSet):\r\n    def on_start(self):\r\n        all_locusts_spawned.wait()\r\n\r\n    @task\r\n    def login(self): \r\n        body = {\"params\":\"test\"}\r\n        with self.client.post(path=\"/login\", data=body,  catch_response=True) as res_all:\r\n            code = json.loads(res_all)[\"code\"]\r\n            if code == 0:\r\n                pass\r\n            else:\r\n                msg = json.loads(res_all)[\"message\"]\r\n                res_all.failure(\" login Failed!!!!!!code=%d,msg=%s\"%(code,msg))\r\n\r\nclass WebUser(FastHttpUser):\r\n\r\n    tasks = [MyTaskSet]\r\n    wait_time = between(0.5, 0.5)\r\n\r\n```\r\n### Environment\r\n\r\n- OS:\r\n- Python version: python3.7\r\n- Locust version:  locust 1.4.4\r\n- Locust command line that you ran: python3 -m locust -f demo.py --master   & python3 -m locust -f demo.py --worker\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1892/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1892/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1887", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1887/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1887/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1887/events", "html_url": "https://github.com/locustio/locust/issues/1887", "id": 999233699, "node_id": "I_kwDOABUGS847jxij", "number": 1887, "title": "failed APIs in Report with different parameters while using FastHttp in Locust are not Grouped.", "user": {"login": "manishsaini7", "id": 8024392, "node_id": "MDQ6VXNlcjgwMjQzOTI=", "avatar_url": "https://avatars.githubusercontent.com/u/8024392?v=4", "gravatar_id": "", "url": "https://api.github.com/users/manishsaini7", "html_url": "https://github.com/manishsaini7", "followers_url": "https://api.github.com/users/manishsaini7/followers", "following_url": "https://api.github.com/users/manishsaini7/following{/other_user}", "gists_url": "https://api.github.com/users/manishsaini7/gists{/gist_id}", "starred_url": "https://api.github.com/users/manishsaini7/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/manishsaini7/subscriptions", "organizations_url": "https://api.github.com/users/manishsaini7/orgs", "repos_url": "https://api.github.com/users/manishsaini7/repos", "events_url": "https://api.github.com/users/manishsaini7/events{/privacy}", "received_events_url": "https://api.github.com/users/manishsaini7/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-09-17T11:11:07Z", "updated_at": "2021-11-28T01:49:22Z", "closed_at": "2021-11-28T01:49:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "My API is like /api/v1/users/checkuser?PhoneNo I am creating requests for random phone nos. When I am using HttpUser(Requests) it shows grouped results whenever API failed for any number. But when I use FastHttpuser(geventhttpclient) it shows failed APIs in different columns for different phone nos. I already used name to group APIs. But its only grouping in Statistics not in Failed part. \r\nself.client.get(f\"/api/v1/users/checkuser?phone_number={self.phone_no}\", name=\"/api/v1/users/checkuser\")\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1887/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1887/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1885", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1885/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1885/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1885/events", "html_url": "https://github.com/locustio/locust/issues/1885", "id": 996726635, "node_id": "I_kwDOABUGS847aNdr", "number": 1885, "title": "Version information in Docker image is incorrect", "user": {"login": "MaggotMouth", "id": 2102169, "node_id": "MDQ6VXNlcjIxMDIxNjk=", "avatar_url": "https://avatars.githubusercontent.com/u/2102169?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MaggotMouth", "html_url": "https://github.com/MaggotMouth", "followers_url": "https://api.github.com/users/MaggotMouth/followers", "following_url": "https://api.github.com/users/MaggotMouth/following{/other_user}", "gists_url": "https://api.github.com/users/MaggotMouth/gists{/gist_id}", "starred_url": "https://api.github.com/users/MaggotMouth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MaggotMouth/subscriptions", "organizations_url": "https://api.github.com/users/MaggotMouth/orgs", "repos_url": "https://api.github.com/users/MaggotMouth/repos", "events_url": "https://api.github.com/users/MaggotMouth/events{/privacy}", "received_events_url": "https://api.github.com/users/MaggotMouth/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-09-15T06:58:02Z", "updated_at": "2021-09-16T07:06:41Z", "closed_at": "2021-09-15T10:35:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nWhen running the docker image after v2.1.0, the version reported by locust is incorrrect\r\n\r\n\r\n### Expected behavior\r\nFrom 2.1.0 image:\r\n```\r\n$ locust --version\r\nlocust 2.1.0\r\n```\r\n\r\n### Actual behavior\r\n```\r\n$ locust --version\r\nlocust 0.1.dev1\r\n```\r\n\r\n### Steps to reproduce\r\nSee above.\r\nExpect it was introduced in #1847 \r\n\r\n### Environment\r\n\r\n- OS: docker\r\n- Locust version: > 2.1.0 - including masterr\r\n- Locust command line that you ran: locust version\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1885/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1885/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1884", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1884/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1884/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1884/events", "html_url": "https://github.com/locustio/locust/issues/1884", "id": 995822532, "node_id": "I_kwDOABUGS847WwvE", "number": 1884, "title": "User distribution should happen when new workers comes in", "user": {"login": "tyge68", "id": 8066508, "node_id": "MDQ6VXNlcjgwNjY1MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/8066508?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tyge68", "html_url": "https://github.com/tyge68", "followers_url": "https://api.github.com/users/tyge68/followers", "following_url": "https://api.github.com/users/tyge68/following{/other_user}", "gists_url": "https://api.github.com/users/tyge68/gists{/gist_id}", "starred_url": "https://api.github.com/users/tyge68/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tyge68/subscriptions", "organizations_url": "https://api.github.com/users/tyge68/orgs", "repos_url": "https://api.github.com/users/tyge68/repos", "events_url": "https://api.github.com/users/tyge68/events{/privacy}", "received_events_url": "https://api.github.com/users/tyge68/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-09-14T09:54:31Z", "updated_at": "2021-11-15T06:14:29Z", "closed_at": "2021-11-15T06:14:29Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Currently when more workers are added (dynamically based in the workers CPU load on kubernetes), if the swarming is over, then new workers are detected ready, but there is redistribution of the users on the new workers to take some load on the other workers.\r\n\r\nOnly a manually re-swarming can force redistribute the users among the workers.\r\n\r\n### Describe the bug\r\nThe new workers are ready but not used\r\n\r\n### Expected behavior\r\nIf a new worker is added, it should automatically redistribute the load of users on the workers.\r\n\r\n### Actual behavior\r\nNew worker is ready, but don't get any user / tasks to execute. Other workers are still using all the CPU.\r\n\r\n### Steps to reproduce\r\nSetup some workers , and start a load test, wait until the target number of user is reached. Add a new worker to the pool, check the state is ready, but no user is assigned to it, until a \"re-swarm\" is manually triggered.\r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version: 3.9\r\n- Locust version: 2.2.1\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1884/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1884/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1883", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1883/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1883/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1883/events", "html_url": "https://github.com/locustio/locust/issues/1883", "id": 995550862, "node_id": "I_kwDOABUGS847VuaO", "number": 1883, "title": "MasterRunner target_user_count no longer set for test_start event listeners", "user": {"login": "jrweldon", "id": 2894244, "node_id": "MDQ6VXNlcjI4OTQyNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2894244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jrweldon", "html_url": "https://github.com/jrweldon", "followers_url": "https://api.github.com/users/jrweldon/followers", "following_url": "https://api.github.com/users/jrweldon/following{/other_user}", "gists_url": "https://api.github.com/users/jrweldon/gists{/gist_id}", "starred_url": "https://api.github.com/users/jrweldon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jrweldon/subscriptions", "organizations_url": "https://api.github.com/users/jrweldon/orgs", "repos_url": "https://api.github.com/users/jrweldon/repos", "events_url": "https://api.github.com/users/jrweldon/events{/privacy}", "received_events_url": "https://api.github.com/users/jrweldon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2021-09-14T03:41:28Z", "updated_at": "2021-09-27T18:07:18Z", "closed_at": "2021-09-27T17:27:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nI was following the `custom_messages.py` example and noticed that `environment.runner.target_user_count` is no longer resolving to the number of users being created for the test. This functionality appears to have been broken between tags `2.0.0b1` and `2.0.0b2`.\r\n\r\n### Expected behavior\r\nThe MasterRunner's `target_user_count` should resolve to the number of users specified in the WebUI for the test.\r\nThe `custom_messages.py` example for a test with 10 users and 2 workers should log a message from each worker indicating that they received 5 users.\r\n```\r\nmaster_1  | [2021-09-14 02:48:02,550] d4b6940eebd0/INFO/locust.runners: Sending spawn jobs of 10 users at 1.00 spawn rate to 2 ready clients\r\nmaster_1  | Thanks for the 5 users!\r\nmaster_1  | Thanks for the 5 users!\r\nworker_1  | User4\r\nworker_2  | User9\r\nworker_1  | User3\r\n...\r\n```\r\n\r\n### Actual behavior\r\nThe MasterRunner's `target_user_count` is 0, causing numerous exceptions in the `custom_messages.py` example.\r\n```\r\nmaster_1  | [2021-09-14 03:01:33,449] 0134f51ea2b2/INFO/locust.runners: Sending spawn jobs of 10 users at 1.00 spawn rate to 2 ready clients\r\nmaster_1  | Thanks for the 0 users!\r\nmaster_1  | Thanks for the 0 users!\r\nworker_2  | Traceback (most recent call last):\r\nworker_2  |   File \"src/gevent/greenlet.py\", line 906, in gevent._gevent_cgreenlet.Greenlet.run\r\nworker_2  |   File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 1138, in <lambda>\r\nworker_2  |     self.spawning_greenlet = self.greenlet.spawn(lambda: self.start_worker(job[\"user_classes_count\"]))\r\nworker_2  |   File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 1075, in start_worker\r\nworker_2  |     self.spawn_users(user_classes_spawn_count)\r\nworker_2  |   File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 221, in spawn_users\r\nworker_2  |     new_users += spawn(user_class, spawn_count)\r\nworker_2  |   File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 210, in spawn\r\nworker_2  |     new_user = self.user_classes_by_name[user_class](self.environment)\r\nworker_2  |   File \"/mnt/locust/custom_messages.py\", line 55, in __init__\r\nworker_2  |     self.username = usernames.pop()\r\nworker_2  | IndexError: pop from empty list\r\nworker_2  | 2021-09-14T03:01:33Z <Greenlet at 0x7fc070a7ae10: <lambda>> failed with IndexError\r\n...\r\n```\r\n\r\n### Steps to reproduce\r\n1. Create `docker-compose.yml`:\r\n```yaml\r\nversion: '3'\r\n\r\nservices:\r\n  master:\r\n    image: locustio/locust:2.2.1\r\n    # image: locustio/locust:2.0.0b1 ## Last known working version\r\n    ports:\r\n     - \"8089:8089\"\r\n    volumes:\r\n      - ./:/mnt/locust\r\n    command: -f /mnt/locust/custom_messages.py --master -H http://master:8089\r\n  \r\n  worker:\r\n    image: locustio/locust:2.2.1\r\n    # image: locustio/locust:2.0.0b1 ## Last known working version\r\n    volumes:\r\n      - ./:/mnt/locust\r\n    command: -f /mnt/locust/custom_messages.py --worker --master-host master\r\n    deploy:\r\n      mode: replicated\r\n      replicas: 2\r\n```\r\n2. Copy the existing [examples/custom_messages.py](https://raw.githubusercontent.com/locustio/locust/master/examples/custom_messages.py) into the same directory as the `docker-compose.yml`\r\n3. Run `docker compose up`\r\n4. Visit http://localhost:8089/ and start a test with 10 users\r\n5. (Optional) Modify the `docker-compose.yml` to use a different image tag listed below and repeat steps 3 and 4.\r\n\r\n### Environment\r\n\r\n- OS: `Debian GNU/Linux 11 (bullseye)` from `locustio/locust` docker image.\r\n- Python version: `3.8.11` and `3.8.12` from the various `locustio/locust` docker images.\r\n- Locust version: `2.0.0b2`, `2.0.0b3`, `2.1.0`, `2.2.0`, `2.2.1`\r\n- Locust command line that you ran: See `docker-compose.yml` above.\r\n- Locust file contents (anonymized if necessary): [examples/custom_messages.py](https://raw.githubusercontent.com/locustio/locust/master/examples/custom_messages.py)", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1883/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1883/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1882", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1882/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1882/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1882/events", "html_url": "https://github.com/locustio/locust/issues/1882", "id": 995504547, "node_id": "I_kwDOABUGS847VjGj", "number": 1882, "title": "--tags / --exclude-tags seems not taken in consideration when running distributed unless they are specified in every worker", "user": {"login": "lfoppiano", "id": 15426, "node_id": "MDQ6VXNlcjE1NDI2", "avatar_url": "https://avatars.githubusercontent.com/u/15426?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lfoppiano", "html_url": "https://github.com/lfoppiano", "followers_url": "https://api.github.com/users/lfoppiano/followers", "following_url": "https://api.github.com/users/lfoppiano/following{/other_user}", "gists_url": "https://api.github.com/users/lfoppiano/gists{/gist_id}", "starred_url": "https://api.github.com/users/lfoppiano/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lfoppiano/subscriptions", "organizations_url": "https://api.github.com/users/lfoppiano/orgs", "repos_url": "https://api.github.com/users/lfoppiano/repos", "events_url": "https://api.github.com/users/lfoppiano/events{/privacy}", "received_events_url": "https://api.github.com/users/lfoppiano/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-09-14T02:05:43Z", "updated_at": "2021-11-25T01:50:05Z", "closed_at": "2021-11-25T01:50:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm not sure this is a bug, it's just quite inconvenient to have to specify --tags and --excluded-tags for each worker. It's indeed working if the tags are specified at wokrer level (the `--tags` and `--exlcuded-tags` is completely ignored for the master)\r\n\r\n### Describe the bug\r\nI run the master with `--tags  process_text` because I want to only run one one of the tasks\r\n\r\n### Expected behavior\r\nOnly the tasks I specify in `--tags` are taken in account, or the ones that are in `--excluded-tags` are excluded \r\n\r\n### Actual behavior\r\nAll the tasks are executed \r\n\r\n### Steps to reproduce\r\nOnly the tasks that are selected/excluded should be only selected / excluded\r\n\r\n### Environment\r\n\r\n- OS: Linux (Centos, Ubuntu)\r\n- Python version: 3.9.6\r\n- Locust version: 2.2.0 (on all machines)\r\n- Locust command line that you ran: `locust --config yomite-1h-50u-master.conf --tags process_text` See [config](https://github.com/lfoppiano/grobid-superconductors-performance/blob/main/yomite-1h-50u-master.conf). \r\n- Locust file contents (anonymized if necessary): See [here](https://github.com/lfoppiano/grobid-superconductors-performance/blob/main/locustfiles/locustfile_java.py). The data is not available, though.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1882/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1882/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1877", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1877/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1877/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1877/events", "html_url": "https://github.com/locustio/locust/issues/1877", "id": 991015382, "node_id": "MDU6SXNzdWU5OTEwMTUzODI=", "number": 1877, "title": "After Version 2.2.0 I am getting error while running test on worker.", "user": {"login": "manishsaini7", "id": 8024392, "node_id": "MDQ6VXNlcjgwMjQzOTI=", "avatar_url": "https://avatars.githubusercontent.com/u/8024392?v=4", "gravatar_id": "", "url": "https://api.github.com/users/manishsaini7", "html_url": "https://github.com/manishsaini7", "followers_url": "https://api.github.com/users/manishsaini7/followers", "following_url": "https://api.github.com/users/manishsaini7/following{/other_user}", "gists_url": "https://api.github.com/users/manishsaini7/gists{/gist_id}", "starred_url": "https://api.github.com/users/manishsaini7/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/manishsaini7/subscriptions", "organizations_url": "https://api.github.com/users/manishsaini7/orgs", "repos_url": "https://api.github.com/users/manishsaini7/repos", "events_url": "https://api.github.com/users/manishsaini7/events{/privacy}", "received_events_url": "https://api.github.com/users/manishsaini7/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-09-08T11:07:48Z", "updated_at": "2021-09-17T07:12:33Z", "closed_at": "2021-09-17T06:49:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "File \"src/gevent/greenlet.py\", line 906, in gevent._gevent_cgreenlet.Greenlet.run File \"/home/manish/.local/lib/python3.8/site-packages/locust/runners.py\", line 1131, in worker k: v for k, v in job[\"parsed_options\"].items() if k not in argument_parser.default_args_dict() KeyError: 'parsed_options' 2021-09-08T09:59:06Z <Greenlet at 0x7f6e7b0de590: <bound method WorkerRunner.worker of <locust.runners.WorkerRunner object at 0x7f6e7b06f1c0>>> failed with KeyError.\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1877/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1877/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1870", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1870/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1870/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1870/events", "html_url": "https://github.com/locustio/locust/issues/1870", "id": 986337743, "node_id": "MDU6SXNzdWU5ODYzMzc3NDM=", "number": 1870, "title": "Importing any locust plugin breaks the UI and distributed load generation.", "user": {"login": "Serhiy1", "id": 28574129, "node_id": "MDQ6VXNlcjI4NTc0MTI5", "avatar_url": "https://avatars.githubusercontent.com/u/28574129?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Serhiy1", "html_url": "https://github.com/Serhiy1", "followers_url": "https://api.github.com/users/Serhiy1/followers", "following_url": "https://api.github.com/users/Serhiy1/following{/other_user}", "gists_url": "https://api.github.com/users/Serhiy1/gists{/gist_id}", "starred_url": "https://api.github.com/users/Serhiy1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Serhiy1/subscriptions", "organizations_url": "https://api.github.com/users/Serhiy1/orgs", "repos_url": "https://api.github.com/users/Serhiy1/repos", "events_url": "https://api.github.com/users/Serhiy1/events{/privacy}", "received_events_url": "https://api.github.com/users/Serhiy1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-09-02T08:07:35Z", "updated_at": "2021-09-02T12:55:20Z", "closed_at": "2021-09-02T11:26:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\nimporting any plugins from the locust plugins directory seems to break the UI and distributed load generation.\r\nI have particularly used the `run_single_user` and `Transaction manager` plugins. \r\n\r\nThis is how the UI looks if you import either of the two\r\n\r\n![image](https://user-images.githubusercontent.com/28574129/131804417-a9b21c58-c08a-44bf-806c-3efd68d0eeed.png)\r\n\r\nIf you run the following in distributed mode, only filling out the default parameters: (Number of users, spawn rate, host) you will consistently get the following exception.  \r\n\r\n```\r\nTraceback (most recent call last):                                                                                                                                                                            \r\n   File \"/usr/local/lib/python3.8/site-packages/gevent/pywsgi.py\", line 999, in handle_one_response                                                                                                            \r\n     self.run_application()                                                                                                                                                                                    \r\n   File \"/usr/local/lib/python3.8/site-packages/gevent/pywsgi.py\", line 945, in run_application                                                                                                                \r\n     self.result = self.application(self.environ, self.start_response)                                                                                                                                         \r\n   File \"/usr/local/lib/python3.8/site-packages/flask/app.py\", line 2088, in __call__                                                                                                                          \r\n     return self.wsgi_app(environ, start_response)                                                                                                                                                             \r\n   File \"/usr/local/lib/python3.8/site-packages/flask/app.py\", line 2073, in wsgi_app                                                                                                                          \r\n     response = self.handle_exception(e)                                                                                                                                                                       \r\n   File \"/usr/local/lib/python3.8/site-packages/flask_cors/extension.py\", line 165, in wrapped_function                                                                                                        \r\n     return cors_after_request(app.make_response(f(*args, **kwargs)))                                                                                                                                          \r\n   File \"/usr/local/lib/python3.8/site-packages/flask/app.py\", line 2070, in wsgi_app                                                                                                                          \r\n     response = self.full_dispatch_request()                                                                                                                                                                   \r\n   File \"/usr/local/lib/python3.8/site-packages/flask/app.py\", line 1515, in full_dispatch_request                                                                                                             \r\n     rv = self.handle_user_exception(e)                                                                                                                                                                        \r\n   File \"/usr/local/lib/python3.8/site-packages/flask_cors/extension.py\", line 165, in wrapped_function                                                                                                        \r\n     return cors_after_request(app.make_response(f(*args, **kwargs)))                                                                                                                                          \r\n   File \"/usr/local/lib/python3.8/site-packages/flask/app.py\", line 1513, in full_dispatch_request                                                                                                             \r\n     rv = self.dispatch_request()                                                                                                                                                                              \r\n   File \"/usr/local/lib/python3.8/site-packages/flask/app.py\", line 1499, in dispatch_request                                                                                                                  \r\n     return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)                                                                                                                              \r\n   File \"/home/locust/.local/lib/python3.8/site-packages/locust/web.py\", line 384, in wrapper                                                                                                                  \r\n     return view_func(*args, **kwargs)                                                                                                                                                                         \r\n   File \"/home/locust/.local/lib/python3.8/site-packages/locust/web.py\", line 154, in swarm                                                                                                                    \r\n     parsed_options_dict[key] = type(parsed_options_dict[key])(value)                                                                                                                                          \r\n TypeError: NoneType takes no arguments                                                                                                                                                                        \r\n 2021-09-01T17:52:19Z {'REMOTE_ADDR': '::ffff:127.0.0.1', 'REMOTE_PORT': '40020', 'HTTP_HOST': 'localhost:8089', (hidden keys: 33)} failed with TypeError\r\n```\r\n\r\n### Expected behaviour\r\n<!-- Tell us what you think should happen -->\r\nImporting singular plugins should not generate so many custom parameters and distributed load generation should still continue to work. \r\n\r\n### Steps to reproduce\r\nHere is a small repo project based off the [delivery hero example](https://github.com/deliveryhero/helm-charts/tree/master/stable/locust/locustfiles/example) \r\n\r\n[example.zip](https://github.com/locustio/locust/files/7097199/example.zip)\r\n\r\nTo observe the broken UI, you can run `locust -f main_broken.py` locally. \r\n\r\nTo observe distributed builds being broken you will need to deploy the test in a distributed fashion. I have used Kubernetes and the provided helm chart to do so. \r\n\r\n#### EDIT \r\nLooks like you can repo this issue without the need to run in distributed mode. run run `locust -f main_broken.py` and set the host to https://www.google.com \r\n\r\n\r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version: 3.8\r\n- Locust version: 2.2.0\r\n\r\n- Locust command line that you ran: ", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1870/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1870/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1862", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1862/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1862/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1862/events", "html_url": "https://github.com/locustio/locust/issues/1862", "id": 976357484, "node_id": "MDU6SXNzdWU5NzYzNTc0ODQ=", "number": 1862, "title": "Runner doesn't look on shape_class of environment", "user": {"login": "kirillantv", "id": 22444239, "node_id": "MDQ6VXNlcjIyNDQ0MjM5", "avatar_url": "https://avatars.githubusercontent.com/u/22444239?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kirillantv", "html_url": "https://github.com/kirillantv", "followers_url": "https://api.github.com/users/kirillantv/followers", "following_url": "https://api.github.com/users/kirillantv/following{/other_user}", "gists_url": "https://api.github.com/users/kirillantv/gists{/gist_id}", "starred_url": "https://api.github.com/users/kirillantv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kirillantv/subscriptions", "organizations_url": "https://api.github.com/users/kirillantv/orgs", "repos_url": "https://api.github.com/users/kirillantv/repos", "events_url": "https://api.github.com/users/kirillantv/events{/privacy}", "received_events_url": "https://api.github.com/users/kirillantv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2021-08-22T11:51:14Z", "updated_at": "2021-11-04T20:01:50Z", "closed_at": "2021-11-04T20:01:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nI use locust as library and I am investigating how to user custom load shape in this case. And seems like locust ignore shape_class in environment.\r\n\r\n### Expected behavior\r\nLoad increasing by 10 users every 30 seconds\r\n  \r\n### Actual behavior\r\nI've got only 1 user per second all the time\r\n\r\nAfter approximately 2 minutes:\r\n```\r\n Name                                                                              # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n GET //                                                                               100     0(0.00%)  |    1105     782    2129    1000  |    0.40    0.00\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                                           100     0(0.00%)  |    1105     782    2129    1000  |    0.40    0.00\r\n\r\n Name                                                                              # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n GET //                                                                               101     0(0.00%)  |    1103     782    2129    1000  |    0.50    0.00\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                                           101     0(0.00%)  |    1103     782    2129    1000  |    0.50    0.00\r\n\r\n Name                                                                              # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n GET //                                                                               102     0(0.00%)  |    1103     782    2129    1000  |    0.50    0.00\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                                           102     0(0.00%)  |    1103     782    2129    1000  |    0.50    0.00\r\n\r\n Name                                                                              # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n GET //                                                                               103     0(0.00%)  |    1102     782    2129    1000  |    0.50    0.00\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                                           103     0(0.00%)  |    1102     782    2129    1000  |    0.50    0.00\r\n\r\n Name                                                                              # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n GET //                                                                               104     0(0.00%)  |    1100     782    2129    1000  |    0.50    0.00\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                                           104     0(0.00%)  |    1100     782    2129    1000  |    0.50    0.00\r\n\r\n```\r\n\r\n### Steps to reproduce\r\nThis is my code:\r\n```python\r\nimport gevent\r\nimport math\r\nfrom locust import HttpUser, task, between, constant\r\nfrom locust.env import Environment\r\nfrom locust.stats import stats_printer, stats_history\r\nfrom locust.log import setup_logging\r\nfrom locust.shape import LoadTestShape\r\n\r\nsetup_logging(\"INFO\", None)\r\n\r\n\r\nclass StepLoadShape(LoadTestShape):\r\n\r\n    step_time = 30\r\n    step_load = 10\r\n    spawn_rate = 10\r\n    time_limit = 600\r\n\r\n    def tick(self):\r\n        run_time = self.get_run_time()\r\n\r\n        if run_time > self.time_limit:\r\n            return None\r\n\r\n        current_step = math.floor(run_time / self.step_time) + 1\r\n        return (current_step * self.step_load, self.spawn_rate)\r\n\r\n\r\nclass User(HttpUser):\r\n    wait_time = constant(1)\r\n\r\n    @task\r\n    def my_task(self):\r\n        self.client.get(\"/\")\r\n\r\n\r\nenv = Environment(user_classes=[User], shape_class=StepLoadShape, host=\"https://docs.locust.io/\")\r\nenv.create_local_runner()\r\n\r\ngevent.spawn(stats_printer(env.stats))\r\n\r\ngevent.spawn(stats_history, env.runner)\r\n\r\nenv.runner.start(1, spawn_rate=10)\r\n\r\ngevent.spawn_later(600, lambda: env.runner.quit())\r\n\r\nenv.runner.greenlet.join()\r\n```\r\nRun it with `python /path_to_file`\r\n### Environment\r\n\r\n- OS: macOS 10.15.4\r\n- Python version: 3.7.11\r\n- Locust version: 2.1.0\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1862/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1862/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1856", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1856/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1856/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1856/events", "html_url": "https://github.com/locustio/locust/issues/1856", "id": 974412672, "node_id": "MDU6SXNzdWU5NzQ0MTI2NzI=", "number": 1856, "title": "semaphore wait not use on master with worker  run ", "user": {"login": "kyoliu", "id": 28671990, "node_id": "MDQ6VXNlcjI4NjcxOTkw", "avatar_url": "https://avatars.githubusercontent.com/u/28671990?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyoliu", "html_url": "https://github.com/kyoliu", "followers_url": "https://api.github.com/users/kyoliu/followers", "following_url": "https://api.github.com/users/kyoliu/following{/other_user}", "gists_url": "https://api.github.com/users/kyoliu/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyoliu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyoliu/subscriptions", "organizations_url": "https://api.github.com/users/kyoliu/orgs", "repos_url": "https://api.github.com/users/kyoliu/repos", "events_url": "https://api.github.com/users/kyoliu/events{/privacy}", "received_events_url": "https://api.github.com/users/kyoliu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2021-08-19T08:32:19Z", "updated_at": "2021-10-31T01:50:19Z", "closed_at": "2021-10-31T01:50:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "before run my  case  on locust 1.6  and use master-worker  semaphore wait (like examples/semaphore_wait.py )  is ok  \r\n\r\ntoday  update my  locust to 2.1 semaphore wait  not use  when i run  on master-worker\r\n\r\npython 3.7.8", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1856/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1856/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1850", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1850/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1850/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1850/events", "html_url": "https://github.com/locustio/locust/issues/1850", "id": 971301197, "node_id": "MDU6SXNzdWU5NzEzMDExOTc=", "number": 1850, "title": "Exceptions are not logged when running in distributed mode", "user": {"login": "achenar5", "id": 11951055, "node_id": "MDQ6VXNlcjExOTUxMDU1", "avatar_url": "https://avatars.githubusercontent.com/u/11951055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/achenar5", "html_url": "https://github.com/achenar5", "followers_url": "https://api.github.com/users/achenar5/followers", "following_url": "https://api.github.com/users/achenar5/following{/other_user}", "gists_url": "https://api.github.com/users/achenar5/gists{/gist_id}", "starred_url": "https://api.github.com/users/achenar5/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/achenar5/subscriptions", "organizations_url": "https://api.github.com/users/achenar5/orgs", "repos_url": "https://api.github.com/users/achenar5/repos", "events_url": "https://api.github.com/users/achenar5/events{/privacy}", "received_events_url": "https://api.github.com/users/achenar5/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2021-08-16T02:11:09Z", "updated_at": "2021-10-27T01:49:41Z", "closed_at": "2021-10-27T01:49:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nWhen running Locust in a distributed master-worker mode, exceptions are logged in the worker node but do not show up in the Locust \"Exceptions\" UI section.\r\n\r\n### Expected behavior\r\nThe Locust \"Exceptions\" tab should show the same traceback as the worker log.\r\n\r\n### Actual behavior\r\n![image](https://user-images.githubusercontent.com/11951055/129501894-720cc5f7-ab4c-48e6-a06a-cc6881e0128e.png)\r\n![image](https://user-images.githubusercontent.com/11951055/129501934-e01d5119-7c61-456d-a26a-5d2fe0332af4.png)\r\n\r\n### Steps to reproduce\r\nThe master and worker are running from the latest Locust Docker image \"locustio/locust\", as two containers started with Docker Compose.  The locustfile.py is copied below.\r\n\r\n### Environment\r\n\r\n- OS: Fedora 34\r\n- Python version: 3.8.11\r\n- Locust version: 2.0.0b3\r\n- Locust command line that you ran:\r\nMaster options: --master -H http://master:8089\r\nWorker options:  --worker --master-host master --loglevel WARNING\r\n\r\n- Locust file contents (anonymized if necessary):\r\n\r\n```\r\nfrom locust import HttpUser, task\r\n\r\nclass QuickstartUser(HttpUser):\r\n    @task\r\n    def run(self):\r\n        raise Exception('asdf')\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1850/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1850/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1846", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1846/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1846/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1846/events", "html_url": "https://github.com/locustio/locust/issues/1846", "id": 963585367, "node_id": "MDU6SXNzdWU5NjM1ODUzNjc=", "number": 1846, "title": "locust in subprocess don't start", "user": {"login": "jade227", "id": 54238662, "node_id": "MDQ6VXNlcjU0MjM4NjYy", "avatar_url": "https://avatars.githubusercontent.com/u/54238662?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jade227", "html_url": "https://github.com/jade227", "followers_url": "https://api.github.com/users/jade227/followers", "following_url": "https://api.github.com/users/jade227/following{/other_user}", "gists_url": "https://api.github.com/users/jade227/gists{/gist_id}", "starred_url": "https://api.github.com/users/jade227/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jade227/subscriptions", "organizations_url": "https://api.github.com/users/jade227/orgs", "repos_url": "https://api.github.com/users/jade227/repos", "events_url": "https://api.github.com/users/jade227/events{/privacy}", "received_events_url": "https://api.github.com/users/jade227/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-08-09T02:10:09Z", "updated_at": "2021-09-01T16:28:47Z", "closed_at": "2021-08-09T08:04:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nLocust doesn't start in subprocess even if it run normally in another command line\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nLocust runs normally and stop when I give --run-time option\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nLocust don't run and no log out after web interface 0.0.0.0:8089 created\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\nin test.py, run \r\nsubprocess.Popen(\r\n    ['locust', '-f', 'locustfile.py', '--host', {HOST URL}, '--headless', '-u',' 1000', '-r', '100', '--run-time', '10s'], \r\n    stdout = subprocess.PIPE, \r\n    stderr = subprocess.PIPE, \r\n    shell=True\r\n)\r\nand this process never stop\r\n\r\n### Environment\r\n\r\n- OS: Linux ubuntu\r\n- Python version: 3.6.9\r\n- Locust version: 2.0.0\r\n- Locust command line that you ran: locust -f locustfile.py --host { HOST URL } --headless -u 1000 -r 100 --run-time 10s\r\n- Locust file contents (anonymized if necessary):\r\n POST base64 image to host url", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1846/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1846/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1843", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1843/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1843/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1843/events", "html_url": "https://github.com/locustio/locust/issues/1843", "id": 963039092, "node_id": "MDU6SXNzdWU5NjMwMzkwOTI=", "number": 1843, "title": "Workers go down with message: failed to send heartbeat, setting state to missing.", "user": {"login": "roquemoyano-tc", "id": 77789941, "node_id": "MDQ6VXNlcjc3Nzg5OTQx", "avatar_url": "https://avatars.githubusercontent.com/u/77789941?v=4", "gravatar_id": "", "url": "https://api.github.com/users/roquemoyano-tc", "html_url": "https://github.com/roquemoyano-tc", "followers_url": "https://api.github.com/users/roquemoyano-tc/followers", "following_url": "https://api.github.com/users/roquemoyano-tc/following{/other_user}", "gists_url": "https://api.github.com/users/roquemoyano-tc/gists{/gist_id}", "starred_url": "https://api.github.com/users/roquemoyano-tc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/roquemoyano-tc/subscriptions", "organizations_url": "https://api.github.com/users/roquemoyano-tc/orgs", "repos_url": "https://api.github.com/users/roquemoyano-tc/repos", "events_url": "https://api.github.com/users/roquemoyano-tc/events{/privacy}", "received_events_url": "https://api.github.com/users/roquemoyano-tc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2021-08-06T20:53:05Z", "updated_at": "2021-08-17T13:14:46Z", "closed_at": "2021-08-17T13:14:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nevery time that I run locust I'm always getting:  locust-worker-xxxx failed to send heartbeat, setting state to missing.\r\n\r\n### Expected behavior\r\nworker in running status\r\n\r\n### Actual behavior\r\nI'm using the oficial helm chart  to run locust, when I run the python code after some time the workers changes their status to missing and I'm not able to finish running the test.\r\n\r\n### Environment\r\n\r\n- OS: AKS\r\n- Python version: python version included in helm chart\r\n- Locust version: 1.5.0* to 2.0.0*\r\n- Locust command line that you ran: I open the Gui to run it\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1843/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1843/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1840", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1840/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1840/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1840/events", "html_url": "https://github.com/locustio/locust/issues/1840", "id": 961796717, "node_id": "MDU6SXNzdWU5NjE3OTY3MTc=", "number": 1840, "title": "locust timeout does not work as expected", "user": {"login": "YairTayb", "id": 48632701, "node_id": "MDQ6VXNlcjQ4NjMyNzAx", "avatar_url": "https://avatars.githubusercontent.com/u/48632701?v=4", "gravatar_id": "", "url": "https://api.github.com/users/YairTayb", "html_url": "https://github.com/YairTayb", "followers_url": "https://api.github.com/users/YairTayb/followers", "following_url": "https://api.github.com/users/YairTayb/following{/other_user}", "gists_url": "https://api.github.com/users/YairTayb/gists{/gist_id}", "starred_url": "https://api.github.com/users/YairTayb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/YairTayb/subscriptions", "organizations_url": "https://api.github.com/users/YairTayb/orgs", "repos_url": "https://api.github.com/users/YairTayb/repos", "events_url": "https://api.github.com/users/YairTayb/events{/privacy}", "received_events_url": "https://api.github.com/users/YairTayb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 15, "created_at": "2021-08-05T12:55:41Z", "updated_at": "2021-08-09T07:14:54Z", "closed_at": "2021-08-09T06:02:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nI am running locust without the ui in a and in a decentralized manner (about 25 EC2s) dockerized environment, my command is: \r\ndocker run --log-opt max-size=10m --log-opt max-file=2 -p 8089:8089 -p 5557:5557 -v $PWD/:/mnt/ locust_client -f /mnt/performance_test.py -P 8089 --headless --csv=/mnt/currentTestData --test_file_name currentTestData --use_ui false -u 2850 --user_amount 2850 --host_name $HOST --run-time 8h --host $HOST -r 10 -L INFO\r\n\r\ninstead of running for 8hours it ends after about 22 minutes give or take, constantly.\r\nlocust version for the dockerfile is: 1.4.4\r\n\r\nI would expect the test to run for 8 hours.\r\n\r\n\r\n- OS: Linux (amazon)\r\n- Python version: 2.7.8\r\n- Locust version: 1.4.4\r\n- Locust file contents (anonymized if necessary):\r\n################################\r\n\r\n\r\n```\r\nfrom locust import User, task, between, events, constant\r\nimport hashlib\r\nimport logging\r\nfrom endpoint_user import *\r\nfrom test_metrics_analyser import *\r\nfrom test_report_generator import *\r\n\r\n\r\n@events.init_command_line_parser.add_listener\r\ndef init_parser(parser):\r\n    parser.add_argument(\r\n        '--wavefront_api_key',\r\n        help=\"wavefront's api key\"\r\n    )\r\n    parser.add_argument(\r\n        '--test_file_name',\r\n        help=\"the test result file name\"\r\n    )\r\n    parser.add_argument(\r\n        '--user_amount',\r\n        help=\"the amount of users for the test\"\r\n    )\r\n    parser.add_argument(\r\n        '--host_name',\r\n        help=\"the vkm's address\"\r\n    )\r\n    parser.add_argument(\r\n        '--use_ui',\r\n        help=\"use user interface or not\"\r\n    )\r\n\r\n\r\n@events.test_stop.add_listener\r\ndef analyse_test_results_and_publish_report(environment, **kwargs):\r\n    logging.info(\"locust test finished, starting to analyse test results\")\r\n\r\n\r\nclass LongRunTest(EndpointUser):\r\n    wait_time = constant(0.1)\r\n    secret_name = \"secret_for_role_protected_folder\"\r\n    folder_name = \"dir_in_root\" + generate_random_alphanum_string(12)\r\n    secret_item = folder_name + \"/\" + secret_name\r\n\r\n    def __init__(self, *args, **kwargs):\r\n        super(LongRunTest, self).__init__(*args, **kwargs)\r\n        self.create_role_protected_folder()\r\n        self.create_secret_in_role_protected_folder()\r\n        self.create_key_in_role_protected_folder()\r\n        self.create_derived_key()\r\n\r\n    def __del__(self):\r\n        #self.cleanup()\r\n        logging.info(\"Cleanup Ended\")\r\n\r\n    @task(4)\r\n    def get_secret(self):\r\n        # logging.info(\"getting secret: \" + self.secret_item)\r\n        self.client.get_item(self.secret_item)\r\n\r\n    @task(8)\r\n    def twice_derive_key(self):\r\n        self.client.rcc_derive_twice_key(self.key.name, \"idps-team\", version=self.key.version)\r\n        # logging.info(\"twice_derive_key ended\")\r\n\r\n    @task(8)\r\n    def derive_key(self):\r\n        self.client.rcc_derive_key(self.derived_key.name, self.header_data, version=self.derived_key.version)\r\n        # logging.info(\"RCC derive key ended\")\r\n\r\n    @task(1)\r\n    def get_item_list_unprotected_folder(self):\r\n        self.client.get_items_list(self.folder_name)\r\n        # logging.info(\"Get item list for an unprotected folder finished\")\r\n\r\n    @task(1)\r\n    def get_non_existent_item_from_existing_folder(self):\r\n        non_existent_secret_name = self.folder_name + \"/\" + \"non_existing_secret\"\r\n        self.client.get_item_nonexistent(non_existent_secret_name)\r\n        # logging.info(\"Get non-existing item in an existing role-protected folder finished\")\r\n\r\n\r\n    def cleanup(self):\r\n        logging.info(\"Cleanup: Test ended, starting cleanup\")\r\n        self.client.ep.clear_item(self.secret_item)\r\n        logging.info(\"Cleanup: secret cleared: \" + self.secret_item)\r\n        self.client.ep.clear_item(self.key.name)\r\n        logging.info(\"Cleanup: key cleared \" + self.key.name)\r\n        # self.client.ep.clear_item(self.derived_key.name)\r\n        # logging.info(\"Cleanup: key cleared \"+self.derived_key.name)\r\n        self.client.ep.clear_item(self.folder_name)\r\n        logging.info(\"Cleanup: folder cleared \" + self.folder_name)\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1840/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1840/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1835", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1835/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1835/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1835/events", "html_url": "https://github.com/locustio/locust/issues/1835", "id": 957257747, "node_id": "MDU6SXNzdWU5NTcyNTc3NDc=", "number": 1835, "title": "time display in live charts switches to the local time upon refresh", "user": {"login": "jf", "id": 7270, "node_id": "MDQ6VXNlcjcyNzA=", "avatar_url": "https://avatars.githubusercontent.com/u/7270?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jf", "html_url": "https://github.com/jf", "followers_url": "https://api.github.com/users/jf/followers", "following_url": "https://api.github.com/users/jf/following{/other_user}", "gists_url": "https://api.github.com/users/jf/gists{/gist_id}", "starred_url": "https://api.github.com/users/jf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jf/subscriptions", "organizations_url": "https://api.github.com/users/jf/orgs", "repos_url": "https://api.github.com/users/jf/repos", "events_url": "https://api.github.com/users/jf/events{/privacy}", "received_events_url": "https://api.github.com/users/jf/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-07-31T14:41:04Z", "updated_at": "2021-08-17T06:34:14Z", "closed_at": "2021-08-17T06:34:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\nThere is a bug in the display of the time in live graphs (that thankfully doesnt seem to appear when you go to \u201cDownload Report\u201d), where the hour (time zone?) switches. It will show the time in the server's own timezone... and then at some point in the graph (depending on when you refreshed your browser to load the web UI), the time display will switch to the local timezone of your browser system.\r\n\r\n### Expected behavior\r\n\r\nThe time display should always be consistent. Either take the cue from the server (this is the default, and is fantastic)... or from the browser system.\r\n\r\n### Actual behavior\r\n\r\nSee \"Describe the bug\" section.\r\n\r\nHere is a screenshot of the problem, showing how the hour switches from 11 (the server is GMT) to 19 (my system is GMT+8):\r\n![Screenshot 2021-07-30 at 19 14 22](https://user-images.githubusercontent.com/7270/127743292-f41ad7bd-c559-4576-bf0c-d22d42c53125.png)\r\n\r\n### Steps to reproduce\r\n\r\nSet up a server in a different time zone from your local system. Load the web UI and start a run. Refresh your browser, and click \"Charts\". You will notice that the last time as shown in the charts will *always* be in your local timezone, and as more points get added to the graphs, all of those will be in your local time.\r\n\r\nThis behaviour is repeatable. Refresh your browser again, click on \"Charts\" again... and you will see again that all of the time values will reset to the server's time zone save for the last one.\r\n\r\n### Environment\r\n\r\n- OS: Ubuntu 20.04\r\n- Python version: 3.8.10\r\n- Locust version: 1.6.0", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1835/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1835/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1824", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1824/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1824/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1824/events", "html_url": "https://github.com/locustio/locust/issues/1824", "id": 952231323, "node_id": "MDU6SXNzdWU5NTIyMzEzMjM=", "number": 1824, "title": "Locust as library throwing Master-Server connection error in Distributed mode", "user": {"login": "naveen-kinnal", "id": 11724256, "node_id": "MDQ6VXNlcjExNzI0MjU2", "avatar_url": "https://avatars.githubusercontent.com/u/11724256?v=4", "gravatar_id": "", "url": "https://api.github.com/users/naveen-kinnal", "html_url": "https://github.com/naveen-kinnal", "followers_url": "https://api.github.com/users/naveen-kinnal/followers", "following_url": "https://api.github.com/users/naveen-kinnal/following{/other_user}", "gists_url": "https://api.github.com/users/naveen-kinnal/gists{/gist_id}", "starred_url": "https://api.github.com/users/naveen-kinnal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/naveen-kinnal/subscriptions", "organizations_url": "https://api.github.com/users/naveen-kinnal/orgs", "repos_url": "https://api.github.com/users/naveen-kinnal/repos", "events_url": "https://api.github.com/users/naveen-kinnal/events{/privacy}", "received_events_url": "https://api.github.com/users/naveen-kinnal/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2021-07-25T09:09:36Z", "updated_at": "2021-07-26T16:31:05Z", "closed_at": "2021-07-26T16:31:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nWhen I run the locust as a library with Master-worker mode, I am getting a worker-server connection error.\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nThe tests should run without any errors.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nGetting the below warning, and the tests are not running.\r\n\r\n`WARNING:locust.runners:You are running in distributed mode but have no worker servers connected. Please connect workers prior to swarming.`\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\nBelow is the code\r\n\r\n```\r\nfrom gen_recommender import RecommenderUser\r\nfrom locust.env import Environment\r\nimport gevent\r\nfrom locust.stats import stats_printer, stats_history\r\nfrom locust.runners import STATE_RUNNING\r\nimport os\r\n\r\ndef create_workers():\r\n    for _ in range(20):\r\n        environ = Environment(user_classes=[RecommenderUser])\r\n        environ.create_worker_runner('127.0.0.1', 5557)\r\n\r\ndef create_master():\r\n    envi = Environment(user_classes=[RecommenderUser])\r\n    envi.create_master_runner(master_bind_host='*', master_bind_port=5557)\r\n    envi.create_web_ui(web_host, int(web_port))\r\n\r\n    gevent.spawn(stats_printer(envi.stats))\r\n    gevent.spawn(stats_history, envi.runner)\r\n    gevent.spawn(checker, envi.runner)\r\n\r\n    return envi\r\n\r\ndef run_tests(environ, users, spawn_rate):\r\n    environ.runner.start(users, spawn_rate=spawn_rate)\r\n    environ.runner.greenlet.join()\r\n    environ.web_ui.stop()\r\n    \r\nmy_env = create_master()\r\ncreate_workers()\r\nrun_tests(my_env, 10000, 100)\r\n```\r\n\r\n### Environment\r\n\r\n- OS: Windows\r\n- Python version: 3.7\r\n- Locust version: latest\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1824/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1824/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1814", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1814/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1814/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1814/events", "html_url": "https://github.com/locustio/locust/issues/1814", "id": 945707553, "node_id": "MDU6SXNzdWU5NDU3MDc1NTM=", "number": 1814, "title": "In master mode, locust should not require a locustfile", "user": {"login": "noamtamim", "id": 10047237, "node_id": "MDQ6VXNlcjEwMDQ3MjM3", "avatar_url": "https://avatars.githubusercontent.com/u/10047237?v=4", "gravatar_id": "", "url": "https://api.github.com/users/noamtamim", "html_url": "https://github.com/noamtamim", "followers_url": "https://api.github.com/users/noamtamim/followers", "following_url": "https://api.github.com/users/noamtamim/following{/other_user}", "gists_url": "https://api.github.com/users/noamtamim/gists{/gist_id}", "starred_url": "https://api.github.com/users/noamtamim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/noamtamim/subscriptions", "organizations_url": "https://api.github.com/users/noamtamim/orgs", "repos_url": "https://api.github.com/users/noamtamim/repos", "events_url": "https://api.github.com/users/noamtamim/events{/privacy}", "received_events_url": "https://api.github.com/users/noamtamim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-07-15T19:58:22Z", "updated_at": "2021-07-27T14:07:05Z", "closed_at": "2021-07-15T21:05:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n### Describe the bug\r\nWhen running locust in master mode, it doesn't really use a locustfile - yet it requires it.\r\n\r\n### Expected behavior\r\nLocust should start in master mode without trying to load a locustfile.\r\n\r\n### Actual behavior\r\nThe following error is shown and locust refuses to start:\r\n> Could not find any locustfile! Ensure file ends in '.py' and see --help for available options.\r\n\r\n### Steps to reproduce\r\nJust run `locust --master` in an empty directory.\r\n\r\n### Environment\r\n- Python version: 3.9.5\r\n- Locust version: 1.6.0\r\n- Locust command line that you ran: `locust --master`\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1814/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1814/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1813", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1813/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1813/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1813/events", "html_url": "https://github.com/locustio/locust/issues/1813", "id": 944805701, "node_id": "MDU6SXNzdWU5NDQ4MDU3MDE=", "number": 1813, "title": "Locust not reading from locust.conf", "user": {"login": "jason-m-reich", "id": 22607604, "node_id": "MDQ6VXNlcjIyNjA3NjA0", "avatar_url": "https://avatars.githubusercontent.com/u/22607604?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jason-m-reich", "html_url": "https://github.com/jason-m-reich", "followers_url": "https://api.github.com/users/jason-m-reich/followers", "following_url": "https://api.github.com/users/jason-m-reich/following{/other_user}", "gists_url": "https://api.github.com/users/jason-m-reich/gists{/gist_id}", "starred_url": "https://api.github.com/users/jason-m-reich/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jason-m-reich/subscriptions", "organizations_url": "https://api.github.com/users/jason-m-reich/orgs", "repos_url": "https://api.github.com/users/jason-m-reich/repos", "events_url": "https://api.github.com/users/jason-m-reich/events{/privacy}", "received_events_url": "https://api.github.com/users/jason-m-reich/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-07-14T21:20:22Z", "updated_at": "2021-07-16T21:43:46Z", "closed_at": "2021-07-14T22:51:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nLocust not reading from .locust.conf\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nThe \"All available configuration options\" table of the docs seem to make it clear that LOCUST_HOST and host are on the same footing. The former is for .env and the latter (according to the docs just above said table) can go in locust.conf\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n`host` never has in it the base URI I assign in locust.conf\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\nAny basics Locust API test where you place the base URI of the target machine in the host variable in locust.conf and expect it to work just as if you had placed it in a .env file into the environment variable LOCUST_HOST\r\n### Environment\r\n\r\n- OS:\r\n- Python version:\r\n- Locust version:\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1813/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1813/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1810", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1810/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1810/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1810/events", "html_url": "https://github.com/locustio/locust/issues/1810", "id": 940184558, "node_id": "MDU6SXNzdWU5NDAxODQ1NTg=", "number": 1810, "title": "FastHttpUser requests are blocking", "user": {"login": "soitinj", "id": 27452531, "node_id": "MDQ6VXNlcjI3NDUyNTMx", "avatar_url": "https://avatars.githubusercontent.com/u/27452531?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soitinj", "html_url": "https://github.com/soitinj", "followers_url": "https://api.github.com/users/soitinj/followers", "following_url": "https://api.github.com/users/soitinj/following{/other_user}", "gists_url": "https://api.github.com/users/soitinj/gists{/gist_id}", "starred_url": "https://api.github.com/users/soitinj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soitinj/subscriptions", "organizations_url": "https://api.github.com/users/soitinj/orgs", "repos_url": "https://api.github.com/users/soitinj/repos", "events_url": "https://api.github.com/users/soitinj/events{/privacy}", "received_events_url": "https://api.github.com/users/soitinj/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2021-07-08T20:11:02Z", "updated_at": "2022-06-29T12:29:00Z", "closed_at": "2021-07-13T10:57:02Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Describe the bug\r\nI'd like to simulate concurrent requests, much like a real javascript client would do. This can be done by spawning multiple greenlets within a task, and resolving them cooperatively. This approach is also suggested in [this issue report](https://github.com/locustio/locust/issues/198). This works just fine with HttpUser, but FastHttpUser requests are blocking, which means that the requests spawned are handled sequentially instead of cooperatively.\r\n\r\nThis also affects the request times of requests performed. For example, in the sample code below, the result time of request to /example_url_3 is the sum of all requests performed, request time to url /example_url_2 is the sum of request times to /example_url_1 and /example_url_2, and so on. This is the most unfortunate part of the issue.\r\n\r\ngeventhttpclient already supports concurrency, but this is 1 by default. The gevent UserAgent can be passed a concurrency kwarg, as explained [here](https://github.com/gwik/geventhttpclient#high-concurrency), but this is ignored in locust. I forked locust and made [this commit](https://github.com/soitinj/locust/commit/ee205dbbc634dcb4ff8f0cc7ecf975d14754c6a1) that allows adjusting concurrency within a locust user class that extends FastHttpUser. From my perspective, setting the concurrency to some number above 1 solves the issue. In the code sample below, concurrency=3 would be enough.\r\n\r\n### Expected behavior\r\nRequests should be executed cooperatively.\r\n\r\n### Actual behavior\r\nRequests are blocking instead of cooperatively.\r\n\r\n### Steps to reproduce\r\n```python\r\nfrom locust import TaskSet, task, between\r\nfrom locust.contrib.fasthttp import FastHttpUser\r\nfrom gevent.pool import Group\r\n\r\n\r\nclass ExampleTaskSet(TaskSet):\r\n\r\n    wait_time = between(4, 5)\r\n\r\n    @task\r\n    def example_task(self):\r\n        group = Group()\r\n        group.spawn(lambda: self.client.get(\"/example_url_1\"))\r\n        group.spawn(lambda: self.client.get(\"/example_url_2\"))\r\n        group.spawn(lambda: self.client.get(\"/example_url_3\"))\r\n        group.join()\r\n\r\nclass ExampleUser(FastHttpUser):\r\n    tasks = [ExampleTaskSet]\r\n    host = ''\r\n\r\n```\r\n\r\n### Environment\r\n\r\n- OS: macOS 10.14.6 Mojave\r\n- Python version: 3.7.2\r\n- Locust version: 1.5.3\r\n- Locust command line that you ran: locust", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1810/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1810/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1808", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1808/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1808/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1808/events", "html_url": "https://github.com/locustio/locust/issues/1808", "id": 938657447, "node_id": "MDU6SXNzdWU5Mzg2NTc0NDc=", "number": 1808, "title": "Troubles when load testing multiple AWS EC2 instances behind a load balancer for deep-learning inference", "user": {"login": "Matthieu-Tinycoaching", "id": 77435960, "node_id": "MDQ6VXNlcjc3NDM1OTYw", "avatar_url": "https://avatars.githubusercontent.com/u/77435960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Matthieu-Tinycoaching", "html_url": "https://github.com/Matthieu-Tinycoaching", "followers_url": "https://api.github.com/users/Matthieu-Tinycoaching/followers", "following_url": "https://api.github.com/users/Matthieu-Tinycoaching/following{/other_user}", "gists_url": "https://api.github.com/users/Matthieu-Tinycoaching/gists{/gist_id}", "starred_url": "https://api.github.com/users/Matthieu-Tinycoaching/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Matthieu-Tinycoaching/subscriptions", "organizations_url": "https://api.github.com/users/Matthieu-Tinycoaching/orgs", "repos_url": "https://api.github.com/users/Matthieu-Tinycoaching/repos", "events_url": "https://api.github.com/users/Matthieu-Tinycoaching/events{/privacy}", "received_events_url": "https://api.github.com/users/Matthieu-Tinycoaching/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-07-07T08:57:51Z", "updated_at": "2021-07-12T12:36:47Z", "closed_at": "2021-07-07T09:50:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi community,\r\n\r\nI am struggling with one particular issue regarding load testing 2 GPU AWS EC2 instances behind a load balancer for deep learning inference. Indeed, when load testing a unique GPU instance I got better results than when load testing 2 GPU instances behind the load balancer. \r\n\r\nIs there anything to do regarding locust when load testing 2 instances behind a load balancer? I tried to launch 2 locust workers but this didn't work better.\r\n\r\nThanks for helping!\r\n\r\n### Environment\r\n\r\n- OS: Ubuntu 18.04\r\n- Python version: 3.8.8\r\n- Locust version: 1.4.4", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1808/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1808/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1804", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1804/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1804/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1804/events", "html_url": "https://github.com/locustio/locust/issues/1804", "id": 936656629, "node_id": "MDU6SXNzdWU5MzY2NTY2Mjk=", "number": 1804, "title": "ERROR:locust.user.task:A new response began before end of HTTPSocketPoolResponse", "user": {"login": "JingYang0725", "id": 18026276, "node_id": "MDQ6VXNlcjE4MDI2Mjc2", "avatar_url": "https://avatars.githubusercontent.com/u/18026276?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JingYang0725", "html_url": "https://github.com/JingYang0725", "followers_url": "https://api.github.com/users/JingYang0725/followers", "following_url": "https://api.github.com/users/JingYang0725/following{/other_user}", "gists_url": "https://api.github.com/users/JingYang0725/gists{/gist_id}", "starred_url": "https://api.github.com/users/JingYang0725/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JingYang0725/subscriptions", "organizations_url": "https://api.github.com/users/JingYang0725/orgs", "repos_url": "https://api.github.com/users/JingYang0725/repos", "events_url": "https://api.github.com/users/JingYang0725/events{/privacy}", "received_events_url": "https://api.github.com/users/JingYang0725/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2021-07-05T03:59:35Z", "updated_at": "2021-09-16T01:51:59Z", "closed_at": "2021-09-16T01:51:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Descriptions:**\r\nI want to read the user's request data from the database and play it back\r\n\r\nSuch as:\r\n\r\nUser A has 1000 requests in the database\r\n\r\nThen I will read the data from the database as each user is started by Locust, and one of the users will read user A, and I will play back the 1000 requests in the transaction\r\n\r\nBut I got an error\r\n\r\n**Error Detail:**\r\nERROR:locust.user.task:A new response began before end of <HTTPSocketPoolResponse status=200 headers={'date': 'Mon, 05 Jul 2021 03:48:06 GMT', 'content-type': 'application/json;charset=UTF-8', 'content-length': '42', 'connection': 'keep-alive'}>\r\n\r\n### Steps to reproduce\r\nHttp Mode:FastHttpUser\r\n@task(100)\r\ndef transaction(self):\r\n    # Step 1\r\n    # get requests from database\r\n    # Step 2\r\n    # do requests\r\n    for i in range(1000):\r\n         self.client.request(path=my_path, method=my_method, header=my_headers, json=my_json)\r\n\r\n**### Environment**\r\n\r\n- OS:\r\n- Python version: 3.8.0\r\n- Locust version: 1.5.3\r\n- Locust command line that you ran: locust -f run_test.py\r\n- Locust file contents (anonymized if necessary): \r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1804/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1804/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1802", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1802/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1802/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1802/events", "html_url": "https://github.com/locustio/locust/issues/1802", "id": 936247684, "node_id": "MDU6SXNzdWU5MzYyNDc2ODQ=", "number": 1802, "title": "Issue with locust master on Python and locust client on JAVA", "user": {"login": "Blodlad", "id": 55101664, "node_id": "MDQ6VXNlcjU1MTAxNjY0", "avatar_url": "https://avatars.githubusercontent.com/u/55101664?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Blodlad", "html_url": "https://github.com/Blodlad", "followers_url": "https://api.github.com/users/Blodlad/followers", "following_url": "https://api.github.com/users/Blodlad/following{/other_user}", "gists_url": "https://api.github.com/users/Blodlad/gists{/gist_id}", "starred_url": "https://api.github.com/users/Blodlad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Blodlad/subscriptions", "organizations_url": "https://api.github.com/users/Blodlad/orgs", "repos_url": "https://api.github.com/users/Blodlad/repos", "events_url": "https://api.github.com/users/Blodlad/events{/privacy}", "received_events_url": "https://api.github.com/users/Blodlad/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-07-03T12:42:29Z", "updated_at": "2021-07-15T21:08:37Z", "closed_at": "2021-07-15T21:08:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nHello I tried to write the actual code where I used Locust framework for performance testing and locust4j from github. I created the master on Python and slave on Java. The master and slave started, but master didn't see that slave was connected to master, actually is not connected. And in UI it wasn't worked. \r\n### Expected behavior\r\nI changed the version of locust the worker was connected but i got errors:\r\nTraceback (most recent call last):\r\n  File \"src\\\\gevent\\\\greenlet.py\", line 906, in gevent._gevent_cgreenlet.Greenlet.run\r\n  File \"c:\\users\\maksim_kim\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\locust\\runners.py\", line 707, in client_listener\r\n    c.cpu_usage = msg.data[\"current_cpu_usage\"]\r\nKeyError: 'current_cpu_usage'\r\n2021-07-03T12:27:24Z <Greenlet at 0x18eda9a4150: <bound method MasterRunner.client_listener of <locust.runners.MasterRunner object at 0x0000018EDA99A3D0>>> failed with KeyError\r\n\r\n### Actual behavior\r\n<img width=\"713\" alt=\"Screenshot_4\" src=\"https://user-images.githubusercontent.com/55101664/124354291-c6f7e400-dc24-11eb-9732-249e22c1560a.png\">\r\n\r\n\r\n### Steps to reproduce \r\nhere is the Python code on master\r\n\r\nfrom locust import User, TaskSet, task\r\n\r\nclass DummyTask(TaskSet):\r\n    @task(1)\r\n    def dummy(self):\r\n        pass\r\n\r\nclass Dummy(User):\r\n    tasks =[DummyTask]\r\nI also used the command on master for opening the port: locust -f locust-master.py --master --master-bind-host=127.0.0.1 --master-bind-port=5557 Here is the slave code on Java Main\r\n\r\n    import com.maksimkim.getData;\r\nimport com.github.myzhan.locust4j.Locust;\r\n\r\n    public class Main {\r\n        public static void main(String[] args) {\r\n            Locust locust = Locust.getInstance();\r\n            locust.setMasterHost(\"127.0.0.1\");\r\n            locust.setMasterPort(5557); //some free port to run the Locust slave\r\n\r\n            locust.run(\r\n                    new getData(50)\r\n            );\r\n        }\r\n    }\r\nHere is the slave Code on Java getData\r\n\r\nimport com.github.myzhan.locust4j.AbstractTask;\r\nimport com.github.myzhan.locust4j.Locust;\r\nimport com.jayway.restassured.response.Response;\r\nimport static com.jayway.restassured.RestAssured.given;\r\npublic class getData extends AbstractTask {\r\n    private int weight;\r\n\r\n    @Override\r\n    public int getWeight() {\r\n        return weight;\r\n    }\r\n\r\n\r\n    @Override\r\n    public String getName() {\r\n        return \"Open application task\";\r\n    }\r\n\r\n    public getData(int weight) {\r\n        this.weight = weight;\r\n    }\r\n\r\n    @Override\r\n    public void execute() {\r\n        try {\r\n            Response response = given().get(\"http://github.com\");\r\n            Locust.getInstance().recordSuccess(\"http\", getName(), response.getTime(), 1);\r\n\r\n        } catch (Exception ex) {\r\n            ex.printStackTrace();\r\n        }\r\n    }\r\n}\r\n\r\n### Environment\r\n\r\n- OS: Windows 10\r\n- Python version: 3.9.6\r\n- Java: 16.0.1\r\n- Locust version: 1.6.0\r\n- Locust4j: 1.0.6\r\n- Locust command line that you ran: locust -f locust-master.py --master --master-bind-host=127.0.0.1 --master-bind-port=5557 for master in python", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1802/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1802/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1801", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1801/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1801/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1801/events", "html_url": "https://github.com/locustio/locust/issues/1801", "id": 934477339, "node_id": "MDU6SXNzdWU5MzQ0NzczMzk=", "number": 1801, "title": "Task weight as set is not working", "user": {"login": "del-zhenwu", "id": 56623710, "node_id": "MDQ6VXNlcjU2NjIzNzEw", "avatar_url": "https://avatars.githubusercontent.com/u/56623710?v=4", "gravatar_id": "", "url": "https://api.github.com/users/del-zhenwu", "html_url": "https://github.com/del-zhenwu", "followers_url": "https://api.github.com/users/del-zhenwu/followers", "following_url": "https://api.github.com/users/del-zhenwu/following{/other_user}", "gists_url": "https://api.github.com/users/del-zhenwu/gists{/gist_id}", "starred_url": "https://api.github.com/users/del-zhenwu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/del-zhenwu/subscriptions", "organizations_url": "https://api.github.com/users/del-zhenwu/orgs", "repos_url": "https://api.github.com/users/del-zhenwu/repos", "events_url": "https://api.github.com/users/del-zhenwu/events{/privacy}", "received_events_url": "https://api.github.com/users/del-zhenwu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2021-07-01T06:53:14Z", "updated_at": "2021-10-13T05:12:10Z", "closed_at": "2021-10-13T05:12:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n### Describe the bug\r\nI use the following scripts for loading test:\r\n```\r\nMyUser.tasks = {Tasks.query: 1, Tasks.get: 20}\r\nenv = Environment(events=events, user_classes=[MyUser])\r\n    runner = env.create_local_runner()\r\n```\r\nMyUser:\r\n```\r\nclass MyUser(User):\r\n    wait_time = between(1, 2)\r\n```\r\nTasks:\r\n```\r\nclass Tasks(TaskSet):\r\n    @task\r\n    def query(self):\r\n        pass\r\n  \r\n    @task\r\n    def get(self):\r\n        pass\r\n```\r\nIt can be performed to run, but the number of the requests is not match the weight value as set.\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version:\r\n- Locust version: 1.4.3\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1801/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1801/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1800", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1800/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1800/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1800/events", "html_url": "https://github.com/locustio/locust/issues/1800", "id": 933252562, "node_id": "MDU6SXNzdWU5MzMyNTI1NjI=", "number": 1800, "title": "The user task is blocked when I want a pymilvus client", "user": {"login": "12monkeys-stack", "id": 62694210, "node_id": "MDQ6VXNlcjYyNjk0MjEw", "avatar_url": "https://avatars.githubusercontent.com/u/62694210?v=4", "gravatar_id": "", "url": "https://api.github.com/users/12monkeys-stack", "html_url": "https://github.com/12monkeys-stack", "followers_url": "https://api.github.com/users/12monkeys-stack/followers", "following_url": "https://api.github.com/users/12monkeys-stack/following{/other_user}", "gists_url": "https://api.github.com/users/12monkeys-stack/gists{/gist_id}", "starred_url": "https://api.github.com/users/12monkeys-stack/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/12monkeys-stack/subscriptions", "organizations_url": "https://api.github.com/users/12monkeys-stack/orgs", "repos_url": "https://api.github.com/users/12monkeys-stack/repos", "events_url": "https://api.github.com/users/12monkeys-stack/events{/privacy}", "received_events_url": "https://api.github.com/users/12monkeys-stack/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-06-30T02:41:37Z", "updated_at": "2021-06-30T09:30:25Z", "closed_at": "2021-06-30T09:30:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nThe user task is blocked when I want a Milvus client. I can't fixed\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nIt should be keep running, output the log \r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nThe program blocked\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n![\u4f01\u4e1a\u5fae\u4fe1\u622a\u56fe_16250203643453](https://user-images.githubusercontent.com/62694210/123893247-a44c9d80-d98e-11eb-9595-ce804cfe4c44.png)\r\n\r\nThis program output line 39, and bolcked\r\n\r\npymilvus==0.2.14, follow GRPC protocol\r\n![\u4f01\u4e1a\u5fae\u4fe1\u622a\u56fe_16250207401830](https://user-images.githubusercontent.com/62694210/123893821-b2e78480-d98f-11eb-884b-90e1193eb786.png)\r\n\r\n\r\n### Environment\r\n\r\n- OS: Linux\r\n- Python version: python 3.8.8\r\n- Locust version: 1.6.0\r\n- Locust command line that you ran: locust -f milvus_req.py --host 127.0.0.1 -u 1 -r 1 -t 1m --headless\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1800/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1800/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1798", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1798/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1798/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1798/events", "html_url": "https://github.com/locustio/locust/issues/1798", "id": 930869225, "node_id": "MDU6SXNzdWU5MzA4NjkyMjU=", "number": 1798, "title": "UI not getting updated with Locust library usage", "user": {"login": "naveen-kinnal", "id": 11724256, "node_id": "MDQ6VXNlcjExNzI0MjU2", "avatar_url": "https://avatars.githubusercontent.com/u/11724256?v=4", "gravatar_id": "", "url": "https://api.github.com/users/naveen-kinnal", "html_url": "https://github.com/naveen-kinnal", "followers_url": "https://api.github.com/users/naveen-kinnal/followers", "following_url": "https://api.github.com/users/naveen-kinnal/following{/other_user}", "gists_url": "https://api.github.com/users/naveen-kinnal/gists{/gist_id}", "starred_url": "https://api.github.com/users/naveen-kinnal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/naveen-kinnal/subscriptions", "organizations_url": "https://api.github.com/users/naveen-kinnal/orgs", "repos_url": "https://api.github.com/users/naveen-kinnal/repos", "events_url": "https://api.github.com/users/naveen-kinnal/events{/privacy}", "received_events_url": "https://api.github.com/users/naveen-kinnal/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-06-27T07:34:01Z", "updated_at": "2021-09-06T01:50:43Z", "closed_at": "2021-09-06T01:50:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nI am running the Locust as a library for multiple spawn rates. My code looks as below\r\n\r\n```\r\nspawn_rates = [5, 20, 50]\r\n\r\nfor rate in spawn_rates:\r\n    env = Environment(user_classes=[RecommenderUser])\r\n    env.create_local_runner()\r\n    env.create_web_ui(\"127.0.0.1\", 8089)\r\n    gevent.spawn(stats_printer(env.stats))\r\n    gevent.spawn(stats_history, env.runner)\r\n    env.runner.start(1000, spawn_rate=rate)\r\n    gevent.spawn_later(120, lambda: env.runner.quit())\r\n    env.runner.greenlet.join()\r\n    env.web_ui.stop()\r\n    process(env.runner.stats.total.avg_response_time) \r\n\r\n```\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nMy Web UI should get reset for every new instance of the local runner.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nThe Web UI currently gets frozen just displaying the results of the first run alone (with the status 'STOPPED'), while the back-end run is successfully completed for all spawn-rates.\r\n\r\n### Environment\r\n\r\n- OS: Windows\r\n- Python version: 3.7\r\n- Locust version: 1.5.3\r\n- Locust command line that you ran: python locust_lib.py", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1798/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1798/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1796", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1796/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1796/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1796/events", "html_url": "https://github.com/locustio/locust/issues/1796", "id": 927641420, "node_id": "MDU6SXNzdWU5Mjc2NDE0MjA=", "number": 1796, "title": "fs module causing errors in UI mode", "user": {"login": "lesterbostic", "id": 32841418, "node_id": "MDQ6VXNlcjMyODQxNDE4", "avatar_url": "https://avatars.githubusercontent.com/u/32841418?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lesterbostic", "html_url": "https://github.com/lesterbostic", "followers_url": "https://api.github.com/users/lesterbostic/followers", "following_url": "https://api.github.com/users/lesterbostic/following{/other_user}", "gists_url": "https://api.github.com/users/lesterbostic/gists{/gist_id}", "starred_url": "https://api.github.com/users/lesterbostic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lesterbostic/subscriptions", "organizations_url": "https://api.github.com/users/lesterbostic/orgs", "repos_url": "https://api.github.com/users/lesterbostic/repos", "events_url": "https://api.github.com/users/lesterbostic/events{/privacy}", "received_events_url": "https://api.github.com/users/lesterbostic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2021-06-22T21:18:27Z", "updated_at": "2021-09-02T01:49:31Z", "closed_at": "2021-09-02T01:49:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am creating a RAM disk using the fs module.\r\n\r\nCode Snippet:\r\n`4: from fs.memoryfs import MemoryFS\r\n\r\n18:   v_dir = MemoryFS()\r\n\r\n27:    try:\r\n28:       with v_dir.openbin(up_path, \"w\", 1024) as fout:\r\n29:            fout.write(os.urandom(1024 * size_k_bytes))`\r\n\r\nI am getting this error only when not using headless mode:\r\n<html>\r\n<body>\r\n<!--StartFragment-->\r\n\r\nTraceback (most recent call last):\r\n--\r\n\u00a0 | File \"/usr/local/bin/locust\", line 11, in <module>\r\n\u00a0 | load_entry_point('locust==1.4.3', 'console_scripts', 'locust')()\r\n\u00a0 | File \"/usr/local/lib/python3.6/site-packages/locust/main.py\", line 125, in main\r\n\u00a0 | docstring, user_classes, shape_class = load_locustfile(locustfile)\r\n\u00a0 | File \"/usr/local/lib/python3.6/site-packages/locust/main.py\", line 81, in load_locustfile\r\n\u00a0 | imported = source.load_module()\r\n\u00a0 | File \"<frozen importlib._bootstrap_external>\", line 399, in _check_name_wrapper\r\n\u00a0 | File \"<frozen importlib._bootstrap_external>\", line 823, in load_module\r\n\u00a0 | File \"<frozen importlib._bootstrap_external>\", line 682, in load_module\r\n\u00a0 | File \"<frozen importlib._bootstrap>\", line 265, in _load_module_shim\r\n\u00a0 | File \"<frozen importlib._bootstrap>\", line 684, in _load\r\n\u00a0 | File \"<frozen importlib._bootstrap>\", line 665, in _load_unlocked\r\n\u00a0 | File \"<frozen importlib._bootstrap_external>\", line 678, in exec_module\r\n\u00a0 | File \"<frozen importlib._bootstrap>\", line 219, in _call_with_frames_removed\r\n\u00a0 | File \"/mnt/locust/artperftest.py\", line 4, in <module>\r\n\u00a0 | from artfrmwrk.bin_file_gen import create_bin_file\r\n\u00a0 | File \"/mnt/locust/artfrmwrk/bin_file_gen.py\", line 4, in <module>\r\n\u00a0 | from fs.memoryfs import MemoryFS\r\n\u00a0 | ModuleNotFoundError: No module named 'fs'\r\n\r\n<!--EndFragment-->\r\n</body>\r\n</html>", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1796/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1796/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1792", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1792/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1792/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1792/events", "html_url": "https://github.com/locustio/locust/issues/1792", "id": 925640480, "node_id": "MDU6SXNzdWU5MjU2NDA0ODA=", "number": 1792, "title": "Locust 1.5.3 greenlet AttributeError: 'RetriesExceeded' object has no attribute 'kwargs_text'", "user": {"login": "ecc256", "id": 15874603, "node_id": "MDQ6VXNlcjE1ODc0NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/15874603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecc256", "html_url": "https://github.com/ecc256", "followers_url": "https://api.github.com/users/ecc256/followers", "following_url": "https://api.github.com/users/ecc256/following{/other_user}", "gists_url": "https://api.github.com/users/ecc256/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecc256/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecc256/subscriptions", "organizations_url": "https://api.github.com/users/ecc256/orgs", "repos_url": "https://api.github.com/users/ecc256/repos", "events_url": "https://api.github.com/users/ecc256/events{/privacy}", "received_events_url": "https://api.github.com/users/ecc256/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-06-20T16:59:43Z", "updated_at": "2021-08-31T01:49:23Z", "closed_at": "2021-08-31T01:49:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "Guys,\r\nI've upgraded to Anaconda3-2021.05, recreated locust env and start getting the error below.\r\nIs it something expected or do I need to do anything in my code to fix it?\r\n\r\n```\r\nwith self.client.get(url, headers=self.headers, catch_response=True) as response:\r\n\tif response.status_code != self.status_code:\r\n\t\tprint(f'{self.id}: got {response.status_code}, expected {self.status_code} for {url}')\r\n\r\n```\r\n`Python 3.9.5`\r\n```\r\n[2021-06-20 11:02:16,107] WSAMZN-ABCD1234/INFO/locust.main: Run time limit set to 7200 seconds\r\n[2021-06-20 11:02:16,107] WSAMZN-ABCD1234/INFO/locust.main: Starting Locust 1.5.3\r\n[2021-06-20 11:02:16,122] WSAMZN-ABCD1234/INFO/locust.runners: Spawning 1 users at the rate 1 users/s (0 users already running)...\r\n[2021-06-20 11:02:16,122] WSAMZN-ABCD1234/INFO/locust.runners: All users spawned: User: 1 (1 total running)\r\n[2021-06-20 11:02:16,122] WSAMZN-ABCD1234/INFO/locust.runners: Resetting stats\r\n\r\n0: got 0, expected 200 for http://acb.def.com/viewitems/categories\r\n[2021-06-20 11:04:04,765] WSAMZN-ABCD1234/ERROR/root: Uncaught exception in event handler:\r\nTraceback (most recent call last):\r\n  File \"c:\\users\\user\\anaconda3\\envs\\locust395\\lib\\site-packages\\locust\\event.py\", line 40, in fire\r\n    handler(**kwargs)\r\n  File \"c:\\users\\user\\anaconda3\\envs\\locust395\\lib\\site-packages\\locust\\runners.py\", line 79, in on_request_failure\r\n    self.stats.log_error(request_type, name, exception)\r\n  File \"c:\\users\\user\\anaconda3\\envs\\locust395\\lib\\site-packages\\locust\\stats.py\", line 143, in log_error\r\n    key = StatsError.create_key(method, name, error)\r\n  File \"c:\\users\\user\\anaconda3\\envs\\locust395\\lib\\site-packages\\locust\\stats.py\", line 640, in create_key\r\n    key = \"%s.%s.%r\" % (method, name, StatsError.parse_error(error))\r\n  File \"c:\\users\\user\\anaconda3\\envs\\locust395\\lib\\site-packages\\locust\\stats.py\", line 626, in parse_error\r\n    string_error = repr(error)\r\n  File \"c:\\users\\user\\anaconda3\\envs\\locust395\\lib\\site-packages\\geventhttpclient\\useragent.py\", line 48, in __repr__\r\n    if self.kwargs_text:\r\nAttributeError: 'RetriesExceeded' object has no attribute 'kwargs_text'\r\n```\r\n```\r\n(locust395)>conda list\r\n# packages in environment at c:\\users\\user\\Anaconda3\\envs\\locust395:\r\n#\r\n# Name                    Version                   Build  Channel\r\nca-certificates           2021.5.25            haa95532_1\r\ncertifi                   2021.5.30        py39haa95532_0\r\ncffi                      1.14.5                   pypi_0    pypi\r\nchardet                   4.0.0                    pypi_0    pypi\r\nclick                     8.0.1                    pypi_0    pypi\r\ncolorama                  0.4.4                    pypi_0    pypi\r\nconfigargparse            1.4.1                    pypi_0    pypi\r\nflask                     1.1.2                    pypi_0    pypi\r\nflask-basicauth           0.2.0                    pypi_0    pypi\r\ngevent                    21.1.2                   pypi_0    pypi\r\ngeventhttpclient          1.4.4                    pypi_0    pypi\r\ngreenlet                  1.1.0                    pypi_0    pypi\r\nidna                      2.10                     pypi_0    pypi\r\nitsdangerous              2.0.1                    pypi_0    pypi\r\njinja2                    3.0.1                    pypi_0    pypi\r\nlocust                    1.5.3                    pypi_0    pypi\r\nmarkupsafe                2.0.1                    pypi_0    pypi\r\nmsgpack                   1.0.2                    pypi_0    pypi\r\nopenssl                   1.1.1k               h2bbff1b_0\r\npip                       21.1.2           py39haa95532_0\r\npsutil                    5.8.0                    pypi_0    pypi\r\npycparser                 2.20                     pypi_0    pypi\r\npyodbc                    4.0.30                   pypi_0    pypi\r\npython                    3.9.5                h6244533_3\r\npywin32                   228              py39he774522_0\r\npyzmq                     22.1.0                   pypi_0    pypi\r\nrequests                  2.25.1                   pypi_0    pypi\r\nsetuptools                52.0.0           py39haa95532_0\r\nsqlite                    3.35.4               h2bbff1b_0\r\ntzdata                    2020f                h52ac0ba_0\r\nurllib3                   1.26.5                   pypi_0    pypi\r\nvc                        14.2                 h21ff451_1\r\nvs2015_runtime            14.27.29016          h5e58377_2\r\nwerkzeug                  2.0.1                    pypi_0    pypi\r\nwheel                     0.36.2             pyhd3eb1b0_0\r\nwincertstore              0.2              py39h2bbff1b_0\r\nzope-event                4.5.0                    pypi_0    pypi\r\nzope-interface            5.4.0                    pypi_0    pypi\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1792/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1792/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1786", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1786/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1786/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1786/events", "html_url": "https://github.com/locustio/locust/issues/1786", "id": 918938528, "node_id": "MDU6SXNzdWU5MTg5Mzg1Mjg=", "number": 1786, "title": "All workers failed to make targeted api requests in distributed mode.", "user": {"login": "rahul-sehgal", "id": 40372214, "node_id": "MDQ6VXNlcjQwMzcyMjE0", "avatar_url": "https://avatars.githubusercontent.com/u/40372214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rahul-sehgal", "html_url": "https://github.com/rahul-sehgal", "followers_url": "https://api.github.com/users/rahul-sehgal/followers", "following_url": "https://api.github.com/users/rahul-sehgal/following{/other_user}", "gists_url": "https://api.github.com/users/rahul-sehgal/gists{/gist_id}", "starred_url": "https://api.github.com/users/rahul-sehgal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rahul-sehgal/subscriptions", "organizations_url": "https://api.github.com/users/rahul-sehgal/orgs", "repos_url": "https://api.github.com/users/rahul-sehgal/repos", "events_url": "https://api.github.com/users/rahul-sehgal/events{/privacy}", "received_events_url": "https://api.github.com/users/rahul-sehgal/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 19, "created_at": "2021-06-11T16:09:03Z", "updated_at": "2021-08-17T07:12:38Z", "closed_at": "2021-08-17T07:12:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nWe are running locust in distributed mode on a single machine (Jenkins executor), which has 4 cores. The master runs on 1 core and workers are on other 3 cores. All the workers register with master successfully, we see this log message in our jenkins job \"_Currently 3 clients ready to swarm._\" and \"_Sending spawn jobs of 60 users and 1.00 spawn rate to 3 ready clients_\". But after test completion the aggregated # of requests and req/sec is way less than running locust in **non-distributed mode** (with same test configuration). The load difference is in range of 1.5x to 2x between distributed and non-distributed test runs. Also, we are using **_FastHttpUser_** in both scenarios. We are using single HttpUser class with weighted tasks for this test.\r\n\r\nWe tried with latest version of locust(1.5.3) but it fails for _FastHttpUser_ with this error _\"{**self.user.context(), **context}AttributeError: \"str\" object has no attribute \"context\"\"_ , so we used version 1.4.4 instead.\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nDistributed mode should run more load (using multiple cores) than non-distributed mode for same test configuration.\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nWith non-distributed mode we are able to run higher load than distributed mode for same test configuration. Following are the test configuration:\r\n- NUM_CLIENTS: 180\r\n- HATCH_RATE: 3\r\n- RUN_TIME: 15m\r\n- MIN_WAIT: 1\r\n- MAX_WAIT: 1\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: linux\r\n- Python version: 3.6\r\n- Locust version: 1.4.4\r\n- Locust command line that you ran: worker: ${venvPath}/bin/locust -f ${filePath}/${locustFile} --worker,\r\n                                                              master: ${venvPath}/bin/locust -f ${filePath}/${locustFile} -u ${numClients} -r ${hatchRate} -t ${runTime} --csv=${outputFile} --headless ${userClass} --master --expect-workers=${cpuCores}\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1786/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1786/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1778", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1778/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1778/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1778/events", "html_url": "https://github.com/locustio/locust/issues/1778", "id": 912377528, "node_id": "MDU6SXNzdWU5MTIzNzc1Mjg=", "number": 1778, "title": "test_start/stop event hook are never called in 1.5.3", "user": {"login": "taitelman", "id": 8079496, "node_id": "MDQ6VXNlcjgwNzk0OTY=", "avatar_url": "https://avatars.githubusercontent.com/u/8079496?v=4", "gravatar_id": "", "url": "https://api.github.com/users/taitelman", "html_url": "https://github.com/taitelman", "followers_url": "https://api.github.com/users/taitelman/followers", "following_url": "https://api.github.com/users/taitelman/following{/other_user}", "gists_url": "https://api.github.com/users/taitelman/gists{/gist_id}", "starred_url": "https://api.github.com/users/taitelman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/taitelman/subscriptions", "organizations_url": "https://api.github.com/users/taitelman/orgs", "repos_url": "https://api.github.com/users/taitelman/repos", "events_url": "https://api.github.com/users/taitelman/events{/privacy}", "received_events_url": "https://api.github.com/users/taitelman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-06-05T18:12:34Z", "updated_at": "2021-06-05T19:50:36Z", "closed_at": "2021-06-05T18:27:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "in locust distributed locust I added a test for https://docs.locust.io/en/stable/api.html#locust.event.Events.test_start\r\n```\r\n@events.init.add_listener\r\ndef on_locust_init(environment, **kwargs):\r\n        logging.info(\"Master init.\")\r\n    else:\r\n        logging.info(\"Worker init\")\r\n\r\n@events.test_start.add_listener\r\ndef test_start(*a, **kw):\r\n    print(\"test_start 1\")\r\n\r\n@events.test_stop.add_listener\r\ndef test_stop(*a, **kw):\r\n    print(\"test_stop 1\")\r\n\r\nclass QuickstartUser(HttpUser):\r\n    ...more code here...\r\n\r\n``` \r\n`test_start` (or stop) methods are never called (not in master and not in worker). other events types are called as expected.\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1778/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1778/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1775", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1775/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1775/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1775/events", "html_url": "https://github.com/locustio/locust/issues/1775", "id": 910849780, "node_id": "MDU6SXNzdWU5MTA4NDk3ODA=", "number": 1775, "title": "Issue with multiple_hosts.py", "user": {"login": "des-moines", "id": 85316828, "node_id": "MDQ6VXNlcjg1MzE2ODI4", "avatar_url": "https://avatars.githubusercontent.com/u/85316828?v=4", "gravatar_id": "", "url": "https://api.github.com/users/des-moines", "html_url": "https://github.com/des-moines", "followers_url": "https://api.github.com/users/des-moines/followers", "following_url": "https://api.github.com/users/des-moines/following{/other_user}", "gists_url": "https://api.github.com/users/des-moines/gists{/gist_id}", "starred_url": "https://api.github.com/users/des-moines/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/des-moines/subscriptions", "organizations_url": "https://api.github.com/users/des-moines/orgs", "repos_url": "https://api.github.com/users/des-moines/repos", "events_url": "https://api.github.com/users/des-moines/events{/privacy}", "received_events_url": "https://api.github.com/users/des-moines/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-06-03T21:01:06Z", "updated_at": "2021-08-15T01:49:26Z", "closed_at": "2021-08-15T01:49:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nRunning the sample code in multiple_hosts.py fails. \r\n\r\n### Expected behavior\r\nThe code should run without errors. \r\n\r\n### Actual behavior\r\nIt fails with this error: \r\nTypeError: __init__() missing 2 required positional arguments: 'request_event' and 'user'\r\n\r\n### Environment\r\n\r\n- OS: MacOS Big Sur 11.3.1\r\n- Python version: 3.8.10\r\n- Locust version: 1.5.3\r\n- Locust command line that you ran: locust -f \r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1775/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1775/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1774", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1774/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1774/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1774/events", "html_url": "https://github.com/locustio/locust/issues/1774", "id": 909416012, "node_id": "MDU6SXNzdWU5MDk0MTYwMTI=", "number": 1774, "title": "Can't start the Web UI on another machine", "user": {"login": "naveen-kinnal", "id": 11724256, "node_id": "MDQ6VXNlcjExNzI0MjU2", "avatar_url": "https://avatars.githubusercontent.com/u/11724256?v=4", "gravatar_id": "", "url": "https://api.github.com/users/naveen-kinnal", "html_url": "https://github.com/naveen-kinnal", "followers_url": "https://api.github.com/users/naveen-kinnal/followers", "following_url": "https://api.github.com/users/naveen-kinnal/following{/other_user}", "gists_url": "https://api.github.com/users/naveen-kinnal/gists{/gist_id}", "starred_url": "https://api.github.com/users/naveen-kinnal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/naveen-kinnal/subscriptions", "organizations_url": "https://api.github.com/users/naveen-kinnal/orgs", "repos_url": "https://api.github.com/users/naveen-kinnal/repos", "events_url": "https://api.github.com/users/naveen-kinnal/events{/privacy}", "received_events_url": "https://api.github.com/users/naveen-kinnal/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-06-02T11:50:19Z", "updated_at": "2021-06-16T10:22:21Z", "closed_at": "2021-06-16T10:18:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nI would want to start the locust Web UI as a service on my host which runs the docker image of Locust stored in another machine, with a URL something like this\r\n`https://service-website:30001/studio/projects/recommender/services/icrs-stress-test/8089/`   \r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nWhen I initiate and run the service, I should be able to get the Web UI of Locust in the above mentioned URL\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nGetting an exception as below\r\n    \r\n`[2021-06-01 09:17:16,035] a8094620894d/INFO/locust.main: Starting web interface at http://0.0.0.0:8089 (accepting connections from all network interfaces) [2021-06-01 09:17:16,043] a8094620894d/INFO/locust.main: Starting Locust 1.5.3 Traceback (most recent call last): File \"src/gevent/greenlet.py\", line 906, in gevent._gevent_cgreenlet.Greenlet.run File \"/usr/local/lib/python3.8/site-packages/locust/web.py\", line 339, in start_server self.server.serve_forever() File \"/usr/local/lib/python3.8/site-packages/gevent/baseserver.py\", line 398, in serve_forever self.start() File \"/usr/local/lib/python3.8/site-packages/gevent/baseserver.py\", line 336, in start self.init_socket() File \"/usr/local/lib/python3.8/site-packages/gevent/pywsgi.py\", line 1545, in init_socket StreamServer.init_socket(self) File \"/usr/local/lib/python3.8/site-packages/gevent/server.py\", line 180, in init_socket self.socket = self.get_listener(self.address, self.backlog, self.family) File \"/usr/local/lib/python3.8/site-packages/gevent/server.py\", line 192, in get_listener return _tcp_listener(address, backlog=backlog, reuse_addr=cls.reuse_addr, family=family) File \"/usr/local/lib/python3.8/site-packages/gevent/server.py\", line 284, in _tcp_listener sock = GeventSocket(family=family) File \"/usr/local/lib/python3.8/site-packages/gevent/_socket3.py\", line 133, in __init__ self._sock = self._gevent_sock_class(family, type, proto, fileno) OSError: [Errno 97] Address family not supported by protocol 2021-06-01T09:17:16Z <Greenlet at 0x7fb0dc1177b0: <bound method WebUI.start_server of <locust.web.WebUI object at 0x7fb0dc09ab80>>> failed with OSError`\r\n\r\nI see in the Locust on AWS tutorials, that invoking the Web UI was happening with `http://*:8089` in earlier version of Locust. That could easily connect to the host on AWS. But now, the Web UI is starting with `http://0.0.0.0:8089`. Is this by any chance the reason I am not able to run the Web UI in an external system?  \r\n\r\n### Environment\r\n\r\n- Python version: 3.8\r\n- Locust version: latest", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1774/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1774/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1773", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1773/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1773/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1773/events", "html_url": "https://github.com/locustio/locust/issues/1773", "id": 908197840, "node_id": "MDU6SXNzdWU5MDgxOTc4NDA=", "number": 1773, "title": "Web UI mode to run load test not working for Python 3.6 version", "user": {"login": "adityadhanraj", "id": 20147709, "node_id": "MDQ6VXNlcjIwMTQ3NzA5", "avatar_url": "https://avatars.githubusercontent.com/u/20147709?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adityadhanraj", "html_url": "https://github.com/adityadhanraj", "followers_url": "https://api.github.com/users/adityadhanraj/followers", "following_url": "https://api.github.com/users/adityadhanraj/following{/other_user}", "gists_url": "https://api.github.com/users/adityadhanraj/gists{/gist_id}", "starred_url": "https://api.github.com/users/adityadhanraj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adityadhanraj/subscriptions", "organizations_url": "https://api.github.com/users/adityadhanraj/orgs", "repos_url": "https://api.github.com/users/adityadhanraj/repos", "events_url": "https://api.github.com/users/adityadhanraj/events{/privacy}", "received_events_url": "https://api.github.com/users/adityadhanraj/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-06-01T11:34:07Z", "updated_at": "2021-06-02T03:06:53Z", "closed_at": "2021-06-01T15:11:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nGetting below error in Termianl\r\n  File \"c:\\users\\tiwaria\\downloads\\locust_3.6.0\\venv\\lib\\site-packages\\jinja2\\parser.py\", line 560, in parse_not\r\n    if self.stream.current.test(\"name:not\"):\r\nAttributeError: 'Token' object has no attribute 'test'\r\n\r\nLooks like there is issue in parsing html.\r\n![locsut_terminal_error](https://user-images.githubusercontent.com/20147709/120316378-fbf9d980-c2fa-11eb-9658-8af786735055.jpg)\r\n![server_error_locust](https://user-images.githubusercontent.com/20147709/120316392-fdc39d00-c2fa-11eb-8799-d824315c78a9.jpg)\r\n\r\n\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nWeb UI should get open to run performance test\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nGetting Internal server error\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n1. Run ```locust -f test.py ``` command in terminal.\r\n2. Open browser and go to http://localhost:8089/\r\n\r\n### Environment\r\n\r\n- OS: Windows 10 Enterprise \r\n- Python version: Python 3.6.0\r\n- Locust version: 1.5.3\r\n- Locust command line that you ran: locust -f test.py\r\n- Locust file contents (anonymized if necessary): \r\n\r\n```\r\nimport time\r\nfrom locust import HttpUser, task, between\r\n\r\nclass QuickstartUser(HttpUser):\r\n    wait_time = between(1, 2.5)\r\n    @task\r\n    def hello_world(self):\r\n        self.client.get(\"/hello\")\r\n        self.client.get(\"/world\")\r\n\r\n    @task(3)\r\n    def view_items(self):\r\n        for item_id in range(10):\r\n            self.client.get(f\"/item?id={item_id}\", name=\"/item\")\r\n            time.sleep(1)\r\n\r\n    def on_start(self):\r\n        self.client.post(\"/login\", json={\"username\":\"foo\", \"password\":\"bar\"})\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1773/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1773/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1770", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1770/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1770/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1770/events", "html_url": "https://github.com/locustio/locust/issues/1770", "id": 907703311, "node_id": "MDU6SXNzdWU5MDc3MDMzMTE=", "number": 1770, "title": "Can't start Locust on localhost - getting an OSError", "user": {"login": "naveen-kinnal", "id": 11724256, "node_id": "MDQ6VXNlcjExNzI0MjU2", "avatar_url": "https://avatars.githubusercontent.com/u/11724256?v=4", "gravatar_id": "", "url": "https://api.github.com/users/naveen-kinnal", "html_url": "https://github.com/naveen-kinnal", "followers_url": "https://api.github.com/users/naveen-kinnal/followers", "following_url": "https://api.github.com/users/naveen-kinnal/following{/other_user}", "gists_url": "https://api.github.com/users/naveen-kinnal/gists{/gist_id}", "starred_url": "https://api.github.com/users/naveen-kinnal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/naveen-kinnal/subscriptions", "organizations_url": "https://api.github.com/users/naveen-kinnal/orgs", "repos_url": "https://api.github.com/users/naveen-kinnal/repos", "events_url": "https://api.github.com/users/naveen-kinnal/events{/privacy}", "received_events_url": "https://api.github.com/users/naveen-kinnal/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-05-31T20:34:22Z", "updated_at": "2021-06-02T11:52:23Z", "closed_at": "2021-06-02T11:36:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nI am trying to run locust with the command `locust -f locustfile.py`. My locustfile looks as below\r\n```\r\n\r\n    from locust import HttpUser, TaskSet, task\r\n    import urllib.parse\r\n    from locust.env import Environment\r\n    import json\r\n    import urllib3\r\n    from locust.contrib.fasthttp import FastHttpUser\r\n    \r\n    global_header = None\r\n    class RecommenderTasks(TaskSet):\r\n        def __init__(self, parent):\r\n            super().__init__(parent)\r\n            self.global_header = None\r\n            self.cold_start_url = \"https://my-web-site\"\r\n    \r\n        def on_start(self):\r\n            urllib3.disable_warnings()\r\n            self.global_header = self.login()\r\n            \r\n        def login(self):\r\n            call_url = urllib.parse.urljoin(self.cold_start_url, \"/oauth/token\")\r\n            headers = {'Authorization': 'Basic (my-token)=='}\r\n            response = self.client.post(call_url, {'grant_type': 'client_credentials'}, headers=headers, verify=False)        \r\n            \r\n            access_token = json.loads(response.text.encode('utf8'))['access_token']\r\n            headers = {'Authorization': 'Bearer ' + access_token}\r\n            return headers\r\n        \r\n        @task\r\n        def test_recommender_multiple_platforms(self):\r\n            \r\n            params = {'rec_id': str(0)}\r\n            response = self.client.request(\"GET\", '/recommendations',\r\n                                    params=params,\r\n                                    headers=self.global_header,\r\n                                    verify=False)\r\n            print(response)\r\n    \r\n    class RecommenderUser(HttpUser):\r\n        tasks = [RecommenderTasks]\r\n        min_wait = 0\r\n        max_wait = 0\r\n    \r\n        host = \"https://my-web-site\"\r\n```\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nI should be able to start the locust service\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nI am getting the following error\r\n\r\n```\r\n[2021-05-31 20:25:34,146] d6ad3fb4f0cf/INFO/locust.main: Starting web interface at http://0.0.0.0:8089 (accepting connections from all network interfaces)\r\n[2021-05-31 20:25:34,156] d6ad3fb4f0cf/INFO/locust.main: Starting Locust 1.5.3\r\nTraceback (most recent call last):\r\n  File \"src/gevent/greenlet.py\", line 906, in gevent._gevent_cgreenlet.Greenlet.run\r\n  File \"/usr/local/lib/python3.8/site-packages/locust/web.py\", line 339, in start_server\r\n    self.server.serve_forever()\r\n  File \"/usr/local/lib/python3.8/site-packages/gevent/baseserver.py\", line 398, in serve_forever\r\n    self.start()\r\n  File \"/usr/local/lib/python3.8/site-packages/gevent/baseserver.py\", line 336, in start\r\n    self.init_socket()\r\n  File \"/usr/local/lib/python3.8/site-packages/gevent/pywsgi.py\", line 1545, in init_socket\r\n    StreamServer.init_socket(self)\r\n  File \"/usr/local/lib/python3.8/site-packages/gevent/server.py\", line 180, in init_socket\r\n    self.socket = self.get_listener(self.address, self.backlog, self.family)\r\n  File \"/usr/local/lib/python3.8/site-packages/gevent/server.py\", line 192, in get_listener\r\n    return _tcp_listener(address, backlog=backlog, reuse_addr=cls.reuse_addr, family=family)\r\n  File \"/usr/local/lib/python3.8/site-packages/gevent/server.py\", line 284, in _tcp_listener\r\n    sock = GeventSocket(family=family)\r\n  File \"/usr/local/lib/python3.8/site-packages/gevent/_socket3.py\", line 133, in __init__\r\n    self._sock = self._gevent_sock_class(family, type, proto, fileno)\r\nOSError: [Errno 97] Address family not supported by protocol\r\n2021-05-31T20:25:34Z <Greenlet at 0x7f11128f47b0: <bound method WebUI.start_server of <locust.web.WebUI object at 0x7f1112877e50>>> failed with OSError\r\n```\r\n\r\nMay I know what would be the cause of such an exception?\r\n\r\n### Environment\r\n\r\n- OS: Windows\r\n- Python version: 3.8\r\n- Locust version: latest\r\n- Locust command line that you ran: locust -f locustfile.py\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1770/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1770/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1766", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1766/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1766/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1766/events", "html_url": "https://github.com/locustio/locust/issues/1766", "id": 899782758, "node_id": "MDU6SXNzdWU4OTk3ODI3NTg=", "number": 1766, "title": "User Count Drops when Worker Abruptly Leaves The Test In Distributed Mode", "user": {"login": "SoonerLR", "id": 9464289, "node_id": "MDQ6VXNlcjk0NjQyODk=", "avatar_url": "https://avatars.githubusercontent.com/u/9464289?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SoonerLR", "html_url": "https://github.com/SoonerLR", "followers_url": "https://api.github.com/users/SoonerLR/followers", "following_url": "https://api.github.com/users/SoonerLR/following{/other_user}", "gists_url": "https://api.github.com/users/SoonerLR/gists{/gist_id}", "starred_url": "https://api.github.com/users/SoonerLR/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SoonerLR/subscriptions", "organizations_url": "https://api.github.com/users/SoonerLR/orgs", "repos_url": "https://api.github.com/users/SoonerLR/repos", "events_url": "https://api.github.com/users/SoonerLR/events{/privacy}", "received_events_url": "https://api.github.com/users/SoonerLR/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-05-24T15:48:10Z", "updated_at": "2021-07-31T12:45:48Z", "closed_at": "2021-07-31T12:45:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "### User Count Drops when Worker Abruptly Leaves The Test In Distributed Mode\r\nWhen running in distributed mode with workers running in Docker containers, and a worker leaves the test, total target user count should remain the same and redistribute the users among the remaining workers.\r\n\r\n### Expected behavior\r\nIf using Docker in an auto-scaled environment, based on factors such as CPU, workers can join the test and leave the test. When workers leave the test, because they were no longer needed to maintain test parameters, they also take their assigned users with them. For example, running a test with 4 worker nodes, with 40 users, when 1 worker drops (leaving 3), total remaining users will be 30 instead of 40. \r\n\r\nWhen a worker leaves, it should be the same as when a worker joins, e.g. distribute the total target users among current workers.\r\n\r\n### Environment\r\nusing locustio/locust:master as base to Docker image. \r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1766/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1766/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1762", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1762/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1762/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1762/events", "html_url": "https://github.com/locustio/locust/issues/1762", "id": 895154822, "node_id": "MDU6SXNzdWU4OTUxNTQ4MjI=", "number": 1762, "title": "status \"stopped\" instead of \"spawning\", tick() method of LoadShape called only once", "user": {"login": "stanislawskwark", "id": 46684704, "node_id": "MDQ6VXNlcjQ2Njg0NzA0", "avatar_url": "https://avatars.githubusercontent.com/u/46684704?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stanislawskwark", "html_url": "https://github.com/stanislawskwark", "followers_url": "https://api.github.com/users/stanislawskwark/followers", "following_url": "https://api.github.com/users/stanislawskwark/following{/other_user}", "gists_url": "https://api.github.com/users/stanislawskwark/gists{/gist_id}", "starred_url": "https://api.github.com/users/stanislawskwark/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stanislawskwark/subscriptions", "organizations_url": "https://api.github.com/users/stanislawskwark/orgs", "repos_url": "https://api.github.com/users/stanislawskwark/repos", "events_url": "https://api.github.com/users/stanislawskwark/events{/privacy}", "received_events_url": "https://api.github.com/users/stanislawskwark/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-05-19T08:34:33Z", "updated_at": "2021-05-28T07:06:54Z", "closed_at": "2021-05-28T07:06:54Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Describe the bug\r\nThis happens with high number of workers, for me it sometimes happens when I use ~80 workers, it does not happen each time though, I didn't find the root cause so far. It never happened for me when running standalone locust, with low number of workers it happened just once as far as I know. \r\nSometimes build starts with \"stopped\" status instead of \"spawning\". Number of users grows until it reaches expected value, then status changes to \"running\". The most problematic thing for me is that when it happens, locust stops calling tick() method of load shape, so shape doesn't really work and number of users get stuck on value returned in first call of tick() method.\r\n### Expected behavior\r\nStatus shown in GUI represents actual status and tick method is called every second until it returns None or the build is stopped manually\r\n\r\n### Actual behavior\r\nGUI hows status \"stopped\" instead of \"spawning\", tick() method of LoadShape called only once\r\n\r\n### Steps to reproduce\r\nset up master and around 80 workers (maybe it would happen more often with higher number of workers, I didn't have access to more machines to check it)\r\n### Environment\r\n\r\n- OS: centos 7\r\n- Python version: 3.8.2\r\n- Locust version: 1.4.3, 1.4.4, 1.5.2\r\n- Locust command line that you ran: locust --master --skip-log-setup --only-summary\r\n- Locust file contents (anonymized if necessary): this happens regardless of locust file, even with dummy locust file which doesn't do any requests, just task which creates random list", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1762/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1762/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1759", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1759/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1759/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1759/events", "html_url": "https://github.com/locustio/locust/issues/1759", "id": 889912992, "node_id": "MDU6SXNzdWU4ODk5MTI5OTI=", "number": 1759, "title": "Locust stopped working after Flast 2.0 got released", "user": {"login": "stanislawskwark", "id": 46684704, "node_id": "MDQ6VXNlcjQ2Njg0NzA0", "avatar_url": "https://avatars.githubusercontent.com/u/46684704?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stanislawskwark", "html_url": "https://github.com/stanislawskwark", "followers_url": "https://api.github.com/users/stanislawskwark/followers", "following_url": "https://api.github.com/users/stanislawskwark/following{/other_user}", "gists_url": "https://api.github.com/users/stanislawskwark/gists{/gist_id}", "starred_url": "https://api.github.com/users/stanislawskwark/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stanislawskwark/subscriptions", "organizations_url": "https://api.github.com/users/stanislawskwark/orgs", "repos_url": "https://api.github.com/users/stanislawskwark/repos", "events_url": "https://api.github.com/users/stanislawskwark/events{/privacy}", "received_events_url": "https://api.github.com/users/stanislawskwark/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-05-12T10:05:47Z", "updated_at": "2021-05-12T10:33:19Z", "closed_at": "2021-05-12T10:33:19Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "in setup.py I can see:\r\n` \"flask>=1.1.2\", `\r\nI guess it should be hardcoded to ==1.1.2 for now.\r\n\r\nit crashes with:\r\n```\r\nFile \"/root/.local/share/virtualenvs/xxxxxxx/lib/python3.6/site-packages/locust/web.py\", line 102, in __init__\r\napp.jinja_options[\"extensions\"].append(\"jinja2.ext.do\")\r\nKeyError: 'extensions'\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1759/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1759/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1757", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1757/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1757/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1757/events", "html_url": "https://github.com/locustio/locust/issues/1757", "id": 876595239, "node_id": "MDU6SXNzdWU4NzY1OTUyMzk=", "number": 1757, "title": "TypeError: 'EventHook' object is not callable", "user": {"login": "renanbastos93", "id": 8202898, "node_id": "MDQ6VXNlcjgyMDI4OTg=", "avatar_url": "https://avatars.githubusercontent.com/u/8202898?v=4", "gravatar_id": "", "url": "https://api.github.com/users/renanbastos93", "html_url": "https://github.com/renanbastos93", "followers_url": "https://api.github.com/users/renanbastos93/followers", "following_url": "https://api.github.com/users/renanbastos93/following{/other_user}", "gists_url": "https://api.github.com/users/renanbastos93/gists{/gist_id}", "starred_url": "https://api.github.com/users/renanbastos93/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/renanbastos93/subscriptions", "organizations_url": "https://api.github.com/users/renanbastos93/orgs", "repos_url": "https://api.github.com/users/renanbastos93/repos", "events_url": "https://api.github.com/users/renanbastos93/events{/privacy}", "received_events_url": "https://api.github.com/users/renanbastos93/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-05-05T15:48:04Z", "updated_at": "2021-05-06T22:57:46Z", "closed_at": "2021-05-06T05:59:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: MacOS Catalina\r\n- Python version: 3\r\n- Locust version: 1.5.1\r\n- Locust command line that you ran: locust -f file.py\r\n- Locust file contents (anonymized if necessary): test to grpc", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1757/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1757/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1753", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1753/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1753/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1753/events", "html_url": "https://github.com/locustio/locust/issues/1753", "id": 875367655, "node_id": "MDU6SXNzdWU4NzUzNjc2NTU=", "number": 1753, "title": "New request event \"start_time\" param is not described in docs", "user": {"login": "ludeknovy", "id": 13610612, "node_id": "MDQ6VXNlcjEzNjEwNjEy", "avatar_url": "https://avatars.githubusercontent.com/u/13610612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ludeknovy", "html_url": "https://github.com/ludeknovy", "followers_url": "https://api.github.com/users/ludeknovy/followers", "following_url": "https://api.github.com/users/ludeknovy/following{/other_user}", "gists_url": "https://api.github.com/users/ludeknovy/gists{/gist_id}", "starred_url": "https://api.github.com/users/ludeknovy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ludeknovy/subscriptions", "organizations_url": "https://api.github.com/users/ludeknovy/orgs", "repos_url": "https://api.github.com/users/ludeknovy/repos", "events_url": "https://api.github.com/users/ludeknovy/events{/privacy}", "received_events_url": "https://api.github.com/users/ludeknovy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-05-04T11:28:16Z", "updated_at": "2021-05-12T10:35:58Z", "closed_at": "2021-05-04T12:31:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nWhen I try to use the new \"request\" event it throws an ` got an unexpected keyword argument 'start_time'`\r\n\r\n### Expected behavior\r\nThe `start_time` is either removed or described in docs? Not sure how it was intended.\r\n\r\n### Actual behavior\r\nThrows an error: `TypeError: _request() got an unexpected keyword argument 'start_time'`\r\n\r\n\r\n### Steps to reproduce\r\n1. Have a test with `HttpUser` class.\r\n2. Add a listener to the test\r\n```\r\n        events = self.env.events\r\n        events.request.add_listener(self._request)\r\n```\r\nwith `_request` implementation like this\r\n```\r\n    def _request(self, request_type, name, response_time, response_length, response, context, exception):\r\n       ...\r\n       ...\r\n```\r\n\r\nThe `_request` method, contains all the parameters described here: https://docs.locust.io/en/stable/api.html#locust.event.Events.request\r\n\r\n\r\nI guess the `start_time` is coming from here ?https://github.com/locustio/locust/blob/1d63adb03fe417fbd69aba009263862752f3ba57/locust/clients.py#L117\r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version: 3.7\r\n- Locust version: 1.5.0\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1753/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1753/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1747", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1747/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1747/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1747/events", "html_url": "https://github.com/locustio/locust/issues/1747", "id": 857447975, "node_id": "MDU6SXNzdWU4NTc0NDc5NzU=", "number": 1747, "title": "Adding TLS cert causes Errors in debug log, using container image", "user": {"login": "brwilkinson", "id": 3605266, "node_id": "MDQ6VXNlcjM2MDUyNjY=", "avatar_url": "https://avatars.githubusercontent.com/u/3605266?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brwilkinson", "html_url": "https://github.com/brwilkinson", "followers_url": "https://api.github.com/users/brwilkinson/followers", "following_url": "https://api.github.com/users/brwilkinson/following{/other_user}", "gists_url": "https://api.github.com/users/brwilkinson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brwilkinson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brwilkinson/subscriptions", "organizations_url": "https://api.github.com/users/brwilkinson/orgs", "repos_url": "https://api.github.com/users/brwilkinson/repos", "events_url": "https://api.github.com/users/brwilkinson/events{/privacy}", "received_events_url": "https://api.github.com/users/brwilkinson/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901882, "node_id": "MDU6TGFiZWwxNjM1OTAxODgy", "url": "https://api.github.com/repos/locustio/locust/labels/wontfix", "name": "wontfix", "color": "ddcccc", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-04-14T01:53:49Z", "updated_at": "2021-05-04T09:05:14Z", "closed_at": "2021-04-21T17:58:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nI added a TLS cert and that seems to be working correctly.\r\n\r\n### Expected behavior\r\n\r\nHowever I am seeing the following errors logged on the console\r\n\r\n### Actual behavior\r\n\r\n```log\r\nTraceback (most recent call last):\r\n  File \"src/gevent/greenlet.py\", line 906, in gevent._gevent_cgreenlet.Greenlet.run\r\n  File \"/usr/local/lib/python3.8/site-packages/gevent/baseserver.py\", line 34, in _handle_and_close_when_done\r\n    return handle(*args_tuple)\r\n  File \"/usr/local/lib/python3.8/site-packages/gevent/server.py\", line 233, in wrap_socket_and_handle\r\n    with _closing_socket(self.wrap_socket(client_socket, **self.ssl_args)) as ssl_socket:\r\n  File \"/usr/local/lib/python3.8/site-packages/gevent/_ssl3.py\", line 797, in wrap_socket\r\n    return SSLSocket(sock=sock, keyfile=keyfile, certfile=certfile,\r\n  File \"/usr/local/lib/python3.8/site-packages/gevent/_ssl3.py\", line 312, in __init__\r\n    raise x\r\n  File \"/usr/local/lib/python3.8/site-packages/gevent/_ssl3.py\", line 308, in __init__\r\n    self.do_handshake()\r\n  File \"/usr/local/lib/python3.8/site-packages/gevent/_ssl3.py\", line 667, in do_handshake\r\n    self._sslobj.do_handshake()\r\nssl.SSLEOFError: EOF occurred in violation of protocol (_ssl.c:1125)\r\n2021-04-14T01:20:52Z <Greenlet at 0x7f7e54abfe10: _handle_and_close_when_done(<bound method StreamServer.wrap_socket_and_handle , <bound method StreamServer.do_close of <WSGIServer, (<gevent._socket3.socket [closed] at 0x7f7e547790a)> failed with SSLEOFError\r\n```\r\n\r\n### Steps to reproduce\r\n\r\nI configured the following ENV vars\r\n\r\n```json\r\n              {\r\n                \"Name\": \"LOCUST_TLS_KEY\",\r\n                \"value\": \"/home/locust/locust/mycert-wildcard.key\"\r\n              },\r\n              {\r\n                \"Name\": \"LOCUST_TLS_CERT\",\r\n                \"value\": \"/home/locust/locust/mycert-wildcard.crt\"\r\n              }\r\n```\r\n\r\n### Environment\r\n\r\nI generated the certs with:   OpenSSL 1.1.1d  10 Sep 2019 \r\n\r\n- OS:\r\n\"image\": \"locustio/locust:1.4.4\"", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1747/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1747/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1745", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1745/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1745/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1745/events", "html_url": "https://github.com/locustio/locust/issues/1745", "id": 853491400, "node_id": "MDU6SXNzdWU4NTM0OTE0MDA=", "number": 1745, "title": "How to perform web-auth in locust?", "user": {"login": "harit-h", "id": 64791581, "node_id": "MDQ6VXNlcjY0NzkxNTgx", "avatar_url": "https://avatars.githubusercontent.com/u/64791581?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harit-h", "html_url": "https://github.com/harit-h", "followers_url": "https://api.github.com/users/harit-h/followers", "following_url": "https://api.github.com/users/harit-h/following{/other_user}", "gists_url": "https://api.github.com/users/harit-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/harit-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harit-h/subscriptions", "organizations_url": "https://api.github.com/users/harit-h/orgs", "repos_url": "https://api.github.com/users/harit-h/repos", "events_url": "https://api.github.com/users/harit-h/events{/privacy}", "received_events_url": "https://api.github.com/users/harit-h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-04-08T13:45:35Z", "updated_at": "2021-04-08T15:15:24Z", "closed_at": "2021-04-08T14:43:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello here,\r\n\r\nI also asked this question on [stackoverflow](https://stackoverflow.com/questions/66992524/how-to-perform-web-auth-in-locust), but seem to have no response. I am not sure if the community is active there, so I am re-posting this here.\r\n\r\n---\r\n\r\nI am looking at the [Locust Documentation](https://docs.locust.io/en/stable/configuration.html) and one of the flag in configuration is\r\n```\r\n --web-auth WEB_AUTH   Turn on Basic Auth for the web interface. Should be\r\n                        supplied in the following format: username:password\r\n```\r\nI looked into it's github repo to find out how to use this feature, and the relevant section in [locust/main.py](https://github.com/locustio/locust/blob/78381c9410eb711837a55b909919aa9946553aab/locust/main.py#L286-L294) has the following code\r\n\r\n```python\r\nweb_ui = environment.create_web_ui(\r\n                host=web_host,\r\n                port=options.web_port,\r\n                auth_credentials=options.web_auth,\r\n                tls_cert=options.tls_cert,\r\n                tls_key=options.tls_key,\r\n                stats_csv_writer=stats_csv_writer,\r\n                delayed_start=True,\r\n            )\r\n```\r\n\r\nI also looked at the [pull request](https://github.com/locustio/locust/pull/1313) that enabled this flag. In the [tests](https://github.com/locustio/locust/pull/1313/files#diff-c3c09c105a3c62bbf2d88cca4162b8a6c8c2b19880e5f8a67e03a06251e50287R258-R285), I see that hardcoded user id/password is passed in.\r\n\r\nThis has not given me a good idea on how to use web authentication in locust because I expected a handler function for web authentication which receives user/password combination that returns `true/false` or `roles` for the combination, but I did not see any such thing.\r\n\r\nAm I missing anything here?", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1745/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1745/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1742", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1742/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1742/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1742/events", "html_url": "https://github.com/locustio/locust/issues/1742", "id": 845338917, "node_id": "MDU6SXNzdWU4NDUzMzg5MTc=", "number": 1742, "title": "'locust' is not recognized as an internal or external command, operable program or batch file.", "user": {"login": "Muhammadehsan2019", "id": 57292707, "node_id": "MDQ6VXNlcjU3MjkyNzA3", "avatar_url": "https://avatars.githubusercontent.com/u/57292707?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Muhammadehsan2019", "html_url": "https://github.com/Muhammadehsan2019", "followers_url": "https://api.github.com/users/Muhammadehsan2019/followers", "following_url": "https://api.github.com/users/Muhammadehsan2019/following{/other_user}", "gists_url": "https://api.github.com/users/Muhammadehsan2019/gists{/gist_id}", "starred_url": "https://api.github.com/users/Muhammadehsan2019/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Muhammadehsan2019/subscriptions", "organizations_url": "https://api.github.com/users/Muhammadehsan2019/orgs", "repos_url": "https://api.github.com/users/Muhammadehsan2019/repos", "events_url": "https://api.github.com/users/Muhammadehsan2019/events{/privacy}", "received_events_url": "https://api.github.com/users/Muhammadehsan2019/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-03-30T21:56:45Z", "updated_at": "2021-04-01T07:22:28Z", "closed_at": "2021-04-01T07:22:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "Locust was successfully installed and was running smoothly, but opening after two weeks to perform some performance testing, it now throws the following error. I tried my best to fix it but couldn't as there weren't many resources.  I have re-installed locust through Python Interpreter but still doesn't work.\r\n'locust' is not recognized as an internal or external command, operable program, or batch file.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1742/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1742/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1741", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1741/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1741/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1741/events", "html_url": "https://github.com/locustio/locust/issues/1741", "id": 840698306, "node_id": "MDU6SXNzdWU4NDA2OTgzMDY=", "number": 1741, "title": "Kernel panic on M1 MBA at 3000 users", "user": {"login": "lundstrj", "id": 1045735, "node_id": "MDQ6VXNlcjEwNDU3MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/1045735?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lundstrj", "html_url": "https://github.com/lundstrj", "followers_url": "https://api.github.com/users/lundstrj/followers", "following_url": "https://api.github.com/users/lundstrj/following{/other_user}", "gists_url": "https://api.github.com/users/lundstrj/gists{/gist_id}", "starred_url": "https://api.github.com/users/lundstrj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lundstrj/subscriptions", "organizations_url": "https://api.github.com/users/lundstrj/orgs", "repos_url": "https://api.github.com/users/lundstrj/repos", "events_url": "https://api.github.com/users/lundstrj/events{/privacy}", "received_events_url": "https://api.github.com/users/lundstrj/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-03-25T08:42:19Z", "updated_at": "2021-03-25T12:10:59Z", "closed_at": "2021-03-25T11:47:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nKernel panic on M1 Macbook Air around the 2500 spawned users mark and maybe 300 requests per second.\r\nI ran the scenario multiple times, having terminated all other non system applications before running locust.\r\n\r\n### Expected behavior\r\nI would expect the test driving system to maybe slow down as it bottlenecks on something but not to panic and reboot itself.\r\n\r\n### Actual behavior\r\nWhen running a very basic locust swarm (one static HTTP request in locustfile.py)\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n`pip install locust`\r\n`locust`\r\n\r\n- Fire up a browser aimed at [http://0.0.0.0:8089/](http://0.0.0.0:8089/)\r\n- Enter the following data:\r\n- 3000\r\n- 50\r\n- https://super.secret.api\r\n\r\n### Environment\r\n\r\n- OS: macOS Big Sur 11.2.3 (20D91)\r\n- Python version: 3.9.2\r\n- Locust version: 1.4.3\r\n- Locust command line that you ran: locust\r\n- Locust file contents (anonymized if necessary):\r\n\r\n```\r\nimport time\r\nimport random\r\nfrom locust import HttpUser, task, between\r\n\r\nclass QuickstartUser(HttpUser):\r\n    wait_time = between(0, 1)\r\n    auth_headers = \"nope\"\r\n\r\n    @task\r\n    def kernel_panic_causing_code(self):\r\n        response = self.client.get(\"/api/some/static-call\", headers=self.auth_headers)\r\n\r\n    def on_start(self):\r\n        print(\"start\")\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1741/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1741/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1733", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1733/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1733/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1733/events", "html_url": "https://github.com/locustio/locust/issues/1733", "id": 834086153, "node_id": "MDU6SXNzdWU4MzQwODYxNTM=", "number": 1733, "title": "Locust greenlets not terminating - using locust as a library", "user": {"login": "bhavanib", "id": 12427347, "node_id": "MDQ6VXNlcjEyNDI3MzQ3", "avatar_url": "https://avatars.githubusercontent.com/u/12427347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bhavanib", "html_url": "https://github.com/bhavanib", "followers_url": "https://api.github.com/users/bhavanib/followers", "following_url": "https://api.github.com/users/bhavanib/following{/other_user}", "gists_url": "https://api.github.com/users/bhavanib/gists{/gist_id}", "starred_url": "https://api.github.com/users/bhavanib/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bhavanib/subscriptions", "organizations_url": "https://api.github.com/users/bhavanib/orgs", "repos_url": "https://api.github.com/users/bhavanib/repos", "events_url": "https://api.github.com/users/bhavanib/events{/privacy}", "received_events_url": "https://api.github.com/users/bhavanib/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-03-17T18:57:15Z", "updated_at": "2021-05-27T02:14:41Z", "closed_at": "2021-05-27T02:14:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have a use case where I need to produce specific number of messages to Kafka using locust as a library ( reference - <https://docs.locust.io/en/stable/use-as-lib.html> ). Since locust does not stop after specific number of requests, I am using a counter to cap the number of requests, and quitting the runners once the requests have been handled. Here is the snippet:\r\n\r\n```\r\ndef handle_request(self):\r\n    if self.current_count == self.total_count:\r\n        raise StopUser\r\n    else:\r\n        # handle request\r\n        self.current_count += 1\r\n\r\ndef on_stop(self):\r\n    self.environment.runner.quit()\r\n```\r\n\r\nLocust version used: 1.4.3\r\n\r\n**Issue:**\r\nEven though the user has been stopped and killed, the greenlets spawned in locust continue to run, and the stats-printer continues to print to the console.\r\n- Is there a way I could make locust could stop after specific number of requests?\r\n- Is there a way I could quit the runners from within the locustfile and let the library handler know that the greenlets can now join with greenlet.join()?", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1733/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1733/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1732", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1732/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1732/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1732/events", "html_url": "https://github.com/locustio/locust/issues/1732", "id": 833576734, "node_id": "MDU6SXNzdWU4MzM1NzY3MzQ=", "number": 1732, "title": "Can't run post request with JSON body for authentication issue even after login success", "user": {"login": "chunspring", "id": 13565665, "node_id": "MDQ6VXNlcjEzNTY1NjY1", "avatar_url": "https://avatars.githubusercontent.com/u/13565665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chunspring", "html_url": "https://github.com/chunspring", "followers_url": "https://api.github.com/users/chunspring/followers", "following_url": "https://api.github.com/users/chunspring/following{/other_user}", "gists_url": "https://api.github.com/users/chunspring/gists{/gist_id}", "starred_url": "https://api.github.com/users/chunspring/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chunspring/subscriptions", "organizations_url": "https://api.github.com/users/chunspring/orgs", "repos_url": "https://api.github.com/users/chunspring/repos", "events_url": "https://api.github.com/users/chunspring/events{/privacy}", "received_events_url": "https://api.github.com/users/chunspring/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-03-17T09:33:02Z", "updated_at": "2021-03-17T21:26:14Z", "closed_at": "2021-03-17T21:26:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "My script is like below: After login,   self.client.get(\"/xx/iit/bgc\", verify=False) can work well.\r\n     But   self.client.request(method=\"POST\", url= \"/ata/catas/api\", json={\"name\":\"CaNew\",\"description\":\"DEST\"}) always fail for \"HTTPError:  511 network authentication is required\".\r\n\r\nAfter login, how to pass the authentication for the later request if needed?\r\n\r\nfrom locust import HttpUser, TaskSet, task, between\r\nimport urllib3\r\nurllib3.disable_warnings()\r\nimport logging\r\n\r\nclass UserBehaviour(TaskSet):\r\n    def on_start(self):\r\n        response = self.client.request(method=\"GET\", verify=False, url = \"/auth/login/sso?logged_out=true\", auth=(\"user\", \"password1\"))\r\n      \r\n            \r\n    @task\r\n    def some_task(self):\r\n        self.client.get(\"/xx/iit/bgc\", verify=False)\r\n        self.client.request(method=\"POST\", url= \"/ta/catas/api\", json={\"name\":\"CaNew\",\"description\":\"DEST\"})\r\n      \r\n        \r\nclass User(HttpUser):\r\n    tasks = [UserBehaviour]\r\n    wait_time = between(5, 60)\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1732/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1732/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1731", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1731/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1731/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1731/events", "html_url": "https://github.com/locustio/locust/issues/1731", "id": 832478786, "node_id": "MDU6SXNzdWU4MzI0Nzg3ODY=", "number": 1731, "title": "When I run Locust in the scene, it does not execute in the order I specified.", "user": {"login": "moshangxiaole", "id": 26242818, "node_id": "MDQ6VXNlcjI2MjQyODE4", "avatar_url": "https://avatars.githubusercontent.com/u/26242818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/moshangxiaole", "html_url": "https://github.com/moshangxiaole", "followers_url": "https://api.github.com/users/moshangxiaole/followers", "following_url": "https://api.github.com/users/moshangxiaole/following{/other_user}", "gists_url": "https://api.github.com/users/moshangxiaole/gists{/gist_id}", "starred_url": "https://api.github.com/users/moshangxiaole/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/moshangxiaole/subscriptions", "organizations_url": "https://api.github.com/users/moshangxiaole/orgs", "repos_url": "https://api.github.com/users/moshangxiaole/repos", "events_url": "https://api.github.com/users/moshangxiaole/events{/privacy}", "received_events_url": "https://api.github.com/users/moshangxiaole/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-03-16T06:56:23Z", "updated_at": "2021-05-26T02:11:18Z", "closed_at": "2021-05-26T02:11:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nWhen I run Locust in the scene, it does not execute in the order I specified.\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nFirst ,it shuld run test_set ,Second run test_shop,and loop until end\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nthis error: \r\nnow,I'm No.1===========\r\n\r\nnow,I'm No.1===========\r\n\r\nnow,I'm No.1===========\r\n\r\nnow,I'm No.1===========\r\n\r\n Name                                                          # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n POST /businesses-gateway/merchant/1.0/acc/_login                   4     0(0.00%)  |     230     156     375     190  |    0.00    0.00\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                         4     0(0.00%)  |     230     156     375     190  |    0.00    0.00\r\n\r\nnow,I'm No.1===========\r\n\r\nI'm No.2===========22222222\r\nnow,I'm No.1===========\r\n\r\nI'm No.2===========22222222\r\nnow,I'm No.1===========\r\n\r\nI'm No.2===========22222222\r\n\r\nI'm No.2===========22222222\r\n\r\nnow,I'm No.1===========\r\nI'm No.2===========22222222\r\n\r\n\r\n Name                                                          # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n POST /businesses-gateway/customer/1.0/myCoupon/list                5     0(0.00%)  |     121      93     172      94  |    0.00    0.00\r\n POST /businesses-gateway/merchant/1.0/acc/_login                   8     0(0.00%)  |     193     140     375     160  |    1.50    0.00\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                        13     0(0.00%)  |     165      93     375     160  |    1.50    0.00\r\n\r\nnow,I'm No.1===========\r\n\r\n[2021-03-16 14:31:22,391] PL-PC/INFO/locust.runners: All users spawned: HydeeMiddleUser: 10 (10 total running)\r\nnow,I'm No.1===========\r\nnow,I'm No.1===========\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS:Windows 10\r\n- Python version:3.6\r\n- Locust version:1.4.3\r\n- Locust command line that you ran:locust -f locusttest.py --headless -u 10 -r 2 -t 5s --html testHtml.html\r\n- Locust file contents (anonymized if necessary):\r\nThis is my code:\r\n\r\n# -*- coding:utf-8 -*-\r\nfrom locust import HttpUser,SequentialTaskSet,task,between\r\nimport requests,os,json\r\nfrom requests.packages.urllib3.exceptions import InsecureRequestWarning\r\n# \u7981\u7528\u5b89\u5168\u8bf7\u6c42\u8b66\u544a\r\nrequests.packages.urllib3.disable_warnings(InsecureRequestWarning)\r\n\r\n\r\nclass HydeeMiddleUser(HttpUser):\r\n\twait_time = between(1, 3)\r\n\thost = \"https://example.test.cn\"\r\n\r\n\t@task\r\n\tclass SequenceOfTasks(SequentialTaskSet):\r\n\r\n\t\t@task\r\n\t\tdef test_set(self):\r\n\t\t\tprint(\"now,I'm No.1===========\")\r\n\t\t\theaders = {\"A\":\"auage\",\"B\":\"example\"}\r\n\t\t\tdata = {\"account\": \"admin\",\"pwd\": \"123456\"}\r\n\t\t\ttest = self.client.post(\"/_login\",json=data,headers=headers)\r\n\t\t\tprint(test.text)\r\n\r\n\t\t@task\r\n\t\tdef test_shop(self):\r\n\t\t\thost = \"https://example.uat.cn\"\r\n\t\t\tprint(\"I'm No.2===========22222222\")\r\n\t\t\theaders = {\"A\":\"Example\"}\r\n\t\t\tdata = {\"merCode\": \"778899\",\"state\": 0,\"currentPage\": 1,\"pageSize\": 10000}\r\n\t\t\ttest = self.client.post(\"/myCoupon/list\",json=data,headers=headers)\r\n\t\t\tprint(test.text)\r\n\r\n\r\n\r\nif __name__ == '__main__':\r\n\tos.system(\"locust -f locusttest.py --headless -u 10 -r 2 -t 5s --html testHtml.html\")", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1731/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1731/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1730", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1730/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1730/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1730/events", "html_url": "https://github.com/locustio/locust/issues/1730", "id": 832221505, "node_id": "MDU6SXNzdWU4MzIyMjE1MDU=", "number": 1730, "title": "events.init.add_listener runs after Users are created on worker", "user": {"login": "jbarz1", "id": 64875874, "node_id": "MDQ6VXNlcjY0ODc1ODc0", "avatar_url": "https://avatars.githubusercontent.com/u/64875874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jbarz1", "html_url": "https://github.com/jbarz1", "followers_url": "https://api.github.com/users/jbarz1/followers", "following_url": "https://api.github.com/users/jbarz1/following{/other_user}", "gists_url": "https://api.github.com/users/jbarz1/gists{/gist_id}", "starred_url": "https://api.github.com/users/jbarz1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jbarz1/subscriptions", "organizations_url": "https://api.github.com/users/jbarz1/orgs", "repos_url": "https://api.github.com/users/jbarz1/repos", "events_url": "https://api.github.com/users/jbarz1/events{/privacy}", "received_events_url": "https://api.github.com/users/jbarz1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2021-03-15T21:51:13Z", "updated_at": "2023-01-18T21:03:28Z", "closed_at": "2021-10-05T01:50:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nIt appears that ```locust.User``` tasks are executed before all  ```events.init.add_listener``` listeners are executed on the worker.\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n```locust.User``` tasks should execute only after all ```events.init.add_listener``` listeners have run.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nIt appears that ```locust.User``` tasks are executed before all  ```events.init.add_listener``` listeners are done.\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) -->\r\n```\r\n# start worker\r\npython3 -m locust -f test_locustfile.py --headless --worker --master-host=<ip>\r\n# start master\r\npython3 -m locust -f test_locustfile.py --headless --master --expect-workers=1\r\n```\r\n \r\n```python\r\n@events.init.add_listener\r\ndef on_locust_init(environment, **_kwargs):\r\n    time.sleep(2)\r\n    log.info('Ran init')\r\n\r\nclass CustomUser(User):\r\n    @task\r\n    def test(self):\r\n        log.info('Running test')\r\n```\r\n\r\n### Output from worker\r\n```\r\nSpawning 1 users at the rate 1 users/s (0 users already running)...\r\nAll users spawned: CustomUser: 1 (1 total running)\r\nRunning test\r\nRunning test\r\n...\r\nRunning test\r\nRan init\r\nStarting Locust 1.4.3\r\nRunning test\r\n...\r\n```\r\n\r\n### Environment\r\n\r\n- OS:Linux\r\n- Python version: 3.7\r\n- Locust version: 1.4.3\r\n- Locust command line that you ran: given above\r\n- Locust file contents (anonymized if necessary): given above", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1730/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1730/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1729", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1729/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1729/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1729/events", "html_url": "https://github.com/locustio/locust/issues/1729", "id": 829833220, "node_id": "MDU6SXNzdWU4Mjk4MzMyMjA=", "number": 1729, "title": "Can't trace the test data of locust?", "user": {"login": "HN-PRO", "id": 30229591, "node_id": "MDQ6VXNlcjMwMjI5NTkx", "avatar_url": "https://avatars.githubusercontent.com/u/30229591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HN-PRO", "html_url": "https://github.com/HN-PRO", "followers_url": "https://api.github.com/users/HN-PRO/followers", "following_url": "https://api.github.com/users/HN-PRO/following{/other_user}", "gists_url": "https://api.github.com/users/HN-PRO/gists{/gist_id}", "starred_url": "https://api.github.com/users/HN-PRO/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HN-PRO/subscriptions", "organizations_url": "https://api.github.com/users/HN-PRO/orgs", "repos_url": "https://api.github.com/users/HN-PRO/repos", "events_url": "https://api.github.com/users/HN-PRO/events{/privacy}", "received_events_url": "https://api.github.com/users/HN-PRO/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-03-12T07:21:48Z", "updated_at": "2021-03-12T08:52:48Z", "closed_at": "2021-03-12T08:52:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "Since my tracking code is a JS file, is it impossible to count using locust? I can't count the data after I use it", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1729/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1729/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1726", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1726/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1726/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1726/events", "html_url": "https://github.com/locustio/locust/issues/1726", "id": 827597734, "node_id": "MDU6SXNzdWU4Mjc1OTc3MzQ=", "number": 1726, "title": "self.quit() fails test doesn't stop", "user": {"login": "Paszymaja", "id": 36695377, "node_id": "MDQ6VXNlcjM2Njk1Mzc3", "avatar_url": "https://avatars.githubusercontent.com/u/36695377?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Paszymaja", "html_url": "https://github.com/Paszymaja", "followers_url": "https://api.github.com/users/Paszymaja/followers", "following_url": "https://api.github.com/users/Paszymaja/following{/other_user}", "gists_url": "https://api.github.com/users/Paszymaja/gists{/gist_id}", "starred_url": "https://api.github.com/users/Paszymaja/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Paszymaja/subscriptions", "organizations_url": "https://api.github.com/users/Paszymaja/orgs", "repos_url": "https://api.github.com/users/Paszymaja/repos", "events_url": "https://api.github.com/users/Paszymaja/events{/privacy}", "received_events_url": "https://api.github.com/users/Paszymaja/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-03-10T11:40:47Z", "updated_at": "2021-03-15T14:14:54Z", "closed_at": "2021-03-15T13:12:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nWhen running Locust sometimes the `self.quit() ` fails and the test doesn't stop. This is a problem for us because we are running it inside the Argo workflow so this step never ends.\r\n\r\nFull Traceback:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"src/gevent/greenlet.py\", line 906, in gevent._gevent_cgreenlet.Greenlet.run\r\n  File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 334, in shape_worker\r\n    self.quit()\r\n  File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 362, in quit\r\n    self.stop()\r\n  File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 413, in stop\r\n    super().stop()\r\n  File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 354, in stop\r\n    self.stop_users(self.user_count)\r\n  File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 223, in stop_users\r\n    user = g.args[0]\r\nIndexError: tuple index out of range\r\n<REDACTED_DATE> <Greenlet at 0x7f88ca99fae0: <bound method Runner.shape_worker of <locust.runners.LocalRunner object at 0x7f88cabaffd0>>> failed with IndexError\r\n```\r\n\r\n### Expected behavior\r\n\r\nLocust should exit and maybe return an error.\r\n\r\n### Actual behavior\r\n\r\nAfter the error locust is still working and sending requests. Pipeline with test never ends.\r\n\r\n### Steps to reproduce\r\n\r\nI wasn't able to reproduce it 100% of the time. I would love to get some general direction if this is a known problem with our Locust file, Locust or maybe something else. Any help would be great. Our Locust file deployed inside Docker:\r\n\r\n```python\r\nimport math\r\nfrom locust import HttpUser, TaskSet, task, between\r\nfrom locust import LoadTestShape\r\nimport os\r\n\r\n\r\nclass UserBehavior(TaskSet):\r\n    @task\r\n    def pollute_memory(self):\r\n        abc = self.client.get(\"/cars\")\r\n\r\nclass WebsiteUser(HttpUser):\r\n    tasks = [UserBehavior]\r\n    wait_time = between(1, 3)\r\n\r\nclass SinusWave(LoadTestShape):\r\n    ramp_up_time = os.getenv('RAMP_UP_TIME')\r\n    ramp_up_slope = os.getenv('RAMP_UP_SLOPE')\r\n    amplitude = os.getenv('STABLE_AMPLITUDE')\r\n    frequency = os.getenv('STABLE_FREQUENCY')\r\n    offset = os.getenv(\"STABLE_OFFSET\")\r\n    time_limit = os.getenv('STABLE_MAX_TIME_LIMIT_IN_S')\r\n    ramp_up_value = 0\r\n\r\n    def tick(self):\r\n        run_time = round(self.get_run_time())\r\n        if run_time < int(self.time_limit):\r\n\r\n            if run_time < int(self.ramp_up_time):\r\n                self.ramp_up_value = float(self.ramp_up_slope) * run_time\r\n                return (round(self.ramp_up_value), 1)\r\n            else:\r\n                user_count = float(self.amplitude) * math.sin((float(self.frequency) * run_time) + float(self.offset)) + float(self.ramp_up_value)\r\n                if user_count <= 0:\r\n                    user_count = float(self.ramp_up_value) # Minimal value of sinus\r\n                return (round(user_count), 20) #(user_count, spawn_rate - number of users to start per second)\r\n        else:\r\n            return None\r\n```\r\n\r\n\r\n### Environment\r\n\r\n- OS: Kubernetes/Docker\r\n- Python version: 3.8\r\n- Locust version: 1.4.3\r\n- Locust command line that you ran: `locust --host=\"http://${HOSTNAME}\" --headless`", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1726/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1726/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1725", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1725/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1725/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1725/events", "html_url": "https://github.com/locustio/locust/issues/1725", "id": 826441513, "node_id": "MDU6SXNzdWU4MjY0NDE1MTM=", "number": 1725, "title": "Wasn't able to test COBRA IIOP protocol ", "user": {"login": "Muhammadehsan2019", "id": 57292707, "node_id": "MDQ6VXNlcjU3MjkyNzA3", "avatar_url": "https://avatars.githubusercontent.com/u/57292707?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Muhammadehsan2019", "html_url": "https://github.com/Muhammadehsan2019", "followers_url": "https://api.github.com/users/Muhammadehsan2019/followers", "following_url": "https://api.github.com/users/Muhammadehsan2019/following{/other_user}", "gists_url": "https://api.github.com/users/Muhammadehsan2019/gists{/gist_id}", "starred_url": "https://api.github.com/users/Muhammadehsan2019/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Muhammadehsan2019/subscriptions", "organizations_url": "https://api.github.com/users/Muhammadehsan2019/orgs", "repos_url": "https://api.github.com/users/Muhammadehsan2019/repos", "events_url": "https://api.github.com/users/Muhammadehsan2019/events{/privacy}", "received_events_url": "https://api.github.com/users/Muhammadehsan2019/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-03-09T18:38:40Z", "updated_at": "2021-03-09T21:38:31Z", "closed_at": "2021-03-09T21:38:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "The phrase \u201calmost any system or protocol\u201d in the Locust Features/\u2022 Can test any system, leaves me with uncertainty and doesn\u2019t define what that really means. \r\nAs a developer, I am able to test HTTP/HTTPS with HTML, XML, and JSON payloads.\r\nbut I am not able to test a system that uses the CORBA IIOP protocol, which is almost unknown in 2021. Does Locust handle testing COBRA IIOP protocol?", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1725/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1725/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1723", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1723/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1723/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1723/events", "html_url": "https://github.com/locustio/locust/issues/1723", "id": 822355863, "node_id": "MDU6SXNzdWU4MjIzNTU4NjM=", "number": 1723, "title": "constant_pacing doesn't work as expected with nested TaskSets", "user": {"login": "nathan-beam", "id": 24681333, "node_id": "MDQ6VXNlcjI0NjgxMzMz", "avatar_url": "https://avatars.githubusercontent.com/u/24681333?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nathan-beam", "html_url": "https://github.com/nathan-beam", "followers_url": "https://api.github.com/users/nathan-beam/followers", "following_url": "https://api.github.com/users/nathan-beam/following{/other_user}", "gists_url": "https://api.github.com/users/nathan-beam/gists{/gist_id}", "starred_url": "https://api.github.com/users/nathan-beam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nathan-beam/subscriptions", "organizations_url": "https://api.github.com/users/nathan-beam/orgs", "repos_url": "https://api.github.com/users/nathan-beam/repos", "events_url": "https://api.github.com/users/nathan-beam/events{/privacy}", "received_events_url": "https://api.github.com/users/nathan-beam/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-03-04T17:42:33Z", "updated_at": "2021-05-14T01:59:52Z", "closed_at": "2021-05-14T01:59:52Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nWhen using `wait_time = constant_pacing` with nested TaskSets, pacing does not keep track of nested task runs, so when the child TaskSet interrupts, the parent TaskSet immediately runs 2 tasks.\r\n\r\nThe problem lies in the way the `constant_pacing` [function ](https://github.com/locustio/locust/blob/fddfefe7ef1082bc5284cd2dd8477221484dfb0c/locust/user/wait_time.py#L49)keeps track of the last run: \r\n\r\n``` python\r\n    def wait_time_func(self):\r\n        if not hasattr(self, \"_cp_last_run\"):\r\n            self._cp_last_wait_time = wait_time\r\n            self._cp_last_run = time()\r\n            return wait_time\r\n        else:\r\n            run_time = time() - self._cp_last_run - self._cp_last_wait_time\r\n            self._cp_last_wait_time = max(0, wait_time - run_time)\r\n            self._cp_last_run = time()\r\n            return self._cp_last_wait_time\r\n```\r\n\r\nWhen a child TaskSet ends, it returns up to the parent TaskSet, where another task is run immediately, as expected. After the task completes, `wait_time_func` is called, and, when the runtime is calculated, uses the `_cp_last_run` variable to determine how long the task took to run. However, because the `_cp_last_run` for the parent task set was last set just before the child taskset was executed, the `_cp_last_run` will appear as if the task took far longer to run than it did, nearly always longer than the supplied `wait_time`, meaning the newly calculated `wait_time` will nearly always be 0, resulting in immediately firing a second task.\r\n\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nOnce the flow has returned to the parent TaskSet, `constant_pacing` should calculate the next wait time based off of the last task run, not the one run _before_ entering the child TaskSet\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nOnce the flow has returned to the parent TaskSet, a task from the parent TaskSet is immediately run, but since `_cp_last_run` is set on the object _after_ a task runs, the wait time is calculated based off of the task executed _before_ entering the child, the wait time is calculated to be 0 and another task is immediately fired.\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n```python\r\nfrom locust import constant_pacing, HttpUser, task, TaskSet\r\n\r\nclass User(HttpUser):\r\n    @task\r\n    class ParentTaskSet(TaskSet):\r\n            wait_time = constant_pacing(5)\r\n            @task\r\n            def on_init(self):\r\n                self.client.get(\"/parent\")\r\n                self.schedule_task(self.ChildTaskSet, True)\r\n            class ChildTaskSet(TaskSet):\r\n                wait_time = constant_pacing(5)\r\n                \r\n                @task\r\n                def child_task(self):\r\n                    self.client.get(\"/parent/child\")\r\n                    self.schedule_task(self.interrupt, True)\r\n````\r\n\r\n\r\n### Environment\r\n\r\n- OS: Windows 10\r\n- Python version: 3.9\r\n- Locust version: 1.4.3\r\n- Locust command line that you ran: `locust -f scripts/locustfile.py --loglevel \"DEBUG\"`\r\n- Locust file contents (anonymized if necessary): \r\n```\r\n[2021-03-04 12:35:13,471] nbeam10lt/INFO/locust.main: Starting web interface at http://0.0.0.0:8089 (accepting connections from all network interfaces)\r\n[2021-03-04 12:35:13,479] nbeam10lt/INFO/locust.main: Starting Locust 1.4.3\r\n[2021-03-04 12:35:18,378] nbeam10lt/DEBUG/locust.runners: Stopping all users\r\n[2021-03-04 12:35:20,421] nbeam10lt/INFO/locust.runners: Spawning 1 users at the rate 1 users/s (0 users already running)...\r\n[2021-03-04 12:35:20,423] nbeam10lt/INFO/locust.runners: All users spawned: User: 1 (1 total running)\r\n[2021-03-04 12:35:20,424] nbeam10lt/DEBUG/urllib3.connectionpool: Starting new HTTP connection (1): 127.0.0.1:80\r\n[2021-03-04 12:35:20,483] nbeam10lt/DEBUG/urllib3.connectionpool: http://www.127.0.0.1.com:80 \"GET /parent HTTP/1.1\" 404 1567\r\n[2021-03-04 12:35:25,512] nbeam10lt/DEBUG/urllib3.connectionpool: http://127.0.0.1:80 \"GET /parent/child HTTP/1.1\" 404 1573\r\n[2021-03-04 12:35:30,542] nbeam10lt/DEBUG/urllib3.connectionpool: http://127.0.0.1:80 \"GET /parent HTTP/1.1\" 404 1567\r\n[2021-03-04 12:35:30,570] nbeam10lt/DEBUG/urllib3.connectionpool: http://127.0.0.1:80 \"GET /parent/child HTTP/1.1\" 404 1573\r\n[2021-03-04 12:35:35,599] nbeam10lt/DEBUG/urllib3.connectionpool: http://127.0.0.1:80 \"GET /parent HTTP/1.1\" 404 1567\r\n[2021-03-04 12:35:35,626] nbeam10lt/DEBUG/urllib3.connectionpool: http://127.0.0.1:80 \"GET /parent/child HTTP/1.1\" 404 1573\r\n[2021-03-04 12:35:40,656] nbeam10lt/DEBUG/urllib3.connectionpool: http://127.0.0.1:80 \"GET /parent HTTP/1.1\" 404 1567\r\n[2021-03-04 12:35:40,683] nbeam10lt/DEBUG/urllib3.connectionpool: http://127.0.0.1:80 \"GET /parent/child HTTP/1.1\" 404 1573\r\n```\r\nNote after the initial 2 commands are executed as expected (5 second wait), the commands are then executed in pairs, one after the other. ", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1723/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1723/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1718", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1718/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1718/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1718/events", "html_url": "https://github.com/locustio/locust/issues/1718", "id": 818720228, "node_id": "MDU6SXNzdWU4MTg3MjAyMjg=", "number": 1718, "title": "LoadTestShape run_time broken when using test_start and test_stop decorators", "user": {"login": "laakejs", "id": 33700709, "node_id": "MDQ6VXNlcjMzNzAwNzA5", "avatar_url": "https://avatars.githubusercontent.com/u/33700709?v=4", "gravatar_id": "", "url": "https://api.github.com/users/laakejs", "html_url": "https://github.com/laakejs", "followers_url": "https://api.github.com/users/laakejs/followers", "following_url": "https://api.github.com/users/laakejs/following{/other_user}", "gists_url": "https://api.github.com/users/laakejs/gists{/gist_id}", "starred_url": "https://api.github.com/users/laakejs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/laakejs/subscriptions", "organizations_url": "https://api.github.com/users/laakejs/orgs", "repos_url": "https://api.github.com/users/laakejs/repos", "events_url": "https://api.github.com/users/laakejs/events{/privacy}", "received_events_url": "https://api.github.com/users/laakejs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2021-03-01T10:26:58Z", "updated_at": "2021-03-23T15:03:50Z", "closed_at": "2021-03-23T15:03:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nWhen using the LoadTestShape class in combination with @events.test_start.add_listener and @events.test_stop.add_listener, the run_time does not work as expected. The tick function is called once BEFORE the  @events.test_start.add_listener function runs. Next, the  content of the @events.test_start.add_listener function is executed which in our case takes quite a while as we are faking data. When it is finished the actual CustomShape loadtest starts, however the time was running in the background all the time, so the get_run_time() function returns pretty high numbers. If there are stages that would still run at that time locust now seems to start them and we get some load on our Api. But even more confusing the @events.test_start.add_listener seems to run again, this time in parallel wit the actual loadtest.\r\n\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nIf there is a class extending the  LoadTestShape class, it should be instantiated (and the time should start to tick) AFTER the @events.test_start.add_listener function finished. Otherwise it is dependent on the runtime of preparation actions. Also it should not cause @events.test_start.add_listener to run again.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nThe tick function is called once BEFORE the @events.test_start.add_listener function runs and the time keeps running in the background.  Additionally it seems to start events.test_start.add_listener again in parallel to the loadtest.\r\n![Locust_bug_proof_long](https://user-images.githubusercontent.com/33700709/109479634-df8b9e00-7a7a-11eb-8315-bbb6bb4f27a5.JPG)\r\n\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\nimport logging\r\nimport time \r\n\r\nfrom locust import HttpUser, LoadTestShape, between, events, task\r\nfrom utils import get_api_credentials, get_host\r\n\r\n\r\n@events.test_start.add_listener\r\ndef on_test_start(**kwargs):\r\n    logging.info(\"on_test_start started running\")\r\n    time.sleep(317)\r\n    logging.info(\"on_test_start finished\")\r\n\r\n\r\n@events.test_stop.add_listener\r\ndef on_test_stop(**kwargs):\r\n    logging.info(\"on_test_stop started running\")\r\n    time.sleep(317)\r\n    logging.info(\"on_test_stop finished\")\r\n\r\n\r\nclass Api1(HttpUser):\r\n    wait_time = between(1, 10)\r\n    host = get_host()\r\n    credentials = get_api_credentials()\r\n\r\n    @task\r\n    def task1(self):\r\n        self.client.get(\"/foo\", auth=self.credentials, timeout=0.2)\r\n\r\n    @task\r\n    def task2(self):\r\n        self.client.get(\"/bar\", auth=self.credentials, timeout=0.2)\r\n\r\n    @task\r\n    def task3(self):\r\n        self.client.get(\"/misc\", auth=self.credentials, timeout=0.2)\r\n\r\n\r\nclass StagesShape(LoadTestShape):\r\n\r\n    stages = [\r\n        {\"duration\": 120, \"users\": 100, \"spawn_rate\": 1},\r\n        {\"duration\": 300, \"users\": 500, \"spawn_rate\": 10},\r\n        {\"duration\": 500, \"users\": 500, \"spawn_rate\": 10},\r\n    ]\r\n\r\n    def tick(self):\r\n        run_time = self.get_run_time()\r\n        logging.info(f\"Loadtest running with runtime={run_time}\")\r\n        for stage in self.stages:\r\n            if run_time < stage[\"duration\"]:\r\n                tick_data = (stage[\"users\"], stage[\"spawn_rate\"])\r\n                return tick_data\r\n        logging.info(\"end loadtest\")\r\n        return None\r\n\r\n\r\nlocust.conf:\r\n\r\nlocustfile = tests/loadtests/custom_shape_loadtest.py\r\nheadless = true\r\nstop-timeout = 1\r\ncsv = .artifacts/load_test\r\nonly-summary = true\r\n\r\n### Environment\r\n\r\n- OS: Ubuntu 18.04.5 LTS (WSL)\r\n- Python version: 3.9.1\r\n- Locust version: 1.4.3\r\n- Locust command line that you ran: poetry run locust\r\n- Locust file contents (anonymized if necessary): ", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1718/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1718/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1716", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1716/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1716/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1716/events", "html_url": "https://github.com/locustio/locust/issues/1716", "id": 818521872, "node_id": "MDU6SXNzdWU4MTg1MjE4NzI=", "number": 1716, "title": "How to use multiple hosts in multiple classes", "user": {"login": "atinesh-s", "id": 11910799, "node_id": "MDQ6VXNlcjExOTEwNzk5", "avatar_url": "https://avatars.githubusercontent.com/u/11910799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/atinesh-s", "html_url": "https://github.com/atinesh-s", "followers_url": "https://api.github.com/users/atinesh-s/followers", "following_url": "https://api.github.com/users/atinesh-s/following{/other_user}", "gists_url": "https://api.github.com/users/atinesh-s/gists{/gist_id}", "starred_url": "https://api.github.com/users/atinesh-s/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/atinesh-s/subscriptions", "organizations_url": "https://api.github.com/users/atinesh-s/orgs", "repos_url": "https://api.github.com/users/atinesh-s/repos", "events_url": "https://api.github.com/users/atinesh-s/events{/privacy}", "received_events_url": "https://api.github.com/users/atinesh-s/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-03-01T06:24:59Z", "updated_at": "2021-03-01T17:51:58Z", "closed_at": "2021-03-01T17:23:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\nI need to test some APIs having different addresses, I have created locustfile as mentioned below, but only api1 is working, endpoints in api2 are not being called\r\n\r\nI tried suggestions from Issue: https://github.com/locustio/locust/issues/150 and put full path as `self.client.post('http://localhost:6001/ep1')` but the same problem persists\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n**locustfile.py**\r\n```\r\nfrom locust import HttpUser, task, between\r\n\r\nclass api1(HttpUser):\r\n\r\n    host = 'http://localhost:6001'\r\n    wait_time = between(2, 4)\r\n\r\n    @task()\r\n    def api1_ep1(self):\r\n        self.client.post('/ep1')\r\n        \r\n    @task()\r\n    def api1_ep2(self):\r\n        self.client.post('/ep2')\r\n        \r\n\r\nclass api2(HttpUser):\r\n\r\n    host = 'http://localhost:6002'\r\n    wait_time = between(2, 4)\r\n\r\n    @task()\r\n    def api2_ep1(self):\r\n        self.client.post('/ep1')\r\n\r\n    @task()\r\n    def api2_ep2(self):\r\n        self.client.post('/ep2')\r\n```\r\n\r\n### Environment\r\n\r\n- OS: Ubuntu 18.04 LTS\r\n- Python version: Python 3.6.9 \r\n- Locust version: 1.4.3\r\n- Locust command line that you ran: locust\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1716/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1716/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1713", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1713/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1713/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1713/events", "html_url": "https://github.com/locustio/locust/issues/1713", "id": 815256479, "node_id": "MDU6SXNzdWU4MTUyNTY0Nzk=", "number": 1713, "title": "webUI #Requests and # Fails count error when api failed", "user": {"login": "weirdohaibo", "id": 39296688, "node_id": "MDQ6VXNlcjM5Mjk2Njg4", "avatar_url": "https://avatars.githubusercontent.com/u/39296688?v=4", "gravatar_id": "", "url": "https://api.github.com/users/weirdohaibo", "html_url": "https://github.com/weirdohaibo", "followers_url": "https://api.github.com/users/weirdohaibo/followers", "following_url": "https://api.github.com/users/weirdohaibo/following{/other_user}", "gists_url": "https://api.github.com/users/weirdohaibo/gists{/gist_id}", "starred_url": "https://api.github.com/users/weirdohaibo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/weirdohaibo/subscriptions", "organizations_url": "https://api.github.com/users/weirdohaibo/orgs", "repos_url": "https://api.github.com/users/weirdohaibo/repos", "events_url": "https://api.github.com/users/weirdohaibo/events{/privacy}", "received_events_url": "https://api.github.com/users/weirdohaibo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-02-24T08:44:56Z", "updated_at": "2021-03-15T14:19:49Z", "closed_at": "2021-03-15T14:19:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nwebUI #Requests and # Fails count error, \r\n\r\n### Expected behavior\r\n#Request count right\r\n\r\n### Actual behavior\r\n#Requests plus one more time # Fails\r\ncase is run 4 times, but #Requests is 7.\r\n\r\nType | Name | # Requests | # Fails | Median (ms) | 90%ile (ms) | Average (ms) | Min (ms) | Max (ms) | Average size (bytes) | Current RPS | Current Failures/s\r\n-- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | --\r\nPOST | insurance_pay_searchQuotation | 7 | 3 | 29 | 36 | 19 | 0 | 36 | 390 | 0.63 | 0.25\r\nGET | insurance_createContract_getDcecisionPlanList | 5 | 0 | 16 | 41 | 25 | 13 | 41 | 6 | 0.38 | 0\r\nPOST | insurance_createContract_getVehicleInfo | 5 | 0 | 19 | 27 | 21 | 18 | 27 | 183 | 0.38 | 0\r\nGET | insurance_createContract_init_0 | 5 | 0 | 21 | 39 | 24 | 20 | 39 | 19767 | 0.38 | 0\r\nPOST | insurance_createContract_showHasPacks | 5 | 0 | 25 | 39 | 26 | 19 | 39 | 37 | 0.38 | 0\r\nPOST | login | 5 | 0 | 42 | 66 | 44 | 32 | 66 | 0 | 0.38 | 0\r\nGET | insurance_bePaid_init_contractId | 4 | 0 | 30 | 38 | 32 | 29 | 38 | 209 | 0.38 | 0\r\nPOST | insurance_bePaid_submit | 4 | 0 | 29 | 38 | 32 | 28 | 38 | 0 | 0.38 | 0\r\nPOST | insurance_bePaid_submitCheck | 4 | 0 | 25 | 26 | 26 | 24 | 26 | 12 | 0.38 | 0\r\nPOST | insurance_createContract_calculatePrice | 4 | 0 | 58 | 72 | 59 | 44 | 72 | 1597 | 0.38 | 0\r\n\r\n\r\n![Uploading image.png\u2026]()\r\n\r\n### Steps to reproduce\r\n1. 1 user running\r\n2. one api is failed, and keep running\r\n3. webUI #Requests and # Fails count error, #Requests plus one more time # Fails\r\n\r\n### Environment\r\n\r\n- OS: linux\r\n- Python version: 3.6\r\n- Locust version: 1.4.3\r\n- Locust command line that you ran: \r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1713/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1713/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1712", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1712/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1712/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1712/events", "html_url": "https://github.com/locustio/locust/issues/1712", "id": 814683311, "node_id": "MDU6SXNzdWU4MTQ2ODMzMTE=", "number": 1712, "title": "HTML output includes all errors resulting in enormous unusable files ", "user": {"login": "benc-uk", "id": 14982936, "node_id": "MDQ6VXNlcjE0OTgyOTM2", "avatar_url": "https://avatars.githubusercontent.com/u/14982936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/benc-uk", "html_url": "https://github.com/benc-uk", "followers_url": "https://api.github.com/users/benc-uk/followers", "following_url": "https://api.github.com/users/benc-uk/following{/other_user}", "gists_url": "https://api.github.com/users/benc-uk/gists{/gist_id}", "starred_url": "https://api.github.com/users/benc-uk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/benc-uk/subscriptions", "organizations_url": "https://api.github.com/users/benc-uk/orgs", "repos_url": "https://api.github.com/users/benc-uk/repos", "events_url": "https://api.github.com/users/benc-uk/events{/privacy}", "received_events_url": "https://api.github.com/users/benc-uk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-02-23T17:39:29Z", "updated_at": "2021-07-11T01:50:31Z", "closed_at": "2021-07-11T01:50:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nWhen running long tests with high user load, **_many_** errors can be output, sometimes millions of millions of error messages. These are ALL written the to HTML report file. \r\n\r\nIn a recent test I created an insanely large **1.2GB HTML file** \ud83d\ude32, and that was just a 10 min long test.  \r\nNaturally this file was completely useless\r\n\r\nTo make matters worse, the charts are placed *after* the errors in the report.\r\n\r\n### Expected behavior\r\nThe HTML doesn't include all the errors, and is of a size a browser can open and handle.\r\n\r\n### Actual behavior\r\nEnormous file which makes my browser cry, and my laptop CPU \ud83d\udd25\r\n\r\n### Steps to reproduce\r\nRun a ten minute test which fails or has some other error in it, and run with with `--html` option\r\n\r\n### Environment\r\n\r\n- OS: Linux\r\n- Python version: 3.9\r\n- Locust version: 1.4.3\r\n- Locust command line that you ran: It's complicated\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1712/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1712/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1711", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1711/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1711/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1711/events", "html_url": "https://github.com/locustio/locust/issues/1711", "id": 814528501, "node_id": "MDU6SXNzdWU4MTQ1Mjg1MDE=", "number": 1711, "title": "Test stops / resets unexpectedly", "user": {"login": "ilons", "id": 6905634, "node_id": "MDQ6VXNlcjY5MDU2MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/6905634?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ilons", "html_url": "https://github.com/ilons", "followers_url": "https://api.github.com/users/ilons/followers", "following_url": "https://api.github.com/users/ilons/following{/other_user}", "gists_url": "https://api.github.com/users/ilons/gists{/gist_id}", "starred_url": "https://api.github.com/users/ilons/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ilons/subscriptions", "organizations_url": "https://api.github.com/users/ilons/orgs", "repos_url": "https://api.github.com/users/ilons/repos", "events_url": "https://api.github.com/users/ilons/events{/privacy}", "received_events_url": "https://api.github.com/users/ilons/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-02-23T14:41:21Z", "updated_at": "2021-02-24T14:21:06Z", "closed_at": "2021-02-23T21:22:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nWhen running Locust distributed using the Web UI, after a while (about 20 minutes), the master seems to reset, and the web UI gets reset.\r\n\r\nIn the logs for the master there is no errors, and the only thing logged is when Locust starts again.\r\nHowever, as the master restarted, and the slaves didn't every time a slave send reporting, a log record are emitted for this:\r\n`[2021-02-23 14:39:06,083] be6840e48053/INFO/locust.runners: Discarded report from unrecognized slave 5872913091c8_...`\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nTests continues to run until I press stop\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nThe locusts continue to run, but the master restarts, making locusts reports to get discarded and the STOP button disappearing from the web UI.\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\nI'm trying to create steps to reproduce this reliably, but are having a hard time getting any debug information out of locust (as hardly any debug logging are done from it)\r\n\r\n### Environment\r\n\r\n- OS: alpine 3.12\r\n- Python version: 3.7.9\r\n- Locust version: 0.14.6\r\n- Locust command line that you ran: `locust -f locustfile.py --host https://<censored> --skip-log-setup`\r\n- Locust file contents (anonymized if necessary): Will try to isolate it", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1711/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1711/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1709", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1709/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1709/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1709/events", "html_url": "https://github.com/locustio/locust/issues/1709", "id": 812599051, "node_id": "MDU6SXNzdWU4MTI1OTkwNTE=", "number": 1709, "title": "Reset Stats doesn't work", "user": {"login": "thecantero", "id": 77951308, "node_id": "MDQ6VXNlcjc3OTUxMzA4", "avatar_url": "https://avatars.githubusercontent.com/u/77951308?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thecantero", "html_url": "https://github.com/thecantero", "followers_url": "https://api.github.com/users/thecantero/followers", "following_url": "https://api.github.com/users/thecantero/following{/other_user}", "gists_url": "https://api.github.com/users/thecantero/gists{/gist_id}", "starred_url": "https://api.github.com/users/thecantero/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thecantero/subscriptions", "organizations_url": "https://api.github.com/users/thecantero/orgs", "repos_url": "https://api.github.com/users/thecantero/repos", "events_url": "https://api.github.com/users/thecantero/events{/privacy}", "received_events_url": "https://api.github.com/users/thecantero/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-02-20T12:30:00Z", "updated_at": "2021-05-02T01:59:03Z", "closed_at": "2021-05-02T01:59:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "Should clicking \"Reset Stats\" clear the graph and stats? It doesn't seem to work, or I don't know how it should work.\r\n\r\nPlease do fix or enlighten me how it should work.\r\n\r\nThanks", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1709/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1709/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1708", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1708/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1708/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1708/events", "html_url": "https://github.com/locustio/locust/issues/1708", "id": 811642491, "node_id": "MDU6SXNzdWU4MTE2NDI0OTE=", "number": 1708, "title": "test_webserver and test_custom_exit_code test failures", "user": {"login": "Apteryks", "id": 8332263, "node_id": "MDQ6VXNlcjgzMzIyNjM=", "avatar_url": "https://avatars.githubusercontent.com/u/8332263?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Apteryks", "html_url": "https://github.com/Apteryks", "followers_url": "https://api.github.com/users/Apteryks/followers", "following_url": "https://api.github.com/users/Apteryks/following{/other_user}", "gists_url": "https://api.github.com/users/Apteryks/gists{/gist_id}", "starred_url": "https://api.github.com/users/Apteryks/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Apteryks/subscriptions", "organizations_url": "https://api.github.com/users/Apteryks/orgs", "repos_url": "https://api.github.com/users/Apteryks/repos", "events_url": "https://api.github.com/users/Apteryks/events{/privacy}", "received_events_url": "https://api.github.com/users/Apteryks/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}, {"id": 2115072627, "node_id": "MDU6TGFiZWwyMTE1MDcyNjI3", "url": "https://api.github.com/repos/locustio/locust/labels/non-critical", "name": "non-critical", "color": "c4e4c9", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-02-19T03:06:56Z", "updated_at": "2021-02-23T06:56:42Z", "closed_at": "2021-02-23T06:55:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nThe two tests mentioned in the title fail on machine A but pass on machine B.  The build environment on both machine should be identical, with the exception of the the Linux kernel version and system specifications (CPU, RAM, disk, etc.)\r\n\r\n### Expected behavior\r\nThe tests should pass on both these machines.\r\n\r\n### Actual behavior\r\nOn the slower machine A, the two tests mentioned above fail, with the results:\r\n\r\n```\r\n[...]\r\n______________ LocustProcessIntegrationTest.test_custom_exit_code ______________\r\n\r\nself = <locust.test.test_main.LocustProcessIntegrationTest testMethod=test_custom_exit_code>\r\n\r\n    def test_custom_exit_code(self):\r\n        with temporary_file(\r\n            content=textwrap.dedent(\r\n                \"\"\"\r\n            from locust import User, task, constant, events\r\n            @events.quitting.add_listener\r\n            def _(environment, **kw):\r\n                environment.process_exit_code = 42\r\n            class TestUser(User):\r\n                wait_time = constant(3)\r\n                @task\r\n                def my_task(self):\r\n                    print(\"running my_task()\")\r\n        \"\"\"\r\n            )\r\n        ) as file_path:\r\n            proc = subprocess.Popen([\"locust\", \"-f\", file_path], stdout=PIPE, stderr=PIPE)\r\n            gevent.sleep(1)\r\n            proc.send_signal(signal.SIGTERM)\r\n            stdout, stderr = proc.communicate()\r\n>           self.assertEqual(42, proc.returncode)\r\nE           AssertionError: 42 != -15\r\n\r\nlocust/test/test_main.py:199: AssertionError\r\n[...]\r\nlocust/test/test_main.py:396: AssertionError\r\n_________________ LocustProcessIntegrationTest.test_webserver __________________\r\n\r\nself = <locust.test.test_main.LocustProcessIntegrationTest testMethod=test_webserver>\r\n\r\n    def test_webserver(self):\r\n        with temporary_file(\r\n            content=textwrap.dedent(\r\n                \"\"\"\r\n            from locust import User, task, constant, events\r\n            class TestUser(User):\r\n                wait_time = constant(3)\r\n                @task\r\n                def my_task(self):\r\n                    print(\"running my_task()\")\r\n        \"\"\"\r\n            )\r\n        ) as file_path:\r\n            proc = subprocess.Popen([\"locust\", \"-f\", file_path], stdout=PIPE, stderr=PIPE)\r\n            gevent.sleep(1)\r\n            proc.send_signal(signal.SIGTERM)\r\n            stdout, stderr = proc.communicate()\r\n>           self.assertEqual(0, proc.returncode)\r\nE           AssertionError: 0 != -15\r\n\r\nlocust/test/test_main.py:222: AssertionError\r\n[...]\r\n```\r\n\r\nAttached is the full log:\r\n[ilsddw0ll0vhbv9iqa6v2wx29smvi1-python-locust-1.4.3.drv.log.gz](https://github.com/locustio/locust/files/6007351/ilsddw0ll0vhbv9iqa6v2wx29smvi1-python-locust-1.4.3.drv.log.gz)\r\n\r\n### Steps to reproduce\r\n\r\nThe easiest way to reproduce this on your environment may well be to use Guix, which was designed for reproducibility:\r\n\r\n1. Install the Guix binary (it's a matter of running a script): https://guix.gnu.org/manual/en/html_node/Binary-Installation.html\r\n2. Run the following command:\r\n```\r\nguix time-machine --commit=a30f250d7426df48f5532cd339b8f53dd6e4dd3a -- build -K --with-latest=python-locust python-locust\r\n```\r\n\r\nWith some luck, you should see the same failures (perhaps just on lesser machines, like in my case?).\r\n\r\n### Environment\r\n\r\nMachine A:\r\nIntel Q6700, 8 GiB RAM, spinning disks, Linux 5.10.17-gnu\r\n\r\nMachine B:\r\nAMD Ryzen 3900X, 32 GiB RAM, M.2 SSD, Linux 5.8.5-gnu\r\n\r\n- OS: Guix System\r\n- Python version: 3.8.2\r\n- Locust version: 1.4.3\r\n- Locust command line that you ran: See 'Steps to reproduce'.\r\n- Locust file contents (anonymized if necessary): N/A.\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1708/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1708/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1707", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1707/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1707/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1707/events", "html_url": "https://github.com/locustio/locust/issues/1707", "id": 811022216, "node_id": "MDU6SXNzdWU4MTEwMjIyMTY=", "number": 1707, "title": "Distributed test stopped despite workers running", "user": {"login": "enote-kane", "id": 55989919, "node_id": "MDQ6VXNlcjU1OTg5OTE5", "avatar_url": "https://avatars.githubusercontent.com/u/55989919?v=4", "gravatar_id": "", "url": "https://api.github.com/users/enote-kane", "html_url": "https://github.com/enote-kane", "followers_url": "https://api.github.com/users/enote-kane/followers", "following_url": "https://api.github.com/users/enote-kane/following{/other_user}", "gists_url": "https://api.github.com/users/enote-kane/gists{/gist_id}", "starred_url": "https://api.github.com/users/enote-kane/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/enote-kane/subscriptions", "organizations_url": "https://api.github.com/users/enote-kane/orgs", "repos_url": "https://api.github.com/users/enote-kane/repos", "events_url": "https://api.github.com/users/enote-kane/events{/privacy}", "received_events_url": "https://api.github.com/users/enote-kane/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2021-02-18T11:41:00Z", "updated_at": "2021-08-11T13:09:31Z", "closed_at": "2021-02-26T11:15:15Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Describe the bug\r\nWhen executing a distributed load test where worker node might not heartbeat back in-time (which is not configurable anymore) due to CPU and/or I/O-intensive tasks, it can happen that the whole test is being stopped despite the workers being fine and just busy.\r\n\r\n### Expected behavior\r\nThe test continues to run.\r\n\r\n### Actual behavior\r\nAll workers are being stopped by the master after the following messages:\r\n```\r\n[2021-02-18 10:58:33,241] 7c22a81c40a0/INFO/locust.runners: Worker ffaeb7471fb6_898127e830cc4c7487b6674f88b045fc failed to send heartbeat, setting state to missing.\r\n[2021-02-18 10:58:33,241] 7c22a81c40a0/INFO/locust.runners: Worker da57de88394e_76e79054084547768aa00e0adba033bf failed to send heartbeat, setting state to missing.\r\n[2021-02-18 10:58:33,241] 7c22a81c40a0/INFO/locust.runners: Worker d3c53c424e43_1644c39706a44f118090761360c76fe1 failed to send heartbeat, setting state to missing.\r\n[2021-02-18 10:58:34,241] 7c22a81c40a0/INFO/locust.runners: Worker 95ac4f8adc8a_ce1bb0094a494d7f8a0540ebab54e105 failed to send heartbeat, setting state to missing.\r\n[2021-02-18 10:58:34,242] 7c22a81c40a0/INFO/locust.runners: Worker c08fe40ccea4_b63905214f7846cea3f18cf529cb8767 failed to send heartbeat, setting state to missing.\r\n[2021-02-18 10:58:35,242] 7c22a81c40a0/INFO/locust.runners: Worker 8784191196a2_9a136837b45d468cb46b0edaa3c3697c failed to send heartbeat, setting state to missing.\r\n[2021-02-18 10:58:35,243] 7c22a81c40a0/INFO/locust.runners: Worker a5c9ae640c92_1f323758e42c4b609fa5a050c28bac50 failed to send heartbeat, setting state to missing.\r\n[2021-02-18 10:58:36,243] 7c22a81c40a0/INFO/locust.runners: Worker 3f2bf4b8fc3f_90f59e8d0efb4e6fb424fb2e95c8c50a failed to send heartbeat, setting state to missing.\r\n[2021-02-18 10:58:36,243] 7c22a81c40a0/INFO/locust.runners: The last worker went missing, stopping test.\r\n```\r\n\r\nAfter logging some more internals, it became evident that the calculation is simply wrong:\r\n```\r\n... The last worker went missing, stopping test (workers: 15, missing: 15).\r\n```\r\n...where:\r\n* `workers = self.worker_count` (despite actually running 30 workers in my case)\r\n* `missing = len(self.clients.missing)`\r\n\r\n...however, `self.worker_count` doesn't even include missing clients, which makes the condition completely obsolete:\r\n```python\r\nif self.worker_count - len(self.clients.missing) <= 0:\r\n```\r\n\r\nSo, either `self.worker_count` needs to include missing clients or the condition should changed to this instead:\r\n```python\r\nif self.worker_count <= 0:\r\n```\r\n\r\n### Steps to reproduce\r\nCreate a load-test that has a CPU-intensive task that runs for more than 3 seconds on each worker.\r\n\r\n### Environment\r\n\r\n- OS: Ubuntu 20.04 LTS\r\n- Python version: 3.8\r\n- Locust version: 1.4.3\r\n- Locust command line that you ran: `docker-compose up --scale worker=30` (see docker-compose file below)\r\n- Locust file contents (anonymized if necessary): the one that I have is too complex for this\r\n\r\nDocker compose file:\r\n```yaml\r\nversion: \"3.7\"\r\n\r\nx-base-service: &base_service\r\n  image: \"locustio/locust:latest\"\r\n  restart: \"no\"\r\n  volumes:\r\n    - ./:/mnt/tests:ro\r\n  working_dir: \"/mnt/tests\"\r\n\r\nservices:\r\n  locust-master:\r\n    <<: *base_service\r\n    container_name: locust-master\r\n    command: [\r\n      \"--master\",\r\n      \"--headless\",\r\n      \"--locustfile\", \"/mnt/tests/${LOCUST_FILE:?Locustfile not specified}\",\r\n      \"--users\", \"${NUM_USERS:-10}\",\r\n      \"--spawn-rate\", \"${SPAWN_RATE:-7}\",\r\n      \"--run-time\", \"${RUN_TIME:-5m}\",\r\n      \"--stop-timeout\", \"${STOP_TIMEOUT:-60}\",\r\n      \"--expect-workers\", \"${LOCUST_WORKERS:-1}\",\r\n      \"--host\", \"${LOCUST_TARGET:?No test target host specified}\"\r\n    ]\r\n\r\n  worker:\r\n    <<: *base_service\r\n    command: [\r\n      \"--worker\",\r\n      \"--master-host\", \"locust-master\",\r\n      \"--locustfile\", \"/mnt/tests/${LOCUST_FILE:?Locustfile not specified}\",\r\n      \"--users\", \"${NUM_USERS:-10}\",\r\n      \"--spawn-rate\", \"${SPAWN_RATE:-7}\",\r\n      \"--host\", \"${LOCUST_TARGET:?No test target host specified}\"\r\n    ]\r\n```\r\n\r\n`.env` file for the specific run:\r\n```dotenv\r\nLOCUST_FILE=<redacted>\r\nLOCUST_WORKERS=30\r\nNUM_USERS=240\r\nSPAWN_RATE=30\r\nRUN_TIME=15m\r\nSTOP_TIMEOUT=60\r\nLOCUST_TARGET=<redacted>\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1707/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1707/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1706", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1706/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1706/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1706/events", "html_url": "https://github.com/locustio/locust/issues/1706", "id": 810094231, "node_id": "MDU6SXNzdWU4MTAwOTQyMzE=", "number": 1706, "title": "`FastHttpResponse` has less cookies than `HttpResponse`", "user": {"login": "htr3n", "id": 278382, "node_id": "MDQ6VXNlcjI3ODM4Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/278382?v=4", "gravatar_id": "", "url": "https://api.github.com/users/htr3n", "html_url": "https://github.com/htr3n", "followers_url": "https://api.github.com/users/htr3n/followers", "following_url": "https://api.github.com/users/htr3n/following{/other_user}", "gists_url": "https://api.github.com/users/htr3n/gists{/gist_id}", "starred_url": "https://api.github.com/users/htr3n/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/htr3n/subscriptions", "organizations_url": "https://api.github.com/users/htr3n/orgs", "repos_url": "https://api.github.com/users/htr3n/repos", "events_url": "https://api.github.com/users/htr3n/events{/privacy}", "received_events_url": "https://api.github.com/users/htr3n/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2115072627, "node_id": "MDU6TGFiZWwyMTE1MDcyNjI3", "url": "https://api.github.com/repos/locustio/locust/labels/non-critical", "name": "non-critical", "color": "c4e4c9", "default": false, "description": ""}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-02-17T11:20:57Z", "updated_at": "2021-05-05T01:50:33Z", "closed_at": "2021-05-05T01:50:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\nI wrote a TaskSet subclass that will authentication on `on_start(self)` and maintain the session for all tasks within that same TaskSet. Before, I used `HttpUser`. Lately, I want to achieve better performance, hence, switching to `FastHttp` with the same test procedure (the response is handled differently as `FastHttpUser` and `HttpUser `are slightly different).\r\n\r\n### Expected behavior\r\n`self.client` is an instance of `HttpSession` / `FastHttpSession`, it should have valid session after the authentication with `on_start()`. Hence, the task request should not return 401.\r\n\r\n### Actual behavior\r\nMy same test that ran perfectly fine with `HttpUser` now returns 401 Unauthorized with `FastHttpUser`.\r\n\r\nI printed out the `response.__dict__` right after the authentication call and noticed that, `HttpResponse` has more cookies in the jar than `FastHttpResponse` ;)\r\n\r\nThis is from `HttpResponse`, the paths are anonymized.\r\n\r\n```\r\n'cookies': <RequestsCookieJar[Cookie(version=0, name='JSESSIONIDSSO', value='ZgcvTpsE3MtzrxqezzWg9PJq3WDsDg0C6Q9SBVm7', port=None, port_specified=False, domain='localhost.local', domain_specified=False, domain_initial_dot=False, path='/', path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={}, rfc2109=False), Cookie(version=0, name='JSESSIONID', value='\"iICagxGg1jN3x0aqVpEz9OOuwXO9E1nf_xN4Ip6J.primary:cpf-server\"', port=None, port_specified=False, domain='localhost.local', domain_specified=False, domain_initial_dot=False, path='/login', path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={}, rfc2109=True), Cookie(version=0, name='JSESSIONID', value='\"NslWHcDA0xQukoWxLUjATqLiLVVKc5L7a_xdgwaU.primary:abc-server\"', port=None, port_specified=False, domain='localhost.local', domain_specified=False, domain_initial_dot=False, path='/xyz', path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={}, rfc2109=True), Cookie(version=0, name='JSESSIONID', value='\"Ak394pur3OqD5boZ-BqK1Jr7Gb6_9McNNHfe_LL5.primary:def-server\"', port=None, port_specified=False, domain='localhost.local', domain_specified=False, domain_initial_dot=False, path='/workflowapi', path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={}, rfc2109=True)]>,\r\n``` \r\n\r\nThis is from `FastHttpResponse`\r\n\r\n```\r\n'base_url': 'https://localhost',\r\n 'client': <locust.contrib.fasthttp.LocustUserAgent object at 0x7f9707d71460>,\r\n 'cookiejar': <CookieJar[Cookie(version=0, name='JSESSIONID', value='\"lwb5Oa3uNrwfqNnTt1yvqKIJZLIe0N3a8tXEiDsK.primary:abc-server\"', port=None, port_specified=False, domain='localhost.local', domain_specified=False, domain_initial_dot=False, path='/xyz', path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={}, rfc2109=True)]>,\r\n 'environment': <locust.env.Environment object at 0x7f9708647a00>,\r\n 'verify': False\r\n```\r\n\r\n`HttpResponse` consists of many cookies, especially the `JSESSIONIDSSO` which is used to authenticate in our SSO Web apps. `FastHttpResponse` only contains one, but no `JSESSIONIDSSO`.\r\n\r\n### Steps to reproduce\r\n\r\nRun the following command with the provided Locust file \r\n\r\n```sh\r\nlocust -f test_fasthttp.py --host=https://localhost --headless -u1 -r1 -t1\r\n``` \r\n\r\n### Environment\r\n\r\n- OS: Ubuntu 20.04.2 LTS\r\n- Python version: Python 3.8.5\r\n- Locust version: `locust==1.4.3`\r\n- Locust command line that you ran: `locust -f test_fasthttp.py --host=https://localhost --headless -u1 -r1 -t1`\r\n- Locust file contents (anonymized if necessary):\r\n\r\n```python\r\nclass MyTaskSet(TaskSet):\r\n\r\n    def on_start(self):\r\n        username, password = ('xxx', 'xxx')\r\n        with self.client.get(\"/login/\",\r\n                             auth=(username, password),\r\n                             catch_response=True) as response:\r\n            pprint(response.__dict__)\r\n            response.success()\r\n\t@task\r\n    def another_request(self):\r\n\t\twith self.client.post(f'...', json=..., catch_response=True) as response:\r\n\t\t\t# Got 401 here\r\n\t\t\tpprint(response.__dict__)\r\n\r\nclass MyFastHttpUser(FastHttpUser):\r\n    tasks = [MyTaskSet]\r\n    min_wait = 10\r\n    max_wait = 1000\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1706/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1706/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1704", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1704/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1704/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1704/events", "html_url": "https://github.com/locustio/locust/issues/1704", "id": 807888771, "node_id": "MDU6SXNzdWU4MDc4ODg3NzE=", "number": 1704, "title": "tests failures when running on Debian", "user": {"login": "sandrotosi", "id": 346648, "node_id": "MDQ6VXNlcjM0NjY0OA==", "avatar_url": "https://avatars.githubusercontent.com/u/346648?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sandrotosi", "html_url": "https://github.com/sandrotosi", "followers_url": "https://api.github.com/users/sandrotosi/followers", "following_url": "https://api.github.com/users/sandrotosi/following{/other_user}", "gists_url": "https://api.github.com/users/sandrotosi/gists{/gist_id}", "starred_url": "https://api.github.com/users/sandrotosi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sandrotosi/subscriptions", "organizations_url": "https://api.github.com/users/sandrotosi/orgs", "repos_url": "https://api.github.com/users/sandrotosi/repos", "events_url": "https://api.github.com/users/sandrotosi/events{/privacy}", "received_events_url": "https://api.github.com/users/sandrotosi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-02-14T04:53:24Z", "updated_at": "2021-02-14T22:27:43Z", "closed_at": "2021-02-14T21:08:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\nwhen running tests (via `python3.9 setup.py test`) several of them fail:\r\n\r\n```\r\n======================================================================\r\nERROR: test_exceptions (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc653344b20>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:36575/exceptions (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc653344b20>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 202, in test_exceptions\r\n    response = requests.get(\"http://127.0.0.1:%i/exceptions\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:36575/exceptions (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc653344b20>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_exceptions_csv (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc651146640>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:38053/exceptions/csv (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc651146640>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 217, in test_exceptions_csv\r\n    response = requests.get(\"http://127.0.0.1:%i/exceptions/csv\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:38053/exceptions/csv (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc651146640>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_failure_stats_csv (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc65116a5e0>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:43601/stats/failures/csv (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc65116a5e0>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 161, in test_failure_stats_csv\r\n    response = requests.get(\"http://127.0.0.1:%i/stats/failures/csv\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:43601/stats/failures/csv (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc65116a5e0>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_host_value_from_multiple_user_classes (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc651101b20>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:40507/ (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc651101b20>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 282, in test_host_value_from_multiple_user_classes\r\n    response = requests.get(\"http://127.0.0.1:%i/\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:40507/ (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc651101b20>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_host_value_from_multiple_user_classes_different_hosts (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc6511220d0>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:44811/ (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc6511220d0>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 295, in test_host_value_from_multiple_user_classes_different_hosts\r\n    response = requests.get(\"http://127.0.0.1:%i/\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:44811/ (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc6511220d0>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_host_value_from_user_class (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc6510bb580>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:46503/ (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc6510bb580>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 269, in test_host_value_from_user_class\r\n    response = requests.get(\"http://127.0.0.1:%i/\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:46503/ (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc6510bb580>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_index (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc6510d3a60>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:42287/ (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc6510d3a60>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 76, in test_index\r\n    self.assertEqual(200, requests.get(\"http://127.0.0.1:%i/\" % self.web_port).status_code)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:42287/ (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc6510d3a60>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_index_with_spawn_options (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc651073ee0>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:40979/ (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc651073ee0>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 87, in test_index_with_spawn_options\r\n    response = requests.get(\"http://127.0.0.1:%i/\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:40979/ (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc651073ee0>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_report_download (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc6510d3580>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:33707/stats/report?download=1 (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc6510d3580>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 320, in test_report_download\r\n    r = requests.get(\"http://127.0.0.1:%i/stats/report?download=1\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:33707/stats/report?download=1 (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc6510d3580>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_report_exceptions (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc651127310>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:40091/stats/report (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc651127310>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 355, in test_report_exceptions\r\n    r = requests.get(\"http://127.0.0.1:%i/stats/report\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:40091/stats/report (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc651127310>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_report_host (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc65114b640>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:43955/stats/report (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc65114b640>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 328, in test_report_host\r\n    r = requests.get(\"http://127.0.0.1:%i/stats/report\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:43955/stats/report (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc65114b640>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_report_host2 (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc6510a30d0>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:40393/stats/report (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc6510a30d0>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 343, in test_report_host2\r\n    r = requests.get(\"http://127.0.0.1:%i/stats/report\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:40393/stats/report (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc6510a30d0>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_report_page (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc65103b580>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:34951/stats/report (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc65103b580>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 302, in test_report_page\r\n    r = requests.get(\"http://127.0.0.1:%i/stats/report\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:34951/stats/report (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc65103b580>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_report_page_empty_stats (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc6510497c0>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:38845/stats/report (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc6510497c0>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 313, in test_report_page_empty_stats\r\n    r = requests.get(\"http://127.0.0.1:%i/stats/report\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:38845/stats/report (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc6510497c0>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_request_stats_csv (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc65105fee0>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:44955/stats/requests/csv (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc65105fee0>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 150, in test_request_stats_csv\r\n    response = requests.get(\"http://127.0.0.1:%i/stats/requests/csv\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:44955/stats/requests/csv (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc65105fee0>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_request_stats_full_history_csv_not_present (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc65100c3d0>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:33103/stats/requests_full_history/csv (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc65100c3d0>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 156, in test_request_stats_full_history_csv_not_present\r\n    response = requests.get(\"http://127.0.0.1:%i/stats/requests_full_history/csv\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:33103/stats/requests_full_history/csv (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc65100c3d0>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_request_stats_with_errors (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc65101c910>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:33929/stats/requests (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc65101c910>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 167, in test_request_stats_with_errors\r\n    response = requests.get(\"http://127.0.0.1:%i/stats/requests\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:33929/stats/requests (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc65101c910>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_reset_stats (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc650fb3e80>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:46073/stats/reset (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc650fb3e80>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 182, in test_reset_stats\r\n    response = requests.get(\"http://127.0.0.1:%i/stats/reset\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:46073/stats/reset (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc650fb3e80>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_stats (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc650ff3e80>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:34503/stats/requests (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc650ff3e80>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 107, in test_stats\r\n    response = requests.get(\"http://127.0.0.1:%i/stats/requests\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:34503/stats/requests (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc650ff3e80>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_stats_cache (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc65338f910>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:42203/stats/requests (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc65338f910>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 123, in test_stats_cache\r\n    response = requests.get(\"http://127.0.0.1:%i/stats/requests\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:42203/stats/requests (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc65338f910>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_stats_no_data (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc650fe20d0>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:36201/stats/requests (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc650fe20d0>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 103, in test_stats_no_data\r\n    self.assertEqual(200, requests.get(\"http://127.0.0.1:%i/stats/requests\" % self.web_port).status_code)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:36201/stats/requests (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc650fe20d0>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_stats_rounding (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc650f775b0>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:33031/stats/requests (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc650f775b0>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 141, in test_stats_rounding\r\n    response = requests.get(\"http://127.0.0.1:%i/stats/requests\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:33031/stats/requests (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc650f775b0>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_swarm_host_value_not_specified (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc650f8b940>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:33705/swarm (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc650f8b940>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 256, in test_swarm_host_value_not_specified\r\n    response = requests.post(\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 119, in post\r\n    return request('post', url, data=data, json=json, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:33705/swarm (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc650f8b940>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_swarm_host_value_specified (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc650f370a0>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:35757/swarm (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc650f370a0>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 239, in test_swarm_host_value_specified\r\n    response = requests.post(\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 119, in post\r\n    return request('post', url, data=data, json=json, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:35757/swarm (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc650f370a0>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_web_ui_no_runner (locust.test.test_web.TestWebUI)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc650f58d30>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:44035/ (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc650f58d30>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 69, in test_web_ui_no_runner\r\n    response = requests.get(\"http://127.0.0.1:%i/\" % web_ui.server.server_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:44035/ (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc650f58d30>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_index_with_basic_auth_enabled_blank_credentials (locust.test.test_web.TestWebUIAuth)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc650f4b430>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:33217/?ele=phino (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc650f4b430>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 389, in test_index_with_basic_auth_enabled_blank_credentials\r\n    self.assertEqual(401, requests.get(\"http://127.0.0.1:%i/?ele=phino\" % self.web_port).status_code)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:33217/?ele=phino (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc650f4b430>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_index_with_basic_auth_enabled_correct_credentials (locust.test.test_web.TestWebUIAuth)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc650f69730>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:38617/?ele=phino (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc650f69730>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 380, in test_index_with_basic_auth_enabled_correct_credentials\r\n    200, requests.get(\"http://127.0.0.1:%i/?ele=phino\" % self.web_port, auth=(\"john\", \"doe\")).status_code\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:38617/?ele=phino (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc650f69730>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_index_with_basic_auth_enabled_incorrect_credentials (locust.test.test_web.TestWebUIAuth)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc650f83c10>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:34555/?ele=phino (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc650f83c10>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 385, in test_index_with_basic_auth_enabled_incorrect_credentials\r\n    401, requests.get(\"http://127.0.0.1:%i/?ele=phino\" % self.web_port, auth=(\"john\", \"invalid\")).status_code\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:34555/?ele=phino (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc650f83c10>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_request_stats_full_history_csv (locust.test.test_web.TestWebUIFullHistory)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 699, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 394, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 234, in request\r\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n    self.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 200, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc651040640>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:44355/stats/requests_full_history/csv (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc651040640>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 482, in test_request_stats_full_history_csv\r\n    response = requests.get(\"http://127.0.0.1:%i/stats/requests_full_history/csv\" % self.web_port)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:44355/stats/requests_full_history/csv (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc651040640>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_index_with_https (locust.test.test_web.TestWebUIWithTLS)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 169, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 96, in create_connection\r\n    raise err\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/connection.py\", line 86, in create_connection\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python3/dist-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 696, in urlopen\r\n    self._prepare_proxy(conn)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 966, in _prepare_proxy\r\n    conn.connect()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 353, in connect\r\n    conn = self._new_conn()\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connection.py\", line 181, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fc650ce5b50>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 755, in urlopen\r\n    retries = retries.increment(\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/retry.py\", line 573, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='127.0.0.1', port=33793): Max retries exceeded with url: / (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc650ce5b50>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_web.py\", line 430, in test_index_with_https\r\n    self.assertEqual(200, requests.get(\"https://127.0.0.1:%i/\" % self.web_port, verify=False).status_code)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/requests/adapters.py\", line 510, in send\r\n    raise ProxyError(e, request=request)\r\nrequests.exceptions.ProxyError: HTTPSConnectionPool(host='127.0.0.1', port=33793): Max retries exceeded with url: / (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc650ce5b50>: Failed to establish a new connection: [Errno 111] Connection refused')))\r\n\r\n======================================================================\r\nERROR: test_custom_exit_code (locust.test.test_main.LocustProcessIntegrationTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_main.py\", line 195, in test_custom_exit_code\r\n    proc = subprocess.Popen([\"locust\", \"-f\", file_path], stdout=PIPE, stderr=PIPE)\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 773, in __init__\r\n    self._execute_child(args, executable, preexec_fn, close_fds,\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 1758, in _execute_child\r\n    raise child_exception\r\nFileNotFoundError: [Errno 2] No such file or directory: 'locust'\r\n\r\n======================================================================\r\nERROR: test_default_headless_spawn_options (locust.test.test_main.LocustProcessIntegrationTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_main.py\", line 231, in test_default_headless_spawn_options\r\n    subprocess.check_output(\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 390, in check_output\r\n    with Popen(*popenargs, stdout=PIPE, **kwargs) as process:\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 773, in __init__\r\n    self._execute_child(args, executable, preexec_fn, close_fds,\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 1758, in _execute_child\r\n    raise child_exception\r\nFileNotFoundError: [Errno 2] No such file or directory: 'locust'\r\n\r\n======================================================================\r\nERROR: test_default_headless_spawn_options_with_shape (locust.test.test_main.LocustProcessIntegrationTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_main.py\", line 271, in test_default_headless_spawn_options_with_shape\r\n    subprocess.check_output(\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 390, in check_output\r\n    with Popen(*popenargs, stdout=PIPE, **kwargs) as process:\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 773, in __init__\r\n    self._execute_child(args, executable, preexec_fn, close_fds,\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 1758, in _execute_child\r\n    raise child_exception\r\nFileNotFoundError: [Errno 2] No such file or directory: 'locust'\r\n\r\n======================================================================\r\nERROR: test_headless_spawn_options_wo_run_time (locust.test.test_main.LocustProcessIntegrationTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_main.py\", line 243, in test_headless_spawn_options_wo_run_time\r\n    proc = subprocess.Popen(\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 773, in __init__\r\n    self._execute_child(args, executable, preexec_fn, close_fds,\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 1758, in _execute_child\r\n    raise child_exception\r\nFileNotFoundError: [Errno 2] No such file or directory: 'locust'\r\n\r\n======================================================================\r\nERROR: test_help_arg (locust.test.test_main.LocustProcessIntegrationTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_main.py\", line 165, in test_help_arg\r\n    subprocess.check_output(\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 390, in check_output\r\n    with Popen(*popenargs, stdout=PIPE, **kwargs) as process:\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 773, in __init__\r\n    self._execute_child(args, executable, preexec_fn, close_fds,\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 1758, in _execute_child\r\n    raise child_exception\r\nFileNotFoundError: [Errno 2] No such file or directory: 'locust'\r\n\r\n======================================================================\r\nERROR: test_html_report_option (locust.test.test_main.LocustProcessIntegrationTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_main.py\", line 376, in test_html_report_option\r\n    subprocess.check_output(\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 390, in check_output\r\n    with Popen(*popenargs, stdout=PIPE, **kwargs) as process:\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 773, in __init__\r\n    self._execute_child(args, executable, preexec_fn, close_fds,\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 1758, in _execute_child\r\n    raise child_exception\r\nFileNotFoundError: [Errno 2] No such file or directory: 'locust'\r\n\r\n======================================================================\r\nERROR: test_web_options (locust.test.test_main.LocustProcessIntegrationTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_main.py\", line 290, in test_web_options\r\n    proc = subprocess.Popen(\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 773, in __init__\r\n    self._execute_child(args, executable, preexec_fn, close_fds,\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 1758, in _execute_child\r\n    raise child_exception\r\nFileNotFoundError: [Errno 2] No such file or directory: 'locust'\r\n\r\n======================================================================\r\nERROR: test_webserver (locust.test.test_main.LocustProcessIntegrationTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_main.py\", line 218, in test_webserver\r\n    proc = subprocess.Popen([\"locust\", \"-f\", file_path], stdout=PIPE, stderr=PIPE)\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 773, in __init__\r\n    self._execute_child(args, executable, preexec_fn, close_fds,\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 1758, in _execute_child\r\n    raise child_exception\r\nFileNotFoundError: [Errno 2] No such file or directory: 'locust'\r\n\r\n======================================================================\r\nERROR: test_log_to_file (locust.test.test_log.TestLoggingOptions)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_log.py\", line 152, in test_log_to_file\r\n    output = subprocess.check_output(\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 390, in check_output\r\n    with Popen(*popenargs, stdout=PIPE, **kwargs) as process:\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 773, in __init__\r\n    self._execute_child(args, executable, preexec_fn, close_fds,\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 1758, in _execute_child\r\n    raise child_exception\r\nFileNotFoundError: [Errno 2] No such file or directory: 'locust'\r\n\r\n======================================================================\r\nERROR: test_logging_output (locust.test.test_log.TestLoggingOptions)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_log.py\", line 57, in test_logging_output\r\n    output = subprocess.check_output(\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 390, in check_output\r\n    with Popen(*popenargs, stdout=PIPE, **kwargs) as process:\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 773, in __init__\r\n    self._execute_child(args, executable, preexec_fn, close_fds,\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 1758, in _execute_child\r\n    raise child_exception\r\nFileNotFoundError: [Errno 2] No such file or directory: 'locust'\r\n\r\n======================================================================\r\nERROR: test_skip_logging (locust.test.test_log.TestLoggingOptions)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_log.py\", line 115, in test_skip_logging\r\n    output = subprocess.check_output(\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 390, in check_output\r\n    with Popen(*popenargs, stdout=PIPE, **kwargs) as process:\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 773, in __init__\r\n    self._execute_child(args, executable, preexec_fn, close_fds,\r\n  File \"/usr/lib/python3/dist-packages/gevent/subprocess.py\", line 1758, in _execute_child\r\n    raise child_exception\r\nFileNotFoundError: [Errno 2] No such file or directory: 'locust'\r\n\r\n======================================================================\r\nFAIL: test_input (locust.test.test_main.LocustProcessIntegrationTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_main.py\", line 365, in test_input\r\n    self.assertIn(\"Spawning 1 users at the rate 100 users/s\", output)\r\nAssertionError: 'Spawning 1 users at the rate 100 users/s' not found in '/bin/sh: 1: locust: not found\\n'\r\n\r\n======================================================================\r\nFAIL: test_catch_response_default_success (locust.test.test_client.TestHttpSession)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_client.py\", line 191, in test_catch_response_default_success\r\n    self.assertEqual(0, self.environment.stats.get(\"/ultra_fast\", \"GET\").num_failures)\r\nAssertionError: 0 != 1\r\n\r\n======================================================================\r\nFAIL: test_cookie (locust.test.test_client.TestHttpSession)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_client.py\", line 84, in test_cookie\r\n    self.assertEqual(200, r.status_code)\r\nAssertionError: 200 != 0\r\n\r\n======================================================================\r\nFAIL: test_delete (locust.test.test_client.TestHttpSession)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_client.py\", line 97, in test_delete\r\n    self.assertEqual(200, r.status_code)\r\nAssertionError: 200 != 0\r\n\r\n======================================================================\r\nFAIL: test_error_message_with_name_replacement (locust.test.test_client.TestHttpSession)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_client.py\", line 119, in test_error_message_with_name_replacement\r\n    self.assertIn(\"for url: replaced_url_name\", str(kwargs[\"exception\"]))\r\nAssertionError: 'for url: replaced_url_name' not found in \"HTTPConnectionPool(host='127.0.0.1', port=9): Max retries exceeded with url: http://127.0.0.1:40873/wrong_url/01 (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc6405f9280>: Failed to establish a new connection: [Errno 111] Connection refused')))\"\r\n\r\n======================================================================\r\nFAIL: test_get (locust.test.test_client.TestHttpSession)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_client.py\", line 23, in test_get\r\n    self.assertEqual(200, r.status_code)\r\nAssertionError: 200 != 0\r\n\r\n======================================================================\r\nFAIL: test_get_with_params (locust.test.test_client.TestHttpSession)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_client.py\", line 124, in test_get_with_params\r\n    self.assertEqual(200, r.status_code)\r\nAssertionError: 200 != 0\r\n\r\n======================================================================\r\nFAIL: test_head (locust.test.test_client.TestHttpSession)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_client.py\", line 91, in test_head\r\n    self.assertEqual(200, r.status_code)\r\nAssertionError: 200 != 0\r\n\r\n======================================================================\r\nFAIL: test_options (locust.test.test_client.TestHttpSession)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_client.py\", line 103, in test_options\r\n    self.assertEqual(200, r.status_code)\r\nAssertionError: 200 != 0\r\n\r\n======================================================================\r\nFAIL: test_post_redirect (locust.test.test_client.TestHttpSession)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_client.py\", line 75, in test_post_redirect\r\n    self.assertEqual(200, r.status_code)\r\nAssertionError: 200 != 0\r\n\r\n======================================================================\r\nFAIL: test_slow_redirect (locust.test.test_client.TestHttpSession)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_client.py\", line 69, in test_slow_redirect\r\n    self.assertGreater(stats.avg_response_time, 500)\r\nAssertionError: 6.6246166825294495 not greater than 500\r\n\r\n======================================================================\r\nFAIL: test_streaming_response (locust.test.test_client.TestHttpSession)\r\nTest a request to an endpoint that returns a streaming response\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/build/locust-1.4.3/locust/test/test_client.py\", line 52, in test_streaming_response\r\n    self.assertGreater(self.runner.stats.get(\"/streaming/30\", method=\"GET\").avg_response_time, 250)\r\nAssertionError: 6.219514645636082 not greater than 250\r\n\r\n----------------------------------------------------------------------\r\nRan 323 tests in 71.818s\r\n\r\nFAILED (failures=12, errors=41)\r\n```\r\n\r\nthis happens both while running inside a chroot (or usual build env, where we disable network connectivity to internet) but also on my machine.\r\n\r\n### Environment\r\n\r\n- OS: Debian unstable\r\n- Python version: 3.9\r\n- Locust version: 1.4.3\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1704/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1704/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1703", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1703/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1703/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1703/events", "html_url": "https://github.com/locustio/locust/issues/1703", "id": 805304135, "node_id": "MDU6SXNzdWU4MDUzMDQxMzU=", "number": 1703, "title": "There is a bug when the command line locust is running", "user": {"login": "ssandme", "id": 54564585, "node_id": "MDQ6VXNlcjU0NTY0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/54564585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssandme", "html_url": "https://github.com/ssandme", "followers_url": "https://api.github.com/users/ssandme/followers", "following_url": "https://api.github.com/users/ssandme/following{/other_user}", "gists_url": "https://api.github.com/users/ssandme/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssandme/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssandme/subscriptions", "organizations_url": "https://api.github.com/users/ssandme/orgs", "repos_url": "https://api.github.com/users/ssandme/repos", "events_url": "https://api.github.com/users/ssandme/events{/privacy}", "received_events_url": "https://api.github.com/users/ssandme/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-02-10T08:46:45Z", "updated_at": "2021-02-14T21:09:23Z", "closed_at": "2021-02-14T21:09:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nI have two files with exactly the same content. When running through the command line locust, only one request is always issued, but when running through locust -f, it is normal.\r\n\r\n\r\n- OS:windows10\r\n- Python version:3.9.1\r\n- Locust version:1.4.3\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):\r\n\r\n> `class UserBehavior(TaskSet):\r\n    wait_time = between(1, 2.5)\r\n    @task(1)\r\n    def apidy1(self):\r\n        pass\r\n\r\n    @task(2)\r\n    def apidy2(self):\r\n        pass\r\n`\r\n\r\nclass WebsiteUser(HttpUser):\r\n    tasks = [UserBehavior]\r\n    host = \"http://192.168.208.219\"", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1703/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1703/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1702", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1702/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1702/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1702/events", "html_url": "https://github.com/locustio/locust/issues/1702", "id": 804466449, "node_id": "MDU6SXNzdWU4MDQ0NjY0NDk=", "number": 1702, "title": "Part of response times chart lines are missing", "user": {"login": "rauttiz", "id": 15322977, "node_id": "MDQ6VXNlcjE1MzIyOTc3", "avatar_url": "https://avatars.githubusercontent.com/u/15322977?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rauttiz", "html_url": "https://github.com/rauttiz", "followers_url": "https://api.github.com/users/rauttiz/followers", "following_url": "https://api.github.com/users/rauttiz/following{/other_user}", "gists_url": "https://api.github.com/users/rauttiz/gists{/gist_id}", "starred_url": "https://api.github.com/users/rauttiz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rauttiz/subscriptions", "organizations_url": "https://api.github.com/users/rauttiz/orgs", "repos_url": "https://api.github.com/users/rauttiz/repos", "events_url": "https://api.github.com/users/rauttiz/events{/privacy}", "received_events_url": "https://api.github.com/users/rauttiz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2021-02-09T11:30:34Z", "updated_at": "2021-08-22T07:04:13Z", "closed_at": "2021-08-22T07:04:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "When locust 1.4.3 is started with -u and/or -r options without the --headless option part of the response times chart line is missing. This doesn't seem to happen if locust is started without any parameters.\r\n\r\nSteps to reproduce:\r\n1) Start locust e.g. with command: locust -u 10 -r 1\r\n2) Go to http://localhost:8089/\r\n3) Wait for a couple of seconds and then press Start Swarming\r\n3) Go to Charts and check the Response Times (ms) chart\r\n\r\nExpected result:\r\nThere is a continuous yellow line in the Response Times (ms) chart\r\n\r\nActual result:\r\nPart of the line is missing near the beginning\r\n![response_times_(ms)_1612868714](https://user-images.githubusercontent.com/15322977/107357367-a1820680-6ada-11eb-832e-4373a7121afa.png)\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1702/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1702/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1699", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1699/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1699/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1699/events", "html_url": "https://github.com/locustio/locust/issues/1699", "id": 801804361, "node_id": "MDU6SXNzdWU4MDE4MDQzNjE=", "number": 1699, "title": "on_stop method not work, tuple index out of range", "user": {"login": "mm25712423", "id": 20388703, "node_id": "MDQ6VXNlcjIwMzg4NzAz", "avatar_url": "https://avatars.githubusercontent.com/u/20388703?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mm25712423", "html_url": "https://github.com/mm25712423", "followers_url": "https://api.github.com/users/mm25712423/followers", "following_url": "https://api.github.com/users/mm25712423/following{/other_user}", "gists_url": "https://api.github.com/users/mm25712423/gists{/gist_id}", "starred_url": "https://api.github.com/users/mm25712423/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mm25712423/subscriptions", "organizations_url": "https://api.github.com/users/mm25712423/orgs", "repos_url": "https://api.github.com/users/mm25712423/repos", "events_url": "https://api.github.com/users/mm25712423/events{/privacy}", "received_events_url": "https://api.github.com/users/mm25712423/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1003994742, "node_id": "MDU6TGFiZWwxMDAzOTk0NzQy", "url": "https://api.github.com/repos/locustio/locust/labels/waiting%20on%20contributor", "name": "waiting on contributor", "color": "5319e7", "default": false, "description": ""}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2021-02-05T03:13:50Z", "updated_at": "2021-05-01T01:56:35Z", "closed_at": "2021-05-01T01:56:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "I think the problem is the request/response timeout. But it does not show the assertion failed. And it needs to be shut down normally\r\n\r\n### Describe the bug\r\n* Set Locust users number: 20\r\n* Set spawn rate: 10\r\n* Set run time: 90 secs\r\n\r\nProblems: \r\n* Some users did not call the on_stop method\r\n* The task method is still called after on_stop called\r\n* Exhausted my time limit (90 seconds)\r\n\r\n### Expected behavior\r\nAll users call on_stop and shutdown locust.\r\n\r\n### Actual behavior\r\n\r\nI tried to interrupt the process because it never stops and it shows:\r\n```shell\r\n[2021-02-05 02:45:09,267] e34866ebd6ad/INFO/locust.main: Running teardowns...\r\n[2021-02-05 02:45:09,267] e34866ebd6ad/INFO/locust.main: Shutting down (exit code 1), bye.\r\n[2021-02-05 02:45:09,267] e34866ebd6ad/INFO/locust.main: Cleaning up runner...\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.8/site-packages/locust/main.py\", line 426, in main\r\n    main_greenlet.join()\r\n  File \"/usr/local/lib/python3.8/site-packages/gevent/pool.py\", line 430, in join\r\n    result = self._empty_event.wait(timeout=timeout)\r\n  File \"src/gevent/event.py\", line 163, in gevent._gevent_cevent.Event.wait\r\n  File \"src/gevent/_abstract_linkable.py\", line 521, in gevent._gevent_c_abstract_linkable.AbstractLinkable._wait\r\n  File \"src/gevent/_abstract_linkable.py\", line 487, in gevent._gevent_c_abstract_linkable.AbstractLinkable._wait_core\r\n  File \"src/gevent/_abstract_linkable.py\", line 490, in gevent._gevent_c_abstract_linkable.AbstractLinkable._wait_core\r\n  File \"src/gevent/_abstract_linkable.py\", line 442, in gevent._gevent_c_abstract_linkable.AbstractLinkable._AbstractLinkable__wait_to_be_notified\r\n  File \"src/gevent/_abstract_linkable.py\", line 451, in gevent._gevent_c_abstract_linkable.AbstractLinkable._switch_to_hub\r\n  File \"src/gevent/_greenlet_primitives.py\", line 61, in gevent._gevent_c_greenlet_primitives.SwitchOutGreenletWithLoop.switch\r\n  File \"src/gevent/_greenlet_primitives.py\", line 65, in gevent._gevent_c_greenlet_primitives.SwitchOutGreenletWithLoop.switch\r\n  File \"src/gevent/_gevent_c_greenlet_primitives.pxd\", line 35, in gevent._gevent_c_greenlet_primitives._greenlet_switch\r\nKeyboardInterrupt\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/locust\", line 8, in <module>\r\n    sys.exit(main())\r\n  File \"/usr/local/lib/python3.8/site-packages/locust/main.py\", line 433, in main\r\n    shutdown()\r\n  File \"/usr/local/lib/python3.8/site-packages/locust/main.py\", line 408, in shutdown\r\n    runner.quit()\r\n  File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 362, in quit\r\n    self.stop()\r\n  File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 413, in stop\r\n    super().stop()\r\n  File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 354, in stop\r\n    self.stop_users(self.user_count)\r\n  File \"/usr/local/lib/python3.8/site-packages/locust/runners.py\", line 223, in stop_users\r\n    user = g.args[0]\r\nIndexError: tuple index out of range\r\n```\r\n\r\n### Steps to reproduce\r\n1. Inherit HttpUser class\r\n2. on_start -> Login user and setup\r\n3. on_stop -> Delete user and teardown\r\n4. task -> do something will be take much time\r\n\r\n### Environment\r\n\r\n- OS:\r\n- Docker version: 19.03.14\r\n- Locust version: 1.4.3\r\n- Locust command line that you ran: \r\n`docker run -it --rm -v /home/users/workspace/tests/locust/:/mnt/locust locustio/locust:1.4.3 -f /mnt/locust/load_test.py -u 20-r 10 -t 90  -headless`", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1699/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1699/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1694", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1694/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1694/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1694/events", "html_url": "https://github.com/locustio/locust/issues/1694", "id": 797919715, "node_id": "MDU6SXNzdWU3OTc5MTk3MTU=", "number": 1694, "title": "when i run locust with workers mode.different workers use the same data.", "user": {"login": "fcy197778770", "id": 68221995, "node_id": "MDQ6VXNlcjY4MjIxOTk1", "avatar_url": "https://avatars.githubusercontent.com/u/68221995?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fcy197778770", "html_url": "https://github.com/fcy197778770", "followers_url": "https://api.github.com/users/fcy197778770/followers", "following_url": "https://api.github.com/users/fcy197778770/following{/other_user}", "gists_url": "https://api.github.com/users/fcy197778770/gists{/gist_id}", "starred_url": "https://api.github.com/users/fcy197778770/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fcy197778770/subscriptions", "organizations_url": "https://api.github.com/users/fcy197778770/orgs", "repos_url": "https://api.github.com/users/fcy197778770/repos", "events_url": "https://api.github.com/users/fcy197778770/events{/privacy}", "received_events_url": "https://api.github.com/users/fcy197778770/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-02-01T03:37:09Z", "updated_at": "2021-02-16T07:37:10Z", "closed_at": "2021-02-16T07:37:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "![image](https://user-images.githubusercontent.com/68221995/106411912-5f751700-6481-11eb-9e45-5adfd0f0535f.png)\r\nbecause different workers use the same data. that  i cant use workers mode .that  i can  get a lot of users. its a big problem\r\nat least it shoul  use the  different data at d same time \r\n\r\n![image](https://user-images.githubusercontent.com/68221995/106411966-829fc680-6481-11eb-85b8-93553fe1d9f1.png)\r\nwhen i use the workers mode .sometimes it will disconnect  one workers ", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1694/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1694/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1693", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1693/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1693/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1693/events", "html_url": "https://github.com/locustio/locust/issues/1693", "id": 796920081, "node_id": "MDU6SXNzdWU3OTY5MjAwODE=", "number": 1693, "title": "New HTML reports are missing data", "user": {"login": "benc-uk", "id": 14982936, "node_id": "MDQ6VXNlcjE0OTgyOTM2", "avatar_url": "https://avatars.githubusercontent.com/u/14982936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/benc-uk", "html_url": "https://github.com/benc-uk", "followers_url": "https://api.github.com/users/benc-uk/followers", "following_url": "https://api.github.com/users/benc-uk/following{/other_user}", "gists_url": "https://api.github.com/users/benc-uk/gists{/gist_id}", "starred_url": "https://api.github.com/users/benc-uk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/benc-uk/subscriptions", "organizations_url": "https://api.github.com/users/benc-uk/orgs", "repos_url": "https://api.github.com/users/benc-uk/repos", "events_url": "https://api.github.com/users/benc-uk/events{/privacy}", "received_events_url": "https://api.github.com/users/benc-uk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2021-01-29T14:20:12Z", "updated_at": "2022-04-22T16:15:16Z", "closed_at": "2021-05-10T07:15:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nNew `--html` report option generates HTML report with data missing. The CSV output contains many datapoints not shown in the HTML\r\n\r\n### Expected behavior\r\nAll data is is shown in the HTML and matches the CSV\r\n\r\n### Actual behavior\r\nMuch of the data missing\r\n\r\nSee screenshots below\r\n\r\nThis is a 3 minute load test of 500 users ramping up 8 per second\r\nLocust report, the whole of the ramp up section of data is missing\r\n![image](https://user-images.githubusercontent.com/14982936/106285918-f43b0300-623c-11eb-9077-bb54df6f3bb5.png)\r\n\r\nThis graph is from Excel generated from the CSVs\r\n![image](https://user-images.githubusercontent.com/14982936/106285840-dc637f00-623c-11eb-8463-adf08cca4b17.png)\r\n\r\n\r\n### Steps to reproduce\r\n- Run locust with `--html` and `--csv` `--csv-full-history` options\r\n- Look at generated HTML\r\n- Look at CSV\r\n\r\n### Environment\r\n\r\n- OS: Linux Ubuntu 20.04\r\n- Python version: 3.8.5\r\n- Locust version: 1.4.2 \r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1693/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1693/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1690", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1690/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1690/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1690/events", "html_url": "https://github.com/locustio/locust/issues/1690", "id": 795037967, "node_id": "MDU6SXNzdWU3OTUwMzc5Njc=", "number": 1690, "title": "Charts not working well in version 1.4.2", "user": {"login": "mthaak", "id": 6129322, "node_id": "MDQ6VXNlcjYxMjkzMjI=", "avatar_url": "https://avatars.githubusercontent.com/u/6129322?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mthaak", "html_url": "https://github.com/mthaak", "followers_url": "https://api.github.com/users/mthaak/followers", "following_url": "https://api.github.com/users/mthaak/following{/other_user}", "gists_url": "https://api.github.com/users/mthaak/gists{/gist_id}", "starred_url": "https://api.github.com/users/mthaak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mthaak/subscriptions", "organizations_url": "https://api.github.com/users/mthaak/orgs", "repos_url": "https://api.github.com/users/mthaak/repos", "events_url": "https://api.github.com/users/mthaak/events{/privacy}", "received_events_url": "https://api.github.com/users/mthaak/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-01-27T11:57:22Z", "updated_at": "2021-01-28T00:29:58Z", "closed_at": "2021-01-28T00:29:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi Locust developers,\r\n\r\nI discovered your tool today and it looks like exactly what I need. However, I found that in version 1.4.2 (release 21 hours ago) the charts are not working well.\r\n\r\n### Describe the bug\r\nThe _Reponse Times (ms)_ and _Number of Users_ charts don't update at all. The _Total Requests per Second_ chart updates but the tooltip values are `undefined`. This only happens in Locust 1.4.2. In Locust 1.4.1 the charts work perfectly.\r\n\r\n### Actual behavior\r\nLocust 1.4.2:\r\n![image](https://user-images.githubusercontent.com/6129322/105986912-d1beb380-609d-11eb-9b01-10f88cfa9607.png)\r\n\r\nThis is what I see in my browser's dev console:\r\n![image](https://user-images.githubusercontent.com/6129322/105987011-f31f9f80-609d-11eb-83bc-dd02a983583c.png)\r\n(many many times the same error)\r\n\r\n### Expected behavior\r\nExact same set up but then using Locust 1.4.1:\r\n![image](https://user-images.githubusercontent.com/6129322/105985266-873c3780-609b-11eb-8fbd-10e6dc0d32ac.png)\r\n\r\n### Steps to reproduce\r\n_See environment below_\r\n\r\n### Environment\r\n\r\n- OS: Windows 10\r\n- Python version: 3.8.5\r\n- Locust version: 1.4.2\r\n- Locust command line that you ran: `locust --host=...`\r\n- Locust file contents (anonymized if necessary):\r\n```\r\nfrom locust import HttpUser, task, between\r\n\r\nclass QuickstartUser(HttpUser):\r\n    wait_time = between(1, 2.5)\r\n\r\n    @task\r\n    def get_1(self):\r\n        self.client.get(...)\r\n\r\n    @task\r\n    def get_2(self):\r\n        self.client.get(...)\r\n\r\n    @task\r\n    def get_3(self):\r\n        self.client.get(...)\r\n\r\n    def on_start(self):\r\n        self.client.headers['Authorization'] = f'Bearer {AUTH_TOKEN}'\r\n```\r\n\r\n50 total users spawned at 10/s", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1690/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1690/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1689", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1689/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1689/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1689/events", "html_url": "https://github.com/locustio/locust/issues/1689", "id": 793925870, "node_id": "MDU6SXNzdWU3OTM5MjU4NzA=", "number": 1689, "title": "Idle user when tasks are disabled/enabled with @tag", "user": {"login": "bamanuel", "id": 1187867, "node_id": "MDQ6VXNlcjExODc4Njc=", "avatar_url": "https://avatars.githubusercontent.com/u/1187867?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bamanuel", "html_url": "https://github.com/bamanuel", "followers_url": "https://api.github.com/users/bamanuel/followers", "following_url": "https://api.github.com/users/bamanuel/following{/other_user}", "gists_url": "https://api.github.com/users/bamanuel/gists{/gist_id}", "starred_url": "https://api.github.com/users/bamanuel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bamanuel/subscriptions", "organizations_url": "https://api.github.com/users/bamanuel/orgs", "repos_url": "https://api.github.com/users/bamanuel/repos", "events_url": "https://api.github.com/users/bamanuel/events{/privacy}", "received_events_url": "https://api.github.com/users/bamanuel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2115072627, "node_id": "MDU6TGFiZWwyMTE1MDcyNjI3", "url": "https://api.github.com/repos/locustio/locust/labels/non-critical", "name": "non-critical", "color": "c4e4c9", "default": false, "description": ""}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-01-26T04:50:53Z", "updated_at": "2023-02-16T15:31:16Z", "closed_at": "2021-04-29T01:53:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n\r\n### Describe the bug\r\nWhen tasks are included/excluded using _--tags_/_--exclude-tags_ at runtime, it is possible that certain users created would not have any tasks to run. In this case, each time the user without a task is executed, it shows an error `Exception: No tasks defined on...`\r\n\r\n### Expected behavior\r\nThe error should not be thrown since the user's task has been disabled. Preferably the user should be idled or, even better, should not be instantiated when there are not tasks available.\r\n\r\n### Actual behavior\r\nThe user keeps attempting to execute task (which it doesn't find). So will print error: `Exception: No tasks defined on...`\r\n\r\n### Steps to reproduce\r\n```\r\nfrom locust import User, SequentialTaskSet, tag, task, HttpUser\r\n\r\n@tag('AdminPage1')\r\nclass AdminPage1(SequentialTaskSet):\r\n    @task\r\n    def admin_task1(self):\r\n        pass\r\n\r\n@tag('UserPage1')\r\nclass UserPage1(SequentialTaskSet):\r\n    @task\r\n    def admin_task1(self):\r\n        pass\r\n\r\nclass AdminUser(HttpUser):\r\n    tasks = [AdminPage1]\r\n\r\nclass EndUser(HttpUser):\r\n    tasks = [UserPage1]\r\n```\r\n\r\n`$ locust --host localhost --only-summary --headless --users 2 --tag UserPage1`\r\n\r\nError does not occur if tag argument is removed from the command.\r\n\r\n### Environment\r\n\r\n- OS: Windows 7\r\n- Python version: 3.7.3\r\n- Locust version: 1.4.1\r\n- Locust command line that you ran: `locust --host localhost --only-summary --headless --users 2 --tag UserPage1`\r\n- Locust file contents (anonymized if necessary): N/A posted above", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1689/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1689/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1684", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1684/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1684/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1684/events", "html_url": "https://github.com/locustio/locust/issues/1684", "id": 791040647, "node_id": "MDU6SXNzdWU3OTEwNDA2NDc=", "number": 1684, "title": "create_master_runner does not load the task to test the qps", "user": {"login": "heimao63531", "id": 11887111, "node_id": "MDQ6VXNlcjExODg3MTEx", "avatar_url": "https://avatars.githubusercontent.com/u/11887111?v=4", "gravatar_id": "", "url": "https://api.github.com/users/heimao63531", "html_url": "https://github.com/heimao63531", "followers_url": "https://api.github.com/users/heimao63531/followers", "following_url": "https://api.github.com/users/heimao63531/following{/other_user}", "gists_url": "https://api.github.com/users/heimao63531/gists{/gist_id}", "starred_url": "https://api.github.com/users/heimao63531/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/heimao63531/subscriptions", "organizations_url": "https://api.github.com/users/heimao63531/orgs", "repos_url": "https://api.github.com/users/heimao63531/repos", "events_url": "https://api.github.com/users/heimao63531/events{/privacy}", "received_events_url": "https://api.github.com/users/heimao63531/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-01-21T12:45:15Z", "updated_at": "2021-01-22T07:28:26Z", "closed_at": "2021-01-22T06:12:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n\r\ni start an http server in my local env and try to run the locust in distribute mode in 2 process. i can run it with locust cmdlet with \r\nlocust -f quickStart.py --master -r 10 -u 1 --host http://127.0.0.1:8999\r\nlocust -f quickStart.py --worker --master-host 127.0.0.1\r\n\r\nbut  it fail with the lib code. show as following\r\n\r\n**master code:**\r\n\r\nclass QuickstartUser(HttpUser):\r\n\r\n    wait_time = between(1, 3)\r\n    host = \"http://127.0.0.1:8999\"\r\n    @task\r\n    def my_task(self):\r\n        self.client.get(\"/v1/services/1cd97a29-5ccb-4821-a5bf-77e048b82012/basic\")\r\nenv = Environment()\r\nenv.create_worker_runner(master_host=\"127.0.0.1\", master_port=5557)\r\ngevent.spawn(stats_printer(env.stats))\r\nenv.runner.start(1, spawn_rate=10)\r\ngevent.spawn_later(60, lambda: env.runner.quit())\r\nenv.runner.greenlet.join()\r\n\r\n**work code**\r\n\r\nclass QuickstartUser(HttpUser):\r\n\r\n    wait_time = between(1, 3)\r\n    host = \"http://10.24.6.201:8999\"\r\n\r\n    @task\r\n    def my_task(self):\r\n        self.client.get(\"/v1/services/1cd97a29-5ccb-4821-a5bf-77e048b82012/basic\")\r\n\r\n    @task\r\n    def task_404(self):\r\n        self.client.get(\"/v1/services?accountId=default\")\r\n\r\nenv = Environment(user_classes=[QuickstartUser], host=\"http://10.24.6.201:8999\")\r\nenv.create_worker_runner(master_host=\"10.24.6.201\", master_port=5557)\r\ngevent.spawn(stats_printer(env.stats))\r\nenv.runner.greenlet.join()\r\n\r\n### Expected behavior\r\n\r\nhere is the result from cmdlet.\r\nName                                                          # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n GET /v1/services/1cd97a29-5ccb-4821-a5bf-77e048b82012/basic        0     0(0.00%)  |       0       0       0       0  |    0.00    0.00\r\n GET /v1/services?accountId=default                                 0     0(0.00%)  |       0       0       0       0  |    0.00    0.00\r\n\r\n### Actual behavior\r\n\r\nhere is the result from the lib code\r\nlocust.runners: Client '' reported as ready. Currently 1 clients ready to swarm.\r\n\r\nName                                                          # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                         0     0(0.00%)  |       0       0       0       0  |    0.00    0.00\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: centos6\r\n- Python version: 3.7\r\n- Locust version: 1.4.1\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1684/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1684/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1682", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1682/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1682/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1682/events", "html_url": "https://github.com/locustio/locust/issues/1682", "id": 790055930, "node_id": "MDU6SXNzdWU3OTAwNTU5MzA=", "number": 1682, "title": "Locust failed to launch if installed from latest revision", "user": {"login": "andrii-rymar", "id": 23473680, "node_id": "MDQ6VXNlcjIzNDczNjgw", "avatar_url": "https://avatars.githubusercontent.com/u/23473680?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andrii-rymar", "html_url": "https://github.com/andrii-rymar", "followers_url": "https://api.github.com/users/andrii-rymar/followers", "following_url": "https://api.github.com/users/andrii-rymar/following{/other_user}", "gists_url": "https://api.github.com/users/andrii-rymar/gists{/gist_id}", "starred_url": "https://api.github.com/users/andrii-rymar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andrii-rymar/subscriptions", "organizations_url": "https://api.github.com/users/andrii-rymar/orgs", "repos_url": "https://api.github.com/users/andrii-rymar/repos", "events_url": "https://api.github.com/users/andrii-rymar/events{/privacy}", "received_events_url": "https://api.github.com/users/andrii-rymar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-01-20T14:58:13Z", "updated_at": "2021-01-21T07:31:05Z", "closed_at": "2021-01-21T07:30:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nLocust failed to launch if being installed from the latest master commit (b2721592075676b87f62923b3936161619c230ec). Previous revision works just fine (3db9724d765b5f7b15e472f164e4d5e131bca14f).\r\n\r\n### Expected behavior\r\nCorrect launch\r\n\r\n### Actual behavior\r\n```\r\n  File \".../python3.9/site-packages/locust/user/users.py\", line 108, in User\r\n    environment: Environment = None\r\nNameError: name 'Environment' is not defined\r\n```\r\n\r\n### Steps to reproduce\r\n1. Install locust from b2721592075676b87f62923b3936161619c230ec revision\r\n2. Run simple test (locustfile.py):\r\n```\r\nfrom locust import HttpUser, task, constant\r\n\r\n\r\nclass TestUser(HttpUser):\r\n    host = \"https://google.com\"\r\n    wait_time = constant(1)\r\n\r\n    @task\r\n    def test_query(self):\r\n        self.client.get(\"/search?q=test\")\r\n\r\n```\r\n\r\n### Environment\r\n\r\n- OS: macOS 10.15.7\r\n- Python version: 3.9.0\r\n- Locust version: 1.4.1 (b2721592075676b87f62923b3936161619c230ec)\r\n- Locust command line that you ran: locust --headless -u 1 -r 1 --run-time 5s", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1682/reactions", "total_count": 2, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1682/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1677", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1677/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1677/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1677/events", "html_url": "https://github.com/locustio/locust/issues/1677", "id": 789163471, "node_id": "MDU6SXNzdWU3ODkxNjM0NzE=", "number": 1677, "title": "Report charts plot data points after the test has ended", "user": {"login": "TheBronx", "id": 939664, "node_id": "MDQ6VXNlcjkzOTY2NA==", "avatar_url": "https://avatars.githubusercontent.com/u/939664?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TheBronx", "html_url": "https://github.com/TheBronx", "followers_url": "https://api.github.com/users/TheBronx/followers", "following_url": "https://api.github.com/users/TheBronx/following{/other_user}", "gists_url": "https://api.github.com/users/TheBronx/gists{/gist_id}", "starred_url": "https://api.github.com/users/TheBronx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TheBronx/subscriptions", "organizations_url": "https://api.github.com/users/TheBronx/orgs", "repos_url": "https://api.github.com/users/TheBronx/repos", "events_url": "https://api.github.com/users/TheBronx/events{/privacy}", "received_events_url": "https://api.github.com/users/TheBronx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-01-19T16:20:41Z", "updated_at": "2021-01-19T19:58:50Z", "closed_at": "2021-01-19T19:58:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "![imagen](https://user-images.githubusercontent.com/939664/105061092-665f5b00-5a79-11eb-862d-7f4e8770e11e.png)\r\n![imagen](https://user-images.githubusercontent.com/939664/105061163-7ecf7580-5a79-11eb-9c6b-01e8aa423fc9.png)\r\n\r\n### Describe the bug\r\nAfter stopping a test on the UI, when I click on \"Download report\" the plots show a date range between _test-start_ and _now_, instead of _test-start_ and _test-end_. \r\n\r\n### Expected behavior\r\nAll the plots should only contain data between _test-start_ and _test-end_ dates I guess.\r\n\r\n### Actual behavior\r\nAll three plots in the report continue plotting either 0 (Response Times and Number of Users) or RPS (Total Requests per Second) after the test has ended up until the moment you open or refresh the Download Report page.\r\n\r\n### Steps to reproduce\r\n\r\n- Start the UI with any test file (the Quick Start one for example: https://docs.locust.io/en/stable/quickstart.html): `locust -f example.py`\r\n- Parameters don't matter as far as I know, just run the test\r\n- Let it run for a few seconds\r\n- Stop it\r\n- Wait for 10 or 20 seconds so it is easier to see the bug\r\n- Click on **Download Data -> Download Report**\r\n- Notice the flatlines on the plots and the date ranges, extending way after the test was stopped. If you refresh this page (the report) the plots just keep growing.\r\n- Interestingly enough, the start and end dates at the top of the report are correct\r\n\r\n### Environment\r\n\r\n- OS: Ubuntu 20.04\r\n- Browser: Firefox 84.0.2 and Chromium 87.0.4280.141\r\n- Python version: 3.8.5\r\n- Locust version: 1.4.1\r\n- Locust command line that you ran: `locust -f example.py`\r\n- Locust file contents (anonymized if necessary): \r\n\r\n```\r\nimport time\r\nfrom locust import HttpUser, task\r\n\r\nclass QuickstartUser(HttpUser):\r\n    @task\r\n    def hello_world(self):\r\n        self.client.get(\"/hello\")\r\n        self.client.get(\"/world\")\r\n\r\n    @task(3)\r\n    def view_item(self):\r\n        for item_id in range(10):\r\n            self.client.get(f\"/item?id={item_id}\", name=\"/item\")\r\n            time.sleep(1)\r\n\r\n    def on_start(self):\r\n        self.client.post(\"/login\", json={\"username\":\"foo\", \"password\":\"bar\"})\r\n```\r\n\r\nBTW I think this is a great tool, I have just discovered it and I am loving it! :heart: ", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1677/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1677/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1676", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1676/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1676/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1676/events", "html_url": "https://github.com/locustio/locust/issues/1676", "id": 788048382, "node_id": "MDU6SXNzdWU3ODgwNDgzODI=", "number": 1676, "title": "GRPC compatibility : Locust load test throws greenlet.GreenletExit exception on reaching test time limit", "user": {"login": "pranavgupta1234", "id": 21027310, "node_id": "MDQ6VXNlcjIxMDI3MzEw", "avatar_url": "https://avatars.githubusercontent.com/u/21027310?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pranavgupta1234", "html_url": "https://github.com/pranavgupta1234", "followers_url": "https://api.github.com/users/pranavgupta1234/followers", "following_url": "https://api.github.com/users/pranavgupta1234/following{/other_user}", "gists_url": "https://api.github.com/users/pranavgupta1234/gists{/gist_id}", "starred_url": "https://api.github.com/users/pranavgupta1234/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pranavgupta1234/subscriptions", "organizations_url": "https://api.github.com/users/pranavgupta1234/orgs", "repos_url": "https://api.github.com/users/pranavgupta1234/repos", "events_url": "https://api.github.com/users/pranavgupta1234/events{/privacy}", "received_events_url": "https://api.github.com/users/pranavgupta1234/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 19, "created_at": "2021-01-18T08:30:00Z", "updated_at": "2021-05-19T16:26:35Z", "closed_at": "2021-05-05T10:35:36Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nLocust load test throws greenlet.GreenletExit exception on reaching test time limit while testing GRPC based services. To monkey patch GRPC with gevent I am using grpc's:\r\n```\r\nimport grpc.experimental.gevent as grpc_gevent\r\ngrpc_gevent.init_gevent()\r\n```\r\nbut no luck.\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nShould gracefully stop all greenlets and generate the necessary outputs.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nTest keeps on generating load, does not stop, has to be stopped via CTRL+C Keyboard Interrupt.\r\nThrown exception:\r\n```\r\n[2021-01-18 13:40:47,715] C02CD0BNMD6N/INFO/locust.main: Run time limit set to 30 seconds\r\n[2021-01-18 13:40:47,715] C02CD0BNMD6N/INFO/locust.main: Starting Locust 1.4.1\r\n[2021-01-18 13:40:47,716] C02CD0BNMD6N/DEBUG/locust.runners: Updating state to 'spawning', old state was 'ready'\r\n[2021-01-18 13:40:47,716] C02CD0BNMD6N/INFO/locust.runners: Spawning 5 users at the rate 3 users/s (0 users already running)...\r\n\r\n a bunch of related stats generated .......\r\n\r\n[2021-01-18 13:41:17,717] C02CD0BNMD6N/INFO/locust.main: Time limit reached. Stopping Locust.\r\n[2021-01-18 13:41:17,717] C02CD0BNMD6N/DEBUG/locust.runners: Stopping all users\r\n[2021-01-18 13:41:17,718] C02CD0BNMD6N/DEBUG/locust.runners: Updating state to 'cleanup', old state was 'running'\r\n[2021-01-18 13:41:17,718] C02CD0BNMD6N/INFO/locust.runners: Stopping 5 users\r\n[2021-01-18 13:41:17,718] C02CD0BNMD6N/DEBUG/locust.runners: Stopping Greenlet-0\r\n[2021-01-18 13:41:17,718] C02CD0BNMD6N/DEBUG/locust.runners: Stopping Greenlet-1\r\n[2021-01-18 13:41:17,718] C02CD0BNMD6N/DEBUG/locust.runners: Stopping Greenlet-2\r\n[2021-01-18 13:41:17,718] C02CD0BNMD6N/DEBUG/locust.runners: Stopping Greenlet-3\r\n[2021-01-18 13:41:17,718] C02CD0BNMD6N/DEBUG/locust.runners: Stopping Greenlet-4\r\n\r\nTraceback (most recent call last):\r\n  File \"src/gevent/event.py\", line 159, in gevent._gevent_cevent.Event.wait\r\n  File \"src/gevent/_abstract_linkable.py\", line 437, in gevent._gevent_c_abstract_linkable.AbstractLinkable._wait\r\n  File \"src/gevent/_abstract_linkable.py\", line 403, in gevent._gevent_c_abstract_linkable.AbstractLinkable._wait_core\r\n  File \"src/gevent/_abstract_linkable.py\", line 406, in gevent._gevent_c_abstract_linkable.AbstractLinkable._wait_core\r\n  File \"src/gevent/_abstract_linkable.py\", line 358, in gevent._gevent_c_abstract_linkable.AbstractLinkable._AbstractLinkable__wait_to_be_notified\r\n  File \"src/gevent/_abstract_linkable.py\", line 367, in gevent._gevent_c_abstract_linkable.AbstractLinkable._switch_to_hub\r\n  File \"src/gevent/_greenlet_primitives.py\", line 61, in gevent._gevent_c_greenlet_primitives.SwitchOutGreenletWithLoop.switch\r\n  File \"src/gevent/_greenlet_primitives.py\", line 65, in gevent._gevent_c_greenlet_primitives.SwitchOutGreenletWithLoop.switch\r\n  File \"src/gevent/_gevent_c_greenlet_primitives.pxd\", line 35, in gevent._gevent_c_greenlet_primitives._greenlet_switch\r\ngreenlet.GreenletExit\r\nException ignored in: 'grpc._cython.cygrpc.run_loop'\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\nI am using locust to test bunch of GRPC services and tasks involve bunch of GRPC calls.\r\n\r\n### Environment\r\n\r\n- OS: MacOS Catalina 10.15.7\r\n- Python version: 3.8\r\n- Locust version: 1.4.1, grpcio version : 1.30.0\r\n- Locust command line that you ran: locust --host myhost -f locustfile --headless -u 5 -r 3 -t 30s MyLocustClass ", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1676/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1676/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1672", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1672/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1672/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1672/events", "html_url": "https://github.com/locustio/locust/issues/1672", "id": 781827725, "node_id": "MDU6SXNzdWU3ODE4Mjc3MjU=", "number": 1672, "title": "Proxies provision in FastHTTPUser Approach", "user": {"login": "vnbal", "id": 75733554, "node_id": "MDQ6VXNlcjc1NzMzNTU0", "avatar_url": "https://avatars.githubusercontent.com/u/75733554?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vnbal", "html_url": "https://github.com/vnbal", "followers_url": "https://api.github.com/users/vnbal/followers", "following_url": "https://api.github.com/users/vnbal/following{/other_user}", "gists_url": "https://api.github.com/users/vnbal/gists{/gist_id}", "starred_url": "https://api.github.com/users/vnbal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vnbal/subscriptions", "organizations_url": "https://api.github.com/users/vnbal/orgs", "repos_url": "https://api.github.com/users/vnbal/repos", "events_url": "https://api.github.com/users/vnbal/events{/privacy}", "received_events_url": "https://api.github.com/users/vnbal/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-01-08T04:09:30Z", "updated_at": "2023-04-05T22:18:35Z", "closed_at": "2021-02-16T08:25:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "Describe the bug:\r\nIn HTTPUser, we can give Proxies in self.client.get(url, proxies=proxies) where proxies is configured as JSON (e.g. {\"http\": \"testmedmain.company.com:80\",\"https\":\"testmedmain.company.com:443\",} ).\r\nHowever, same is not working when we use fasthttpuser. It says \"Connection Refused\". Please let us know the steps to configure Proxie property as JSON in Self.client.get in FastHTTPUSer.\r\n\r\nExpected behavior:\r\nProxy setting should work in FastHTTPUser when we configure same manner as in HTTPUser\r\n\r\nActual behavior:\r\nConnection Refused message appears. Same approach works fine with HTTPUser\r\n\r\n\r\n\r\n### Environment\r\n\r\n- OS: MAC\r\n- Python version: Python 3.6\r\n- Locust version:1.4.1\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1672/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1672/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1667", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1667/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1667/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1667/events", "html_url": "https://github.com/locustio/locust/issues/1667", "id": 772826026, "node_id": "MDU6SXNzdWU3NzI4MjYwMjY=", "number": 1667, "title": "FastHttpUser  error: only SOCK_STREAM type sockets are supported", "user": {"login": "hdzys", "id": 45445106, "node_id": "MDQ6VXNlcjQ1NDQ1MTA2", "avatar_url": "https://avatars.githubusercontent.com/u/45445106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hdzys", "html_url": "https://github.com/hdzys", "followers_url": "https://api.github.com/users/hdzys/followers", "following_url": "https://api.github.com/users/hdzys/following{/other_user}", "gists_url": "https://api.github.com/users/hdzys/gists{/gist_id}", "starred_url": "https://api.github.com/users/hdzys/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hdzys/subscriptions", "organizations_url": "https://api.github.com/users/hdzys/orgs", "repos_url": "https://api.github.com/users/hdzys/repos", "events_url": "https://api.github.com/users/hdzys/events{/privacy}", "received_events_url": "https://api.github.com/users/hdzys/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-12-22T10:18:58Z", "updated_at": "2020-12-25T15:04:08Z", "closed_at": "2020-12-25T15:04:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "The code:\r\n\r\n`import json\r\nfrom locust import SequentialTaskSet, task, constant\r\nfrom locust.contrib.fasthttp import **FastHttpUser**\r\nfrom locust import LoadTestShape\r\n\r\nclass Hong(SequentialTaskSet):\r\n    @task\r\n    def api_community_list(self):\r\n        headers = {'Content-Type': 'application/x-www-form-urlencoded','tenantId': '22', \"host\": \"countyrmt-test-api.thecover.cn\"}\r\n        r_url = \"/community/list\"\r\n        data = json.dumps({\"page_size\": 10, \"type\": 1})\r\n        requests_data = {\"data\": data, 'deviceid': '1B722294-E6B7-4AB0-B60A-84AB9972BBCA-ODBD', 'token': 'e3620bae8bfb4d56902701466901ee93', 'optionName': \"test\"}\r\n        with self.client.post(r_url, data=requests_data, catch_response=True, name=r_url, headers=**headers**) as r:\r\n            if r.content == b\"\":\r\n                r.failure(\"No data\")\r\n            if r.status_code != 200:\r\n                em = \"request error --\" + str(r.status_code)\r\n                r.failure(em)\r\n\r\nclass LocustHljLocust(FastHttpUser):\r\n    host = \"http://123.4.28.255:80\"\r\n    wait_time = constant(0)\r\n    tasks = {Hong: 1}`\r\n\r\nAn error occurred while passing headers in the request parameter:\r\n\r\n[2020-12-22 17:26:08,722] thecovercs/ERROR/locust.user.task: only SOCK_STREAM type sockets are supported\r\nTraceback (most recent call last):\r\n  File \"d:\\python\\lib\\site-packages\\locust\\user\\task.py\", line 290, in run\r\n    self.execute_next_task()\r\n  File \"d:\\python\\lib\\site-packages\\locust\\user\\task.py\", line 315, in execute_next_task\r\n    self.execute_task(self._task_queue.pop(0))\r\n  File \"d:\\python\\lib\\site-packages\\locust\\user\\task.py\", line 327, in execute_task\r\n    task(self)\r\n  File \"D:\\thecover_project\\api_locust\\locust_view\\hongya\\locust_hy.py\", line 27, in api_community_list\r\n    with self.client.post(r_url, data=requests_data, catch_response=True, name=r_url, headers=headers) as r:\r\n  File \"d:\\python\\lib\\site-packages\\locust\\contrib\\fasthttp.py\", line 261, in post\r\n    return self.request(\"POST\", path, data=data, **kwargs)\r\n  File \"d:\\python\\lib\\site-packages\\locust\\contrib\\fasthttp.py\", line 189, in request\r\n    response = self._send_request_safe_mode(method, url, payload=data, headers=headers, **kwargs)\r\n  File \"d:\\python\\lib\\site-packages\\locust\\contrib\\fasthttp.py\", line 109, in _send_request_safe_mode\r\n    return self.client.urlopen(url, method=method, **kwargs)\r\n  File \"d:\\python\\lib\\site-packages\\geventhttpclient\\useragent.py\", line 359, in urlopen\r\n    last_error = self._handle_error(e, url=req.url)\r\n  File \"d:\\python\\lib\\site-packages\\geventhttpclient\\useragent.py\", line 326, in _handle_error\r\n    raise reraise(type(e), e, sys.exc_info()[2])\r\n  File \"d:\\python\\lib\\site-packages\\six.py\", line 703, in reraise\r\n    raise value\r\n  File \"d:\\python\\lib\\site-packages\\geventhttpclient\\useragent.py\", line 354, in urlopen\r\n    resp = self._urlopen(req)\r\n  File \"d:\\python\\lib\\site-packages\\locust\\contrib\\fasthttp.py\", line 402, in _urlopen\r\n    resp = client.request(\r\n  File \"d:\\python\\lib\\site-packages\\geventhttpclient\\client.py\", line 236, in request\r\n    sock.sendfile(body)\r\n  File \"d:\\python\\lib\\site-packages\\gevent\\_socket3.py\", line 684, in sendfile\r\n    return self._sendfile_use_send(file, offset, count)\r\n  File \"d:\\python\\lib\\site-packages\\gevent\\_socket3.py\", line 614, in _sendfile_use_send\r\n    self._check_sendfile_params(file, offset, count)\r\n  File \"d:\\python\\lib\\site-packages\\gevent\\_socket3.py\", line 653, in _check_sendfile_params\r\n    raise ValueError(\"only SOCK_STREAM type sockets are supported\")\r\nValueError: only SOCK_STREAM type sockets are supported\r\n\r\nThe same code, using HttpUser does not have this problem\u3002\r\n\r\n### Environment\r\n\r\n- OS: windows\r\n- Python version: Python 3.8.3\r\n- Locust version:locust 1.3.2\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1667/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1667/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1666", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1666/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1666/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1666/events", "html_url": "https://github.com/locustio/locust/issues/1666", "id": 772713059, "node_id": "MDU6SXNzdWU3NzI3MTMwNTk=", "number": 1666, "title": "the FastHttpUser will change the uppercase in the headers into lowwercase.", "user": {"login": "w00992", "id": 43738996, "node_id": "MDQ6VXNlcjQzNzM4OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/43738996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/w00992", "html_url": "https://github.com/w00992", "followers_url": "https://api.github.com/users/w00992/followers", "following_url": "https://api.github.com/users/w00992/following{/other_user}", "gists_url": "https://api.github.com/users/w00992/gists{/gist_id}", "starred_url": "https://api.github.com/users/w00992/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/w00992/subscriptions", "organizations_url": "https://api.github.com/users/w00992/orgs", "repos_url": "https://api.github.com/users/w00992/repos", "events_url": "https://api.github.com/users/w00992/events{/privacy}", "received_events_url": "https://api.github.com/users/w00992/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-12-22T07:27:30Z", "updated_at": "2020-12-22T20:28:08Z", "closed_at": "2020-12-22T14:38:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: mac 11.0.1\r\n- Python version: 3.6.8\r\n- Locust version: 1.4.1\r\n\r\nthe fasthttpuser will change the uppercase in the headers into lowwercase.\r\n\r\ncode as below:\r\n\r\n```python\r\nfrom locust import task, constant, HttpUser\r\nfrom locust.contrib.fasthttp import FastHttpUser\r\n\r\n\r\nclass MeshUser(FastHttpUser):\r\n    host = 'http://127.0.0.1:9999'\r\n    wait_time = constant(0)\r\n\r\n    def def_req(self,wait_time='0'):\r\n        headers = {r'Src-App': r'test.test.tset',\r\n                   r'Dst-App': r'test.test.srv2',\r\n                   r'Content-Type': r'text/plain'}\r\n        data = wait_time\r\n        resp = self.client.request(\r\n            method='post', path='/wait', headers=headers, data=data)\r\n\r\n    @task\r\n    def mesh_req_00(self):\r\n        self.mesh_req(wait_time='0')\r\n\r\n```\r\n\r\nand the server get data is : \u300csrc-app: test.test.tset\\r\\ndst-app: test.test....\u300d", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1666/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1666/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1664", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1664/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1664/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1664/events", "html_url": "https://github.com/locustio/locust/issues/1664", "id": 771441843, "node_id": "MDU6SXNzdWU3NzE0NDE4NDM=", "number": 1664, "title": "Test suite failure (packaging for GNU Guix)", "user": {"login": "Apteryks", "id": 8332263, "node_id": "MDQ6VXNlcjgzMzIyNjM=", "avatar_url": "https://avatars.githubusercontent.com/u/8332263?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Apteryks", "html_url": "https://github.com/Apteryks", "followers_url": "https://api.github.com/users/Apteryks/followers", "following_url": "https://api.github.com/users/Apteryks/following{/other_user}", "gists_url": "https://api.github.com/users/Apteryks/gists{/gist_id}", "starred_url": "https://api.github.com/users/Apteryks/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Apteryks/subscriptions", "organizations_url": "https://api.github.com/users/Apteryks/orgs", "repos_url": "https://api.github.com/users/Apteryks/repos", "events_url": "https://api.github.com/users/Apteryks/events{/privacy}", "received_events_url": "https://api.github.com/users/Apteryks/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901882, "node_id": "MDU6TGFiZWwxNjM1OTAxODgy", "url": "https://api.github.com/repos/locustio/locust/labels/wontfix", "name": "wontfix", "color": "ddcccc", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-12-19T19:41:27Z", "updated_at": "2020-12-21T12:13:14Z", "closed_at": "2020-12-21T12:13:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\n### Describe the bug\r\nI'm packaging `python-locust` for GNU Guix. The current dependencies used are:\r\n\r\n```\r\ndependencies: python-configargparse@1.2.3 python-flask-basicauth@0.2.0 python-flask@1.1.2\r\n+ python-gevent@20.9.0 python-geventhttpclient@1.4.4 python-mock@3.0.5 python-msgpack@1.0.0\r\n+ python-psutil@5.7.2 python-pyquery@1.2.17 python-pyzmq@17.1.2 python-requests@2.24.0\r\n+ python-werkzeug@1.0.1\r\n```\r\n\r\n### Expected behavior\r\nThe test suite should pass.\r\n\r\n### Actual behavior\r\nThe test suite fails with the following errors:\r\n```\r\n======================================================================\r\nERROR: test_default_headless_spawn_options (locust.test.test_main.LocustProcessIntegrationTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/tmp/guix-build-python-locust-1.4.1.drv-0/locust-1.4.1/locust/test/test_main.py\", line 231, in test_default_headless_spawn_options\r\n    subprocess.check_output(\r\n  File \"/gnu/store/wwm10m100gnpgw46y52a539lkxzf50f7-python-gevent-20.9.0/lib/python3.8/site-packages/gevent/subprocess.py\", line 404, in check_output\r\n    raise CalledProcessError(retcode, process.args, output=output)\r\nsubprocess.CalledProcessError: Command '['locust', '-f', '/tmp/guix-build-python-locust-1.4.1.drv-0/locust-1.4.1/locust/test/mock_locustfile_1608407678_1009326_26670.py', '--host', 'https://test.com/', '--run-time', '1s', '--headless']' returned non-zero exit status 1.\r\n\r\n======================================================================\r\nERROR: test_default_headless_spawn_options_with_shape (locust.test.test_main.LocustProcessIntegrationTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/tmp/guix-build-python-locust-1.4.1.drv-0/locust-1.4.1/locust/test/test_main.py\", line 272, in test_default_headless_spawn_options_with_shape\r\n    subprocess.check_output(\r\n  File \"/gnu/store/wwm10m100gnpgw46y52a539lkxzf50f7-python-gevent-20.9.0/lib/python3.8/site-packages/gevent/subprocess.py\", line 404, in check_output\r\n    raise CalledProcessError(retcode, process.args, output=output)\r\nsubprocess.CalledProcessError: Command '['locust', '-f', '/tmp/guix-build-python-locust-1.4.1.drv-0/locust-1.4.1/locust/test/mock_locustfile_1608407679_8408535_8220.py', '--host', 'https://test.com/', '--run-time', '1s', '--headless']' returned non-zero exit status 1.\r\n\r\n======================================================================\r\nERROR: test_web_options (locust.test.test_main.LocustProcessIntegrationTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/gnu/store/27bsphgz4hc261iw4lsi22gvm87y9qm2-python-urllib3-1.25.9/lib/python3.8/site-packages/urllib3/connection.py\", line 159, in _new_conn\r\n    conn = connection.create_connection(\r\n  File \"/gnu/store/27bsphgz4hc261iw4lsi22gvm87y9qm2-python-urllib3-1.25.9/lib/python3.8/site-packages/urllib3/util/connection.py\", line 84, in create_connection\r\n    raise err\r\n  File \"/gnu/store/27bsphgz4hc261iw4lsi22gvm87y9qm2-python-urllib3-1.25.9/lib/python3.8/site-packages/urllib3/util/connection.py\", line 74, in create_connection\r\n    sock.connect(sa)\r\n  File \"/gnu/store/wwm10m100gnpgw46y52a539lkxzf50f7-python-gevent-20.9.0/lib/python3.8/site-packages/gevent/_socket3.py\", line 407, in connect\r\n    raise error(err, strerror(err))\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/gnu/store/27bsphgz4hc261iw4lsi22gvm87y9qm2-python-urllib3-1.25.9/lib/python3.8/site-packages/urllib3/connectionpool.py\", line 670, in urlopen\r\n    httplib_response = self._make_request(\r\n  File \"/gnu/store/27bsphgz4hc261iw4lsi22gvm87y9qm2-python-urllib3-1.25.9/lib/python3.8/site-packages/urllib3/connectionpool.py\", line 392, in _make_request\r\n    conn.request(method, url, **httplib_request_kw)\r\n  File \"/gnu/store/q9rm8h9imazsq2c4qiv2yjpvlvliywqb-python-3.8.2/lib/python3.8/http/client.py\", line 1230, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/gnu/store/q9rm8h9imazsq2c4qiv2yjpvlvliywqb-python-3.8.2/lib/python3.8/http/client.py\", line 1276, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/gnu/store/q9rm8h9imazsq2c4qiv2yjpvlvliywqb-python-3.8.2/lib/python3.8/http/client.py\", line 1225, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/gnu/store/q9rm8h9imazsq2c4qiv2yjpvlvliywqb-python-3.8.2/lib/python3.8/http/client.py\", line 1004, in _send_output\r\n    self.send(msg)\r\n  File \"/gnu/store/q9rm8h9imazsq2c4qiv2yjpvlvliywqb-python-3.8.2/lib/python3.8/http/client.py\", line 944, in send\r\n    self.connect()\r\n  File \"/gnu/store/27bsphgz4hc261iw4lsi22gvm87y9qm2-python-urllib3-1.25.9/lib/python3.8/site-packages/urllib3/connection.py\", line 187, in connect\r\n    conn = self._new_conn()\r\n  File \"/gnu/store/27bsphgz4hc261iw4lsi22gvm87y9qm2-python-urllib3-1.25.9/lib/python3.8/site-packages/urllib3/connection.py\", line 171, in _new_conn\r\n    raise NewConnectionError(\r\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fffefda5670>: Failed to establish a new connection: [Errno 111] Connection refused\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/gnu/store/xc0p8gamx973rawzai1xx3d1fyahg55v-python-requests-2.24.0/lib/python3.8/site-packages/requests/adapters.py\", line 439, in send\r\n    resp = conn.urlopen(\r\n  File \"/gnu/store/27bsphgz4hc261iw4lsi22gvm87y9qm2-python-urllib3-1.25.9/lib/python3.8/site-packages/urllib3/connectionpool.py\", line 724, in urlopen\r\n    retries = retries.increment(\r\n  File \"/gnu/store/27bsphgz4hc261iw4lsi22gvm87y9qm2-python-urllib3-1.25.9/lib/python3.8/site-packages/urllib3/util/retry.py\", line 439, in increment\r\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=32949): Max retries exceeded with url: / (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fffefda5670>: Failed to establish a new connection: [Errno 111] Connection refused'))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/tmp/guix-build-python-locust-1.4.1.drv-0/locust-1.4.1/locust/test/test_main.py\", line 315, in test_web_options\r\n    self.assertEqual(200, requests.get(\"http://127.0.0.1:%i/\" % port, timeout=1).status_code)\r\n  File \"/gnu/store/xc0p8gamx973rawzai1xx3d1fyahg55v-python-requests-2.24.0/lib/python3.8/site-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/gnu/store/xc0p8gamx973rawzai1xx3d1fyahg55v-python-requests-2.24.0/lib/python3.8/site-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/gnu/store/xc0p8gamx973rawzai1xx3d1fyahg55v-python-requests-2.24.0/lib/python3.8/site-packages/requests/sessions.py\", line 530, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/gnu/store/xc0p8gamx973rawzai1xx3d1fyahg55v-python-requests-2.24.0/lib/python3.8/site-packages/requests/sessions.py\", line 643, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/gnu/store/xc0p8gamx973rawzai1xx3d1fyahg55v-python-requests-2.24.0/lib/python3.8/site-packages/requests/adapters.py\", line 516, in send\r\n    raise ConnectionError(e, request=request)\r\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host='127.0.0.1', port=32949): Max retries exceeded with url: / (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fffefda5670>: Failed to establish a new connection: [Errno 111] Connection refused'))\r\n\r\n======================================================================\r\nFAIL: test_skip_logging (locust.test.test_log.TestLoggingOptions)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/tmp/guix-build-python-locust-1.4.1.drv-0/locust-1.4.1/locust/test/test_log.py\", line 132, in test_skip_logging\r\n    self.assertEqual(\"running my_task\", output.strip())\r\nAssertionError: 'running my_task' != \"System open file limit '1024' is below m[250 chars]task\"\r\n- running my_task\r\n+ System open file limit '1024' is below minimum setting '10000'. It's not high enough for load testing, and the OS didn't allow locust to increase it by itself. See https://github.com/locustio/locust/wiki/Installation#increasing-maximum-number-of-open-files-limit for more info.\r\nrunning my_task\r\n\r\n\r\n======================================================================\r\nFAIL: test_custom_exit_code (locust.test.test_main.LocustProcessIntegrationTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/tmp/guix-build-python-locust-1.4.1.drv-0/locust-1.4.1/locust/test/test_main.py\", line 199, in test_custom_exit_code\r\n    self.assertEqual(42, proc.returncode)\r\nAssertionError: 42 != -15\r\n\r\n======================================================================\r\nFAIL: test_headless_spawn_options_wo_run_time (locust.test.test_main.LocustProcessIntegrationTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/tmp/guix-build-python-locust-1.4.1.drv-0/locust-1.4.1/locust/test/test_main.py\", line 251, in test_headless_spawn_options_wo_run_time\r\n    self.assertEqual(0, proc.returncode)\r\nAssertionError: 0 != -15\r\n\r\n----------------------------------------------------------------------\r\nRan 320 tests in 90.361s\r\n\r\nFAILED (failures=3, errors=3)\r\nTest failed: <unittest.runner.TextTestResult run=320 errors=3 failures=3>\r\nerror: Test failed: <unittest.runner.TextTestResult run=320 errors=3 failures=3>\r\ncommand \"python\" \"-c\" \"import setuptools, tokenize;__file__='setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\\\\r\\\\n', '\\\\n');f.close();exec(compile(code, __file__, 'exec'))\" \"test\" failed with status 1\r\n```\r\n\r\nI think the first two issues might have to do with networking not available in the Guix build container. Is there a mean to skip network dependent tests?\r\n\r\nThe second catches a warning instead of the expected text; the test seems brittle. Note that I can't do anything about the fs.file-max value (say, using `sysctl -w fs.file-max=500000`), as the build user in the container is not root.\r\n\r\nI have no clue about the last one.\r\n\r\n### Environment\r\n\r\n- OS: Guix System\r\n- Python version: 3.8.2\r\n- Locust version: 1.4.1\r\n- Locust command line that you ran: python setup.py test", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1664/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1664/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1663", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1663/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1663/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1663/events", "html_url": "https://github.com/locustio/locust/issues/1663", "id": 769525922, "node_id": "MDU6SXNzdWU3Njk1MjU5MjI=", "number": 1663, "title": "Cannot install locustio on nixos machine in nix-shell environment.", "user": {"login": "MajesticMullet", "id": 31056089, "node_id": "MDQ6VXNlcjMxMDU2MDg5", "avatar_url": "https://avatars.githubusercontent.com/u/31056089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MajesticMullet", "html_url": "https://github.com/MajesticMullet", "followers_url": "https://api.github.com/users/MajesticMullet/followers", "following_url": "https://api.github.com/users/MajesticMullet/following{/other_user}", "gists_url": "https://api.github.com/users/MajesticMullet/gists{/gist_id}", "starred_url": "https://api.github.com/users/MajesticMullet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MajesticMullet/subscriptions", "organizations_url": "https://api.github.com/users/MajesticMullet/orgs", "repos_url": "https://api.github.com/users/MajesticMullet/repos", "events_url": "https://api.github.com/users/MajesticMullet/events{/privacy}", "received_events_url": "https://api.github.com/users/MajesticMullet/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-12-17T05:10:47Z", "updated_at": "2020-12-18T04:51:08Z", "closed_at": "2020-12-17T16:05:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nCannot use locustio as when installing in a `nix-shell` as it does not pass its own tests. \r\n\r\n### Expected behavior\r\nI expect locustio to be installed so I can use it. (Note that it is a part of [nixpkgs](https://search.nixos.org/packages?channel=20.09&show=python37Packages.locustio&from=0&size=30&sort=relevance&query=locust))\r\n\r\n### Actual behavior\r\nDuring installation, locustio fails on 3 of it's own tests. (74 pass).\r\n![image](https://user-images.githubusercontent.com/31056089/102446428-dbf29880-4081-11eb-8bcc-dce05ed48ce0.png)\r\n\r\n### Steps to reproduce\r\nIn your `default.nix` file have: \r\n```\r\n{ buildPythonPackage\r\n, nix-gitignore\r\n, locustio\r\n}:\r\n\r\nbuildPythonPackage {\r\n pname = \"anything\"\r\n version = \"0.0.1\"\r\n src = nix-gitignore.gitignoreSource [] ./.;\r\n propagatedBuildInputs = [\r\n  locustio\r\n ];\r\n}\r\n```\r\n\r\n### Environment\r\n\r\n- OS: Nixos 20.09\r\n- Python version: Python37\r\n- Locustio version: 0.9.0", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1663/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1663/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1662", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1662/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1662/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1662/events", "html_url": "https://github.com/locustio/locust/issues/1662", "id": 768353230, "node_id": "MDU6SXNzdWU3NjgzNTMyMzA=", "number": 1662, "title": "Ubuntu / anaconda3 / locust keeps getting installed into \"base\" instead of current \"active\" conda env.", "user": {"login": "ecc256", "id": 15874603, "node_id": "MDQ6VXNlcjE1ODc0NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/15874603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecc256", "html_url": "https://github.com/ecc256", "followers_url": "https://api.github.com/users/ecc256/followers", "following_url": "https://api.github.com/users/ecc256/following{/other_user}", "gists_url": "https://api.github.com/users/ecc256/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecc256/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecc256/subscriptions", "organizations_url": "https://api.github.com/users/ecc256/orgs", "repos_url": "https://api.github.com/users/ecc256/repos", "events_url": "https://api.github.com/users/ecc256/events{/privacy}", "received_events_url": "https://api.github.com/users/ecc256/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-12-16T01:05:21Z", "updated_at": "2020-12-16T09:54:40Z", "closed_at": "2020-12-16T01:32:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "Guys,\r\nDon't what is wrong, but locust keeps getting installed into base conda env. \r\nnot current active env.\r\nI did clean conda reinstall few times and it behaves the same exactly...\r\n\r\nUbuntu 20.04.1 LTS (GNU/Linux 5.4.0-1032-aws x86_64)\r\nAnaconda3-2020.11-Linux-x86_64.sh\r\n\r\nSteps to reproduce:\r\n\r\n```\r\nconda create --name locust385 -y python=3.8.5\r\nconda activate locust385\r\npip install locust\r\nconda list\r\n\r\n```doesn't show locust\r\n\r\n```\r\nlocust\r\nlocust: command not found\r\n\r\n```\r\nbut if I switch to base, it can find \r\n```\r\nconda activate base\r\nwhich locust\r\n/home/ubuntu/anaconda3/bin/locust\r\n\r\n```\r\nAll I can say, it was not like this with locust 1.1.1", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1662/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1662/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1661", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1661/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1661/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1661/events", "html_url": "https://github.com/locustio/locust/issues/1661", "id": 768308966, "node_id": "MDU6SXNzdWU3NjgzMDg5NjY=", "number": 1661, "title": "curl IP/stop does not actually terminate Locust swarms", "user": {"login": "0xSage", "id": 69952136, "node_id": "MDQ6VXNlcjY5OTUyMTM2", "avatar_url": "https://avatars.githubusercontent.com/u/69952136?v=4", "gravatar_id": "", "url": "https://api.github.com/users/0xSage", "html_url": "https://github.com/0xSage", "followers_url": "https://api.github.com/users/0xSage/followers", "following_url": "https://api.github.com/users/0xSage/following{/other_user}", "gists_url": "https://api.github.com/users/0xSage/gists{/gist_id}", "starred_url": "https://api.github.com/users/0xSage/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/0xSage/subscriptions", "organizations_url": "https://api.github.com/users/0xSage/orgs", "repos_url": "https://api.github.com/users/0xSage/repos", "events_url": "https://api.github.com/users/0xSage/events{/privacy}", "received_events_url": "https://api.github.com/users/0xSage/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2115072627, "node_id": "MDU6TGFiZWwyMTE1MDcyNjI3", "url": "https://api.github.com/repos/locustio/locust/labels/non-critical", "name": "non-critical", "color": "c4e4c9", "default": false, "description": ""}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-12-15T23:49:31Z", "updated_at": "2021-05-25T02:04:00Z", "closed_at": "2021-05-25T02:04:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Expected**\r\nPer suggestion in #831, I have a script that starts Locust through a POST request, then terminates Locust through a GET /stop. \r\n\r\nThere are two issues with this: \r\n1. Depending on the spawn_rate, calling GET /stop only terminates httpusers that are already spawned. I expected this would terminate the entire test's users.\r\n2. If you initiate a swarm with a HTTP request, the UI doesn't have a \"STOP\" button. The only way to terminate that swarm is with a GET /stop. \r\n\r\n**To repro**\r\n1. `curl -XPOST -d \"user_count=100&spawn_rate=10\" http://$LOADGEN_IP/swarm` where user_count/spawn_rate are our custom fields\r\n2. sleep for 5 seconds, then `curl http://$LOADGEN_IP/stop`\r\n3. Notice, after running step 2 UI indicates `STATUS: STOPPED`, and HTTPResponse is successful: \r\n```sh\r\n{\r\n  \"message\": \"Test stopped\",\r\n  \"success\": true\r\n}\r\n```\r\n4. However, according to our reliable telemetry, Locust is still swarming\r\n \r\n### Environment\r\n- Locust version: 1.3.1\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1661/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1661/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1654", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1654/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1654/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1654/events", "html_url": "https://github.com/locustio/locust/issues/1654", "id": 761436992, "node_id": "MDU6SXNzdWU3NjE0MzY5OTI=", "number": 1654, "title": "SetConsoleMode throws an error when locust is run from Jenkins Powershell", "user": {"login": "jasuomi", "id": 61458417, "node_id": "MDQ6VXNlcjYxNDU4NDE3", "avatar_url": "https://avatars.githubusercontent.com/u/61458417?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jasuomi", "html_url": "https://github.com/jasuomi", "followers_url": "https://api.github.com/users/jasuomi/followers", "following_url": "https://api.github.com/users/jasuomi/following{/other_user}", "gists_url": "https://api.github.com/users/jasuomi/gists{/gist_id}", "starred_url": "https://api.github.com/users/jasuomi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jasuomi/subscriptions", "organizations_url": "https://api.github.com/users/jasuomi/orgs", "repos_url": "https://api.github.com/users/jasuomi/repos", "events_url": "https://api.github.com/users/jasuomi/events{/privacy}", "received_events_url": "https://api.github.com/users/jasuomi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-12-10T17:24:39Z", "updated_at": "2022-02-16T07:07:51Z", "closed_at": "2020-12-11T15:26:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nError message is printed out to console right after the test is started in Jenkins and job fails on exit code 2 even actual test passes. We have run locust performance tests over a year on Jenkins without similar problem. Tests started to fail recently after we updated Python and Locustio versions to latest. Locust test run without a problem if it is started on Windows desktop Powershell (or cmd).\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nLocust tests should run on CI as they run on local machine.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nError \"pywintypes.error: (6, 'SetConsoleMode', 'The handle is invalid.')\" is printed out to console right after the test is started in Jenkins and job fails on exit code 2 even actual test passes.\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n```\r\nfrom locust import User, task, between\r\n\r\n\r\nclass MyUser(User):\r\n    @task\r\n    def my_task(self):\r\n        print(\"executing my_task\")\r\n\r\n    wait_time = between(0.5, 10)\r\n```\r\nStart command\r\n`locust -f .\\locust_test.py --headless --run-time 3`\r\n\r\nConsole from Jenkins:\r\n```\r\n[Locust_test] $ powershell.exe -NonInteractive -ExecutionPolicy Bypass -File C:\\Users\\locust\\AppData\\Local\\Temp\\jenkins11138277147510956709.ps1\r\n[2020-12-10 19:13:09,846] robot-vm/INFO/locust.main: Run time limit set to 3 seconds\r\n[2020-12-10 19:13:09,847] robot-vm/INFO/locust.main: Starting Locust 1.4.1\r\n[2020-12-10 19:13:09,847] robot-vm/INFO/locust.runners: Spawning 1 users at the rate 1 users/s (0 users already running)...\r\n[2020-12-10 19:13:09,847] robot-vm/INFO/locust.runners: All users spawned: MyUser: 1 (1 total running)\r\nTraceback (most recent call last):\r\n  File \"src/gevent/greenlet.py\", line 854, in gevent._gevent_cgreenlet.Greenlet.run\r\n  File \"c:\\python39\\lib\\site-packages\\locust\\input_events.py\", line 89, in input_listener_func\r\n    poller = get_poller()\r\n  File \"c:\\python39\\lib\\site-packages\\locust\\input_events.py\", line 81, in get_poller\r\n    return WindowsKeyPoller()\r\n  File \"c:\\python39\\lib\\site-packages\\locust\\input_events.py\", line 47, in __init__\r\n    self.read_handle.SetConsoleMode(ENABLE_LINE_INPUT | ENABLE_ECHO_INPUT | ENABLE_PROCESSED_INPUT)\r\npywintypes.error: (6, 'SetConsoleMode', 'The handle is invalid.')\r\n2020-12-10T17:13:09Z <Greenlet at 0x19066ffdd00: input_listener_func> failed with error\r\n\r\n Name                                                          # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                         0     0(0.00%)  |       0       0       0       0  |    0.00    0.00\r\n\r\n[2020-12-10 19:13:09,855] robot-vm/CRITICAL/locust.main: Unhandled exception in greenlet: <Greenlet at 0x19066ffdd00: input_listener_func>\r\nTraceback (most recent call last):\r\n  File \"src/gevent/greenlet.py\", line 854, in gevent._gevent_cgreenlet.Greenlet.run\r\n  File \"c:\\python39\\lib\\site-packages\\locust\\input_events.py\", line 89, in input_listener_func\r\n    poller = get_poller()\r\n  File \"c:\\python39\\lib\\site-packages\\locust\\input_events.py\", line 81, in get_poller\r\n    return WindowsKeyPoller()\r\n  File \"c:\\python39\\lib\\site-packages\\locust\\input_events.py\", line 47, in __init__\r\n    self.read_handle.SetConsoleMode(ENABLE_LINE_INPUT | ENABLE_ECHO_INPUT | ENABLE_PROCESSED_INPUT)\r\npywintypes.error: (6, 'SetConsoleMode', 'The handle is invalid.')\r\n Name                                                          # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                         0     0(0.00%)  |       0       0       0       0  |    0.00    0.00\r\n\r\n[2020-12-10 19:13:12,486] robot-vm/INFO/locust.main: Time limit reached. Stopping Locust.\r\n[2020-12-10 19:13:12,486] robot-vm/INFO/locust.runners: Stopping 1 users\r\n[2020-12-10 19:13:12,487] robot-vm/INFO/locust.runners: 1 Users have been stopped, 0 still running\r\n[2020-12-10 19:13:12,487] robot-vm/INFO/locust.main: Running teardowns...\r\n[2020-12-10 19:13:12,487] robot-vm/INFO/locust.main: Shutting down (exit code 2), bye.\r\n[2020-12-10 19:13:12,487] robot-vm/INFO/locust.main: Cleaning up runner...\r\n Name                                                          # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                         0     0(0.00%)  |       0       0       0       0  |    0.00    0.00\r\n\r\nResponse time percentiles (approximated)\r\n Type     Name                                                              50%    66%    75%    80%    90%    95%    98%    99%  99.9% 99.99%   100% # reqs\r\n--------|------------------------------------------------------------|---------|------|------|------|------|------|------|------|------|------|------|------|\r\n--------|------------------------------------------------------------|---------|------|------|------|------|------|------|------|------|------|------|------|\r\n\r\nexecuting my_task\r\nBuild step 'PowerShell' marked build as failure\r\nArchiving artifacts\r\nFinished: FAILURE\r\n\r\nREST API\r\nJenkins 2.249.3\r\n```\r\nConsole from local PC's Powershell\r\n```\r\nPS C:\\workspace\\tmp> locust -f .\\locust_test.py --headless --run-time 3\r\n[2020-12-10 18:55:07,816] WL313558/INFO/locust.main: Run time limit set to 3 seconds\r\n[2020-12-10 18:55:07,816] WL313558/INFO/locust.main: Starting Locust 1.4.1\r\n[2020-12-10 18:55:07,816] WL313558/INFO/locust.runners: Spawning 1 users at the rate 1 users/s (0 users already running)...\r\n[2020-12-10 18:55:07,816] WL313558/INFO/locust.runners: All users spawned: MyUser: 1 (1 total running)\r\n Name                                                          # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                         0     0(0.00%)  |       0       0       0       0  |    0.00    0.00\r\n\r\nexecuting my_task\r\n Name                                                          # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                         0     0(0.00%)  |       0       0       0       0  |    0.00    0.00\r\n\r\nexecuting my_task\r\n[2020-12-10 18:55:10,512] WL313558/INFO/locust.main: Time limit reached. Stopping Locust.\r\n[2020-12-10 18:55:10,513] WL313558/INFO/locust.runners: Stopping 1 users\r\n[2020-12-10 18:55:10,513] WL313558/INFO/locust.runners: 1 Users have been stopped, 0 still running\r\n[2020-12-10 18:55:10,513] WL313558/INFO/locust.main: Running teardowns...\r\n[2020-12-10 18:55:10,513] WL313558/INFO/locust.main: Shutting down (exit code 0), bye.\r\n[2020-12-10 18:55:10,513] WL313558/INFO/locust.main: Cleaning up runner...\r\n Name                                                          # reqs      # fails  |     Avg     Min     Max  Median  |   req/s failures/s\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                         0     0(0.00%)  |       0       0       0       0  |    0.00    0.00\r\n\r\nResponse time percentiles (approximated)\r\n Type     Name                                                              50%    66%    75%    80%    90%    95%    98%    99%  99.9% 99.99%   100% # reqs\r\n--------|------------------------------------------------------------|---------|------|------|------|------|------|------|------|------|------|------|------|\r\n--------|------------------------------------------------------------|---------|------|------|------|------|------|------|------|------|------|------|------|\r\n```\r\n\r\n\r\n### Environment\r\n\r\n- OS: Windows 10\r\n- Python version: 3.9.1\r\n- Locust version: 1.4.1", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1654/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1654/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1653", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1653/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1653/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1653/events", "html_url": "https://github.com/locustio/locust/issues/1653", "id": 761395702, "node_id": "MDU6SXNzdWU3NjEzOTU3MDI=", "number": 1653, "title": "locust should exit when a load shape returns None in headless mode", "user": {"login": "Apteryks", "id": 8332263, "node_id": "MDQ6VXNlcjgzMzIyNjM=", "avatar_url": "https://avatars.githubusercontent.com/u/8332263?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Apteryks", "html_url": "https://github.com/Apteryks", "followers_url": "https://api.github.com/users/Apteryks/followers", "following_url": "https://api.github.com/users/Apteryks/following{/other_user}", "gists_url": "https://api.github.com/users/Apteryks/gists{/gist_id}", "starred_url": "https://api.github.com/users/Apteryks/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Apteryks/subscriptions", "organizations_url": "https://api.github.com/users/Apteryks/orgs", "repos_url": "https://api.github.com/users/Apteryks/repos", "events_url": "https://api.github.com/users/Apteryks/events{/privacy}", "received_events_url": "https://api.github.com/users/Apteryks/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-12-10T16:36:34Z", "updated_at": "2021-01-20T17:59:37Z", "closed_at": "2021-01-20T17:59:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello! \r\n\r\n### Describe the bug\r\n\r\nWhen using a LoadTestShape class, the test finishes when its `tick` method returns `None`, but the Locust process keeps running, even when in `--headless` mode.\r\n\r\n### Expected behavior\r\n\r\nWhen Locust is run in `--headless` mode, it should automatically stop running when a `LoadTestShape` class `tick` method signals a test is complete by returning `None`.\r\n\r\n### Actual behavior\r\n\r\nThe test is finished, but the Locust process does not exit.\r\n\r\n### Steps to reproduce\r\n\r\nI'm using Docker to run Locust.\r\n\r\nfile: repro.py\r\n```\r\nimport logging\r\n\r\nfrom locust import HttpUser, LoadTestShape, task\r\n\r\n\r\n# Straight from:\r\n# https://docs.locust.io/en/latest/generating-custom-load-shape.html?highlight=LoadTestShape\r\nclass MyCustomShape(LoadTestShape):\r\n    time_limit = 20\r\n    spawn_rate = 2\r\n\r\n    def tick(self):\r\n        run_time = self.get_run_time()\r\n\r\n        if run_time < self.time_limit:\r\n            # User count rounded to nearest hundred.\r\n            user_count = round(run_time, -2)\r\n            return (user_count, self.spawn_rate)\r\n\r\n        return None\r\n\r\n\r\nclass User(HttpUser):\r\n\r\n    @task\r\n    def main(self):\r\n        logging.info('Running main task...')\r\n\r\n```\r\n\r\nThen run the reproducer like:\r\n```\r\ndocker run -v \"$PWD:/mnt/locust\" -w \"/mnt/locust\" locustio/locust -f repro.py --headless --host http://www.example.com --only-summary\r\n[2020-12-10 16:19:21,864] 39c75587a12e/WARNING/locust.main: System open file limit '1024' is below minimum setting '10000'. It's not high enough for load testing, and the OS didn't allow locust to increase it by itself. See https://github.com/locustio/locust/wiki/Installation#increasing-maximum-number-of-open-files-limit for more info.\r\n[2020-12-10 16:19:21,865] 39c75587a12e/INFO/locust.runners: Shape test starting. User count and spawn rate are ignored for this type of load test\r\n[2020-12-10 16:19:21,865] 39c75587a12e/INFO/locust.main: No run time limit set, use CTRL+C to interrupt.\r\n[2020-12-10 16:19:21,865] 39c75587a12e/INFO/locust.main: Starting Locust 1.4.1\r\n[2020-12-10 16:19:21,866] 39c75587a12e/INFO/locust.runners: Shape worker starting\r\n[2020-12-10 16:19:21,866] 39c75587a12e/INFO/locust.runners: Shape test updating to 0 users at 2.00 spawn rate\r\n[2020-12-10 16:19:21,866] 39c75587a12e/INFO/root: Terminal was not a tty. Keyboard input disabled\r\n[2020-12-10 16:19:21,866] 39c75587a12e/INFO/locust.runners: Spawning 0 users at the rate 2 users/s (0 users already running)...\r\n[2020-12-10 16:19:21,867] 39c75587a12e/INFO/locust.runners: All users spawned: User: 0 (0 total running)\r\n[2020-12-10 16:19:41,887] 39c75587a12e/INFO/locust.runners: Shape test stopping\r\n```\r\n\r\nObserve that Locust does not return control to the shell and keeps running.\r\n\r\n### Environment\r\n\r\nDockerized. Everything needed to reproduce is described above.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1653/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1653/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1650", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1650/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1650/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1650/events", "html_url": "https://github.com/locustio/locust/issues/1650", "id": 759698949, "node_id": "MDU6SXNzdWU3NTk2OTg5NDk=", "number": 1650, "title": "Installation Issue", "user": {"login": "jigsheth57", "id": 11819119, "node_id": "MDQ6VXNlcjExODE5MTE5", "avatar_url": "https://avatars.githubusercontent.com/u/11819119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jigsheth57", "html_url": "https://github.com/jigsheth57", "followers_url": "https://api.github.com/users/jigsheth57/followers", "following_url": "https://api.github.com/users/jigsheth57/following{/other_user}", "gists_url": "https://api.github.com/users/jigsheth57/gists{/gist_id}", "starred_url": "https://api.github.com/users/jigsheth57/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jigsheth57/subscriptions", "organizations_url": "https://api.github.com/users/jigsheth57/orgs", "repos_url": "https://api.github.com/users/jigsheth57/repos", "events_url": "https://api.github.com/users/jigsheth57/events{/privacy}", "received_events_url": "https://api.github.com/users/jigsheth57/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-12-08T18:59:35Z", "updated_at": "2021-02-16T07:51:59Z", "closed_at": "2021-02-16T07:51:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\npip3 install locust\r\nRequirement already satisfied: locust in /usr/local/lib/python3.9/site-packages (1.3.2)\r\nRequirement already satisfied: geventhttpclient>=1.4.4 in /usr/local/lib/python3.9/site-packages (from locust) (1.4.4)\r\nRequirement already satisfied: Flask-BasicAuth>=0.2.0 in /usr/local/lib/python3.9/site-packages (from locust) (0.2.0)\r\nRequirement already satisfied: ConfigArgParse>=1.0 in /usr/local/lib/python3.9/site-packages (from locust) (1.2.3)\r\nRequirement already satisfied: psutil>=5.6.7 in /usr/local/lib/python3.9/site-packages (from locust) (5.7.3)\r\nRequirement already satisfied: msgpack>=0.6.2 in /usr/local/lib/python3.9/site-packages (from locust) (1.0.0)\r\nRequirement already satisfied: requests>=2.9.1 in /usr/local/lib/python3.9/site-packages (from locust) (2.24.0)\r\nRequirement already satisfied: Werkzeug>=1.0.1 in /usr/local/lib/python3.9/site-packages (from locust) (1.0.1)\r\nRequirement already satisfied: flask>=1.1.2 in /usr/local/lib/python3.9/site-packages (from locust) (1.1.2)\r\nRequirement already satisfied: gevent>=20.9.0 in /usr/local/lib/python3.9/site-packages (from locust) (20.9.0)\r\nRequirement already satisfied: pyzmq>=16.0.2 in /usr/local/lib/python3.9/site-packages (from locust) (19.0.2)\r\nRequirement already satisfied: Werkzeug>=1.0.1 in /usr/local/lib/python3.9/site-packages (from locust) (1.0.1)\r\nRequirement already satisfied: itsdangerous>=0.24 in /usr/local/lib/python3.9/site-packages (from flask>=1.1.2->locust) (1.1.0)\r\nRequirement already satisfied: click>=5.1 in /usr/local/lib/python3.9/site-packages (from flask>=1.1.2->locust) (7.1.2)\r\nRequirement already satisfied: Jinja2>=2.10.1 in /usr/local/lib/python3.9/site-packages (from flask>=1.1.2->locust) (2.11.2)\r\nRequirement already satisfied: flask>=1.1.2 in /usr/local/lib/python3.9/site-packages (from locust) (1.1.2)\r\nRequirement already satisfied: greenlet>=0.4.17 in /usr/local/lib/python3.9/site-packages (from gevent>=20.9.0->locust) (0.4.17)\r\nRequirement already satisfied: zope.interface in /usr/local/lib/python3.9/site-packages (from gevent>=20.9.0->locust) (5.2.0)\r\nRequirement already satisfied: setuptools in /usr/local/lib/python3.9/site-packages (from gevent>=20.9.0->locust) (50.3.2)\r\nRequirement already satisfied: zope.event in /usr/local/lib/python3.9/site-packages (from gevent>=20.9.0->locust) (4.5.0)\r\nRequirement already satisfied: certifi in /usr/local/lib/python3.9/site-packages (from geventhttpclient>=1.4.4->locust) (2020.11.8)\r\nRequirement already satisfied: six in /usr/local/lib/python3.9/site-packages (from geventhttpclient>=1.4.4->locust) (1.15.0)\r\nRequirement already satisfied: gevent>=20.9.0 in /usr/local/lib/python3.9/site-packages (from locust) (20.9.0)\r\nRequirement already satisfied: MarkupSafe>=0.23 in /usr/local/lib/python3.9/site-packages (from Jinja2>=2.10.1->flask>=1.1.2->locust) (1.1.1)\r\nRequirement already satisfied: certifi in /usr/local/lib/python3.9/site-packages (from geventhttpclient>=1.4.4->locust) (2020.11.8)\r\nRequirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.9/site-packages (from requests>=2.9.1->locust) (3.0.4)\r\nRequirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.9/site-packages (from requests>=2.9.1->locust) (1.25.11)\r\nRequirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.9/site-packages (from requests>=2.9.1->locust) (2.10)\r\nRequirement already satisfied: setuptools in /usr/local/lib/python3.9/site-packages (from gevent>=20.9.0->locust) (50.3.2)\r\nRequirement already satisfied: setuptools in /usr/local/lib/python3.9/site-packages (from gevent>=20.9.0->locust) (50.3.2)\r\n\r\n**illegal hardware instruction  locust -v**\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: macOS Big Sur 11.0.1\r\n- Python version: Python 3.9.0\r\n- Locust version: latest\r\n- Locust command line that you ran: locust -v\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1650/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1650/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1649", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1649/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1649/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1649/events", "html_url": "https://github.com/locustio/locust/issues/1649", "id": 758130472, "node_id": "MDU6SXNzdWU3NTgxMzA0NzI=", "number": 1649, "title": "Locust exception ImportError(\"cannot import name 'HttpUser'\",)", "user": {"login": "supunsandeeptha", "id": 38730727, "node_id": "MDQ6VXNlcjM4NzMwNzI3", "avatar_url": "https://avatars.githubusercontent.com/u/38730727?v=4", "gravatar_id": "", "url": "https://api.github.com/users/supunsandeeptha", "html_url": "https://github.com/supunsandeeptha", "followers_url": "https://api.github.com/users/supunsandeeptha/followers", "following_url": "https://api.github.com/users/supunsandeeptha/following{/other_user}", "gists_url": "https://api.github.com/users/supunsandeeptha/gists{/gist_id}", "starred_url": "https://api.github.com/users/supunsandeeptha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/supunsandeeptha/subscriptions", "organizations_url": "https://api.github.com/users/supunsandeeptha/orgs", "repos_url": "https://api.github.com/users/supunsandeeptha/repos", "events_url": "https://api.github.com/users/supunsandeeptha/events{/privacy}", "received_events_url": "https://api.github.com/users/supunsandeeptha/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-12-07T03:51:27Z", "updated_at": "2020-12-07T10:10:55Z", "closed_at": "2020-12-07T10:10:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "When using with AWS lambda, gives this error for the locust file.  Here are the steps followed,\r\n\r\n* sudo pip3 install invokust locust --target=python-packages\r\n* created the lambda handler and locust file with user tasks.\r\n* created a zip file with python packages and the python files\r\n* created a aws lambda \r\n* created a test event as follows,\r\n{\r\n\"locustfile\":\"gogetat_locustfile.py\",\r\n\"host\":\"https://gogetat.com\",\r\n\"num_clients\":\"30\",\r\n\"hatch_rate\":\"1\",\r\n\"run_time\":\"5m\"\r\n}\r\n\r\ncan you please point out the issue here.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1649/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1649/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1640", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1640/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1640/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1640/events", "html_url": "https://github.com/locustio/locust/issues/1640", "id": 753312886, "node_id": "MDU6SXNzdWU3NTMzMTI4ODY=", "number": 1640, "title": "Locust is sending empty content", "user": {"login": "alterEgo123", "id": 32942737, "node_id": "MDQ6VXNlcjMyOTQyNzM3", "avatar_url": "https://avatars.githubusercontent.com/u/32942737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alterEgo123", "html_url": "https://github.com/alterEgo123", "followers_url": "https://api.github.com/users/alterEgo123/followers", "following_url": "https://api.github.com/users/alterEgo123/following{/other_user}", "gists_url": "https://api.github.com/users/alterEgo123/gists{/gist_id}", "starred_url": "https://api.github.com/users/alterEgo123/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alterEgo123/subscriptions", "organizations_url": "https://api.github.com/users/alterEgo123/orgs", "repos_url": "https://api.github.com/users/alterEgo123/repos", "events_url": "https://api.github.com/users/alterEgo123/events{/privacy}", "received_events_url": "https://api.github.com/users/alterEgo123/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2115072627, "node_id": "MDU6TGFiZWwyMTE1MDcyNjI3", "url": "https://api.github.com/repos/locustio/locust/labels/non-critical", "name": "non-critical", "color": "c4e4c9", "default": false, "description": ""}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2020-11-30T09:32:06Z", "updated_at": "2021-04-29T01:53:15Z", "closed_at": "2021-04-29T01:53:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nI'm trying to upload a file to my Tornado web server using Locust. I've tried sending the HTTP request successfully using Postman and python's requests, but using Locust it is sending an empty content to the web server.\r\n\r\n### Expected behavior\r\nSending the file (form data) to the web server.\r\n\r\n### Actual behavior\r\nLocust is sending an empty content\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: Linux 18.04\r\n- Python version: 3.6.9\r\n- Locust version: 1.4.1\r\n- Locust command line that you ran: locust -f locustfile.py\r\n- Locust file contents (anonymized if necessary):\r\n\r\nTrying the upload using python's requests:\r\n\r\n```\r\nimport requests\r\nurl = \"http://localhost:xxxxxxxxxxxxxxx/image_upload\"\r\nheaders = {'Authorization': 'bearer xxxxxxxxxxxxxxxxxx'}\r\nimage = '/home/xxxx.jpeg'\r\nfiles = {'file': open(image, 'rb')}\r\nrequests.post(url, files=files, headers=headers, verify=False)\r\n```\r\n\r\nTask inside locustfile:\r\n```\r\n\r\n@task(1)\r\ndef post_image(self):\r\n    url = 'image_upload'\r\n    image ='/home/xxxx.jpeg'\r\n    files = {'file': open(image, 'rb')}\r\n    headers = {'Authorization': 'bearer xxxxxxxxxxxxxxxxxx'}\r\n    self.client.post(url, files=files,\r\n                     headers=headers, verify=False\r\n                     )\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1640/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1640/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1638", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1638/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1638/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1638/events", "html_url": "https://github.com/locustio/locust/issues/1638", "id": 751937318, "node_id": "MDU6SXNzdWU3NTE5MzczMTg=", "number": 1638, "title": "test_stop is fired twice when Locust is running in \u2013master/worker mode", "user": {"login": "12monkeys-stack", "id": 62694210, "node_id": "MDQ6VXNlcjYyNjk0MjEw", "avatar_url": "https://avatars.githubusercontent.com/u/62694210?v=4", "gravatar_id": "", "url": "https://api.github.com/users/12monkeys-stack", "html_url": "https://github.com/12monkeys-stack", "followers_url": "https://api.github.com/users/12monkeys-stack/followers", "following_url": "https://api.github.com/users/12monkeys-stack/following{/other_user}", "gists_url": "https://api.github.com/users/12monkeys-stack/gists{/gist_id}", "starred_url": "https://api.github.com/users/12monkeys-stack/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/12monkeys-stack/subscriptions", "organizations_url": "https://api.github.com/users/12monkeys-stack/orgs", "repos_url": "https://api.github.com/users/12monkeys-stack/repos", "events_url": "https://api.github.com/users/12monkeys-stack/events{/privacy}", "received_events_url": "https://api.github.com/users/12monkeys-stack/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-11-27T02:26:15Z", "updated_at": "2020-12-01T19:50:20Z", "closed_at": "2020-12-01T16:58:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "when I run locust in \u2013master/worker mode\uff0ctest_stop is fired twice, but test_start is fired once.\r\n\r\nmy user class:\r\n```\r\nclass MyUser(User):\r\n    wait_time = constant_pacing(1)\r\n\r\n    @task\r\n    def my_task(self):\r\n        print(\"executing my_task\")\r\n\r\n    @events.test_start.add_listener\r\n    def on_test_start(**kwargs):\r\n        print(\"on_test_start\")\r\n\r\n    @events.test_stop.add_listener\r\n    def on_test_stop(**kwargs):\r\n        print(\"on_test_stop\")\r\n\r\n    def on_start(self):\r\n        print(\"start task\")\r\n\r\n    def on_stop(self):\r\n        print(\"stop task\")\r\n```\r\n\r\nthe test command:\r\n```\r\n    master_cmd = \"locust -f MyLocust.py --host 127.0.0.1 -u 2 -r 1 -t 5s --master --expect-workers 1 --headless \" \\\r\n                 \"--skip-log-setup --loglevel ERROR --logfile test.log\"\r\n    worker_cmd = \"locust -f MyLocust.py --worker\"\r\n\r\n    process1 = subprocess.Popen(master_cmd)\r\n    process2 = subprocess.Popen(worker_cmd)\r\n\r\n    process1.wait()\r\n```\r\n\r\n\r\nthe log information:\r\n```\r\n[2020-11-27 10:21:23,590] DESKTOP-200810/INFO/locust.main: Starting Locust 1.3.0\r\n[2020-11-27 10:21:24,592] DESKTOP-200810/INFO/locust.runners: Spawning 2 users at the rate 1 users/s (0 users already running)...\r\non_test_start\r\nstart task\r\nexecuting my_task\r\n[2020-11-27 10:21:25,592] DESKTOP-200810/INFO/locust.runners: All users spawned: MyUser: 2 (0 already running)\r\nexecuting my_task\r\nstart task\r\nexecuting my_task\r\nexecuting my_task\r\nexecuting my_task\r\nexecuting my_task\r\nexecuting my_task\r\nexecuting my_task\r\nexecuting my_task\r\non_test_stop\r\n[2020-11-27 10:21:29,592] DESKTOP-200810/INFO/locust.runners: Got quit message from master, shutting down...\r\nexecuting my_task\r\n[2020-11-27 10:21:29,592] DESKTOP-200810/INFO/locust.runners: Stopping 2 users\r\nexecuting my_task\r\n[2020-11-27 10:21:29,593] DESKTOP-200810/INFO/locust.runners: 2 Users have been stopped\r\nstop task\r\n[2020-11-27 10:21:29,593] DESKTOP-200810/INFO/locust.main: Running teardowns...\r\nstop task\r\n[2020-11-27 10:21:29,593] DESKTOP-200810/INFO/locust.main: Shutting down (exit code 0), bye.\r\non_test_stop\r\n[2020-11-27 10:21:29,593] DESKTOP-200810/INFO/locust.main: Cleaning up runner...\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1638/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1638/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1635", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1635/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1635/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1635/events", "html_url": "https://github.com/locustio/locust/issues/1635", "id": 747773082, "node_id": "MDU6SXNzdWU3NDc3NzMwODI=", "number": 1635, "title": "Only the first user class is being spawned when running locust as library", "user": {"login": "rkhir", "id": 44171682, "node_id": "MDQ6VXNlcjQ0MTcxNjgy", "avatar_url": "https://avatars.githubusercontent.com/u/44171682?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rkhir", "html_url": "https://github.com/rkhir", "followers_url": "https://api.github.com/users/rkhir/followers", "following_url": "https://api.github.com/users/rkhir/following{/other_user}", "gists_url": "https://api.github.com/users/rkhir/gists{/gist_id}", "starred_url": "https://api.github.com/users/rkhir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rkhir/subscriptions", "organizations_url": "https://api.github.com/users/rkhir/orgs", "repos_url": "https://api.github.com/users/rkhir/repos", "events_url": "https://api.github.com/users/rkhir/events{/privacy}", "received_events_url": "https://api.github.com/users/rkhir/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635903137, "node_id": "MDU6TGFiZWwxNjM1OTAzMTM3", "url": "https://api.github.com/repos/locustio/locust/labels/duplicate", "name": "duplicate", "color": "9cea8c", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2020-11-20T20:26:57Z", "updated_at": "2021-08-09T13:39:13Z", "closed_at": "2020-11-26T18:38:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nI'm running Locust as a library, when instantiating the environment, only the first user class gets spawn up \r\n\r\n### Expected behavior\r\nAll user classes should be span up with the right amount of stimulated users\r\n### Actual behavior\r\n\r\nonly the first specified used class in the environment is being spawned\r\n### Steps to reproduce\r\n\r\nplease see the code snippet\r\n\r\n\r\n### Environment\r\n\r\n- OS: MacOS\r\n- Python version: 3.7\r\n- Locust version:  image \"1.2.3\"\r\n- Locust command line that you ran: running locust as a library in a main method\r\n- Locust file contents (anonymized if necessary):\r\n\r\nuser class A\r\n```\r\nclass AUsers(HttpUser):\r\n    host = os.environ.get(\"A_HOST\")\r\n    wait_time = constant_pacing(1)\r\n    tasks = [ATask]\r\n\r\n```\r\nUser class B \r\n```\r\nclass BUser(HttpUser):\r\n    host = os.environ.get(\"B_HOST\")\r\n    wait_time = constant_pacing(1)\r\n    tasks = [Btasks]\r\n\r\n```\r\n\r\n\r\nMaster main module : \r\n```\r\n    env = Environment(user_classes=[BUser,AUser])\r\n\r\n    def run_manager(self):\r\n        logging.info('*******************')\r\n        logging.info('{}'.format(\"Starting Manager\"))\r\n        logging.info('*******************')\r\n        self.env.step_load = True\r\n        self.env.create_master_runner()\r\n        self.env.create_web_ui(\"0.0.0.0\", 8089)\r\n        gevent.spawn(stats.stats_history, self.env.runner)\r\n        self.env.runner.greenlet.join()\r\n\r\nif __name__ == \"__main__\":\r\n    manager = ManagerEnv()\r\n    manager.run_manager()\r\n```\r\n\r\n\r\nWorker main module\r\n```\r\n    env = Environment(user_classes=[BUser,AUser])\r\n\r\n    def run_worker(self):\r\n        logging.info('*******************')\r\n        logging.info('{}'.format(\"Starting Worker\"))\r\n        logging.info('*******************')\r\n        self.env.create_worker_runner(os.environ.get('MANAGER_HOST'), 5557)\r\n        gevent.spawn(stats_printer(self.env.stats))\r\n        self.env.runner.greenlet.join()\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    worker = Worker()\r\n    worker.run_worker()\r\n\r\n```\r\n\r\n**logs : \r\n/INFO/locust.runners: All users spawned: BUser: 1, AUser: 0 (4 already running)**\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1635/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1635/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1633", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1633/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1633/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1633/events", "html_url": "https://github.com/locustio/locust/issues/1633", "id": 745045936, "node_id": "MDU6SXNzdWU3NDUwNDU5MzY=", "number": 1633, "title": "Install on Windows 10 19041 with Python 3.9 Fails", "user": {"login": "mhornbacher", "id": 12478828, "node_id": "MDQ6VXNlcjEyNDc4ODI4", "avatar_url": "https://avatars.githubusercontent.com/u/12478828?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mhornbacher", "html_url": "https://github.com/mhornbacher", "followers_url": "https://api.github.com/users/mhornbacher/followers", "following_url": "https://api.github.com/users/mhornbacher/following{/other_user}", "gists_url": "https://api.github.com/users/mhornbacher/gists{/gist_id}", "starred_url": "https://api.github.com/users/mhornbacher/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mhornbacher/subscriptions", "organizations_url": "https://api.github.com/users/mhornbacher/orgs", "repos_url": "https://api.github.com/users/mhornbacher/repos", "events_url": "https://api.github.com/users/mhornbacher/events{/privacy}", "received_events_url": "https://api.github.com/users/mhornbacher/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-11-17T20:00:40Z", "updated_at": "2020-11-18T17:59:38Z", "closed_at": "2020-11-18T17:59:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nLocust Fails to install on Windows 10 with unclear error messaging\r\n\r\n### Expected behavior\r\nAs per the docs, `pip install locust` should install with all known dependencies\r\n\r\n### Actual behavior\r\nThe following packages/dependencies fail:\r\n\r\n<details><summary>Error Log</summary>\r\n<p>\r\n```\r\nCollecting gevent>=20.9.0\r\n  Using cached gevent-20.9.0.tar.gz (5.8 MB)\r\n  Installing build dependencies ... error\r\n  ERROR: Command errored out with exit status 1:\r\n   command: 'c:\\python\\python39\\python.exe' 'c:\\python\\python39\\lib\\site-packages\\pip' install --ignore-installed --no-user --prefix 'C:\\Users\\mende\\AppData\\Local\\Temp\\pip-build-env-bdtycr2l\\overlay' --no-warn-script-location --no-binary :none: --only-binary :none: -i https://pypi.org/simple -- 'setuptools >= 40.8.0' wheel 'Cython >= 3.0a5' 'cffi >= 1.12.3 ; platform_python_implementation == '\"'\"'CPython'\"'\"'' 'greenlet >= 0.4.17 ; platform_python_implementation == '\"'\"'CPython'\"'\"''\r\n       cwd: None\r\n  Complete output (54 lines):\r\n  Collecting setuptools>=40.8.0\r\n    Using cached setuptools-50.3.2-py3-none-any.whl (785 kB)\r\n  Collecting wheel\r\n    Using cached wheel-0.35.1-py2.py3-none-any.whl (33 kB)\r\n  Collecting Cython>=3.0a5\r\n    Using cached Cython-3.0a6-py2.py3-none-any.whl (1.0 MB)\r\n  Collecting cffi>=1.12.3\r\n    Using cached cffi-1.14.3-cp39-cp39-win_amd64.whl (179 kB)\r\n  Collecting greenlet>=0.4.17\r\n    Using cached greenlet-0.4.17.tar.gz (61 kB)\r\n  Collecting pycparser\r\n    Using cached pycparser-2.20-py2.py3-none-any.whl (112 kB)\r\n  Building wheels for collected packages: greenlet\r\n    Building wheel for greenlet (setup.py): started\r\n    Building wheel for greenlet (setup.py): finished with status 'error'\r\n    ERROR: Command errored out with exit status 1:\r\n     command: 'c:\\python\\python39\\python.exe' -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'C:\\\\Users\\\\mende\\\\AppData\\\\Local\\\\Temp\\\\pip-install-ys0jxgam\\\\greenlet\\\\setup.py'\"'\"'; __file__='\"'\"'C:\\\\Users\\\\mende\\\\AppData\\\\Local\\\\Temp\\\\pip-install-ys0jxgam\\\\greenlet\\\\setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' bdist_wheel -d 'C:\\Users\\mende\\AppData\\Local\\Temp\\pip-wheel-v8jnpexu'\r\n         cwd: C:\\Users\\mende\\AppData\\Local\\Temp\\pip-install-ys0jxgam\\greenlet\\\r\n    Complete output (11 lines):\r\n    running bdist_wheel\r\n    running build\r\n    running build_ext\r\n    building 'greenlet' extension\r\n    creating build\r\n    creating build\\temp.win-amd64-3.9\r\n    creating build\\temp.win-amd64-3.9\\Release\r\n    C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\x86_amd64\\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MD -Ic:\\python\\python39\\include -Ic:\\python\\python39\\include -IC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\INCLUDE -IC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\ATLMFC\\INCLUDE -IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.10240.0\\ucrt /Tcgreenlet.c /Fobuild\\temp.win-amd64-3.9\\Release\\greenlet.obj\r\n    greenlet.c\r\n    c:\\python\\python39\\include\\pyconfig.h(201): fatal error C1083: Cannot open include file: 'basetsd.h': No such file or directory\r\n    error: command 'C:\\\\Program Files (x86)\\\\Microsoft Visual Studio 14.0\\\\VC\\\\BIN\\\\x86_amd64\\\\cl.exe' failed with exit code 2\r\n    ----------------------------------------\r\n    ERROR: Failed building wheel for greenlet\r\n    Running setup.py clean for greenlet\r\n  Failed to build greenlet\r\n  Installing collected packages: setuptools, wheel, Cython, pycparser, cffi, greenlet\r\n      Running setup.py install for greenlet: started\r\n      Running setup.py install for greenlet: finished with status 'error'\r\n      ERROR: Command errored out with exit status 1:\r\n       command: 'c:\\python\\python39\\python.exe' -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'C:\\\\Users\\\\mende\\\\AppData\\\\Local\\\\Temp\\\\pip-install-ys0jxgam\\\\greenlet\\\\setup.py'\"'\"'; __file__='\"'\"'C:\\\\Users\\\\mende\\\\AppData\\\\Local\\\\Temp\\\\pip-install-ys0jxgam\\\\greenlet\\\\setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' install --record 'C:\\Users\\mende\\AppData\\Local\\Temp\\pip-record-gsxprrl8\\install-record.txt' --single-version-externally-managed --prefix 'C:\\Users\\mende\\AppData\\Local\\Temp\\pip-build-env-bdtycr2l\\overlay' --compile --install-headers 'C:\\Users\\mende\\AppData\\Local\\Temp\\pip-build-env-bdtycr2l\\overlay\\Include\\greenlet'\r\n           cwd: C:\\Users\\mende\\AppData\\Local\\Temp\\pip-install-ys0jxgam\\greenlet\\\r\n      Complete output (11 lines):\r\n      running install\r\n      running build\r\n      running build_ext\r\n      building 'greenlet' extension\r\n      creating build\r\n      creating build\\temp.win-amd64-3.9\r\n      creating build\\temp.win-amd64-3.9\\Release\r\n      C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\x86_amd64\\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MD -Ic:\\python\\python39\\include -Ic:\\python\\python39\\include -IC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\INCLUDE -IC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\ATLMFC\\INCLUDE -IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.10240.0\\ucrt /Tcgreenlet.c /Fobuild\\temp.win-amd64-3.9\\Release\\greenlet.obj\r\n      greenlet.c\r\n      c:\\python\\python39\\include\\pyconfig.h(201): fatal error C1083: Cannot open include file: 'basetsd.h': No such file or directory\r\n      error: command 'C:\\\\Program Files (x86)\\\\Microsoft Visual Studio 14.0\\\\VC\\\\BIN\\\\x86_amd64\\\\cl.exe' failed with exit code 2\r\n      ----------------------------------------\r\n  ERROR: Command errored out with exit status 1: 'c:\\python\\python39\\python.exe' -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'C:\\\\Users\\\\mende\\\\AppData\\\\Local\\\\Temp\\\\pip-install-ys0jxgam\\\\greenlet\\\\setup.py'\"'\"'; __file__='\"'\"'C:\\\\Users\\\\mende\\\\AppData\\\\Local\\\\Temp\\\\pip-install-ys0jxgam\\\\greenlet\\\\setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' install --record 'C:\\Users\\mende\\AppData\\Local\\Temp\\pip-record-gsxprrl8\\install-record.txt' --single-version-externally-managed --prefix 'C:\\Users\\mende\\AppData\\Local\\Temp\\pip-build-env-bdtycr2l\\overlay' --compile --install-headers 'C:\\Users\\mende\\AppData\\Local\\Temp\\pip-build-env-bdtycr2l\\overlay\\Include\\greenlet' Check the logs for full command output.\r\n  ----------------------------------------\r\nERROR: Command errored out with exit status 1: 'c:\\python\\python39\\python.exe' 'c:\\python\\python39\\lib\\site-packages\\pip' install --ignore-installed --no-user --prefix 'C:\\Users\\mende\\AppData\\Local\\Temp\\pip-build-env-bdtycr2l\\overlay' --no-warn-script-location --no-binary :none: --only-binary :none: -i https://pypi.org/simple -- 'setuptools >= 40.8.0' wheel 'Cython >= 3.0a5' 'cffi >= 1.12.3 ; platform_python_implementation == '\"'\"'CPython'\"'\"'' 'greenlet >= 0.4.17 ; platform_python_implementation == '\"'\"'CPython'\"'\"'' Check the logs for full command output.\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n### Steps to reproduce\r\n`pip install locust` on following environment as administrator\r\n\r\n### Environment\r\n\r\n- OS: Windows 10 Pro Build 19041\r\n- Python version: 3.9.0\r\n- Locust version: N/A\r\n- Locust command line that you ran: N/A\r\n- Locust file contents (anonymized if necessary): N/A\r\n- Pip: 20.2.4 from c:\\python\\python39\\lib\\site-packages\\pip (python 3.9)`\r\n- Visual Studio along with Visual C++ 14 installed.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1633/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1633/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1629", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1629/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1629/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1629/events", "html_url": "https://github.com/locustio/locust/issues/1629", "id": 743652173, "node_id": "MDU6SXNzdWU3NDM2NTIxNzM=", "number": 1629, "title": "Locust docker version 1.4.0 using 100% CPU on idle", "user": {"login": "simakuutio", "id": 12248758, "node_id": "MDQ6VXNlcjEyMjQ4NzU4", "avatar_url": "https://avatars.githubusercontent.com/u/12248758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/simakuutio", "html_url": "https://github.com/simakuutio", "followers_url": "https://api.github.com/users/simakuutio/followers", "following_url": "https://api.github.com/users/simakuutio/following{/other_user}", "gists_url": "https://api.github.com/users/simakuutio/gists{/gist_id}", "starred_url": "https://api.github.com/users/simakuutio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/simakuutio/subscriptions", "organizations_url": "https://api.github.com/users/simakuutio/orgs", "repos_url": "https://api.github.com/users/simakuutio/repos", "events_url": "https://api.github.com/users/simakuutio/events{/privacy}", "received_events_url": "https://api.github.com/users/simakuutio/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 17, "created_at": "2020-11-16T08:58:46Z", "updated_at": "2020-11-16T15:11:55Z", "closed_at": "2020-11-16T15:11:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "Test environment:\r\nUbuntu 18.04.1\r\nDocker version 19.03.6\r\n\r\nEnvironment stays the same only the docker image version is changed.\r\nRunning the docker container with the same locustifle.py which is an example from https://hub.docker.com/r/locustio/locust\r\n\r\n```python\r\nfrom locust import HttpUser, task\r\n\r\nclass QuickstartUser(HttpUser):\r\n    def on_start(self):\r\n        self.client.post\r\n(\"/login\", json={\"username\":\"foo\", \"password\":\"bar\"})\r\n\r\n    @task\r\n    def hello_world(self):\r\n        self.client.get(\"/hello\")\r\n        self.client.get(\"/world\")\r\n\r\n    @task(3)\r\n    def view_item(self):\r\n        for item_id in range(10):\r\n            self.client.get(f\"/item?id={item_id}\", name=\"/item\")\r\n```\r\n\r\nWhen running locustio/locust version 1.3.2 the idle CPU load is around 0.0% and stable. \r\n\r\nRunning locustio/locust version 1.4.0 the idle CPU load goes up to 100.0% at once when the container is started and stays between 96.7% and 100.0%.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1629/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1629/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1627", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1627/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1627/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1627/events", "html_url": "https://github.com/locustio/locust/issues/1627", "id": 742221720, "node_id": "MDU6SXNzdWU3NDIyMjE3MjA=", "number": 1627, "title": "When I set --run-time, occasionally it won\u2019t stop", "user": {"login": "UyNewNas", "id": 49863417, "node_id": "MDQ6VXNlcjQ5ODYzNDE3", "avatar_url": "https://avatars.githubusercontent.com/u/49863417?v=4", "gravatar_id": "", "url": "https://api.github.com/users/UyNewNas", "html_url": "https://github.com/UyNewNas", "followers_url": "https://api.github.com/users/UyNewNas/followers", "following_url": "https://api.github.com/users/UyNewNas/following{/other_user}", "gists_url": "https://api.github.com/users/UyNewNas/gists{/gist_id}", "starred_url": "https://api.github.com/users/UyNewNas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/UyNewNas/subscriptions", "organizations_url": "https://api.github.com/users/UyNewNas/orgs", "repos_url": "https://api.github.com/users/UyNewNas/repos", "events_url": "https://api.github.com/users/UyNewNas/events{/privacy}", "received_events_url": "https://api.github.com/users/UyNewNas/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-11-13T07:20:52Z", "updated_at": "2020-11-18T18:14:06Z", "closed_at": "2020-11-18T18:12:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\nI created a websocket User class and add it to my test, but  When I set --run-time, sometimes it won\u2019t stop.\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\nIf run time is up, it should stop actively.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: MacOS X\r\n- Python version: 3.7.3\r\n- Locust version: 1.3.1\r\n- Locust command line that you ran: locust -f <LocustFile> --run-time 5m -u 10 -r 10 --headless\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1627/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1627/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1624", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1624/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1624/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1624/events", "html_url": "https://github.com/locustio/locust/issues/1624", "id": 740650618, "node_id": "MDU6SXNzdWU3NDA2NTA2MTg=", "number": 1624, "title": "The FastHttpUser Bug", "user": {"login": "hdzys", "id": 45445106, "node_id": "MDQ6VXNlcjQ1NDQ1MTA2", "avatar_url": "https://avatars.githubusercontent.com/u/45445106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hdzys", "html_url": "https://github.com/hdzys", "followers_url": "https://api.github.com/users/hdzys/followers", "following_url": "https://api.github.com/users/hdzys/following{/other_user}", "gists_url": "https://api.github.com/users/hdzys/gists{/gist_id}", "starred_url": "https://api.github.com/users/hdzys/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hdzys/subscriptions", "organizations_url": "https://api.github.com/users/hdzys/orgs", "repos_url": "https://api.github.com/users/hdzys/repos", "events_url": "https://api.github.com/users/hdzys/events{/privacy}", "received_events_url": "https://api.github.com/users/hdzys/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-11-11T10:23:28Z", "updated_at": "2020-11-13T19:50:47Z", "closed_at": "2020-11-11T10:42:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\nWhen I use fasthttpuser, the following error will be reported when configuring headers in the request\uff1a\r\n\r\n[2020-11-11 18:12:33,265] thecovercs/INFO/locust.main: Starting Locust 1.3.2\r\n[2020-11-11 18:12:33,678] thecovercs/INFO/locust.runners: Spawning 400 users at the rate 2 users/s (0 users already running)...\r\n[2020-11-11 18:12:33,856] thecovercs/ERROR/locust.user.task: only SOCK_STREAM type sockets are supported\r\nTraceback (most recent call last):\r\n  File \"d:\\python\\lib\\site-packages\\locust\\user\\task.py\", line 290, in run\r\n    self.execute_next_task()\r\n  File \"d:\\python\\lib\\site-packages\\locust\\user\\task.py\", line 315, in execute_next_task\r\n    self.execute_task(self._task_queue.pop(0))\r\n  File \"d:\\python\\lib\\site-packages\\locust\\user\\task.py\", line 327, in execute_task\r\n    task(self)\r\n  File \"D:\\thecover_project\\api_locust\\har_to_api\\har_file\\hlj\\locust_hlj.py\", line 27, in api_activate_device_data\r\n    with self.client.post(r_url, data=requests_data, headers=headers, catch_response=True) as r:\r\n  File \"d:\\python\\lib\\site-packages\\locust\\contrib\\fasthttp.py\", line 261, in post\r\n    return self.request(\"POST\", path, data=data, **kwargs)\r\n  File \"d:\\python\\lib\\site-packages\\locust\\contrib\\fasthttp.py\", line 189, in request\r\n    response = self._send_request_safe_mode(method, url, payload=data, headers=headers, **kwargs)\r\n  File \"d:\\python\\lib\\site-packages\\locust\\contrib\\fasthttp.py\", line 109, in _send_request_safe_mode\r\n    return self.client.urlopen(url, method=method, **kwargs)\r\n  File \"d:\\python\\lib\\site-packages\\geventhttpclient\\useragent.py\", line 359, in urlopen\r\n    last_error = self._handle_error(e, url=req.url)\r\n  File \"d:\\python\\lib\\site-packages\\geventhttpclient\\useragent.py\", line 326, in _handle_error\r\n    raise reraise(type(e), e, sys.exc_info()[2])\r\n  File \"d:\\python\\lib\\site-packages\\six.py\", line 703, in reraise\r\n    raise value\r\n  File \"d:\\python\\lib\\site-packages\\geventhttpclient\\useragent.py\", line 354, in urlopen\r\n    resp = self._urlopen(req)\r\n  File \"d:\\python\\lib\\site-packages\\locust\\contrib\\fasthttp.py\", line 402, in _urlopen\r\n    resp = client.request(\r\n  File \"d:\\python\\lib\\site-packages\\geventhttpclient\\client.py\", line 236, in request\r\n    sock.sendfile(body)\r\n  File \"d:\\python\\lib\\site-packages\\gevent\\_socket3.py\", line 684, in sendfile\r\n    return self._sendfile_use_send(file, offset, count)\r\n  File \"d:\\python\\lib\\site-packages\\gevent\\_socket3.py\", line 614, in _sendfile_use_send\r\n    self._check_sendfile_params(file, offset, count)\r\n  File \"d:\\python\\lib\\site-packages\\gevent\\_socket3.py\", line 653, in _check_sendfile_params\r\n    raise ValueError(\"only SOCK_STREAM type sockets are supported\")\r\nValueError: only SOCK_STREAM type sockets are supported\r\n\r\nif I replace fasthttpuser with httpuser or remove the headers , I will not report an error. Of course,  I don't know why\u3002\r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version: Python 3.8.3\r\n- Locust version: locust 1.3.2\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):\r\n\r\nimport math\r\nimport json\r\nfrom locust import SequentialTaskSet, task, constant, HttpUser\r\nfrom locust.contrib.fasthttp import FastHttpUser\r\nfrom run_locust import locust_run as lr\r\nfrom locust import LoadTestShape\r\n\r\nclass JiGuangXinWen1106(SequentialTaskSet):\r\n\r\n    @task\r\n    def api_activate_device_data(self):\r\n        headers = {'Content-Type': 'application/x-www-form-urlencoded; charset=utf-8', 'tenantId': '10'}\r\n        r_url = \"/activateDeviceData?vno=2.4.4\"\r\n        requests_data = {'account': 'D8CAB84A-53AB-4E54-A1DA-76C86F0976EA', 'client': 'iOS', 'data': '{\"device_id\":\"2060BEAB-4CF8-4289-81B2-A6E4F0F4F4E4-FZRH\",\"device_type\":\"ios\",\"idfa\":\"39A0FCB4-42F3-495E-B9EF-C588A656104D\"}', 'deviceid': '2060BEAB-4CF8-4289-81B2-A6E4F0F4F4E4-FZRH', 'sign': '3D7D33137F9622352A8EC07220AC9ED9', 'timestamp': '1604647305575', 'token': ''}\r\n        with self.client.post(r_url, data=requests_data, headers=headers, catch_response=True) as r:\r\n            if r.content == b\"\":\r\n                r.failure(\"No data\")\r\n            if r.status_code != 200:\r\n                em = \"request error --\" + str(r.status_code)\r\n                r.failure(em)\r\n\r\nclass locust_hlj_locust(FastHttpUser):\r\n    host = \"https://*****.com\"\r\n    wait_time = constant(0)\r\n    tasks = {JiGuangXinWen1106: 1}\r\n\r\n\r\nclass StagesShape(LoadTestShape):\r\n    all_user = lr.user\r\n    run_time = lr.run_time\r\n    time_limit = 0\r\n    sleep_time = int(run_time[:-1])\r\n    if run_time[-1] == 'h':\r\n        time_limit = sleep_time * 60 * 60\r\n    if run_time[-1] == 'm':\r\n        time_limit = sleep_time * 60\r\n    if run_time[-1] == 's':\r\n        time_limit = sleep_time\r\n\r\n    stages = [\r\n        {\"duration\": round(time_limit*1/4), \"users\": all_user, \"spawn_rate\": math.ceil(4*all_user/time_limit)},\r\n        {\"duration\": round(time_limit*3/4), \"users\": all_user, \"spawn_rate\": math.ceil(2*all_user/time_limit)},\r\n        {\"duration\": round(time_limit), \"users\": 1, \"spawn_rate\": math.ceil(4*all_user/time_limit)}\r\n    ]\r\n    print(stages)\r\n\r\n    def tick(self):\r\n        run_time = self.get_run_time()\r\n        for stage in self.stages:\r\n            # print('****', run_time, \"*****\", stage[\"duration\"], '*****', stage[\"spawn_rate\"])\r\n            if run_time <= stage[\"duration\"]:\r\n                tick_data = (stage[\"users\"], stage[\"spawn_rate\"])\r\n                return tick_data\r\n        return None\r\n\r\n\r\n`", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1624/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1624/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1622", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1622/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1622/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1622/events", "html_url": "https://github.com/locustio/locust/issues/1622", "id": 739759478, "node_id": "MDU6SXNzdWU3Mzk3NTk0Nzg=", "number": 1622, "title": "FAILURES Calculation error", "user": {"login": "solxnp", "id": 18416053, "node_id": "MDQ6VXNlcjE4NDE2MDUz", "avatar_url": "https://avatars.githubusercontent.com/u/18416053?v=4", "gravatar_id": "", "url": "https://api.github.com/users/solxnp", "html_url": "https://github.com/solxnp", "followers_url": "https://api.github.com/users/solxnp/followers", "following_url": "https://api.github.com/users/solxnp/following{/other_user}", "gists_url": "https://api.github.com/users/solxnp/gists{/gist_id}", "starred_url": "https://api.github.com/users/solxnp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/solxnp/subscriptions", "organizations_url": "https://api.github.com/users/solxnp/orgs", "repos_url": "https://api.github.com/users/solxnp/repos", "events_url": "https://api.github.com/users/solxnp/events{/privacy}", "received_events_url": "https://api.github.com/users/solxnp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-11-10T09:54:47Z", "updated_at": "2020-11-10T10:46:20Z", "closed_at": "2020-11-10T10:46:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n![image](https://user-images.githubusercontent.com/18416053/98657696-1aa77b80-237d-11eb-904e-1a11ff9df299.png)\r\n\r\n\r\n- OS:\r\n- Python version: 3.8.5\r\n- Locust version: 1.3.2\r\n- Locust command line that you ran: locust -f master.py --master --web-host=0.0.0.0\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1622/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1622/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1620", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1620/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1620/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1620/events", "html_url": "https://github.com/locustio/locust/issues/1620", "id": 738324139, "node_id": "MDU6SXNzdWU3MzgzMjQxMzk=", "number": 1620, "title": "ERROR/locust.main: No User class found!", "user": {"login": "RajVrach", "id": 14893895, "node_id": "MDQ6VXNlcjE0ODkzODk1", "avatar_url": "https://avatars.githubusercontent.com/u/14893895?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RajVrach", "html_url": "https://github.com/RajVrach", "followers_url": "https://api.github.com/users/RajVrach/followers", "following_url": "https://api.github.com/users/RajVrach/following{/other_user}", "gists_url": "https://api.github.com/users/RajVrach/gists{/gist_id}", "starred_url": "https://api.github.com/users/RajVrach/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RajVrach/subscriptions", "organizations_url": "https://api.github.com/users/RajVrach/orgs", "repos_url": "https://api.github.com/users/RajVrach/repos", "events_url": "https://api.github.com/users/RajVrach/events{/privacy}", "received_events_url": "https://api.github.com/users/RajVrach/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-11-07T21:54:04Z", "updated_at": "2020-11-09T09:00:24Z", "closed_at": "2020-11-09T01:11:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "Not able to run even the basic example it just fails\r\n\r\n$ sudo docker run -p 8089:8089 -v $PWD:/mnt/locust locustio/locust --version\r\nlocust 1.3.2\r\n\r\n$ sudo docker run -p 8089:8089 -v $PWD:/mnt/locust locustio/locust -f /mnt/locust/loadtest.py\r\n**[2020-11-07 21:47:12,765] 8a57da46bd88/ERROR/locust.main: No User class found!**\r\n\r\n\r\nhttps://github.com/locustio/locust/blob/master/examples/basic.py\r\n```\r\nfrom locust import HttpUser, TaskSet, task, between\r\n\r\n\r\ndef index(l):\r\n    l.client.get(\"/\")\r\n\r\n\r\ndef stats(l):\r\n    l.client.get(\"/stats/requests\")\r\n\r\n\r\nclass UserTasks(TaskSet):\r\n    # one can specify tasks like this\r\n    tasks = [index, stats]\r\n\r\n    # but it might be convenient to use the @task decorator\r\n    @task\r\n    def page404(self):\r\n        self.client.get(\"/does_not_exist\")\r\n\r\n\r\nclass WebsiteUser(HttpUser):\r\n    \"\"\"\r\n    User class that does requests to the locust web server running on localhost\r\n    \"\"\"\r\n\r\n    host = \"http://127.0.0.1:8089\"\r\n    wait_time = between(2, 5)\r\n    tasks = [UserTasks]\r\n```\r\n\r\nI tried bunch of different examples from docs..same error.\r\n\r\nPS; i tried installing on Ubuntu 20 directly without docker and same error \r\n```\r\n$ locust --version\r\nlocust 1.3.2\r\n\r\n$locust -f loadtest.py\r\n[2020-11-07 16:52:31,048] student/ERROR/locust.main: No User class found!\r\n```\r\n\r\nI am I missing something?\r\n\r\nThanks\r\nRaj", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1620/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1620/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1619", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1619/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1619/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1619/events", "html_url": "https://github.com/locustio/locust/issues/1619", "id": 738262128, "node_id": "MDU6SXNzdWU3MzgyNjIxMjg=", "number": 1619, "title": "Locust UI not capturing API details of the test run", "user": {"login": "ruby2001", "id": 41570098, "node_id": "MDQ6VXNlcjQxNTcwMDk4", "avatar_url": "https://avatars.githubusercontent.com/u/41570098?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ruby2001", "html_url": "https://github.com/ruby2001", "followers_url": "https://api.github.com/users/ruby2001/followers", "following_url": "https://api.github.com/users/ruby2001/following{/other_user}", "gists_url": "https://api.github.com/users/ruby2001/gists{/gist_id}", "starred_url": "https://api.github.com/users/ruby2001/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ruby2001/subscriptions", "organizations_url": "https://api.github.com/users/ruby2001/orgs", "repos_url": "https://api.github.com/users/ruby2001/repos", "events_url": "https://api.github.com/users/ruby2001/events{/privacy}", "received_events_url": "https://api.github.com/users/ruby2001/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-11-07T15:24:17Z", "updated_at": "2020-11-12T21:56:53Z", "closed_at": "2020-11-12T21:56:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am trying to use Locust to load test GraphQL APIs. This is my test tasks.py code. \r\n\r\n`import uuid\r\n\r\nfrom datetime import datetime\r\nfrom locust import HttpLocust, TaskSet, task\r\nfrom python_graphql_client import GraphqlClient\r\n\r\n\r\nclass UserBehavior(TaskSet):\r\n    def on_start(self):\r\n        self.login()\r\n\r\n    @task\r\n    def login(self):\r\n        client = GraphqlClient(endpoint=\"https://www.universe.com/graphql\")\r\n        query = \"\"\"\r\n        {\r\n          event(id: \"5879ad8f6672e70036d58ba5\") {\r\n            title\r\n            address\r\n            currency\r\n            host {\r\n              firstName\r\n            }\r\n            timeSlots {\r\n              totalCount\r\n              nodes {\r\n                startAt\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        \"\"\"\r\n        data = client.execute(query=query)\r\n        print(data)\r\nclass GraphQLSample(HttpLocust):\r\n\r\n    host = \"https://www.universe.com/graphql\"\r\n    min_wait = 20000\r\n    max_wait = 50000\r\n    task_set = UserBehavior\r\n`\r\n\r\nWhen test is started from locust UI, API is triggering and same can be seen on pod logs,\r\n`[2020-11-06 21:02:54,090] locust-worker-547cb4459b-mps4p/INFO/stdout:\r\n[2020-11-06 21:16:31,501] locust-worker-547cb4459b-mps4p/INFO/locust.runners: Hatching and swarming 1 clients at the rate 1 clients/s...\r\n[2020-11-06 21:16:31,730] locust-worker-547cb4459b-mps4p/INFO/stdout: {'data': {'event': {'title': 'End of Unix Time', 'address': 'Los Angeles, CA, USA', 'currency': 'USD', 'host': {'firstName': 'Joshua'}, 'timeSlots': {'totalCount': 2, 'nodes': [{'startAt': '2018-08-31T12:00:00'}, {'startAt': '2038-01-18T21:00:00'}]}}}}\r\n[2020-11-06 21:16:31,731] locust-worker-547cb4459b-mps4p/INFO/stdout:\r\n[2020-11-06 21:16:32,118] locust-worker-547cb4459b-mps4p/INFO/stdout: {'data': {'event': {'title': 'End of Unix Time', 'address': 'Los Angeles, CA, USA', 'currency': 'USD', 'host': {'firstName': 'Joshua'}, 'timeSlots': {'totalCount': 2, 'nodes': [{'startAt': '2018-08-31T12:00:00'}, {'startAt': '2038-01-18T21:00:00'}]}}}}\r\n[2020-11-06 21:16:32,118] locust-worker-547cb4459b-mps4p/INFO/stdout:\r\n[2020-11-06 21:16:32,502] locust-worker-547cb4459b-mps4p/INFO/locust.runners: All locusts hatched: ApolloSample: 1`\r\n\r\nBut these statistics are not present in the locust UI, it has no data of API calls made. Would really appreciate any help on this to unblock and proceed here.\r\n\r\nLib versions used,\r\n`certifi==2019.3.9\r\nchardet==3.0.4\r\nClick==7.0\r\nFlask==1.0.2\r\ngevent==1.4.0\r\ngreenlet==0.4.15\r\nidna==2.8\r\nitsdangerous==1.1.0\r\nJinja2==2.10.1\r\nlocustio==0.11.0\r\nMarkupSafe==1.1.1\r\nmsgpack==0.6.1\r\nmsgpack-python==0.5.6\r\npyzmq==18.0.1\r\nrequests==2.21.0\r\nsix==1.12.0\r\nurllib3==1.24.2\r\nWerkzeug==0.15.1\r\npython-graphql-client==0.3.1`\r\n\r\nThanks in advance!  ", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1619/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1619/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1618", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1618/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1618/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1618/events", "html_url": "https://github.com/locustio/locust/issues/1618", "id": 738110829, "node_id": "MDU6SXNzdWU3MzgxMTA4Mjk=", "number": 1618, "title": "Distribution of user classes is not respected and some user classes are just never spawned", "user": {"login": "mboutet", "id": 52334444, "node_id": "MDQ6VXNlcjUyMzM0NDQ0", "avatar_url": "https://avatars.githubusercontent.com/u/52334444?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mboutet", "html_url": "https://github.com/mboutet", "followers_url": "https://api.github.com/users/mboutet/followers", "following_url": "https://api.github.com/users/mboutet/following{/other_user}", "gists_url": "https://api.github.com/users/mboutet/gists{/gist_id}", "starred_url": "https://api.github.com/users/mboutet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mboutet/subscriptions", "organizations_url": "https://api.github.com/users/mboutet/orgs", "repos_url": "https://api.github.com/users/mboutet/repos", "events_url": "https://api.github.com/users/mboutet/events{/privacy}", "received_events_url": "https://api.github.com/users/mboutet/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 19, "created_at": "2020-11-07T00:06:01Z", "updated_at": "2021-07-05T19:11:37Z", "closed_at": "2021-07-05T19:11:37Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nWhen using `LoadTestShape` in distributed mode and with multiple user classes having different weights, the distribution of users does not respect the weights (even within some tolerance). Furthermore, users with the smaller weights are often never picked up. The problem appears especially when the `LoadTestShape` specifies stages with small increments (e.g. 5 users at a time).\r\n\r\n### Expected behavior\r\nThe distribution of users should take into account the overall distribution of users across all workers.\r\n\r\n### Actual behavior\r\nSome user classes with lower weights are never picked up and the distribution of users does not respect the weights (even within a certain tolerance).\r\n\r\n### Steps to reproduce\r\nI think the problem is that each worker is responsible for spawning its own users. Consider the following setup:\r\n- 5 workers\r\n- Load test shape that increases the users by 5 at a rate of 1/s each minute until 100 users\r\n-  3 user classes with weights `[35, 55, 10]`\r\nOnce the test starts, the master will instruct each worker to spawn 1 user every minute. However, the `weight_users` function will always return the user with the weight of 55.\r\n\r\n### Possible solutions\r\nI see two aspects that needs to be implemented:\r\n1. I think that when running in distributed mode, the master runner should instruct the number of each user class to the workers instead of only the number of users. The worker runner would thus spawn the specified users as-is instead of computing the buckets.\r\n2. The master runner should keep a state of all the running users and their class so that it can spawn the appropriate classes in order to preserve the distribution as much as possible. This state could also serve to solve  https://github.com/locustio/locust/issues/896.\r\n\r\nI'm not super familiar with the codebase, but would that make sense? Is there some technical limitation I'm not aware of?\r\n\r\n### Environment\r\n\r\n- OS: Ubuntu 18.04.5 LTS (GNU/Linux 5.4.0-1031-azure x86_64)\r\n- Python version: Python 3.7.9\r\n- Locust version: locust==1.3.1\r\n- Locust command line that you ran: \r\n\r\nMaster:\r\n```shell\r\n  \"${python_exec}\" -m locust \\\r\n    --locustfile load_tests/locustfile_generated.py \\\r\n    --master \\\r\n    --master-bind-host \"${master_host}\" \\\r\n    --master-bind-port \"${master_port}\" \\\r\n    --expect-workers \"${number_of_workers}\" \\\r\n    --stop-timeout 900 \\\r\n    --csv=\"${results_path}/results\" \\\r\n    --logfile \"${results_path}/logs.log\" \\\r\n    --loglevel \"DEBUG\"\r\n```\r\nWorkers:\r\n```shell\r\n  \"${python_exec}\" -m locust \\\r\n    --locustfile load_tests/locustfile_generated.py \\\r\n    --worker \\\r\n    --master-host \"${master_host}\" \\\r\n    --master-port \"${master_port}\" \\\r\n    --csv=\"${results_path}/results\" \\\r\n    --logfile \"${results_path}/logs.log\" \\\r\n    --loglevel \"DEBUG\"\r\n```\r\n- Locust file contents (anonymized if necessary):\r\nThe content of each test has been omitted. Also, this file is rendered from a template, so that is why the classes and tasks have generic names.\r\n```python\r\nimport json\r\nimport os\r\nimport random\r\nimport uuid\r\nfrom pathlib import Path\r\n\r\nimport locust.stats\r\nfrom essential_generators import DocumentGenerator\r\nfrom locust import (\r\n    HttpUser,\r\n    LoadTestShape,\r\n    between,\r\n    task,\r\n)\r\n\r\nfrom load_tests.api.common import (\r\n    create_user,\r\n    delete_user,\r\n    get_password,\r\n)\r\n\r\nlocust.stats.CSV_STATS_INTERVAL_SEC = 2\r\n\r\ncurrent_path = Path(os.path.split(__file__)[0])\r\n\r\nhost = os.environ['API_HOST']\r\n\r\ncached_data_file_path = os.environ['CACHED_DATA_FILE_PATH']\r\n\r\ngen = DocumentGenerator()\r\n\r\nrandom.seed()\r\n\r\n\r\nclass Test1(HttpUser):\r\n\r\n    wait_time = between(5, 10)\r\n    weight = 35\r\n    host = host\r\n\r\n    def __init__(self, *args, **kwargs):\r\n        super().__init__(*args, **kwargs)\r\n        self.user_id = None\r\n        self.username = None\r\n        self.password = None\r\n        with open(cached_data_file_path, \"rt\") as file:\r\n            self.cached_data = json.load(file)\r\n\r\n    def on_start(self):\r\n        self.username = f\"test-user-{uuid.uuid4()}\"\r\n        self.password = get_password()\r\n        self.user_id, user = create_user(self.client, self.username, self.password)\r\n\r\n    def on_stop(self):\r\n        if self.user_id is not None:\r\n            delete_user(self.client, self.user_id)\r\n        self.user_id = None\r\n        self.username = None\r\n        self.password = None\r\n\r\n    @task(8)\r\n    def test1(self):\r\n        # omitted\r\n        pass\r\n\r\n    @task(8)\r\n    def test2(self):\r\n        # omitted\r\n        pass\r\n\r\n    @task(8)\r\n    def test3(self):\r\n        # omitted\r\n        pass\r\n\r\n    @task(8)\r\n    def test4(self):\r\n        # omitted\r\n        pass\r\n\r\n    @task(8)\r\n    def test5(self):\r\n        # omitted\r\n        pass\r\n\r\n    @task(8)\r\n    def test6(self):\r\n        # omitted\r\n        pass\r\n\r\n    @task(8)\r\n    def test7(self):\r\n        # omitted\r\n        pass\r\n\r\n    @task(8)\r\n    def test8(self):\r\n        # omitted\r\n        pass\r\n\r\n    @task(8)\r\n    def test9(self):\r\n        # omitted\r\n        pass\r\n\r\n    @task(8)\r\n    def test10(self):\r\n        # omitted\r\n        pass\r\n\r\n    @task(8)\r\n    def test11(self):\r\n        # omitted\r\n        pass\r\n\r\n    @task(12)\r\n    def test12(self):\r\n        # omitted\r\n        pass\r\n\r\n\r\nclass Test2(HttpUser):\r\n\r\n    wait_time = between(0, 0.5)\r\n    weight = 55\r\n    host = host\r\n\r\n    def __init__(self, *args, **kwargs):\r\n        super().__init__(*args, **kwargs)\r\n        self.user_id = None\r\n        self.username = None\r\n        self.password = None\r\n        with open(cached_data_file_path, \"rt\") as file:\r\n            self.cached_data = json.load(file)\r\n\r\n    def on_start(self):\r\n        self.username = f\"test-user-{uuid.uuid4()}\"\r\n        self.password = get_password()\r\n        self.user_id, user = create_user(self.client, self.username, self.password)\r\n\r\n    def on_stop(self):\r\n        if self.user_id is not None:\r\n            delete_user(self.client, self.user_id)\r\n        self.user_id = None\r\n        self.username = None\r\n        self.password = None\r\n\r\n    @task(50)\r\n    def test1(self):\r\n        # omitted\r\n        pass\r\n\r\n    @task(50)\r\n    def test2(self):\r\n        # omitted\r\n        pass\r\n\r\n\r\nclass Test3(HttpUser):\r\n\r\n    wait_time = between(5, 10)\r\n    weight = 10\r\n    host = host\r\n\r\n    def __init__(self, *args, **kwargs):\r\n        super().__init__(*args, **kwargs)\r\n        self.user_id = None\r\n        self.username = None\r\n        self.password = None\r\n        with open(cached_data_file_path, \"rt\") as file:\r\n            self.cached_data = json.load(file)\r\n\r\n    def on_start(self):\r\n        self.username = f\"test-user-{uuid.uuid4()}\"\r\n        self.password = get_password()\r\n        self.user_id, user = create_user(self.client, self.username, self.password)\r\n\r\n    def on_stop(self):\r\n        if self.user_id is not None:\r\n            delete_user(self.client, self.user_id)\r\n        self.user_id = None\r\n        self.username = None\r\n        self.password = None\r\n\r\n    @task(100)\r\n    def test4(self):\r\n        # omitted\r\n        pass\r\n\r\n\r\nclass StagesShape(LoadTestShape):\r\n    \"\"\"\r\n    A simply load test shape class that has different user and spawn_rate at\r\n    different stages.\r\n    Keyword arguments:\r\n        stages -- A list of dicts, each representing a stage with the following keys:\r\n            duration -- When this many seconds pass the test is advanced to the next stage\r\n            users -- Total user count\r\n            spawn_rate -- Number of users to start/stop per second\r\n            stop -- A boolean that can stop that test at a specific stage\r\n        stop_at_end -- Can be set to stop once all stages have run.\r\n    \"\"\"\r\n    stages = [\r\n        {\"duration\": 300, \"users\": 5, \"spawn_rate\": 1},\r\n        {\"duration\": 600, \"users\": 25, \"spawn_rate\": 1},\r\n        {\"duration\": 900, \"users\": 50, \"spawn_rate\": 1},\r\n        {\"duration\": 4500, \"users\": 100, \"spawn_rate\": 1},\r\n        {\"duration\": 5400, \"users\": 1, \"spawn_rate\": 1},\r\n        {\"duration\": 6300, \"users\": 50, \"spawn_rate\": 1},\r\n    ]\r\n\r\n    for previous_stage, stage in zip(stages[:-1], stages[1:]):\r\n        assert stage[\"duration\"] > previous_stage[\"duration\"]\r\n\r\n    def tick(self):\r\n        run_time = self.get_run_time()\r\n\r\n        for stage in self.stages:\r\n            if run_time < stage[\"duration\"]:\r\n                tick_data = (stage[\"users\"], stage[\"spawn_rate\"])\r\n                return tick_data\r\n\r\n        return None\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1618/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1618/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1615", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1615/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1615/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1615/events", "html_url": "https://github.com/locustio/locust/issues/1615", "id": 735339073, "node_id": "MDU6SXNzdWU3MzUzMzkwNzM=", "number": 1615, "title": "After installing the locust i am unable to get locust version.", "user": {"login": "nags28", "id": 46648905, "node_id": "MDQ6VXNlcjQ2NjQ4OTA1", "avatar_url": "https://avatars.githubusercontent.com/u/46648905?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nags28", "html_url": "https://github.com/nags28", "followers_url": "https://api.github.com/users/nags28/followers", "following_url": "https://api.github.com/users/nags28/following{/other_user}", "gists_url": "https://api.github.com/users/nags28/gists{/gist_id}", "starred_url": "https://api.github.com/users/nags28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nags28/subscriptions", "organizations_url": "https://api.github.com/users/nags28/orgs", "repos_url": "https://api.github.com/users/nags28/repos", "events_url": "https://api.github.com/users/nags28/events{/privacy}", "received_events_url": "https://api.github.com/users/nags28/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-11-03T13:54:40Z", "updated_at": "2020-11-03T16:51:19Z", "closed_at": "2020-11-03T16:48:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "### I am facing the below issue\r\n\r\n**my python version** \r\n```\r\npython3 --version \r\nPython 3.6.9 \r\n```\r\n```\r\npip3 --version pip \r\n9.0.1 from /usr/lib/python3/dist-packages (python 3.6)\r\n```\r\n\r\n**if I check the locust version I am facing the below error**\r\n\r\n`locust -v`\r\n\r\n```\r\nTraceback (most recent call last):\r\nFile \"/usr/local/bin/locust\", line 11, in\r\nload_entry_point('locust', 'console_scripts', 'locust')()\r\nFile \"/locust-task/src/locust/locust/main.py\", line 123, in main\r\ndocstring, user_classes, shape_class = load_locustfile(locustfile)\r\nFile \"/locust-task/src/locust/locust/main.py\", line 79, in load_locustfile\r\nimported = source.load_module()\r\nFile \"\", line 399, in _check_name_wrapper\r\nFile \"\", line 823, in load_module\r\nFile \"\", line 682, in load_module\r\nFile \"\", line 265, in _load_module_shim\r\nFile \"\", line 684, in _load\r\nFile \"\", line 665, in _load_unlocked\r\nFile \"\", line 678, in exec_module\r\nFile \"\", line 219, in _call_with_frames_removed\r\nFile \"/locust-task/locustfile.py\", line 1, in\r\nfrom locust import HttpLocust, TaskSet, task, InterruptTaskSet\r\nImportError: cannot import name 'InterruptTaskSet'\r\n```\r\n**can someone help me to resolve it?**", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1615/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1615/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1610", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1610/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1610/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1610/events", "html_url": "https://github.com/locustio/locust/issues/1610", "id": 731496844, "node_id": "MDU6SXNzdWU3MzE0OTY4NDQ=", "number": 1610, "title": "Download Report in multi-worker setup", "user": {"login": "mezhaka", "id": 1176545, "node_id": "MDQ6VXNlcjExNzY1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/1176545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mezhaka", "html_url": "https://github.com/mezhaka", "followers_url": "https://api.github.com/users/mezhaka/followers", "following_url": "https://api.github.com/users/mezhaka/following{/other_user}", "gists_url": "https://api.github.com/users/mezhaka/gists{/gist_id}", "starred_url": "https://api.github.com/users/mezhaka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mezhaka/subscriptions", "organizations_url": "https://api.github.com/users/mezhaka/orgs", "repos_url": "https://api.github.com/users/mezhaka/repos", "events_url": "https://api.github.com/users/mezhaka/events{/privacy}", "received_events_url": "https://api.github.com/users/mezhaka/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2020-10-28T14:30:07Z", "updated_at": "2020-11-07T10:38:03Z", "closed_at": "2020-11-07T10:38:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Is your feature request related to a problem? Please describe.\r\nI am frustrated that there's no \"Download Report\" in the multi-worker test, so I could see the summary of the test in the mult-worker environment.\r\n\r\n### Describe the solution you'd like\r\nI'd like to have the \"Download Report\" link available in the multi-worker test.  The report should aggregate the data from the workers.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1610/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1610/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1604", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1604/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1604/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1604/events", "html_url": "https://github.com/locustio/locust/issues/1604", "id": 728599091, "node_id": "MDU6SXNzdWU3Mjg1OTkwOTE=", "number": 1604, "title": "Docker run Could not find any locustfile! Ensure file ends in '.py'", "user": {"login": "jackhu008", "id": 56557114, "node_id": "MDQ6VXNlcjU2NTU3MTE0", "avatar_url": "https://avatars.githubusercontent.com/u/56557114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jackhu008", "html_url": "https://github.com/jackhu008", "followers_url": "https://api.github.com/users/jackhu008/followers", "following_url": "https://api.github.com/users/jackhu008/following{/other_user}", "gists_url": "https://api.github.com/users/jackhu008/gists{/gist_id}", "starred_url": "https://api.github.com/users/jackhu008/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jackhu008/subscriptions", "organizations_url": "https://api.github.com/users/jackhu008/orgs", "repos_url": "https://api.github.com/users/jackhu008/repos", "events_url": "https://api.github.com/users/jackhu008/events{/privacy}", "received_events_url": "https://api.github.com/users/jackhu008/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2020-10-23T23:33:41Z", "updated_at": "2021-01-29T20:34:27Z", "closed_at": "2020-10-24T14:04:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nI followed the instructions on https://docs.locust.io/en/stable/running-locust-docker.html to try to run the docker image \r\n\r\n`docker run -p 8089:8089 -v $PWD:/mnt/locust locustio/locust -f /mnt/locust/locustfile.py`\r\n\r\nbut received  this error \" Could not find any locustfile! Ensure file ends in '.py'\".\r\n\r\nHere is my locustfile.py in $PWD:\r\n```\r\nimport time\r\nfrom locust import HttpUser, task, between\r\n\r\nclass QuickstartUser(HttpUser):\r\n    wait_time = between(1, 2)\r\n    @task\r\n    def index_page(self):\r\n        self.client.get(\"/\")\r\n```\r\n\r\nThis file works fine with locust running on my local machine (Ubuntu WSL of Windows 10), i.e. not using the container.\r\nI confirm the environment variable $PWD is present and pointing to my present working directory where my locustfile.py resides.\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nThe Docker run above should start Locust server and make its UI accessible on http://localhost:8089.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n`$ docker run -p 8089:8089 -v $PWD:/mnt/locust locustio/locust  -f /mnt/locust/locusttest1.py\r\nCould not find any locustfile! Ensure file ends in '.py' and see --help for available options.\r\n`\r\nSurprisingly the above (default to latest tag) shows version 1.1.  So I also tried v 1.3.1 but got the same error. \r\n`$ docker run -p 8089:8089 -v $PWD:/mnt/locust locustio/locust:1.3.1  -f /mnt/locust/locusttest1.py\r\nCould not find any locustfile! Ensure file ends in '.py' and see --help for available options.\r\n`\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n- copy my locustfile.py contents into a new file named locustfile.py in your working directory \r\n\r\n- run `$ docker run -p 8089:8089 -v $PWD:/mnt/locust locustio/locust  -f /mnt/locust/locusttest1.py\r\n`\r\n\r\n### Environment\r\n\r\n- OS:  Ubuntu 16.04 WSL of Windows 10\r\n- Python version: irrelevant because I am running the docker image\r\n- Locust version:  1.1  as shown by `docker run -p 8089:8089 -v $PWD:/mnt/locust locustio/locust  --version`\r\n- Locust command line that you ran: see above   `docker run ... `\r\n- Locust file contents (anonymized if necessary): see above", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1604/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1604/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1602", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1602/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1602/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1602/events", "html_url": "https://github.com/locustio/locust/issues/1602", "id": 727249449, "node_id": "MDU6SXNzdWU3MjcyNDk0NDk=", "number": 1602, "title": "Cannot create security advisory", "user": {"login": "lhupfeldt", "id": 1584329, "node_id": "MDQ6VXNlcjE1ODQzMjk=", "avatar_url": "https://avatars.githubusercontent.com/u/1584329?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lhupfeldt", "html_url": "https://github.com/lhupfeldt", "followers_url": "https://api.github.com/users/lhupfeldt/followers", "following_url": "https://api.github.com/users/lhupfeldt/following{/other_user}", "gists_url": "https://api.github.com/users/lhupfeldt/gists{/gist_id}", "starred_url": "https://api.github.com/users/lhupfeldt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lhupfeldt/subscriptions", "organizations_url": "https://api.github.com/users/lhupfeldt/orgs", "repos_url": "https://api.github.com/users/lhupfeldt/repos", "events_url": "https://api.github.com/users/lhupfeldt/events{/privacy}", "received_events_url": "https://api.github.com/users/lhupfeldt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2020-10-22T10:13:08Z", "updated_at": "2020-10-22T12:28:11Z", "closed_at": "2020-10-22T12:27:54Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I want to create a bug-report/PR for a security issue but it seems I'm not allowed to create security advisories.\r\nThe fix is one line so I can email it if that is easier.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1602/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1602/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1599", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1599/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1599/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1599/events", "html_url": "https://github.com/locustio/locust/issues/1599", "id": 725158209, "node_id": "MDU6SXNzdWU3MjUxNTgyMDk=", "number": 1599, "title": "Locust as library: Web GUI doesn't show the spawned users over time and stucked at 1 user", "user": {"login": "rdagumampan", "id": 5895952, "node_id": "MDQ6VXNlcjU4OTU5NTI=", "avatar_url": "https://avatars.githubusercontent.com/u/5895952?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rdagumampan", "html_url": "https://github.com/rdagumampan", "followers_url": "https://api.github.com/users/rdagumampan/followers", "following_url": "https://api.github.com/users/rdagumampan/following{/other_user}", "gists_url": "https://api.github.com/users/rdagumampan/gists{/gist_id}", "starred_url": "https://api.github.com/users/rdagumampan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rdagumampan/subscriptions", "organizations_url": "https://api.github.com/users/rdagumampan/orgs", "repos_url": "https://api.github.com/users/rdagumampan/repos", "events_url": "https://api.github.com/users/rdagumampan/events{/privacy}", "received_events_url": "https://api.github.com/users/rdagumampan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-10-20T03:27:45Z", "updated_at": "2020-12-01T15:21:11Z", "closed_at": "2020-10-20T05:49:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nWeb GUI doesn't show the spawned users over time and stucked at 1 user.\r\n\r\n### Expected behavior\r\nWeb GUI should reflect the users spawned in realtime\r\n\r\n### Actual behavior\r\nIt was stucked at 1 user\r\n\r\n![image](https://user-images.githubusercontent.com/5895952/96536923-617de600-1295-11eb-8ed5-623c0281660d.png)\r\n\r\n### Steps to reproduce\r\n\r\n```python\r\nclass ApiTestSetup:\r\n    def __init__(self):\r\n        self.base_url = \"any url\"\r\n\r\n\r\nclass ModelBehavior(HttpUser):\r\n    # load test setup configuration\r\n    setup = ApiTestSetup()\r\n\r\n    # properties of HttpUser\r\n    # random wait time between 1 to 3 seconds before executing a task\r\n    wait_time = between(1, 3)\r\n    host = setup.base_url\r\n\r\n    @task\r\n    def get_health_alive(self):\r\n        self.client.get(\"/health/alive\", verify=False)\r\n\r\n# setup Environment and Runner\r\nenv = Environment(user_classes=[ModelBehavior])\r\nenv.create_local_runner()\r\n\r\n# start a Locust WebUI Dashboard\r\nenv.create_web_ui(\"127.0.0.1\", 5001)\r\n\r\n# start a greenlet that periodically outputs the current stats\r\ngevent.spawn(stats_printer(env.stats))\r\n\r\n# start a greenlet that save current stats to history\r\ngevent.spawn(stats_history, env.runner)\r\n\r\n# start the test with 1 user, spawn 100 users every 1 second\r\nenv.runner.start(1, spawn_rate=100, wait=True)\r\n\r\n# in (x = 60 seconds) x 5, we stop the runner\r\ngevent.spawn_later(60 * 5, lambda: env.runner.quit())\r\n\r\n# wait for the greenlets\r\nenv.runner.greenlet.join()\r\n\r\n# stop the web server for good measures\r\nenv.web_ui.stop()\r\n\r\n```\r\n\r\n### Environment\r\n\r\n- OS: win10\r\n- Python version: 3.8\r\n- Locust version: 1.3.1\r\n- Locust command line that you ran: Used as library\r\n- Locust file contents (anonymized if necessary):\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1599/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1599/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1595", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1595/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1595/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1595/events", "html_url": "https://github.com/locustio/locust/issues/1595", "id": 722937228, "node_id": "MDU6SXNzdWU3MjI5MzcyMjg=", "number": 1595, "title": "The master have no  result output\uff0cbug the csv file have~", "user": {"login": "hdzys", "id": 45445106, "node_id": "MDQ6VXNlcjQ1NDQ1MTA2", "avatar_url": "https://avatars.githubusercontent.com/u/45445106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hdzys", "html_url": "https://github.com/hdzys", "followers_url": "https://api.github.com/users/hdzys/followers", "following_url": "https://api.github.com/users/hdzys/following{/other_user}", "gists_url": "https://api.github.com/users/hdzys/gists{/gist_id}", "starred_url": "https://api.github.com/users/hdzys/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hdzys/subscriptions", "organizations_url": "https://api.github.com/users/hdzys/orgs", "repos_url": "https://api.github.com/users/hdzys/repos", "events_url": "https://api.github.com/users/hdzys/events{/privacy}", "received_events_url": "https://api.github.com/users/hdzys/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-10-16T06:15:15Z", "updated_at": "2020-11-04T11:53:47Z", "closed_at": "2020-10-16T06:26:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "Part of the locustfile\uff1a\r\n\r\n`import math\r\nimport json, random, string\r\nfrom locust import HttpUser, SequentialTaskSet, task, constant, events\r\nfrom locust import LoadTestShape\r\nfrom locust.contrib.fasthttp import FastHttpUser\r\n\r\n\r\nclass KBH(SequentialTaskSet):\r\n\r\n    @task\r\n    def get_bot_notice_list(self):\r\n        headers = {'appId': 'exhibitionbot', 'userId': 'uid107491598955646824'}\r\n        # \u8bf7\u6c42\u53c2\u6570\u7ec4\u88c5 ## r_url:\u56fa\u5b9a\u53c2\u6570\r\n        r_url = \"/chat-bot/notice-list\"\r\n        # \u53d1\u8d77\u8bf7\u6c42\r\n        with self.client.get(r_url, headers=headers, catch_response=True, name='notice-list_01') as r:\r\n            if r.content == b\"\":\r\n                r.failure(\"No data\")\r\n            if r.status_code != 200:\r\n                em = \"request error --\" + str(r.status_code)\r\n                r.failure(em)\r\n\r\nclass KBH_New(SequentialTaskSet):\r\n    *****\r\n\r\n\r\nclass DemoBlazePurchaser(FastHttpUser):\r\n    host = \"https://yyy.thecover.cn\"\r\n    wait_time = constant(0)\r\n    tasks = {KBH: 2, KBH_New: 1}\r\n\r\n\r\nclass StepLoadShape(LoadTestShape):\r\n    step_time = 60\r\n    step_load = 50\r\n    spawn_rate = 10\r\n    time_limit = 120\r\n\r\n    def tick(self):\r\n        run_time = self.get_run_time()\r\n\r\n        if run_time > self.time_limit:\r\n            return None\r\n\r\n        current_step = math.floor(run_time / self.step_time) + 1\r\n        return (current_step * self.step_load, self.spawn_rate)`\r\n\r\n![image](https://user-images.githubusercontent.com/45445106/96219421-6141ca00-0fb9-11eb-8bd9-1563105683fb.png)\r\n\r\nThe stats_history.csv and stats.csv :\r\n![image](https://user-images.githubusercontent.com/45445106/96219612-c695bb00-0fb9-11eb-8dd7-85d5a2ba729a.png)\r\n![image](https://user-images.githubusercontent.com/45445106/96219627-d01f2300-0fb9-11eb-952e-45ea832d296a.png)\r\n\r\n\r\n### Environment\r\n\r\n- OS:win 10\r\n- Python version:Python 3.8.3\r\n- Locust version:locust 1.3.0\r\n- Locust command line that you ran:locust -f D:\\thecover_project\\api_locust\\locust_view\\kbh_api\\locust_kbh_all.py --master-host  170.240.110.245 --master-port 9800 --headless --worker\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1595/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1595/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1594", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1594/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1594/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1594/events", "html_url": "https://github.com/locustio/locust/issues/1594", "id": 722054484, "node_id": "MDU6SXNzdWU3MjIwNTQ0ODQ=", "number": 1594, "title": "Move the kubernetes helm chart stable/locust to this repo", "user": {"login": "user10x", "id": 4950828, "node_id": "MDQ6VXNlcjQ5NTA4Mjg=", "avatar_url": "https://avatars.githubusercontent.com/u/4950828?v=4", "gravatar_id": "", "url": "https://api.github.com/users/user10x", "html_url": "https://github.com/user10x", "followers_url": "https://api.github.com/users/user10x/followers", "following_url": "https://api.github.com/users/user10x/following{/other_user}", "gists_url": "https://api.github.com/users/user10x/gists{/gist_id}", "starred_url": "https://api.github.com/users/user10x/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/user10x/subscriptions", "organizations_url": "https://api.github.com/users/user10x/orgs", "repos_url": "https://api.github.com/users/user10x/repos", "events_url": "https://api.github.com/users/user10x/events{/privacy}", "received_events_url": "https://api.github.com/users/user10x/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2115072627, "node_id": "MDU6TGFiZWwyMTE1MDcyNjI3", "url": "https://api.github.com/repos/locustio/locust/labels/non-critical", "name": "non-critical", "color": "c4e4c9", "default": false, "description": ""}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-10-15T06:51:37Z", "updated_at": "2021-04-22T01:54:47Z", "closed_at": "2021-04-22T01:54:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi guys,\r\nIf you guys would like to move over a helm chart for locust in your repo i would like to contribute.\r\nhttps://github.com/helm/charts/tree/master/stable/locust\r\n\r\nhttps://github.com/helm/charts/issues/21103\r\n\r\n\r\n\r\nAdditionally, I will fix the chart for newer version as part of this migration.\r\nhttps://github.com/helm/charts/issues/23905\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1594/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1594/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1590", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1590/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1590/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1590/events", "html_url": "https://github.com/locustio/locust/issues/1590", "id": 718733410, "node_id": "MDU6SXNzdWU3MTg3MzM0MTA=", "number": 1590, "title": "Locust Test not starting", "user": {"login": "QAInsights", "id": 2826376, "node_id": "MDQ6VXNlcjI4MjYzNzY=", "avatar_url": "https://avatars.githubusercontent.com/u/2826376?v=4", "gravatar_id": "", "url": "https://api.github.com/users/QAInsights", "html_url": "https://github.com/QAInsights", "followers_url": "https://api.github.com/users/QAInsights/followers", "following_url": "https://api.github.com/users/QAInsights/following{/other_user}", "gists_url": "https://api.github.com/users/QAInsights/gists{/gist_id}", "starred_url": "https://api.github.com/users/QAInsights/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/QAInsights/subscriptions", "organizations_url": "https://api.github.com/users/QAInsights/orgs", "repos_url": "https://api.github.com/users/QAInsights/repos", "events_url": "https://api.github.com/users/QAInsights/events{/privacy}", "received_events_url": "https://api.github.com/users/QAInsights/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-10-11T01:08:31Z", "updated_at": "2020-10-12T19:28:59Z", "closed_at": "2020-10-12T15:19:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nI am trying to run a simple hello world test. But locust tests are not starting successfully in Windows 10 Pro. I am getting two errors: `System open file limit setting is not high enough for load testing` and ` An attempt was made to access a socket in a way forbidden by its access permissions`.\r\n\r\nI already tried internet search, SO answers and went thru the documentation. But the steps mentioned didn't solve the issue.\r\n\r\nI disabled firewall as well, but no luck.\r\n\r\n### Expected behavior\r\nLocust tests should start successfully.\r\n\r\n### Actual behavior\r\nImmediately shutting down.\r\n![](https://p175.p0.n0.cdn.getcloudapp.com/items/Jrug6Lqy/2020-10-10_21-02-16.jpg?source=viewer&v=be49e2bd0c6b604523e47382bc4bde05)\r\n\r\n### Steps to reproduce\r\n\r\n1. Create a simple locust file.\r\n2. Issue the locust command.\r\n\r\n### Environment\r\n\r\n- OS: Windows 10 Pro\r\n- Python version: 3.9.0\r\n- Locust version: 1.2.3\r\n- Locust command line that you ran: locust -f locustfile.py\r\n- Locust file contents (anonymized if necessary):\r\n```\r\nfrom locust import HttpUser, task, between\r\n\r\nclass HelloWorld(HttpUser):\r\n    wait_time = between(5, 15)\r\n\r\n    @task\r\n    def test(self):\r\n        self.client.get(\"/\")\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1590/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1590/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1589", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1589/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1589/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1589/events", "html_url": "https://github.com/locustio/locust/issues/1589", "id": 718201777, "node_id": "MDU6SXNzdWU3MTgyMDE3Nzc=", "number": 1589, "title": "Weights on test HTTPUser tasks not matching results", "user": {"login": "brianashworth-c", "id": 72615452, "node_id": "MDQ6VXNlcjcyNjE1NDUy", "avatar_url": "https://avatars.githubusercontent.com/u/72615452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brianashworth-c", "html_url": "https://github.com/brianashworth-c", "followers_url": "https://api.github.com/users/brianashworth-c/followers", "following_url": "https://api.github.com/users/brianashworth-c/following{/other_user}", "gists_url": "https://api.github.com/users/brianashworth-c/gists{/gist_id}", "starred_url": "https://api.github.com/users/brianashworth-c/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brianashworth-c/subscriptions", "organizations_url": "https://api.github.com/users/brianashworth-c/orgs", "repos_url": "https://api.github.com/users/brianashworth-c/repos", "events_url": "https://api.github.com/users/brianashworth-c/events{/privacy}", "received_events_url": "https://api.github.com/users/brianashworth-c/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-10-09T14:38:59Z", "updated_at": "2020-10-13T22:24:12Z", "closed_at": "2020-10-12T06:51:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n### Describe the bug\r\nWe have our main HTTPUser class below.  In this example, test1 - test8 are of type TaskSet with no weights and a single @task method each.  \r\n```\r\nclass Runner(HttpUser):\r\n\r\n    wait_time = constant(1)\r\n\r\n    tasks = {\r\n        test1: 3146,\r\n        test2: 1711,\r\n        test3: 3409,\r\n        test4: 118,\r\n        test5: 313273,\r\n        test6: 5042,\r\n        test7: 6352,\r\n        test8: 910\r\n    }\r\n```\r\n\r\n\r\n\r\n### Expected behavior\r\nWhen we run, for every 355,377 transactions, we expect roughly the number of transactions in our dictionary for each transaction type.\r\n\r\n### Actual behavior\r\nWhen we run the tests, the numbers of times that we run the tests does not match the weights that we have above.  In addition, there are some tests that aren't even being run at all, which has been different every time that we run it.  What aren't we understanding?\r\n\r\n### Environment\r\n\r\n- OS: RHEL 7\r\n- Python version: Python 3.6.8\r\n- Locust version: 1.2.3\r\n- Locust command line that you ran: locust -f locust.py\r\n- Locust file contents (anonymized if necessary): see code snip above\r\n\r\nUpdate:  We did some additional testing with the following code:\r\n\r\n```\r\nimport datetime\r\nfrom locust import task, TaskSet, constant, User\r\n\r\n\r\ndef Write(prefix):\r\n    d = datetime.datetime.now()\r\n    timestamp = d.strftime(\"%Y-%m-%d_%H-%M-%S-%f\")\r\n    directory = \"/tmp\"\r\n\r\n    with open(directory + \"/\" + prefix + \"_\" + timestamp + \".txt\", \"w\") as text_file:\r\n        text_file.write(\"\")\r\n\r\n\r\nclass TaskSetA(TaskSet):\r\n    @task\r\n    def task_a(self):\r\n        print(\"TaskSetA started\")\r\n        Write(\"TaskSetA\")\r\n\r\n\r\nclass TaskSetB(TaskSet):\r\n    @task\r\n    def task_b(self):\r\n        print(\"TaskSetB started\")\r\n        Write(\"TaskSetB\")\r\n\r\n\r\nclass LocustUser(User):\r\n    tasks = {TaskSetA:1, TaskSetB:1}\r\n    wait_time = constant(0.5)\r\n\r\n```\r\nWhen we run as shown, we get all TaskSetA's and not TaskSetB tests run. \r\n\r\n If we set the code to:\r\n    `tasks = {TaskSetA:1, TaskSetB:2}`\r\nwe still get only TaskSetA's run. \r\n\r\n If we set the code to:\r\n    `tasks = {TaskSetA:1, TaskSetB:9}`\r\nwe get only TaskSetB's run. \r\n\r\nI hope that helps.\r\nThanks,\r\nBrian\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1589/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1589/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1588", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1588/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1588/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1588/events", "html_url": "https://github.com/locustio/locust/issues/1588", "id": 718153842, "node_id": "MDU6SXNzdWU3MTgxNTM4NDI=", "number": 1588, "title": "locust does not respond when the time to complete a single request is (very) long", "user": {"login": "belloni-SAP", "id": 72554596, "node_id": "MDQ6VXNlcjcyNTU0NTk2", "avatar_url": "https://avatars.githubusercontent.com/u/72554596?v=4", "gravatar_id": "", "url": "https://api.github.com/users/belloni-SAP", "html_url": "https://github.com/belloni-SAP", "followers_url": "https://api.github.com/users/belloni-SAP/followers", "following_url": "https://api.github.com/users/belloni-SAP/following{/other_user}", "gists_url": "https://api.github.com/users/belloni-SAP/gists{/gist_id}", "starred_url": "https://api.github.com/users/belloni-SAP/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/belloni-SAP/subscriptions", "organizations_url": "https://api.github.com/users/belloni-SAP/orgs", "repos_url": "https://api.github.com/users/belloni-SAP/repos", "events_url": "https://api.github.com/users/belloni-SAP/events{/privacy}", "received_events_url": "https://api.github.com/users/belloni-SAP/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-10-09T13:38:34Z", "updated_at": "2020-10-14T11:58:28Z", "closed_at": "2020-10-09T22:18:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nWhen running locust against a database with queries that needs long processing time (above 3 seconds) locust does not respond anymore:\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nLocust should work as usual\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n* run as local: stopping the test from the UI does not work. The runner keeps sending request to the database\r\n* run as master/worker the master loose the worker, printing heartbeat not arrived.\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\nI have created a repository. It need docker and Unix tools, python packages:  `locust` and `pyscopg2`.\r\n\r\n1. ```git clone https://github.com/belloni-SAP/locust_sql```\r\n2. ```cd locust_sql```\r\n3.  run `./prepare_test.sh`\r\n4. Al local:\r\n    * `locust -f postgres_test.py`\r\n      start test from UI and try to stop. In the terminal locust keeps sending request to the database.\r\n   * distributed \r\n         * master: `locust -f postgres_test.py --master`\r\n         * worker: `locust -f postgres_test.py --worker`\r\n     After few seconds in the master terminal an heartbeat problem will try to stop the test.\r\nIncreasing the value of the `heartbeat`-related variables in `locust.runner`have no effect.\r\n\r\n### Environment\r\n\r\n- OS: Linux - x86_64 GNU/Linux\r\n- Python version: Python 3.7.1\r\n- Locust version: locust 1.2.3\r\n- Locust command line that you ran: see above\r\n- Locust file contents (anonymized if necessary): see above", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1588/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1588/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1587", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1587/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1587/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1587/events", "html_url": "https://github.com/locustio/locust/issues/1587", "id": 716979994, "node_id": "MDU6SXNzdWU3MTY5Nzk5OTQ=", "number": 1587, "title": "Cannot import name 'HttpUser' from 'locust' error when running Locust in Kubernetes", "user": {"login": "galynavasylieva", "id": 33268770, "node_id": "MDQ6VXNlcjMzMjY4Nzcw", "avatar_url": "https://avatars.githubusercontent.com/u/33268770?v=4", "gravatar_id": "", "url": "https://api.github.com/users/galynavasylieva", "html_url": "https://github.com/galynavasylieva", "followers_url": "https://api.github.com/users/galynavasylieva/followers", "following_url": "https://api.github.com/users/galynavasylieva/following{/other_user}", "gists_url": "https://api.github.com/users/galynavasylieva/gists{/gist_id}", "starred_url": "https://api.github.com/users/galynavasylieva/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/galynavasylieva/subscriptions", "organizations_url": "https://api.github.com/users/galynavasylieva/orgs", "repos_url": "https://api.github.com/users/galynavasylieva/repos", "events_url": "https://api.github.com/users/galynavasylieva/events{/privacy}", "received_events_url": "https://api.github.com/users/galynavasylieva/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-10-08T02:55:27Z", "updated_at": "2020-10-26T09:55:26Z", "closed_at": "2020-10-08T09:11:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\nI am deploying Locust on Kubernetes using Helm Charts(https://github.com/helm/charts/tree/master/stable/locust), which is using Locust container 0.9.0, where HttpUser was HttpLocust.\r\n\r\n2 Worker pods are running with no errors, but master is in CrashLoopBackOff status.\r\nLogs are showing following error:\r\n\r\n`[2020-10-07 21:46:18,300] locust-master-5bf8d86867-kfxxg/ERROR/stderr: Traceback (most recent call last):\r\n[2020-10-07 21:46:18,300] locust-master-5bf8d86867-kfxxg/ERROR/stderr: File \"/usr/local/bin/locust\", line 11, in <module>\r\n[2020-10-07 21:46:18,300] locust-master-5bf8d86867-kfxxg/ERROR/stderr: \r\n[2020-10-07 21:46:18,300] locust-master-5bf8d86867-kfxxg/ERROR/stderr: sys.exit(main())\r\n[2020-10-07 21:46:18,300] locust-master-5bf8d86867-kfxxg/ERROR/stderr: \r\n[2020-10-07 21:46:18,301] locust-master-5bf8d86867-kfxxg/ERROR/stderr: File \"/usr/local/lib/python3.7/site-packages/locust/main.py\", line 391, in main\r\n[2020-10-07 21:46:18,301] locust-master-5bf8d86867-kfxxg/ERROR/stderr: \r\n[2020-10-07 21:46:18,301] locust-master-5bf8d86867-kfxxg/ERROR/stderr: docstring, locusts = load_locustfile(locustfile)\r\n[2020-10-07 21:46:18,301] locust-master-5bf8d86867-kfxxg/ERROR/stderr: \r\n[2020-10-07 21:46:18,301] locust-master-5bf8d86867-kfxxg/ERROR/stderr: File \"/usr/local/lib/python3.7/site-packages/locust/main.py\", line 358, in load_locustfile\r\n[2020-10-07 21:46:18,301] locust-master-5bf8d86867-kfxxg/ERROR/stderr: \r\n[2020-10-07 21:46:18,302] locust-master-5bf8d86867-kfxxg/ERROR/stderr: imported = __import__(os.path.splitext(locustfile)[0])\r\n[2020-10-07 21:46:18,302] locust-master-5bf8d86867-kfxxg/ERROR/stderr: \r\n[2020-10-07 21:46:18,302] locust-master-5bf8d86867-kfxxg/ERROR/stderr: File \"/locust-tasks/tasks.py\", line 1, in <module>\r\n[2020-10-07 21:46:18,302] locust-master-5bf8d86867-kfxxg/ERROR/stderr: \r\n[2020-10-07 21:46:18,302] locust-master-5bf8d86867-kfxxg/ERROR/stderr: from locust import HttpUser, task, TaskSet, between\r\n[2020-10-07 21:46:18,302] locust-master-5bf8d86867-kfxxg/ERROR/stderr: \r\n[2020-10-07 21:46:18,302] locust-master-5bf8d86867-kfxxg/ERROR/stderr: ImportError\r\n[2020-10-07 21:46:18,302] locust-master-5bf8d86867-kfxxg/ERROR/stderr: :\r\n[2020-10-07 21:46:18,302] locust-master-5bf8d86867-kfxxg/ERROR/stderr: cannot import name 'HttpUser' from 'locust' (/usr/local/lib/python3.7/site-packages/locust/__init__.py)\r\n[2020-10-07 21:46:18,303] locust-master-5bf8d86867-kfxxg/ERROR/stderr:`\r\n\r\nIs that possible to update the chart to use 1.0.+ Locust and is it in the roadmap any time soon? Thanks!\r\n\r\n- OS: MacOS\r\n- Python version: 3.7\r\n- Locust version: locust==1.2.3\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1587/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1587/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1586", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1586/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1586/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1586/events", "html_url": "https://github.com/locustio/locust/issues/1586", "id": 716770459, "node_id": "MDU6SXNzdWU3MTY3NzA0NTk=", "number": 1586, "title": "\"Stop\" button doesn't always stop workers", "user": {"login": "irvintim", "id": 5721686, "node_id": "MDQ6VXNlcjU3MjE2ODY=", "avatar_url": "https://avatars.githubusercontent.com/u/5721686?v=4", "gravatar_id": "", "url": "https://api.github.com/users/irvintim", "html_url": "https://github.com/irvintim", "followers_url": "https://api.github.com/users/irvintim/followers", "following_url": "https://api.github.com/users/irvintim/following{/other_user}", "gists_url": "https://api.github.com/users/irvintim/gists{/gist_id}", "starred_url": "https://api.github.com/users/irvintim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/irvintim/subscriptions", "organizations_url": "https://api.github.com/users/irvintim/orgs", "repos_url": "https://api.github.com/users/irvintim/repos", "events_url": "https://api.github.com/users/irvintim/events{/privacy}", "received_events_url": "https://api.github.com/users/irvintim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2020-10-07T18:49:45Z", "updated_at": "2022-12-01T05:40:22Z", "closed_at": "2020-10-20T06:29:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nIn my test environment I am running a distributed loadtest with 3 workers in GUI mode.  Intermittently (seemingly generally on tests following the initial test after spin up of the hosts), when pressing the \"STOP\" button on the master GUI web interface, the feedback will say \"Stopping\" and looking at the output on the workers console they will also report that they are \"Stopping\" but the number of users never decreases and the load test continues.  We have to \"CTRL-C\" each worker separately to get the test to stop.\r\n\r\n### Expected behavior\r\nWhen the \"STOP\" button is pressed the load test should stop immediately on all workers (or at least within a few seconds).\r\n\r\n### Actual behavior\r\nThe workers and the GUI report the status as \"STOPPING\" and the test continues -- the \"STOP\" button is now gone so the only recourse is to log on to each worker and stop the test manually.\r\n\r\nOutput from one of the workers on the command line is: \"[2020-10-06 23:12:49,585] locust02.YYYY.XXXX.local/INFO/locust.runners: Stopping 666 users\"\r\n\r\n### Steps to reproduce\r\nOn the 3 workers we run this command:\r\n   locust -f locustfile.py --worker --master-host=172.20.2.254\r\nOn the master host we run this command:\r\n  locust -f locustfile.py --master\r\n\r\nOn the GUI we set the number of users to 2000 and the spawn rate of 100.  (We have tried 6000 and 300, and 1000 and 100.)  The problem is intermittent.\r\n\r\nlocustfile.py is shown below\r\n\r\n\r\n\r\n### Environment\r\n\r\n- OS:  CentOS Linux release 7.6.1810\r\n- Python version: Python 3.6.8\r\n- Locust version: locust 1.2.2\r\n- Locust command line that you ran: \r\n    worker:   locust -f locustfile.py --worker --master-host=172.20.2.254\r\n    master:   locust -f locustfile.py --master\r\n- Locust file contents (anonymized if necessary):\r\n```\r\n# coding=utf-8\r\nimport json\r\nimport os\r\nimport random\r\nimport requests\r\nimport time\r\nimport locust_plugins\r\nfrom locust import HttpUser, task, between, TaskSet, User\r\n\r\ndeviceIdStart = 1000000000000000000\r\ndeviceIdRange = 10000\r\nclient_id = os.getenv(\"CLIENTID\")\r\nclient_secret = os.getenv(\"CLIENTSECRET\")\r\n\r\nballots = [\"test\"]\r\n\r\ncandidates = {\r\n    \"test\": {\r\n        \"T1\": \"test1\",\r\n        \"T2\": \"test2\",\r\n        \"T3\": \"test3\",\r\n        \"T4\": \"test4\",\r\n        \"T5\": \"test5\",\r\n        \"T6\": \"test6\",\r\n        \"T7\": \"test7\",\r\n        \"T8\": \"test8\",\r\n    }\r\n}\r\n\r\n\r\ndef candidate():\r\n    ballot_id = random.choice(ballots)\r\n    candidate_list = list(candidates[ballot_id].keys())\r\n    candidate_id = random.choice(candidate_list)\r\n    candidate_name = candidates[ballot_id][candidate_id]\r\n\r\n    return ballot_id, candidate_id, candidate_name\r\n\r\n\r\ndef device_id():\r\n    dIdS = int(os.getenv(\"DEVIDSTART\", deviceIdStart))\r\n    dIdR = int(os.getenv(\"DEVIDRANGE\", deviceIdRange))\r\n    return random.randrange(dIdS, dIdS + dIdR)\r\n\r\n\r\nclass UserBehavior(HttpUser):\r\n    min_wait = 2000\r\n    max_wait = 9000\r\n    host = os.getenv(\"TARGET_URL\")\r\n\r\n    def __init__(self, parent):\r\n        super(UserBehavior, self).__init__(parent)\r\n\r\n        self.token = \"\"\r\n        self.headers = {}\r\n        self.tokenExpires = 0\r\n\r\n    def on_start(self):\r\n        self.token = self.login()\r\n\r\n        self.headers = {\r\n            \"Authorization\": \"%s %s\"\r\n            % (self.token[\"token_type\"], self.token[\"access_token\"])\r\n        }\r\n\r\n        self.tokenExpires = time.time() + self.token[\"expires_in\"] - 120\r\n\r\n    def login(self):\r\n        \"\"\"\r\n        Gets the token for the user\r\n        :rtype: dict\r\n        \"\"\"\r\n        global client_id\r\n        global client_secret\r\n\r\n        url = os.getenv(\"AUTH_URL\")\r\n        print(\"Get token with %s\" % url)\r\n        response = requests.post(\r\n            url,\r\n            headers={\r\n                \"X-Client-Id\": client_id,\r\n                \"X-Client-Secret\": client_secret,\r\n                \"cache-control\": \"no-cache\",\r\n            },\r\n        )\r\n        try:\r\n            content = json.loads(response.content)\r\n            print(\"Access token: %s\" % content.get(\"access_token\"))\r\n            return content\r\n        except:\r\n            print(\"Error in getToken(): %s\" % content.get(\"error_msg\"))\r\n            return None\r\n\r\n    @task\r\n    def vote(self):\r\n        if self.tokenExpires < time.time():\r\n            self.token = self.login()\r\n            if self.token:\r\n                self.tokenExpires = time.time() + self.token[\"expires_in\"] - 120\r\n            else:\r\n                print(\"Unable to get SAT Token\")\r\n                return None\r\n        selection = candidate()\r\n        message = {\r\n            \"Id\": \"TEST-P\",\r\n            \"dId\": device_id(),\r\n            \"bId\": selection[0],\r\n            \"sIds\": selection[1],\r\n            \"sTexts\": selection[2],\r\n        }\r\n        response = self.client.post(\r\n            \"/api/v1/test?partner=test\", message, headers=self.headers\r\n        )\r\n\r\n    # vim: set fileencoding=utf-8 :\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1586/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1586/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1577", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1577/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1577/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1577/events", "html_url": "https://github.com/locustio/locust/issues/1577", "id": 711218094, "node_id": "MDU6SXNzdWU3MTEyMTgwOTQ=", "number": 1577, "title": "After starting and then stopping a load test, master is updating state in a loop", "user": {"login": "max-rocket-internet", "id": 8859277, "node_id": "MDQ6VXNlcjg4NTkyNzc=", "avatar_url": "https://avatars.githubusercontent.com/u/8859277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/max-rocket-internet", "html_url": "https://github.com/max-rocket-internet", "followers_url": "https://api.github.com/users/max-rocket-internet/followers", "following_url": "https://api.github.com/users/max-rocket-internet/following{/other_user}", "gists_url": "https://api.github.com/users/max-rocket-internet/gists{/gist_id}", "starred_url": "https://api.github.com/users/max-rocket-internet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/max-rocket-internet/subscriptions", "organizations_url": "https://api.github.com/users/max-rocket-internet/orgs", "repos_url": "https://api.github.com/users/max-rocket-internet/repos", "events_url": "https://api.github.com/users/max-rocket-internet/events{/privacy}", "received_events_url": "https://api.github.com/users/max-rocket-internet/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-09-29T15:18:27Z", "updated_at": "2020-11-02T08:19:05Z", "closed_at": "2020-09-30T08:41:14Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "After this PR: https://github.com/locustio/locust/pull/1570\r\n\r\nThen master is logging this repeatedly in a loop after stopping a load test:\r\n\r\n```\r\n[2020-09-29 15:15:40,859] locust-vps-master-746cf87dc7-rmws5/DEBUG/locust.runners: Updating state to stopped, old state was stopped\r\n```\r\n\r\nI will make a PR to fix.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1577/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1577/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1576", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1576/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1576/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1576/events", "html_url": "https://github.com/locustio/locust/issues/1576", "id": 710909561, "node_id": "MDU6SXNzdWU3MTA5MDk1NjE=", "number": 1576, "title": "run locusts -f .yml --master and --worker  via linux function bug ", "user": {"login": "highboy168", "id": 31539113, "node_id": "MDQ6VXNlcjMxNTM5MTEz", "avatar_url": "https://avatars.githubusercontent.com/u/31539113?v=4", "gravatar_id": "", "url": "https://api.github.com/users/highboy168", "html_url": "https://github.com/highboy168", "followers_url": "https://api.github.com/users/highboy168/followers", "following_url": "https://api.github.com/users/highboy168/following{/other_user}", "gists_url": "https://api.github.com/users/highboy168/gists{/gist_id}", "starred_url": "https://api.github.com/users/highboy168/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/highboy168/subscriptions", "organizations_url": "https://api.github.com/users/highboy168/orgs", "repos_url": "https://api.github.com/users/highboy168/repos", "events_url": "https://api.github.com/users/highboy168/events{/privacy}", "received_events_url": "https://api.github.com/users/highboy168/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-09-29T09:00:30Z", "updated_at": "2020-09-30T05:59:34Z", "closed_at": "2020-09-29T09:10:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "if worker in linux env,the rps is to slow.\r\nif master and worker all in mac env,the rps is normal.\r\n\r\nmaster env:\r\nmac or linuux\r\n\r\nworker env:\r\nmac: pass\r\nlinux: fail (docker and local hanve same issue)\r\n\r\nlocust version:1.2.3\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1576/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1576/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1572", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1572/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1572/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1572/events", "html_url": "https://github.com/locustio/locust/issues/1572", "id": 710226517, "node_id": "MDU6SXNzdWU3MTAyMjY1MTc=", "number": 1572, "title": "Misleading log message in distributed mode", "user": {"login": "parberge", "id": 5441497, "node_id": "MDQ6VXNlcjU0NDE0OTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5441497?v=4", "gravatar_id": "", "url": "https://api.github.com/users/parberge", "html_url": "https://github.com/parberge", "followers_url": "https://api.github.com/users/parberge/followers", "following_url": "https://api.github.com/users/parberge/following{/other_user}", "gists_url": "https://api.github.com/users/parberge/gists{/gist_id}", "starred_url": "https://api.github.com/users/parberge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/parberge/subscriptions", "organizations_url": "https://api.github.com/users/parberge/orgs", "repos_url": "https://api.github.com/users/parberge/repos", "events_url": "https://api.github.com/users/parberge/events{/privacy}", "received_events_url": "https://api.github.com/users/parberge/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-09-28T12:35:01Z", "updated_at": "2020-09-28T15:43:31Z", "closed_at": "2020-09-28T15:43:31Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nWhen running locust in distributed mode you can still get this warning message on the master node:\r\n```\r\n/WARNING/locust.main: System open file limit setting is not high enough for load testing, and the OS didn't allow locust to increase it by itself. See https://github.com/locustio/locust/wiki/Installation#increasing-maximum-number-of-open-files-limit for more info.\r\n```\r\nSince the master won't execute any of the tests this warning is misleading.\r\n\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nNo log message about open file limit on master when running distributed\r\n\r\n### Actual behavior\r\nLog message about low open file limit on instance running master mode\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\nRun `locust --master` on a host with low open file limit (e.g 2048).\r\n\r\n### Environment\r\n\r\n- OS: locust docker image running on Linux host\r\n- Python version: Embedded version in docker image with tag `1.2.3`\r\n- Locust version: 1.2.3\r\n- Locust command line that you ran: `locust --master`\r\n- Locust file contents (anonymized if necessary): N/A", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1572/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1572/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1568", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1568/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1568/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1568/events", "html_url": "https://github.com/locustio/locust/issues/1568", "id": 708564299, "node_id": "MDU6SXNzdWU3MDg1NjQyOTk=", "number": 1568, "title": "Error when running locust: Unknown User(s): locust", "user": {"login": "kristofj-umd", "id": 43998377, "node_id": "MDQ6VXNlcjQzOTk4Mzc3", "avatar_url": "https://avatars.githubusercontent.com/u/43998377?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kristofj-umd", "html_url": "https://github.com/kristofj-umd", "followers_url": "https://api.github.com/users/kristofj-umd/followers", "following_url": "https://api.github.com/users/kristofj-umd/following{/other_user}", "gists_url": "https://api.github.com/users/kristofj-umd/gists{/gist_id}", "starred_url": "https://api.github.com/users/kristofj-umd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kristofj-umd/subscriptions", "organizations_url": "https://api.github.com/users/kristofj-umd/orgs", "repos_url": "https://api.github.com/users/kristofj-umd/repos", "events_url": "https://api.github.com/users/kristofj-umd/events{/privacy}", "received_events_url": "https://api.github.com/users/kristofj-umd/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-09-25T01:02:03Z", "updated_at": "2022-03-07T08:14:08Z", "closed_at": "2020-09-25T20:30:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nI can't get locust to run. All I receive is this error:\r\n```\r\n[2020-09-25 00:52:30,122] c7452de07324/ERROR/locust.main: Unknown User(s): locust\r\n```\r\n\r\n### Expected behavior\r\nNot sure; haven't used locust before, but I assume the experience should be closer to what is mentioned in the QuickStart guide\r\n\r\n### Actual behavior\r\nSee \"Describe the bug\"\r\n\r\n### Steps to reproduce\r\n1. Create locust docker container as specified: https://docs.locust.io/en/stable/running-locust-docker.html#use-docker-image-as-a-base-image\r\n2.  Run locust in docker-compose setting with\r\n```\r\ndocker-compose   --env-file my_env_file.env    run   --rm   tester   locust -f /mnt/testing/locustfile.py\r\n```\r\n\r\n### Environment\r\n\r\n- OS: docker on Debian\r\n- Python version: not sure; container is based on https://hub.docker.com/r/locustio/locust\r\n- Locust version: https://hub.docker.com/r/locustio/locust\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):\r\n_locustfile.py_\r\n```python\r\nimport os\r\n# for locust testing\r\nfrom locust import HttpUser, task, between\r\n# for interacting with Geoserver\r\nfrom geoserver.catalog import Catalog\r\n# keep it unpredictable\r\nimport random\r\n\r\n# Geoserver catalog instance\r\ncat = Catalog(\r\n    os.environ['geos_url'] + \"rest/\",\r\n    \"admin\",\r\n    os.environ['GEOSERVER_ADMIN_PASSWORD'],\r\n)\r\n# used to authorize requests to server\r\nserver_auth = ('admin', os.environ['GEOSERVER_ADMIN_PASSWORD'])\r\n\r\n# get all the layers\r\nall_layers = cat.get_layers()\r\n\r\n\r\nclass MapUser(HttpUser):\r\n    wait_time = between(1, 5)\r\n\r\n    # set params for request\r\n    wms_params = {\r\n        'service': 'WMS',\r\n        'version': '1.1.1',\r\n        'request': 'GetMap',\r\n        # bbox and layer will be determined dyanamically/randomly\r\n        #'layers': 'nra%3Aacs2018_median_age',\r\n        #'bbox': '189778.189779643%2C4816294.13796494%2C761657.136792686%2C5472414.1367775',\r\n        # tile dimensions\r\n        'width': '256',\r\n        'height': '256',\r\n        # try to do some tiling along the way\r\n        'tiled': 'true',\r\n        'tilesorigin': '-100,40',\r\n        'srs': 'EPSG:3857',\r\n        'format': 'image/png',\r\n        'transparent': 'true',\r\n    }\r\n\r\n    # get bounding box values from range from tileset\r\n    # http://nrri-atlas.d.umn.edu/geoserver/web/wicket/bookmarkable/org.geoserver.gwc.web.gridset.GridSetEditPage?1&gridSet=tight_3857\r\n    bbox_d = {\r\n        'minx': -14479413,\r\n        'miny': 2536215,\r\n        'maxx': -6754824,\r\n        'maxy': 6853969,\r\n    }\r\n\r\n    @task\r\n    def index_page(self):\r\n\r\n        # set layers randomly from list of layers\r\n        layers = random.choice(all_layers)\r\n\r\n        # set bounding box values from range\r\n        # 9784\r\n        midx = random.randrange(bbox_d.minx, bbox_d.maxx)\r\n        midy = random.randrange(bbox_d.miny, bbox_d.maxy)\r\n        minx = (midx - 9784) if (midx - 9784) > bbox_d.minx else bbox_d.minx\r\n        miny = (midy - 9784) if (midy - 9784) > bbox_d.miny else bbox_d.miny\r\n        maxx = (midx + 9784) if (midx + 9784) < bbox_d.maxx else bbox_d.maxx\r\n        maxy = (midy + 9784) if (midy + 9784) < bbox_d.maxy else bbox_d.maxy\r\n        # bbox = [(), ((midy - 9784) if > miny else miny]), ((midx + 9784) if < maxx else maxx), ((midy + 9784) if < maxy else maxy)]\r\n\r\n        params['layers'] = layers\r\n        params['bbox'] = [minx, miny, maxx, maxy].join(',')\r\n\r\n        url = os.environ['geos_url'] + \"/ows?{}\".format(\r\n            urllib.parse.urlencode(params)\r\n        )\r\n        urllib.parse.urlencode\r\n        self.client.get(url)\r\n```\r\nThanks for any help you can provide.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1568/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1568/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1567", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1567/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1567/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1567/events", "html_url": "https://github.com/locustio/locust/issues/1567", "id": 708535434, "node_id": "MDU6SXNzdWU3MDg1MzU0MzQ=", "number": 1567, "title": "Using locust helm chart, not getting any stats. Not sure if it's doing anything really", "user": {"login": "rlewkowicz", "id": 17415445, "node_id": "MDQ6VXNlcjE3NDE1NDQ1", "avatar_url": "https://avatars.githubusercontent.com/u/17415445?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rlewkowicz", "html_url": "https://github.com/rlewkowicz", "followers_url": "https://api.github.com/users/rlewkowicz/followers", "following_url": "https://api.github.com/users/rlewkowicz/following{/other_user}", "gists_url": "https://api.github.com/users/rlewkowicz/gists{/gist_id}", "starred_url": "https://api.github.com/users/rlewkowicz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rlewkowicz/subscriptions", "organizations_url": "https://api.github.com/users/rlewkowicz/orgs", "repos_url": "https://api.github.com/users/rlewkowicz/repos", "events_url": "https://api.github.com/users/rlewkowicz/events{/privacy}", "received_events_url": "https://api.github.com/users/rlewkowicz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-09-24T23:31:28Z", "updated_at": "2020-09-25T19:19:27Z", "closed_at": "2020-09-25T19:19:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "<img width=\"1079\" alt=\"image\" src=\"https://user-images.githubusercontent.com/17415445/94209850-476e0500-fe9b-11ea-857b-db653a324737.png\">\r\n\r\nMaster/slave communication is good, it spawns my users:\r\n\r\n\r\n```\r\n/usr/local/bin/locust -f /locust-tasks/tasks.py --host=http://mediawiki.REDACT --master\r\n[2020-09-24 23:13:45,187] release-name-master-bbbfb6c79-jpm8z/INFO/locust.main: Starting web monitor at *:8089\r\n[2020-09-24 23:13:45,188] release-name-master-bbbfb6c79-jpm8z/INFO/locust.main: Starting Locust 0.9.0\r\n[2020-09-24 23:14:14,425] release-name-master-bbbfb6c79-jpm8z/INFO/locust.runners: Client 'release-name-worker-b4695dd49-7vtqj_14b581c8b3d9099e6070d28e6f931639' reported as ready. Currently 1 clients ready to swarm.\r\n[2020-09-24 23:14:15,285] release-name-master-bbbfb6c79-jpm8z/INFO/locust.runners: Client 'release-name-worker-b4695dd49-c9xnt_38a47c2f15e3839678c4abf7dd1e2c51' reported as ready. Currently 2 clients ready to swarm.\r\n[2020-09-24 23:15:49,618] release-name-master-bbbfb6c79-jpm8z/INFO/locust.runners: Sending hatch jobs to 2 ready clients\r\n```\r\n\r\n```\r\nku logs -f release-name-worker-b4695dd49-7vtqj\r\nWaiting for master\r\nWaiting for master\r\nWaiting for master\r\nWaiting for master\r\nWaiting for master\r\n/usr/local/bin/locust -f /locust-tasks/tasks.py --host=http://mediawiki.REDACT --slave --master-host=release-name-master-svc\r\n[2020-09-24 23:14:14,422] release-name-worker-b4695dd49-7vtqj/INFO/locust.main: Starting Locust 0.9.0\r\n[2020-09-24 23:15:49,619] release-name-worker-b4695dd49-7vtqj/INFO/locust.runners: Hatching and swarming 1 clients at the rate 0.5 clients/s...\r\n[2020-09-24 23:15:51,621] release-name-worker-b4695dd49-7vtqj/INFO/locust.runners: All locusts hatched: MyLocust: 1\r\n```\r\n\r\nmaster mounts a config map:\r\n```\r\n$ cat manifests/locust/templates/worker-cm.yaml\r\n---\r\n# Source: locust/templates/worker-cm.yaml\r\n\r\napiVersion: v1\r\nkind: ConfigMap\r\nmetadata:\r\n  name: release-name-worker\r\n  labels:\r\n    heritage: \"Tiller\"\r\n    release: \"release-name\"\r\n    chart: \"locust-1.2.1\"\r\n    app: release-name-locust\r\ndata:\r\n  tasks.py: |-\r\n    import locust\r\n    class MyTaskSet(locust.TaskSet):\r\n\r\n      @locust.task\r\n      def do_get(self):\r\n          self.client.get('/wiki/Special:Random')\r\n\r\n    class MyLocust(locust.HttpLocust):\r\n      task_set = MyTaskSet\r\n\r\n      min_wait = 100\r\n      max_wait = 1100\r\n```\r\nfrom in the container, it looks good:\r\n```\r\nimport locust\r\nclass MyTaskSet(locust.TaskSet):\r\n\r\n  @locust.task\r\n  def do_get(self):\r\n      self.client.get('/wiki/Special:Random')\r\n\r\nclass MyLocust(locust.HttpLocust):\r\n  task_set = MyTaskSet\r\n\r\n  min_wait = 100\r\n  max_wait = 1100\r\n```\r\nJust as a POC the goal was to do some simple testing on a mediawiki installation. It's just not really doing anything. No errors, no nothing. I'm not sure what I should be checking. I am running those containers as user 11 which is \"operator\" because of our root user policy but I don't see anything errors from that", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1567/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1567/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1563", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1563/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1563/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1563/events", "html_url": "https://github.com/locustio/locust/issues/1563", "id": 702742338, "node_id": "MDU6SXNzdWU3MDI3NDIzMzg=", "number": 1563, "title": "stats - statistics are not precise because of rounding (i.e. 99th percentile sometimes has higher value than max)", "user": {"login": "stanislawskwark", "id": 46684704, "node_id": "MDQ6VXNlcjQ2Njg0NzA0", "avatar_url": "https://avatars.githubusercontent.com/u/46684704?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stanislawskwark", "html_url": "https://github.com/stanislawskwark", "followers_url": "https://api.github.com/users/stanislawskwark/followers", "following_url": "https://api.github.com/users/stanislawskwark/following{/other_user}", "gists_url": "https://api.github.com/users/stanislawskwark/gists{/gist_id}", "starred_url": "https://api.github.com/users/stanislawskwark/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stanislawskwark/subscriptions", "organizations_url": "https://api.github.com/users/stanislawskwark/orgs", "repos_url": "https://api.github.com/users/stanislawskwark/repos", "events_url": "https://api.github.com/users/stanislawskwark/events{/privacy}", "received_events_url": "https://api.github.com/users/stanislawskwark/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}, {"id": 2115072627, "node_id": "MDU6TGFiZWwyMTE1MDcyNjI3", "url": "https://api.github.com/repos/locustio/locust/labels/non-critical", "name": "non-critical", "color": "c4e4c9", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2020-09-16T12:56:38Z", "updated_at": "2020-09-28T19:23:22Z", "closed_at": "2020-09-28T19:23:22Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Describe the bug\r\nI'm extracting stats per item from environment.stats.entries where environment is locust.enc.Environment object.\r\nFrom stats object I use max_response_time and get_reponse_time_percentile(0.99)\r\nI noticed that sometimes value of 99th percentile has higher value than max_response_time - which is impossible.\r\nIn general there are differences between statistics from Influx and from Locust generated for the same data\r\n\r\n### Expected behavior\r\nAll statistics return correct values\r\n\r\n### Actual behavior\r\nMax value is sometimes bigger than some of the percentiles.\r\nI observed the same issue on UI on 90th percentile (on screenshot GET homepage)\r\n![image](https://user-images.githubusercontent.com/46684704/93339727-37677d00-f82c-11ea-9ddd-514378aa5f3e.png)\r\n\r\nStats calculated by Influx vs stats from Locust:\r\n![93447781-1a39b980-f8d3-11ea-9d70-38dc64d26421](https://user-images.githubusercontent.com/46684704/93857011-3619d280-fcba-11ea-9e80-5fd9c20402b2.png)\r\n\r\n\r\n### Steps to reproduce\r\nrun the test and observe the logs\r\n\r\n### Environment\r\n\r\n- OS: Windows 10\r\n- Python version: 3.8.5\r\n- Locust version: 1.2.3\r\n- Locust command line that you ran: locust -f locustfiles/<filename> --skip-log-setup\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1563/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1563/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1562", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1562/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1562/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1562/events", "html_url": "https://github.com/locustio/locust/issues/1562", "id": 702617526, "node_id": "MDU6SXNzdWU3MDI2MTc1MjY=", "number": 1562, "title": "docker locusts + httprunner", "user": {"login": "highboy168", "id": 31539113, "node_id": "MDQ6VXNlcjMxNTM5MTEz", "avatar_url": "https://avatars.githubusercontent.com/u/31539113?v=4", "gravatar_id": "", "url": "https://api.github.com/users/highboy168", "html_url": "https://github.com/highboy168", "followers_url": "https://api.github.com/users/highboy168/followers", "following_url": "https://api.github.com/users/highboy168/following{/other_user}", "gists_url": "https://api.github.com/users/highboy168/gists{/gist_id}", "starred_url": "https://api.github.com/users/highboy168/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/highboy168/subscriptions", "organizations_url": "https://api.github.com/users/highboy168/orgs", "repos_url": "https://api.github.com/users/highboy168/repos", "events_url": "https://api.github.com/users/highboy168/events{/privacy}", "received_events_url": "https://api.github.com/users/highboy168/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-09-16T09:44:36Z", "updated_at": "2020-09-20T10:18:56Z", "closed_at": "2020-09-20T10:18:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "when i use locusts + yml via docker, it is to slow.\r\nbut it\u2019s normal for me to run locally\r\ncan you help me?\r\n\r\nenvironment:same as locust + locustfile\r\ndocker: locust docker hub + httprunner package\r\n\r\nperformance:\r\nlocusts +yml: user/rps = 1/10 (3000user/300rps)\r\nlocust + locustfile = 3000 user/6000rps", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1562/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1562/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1557", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1557/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1557/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1557/events", "html_url": "https://github.com/locustio/locust/issues/1557", "id": 698337250, "node_id": "MDU6SXNzdWU2OTgzMzcyNTA=", "number": 1557, "title": "LoadTestShape.get_run_time is not relative to start of test", "user": {"login": "Bubba74", "id": 5572744, "node_id": "MDQ6VXNlcjU1NzI3NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5572744?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Bubba74", "html_url": "https://github.com/Bubba74", "followers_url": "https://api.github.com/users/Bubba74/followers", "following_url": "https://api.github.com/users/Bubba74/following{/other_user}", "gists_url": "https://api.github.com/users/Bubba74/gists{/gist_id}", "starred_url": "https://api.github.com/users/Bubba74/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Bubba74/subscriptions", "organizations_url": "https://api.github.com/users/Bubba74/orgs", "repos_url": "https://api.github.com/users/Bubba74/repos", "events_url": "https://api.github.com/users/Bubba74/events{/privacy}", "received_events_url": "https://api.github.com/users/Bubba74/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1626596897, "node_id": "MDU6TGFiZWwxNjI2NTk2ODk3", "url": "https://api.github.com/repos/locustio/locust/labels/hacktoberfest", "name": "hacktoberfest", "color": "f4b7cf", "default": false, "description": "See https://hacktoberfest.digitalocean.com for more info"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-09-10T18:29:20Z", "updated_at": "2020-10-01T14:57:15Z", "closed_at": "2020-10-01T14:57:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "Admittedly, I'd say this particular bug is open to interpretation and I can see benefit to the current behavior.\r\nHowever, I believe the current behavior is the opposite of what most implementations would require.\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nThe get_run_time() method in LoadTestShape returns the time delta relative to the start of Locust, not the start of the test.\r\nThis is exacerbated when there is a significant delay between Locust startup and test start (for example through the WebUI)\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nLoadTestShape.get_run_time() should return roughly 0 seconds the first time LoadTestShape.tick() is called.\r\nIf the test resets (say, through the WebUI), the LoadTestShape timer should reset too.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nWhen Locust calls LoadTestShape.tick() for the first time, a call to self.get_run_time() will return a time delay that incorporates Locust startup and all time spent in the WebUI.\r\n\r\nRestarting the example below is basically impossible as the timer has already exceeded 10 seconds if the LoadTest finished normally.\r\n\r\n### Workaround\r\nA subclass of LoadTestShape could keep a `self.first_loop = True` variable then do:\r\n``` .py\r\nif self.first_loop:\r\n    self.reset_time()\r\n    self.first_loop = False\r\n```\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n``` locustfile.py\r\n# locustfile.py\r\nfrom locust import User, task, LoadTestShape, constant\r\n\r\nclass MyUser(User):\r\n    wait_time = constant(10)\r\n\r\n    @task\r\n    def noop(self):\r\n        pass\r\n\r\nclass Shape(LoadTestShape):\r\n    def tick(self):\r\n        time = self.get_run_time()\r\n        if time > 10:\r\n            return None\r\n        print(\"Time:\", time)\r\n        return (1, 1)\r\n```\r\nThe above runs for ~10s when run with: ` locust --headless `\r\nBut might never run if started manually (10s later) via: `locust`\r\n\r\n### Environment\r\n- OS:\r\n- Python version: PyPy 7.3.1 with Python 3.6.9 (but this problem is evident in the master branch source)\r\n- Locust version: 1.2.3\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1557/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1557/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1555", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1555/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1555/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1555/events", "html_url": "https://github.com/locustio/locust/issues/1555", "id": 698196696, "node_id": "MDU6SXNzdWU2OTgxOTY2OTY=", "number": 1555, "title": "OSError: [Errno 16] Device or resource busy", "user": {"login": "ContraBoy9999", "id": 52013307, "node_id": "MDQ6VXNlcjUyMDEzMzA3", "avatar_url": "https://avatars.githubusercontent.com/u/52013307?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ContraBoy9999", "html_url": "https://github.com/ContraBoy9999", "followers_url": "https://api.github.com/users/ContraBoy9999/followers", "following_url": "https://api.github.com/users/ContraBoy9999/following{/other_user}", "gists_url": "https://api.github.com/users/ContraBoy9999/gists{/gist_id}", "starred_url": "https://api.github.com/users/ContraBoy9999/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ContraBoy9999/subscriptions", "organizations_url": "https://api.github.com/users/ContraBoy9999/orgs", "repos_url": "https://api.github.com/users/ContraBoy9999/repos", "events_url": "https://api.github.com/users/ContraBoy9999/events{/privacy}", "received_events_url": "https://api.github.com/users/ContraBoy9999/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-09-10T16:19:06Z", "updated_at": "2020-09-10T21:17:13Z", "closed_at": "2020-09-10T21:17:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\nI am running a load test using locust master-worker using step load. Below are the stats of the test:\r\n\r\n1200 users, 400 every ramp every 10m, 10 users/sec\r\nLocust version: 1.2.3\r\n\r\nWhen the test hits 1200 users I see the following errors in my stack trace (the worker instance)\r\nTraceback (most recent call last):\r\n  File \"/home/ec2-user/.local/lib/python3.7/site-packages/gevent/threadpool.py\", line 142, in __run_task\r\nOSError: [Errno 16] Device or resource busy\r\n2020-09-10T16:04:19Z (<ThreadPoolWorker at 0x7f1c59827050 thread_ident=0x7f1c59759700 threadpool-hub=<Hub at 0x7f1c6635aad0 thread_ident=0x7f1c70bb4740>>, <built-in function getaddrinfo>) failed with OSError\r\n\r\nIs there a fix for the same, I also get this message every time I kick off a test.\r\nSystem open file limit setting is not high enough for load testing, and the OS didn't allow locust to increase it by itself", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1555/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1555/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1552", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1552/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1552/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1552/events", "html_url": "https://github.com/locustio/locust/issues/1552", "id": 694938630, "node_id": "MDU6SXNzdWU2OTQ5Mzg2MzA=", "number": 1552, "title": "On Stop causes the task to continue", "user": {"login": "masonCaminer", "id": 45963533, "node_id": "MDQ6VXNlcjQ1OTYzNTMz", "avatar_url": "https://avatars.githubusercontent.com/u/45963533?v=4", "gravatar_id": "", "url": "https://api.github.com/users/masonCaminer", "html_url": "https://github.com/masonCaminer", "followers_url": "https://api.github.com/users/masonCaminer/followers", "following_url": "https://api.github.com/users/masonCaminer/following{/other_user}", "gists_url": "https://api.github.com/users/masonCaminer/gists{/gist_id}", "starred_url": "https://api.github.com/users/masonCaminer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/masonCaminer/subscriptions", "organizations_url": "https://api.github.com/users/masonCaminer/orgs", "repos_url": "https://api.github.com/users/masonCaminer/repos", "events_url": "https://api.github.com/users/masonCaminer/events{/privacy}", "received_events_url": "https://api.github.com/users/masonCaminer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 15, "created_at": "2020-09-07T10:04:59Z", "updated_at": "2020-09-16T06:32:03Z", "closed_at": "2020-09-16T06:32:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n\r\n### Describe the bug\r\nIf I add a new table concurrently, I click Stop, and then my on_stop method will be executed. On_stop is deleting the table. At this moment, one user will start executing on_stop and the other user will continue to execute task\r\n\r\n### Expected behavior\r\nTask is no longer executed when on_stop is expected\r\n### Actual behavior\r\nThe Task is still executed\r\n### Steps to reproduce\r\n1. Task is a new table\r\n2. On_stop removes the table one by one\r\n\r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version: 3.8\r\n- Locust version: 1.2.3\r\n- Locust command line that you ran: locust -f src/loadTest/11_add_core.py --users=20  --spawn-rate=20\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1552/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1552/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1551", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1551/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1551/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1551/events", "html_url": "https://github.com/locustio/locust/issues/1551", "id": 692518453, "node_id": "MDU6SXNzdWU2OTI1MTg0NTM=", "number": 1551, "title": "Typo in generating-custom-load-shape.rst", "user": {"login": "nishantrevo", "id": 15963526, "node_id": "MDQ6VXNlcjE1OTYzNTI2", "avatar_url": "https://avatars.githubusercontent.com/u/15963526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nishantrevo", "html_url": "https://github.com/nishantrevo", "followers_url": "https://api.github.com/users/nishantrevo/followers", "following_url": "https://api.github.com/users/nishantrevo/following{/other_user}", "gists_url": "https://api.github.com/users/nishantrevo/gists{/gist_id}", "starred_url": "https://api.github.com/users/nishantrevo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nishantrevo/subscriptions", "organizations_url": "https://api.github.com/users/nishantrevo/orgs", "repos_url": "https://api.github.com/users/nishantrevo/repos", "events_url": "https://api.github.com/users/nishantrevo/events{/privacy}", "received_events_url": "https://api.github.com/users/nishantrevo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-09-03T23:45:05Z", "updated_at": "2020-09-16T06:46:29Z", "closed_at": "2020-09-16T06:46:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nSmall typo in Description of example in generating-custom-load-shape.rst. Spawn rate in description and code are different. Example mentions:\r\n> This shape class will increase user count in blocks of 100 and then stop the load test after 10 minutes\r\n\r\n### Expected behavior\r\nCode to contain:\r\n`spawn_rate = 100`\r\n\r\n### Actual behavior\r\n`spawn_rate = 20`\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1551/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1551/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1550", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1550/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1550/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1550/events", "html_url": "https://github.com/locustio/locust/issues/1550", "id": 688160085, "node_id": "MDU6SXNzdWU2ODgxNjAwODU=", "number": 1550, "title": "Multiple hosts example no longer works.", "user": {"login": "apapia", "id": 17028465, "node_id": "MDQ6VXNlcjE3MDI4NDY1", "avatar_url": "https://avatars.githubusercontent.com/u/17028465?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apapia", "html_url": "https://github.com/apapia", "followers_url": "https://api.github.com/users/apapia/followers", "following_url": "https://api.github.com/users/apapia/following{/other_user}", "gists_url": "https://api.github.com/users/apapia/gists{/gist_id}", "starred_url": "https://api.github.com/users/apapia/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apapia/subscriptions", "organizations_url": "https://api.github.com/users/apapia/orgs", "repos_url": "https://api.github.com/users/apapia/repos", "events_url": "https://api.github.com/users/apapia/events{/privacy}", "received_events_url": "https://api.github.com/users/apapia/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-08-28T15:35:01Z", "updated_at": "2020-10-12T19:57:38Z", "closed_at": "2020-08-28T18:37:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n\r\n### Describe the bug\r\nIn my locust test code, I'm trying to setup multiple hosts like the example here:\r\nhttps://github.com/locustio/locust/blob/master/examples/multiple_hosts.py\r\n\r\nThe HttpSession class now requires request_success and request_failure events.  There doesn't appear to be a way to not use these.  I'm not sure the right way to provide them.\r\n\r\n### Expected behavior\r\nI do not need request_success, request_failure callbacks so I expect it should work without those arguments like the example.\r\n\r\n### Actual behavior\r\nI get this error:\r\nlocust.user.task: __init__() missing 2 required positional arguments: 'request_success' and 'request_failure'\r\n\r\n### Steps to reproduce\r\nRunning the multiple_hosts.py example should result in the same error. \r\n\r\n### Environment\r\n\r\n- OS: MacOS\r\n- Python version: 3.8\r\n- Locust version: 1.2.3\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1550/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1550/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1548", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1548/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1548/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1548/events", "html_url": "https://github.com/locustio/locust/issues/1548", "id": 687220502, "node_id": "MDU6SXNzdWU2ODcyMjA1MDI=", "number": 1548, "title": "Unable to install packages using pip", "user": {"login": "ShankarAnush", "id": 35295991, "node_id": "MDQ6VXNlcjM1Mjk1OTkx", "avatar_url": "https://avatars.githubusercontent.com/u/35295991?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ShankarAnush", "html_url": "https://github.com/ShankarAnush", "followers_url": "https://api.github.com/users/ShankarAnush/followers", "following_url": "https://api.github.com/users/ShankarAnush/following{/other_user}", "gists_url": "https://api.github.com/users/ShankarAnush/gists{/gist_id}", "starred_url": "https://api.github.com/users/ShankarAnush/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ShankarAnush/subscriptions", "organizations_url": "https://api.github.com/users/ShankarAnush/orgs", "repos_url": "https://api.github.com/users/ShankarAnush/repos", "events_url": "https://api.github.com/users/ShankarAnush/events{/privacy}", "received_events_url": "https://api.github.com/users/ShankarAnush/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-08-27T12:55:32Z", "updated_at": "2020-08-27T12:59:23Z", "closed_at": "2020-08-27T12:59:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "- OS: Windows 10\r\n- Python version: 3.8.0\r\n- Pip: 19.2.3\r\n\r\nI receive the following error when I try to install packages using pip. At the same time when I try to install them using interpreter settings, there are no packages available in the list.\r\nWhen I try installing them using system terminal I get the same error. Please refer to the attachments below.\r\n\r\nPS: I am working within the corporate network\r\n\r\n![image](https://user-images.githubusercontent.com/35295991/91444454-0c18f000-e875-11ea-8823-7fbff30ccf0d.png)\r\n![image2](https://user-images.githubusercontent.com/35295991/91444469-11763a80-e875-11ea-87a3-3abc52baf4d5.png)\r\n![image1](https://user-images.githubusercontent.com/35295991/91444480-13d89480-e875-11ea-9c40-fb54d9b836ad.png)\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1548/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1548/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1545", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1545/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1545/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1545/events", "html_url": "https://github.com/locustio/locust/issues/1545", "id": 686027936, "node_id": "MDU6SXNzdWU2ODYwMjc5MzY=", "number": 1545, "title": "Cant start: Werkzeug: TypeError: code() takes at least 14 arguments (13 given)", "user": {"login": "mcjoshua", "id": 4987177, "node_id": "MDQ6VXNlcjQ5ODcxNzc=", "avatar_url": "https://avatars.githubusercontent.com/u/4987177?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mcjoshua", "html_url": "https://github.com/mcjoshua", "followers_url": "https://api.github.com/users/mcjoshua/followers", "following_url": "https://api.github.com/users/mcjoshua/following{/other_user}", "gists_url": "https://api.github.com/users/mcjoshua/gists{/gist_id}", "starred_url": "https://api.github.com/users/mcjoshua/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mcjoshua/subscriptions", "organizations_url": "https://api.github.com/users/mcjoshua/orgs", "repos_url": "https://api.github.com/users/mcjoshua/repos", "events_url": "https://api.github.com/users/mcjoshua/events{/privacy}", "received_events_url": "https://api.github.com/users/mcjoshua/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-08-26T05:51:18Z", "updated_at": "2020-08-27T20:36:42Z", "closed_at": "2020-08-27T20:36:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nuser a simple example\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\nC:\\Users\\Administrator\\Desktop\\my_locust>locust\r\n[2020-08-26 13:40:22,369] DESKTOP-APUJUVJ/WARNING/locust.main: System open file limit setting is not high enough for load testing, and the OS didn't allow locust to increase it by itself. See https://github.com/locustio/locust/wiki/Installation#increasing-maximum-number-of-open-files-limit for more info.\r\n[2020-08-26 13:40:22,369] DESKTOP-APUJUVJ/INFO/locust.main: Starting web interface at http://0.0.0.0:8089 (accepting connections from all network interfaces)\r\nTraceback (most recent call last):\r\n  File \"c:\\python\\python38\\lib\\runpy.py\", line 194, in _run_module_as_main\r\n    return _run_code(code, main_globals, None,\r\n  File \"c:\\python\\python38\\lib\\runpy.py\", line 87, in _run_code\r\n    exec(code, run_globals)\r\n  File \"C:\\Python\\Python38\\Scripts\\locust.exe\\__main__.py\", line 7, in <module>\r\n  File \"c:\\python\\python38\\lib\\site-packages\\locust\\main.py\", line 284, in main\r\n    web_ui = environment.create_web_ui(\r\n  File \"c:\\python\\python38\\lib\\site-packages\\locust\\env.py\", line 156, in create_web_ui\r\n    self.web_ui = WebUI(self, host, port, auth_credentials=auth_credentials, tls_cert=tls_cert, tls_key=tls_key, stats_csv_writer=stats_csv_writer)\r\n  File \"c:\\python\\python38\\lib\\site-packages\\locust\\web.py\", line 85, in __init__\r\n    app = Flask(__name__)\r\n  File \"c:\\python\\python38\\lib\\site-packages\\flask\\app.py\", line 601, in __init__\r\n    self.add_url_rule(\r\n  File \"c:\\python\\python38\\lib\\site-packages\\flask\\app.py\", line 98, in wrapper_func\r\n    return f(self, *args, **kwargs)\r\n  File \"c:\\python\\python38\\lib\\site-packages\\flask\\app.py\", line 1278, in add_url_rule\r\n    self.url_map.add(rule)\r\n  File \"c:\\python\\python38\\lib\\site-packages\\werkzeug\\routing.py\", line 1562, in add\r\n    rule.bind(self)\r\n  File \"c:\\python\\python38\\lib\\site-packages\\werkzeug\\routing.py\", line 711, in bind\r\n    self.compile()\r\n  File \"c:\\python\\python38\\lib\\site-packages\\werkzeug\\routing.py\", line 767, in compile\r\n    self._build = self._compile_builder(False)\r\n  File \"c:\\python\\python38\\lib\\site-packages\\werkzeug\\routing.py\", line 1128, in _compile_builder\r\n    return self.BuilderCompiler(self).compile(append_unknown)\r\n  File \"c:\\python\\python38\\lib\\site-packages\\werkzeug\\routing.py\", line 1119, in compile\r\n    co = types.CodeType(*code_args)\r\nTypeError: code() takes at least 14 arguments (13 given)\r\n\r\nC:\\Users\\Administrator\\Desktop\\my_locust>locust -f lct.py\r\n\r\n\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version:  3.8\r\n- Locust version:  1.2\r\n- Locust command line that you ran:  locust -f lct.py\r\n- Locust file contents (anonymized if necessary):\r\n\r\n\r\nlct.py\r\n\r\nfrom locust import HttpUser, task, between\r\n\r\nclass QuickstartUser(HttpUser):\r\n \r\n    def on_start(self):\r\n        pass\r\n\r\n    @task\r\n    def index_page(self):\r\n        pass\r\n\r\n    @task(3)\r\n    def view_item(self):\r\n        pass\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1545/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1545/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1544", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1544/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1544/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1544/events", "html_url": "https://github.com/locustio/locust/issues/1544", "id": 685900742, "node_id": "MDU6SXNzdWU2ODU5MDA3NDI=", "number": 1544, "title": "locust status ready but 0 users", "user": {"login": "4ss3g4f", "id": 22811935, "node_id": "MDQ6VXNlcjIyODExOTM1", "avatar_url": "https://avatars.githubusercontent.com/u/22811935?v=4", "gravatar_id": "", "url": "https://api.github.com/users/4ss3g4f", "html_url": "https://github.com/4ss3g4f", "followers_url": "https://api.github.com/users/4ss3g4f/followers", "following_url": "https://api.github.com/users/4ss3g4f/following{/other_user}", "gists_url": "https://api.github.com/users/4ss3g4f/gists{/gist_id}", "starred_url": "https://api.github.com/users/4ss3g4f/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/4ss3g4f/subscriptions", "organizations_url": "https://api.github.com/users/4ss3g4f/orgs", "repos_url": "https://api.github.com/users/4ss3g4f/repos", "events_url": "https://api.github.com/users/4ss3g4f/events{/privacy}", "received_events_url": "https://api.github.com/users/4ss3g4f/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-08-25T23:36:53Z", "updated_at": "2020-10-12T19:57:03Z", "closed_at": "2020-08-30T00:40:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "Locust docker installed and working, but when executed there is no users ??\r\n\r\n![image](https://user-images.githubusercontent.com/22811935/91237877-f79a0200-e765-11ea-96b9-f0fbe54054af.png)\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->no users running for test\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen --> users should be not 0 (zero)\r\n\r\n```\r\nversion: '3.7'\r\n\r\nnetworks:\r\n  bridge:\r\n    external: true\r\n\r\nservices:\r\n  master:\r\n    image: locustio/locust:latest\r\n    deploy:\r\n      replicas: 1\r\n      # service restart policy\r\n      restart_policy:\r\n        condition: on-failure\r\n        delay: 5s\r\n        max_attempts: 3\r\n        window: 120s\r\n    ports:\r\n     - \"8089:8089\"\r\n    networks:\r\n      - bridge\r\n    volumes:\r\n      - /home/core/locust:/mnt/locust\r\n    command: -f /mnt/locust/locustfile.py --master -H http://192.168.33.231:8089\r\n    \r\n  worker:\r\n    image: locustio/locust:latest\r\n    networks:\r\n      - bridge\r\n    deploy:\r\n      replicas: 3\r\n      # service restart policy\r\n      restart_policy:\r\n        condition: on-failure\r\n        delay: 5s\r\n        max_attempts: 3\r\n        window: 120s\r\n    volumes:\r\n      - /home/core/locust:/mnt/locust\r\n    command: -f /mnt/locust/locustfile.py --worker --master-host 192.168.33.231:8089\r\n```\r\n\r\nI copy all files from https://github.com/locustio/locust/tree/master/examples to the docker yaml volume path,\r\nand change ip 127.0.0.1 to 192.68.33.231\r\n\r\n![image](https://user-images.githubusercontent.com/22811935/91238051-50699a80-e766-11ea-8c2c-f99aa4561b21.png)\r\n\r\nWhy locust is not running ??", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1544/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1544/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1542", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1542/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1542/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1542/events", "html_url": "https://github.com/locustio/locust/issues/1542", "id": 685376386, "node_id": "MDU6SXNzdWU2ODUzNzYzODY=", "number": 1542, "title": "use_as_lib.py example getting stuck when running", "user": {"login": "naphta", "id": 6709831, "node_id": "MDQ6VXNlcjY3MDk4MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/6709831?v=4", "gravatar_id": "", "url": "https://api.github.com/users/naphta", "html_url": "https://github.com/naphta", "followers_url": "https://api.github.com/users/naphta/followers", "following_url": "https://api.github.com/users/naphta/following{/other_user}", "gists_url": "https://api.github.com/users/naphta/gists{/gist_id}", "starred_url": "https://api.github.com/users/naphta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/naphta/subscriptions", "organizations_url": "https://api.github.com/users/naphta/orgs", "repos_url": "https://api.github.com/users/naphta/repos", "events_url": "https://api.github.com/users/naphta/events{/privacy}", "received_events_url": "https://api.github.com/users/naphta/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-08-25T10:40:36Z", "updated_at": "2020-08-25T14:15:14Z", "closed_at": "2020-08-25T14:15:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nRunning the as a library example gets stuck looping over empty stats. It appears that from the traceback it's stuck running the stats and that the gevent is somehow blocking\r\n\r\nI've tested with Python 3.7.3 and Python 3.8, as well as Locust 1.2.2 and Locust 1.2.1.\r\n\r\n```\r\n2020-08-25T10:38:16Z\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 38, in <module>\r\n    gevent.spawn(stats_history(env.runner))\r\n  File \"/Users/jhill/.local/share/virtualenvs/node-service-loadtesting-grpc-jUoOf3CB/lib/python3.7/site-packages/locust/stats.py\", line 773, in stats_history\r\n    gevent.sleep(HISTORY_STATS_INTERVAL_SEC)\r\n  File \"/Users/jhill/.local/share/virtualenvs/node-service-loadtesting-grpc-jUoOf3CB/lib/python3.7/site-packages/gevent/hub.py\", line 163, in sleep\r\n    hub.wait(t)\r\n  File \"src/gevent/_hub_primitives.py\", line 46, in gevent._gevent_c_hub_primitives.WaitOperationsGreenlet.wait\r\n  File \"src/gevent/_hub_primitives.py\", line 55, in gevent._gevent_c_hub_primitives.WaitOperationsGreenlet.wait\r\n  File \"src/gevent/_waiter.py\", line 151, in gevent._gevent_c_waiter.Waiter.get\r\n  File \"src/gevent/_greenlet_primitives.py\", line 61, in gevent._gevent_c_greenlet_primitives.SwitchOutGreenletWithLoop.switch\r\n  File \"src/gevent/_greenlet_primitives.py\", line 61, in gevent._gevent_c_greenlet_primitives.SwitchOutGreenletWithLoop.switch\r\n  File \"src/gevent/_greenlet_primitives.py\", line 65, in gevent._gevent_c_greenlet_primitives.SwitchOutGreenletWithLoop.switch\r\n  File \"src/gevent/_gevent_c_greenlet_primitives.pxd\", line 35, in gevent._gevent_c_greenlet_primitives._greenlet_switch\r\nKeyboardInterrupt\r\n```\r\n\r\n### Expected behavior\r\nThe Web UI should come up, show stats, and have a test running when loaded.\r\n\r\n### Actual behavior\r\nThe Web UI is blank, a test is never started.\r\n\r\n### Steps to reproduce\r\nCopy the use_as_lib.py example, run with python from the command line.\r\n\r\n### Environment\r\n\r\n- OS: macOS 10.15.5\r\n- Python version: 3.8.5, 3.7.3\r\n- Locust version: 1.2.2, 1.2.1\r\n- Locust command line that you ran: `python use_as_lib.py`\r\n- Locust file contents (anonymized if necessary):\r\n```\r\nimport gevent\r\nfrom locust import HttpUser, task, between\r\nfrom locust.env import Environment\r\nfrom locust.stats import stats_printer, stats_history\r\nfrom locust.log import setup_logging\r\n\r\nsetup_logging(\"INFO\", None)\r\n\r\n\r\nclass User(HttpUser):\r\n    wait_time = between(1, 3)\r\n    host = \"https://docs.locust.io\"\r\n\r\n    @task\r\n    def my_task(self):\r\n        self.client.get(\"/\")\r\n\r\n    @task\r\n    def task_404(self):\r\n        self.client.get(\"/non-existing-path\")\r\n\r\n# setup Environment and Runner\r\nenv = Environment(user_classes=[User])\r\nenv.create_local_runner()\r\n\r\n# start a WebUI instance\r\nenv.create_web_ui(\"127.0.0.1\", 8089)\r\n\r\n# start a greenlet that periodically outputs the current stats\r\ngevent.spawn(stats_printer(env.stats))\r\n\r\n# start a greenlet that save current stats to history\r\ngevent.spawn(stats_history(env.runner))\r\n\r\n# start the test\r\nenv.runner.start(1, spawn_rate=10)\r\n\r\n# in 60 seconds stop the runner\r\ngevent.spawn_later(60, lambda: env.runner.quit())\r\n\r\n# wait for the greenlets\r\nenv.runner.greenlet.join()\r\n\r\n# stop the web server for good measures\r\nenv.web_ui.stop()\r\n```\r\n\r\n- Packages installed:\r\n```\r\ncertifi==2020.6.20\r\nchardet==3.0.4\r\nclick==7.1.2\r\nConfigArgParse==1.2.3\r\nFlask==1.1.2\r\nFlask-BasicAuth==0.2.0\r\ngevent==20.6.2\r\ngeventhttpclient==1.4.4\r\ngreenlet==0.4.16\r\ngrpcio==1.31.0\r\ngrpcio-tools==1.31.0\r\nidna==2.10\r\nitsdangerous==1.1.0\r\nJinja2==2.11.2\r\nlocust==1.2.2\r\nMarkupSafe==1.1.1\r\nmsgpack==1.0.0\r\nprotobuf==3.13.0\r\npsutil==5.7.2\r\npyzmq==19.0.2\r\nrequests==2.24.0\r\nsix==1.15.0\r\nurllib3==1.25.10\r\nWerkzeug==1.0.1\r\nzope.event==4.4\r\nzope.interface==5.1.0\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1542/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1542/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1540", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1540/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1540/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1540/events", "html_url": "https://github.com/locustio/locust/issues/1540", "id": 683536819, "node_id": "MDU6SXNzdWU2ODM1MzY4MTk=", "number": 1540, "title": "Locust stuck in \"Shape worker starting\" when restarting a test from the webUI", "user": {"login": "ancameme", "id": 1786940, "node_id": "MDQ6VXNlcjE3ODY5NDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1786940?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ancameme", "html_url": "https://github.com/ancameme", "followers_url": "https://api.github.com/users/ancameme/followers", "following_url": "https://api.github.com/users/ancameme/following{/other_user}", "gists_url": "https://api.github.com/users/ancameme/gists{/gist_id}", "starred_url": "https://api.github.com/users/ancameme/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ancameme/subscriptions", "organizations_url": "https://api.github.com/users/ancameme/orgs", "repos_url": "https://api.github.com/users/ancameme/repos", "events_url": "https://api.github.com/users/ancameme/events{/privacy}", "received_events_url": "https://api.github.com/users/ancameme/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-08-21T12:47:25Z", "updated_at": "2020-08-24T10:44:09Z", "closed_at": "2020-08-24T10:44:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\nWhen restarting a test (that uses LoadTestShape) from the webUI, the test gets stuck in \"Shape worker starting\" (until tick() signals another change in shape). \r\n\r\n#### Expected behavior\r\nTest should start immediately without waiting on a change in load shape. \r\n\r\n#### Actual behavior\r\nTest waits on a change in load shape\r\n\r\nExample file: \r\n```\r\nimport datetime\r\nfrom locust import HttpUser, TaskSet, task, constant\r\nfrom locust import LoadTestShape\r\n\r\nclass UserTasks(TaskSet):\r\n    @task\r\n    def something(self):\r\n        self.client.post(f'/')\r\n\r\nclass WebsiteUser(HttpUser):\r\n    wait_time = constant(1)\r\n    tasks = [UserTasks]\r\n\r\nclass upAndDown(LoadTestShape):\r\n    def tick(self):\r\n        if datetime.datetime.now().minute % 2 == 0:\r\n            user_count = 4\r\n        else:\r\n            user_count = 5\r\n        return (user_count, 2)\r\n```\r\nStart test then stop. Restart the test from webUI (New test). The test won't start running until the minute changes (and tick() returns a different user_count). \r\n\r\nSeems to be due to \r\n``` \r\n            elif self.shape_last_state == new_state:\r\n                gevent.sleep(1)\r\n```\r\nin runners.py > Runner > shape_worker\r\n\r\nand `self.shape_last_state = None` not being reset in stop()\r\n\r\n\r\n- Python version: 3.6.9\r\n- Locust version:  1.2.1\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1540/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1540/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1537", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1537/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1537/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1537/events", "html_url": "https://github.com/locustio/locust/issues/1537", "id": 682951869, "node_id": "MDU6SXNzdWU2ODI5NTE4Njk=", "number": 1537, "title": " Error: No tasks defined. use the @task decorator or set the tasks property of the User ", "user": {"login": "saranyagupta05", "id": 45310966, "node_id": "MDQ6VXNlcjQ1MzEwOTY2", "avatar_url": "https://avatars.githubusercontent.com/u/45310966?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saranyagupta05", "html_url": "https://github.com/saranyagupta05", "followers_url": "https://api.github.com/users/saranyagupta05/followers", "following_url": "https://api.github.com/users/saranyagupta05/following{/other_user}", "gists_url": "https://api.github.com/users/saranyagupta05/gists{/gist_id}", "starred_url": "https://api.github.com/users/saranyagupta05/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saranyagupta05/subscriptions", "organizations_url": "https://api.github.com/users/saranyagupta05/orgs", "repos_url": "https://api.github.com/users/saranyagupta05/repos", "events_url": "https://api.github.com/users/saranyagupta05/events{/privacy}", "received_events_url": "https://api.github.com/users/saranyagupta05/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-08-20T17:36:57Z", "updated_at": "2020-08-21T19:51:38Z", "closed_at": "2020-08-21T19:50:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version: 3.8.2\r\n- Locust version: 1.2.1 \r\n- Locust command line that you ran: bash loadgen.sh \r\n- Locust file contents (anonymized if necessary): \r\n\r\nOn running loadgen.sh, I see this this error, \r\n```\r\n[2020-08-20 22:41:38,964] saranyagupta05-Inspiron-5370/ERROR/locust.user.task: No tasks defined. use the @task decorator or set the tasks property of the User\r\nTraceback (most recent call last):\r\n  File \"/home/saranyagupta05/anaconda3/lib/python3.8/site-packages/locust/user/task.py\", line 280, in run\r\n    self.schedule_task(self.get_next_task())\r\n  File \"/home/saranyagupta05/anaconda3/lib/python3.8/site-packages/locust/user/task.py\", line 409, in get_next_task\r\n    raise Exception(\"No tasks defined. use the @task decorator or set the tasks property of the User\")\r\nException: No tasks defined. use the @task decorator or set the tasks property of the User\r\n\r\n```\r\nThe locust file used is locust.py: \r\n```\r\n#!/usr/bin/python\r\n#\r\n# Copyright 2018 Google LLC\r\n#\r\n# Licensed under the Apache License, Version 2.0 (the \"License\");\r\n# you may not use this file except in compliance with the License.\r\n# You may obtain a copy of the License at\r\n#\r\n#      http://www.apache.org/licenses/LICENSE-2.0\r\n#\r\n# Unless required by applicable law or agreed to in writing, software\r\n# distributed under the License is distributed on an \"AS IS\" BASIS,\r\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n# See the License for the specific language governing permissions and\r\n# limitations under the License.\r\n\r\nimport random\r\nfrom locust import HttpUser, TaskSet, between\r\n\r\nproducts = [\r\n    '0PUK6V6EV0',\r\n    '1YMWWN1N4O',\r\n    '2ZYFJ3GM2N',\r\n    '66VCHSJNUP',\r\n    '6E92ZMYYFZ',\r\n    '9SIQT8TOJO',\r\n    'L9ECAV7KIM',\r\n    'LS4PSXUNUM',\r\n    'OLJCESPC7Z']\r\n\r\ndef index(l):\r\n    l.client.get(\"/\")\r\n\r\ndef setCurrency(l):\r\n    currencies = ['EUR', 'USD', 'JPY', 'CAD']\r\n    l.client.post(\"/setCurrency\",\r\n        {'currency_code': random.choice(currencies)})\r\n\r\ndef browseProduct(l):\r\n    l.client.get(\"/product/\" + random.choice(products))\r\n\r\ndef viewCart(l):\r\n    l.client.get(\"/cart\")\r\n\r\ndef addToCart(l):\r\n    product = random.choice(products)\r\n    l.client.get(\"/product/\" + product)\r\n    l.client.post(\"/cart\", {\r\n        'product_id': product,\r\n        'quantity': random.choice([1,2,3,4,5,10])})\r\n\r\ndef checkout(l):\r\n    addToCart(l)\r\n    l.client.post(\"/cart/checkout\", {\r\n        'email': 'someone@example.com',\r\n        'street_address': '1600 Amphitheatre Parkway',\r\n        'zip_code': '94043',\r\n        'city': 'Mountain View',\r\n        'state': 'CA',\r\n        'country': 'United States',\r\n        'credit_card_number': '4432-8015-6152-0454',\r\n        'credit_card_expiration_month': '1',\r\n        'credit_card_expiration_year': '2039',\r\n        'credit_card_cvv': '672',\r\n    })\r\n\r\nclass UserBehavior(TaskSet):\r\n\r\n    def on_start(self):\r\n        index(self)\r\n\r\n    tasks = {index: 1,\r\n        setCurrency: 2,\r\n        browseProduct: 10,\r\n        addToCart: 2,\r\n        viewCart: 3,\r\n        checkout: 1}\r\n\r\nclass WebsiteUser(HttpUser):\r\n    task_set = UserBehavior\r\n    wait_time = between(1, 10)\r\n```\r\nFile loadgen.sh - \r\n\r\n```\r\n#!/bin/bash\r\n#\r\n# Copyright 2018 Google LLC\r\n#\r\n# Licensed under the Apache License, Version 2.0 (the \"License\");\r\n# you may not use this file except in compliance with the License.\r\n# You may obtain a copy of the License at\r\n#\r\n#      http://www.apache.org/licenses/LICENSE-2.0\r\n#\r\n# Unless required by applicable law or agreed to in writing, software\r\n# distributed under the License is distributed on an \"AS IS\" BASIS,\r\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n# See the License for the specific language governing permissions and\r\n# limitations under the License.\r\n\r\nset -e\r\ntrap \"exit\" TERM\r\n\r\nif [[ -z \"${FRONTEND_ADDR}\" ]]; then\r\n    echo >&2 \"FRONTEND_ADDR not specified\"\r\n    exit 1\r\nfi\r\n\r\nset -x\r\n\r\n# if one request to the frontend fails, then exit\r\nSTATUSCODE=$(curl --silent --output /dev/stderr --write-out \"%{http_code}\" http://${FRONTEND_ADDR})\r\nif test $STATUSCODE -ne 200; then\r\n    echo \"Error: Could not reach frontend - Status code: ${STATUSCODE}\"\r\n    exit 1\r\nfi\r\n\r\n# else, run loadgen\r\nlocust --host=\"http://${FRONTEND_ADDR}\" --no-web -c \"${USERS:-10}\" 2>&1\r\n```\r\nI wanted logs to be generated that showed user behaviour, but instead I see a lot of wrror messages like the one mentioned above. How can this be solved? Is this an issue with locust? Thanks for the help! ", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1537/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1537/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1535", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1535/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1535/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1535/events", "html_url": "https://github.com/locustio/locust/issues/1535", "id": 682728779, "node_id": "MDU6SXNzdWU2ODI3Mjg3Nzk=", "number": 1535, "title": "After starting test from UI, state shows as STOPPED even though it's running", "user": {"login": "max-rocket-internet", "id": 8859277, "node_id": "MDQ6VXNlcjg4NTkyNzc=", "avatar_url": "https://avatars.githubusercontent.com/u/8859277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/max-rocket-internet", "html_url": "https://github.com/max-rocket-internet", "followers_url": "https://api.github.com/users/max-rocket-internet/followers", "following_url": "https://api.github.com/users/max-rocket-internet/following{/other_user}", "gists_url": "https://api.github.com/users/max-rocket-internet/gists{/gist_id}", "starred_url": "https://api.github.com/users/max-rocket-internet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/max-rocket-internet/subscriptions", "organizations_url": "https://api.github.com/users/max-rocket-internet/orgs", "repos_url": "https://api.github.com/users/max-rocket-internet/repos", "events_url": "https://api.github.com/users/max-rocket-internet/events{/privacy}", "received_events_url": "https://api.github.com/users/max-rocket-internet/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}, {"id": 2115072627, "node_id": "MDU6TGFiZWwyMTE1MDcyNjI3", "url": "https://api.github.com/repos/locustio/locust/labels/non-critical", "name": "non-critical", "color": "c4e4c9", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 17, "created_at": "2020-08-20T13:42:46Z", "updated_at": "2021-03-16T13:37:21Z", "closed_at": "2021-03-16T13:37:21Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\nAfter starting test from UI, state shows as `STOPPED` even though it's running.\r\n\r\nIf I click start again, then the status is updated to `SPAWNING` correctly\r\n\r\n![Screen Shot 2020-08-20 at 15 32 25](https://user-images.githubusercontent.com/8859277/90776440-63114900-e2fa-11ea-83e1-62293bc18a0c.png)\r\n\r\n### Expected behavior\r\n\r\nStatus should show as \"SPAWNING\" I believe.\r\n\r\n### Steps to reproduce\r\n\r\nJust start test from UI.\r\n\r\n### Environment\r\n\r\n- OS: k8s\r\n- Locust version: 1.2.1", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1535/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1535/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1531", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1531/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1531/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1531/events", "html_url": "https://github.com/locustio/locust/issues/1531", "id": 682556562, "node_id": "MDU6SXNzdWU2ODI1NTY1NjI=", "number": 1531, "title": "ValueError: StatsEntry.use_response_times_cache must be set to True", "user": {"login": "max-rocket-internet", "id": 8859277, "node_id": "MDQ6VXNlcjg4NTkyNzc=", "avatar_url": "https://avatars.githubusercontent.com/u/8859277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/max-rocket-internet", "html_url": "https://github.com/max-rocket-internet", "followers_url": "https://api.github.com/users/max-rocket-internet/followers", "following_url": "https://api.github.com/users/max-rocket-internet/following{/other_user}", "gists_url": "https://api.github.com/users/max-rocket-internet/gists{/gist_id}", "starred_url": "https://api.github.com/users/max-rocket-internet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/max-rocket-internet/subscriptions", "organizations_url": "https://api.github.com/users/max-rocket-internet/orgs", "repos_url": "https://api.github.com/users/max-rocket-internet/repos", "events_url": "https://api.github.com/users/max-rocket-internet/events{/privacy}", "received_events_url": "https://api.github.com/users/max-rocket-internet/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2020-08-20T09:16:09Z", "updated_at": "2022-03-23T08:38:33Z", "closed_at": "2020-08-20T13:08:01Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I see this on every locust worker running `1.2`:\r\n\r\n```\r\n$ locust --worker --locustfile=main.py\r\n[2020-08-20 11:02:50,637] C02TD0F6GTDX/INFO/locust.main: Starting Locust 1.2\r\nTraceback (most recent call last):\r\n  File \"src/gevent/greenlet.py\", line 854, in gevent._gevent_cgreenlet.Greenlet.run\r\n  File \"/usr/local/lib/python3.8/site-packages/locust/stats.py\", line 766, in stats_history\r\n    'response_time_percentile_95': stats.total.get_current_response_time_percentile(0.95) or 0,\r\n  File \"/usr/local/lib/python3.8/site-packages/locust/stats.py\", line 553, in get_current_response_time_percentile\r\n    raise ValueError(\"StatsEntry.use_response_times_cache must be set to True if we should be able to calculate the _current_ response time percentile\")\r\nValueError: StatsEntry.use_response_times_cache must be set to True if we should be able to calculate the _current_ response time percentile\r\n2020-08-20T09:02:50Z <Greenlet at 0x10803f6a0: stats_history(<locust.runners.WorkerRunner object at 0x10806da60)> failed with ValueError\r\n```\r\n\r\nTried with very basic locust file, same issue:\r\n\r\n```python\r\nfrom locust import HttpUser, TaskSet, task, between\r\n\r\nclass LoadTestTask(TaskSet):\r\n    def on_start(self):\r\n        pass\r\n\r\n    @task(3)\r\n    def get_token(self):\r\n        pass\r\n\r\nclass LoadTest(HttpUser):\r\n    tasks = [LoadTestTask]\r\n    wait_time = between(0.1, 1)\r\n```\r\n\r\nAny idea @cyberw or @vstepanov-lohika-tix?", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1531/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1531/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1529", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1529/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1529/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1529/events", "html_url": "https://github.com/locustio/locust/issues/1529", "id": 681680059, "node_id": "MDU6SXNzdWU2ODE2ODAwNTk=", "number": 1529, "title": "Screenshot in locust.io still shows old terminology", "user": {"login": "max-rocket-internet", "id": 8859277, "node_id": "MDQ6VXNlcjg4NTkyNzc=", "avatar_url": "https://avatars.githubusercontent.com/u/8859277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/max-rocket-internet", "html_url": "https://github.com/max-rocket-internet", "followers_url": "https://api.github.com/users/max-rocket-internet/followers", "following_url": "https://api.github.com/users/max-rocket-internet/following{/other_user}", "gists_url": "https://api.github.com/users/max-rocket-internet/gists{/gist_id}", "starred_url": "https://api.github.com/users/max-rocket-internet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/max-rocket-internet/subscriptions", "organizations_url": "https://api.github.com/users/max-rocket-internet/orgs", "repos_url": "https://api.github.com/users/max-rocket-internet/repos", "events_url": "https://api.github.com/users/max-rocket-internet/events{/privacy}", "received_events_url": "https://api.github.com/users/max-rocket-internet/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2115072627, "node_id": "MDU6TGFiZWwyMTE1MDcyNjI3", "url": "https://api.github.com/repos/locustio/locust/labels/non-critical", "name": "non-critical", "color": "c4e4c9", "default": false, "description": ""}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-08-19T09:13:56Z", "updated_at": "2021-04-22T01:54:50Z", "closed_at": "2021-04-22T01:54:50Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "It should be updated: https://locust.io/static/img/screenshot_0.12.1.png", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1529/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1529/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1519", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1519/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1519/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1519/events", "html_url": "https://github.com/locustio/locust/issues/1519", "id": 679092966, "node_id": "MDU6SXNzdWU2NzkwOTI5NjY=", "number": 1519, "title": "Number of Open files issue", "user": {"login": "harsh976", "id": 29836005, "node_id": "MDQ6VXNlcjI5ODM2MDA1", "avatar_url": "https://avatars.githubusercontent.com/u/29836005?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harsh976", "html_url": "https://github.com/harsh976", "followers_url": "https://api.github.com/users/harsh976/followers", "following_url": "https://api.github.com/users/harsh976/following{/other_user}", "gists_url": "https://api.github.com/users/harsh976/gists{/gist_id}", "starred_url": "https://api.github.com/users/harsh976/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harsh976/subscriptions", "organizations_url": "https://api.github.com/users/harsh976/orgs", "repos_url": "https://api.github.com/users/harsh976/repos", "events_url": "https://api.github.com/users/harsh976/events{/privacy}", "received_events_url": "https://api.github.com/users/harsh976/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-08-14T11:25:20Z", "updated_at": "2020-08-15T15:25:21Z", "closed_at": "2020-08-15T15:25:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "As soon as I start my script the number of open files increases drastically\r\n\r\n(perftestvirtualenv) [jenkins@ip]$ lsof |wc -l\r\n  Before start of a program   : 4473\r\n(perftestvirtualenv) [jenkins@ip]$ lsof |wc -l\r\nAfter the start of a program 6989\r\n\r\nThe number of open files is way too high even before the script execution has been started.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1519/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1519/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1513", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1513/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1513/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1513/events", "html_url": "https://github.com/locustio/locust/issues/1513", "id": 676995534, "node_id": "MDU6SXNzdWU2NzY5OTU1MzQ=", "number": 1513, "title": "test_cpu_warning test is flakey", "user": {"login": "max-rocket-internet", "id": 8859277, "node_id": "MDQ6VXNlcjg4NTkyNzc=", "avatar_url": "https://avatars.githubusercontent.com/u/8859277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/max-rocket-internet", "html_url": "https://github.com/max-rocket-internet", "followers_url": "https://api.github.com/users/max-rocket-internet/followers", "following_url": "https://api.github.com/users/max-rocket-internet/following{/other_user}", "gists_url": "https://api.github.com/users/max-rocket-internet/gists{/gist_id}", "starred_url": "https://api.github.com/users/max-rocket-internet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/max-rocket-internet/subscriptions", "organizations_url": "https://api.github.com/users/max-rocket-internet/orgs", "repos_url": "https://api.github.com/users/max-rocket-internet/repos", "events_url": "https://api.github.com/users/max-rocket-internet/events{/privacy}", "received_events_url": "https://api.github.com/users/max-rocket-internet/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-08-11T15:56:20Z", "updated_at": "2020-08-17T22:06:28Z", "closed_at": "2020-08-14T10:27:09Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I see this very often when running tests locally:\r\n\r\n```\r\n___________________________ TestLocustRunner.test_cpu_warning ___________________________\r\n\r\nself = <locust.test.test_runners.TestLocustRunner testMethod=test_cpu_warning>\r\n\r\n    def test_cpu_warning(self):\r\n        _monitor_interval = runners.CPU_MONITOR_INTERVAL\r\n        runners.CPU_MONITOR_INTERVAL = 2.0\r\n        try:\r\n            class CpuUser(User):\r\n                wait_time = constant(0.001)\r\n                @task\r\n                def cpu_task(self):\r\n                    for i in range(1000000):\r\n                        _ = 3 / 2\r\n            environment = Environment(user_classes=[CpuUser])\r\n            runner = LocalRunner(environment)\r\n            self.assertFalse(runner.cpu_warning_emitted)\r\n            runner.spawn_users(1, 1, wait=False)\r\n            sleep(2.5)\r\n            runner.quit()\r\n>           self.assertTrue(runner.cpu_warning_emitted)\r\nE           AssertionError: False is not true\r\n\r\ntest/test_runners.py:121: AssertionError\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1513/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1513/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1507", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1507/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1507/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1507/events", "html_url": "https://github.com/locustio/locust/issues/1507", "id": 675976146, "node_id": "MDU6SXNzdWU2NzU5NzYxNDY=", "number": 1507, "title": "How to run a single test? It would make development and debugging much faster", "user": {"login": "max-rocket-internet", "id": 8859277, "node_id": "MDQ6VXNlcjg4NTkyNzc=", "avatar_url": "https://avatars.githubusercontent.com/u/8859277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/max-rocket-internet", "html_url": "https://github.com/max-rocket-internet", "followers_url": "https://api.github.com/users/max-rocket-internet/followers", "following_url": "https://api.github.com/users/max-rocket-internet/following{/other_user}", "gists_url": "https://api.github.com/users/max-rocket-internet/gists{/gist_id}", "starred_url": "https://api.github.com/users/max-rocket-internet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/max-rocket-internet/subscriptions", "organizations_url": "https://api.github.com/users/max-rocket-internet/orgs", "repos_url": "https://api.github.com/users/max-rocket-internet/repos", "events_url": "https://api.github.com/users/max-rocket-internet/events{/privacy}", "received_events_url": "https://api.github.com/users/max-rocket-internet/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-08-10T08:56:26Z", "updated_at": "2021-01-21T13:38:11Z", "closed_at": "2021-01-21T13:38:11Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I've searched repeatedly, read `tox` docs but I can't work this out. It would make development and debugging tests much easier \ud83d\ude42\r\n\r\nI think it's possible like this some how:\r\n\r\n```\r\ntox -e py38 -- test_stop_users_with_hatch_rate\r\ntox -e py38 -- locust.test.test_runners::TestMasterRunner::test_stop_users_with_hatch_rate\r\ntox -e py38 -- locust.test.test_runners.TestMasterRunner\r\ntox -e py38 test/test_runners.py::TestMasterRunner::test_stop_users_with_hatch_rate\r\n```\r\n\r\nAny idea?\r\n\r\n### Environment\r\n\r\n- OS: MacOS\r\n- Python version: 3.8\r\n- Locust version: `master`", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1507/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1507/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1501", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1501/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1501/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1501/events", "html_url": "https://github.com/locustio/locust/issues/1501", "id": 672730663, "node_id": "MDU6SXNzdWU2NzI3MzA2NjM=", "number": 1501, "title": "Excessive precision of metrics in losust csv stats ", "user": {"login": "vstepanov-lohika-tix", "id": 48280294, "node_id": "MDQ6VXNlcjQ4MjgwMjk0", "avatar_url": "https://avatars.githubusercontent.com/u/48280294?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vstepanov-lohika-tix", "html_url": "https://github.com/vstepanov-lohika-tix", "followers_url": "https://api.github.com/users/vstepanov-lohika-tix/followers", "following_url": "https://api.github.com/users/vstepanov-lohika-tix/following{/other_user}", "gists_url": "https://api.github.com/users/vstepanov-lohika-tix/gists{/gist_id}", "starred_url": "https://api.github.com/users/vstepanov-lohika-tix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vstepanov-lohika-tix/subscriptions", "organizations_url": "https://api.github.com/users/vstepanov-lohika-tix/orgs", "repos_url": "https://api.github.com/users/vstepanov-lohika-tix/repos", "events_url": "https://api.github.com/users/vstepanov-lohika-tix/events{/privacy}", "received_events_url": "https://api.github.com/users/vstepanov-lohika-tix/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-08-04T11:48:29Z", "updated_at": "2020-08-10T08:58:13Z", "closed_at": "2020-08-08T21:45:51Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Describe the bug\r\nAfter upgrade from 0.14.4 to 1.1.1 the most of metrics in csv report became with excessive precision (> 10 digits after point) \r\nIt doesn't make sense and makes report hard readable. \r\nNot reproduced in console stats\r\n\r\n### Expected behavior\r\nPrecision for time metrics & content size should be integer number.\r\nPrecision for requests rate - float with maximum 2-3 digits after point.\r\n\r\n### Actual behavior\r\nOver 10 digits after point:\r\n![image](https://user-images.githubusercontent.com/48280294/89289212-803dea80-d65f-11ea-9a6a-55fef9f3c1d3.png)\r\n\r\n\r\n### Steps to reproduce\r\nRun any test with HTTP requests & --headless & --csv=report option and check report-stats.csv result file.\r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version: 3.7.2\r\n- Locust version: 1.1.1\r\n- Locust command line that you ran: \r\nlocust -f {locust_file_path} --headless -u {users_number} -r {hatch_rate} --run-time={run_time} --csv=results --exit-code-on-error=0\r\n- Locust file contents (anonymized if necessary): - complicated.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1501/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1501/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1500", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1500/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1500/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1500/events", "html_url": "https://github.com/locustio/locust/issues/1500", "id": 672299540, "node_id": "MDU6SXNzdWU2NzIyOTk1NDA=", "number": 1500, "title": "WorkerRunner spawns heartbeat before setting worker_state", "user": {"login": "Bubba74", "id": 5572744, "node_id": "MDQ6VXNlcjU1NzI3NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5572744?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Bubba74", "html_url": "https://github.com/Bubba74", "followers_url": "https://api.github.com/users/Bubba74/followers", "following_url": "https://api.github.com/users/Bubba74/following{/other_user}", "gists_url": "https://api.github.com/users/Bubba74/gists{/gist_id}", "starred_url": "https://api.github.com/users/Bubba74/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Bubba74/subscriptions", "organizations_url": "https://api.github.com/users/Bubba74/orgs", "repos_url": "https://api.github.com/users/Bubba74/repos", "events_url": "https://api.github.com/users/Bubba74/events{/privacy}", "received_events_url": "https://api.github.com/users/Bubba74/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-08-03T19:41:09Z", "updated_at": "2020-08-04T15:16:02Z", "closed_at": "2020-08-04T15:14:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nThe WorkerRunner.heartbeat() method fails with\r\nException: WorkerRunner object does not have member 'worker_state'\r\n\r\nLooking at the WorkerRunner class: https://github.com/locustio/locust/blob/f5b89d76d6027da021a3dbf2a7816d288a5dde3d/locust/runners.py#L612-L615\r\nThe heartbeat greenlet is spawned on Line#612, while the WorkerRunner.worker_state is set on Line#615. It might have been a rare case where gevent preempted the current thread in such a short gap. But it definitely happened several times.\r\n\r\n### Suggested Fix\r\nIn the WorkerRunner class:\r\nhttps://github.com/locustio/locust/blob/f5b89d76d6027da021a3dbf2a7816d288a5dde3d/locust/runners.py#L612-L615\r\nMove Line#615 to before Line#612. This guarantees that WorkerRunner.worker_state is set for all calls to heartbeat().\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nThere should not be an exception.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nThe exception occurs.\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\nI'm struggling to reproduce this, but the issue seems easy enough to believe and a possible fix is super easy.\r\n\r\n### Environment\r\n\r\n- OS:\r\nLinux 4.4.0-166-generic #195-Ubuntu GNU/Linux\r\n- Python version:\r\nPython 3.6.9 (2ad108f17bdb, Apr 07 2020, 02:59:05)\r\n[PyPy 7.3.1 with GCC 7.3.1 20180303 (Red Hat 7.3.1-5)]\r\n- Locust version:\r\nlocust 1.1.1\r\n\r\n- I can't reproduce this, so I can't provide details here. But I ran a master/1worker setup, both created via library calls, not the command line.\r\n  * Locust command line that you ran:\r\n  * Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1500/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1500/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1493", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1493/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1493/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1493/events", "html_url": "https://github.com/locustio/locust/issues/1493", "id": 665486872, "node_id": "MDU6SXNzdWU2NjU0ODY4NzI=", "number": 1493, "title": "The locust python instance can use max 1 cpu core on macOS", "user": {"login": "bnlcnd", "id": 35465720, "node_id": "MDQ6VXNlcjM1NDY1NzIw", "avatar_url": "https://avatars.githubusercontent.com/u/35465720?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bnlcnd", "html_url": "https://github.com/bnlcnd", "followers_url": "https://api.github.com/users/bnlcnd/followers", "following_url": "https://api.github.com/users/bnlcnd/following{/other_user}", "gists_url": "https://api.github.com/users/bnlcnd/gists{/gist_id}", "starred_url": "https://api.github.com/users/bnlcnd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bnlcnd/subscriptions", "organizations_url": "https://api.github.com/users/bnlcnd/orgs", "repos_url": "https://api.github.com/users/bnlcnd/repos", "events_url": "https://api.github.com/users/bnlcnd/events{/privacy}", "received_events_url": "https://api.github.com/users/bnlcnd/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-07-25T01:09:45Z", "updated_at": "2022-07-22T04:30:06Z", "closed_at": "2020-07-25T10:23:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nI have a simple locust file which hit an json rest endpoint. I start the load with 50 user with hatch rate 25. Then I try to keep adding users in the next run. No matter how many user I specify in the command, I can see that the CPU is only top at 100%CPU cores on my mac with 16CPU cores.\r\n\r\n### Expected behavior\r\nI expect it to take more CPU and ram when the load is increasing.\r\n\r\n### Actual behavior\r\nCPU only top at 1 full core never beyond that.\r\n\r\n### Steps to reproduce\r\nrun the locust command below with the python script at the same folder.\r\n\r\nversions of python and locust\r\n```sh\r\ndev01:~$ locust --version\r\nlocust 1.1.1\r\n\r\ndev01:~$ python3 -V\r\nPython 3.8.4\r\n\r\ndev01:~$ python -V\r\nPython 2.7.16\r\n\r\n```\r\n\r\n\r\n### Environment\r\n- OS: MacOS 10.15.6\r\n- Python version: 3.8.4\r\n- Locust version: 1.1.1\r\n- Locust command line that you ran: locust -f class-test-random-site-12month.py --host=https://report.dev.int --headless -u 500 -r 100 -t 3m --csv=result-12mon\r\n\r\n- Locust file contents (anonymized if necessary):\r\n```py\r\nimport random\r\nfrom locust import HttpUser, task, between\r\nfrom locust.contrib.fasthttp import FastHttpUser\r\n\r\nclass QuickstartUser(HttpUser):\r\n    wait_time = between(0, 0)\r\n    @task\r\n    def article_12mon(self):\r\n        # top 20 stores in test data\r\n        storeList = [7041,7011,7013,7047,7042, 7043, 7063]\r\n        # top departments excluding seasonal/garden\r\n        deptList = [27, 24, 59, 29, 25, 23]\r\n        storeId = str(random.choice(storeList))\r\n        deptId = str(random.choice(deptList))\r\n        self.client.get(\"/dashboard/store/\" + storeId + \"/departments/\" + deptId + \"/classes?filterSelection=12MON\", name=\"class-test - store: \" + storeId + \" - dept: \" + deptId)\r\n\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1493/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1493/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1487", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1487/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1487/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1487/events", "html_url": "https://github.com/locustio/locust/issues/1487", "id": 663874109, "node_id": "MDU6SXNzdWU2NjM4NzQxMDk=", "number": 1487, "title": "Negative min_response_time shown in stats", "user": {"login": "max-rocket-internet", "id": 8859277, "node_id": "MDQ6VXNlcjg4NTkyNzc=", "avatar_url": "https://avatars.githubusercontent.com/u/8859277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/max-rocket-internet", "html_url": "https://github.com/max-rocket-internet", "followers_url": "https://api.github.com/users/max-rocket-internet/followers", "following_url": "https://api.github.com/users/max-rocket-internet/following{/other_user}", "gists_url": "https://api.github.com/users/max-rocket-internet/gists{/gist_id}", "starred_url": "https://api.github.com/users/max-rocket-internet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/max-rocket-internet/subscriptions", "organizations_url": "https://api.github.com/users/max-rocket-internet/orgs", "repos_url": "https://api.github.com/users/max-rocket-internet/repos", "events_url": "https://api.github.com/users/max-rocket-internet/events{/privacy}", "received_events_url": "https://api.github.com/users/max-rocket-internet/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2020-07-22T16:00:36Z", "updated_at": "2020-07-23T17:21:34Z", "closed_at": "2020-07-23T17:21:34Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\nNegative value shown for `min_response_time`:\r\n\r\n![Screen Shot 2020-07-22 at 17 58 54](https://user-images.githubusercontent.com/8859277/88199373-124bf900-cc45-11ea-9186-6632cd1a0eb4.png)\r\n\r\n### Expected behavior\r\n\r\n0 or positive value.\r\n\r\n### Actual behavior\r\n\r\nNegative value shown for `min_response_time`\r\n\r\n### Steps to reproduce\r\n\r\nI have a branch local docker-compose setup to reproduce it easily. But it's just 1 worker calling nginx in another docker container.\r\n\r\n### Environment\r\n\r\n- OS: Docker\r\n- Python version: -\r\n- Locust version: current master", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1487/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1487/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1486", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1486/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1486/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1486/events", "html_url": "https://github.com/locustio/locust/issues/1486", "id": 659107275, "node_id": "MDU6SXNzdWU2NTkxMDcyNzU=", "number": 1486, "title": "when locust call teardown(), the param environment is Object, but the fire() param  **kwargs needs dict ", "user": {"login": "FANHIDE", "id": 29531967, "node_id": "MDQ6VXNlcjI5NTMxOTY3", "avatar_url": "https://avatars.githubusercontent.com/u/29531967?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FANHIDE", "html_url": "https://github.com/FANHIDE", "followers_url": "https://api.github.com/users/FANHIDE/followers", "following_url": "https://api.github.com/users/FANHIDE/following{/other_user}", "gists_url": "https://api.github.com/users/FANHIDE/gists{/gist_id}", "starred_url": "https://api.github.com/users/FANHIDE/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FANHIDE/subscriptions", "organizations_url": "https://api.github.com/users/FANHIDE/orgs", "repos_url": "https://api.github.com/users/FANHIDE/repos", "events_url": "https://api.github.com/users/FANHIDE/events{/privacy}", "received_events_url": "https://api.github.com/users/FANHIDE/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-17T10:11:56Z", "updated_at": "2020-08-10T15:34:30Z", "closed_at": "2020-08-10T15:34:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n### Describe the bug\r\n<!--  teardown() include -->\r\n![image](https://user-images.githubusercontent.com/29531967/87774699-78a4d600-c857-11ea-8857-f2d740fa1df6.png)\r\n![image](https://user-images.githubusercontent.com/29531967/87775049-0385d080-c858-11ea-82c8-2598ad305f82.png)\r\n![image](https://user-images.githubusercontent.com/29531967/87775380-96266f80-c858-11ea-935d-2cfbdc324077.png)\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: mac\r\n- Python version: python 3.7\r\n- Locust version: locust v1.1.1\r\n- Locust command line that you ran: python3 locust -f locust_file/dynamice_user_credentials.py --host=*** -u 2000 --worker --master-host=***\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1486/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1486/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1484", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1484/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1484/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1484/events", "html_url": "https://github.com/locustio/locust/issues/1484", "id": 657880613, "node_id": "MDU6SXNzdWU2NTc4ODA2MTM=", "number": 1484, "title": "using locust as a library, events.test_stop.add_listener is not work", "user": {"login": "gxy501", "id": 6625358, "node_id": "MDQ6VXNlcjY2MjUzNTg=", "avatar_url": "https://avatars.githubusercontent.com/u/6625358?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gxy501", "html_url": "https://github.com/gxy501", "followers_url": "https://api.github.com/users/gxy501/followers", "following_url": "https://api.github.com/users/gxy501/following{/other_user}", "gists_url": "https://api.github.com/users/gxy501/gists{/gist_id}", "starred_url": "https://api.github.com/users/gxy501/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gxy501/subscriptions", "organizations_url": "https://api.github.com/users/gxy501/orgs", "repos_url": "https://api.github.com/users/gxy501/repos", "events_url": "https://api.github.com/users/gxy501/events{/privacy}", "received_events_url": "https://api.github.com/users/gxy501/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-16T06:12:32Z", "updated_at": "2020-07-16T11:57:27Z", "closed_at": "2020-07-16T11:26:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe\r\nusing locust as a library, events.test_stop.add_listener is not work\r\n\r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version: 3.8.0\r\n- Locust version: locust 1.1.1\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):\r\n```\r\nimport gevent\r\nfrom locust import HttpUser, task, constant\r\nfrom locust.env import Environment\r\nfrom locust.stats import stats_printer\r\nfrom locust.log import setup_logging\r\nfrom locust.event import EventHook\r\nfrom locust import events\r\n\r\nsetup_logging(\"INFO\", None)\r\n\r\nmy_event = EventHook()\r\ndef on_my_event(**kw):\r\n    print('my event')\r\n\r\nmy_event.add_listener(on_my_event)\r\n\r\n@events.test_stop.add_listener\r\ndef on_test_stop(**kwargs):\r\n    print('on test stop event')\r\n\r\nclass User(HttpUser):\r\n    wait_time = constant(2)\r\n    host = \"https://www.baidu.com\"\r\n\r\n    @task\r\n    def my_task(self):\r\n        my_event.fire()\r\n        self.client.get(\"/\")\r\n\r\n# setup Environment and Runner\r\nenv = Environment(user_classes=[User])\r\nenv.create_local_runner()\r\n\r\n# start a WebUI instance\r\nenv.create_web_ui(\"0.0.0.0\", 8089)\r\n\r\n# start a greenlet that periodically outputs the current stats\r\ngevent.spawn(stats_printer(env.stats))\r\n\r\n# start the test\r\nenv.runner.start(1, hatch_rate=10)\r\n\r\n# in 60 seconds stop the runner\r\ngevent.spawn_later(10, lambda: env.runner.quit())\r\n\r\n# wait for the greenlets\r\nenv.runner.greenlet.join()\r\n\r\n# stop the web server for good measures\r\nenv.web_ui.stop()\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1484/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1484/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1483", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1483/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1483/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1483/events", "html_url": "https://github.com/locustio/locust/issues/1483", "id": 657839677, "node_id": "MDU6SXNzdWU2NTc4Mzk2Nzc=", "number": 1483, "title": "Can not install locust on windows due to geventhttpclient", "user": {"login": "wyatt-z", "id": 6083180, "node_id": "MDQ6VXNlcjYwODMxODA=", "avatar_url": "https://avatars.githubusercontent.com/u/6083180?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wyatt-z", "html_url": "https://github.com/wyatt-z", "followers_url": "https://api.github.com/users/wyatt-z/followers", "following_url": "https://api.github.com/users/wyatt-z/following{/other_user}", "gists_url": "https://api.github.com/users/wyatt-z/gists{/gist_id}", "starred_url": "https://api.github.com/users/wyatt-z/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wyatt-z/subscriptions", "organizations_url": "https://api.github.com/users/wyatt-z/orgs", "repos_url": "https://api.github.com/users/wyatt-z/repos", "events_url": "https://api.github.com/users/wyatt-z/events{/privacy}", "received_events_url": "https://api.github.com/users/wyatt-z/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-07-16T04:33:39Z", "updated_at": "2020-07-16T08:42:25Z", "closed_at": "2020-07-16T08:42:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nCan't install geventhttpclient, it needs Microsoft Visual C++ Build Tools. So intall locust failed.\r\nAnd Microsoft Visual C++ Build Tools is too heavy. Better avoid it if possible.\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nInstalling collected packages: geventhttpclient\r\nRunning setup.py install for geventhttpclient ... error\r\nERROR: Command errored out with exit status 1:\r\ncommand: 'c:\\python38\\python.exe' -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'C:\\Users\\hooply\\AppData\\Local\\Temp\\pip-install-y9_y11l_\\geventhttpclient\\setup.py'\"'\"'; file='\"'\"'C:\\Users\\hooply\\AppData\\Local\\Temp\\pip-install-y9_y11l_\\geventhttpclient\\setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(file);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, file, '\"'\"'exec'\"'\"'))' install --record 'C:\\Users\\hooply\\AppData\\Local\\Temp\\pip-record-ajhtzswu\\install-record.txt' --single-version-externally-managed --compile --install-headers 'c:\\python38\\Include\\geventhttpclient'\r\ncwd: C:\\Users\\hooply\\AppData\\Local\\Temp\\pip-install-y9_y11l_\\geventhttpclient\r\nComplete output (28 lines):\r\nrunning install\r\nrunning build\r\nrunning build_py\r\ncreating build\r\ncreating build\\lib.win-amd64-3.8\r\ncreating build\\lib.win-amd64-3.8\\geventhttpclient\r\ncopying src\\geventhttpclient\\client.py -> build\\lib.win-amd64-3.8\\geventhttpclient\r\ncopying src\\geventhttpclient\\connectionpool.py -> build\\lib.win-amd64-3.8\\geventhttpclient\r\ncopying src\\geventhttpclient\\url.py -> build\\lib.win-amd64-3.8\\geventhttpclient\r\ncopying src\\geventhttpclient\\useragent.py -> build\\lib.win-amd64-3.8\\geventhttpclient\r\ncopying src\\geventhttpclient_init_.py -> build\\lib.win-amd64-3.8\\geventhttpclient\r\nrunning egg_info\r\nwriting src\\geventhttpclient.egg-info\\PKG-INFO\r\nwriting dependency_links to src\\geventhttpclient.egg-info\\dependency_links.txt\r\nwriting requirements to src\\geventhttpclient.egg-info\\requires.txt\r\nwriting top-level names to src\\geventhttpclient.egg-info\\top_level.txt\r\nreading manifest file 'src\\geventhttpclient.egg-info\\SOURCES.txt'\r\nreading manifest template 'MANIFEST.in'\r\nwarning: no previously-included files matching 'pycache' found anywhere in distribution\r\nwarning: no previously-included files matching '*.py[co]' found anywhere in distribution\r\nwarning: no files found matching 'CHANGELOG'\r\nwriting manifest file 'src\\geventhttpclient.egg-info\\SOURCES.txt'\r\nrunning build_ext\r\nbuilding 'geventhttpclient._parser' extension\r\nerror: Microsoft Visual C++ 14.0 is required. Get it with \"Microsoft Visual C++ Build Tools\": https://visualstudio.microsoft.com/downloads/\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\npip install locust\r\n### Environment\r\n\r\n- OS: Windows 10-64bit\r\n- Python version: 3.8\r\n- Locust version: latest\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1483/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1483/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1482", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1482/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1482/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1482/events", "html_url": "https://github.com/locustio/locust/issues/1482", "id": 656942085, "node_id": "MDU6SXNzdWU2NTY5NDIwODU=", "number": 1482, "title": "Locust1.0.3 Master is not receiving all metrics from workers", "user": {"login": "ghost", "id": 10137, "node_id": "MDQ6VXNlcjEwMTM3", "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghost", "html_url": "https://github.com/ghost", "followers_url": "https://api.github.com/users/ghost/followers", "following_url": "https://api.github.com/users/ghost/following{/other_user}", "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghost/subscriptions", "organizations_url": "https://api.github.com/users/ghost/orgs", "repos_url": "https://api.github.com/users/ghost/repos", "events_url": "https://api.github.com/users/ghost/events{/privacy}", "received_events_url": "https://api.github.com/users/ghost/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-14T22:44:25Z", "updated_at": "2020-07-24T18:39:34Z", "closed_at": "2020-07-24T18:39:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\nLocust Master is not receiving all metrics from workers.I am running my pods in openshift platform. Master Pod has below errors.But Worker is hatching all the users. When I run the same test in local, all the metrics going to master.\r\n\r\n[2020-07-14 22:42:30,404] psr-test-psr-testing-master-wa6oa-wrb4z/ERROR/locust.runners: RPCError found when receiving from client: ZMQ interrupted message\r\n[2020-07-14 22:42:30,654] psr-test-psr-testing-master-wa6oa-wrb4z/INFO/locust.runners: Reset connection to worker\r\n\r\n\r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version: 3.8\r\n- Locust version: 1.0.3\r\n- Openshift version-4.3.28", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1482/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1482/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1481", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1481/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1481/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1481/events", "html_url": "https://github.com/locustio/locust/issues/1481", "id": 656126633, "node_id": "MDU6SXNzdWU2NTYxMjY2MzM=", "number": 1481, "title": "All HttpUsers share single session", "user": {"login": "therealmitchconnors", "id": 821270, "node_id": "MDQ6VXNlcjgyMTI3MA==", "avatar_url": "https://avatars.githubusercontent.com/u/821270?v=4", "gravatar_id": "", "url": "https://api.github.com/users/therealmitchconnors", "html_url": "https://github.com/therealmitchconnors", "followers_url": "https://api.github.com/users/therealmitchconnors/followers", "following_url": "https://api.github.com/users/therealmitchconnors/following{/other_user}", "gists_url": "https://api.github.com/users/therealmitchconnors/gists{/gist_id}", "starred_url": "https://api.github.com/users/therealmitchconnors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/therealmitchconnors/subscriptions", "organizations_url": "https://api.github.com/users/therealmitchconnors/orgs", "repos_url": "https://api.github.com/users/therealmitchconnors/repos", "events_url": "https://api.github.com/users/therealmitchconnors/events{/privacy}", "received_events_url": "https://api.github.com/users/therealmitchconnors/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-13T20:43:42Z", "updated_at": "2020-07-20T18:44:12Z", "closed_at": "2020-07-20T18:42:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "Note: I'm hesitant to submit this, as I'm not 100% confident in my reading of the code.  Apologies if I've got it wrong.\r\n\r\n### Describe the bug\r\nIt looks like all http users on a given instance of locust share a single http Session.\r\n\r\n### Expected behavior\r\nEach user should have their own session.\r\n\r\n### Actual behavior\r\nI haven't found a way to test this in a running environment.  It just appears problematic when reading the code.\r\n\r\n### Steps to reproduce\r\nhttps://github.com/locustio/locust/blob/e7758991e1b0616015b269d913eaaad84fdb3398/locust/clients.py#L167\r\nthe _send_request_safe_mode function uses requests.Session to send the request, which is a global instance of the Session class.  Thus, all requests sent from a single locust process will reuse this one session.  I believe the expected behavior is that each User should have their own session.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1481/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1481/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1478", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1478/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1478/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1478/events", "html_url": "https://github.com/locustio/locust/issues/1478", "id": 654840237, "node_id": "MDU6SXNzdWU2NTQ4NDAyMzc=", "number": 1478, "title": "Event hooks are not working as per the documentation", "user": {"login": "WillPower3309", "id": 13266308, "node_id": "MDQ6VXNlcjEzMjY2MzA4", "avatar_url": "https://avatars.githubusercontent.com/u/13266308?v=4", "gravatar_id": "", "url": "https://api.github.com/users/WillPower3309", "html_url": "https://github.com/WillPower3309", "followers_url": "https://api.github.com/users/WillPower3309/followers", "following_url": "https://api.github.com/users/WillPower3309/following{/other_user}", "gists_url": "https://api.github.com/users/WillPower3309/gists{/gist_id}", "starred_url": "https://api.github.com/users/WillPower3309/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/WillPower3309/subscriptions", "organizations_url": "https://api.github.com/users/WillPower3309/orgs", "repos_url": "https://api.github.com/users/WillPower3309/repos", "events_url": "https://api.github.com/users/WillPower3309/events{/privacy}", "received_events_url": "https://api.github.com/users/WillPower3309/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-07-10T14:56:57Z", "updated_at": "2020-08-17T22:07:09Z", "closed_at": "2020-07-10T15:15:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nOn an attempt to add a listener to test_start, I am met with `module 'locust.events' has no attribute 'test_start'`\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n```\r\n@events.test_start.add_listener\r\ndef on_test_start(**kwargs):\r\n    print(\"A new test is starting\")\r\n```\r\nShould print \"a new test is starting\" when the test is ran\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n```\r\nlocust-master_1    | [2020-07-10 14:49:00,185] 8821da7114b5/ERROR/stderr: Traceback (most recent call last):\r\nlocust-master_1    | [2020-07-10 14:49:00,185] 8821da7114b5/ERROR/stderr: File \"/usr/local/bin/locust\", line 8, in <module>\r\nlocust-master_1    | [2020-07-10 14:49:00,186] 8821da7114b5/ERROR/stderr: \r\nlocust-master_1    | [2020-07-10 14:49:00,186] 8821da7114b5/ERROR/stderr: sys.exit(main())\r\nlocust-master_1    | [2020-07-10 14:49:00,186] 8821da7114b5/ERROR/stderr: \r\nlocust-master_1    | [2020-07-10 14:49:00,186] 8821da7114b5/ERROR/stderr: File \"/usr/local/lib/python3.7/site-packages/locust/main.py\", line 420, in main\r\nlocust-master_1    | [2020-07-10 14:49:00,186] 8821da7114b5/ERROR/stderr: \r\nlocust-master_1    | [2020-07-10 14:49:00,186] 8821da7114b5/ERROR/stderr: docstring, locusts = load_locustfile(locustfile)\r\nlocust-master_1    | [2020-07-10 14:49:00,186] 8821da7114b5/ERROR/stderr: \r\nlocust-master_1    | [2020-07-10 14:49:00,186] 8821da7114b5/ERROR/stderr: File \"/usr/local/lib/python3.7/site-packages/locust/main.py\", line 389, in load_locustfile\r\nlocust-master_1    | [2020-07-10 14:49:00,186] 8821da7114b5/ERROR/stderr: \r\nlocust-master_1    | [2020-07-10 14:49:00,186] 8821da7114b5/ERROR/stderr: imported = __import_locustfile__(locustfile, path)\r\nlocust-master_1    | [2020-07-10 14:49:00,186] 8821da7114b5/ERROR/stderr: \r\nlocust-master_1    | [2020-07-10 14:49:00,186] 8821da7114b5/ERROR/stderr: File \"/usr/local/lib/python3.7/site-packages/locust/main.py\", line 365, in __import_locustfile__\r\nlocust-master_1    | [2020-07-10 14:49:00,186] 8821da7114b5/ERROR/stderr: \r\nlocust-master_1    | [2020-07-10 14:49:00,186] 8821da7114b5/ERROR/stderr: return  source.load_module()\r\nlocust-master_1    | [2020-07-10 14:49:00,186] 8821da7114b5/ERROR/stderr: \r\nlocust-master_1    | [2020-07-10 14:49:00,186] 8821da7114b5/ERROR/stderr: File \"<frozen importlib._bootstrap_external>\", line 407, in _check_name_wrapper\r\nlocust-master_1    | [2020-07-10 14:49:00,187] 8821da7114b5/ERROR/stderr: File \"<frozen importlib._bootstrap_external>\", line 907, in load_module\r\nlocust-master_1    | [2020-07-10 14:49:00,187] 8821da7114b5/ERROR/stderr: File \"<frozen importlib._bootstrap_external>\", line 732, in load_module\r\nlocust-master_1    | [2020-07-10 14:49:00,187] 8821da7114b5/ERROR/stderr: File \"<frozen importlib._bootstrap>\", line 265, in _load_module_shim\r\nlocust-master_1    | [2020-07-10 14:49:00,187] 8821da7114b5/ERROR/stderr: File \"<frozen importlib._bootstrap>\", line 696, in _load\r\nlocust-master_1    | [2020-07-10 14:49:00,187] 8821da7114b5/ERROR/stderr: File \"<frozen importlib._bootstrap>\", line 677, in _load_unlocked\r\nlocust-master_1    | [2020-07-10 14:49:00,187] 8821da7114b5/ERROR/stderr: File \"<frozen importlib._bootstrap_external>\", line 728, in exec_module\r\nlocust-master_1    | [2020-07-10 14:49:00,187] 8821da7114b5/ERROR/stderr: File \"<frozen importlib._bootstrap>\", line 219, in _call_with_frames_removed\r\nlocust-master_1    | [2020-07-10 14:49:00,187] 8821da7114b5/ERROR/stderr: File \"/src/locustfile.py\", line 54, in <module>\r\nlocust-master_1    | [2020-07-10 14:49:00,187] 8821da7114b5/ERROR/stderr: \r\nlocust-master_1    | [2020-07-10 14:49:00,187] 8821da7114b5/ERROR/stderr: @events.test_start.add_listener\r\nlocust-master_1    | [2020-07-10 14:49:00,187] 8821da7114b5/ERROR/stderr: \r\nlocust-master_1    | [2020-07-10 14:49:00,187] 8821da7114b5/ERROR/stderr: AttributeError\r\nlocust-master_1    | [2020-07-10 14:49:00,187] 8821da7114b5/ERROR/stderr: :\r\nlocust-master_1    | [2020-07-10 14:49:00,187] 8821da7114b5/ERROR/stderr: module 'locust.events' has no attribute 'test_start'\r\nlocust-master_1    | [2020-07-10 14:49:00,187] 8821da7114b5/ERROR/stderr: \r\nproject_locust-master_1 exited with code 0\r\n```\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\nRun the below script\r\n```\r\nfrom locust import events\r\n\r\n@events.test_start.add_listener\r\ndef on_test_start(**kwargs):\r\n    print(\"A new test is starting\")\r\n```\r\n### Environment\r\n\r\n- OS: Dockerized python 3.7\r\n- Python version: 3.7\r\n- Locust version: locustio==0.14.6\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):\r\n```\r\nfrom locust import events\r\n\r\n@events.test_start.add_listener\r\ndef on_test_start(**kwargs):\r\n    print(\"A new test is starting\")\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1478/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1478/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1474", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1474/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1474/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1474/events", "html_url": "https://github.com/locustio/locust/issues/1474", "id": 653372013, "node_id": "MDU6SXNzdWU2NTMzNzIwMTM=", "number": 1474, "title": "Ignores the host parameter", "user": {"login": "safwansamla", "id": 60756345, "node_id": "MDQ6VXNlcjYwNzU2MzQ1", "avatar_url": "https://avatars.githubusercontent.com/u/60756345?v=4", "gravatar_id": "", "url": "https://api.github.com/users/safwansamla", "html_url": "https://github.com/safwansamla", "followers_url": "https://api.github.com/users/safwansamla/followers", "following_url": "https://api.github.com/users/safwansamla/following{/other_user}", "gists_url": "https://api.github.com/users/safwansamla/gists{/gist_id}", "starred_url": "https://api.github.com/users/safwansamla/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/safwansamla/subscriptions", "organizations_url": "https://api.github.com/users/safwansamla/orgs", "repos_url": "https://api.github.com/users/safwansamla/repos", "events_url": "https://api.github.com/users/safwansamla/events{/privacy}", "received_events_url": "https://api.github.com/users/safwansamla/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-08T15:03:17Z", "updated_at": "2020-07-10T18:57:24Z", "closed_at": "2020-07-10T18:57:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "Locust tries to start the web interface on an invalid address and it ignores the host parameter.\r\n\r\nI tried the following command\r\n\r\nlocust --host http://127.0.0.1:8089\r\n\r\nAnd I get the following error:\r\n\r\n<hostname/INFO/locust.main: Starting web interface at http://:8089\r\n....\r\nTypeError: code() takes at least 14 arguments (13 given)", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1474/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1474/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1472", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1472/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1472/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1472/events", "html_url": "https://github.com/locustio/locust/issues/1472", "id": 652698519, "node_id": "MDU6SXNzdWU2NTI2OTg1MTk=", "number": 1472, "title": "Unhandled exception:  ConnectionResetError, Connection reset by peer (FastHttpUser)", "user": {"login": "bendizen", "id": 3885334, "node_id": "MDQ6VXNlcjM4ODUzMzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3885334?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bendizen", "html_url": "https://github.com/bendizen", "followers_url": "https://api.github.com/users/bendizen/followers", "following_url": "https://api.github.com/users/bendizen/following{/other_user}", "gists_url": "https://api.github.com/users/bendizen/gists{/gist_id}", "starred_url": "https://api.github.com/users/bendizen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bendizen/subscriptions", "organizations_url": "https://api.github.com/users/bendizen/orgs", "repos_url": "https://api.github.com/users/bendizen/repos", "events_url": "https://api.github.com/users/bendizen/events{/privacy}", "received_events_url": "https://api.github.com/users/bendizen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-07-07T22:28:03Z", "updated_at": "2020-08-17T22:08:04Z", "closed_at": "2020-07-08T19:46:17Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nI running a test pulling large files (some > 250mb) using the fast client, when connection gets reset (\"ConnectionResetError: [Errno 104] Connection reset by peer\") on some files it throws an unhandled exception and does not log a failure.\r\n\r\n**Exception**\r\n```\r\nAttributeError: _cached_content\r\nDuring handling of the above exception, another exception occurred:\r\nTraceback (most recent call last):\r\n  File \"/home/mkarlovich/.pyenv/versions/3.8.2/lib/python3.8/site-packages/locust/user/task.py\", line 284, in run\r\n    self.execute_next_task()\r\n  File \"/home/mkarlovich/.pyenv/versions/3.8.2/lib/python3.8/site-packages/locust/user/task.py\", line 309, in execute_next_task\r\n    self.execute_task(self._task_queue.pop(0))\r\n  File \"/home/mkarlovich/.pyenv/versions/3.8.2/lib/python3.8/site-packages/locust/user/task.py\", line 416, in execute_task\r\n    task(self.user)\r\n  File \"/home/mkarlovich/source/locust-plugins/examples/fast_csvreader_cip.py\", line 16, in index\r\n    self.client.get(url, headers=headers)\r\n  File \"/home/mkarlovich/.pyenv/versions/3.8.2/lib/python3.8/site-packages/locust/contrib/fasthttp.py\", line 283, in get\r\n    return self.request(\"GET\", path, **kwargs)\r\n  File \"/home/mkarlovich/.pyenv/versions/3.8.2/lib/python3.8/site-packages/locust/contrib/fasthttp.py\", line 238, in request\r\n    request_meta[\"content_size\"] = len(response.content or \"\")\r\n  File \"/home/mkarlovich/.pyenv/versions/3.8.2/lib/python3.8/site-packages/geventhttpclient/useragent.py\", line 186, in content\r\n    self._cached_content = self._content()\r\n  File \"/home/mkarlovich/.pyenv/versions/3.8.2/lib/python3.8/site-packages/locust/contrib/fasthttp.py\", line 351, in _content\r\n    return super(FastResponse, self)._content()\r\n  File \"/home/mkarlovich/.pyenv/versions/3.8.2/lib/python3.8/site-packages/geventhttpclient/useragent.py\", line 201, in _content\r\n    ret = self._response.read()\r\n  File \"/home/mkarlovich/.pyenv/versions/3.8.2/lib/python3.8/site-packages/geventhttpclient/response.py\", line 259, in read\r\n    data = self._sock.recv(length or self.block_size)\r\n  File \"/home/mkarlovich/.pyenv/versions/3.8.2/lib/python3.8/site-packages/gevent/_socket3.py\", line 450, in recv\r\n    return self._sock.recv(*args)\r\nConnectionResetError: [Errno 104] Connection reset by peer\r\n```\r\n\r\n### Expected behavior\r\nIt should handle this exception and report it as a failure.\r\n\r\n### Actual behavior\r\nWorkers throw exception but no failure is recorded\r\n\r\n### Steps to reproduce\r\nI can't reproduce it except in my test environment but I have a fix that seems to work:  Add ConnectionResetError to FAILURE_EXCEPTIONS in fasthttp.py.\r\n\r\n```\r\n# List of exceptions that can be raised by geventhttpclient when sending an HTTP request, \r\n# and that should result in a Locust failure\r\nFAILURE_EXCEPTIONS = (ConnectionError, ConnectionRefusedError, ConnectionResetError, socket.error, \\\r\n                      SSLError, Timeout, HTTPConnectionClosed)\r\n```\r\n### Environment\r\n\r\nOS: Ubuntu 16.04 master and workers\r\nPython version: 3.8.2\r\nLocust version: 1.0.3\r\nLocust command line that you ran:\r\nlocust -f fast_csvreader_ex.py --master --expect-workers 10 --headless -u 100 -r 1 -t 60m --csv=test100u60m10w\r\nlocust -f fast_csvreader_ex.py --worker --master-host=10.66.11.21 & # run 5 per worker machine\r\n\r\nLocust file contents (anonymized if necessary):\r\n```\r\nfrom locust_plugins.csvreader import CSVReader\r\nfrom locust import task\r\nfrom locust.contrib.fasthttp import FastHttpUser\r\nimport traceback, logging, sys\r\nimport locust.stats\r\nlocust.stats.CSV_STATS_INTERVAL_SEC = 5\r\n\r\nid_reader = CSVReader(\"ids.csv\")\r\n\r\nclass MyUser(FastHttpUser):\r\n    @task\r\n    def index(self):\r\n        headers = { \"Authorization\": \"apikey\", \"Accept\": \"application/json\" }\r\n        feed_id, file_id = next(id_reader)\r\n        url = f'/feeds/{feed_id}/files/{file_id}'\r\n        self.client.get(url, headers=headers)\r\n        \r\n    host = 'https://my-test-sever.com'\r\n    connection_timeout = 6000.0\r\n    network_timeout = 6000.0\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1472/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1472/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1463", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1463/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1463/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1463/events", "html_url": "https://github.com/locustio/locust/issues/1463", "id": 650714118, "node_id": "MDU6SXNzdWU2NTA3MTQxMTg=", "number": 1463, "title": "test_start event blocks the UI", "user": {"login": "denniseffing", "id": 5879568, "node_id": "MDQ6VXNlcjU4Nzk1Njg=", "avatar_url": "https://avatars.githubusercontent.com/u/5879568?v=4", "gravatar_id": "", "url": "https://api.github.com/users/denniseffing", "html_url": "https://github.com/denniseffing", "followers_url": "https://api.github.com/users/denniseffing/followers", "following_url": "https://api.github.com/users/denniseffing/following{/other_user}", "gists_url": "https://api.github.com/users/denniseffing/gists{/gist_id}", "starred_url": "https://api.github.com/users/denniseffing/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/denniseffing/subscriptions", "organizations_url": "https://api.github.com/users/denniseffing/orgs", "repos_url": "https://api.github.com/users/denniseffing/repos", "events_url": "https://api.github.com/users/denniseffing/events{/privacy}", "received_events_url": "https://api.github.com/users/denniseffing/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901882, "node_id": "MDU6TGFiZWwxNjM1OTAxODgy", "url": "https://api.github.com/repos/locustio/locust/labels/wontfix", "name": "wontfix", "color": "ddcccc", "default": true, "description": ""}, {"id": 2115072627, "node_id": "MDU6TGFiZWwyMTE1MDcyNjI3", "url": "https://api.github.com/repos/locustio/locust/labels/non-critical", "name": "non-critical", "color": "c4e4c9", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-07-03T17:53:51Z", "updated_at": "2020-09-28T19:19:47Z", "closed_at": "2020-09-28T19:19:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nWhen a user starts a load test and the `test_start` event is fired, the UI is basically doing nothing until the `test_start` event hooks have finished executing.\r\n\r\n### Expected behavior\r\nUI should open up the statistics dashboard and change the status from `READY` to a new state called `INITIALIZING`.\r\n\r\n### Actual behavior\r\nUI hangs on \"Start new Locust run screen\" until `test_start` execution has finished.\r\n\r\n### Steps to reproduce\r\n1. Add a `test_start` listener that pauses the thread for 5 seconds. \r\n\r\n```python\r\n@events.test_start.add_listener\r\ndef on_test_start(**kwargs):\r\n    time.sleep(5)\r\n```\r\n\r\n2. Start a test\r\n\r\n### Environment\r\n\r\n- OS: macOS 10.15.3\r\n- Python version: 3.7.7\r\n- Locust version: 1.0.3\r\n- Locust command line that you ran: `locust`\r\n- Locust file contents (anonymized if necessary):\r\n\r\n```python\r\nfrom locust import events, HttpUser, task, between\r\nimport time\r\n\r\n\r\n@events.test_start.add_listener\r\ndef on_test_start(**kwargs):\r\n    time.sleep(5)\r\n\r\n\r\nclass TestUser(HttpUser):\r\n    wait_time = between(5, 9)\r\n\r\n    @task\r\n    def index_page(self):\r\n        self.client.get(url=self.host)\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1463/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1463/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1461", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1461/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1461/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1461/events", "html_url": "https://github.com/locustio/locust/issues/1461", "id": 650323240, "node_id": "MDU6SXNzdWU2NTAzMjMyNDA=", "number": 1461, "title": "--run-time flag is not respected if there is an exception in a test_stop listener", "user": {"login": "camilojimenez", "id": 7208620, "node_id": "MDQ6VXNlcjcyMDg2MjA=", "avatar_url": "https://avatars.githubusercontent.com/u/7208620?v=4", "gravatar_id": "", "url": "https://api.github.com/users/camilojimenez", "html_url": "https://github.com/camilojimenez", "followers_url": "https://api.github.com/users/camilojimenez/followers", "following_url": "https://api.github.com/users/camilojimenez/following{/other_user}", "gists_url": "https://api.github.com/users/camilojimenez/gists{/gist_id}", "starred_url": "https://api.github.com/users/camilojimenez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/camilojimenez/subscriptions", "organizations_url": "https://api.github.com/users/camilojimenez/orgs", "repos_url": "https://api.github.com/users/camilojimenez/repos", "events_url": "https://api.github.com/users/camilojimenez/events{/privacy}", "received_events_url": "https://api.github.com/users/camilojimenez/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-07-03T03:48:10Z", "updated_at": "2020-07-07T19:44:27Z", "closed_at": "2020-07-07T19:44:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nOn a headless session, if there is an exception thrown from a `test_stop` listener, the run-time flag is not respected and the \r\nsession keeps running indefinitely.\r\n\r\n### Expected behavior\r\nThe session should stop even if the listeners throw exceptions.\r\n\r\n### Actual behavior\r\nThe traceback is printed, and the session keeps running.\r\n\r\n### Steps to reproduce\r\nTake, for example, the following `locustfile.py`:\r\n```\r\nfrom locust import HttpUser, events, task\r\nimport time\r\n\r\n@events.test_stop.add_listener\r\ndef on_test_stop(**kwargs):\r\n  1/0\r\n\r\nclass NOOP(HttpUser):\r\n  @task\r\n  def index_page(self):\r\n    time.sleep(10)\r\n```\r\n\r\nIf locust is run with the following command line:\r\n\r\n```locust -t1 -r1 -u10 --headless  --host http://www.google.com```\r\n\r\nyou see the exception being raised and the session continues:\r\n```\r\n[2020-07-03 03:37:18,086] instance-1/INFO/locust.main: Time limit reached. Stopping Locust.\r\nTraceback (most recent call last):\r\n  File \"src/gevent/greenlet.py\", line 854, in gevent._gevent_cgreenlet.Greenlet.run\r\n  File \"/home/camilojimenez/locust/venv/lib/python3.7/site-packages/locust/main.py\", line 231, in timelimit_stop\r\n    runner.quit()\r\n  File \"/home/camilojimenez/locust/venv/lib/python3.7/site-packages/locust/runners.py\", line 294, in quit\r\n    self.stop()\r\n  File \"/home/camilojimenez/locust/venv/lib/python3.7/site-packages/locust/runners.py\", line 340, in stop\r\n    self.environment.events.test_stop.fire(environment=self.environment)\r\n  File \"/home/camilojimenez/locust/venv/lib/python3.7/site-packages/locust/event.py\", line 33, in fire\r\n    handler(**kwargs)\r\n  File \"/home/camilojimenez/locust/locustfile.py\", line 6, in on_test_stop\r\n    1/0\r\nZeroDivisionError: division by zero\r\n2020-07-03T03:37:18Z <Greenlet at 0x7fcad134b9d8: timelimit_stop> failed with ZeroDivisionError\r\n\r\n[2020-07-03 03:37:18,091] instance-1/CRITICAL/locust.main: Unhandled exception in greenlet: <Greenlet at 0x7fcad134b9d8: timelimit_stop>\r\nTraceback (most recent call last):\r\n  File \"src/gevent/greenlet.py\", line 854, in gevent._gevent_cgreenlet.Greenlet.run\r\n  File \"/home/camilojimenez/locust/venv/lib/python3.7/site-packages/locust/main.py\", line 231, in timelimit_stop\r\n    runner.quit()\r\n  File \"/home/camilojimenez/locust/venv/lib/python3.7/site-packages/locust/runners.py\", line 294, in quit\r\n    self.stop()\r\n  File \"/home/camilojimenez/locust/venv/lib/python3.7/site-packages/locust/runners.py\", line 340, in stop\r\n    self.environment.events.test_stop.fire(environment=self.environment)\r\n  File \"/home/camilojimenez/locust/venv/lib/python3.7/site-packages/locust/event.py\", line 33, in fire\r\n    handler(**kwargs)\r\n  File \"/home/camilojimenez/locust/locustfile.py\", line 6, in on_test_stop\r\n    1/0\r\nZeroDivisionError: division by zero\r\n Name                                                          # reqs      # fails     Avg     Min     Max  |  Median   req/s failures/s\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                         0     0(0.00%)       0       0       0  |       0    0.00    0.00\r\n```\r\n\r\n### Environment\r\n\r\n- OS: MacOS\r\n- Python version: 3.7.3 \r\n- Locust version: 1.1\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1461/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1461/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1459", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1459/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1459/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1459/events", "html_url": "https://github.com/locustio/locust/issues/1459", "id": 649836585, "node_id": "MDU6SXNzdWU2NDk4MzY1ODU=", "number": 1459, "title": "environment object properties does not change.", "user": {"login": "AdimUser", "id": 15202718, "node_id": "MDQ6VXNlcjE1MjAyNzE4", "avatar_url": "https://avatars.githubusercontent.com/u/15202718?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AdimUser", "html_url": "https://github.com/AdimUser", "followers_url": "https://api.github.com/users/AdimUser/followers", "following_url": "https://api.github.com/users/AdimUser/following{/other_user}", "gists_url": "https://api.github.com/users/AdimUser/gists{/gist_id}", "starred_url": "https://api.github.com/users/AdimUser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AdimUser/subscriptions", "organizations_url": "https://api.github.com/users/AdimUser/orgs", "repos_url": "https://api.github.com/users/AdimUser/repos", "events_url": "https://api.github.com/users/AdimUser/events{/privacy}", "received_events_url": "https://api.github.com/users/AdimUser/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-02T10:54:52Z", "updated_at": "2020-07-02T12:52:58Z", "closed_at": "2020-07-02T12:52:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi Team, \r\n\r\nI am trying to run a code during the load testing is happening(eg push aggregated data to database).\r\n\r\nI am using locust init event handler --> https://docs.locust.io/en/stable/api.html#locust.event.Events.init\r\n\r\nHere is my code:\r\n\r\n![image](https://user-images.githubusercontent.com/15202718/86350513-c50be580-bc9d-11ea-95b6-5df2836de0c3.png)\r\n\r\n\r\nBut the values is always **_None_**, It does not change to an integer when load-testing is finish, please help on this  ", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1459/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1459/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1458", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1458/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1458/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1458/events", "html_url": "https://github.com/locustio/locust/issues/1458", "id": 648741973, "node_id": "MDU6SXNzdWU2NDg3NDE5NzM=", "number": 1458, "title": "Distributed command line cannot run ", "user": {"login": "MarcSteven", "id": 13824297, "node_id": "MDQ6VXNlcjEzODI0Mjk3", "avatar_url": "https://avatars.githubusercontent.com/u/13824297?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarcSteven", "html_url": "https://github.com/MarcSteven", "followers_url": "https://api.github.com/users/MarcSteven/followers", "following_url": "https://api.github.com/users/MarcSteven/following{/other_user}", "gists_url": "https://api.github.com/users/MarcSteven/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarcSteven/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarcSteven/subscriptions", "organizations_url": "https://api.github.com/users/MarcSteven/orgs", "repos_url": "https://api.github.com/users/MarcSteven/repos", "events_url": "https://api.github.com/users/MarcSteven/events{/privacy}", "received_events_url": "https://api.github.com/users/MarcSteven/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-07-01T07:26:04Z", "updated_at": "2020-07-07T19:41:18Z", "closed_at": "2020-07-07T19:41:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nI use the command to run but cannot start a swarming. Please like the picture\r\n` locust -f load.py --master\r\n`[2020-07-01 16:03:38,423] Marcs-MacBook-Pro.local/ERROR/stderr: Traceback (most recent call last):\r\n[2020-07-01 16:03:38,423] Marcs-MacBook-Pro.local/ERROR/stderr: File \"/Users/user/PycharmProjects/APILoadTest/venv/bin/locust\", line 10, in <module>\r\n[2020-07-01 16:03:38,423] Marcs-MacBook-Pro.local/ERROR/stderr: \r\n[2020-07-01 16:03:38,423] Marcs-MacBook-Pro.local/ERROR/stderr: sys.exit(main())\r\n[2020-07-01 16:03:38,423] Marcs-MacBook-Pro.local/ERROR/stderr: \r\n[2020-07-01 16:03:38,423] Marcs-MacBook-Pro.local/ERROR/stderr: File \"/Users/user/PycharmProjects/APILoadTest/venv/lib/python3.8/site-packages/locust/main.py\", line 495, in main\r\n[2020-07-01 16:03:38,424] Marcs-MacBook-Pro.local/ERROR/stderr: \r\n[2020-07-01 16:03:38,424] Marcs-MacBook-Pro.local/ERROR/stderr: runners.locust_runner = MasterLocustRunner(locust_classes, options)\r\n[2020-07-01 16:03:38,424] Marcs-MacBook-Pro.local/ERROR/stderr: \r\n[2020-07-01 16:03:38,424] Marcs-MacBook-Pro.local/ERROR/stderr: File \"/Users/user/PycharmProjects/APILoadTest/venv/lib/python3.8/site-packages/locust/runners.py\", line 346, in __init__\r\n[2020-07-01 16:03:38,425] Marcs-MacBook-Pro.local/ERROR/stderr: \r\n[2020-07-01 16:03:38,425] Marcs-MacBook-Pro.local/ERROR/stderr: self.server = rpc.Server(self.master_bind_host, self.master_bind_port)\r\n[2020-07-01 16:03:38,425] Marcs-MacBook-Pro.local/ERROR/stderr: \r\n[2020-07-01 16:03:38,425] Marcs-MacBook-Pro.local/ERROR/stderr: File \"/Users/user/PycharmProjects/APILoadTest/venv/lib/python3.8/site-packages/locust/rpc/zmqrpc.py\", line 41, in __init__\r\n[2020-07-01 16:03:38,426] Marcs-MacBook-Pro.local/ERROR/stderr: \r\n[2020-07-01 16:03:38,426] Marcs-MacBook-Pro.local/ERROR/stderr: self.socket.bind(\"tcp://%s:%i\" % (host, port))\r\n[2020-07-01 16:03:38,426] Marcs-MacBook-Pro.local/ERROR/stderr: \r\n[2020-07-01 16:03:38,426] Marcs-MacBook-Pro.local/ERROR/stderr: File \"zmq/backend/cython/socket.pyx\", line 550, in zmq.backend.cython.socket.Socket.bind\r\n[2020-07-01 16:03:38,426] Marcs-MacBook-Pro.local/ERROR/stderr: File \"zmq/backend/cython/checkrc.pxd\", line 26, in zmq.backend.cython.checkrc._check_rc\r\n[2020-07-01 16:03:38,426] Marcs-MacBook-Pro.local/ERROR/stderr: zmq.error\r\n[2020-07-01 16:03:38,426] Marcs-MacBook-Pro.local/ERROR/stderr: .\r\n[2020-07-01 16:03:38,426] Marcs-MacBook-Pro.local/ERROR/stderr: ZMQError\r\n[2020-07-01 16:03:38,426] Marcs-MacBook-Pro.local/ERROR/stderr: :\r\n[2020-07-01 16:03:38,426] Marcs-MacBook-Pro.local/ERROR/stderr: Address already in use\r\n[2020-07-01 16:03:38,426] Marcs-MacBook-Pro.local/ERROR/stderr: \r\n`\r\n\r\n\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nHope it can run well \r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nCannot start swarming even though click the button of starting a swarming, it cannot go \r\n<img width=\"1648\" alt=\"\u622a\u5c4f2020-07-01 \u4e0b\u53483 22 40\" src=\"https://user-images.githubusercontent.com/13824297/86215525-420c6180-bbaf-11ea-9ef2-c2ab7baf3d2a.png\">\r\n\r\n\r\n\r\n\r\n\r\n\r\n### Steps to reproduce\r\n\r\n### Environment\r\n\r\n- OS: Mac OS\r\n- Python version:3.8\r\n- Locust version:2.4\r\n- Locust command line that you ran: locust -f YouthBombAPI.py --slave\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1458/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1458/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1457", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1457/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1457/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1457/events", "html_url": "https://github.com/locustio/locust/issues/1457", "id": 647713893, "node_id": "MDU6SXNzdWU2NDc3MTM4OTM=", "number": 1457, "title": "Unhandled exception: stream ended at an unexpected time", "user": {"login": "bendizen", "id": 3885334, "node_id": "MDQ6VXNlcjM4ODUzMzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3885334?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bendizen", "html_url": "https://github.com/bendizen", "followers_url": "https://api.github.com/users/bendizen/followers", "following_url": "https://api.github.com/users/bendizen/following{/other_user}", "gists_url": "https://api.github.com/users/bendizen/gists{/gist_id}", "starred_url": "https://api.github.com/users/bendizen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bendizen/subscriptions", "organizations_url": "https://api.github.com/users/bendizen/orgs", "repos_url": "https://api.github.com/users/bendizen/repos", "events_url": "https://api.github.com/users/bendizen/events{/privacy}", "received_events_url": "https://api.github.com/users/bendizen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 18, "created_at": "2020-06-29T22:31:57Z", "updated_at": "2020-07-06T15:02:54Z", "closed_at": "2020-07-04T08:40:23Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nI running a test pulling large files (some > 250mb) using the fast client, when connection gets dropped (\"stream ended at an unexpected time\") on some files it throws an unhandled exception and does not log a failure. \r\n\r\n**Exception:**\r\nTraceback (most recent call last):\r\n  File \"/home/mkarlovich/.pyenv/versions/3.8.2/lib/python3.8/site-packages/geventhttpclient/useragent.py\", line 184, in content\r\n    return self._cached_content\r\nAttributeError: _cached_content\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/mkarlovich/.pyenv/versions/3.8.2/lib/python3.8/site-packages/locust/user/task.py\", line 284, in run\r\n    self.execute_next_task()\r\n  File \"/home/mkarlovich/.pyenv/versions/3.8.2/lib/python3.8/site-packages/locust/user/task.py\", line 309, in execute_next_task\r\n    self.execute_task(self._task_queue.pop(0))\r\n  File \"/home/mkarlovich/.pyenv/versions/3.8.2/lib/python3.8/site-packages/locust/user/task.py\", line 416, in execute_task\r\n    task(self.user)\r\n  File \"/home/mkarlovich/source/locust-plugins/examples/fast_csvreader_ex.py\", line 17, in index\r\n    self.client.get(url, headers=headers)\r\n  File \"/home/mkarlovich/.pyenv/versions/3.8.2/lib/python3.8/site-packages/locust/contrib/fasthttp.py\", line 272, in get\r\n    return self.request(\"GET\", path, **kwargs)\r\n  File \"/home/mkarlovich/.pyenv/versions/3.8.2/lib/python3.8/site-packages/locust/contrib/fasthttp.py\", line 237, in request\r\n    request_meta[\"content_size\"] = len(response.content or \"\")\r\n  File \"/home/mkarlovich/.pyenv/versions/3.8.2/lib/python3.8/site-packages/geventhttpclient/useragent.py\", line 186, in content\r\n    self._cached_content = self._content()\r\n  File \"/home/mkarlovich/.pyenv/versions/3.8.2/lib/python3.8/site-packages/locust/contrib/fasthttp.py\", line 340, in _content\r\n    return super(FastResponse, self)._content()\r\n  File \"/home/mkarlovich/.pyenv/versions/3.8.2/lib/python3.8/site-packages/geventhttpclient/useragent.py\", line 201, in _content\r\n    ret = self._response.read()\r\n  File \"/home/mkarlovich/.pyenv/versions/3.8.2/lib/python3.8/site-packages/geventhttpclient/response.py\", line 260, in read\r\n    self.feed(data)\r\n_parser.HTTPParseError: ('stream ended at an unexpected time', 11)\r\n\r\n### Expected behavior\r\nIt should handle this exception and report it as a failure.\r\n\r\n### Actual behavior\r\nWorkers throw exception but no failure is recorded\r\n\r\n### Steps to reproduce\r\nI can't reproduce it except under load, code is using script below which constructs file download urls from csv file.\r\n\r\n### Environment\r\n- OS: Ubuntu 16.04 master and workers\r\n- Python version: 3.8.2\r\n- Locust version: 1.0.3\r\n- Locust command line that you ran: \r\n\r\nlocust -f fast_csvreader_ex.py --master --expect-workers 10 --headless -u 100 -r 1 -t 60m --csv=test100u60m10w \r\nlocust -f fast_csvreader_ex.py --worker --master-host=10.66.11.21 & # run 5 per worker machine\r\n- Locust file contents (anonymized if necessary):\r\n```\r\nfrom locust_plugins.csvreader import CSVReader\r\nfrom locust import task\r\nfrom locust.contrib.fasthttp import FastHttpUser\r\nimport traceback, logging, sys\r\nimport locust.stats\r\nlocust.stats.CSV_STATS_INTERVAL_SEC = 5\r\n\r\nid_reader = CSVReader(\"ids.csv\")\r\n\r\nclass MyUser(FastHttpUser):\r\n    @task\r\n    def index(self):\r\n        headers = { \"Authorization\": \"apikey\", \"Accept\": \"application/json\" }\r\n        feed_id, file_id = next(id_reader)\r\n        url = f'/feeds/{feed_id}/files/{file_id}'\r\n        self.client.get(url, headers=headers)\r\n        \r\n    host = 'https://my-test-sever.com'\r\n    connection_timeout = 6000.0\r\n    network_timeout = 6000.0", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1457/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1457/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1455", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1455/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1455/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1455/events", "html_url": "https://github.com/locustio/locust/issues/1455", "id": 646818509, "node_id": "MDU6SXNzdWU2NDY4MTg1MDk=", "number": 1455, "title": "master/slave terminology is inappropriate and unnecessary", "user": {"login": "reglash", "id": 60038454, "node_id": "MDQ6VXNlcjYwMDM4NDU0", "avatar_url": "https://avatars.githubusercontent.com/u/60038454?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reglash", "html_url": "https://github.com/reglash", "followers_url": "https://api.github.com/users/reglash/followers", "following_url": "https://api.github.com/users/reglash/following{/other_user}", "gists_url": "https://api.github.com/users/reglash/gists{/gist_id}", "starred_url": "https://api.github.com/users/reglash/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reglash/subscriptions", "organizations_url": "https://api.github.com/users/reglash/orgs", "repos_url": "https://api.github.com/users/reglash/repos", "events_url": "https://api.github.com/users/reglash/events{/privacy}", "received_events_url": "https://api.github.com/users/reglash/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-06-28T02:31:27Z", "updated_at": "2020-06-28T06:37:09Z", "closed_at": "2020-06-28T06:35:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- The terminology of master/slave is inappropriate. Other groups have made the effort to replace that with less controversial terms (eg https://tools.ietf.org/id/draft-knodel-terminology-00.html and http://wg20.criticalcodestudies.com/index.php?p=/discussion/59/master-slave-replication-in-mysql).\r\n\r\nIt is not a bug in the technical sense but surely in the social sense.\r\n\r\nIf folks want to diver deeper into this question: https://www.researchgate.net/publication/236752849_Broken_Metaphor_The_Master-Slave_Analogy_in_Technical_Literature\r\n-->\r\n\r\n### Expected behavior\r\n<!-- Inoffensive terms like  primary/secondary, mother/daughter, captain/sailor, boss/worker, wizard/hobbit, and so on -->\r\n\r\n### Actual behavior\r\n<!--  A good example of just how bad that looks can be found here:\r\nhttps://github.com/locustio/locust/issues/724-->\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1455/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1455/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1451", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1451/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1451/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1451/events", "html_url": "https://github.com/locustio/locust/issues/1451", "id": 644908096, "node_id": "MDU6SXNzdWU2NDQ5MDgwOTY=", "number": 1451, "title": "Can't extend docker image with pip3 install <any-package>", "user": {"login": "lhenry7", "id": 23659032, "node_id": "MDQ6VXNlcjIzNjU5MDMy", "avatar_url": "https://avatars.githubusercontent.com/u/23659032?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lhenry7", "html_url": "https://github.com/lhenry7", "followers_url": "https://api.github.com/users/lhenry7/followers", "following_url": "https://api.github.com/users/lhenry7/following{/other_user}", "gists_url": "https://api.github.com/users/lhenry7/gists{/gist_id}", "starred_url": "https://api.github.com/users/lhenry7/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lhenry7/subscriptions", "organizations_url": "https://api.github.com/users/lhenry7/orgs", "repos_url": "https://api.github.com/users/lhenry7/repos", "events_url": "https://api.github.com/users/lhenry7/events{/privacy}", "received_events_url": "https://api.github.com/users/lhenry7/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-06-24T20:07:03Z", "updated_at": "2020-06-25T16:45:25Z", "closed_at": "2020-06-25T16:45:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "See https://github.com/pypa/pypi-support/issues/467\r\n\r\n<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\npip3 install does not work, see linked issue and gist\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version:\r\n- Locust version:\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1451/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1451/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1447", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1447/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1447/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1447/events", "html_url": "https://github.com/locustio/locust/issues/1447", "id": 643749354, "node_id": "MDU6SXNzdWU2NDM3NDkzNTQ=", "number": 1447, "title": " Unhandled `UnicodeDecodeError` exception if response with status 400 and request contains binary payload (for FastHttpUser)", "user": {"login": "magupov", "id": 4011794, "node_id": "MDQ6VXNlcjQwMTE3OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4011794?v=4", "gravatar_id": "", "url": "https://api.github.com/users/magupov", "html_url": "https://github.com/magupov", "followers_url": "https://api.github.com/users/magupov/followers", "following_url": "https://api.github.com/users/magupov/following{/other_user}", "gists_url": "https://api.github.com/users/magupov/gists{/gist_id}", "starred_url": "https://api.github.com/users/magupov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/magupov/subscriptions", "organizations_url": "https://api.github.com/users/magupov/orgs", "repos_url": "https://api.github.com/users/magupov/repos", "events_url": "https://api.github.com/users/magupov/events{/privacy}", "received_events_url": "https://api.github.com/users/magupov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2020-06-23T11:08:18Z", "updated_at": "2020-07-02T13:26:13Z", "closed_at": "2020-07-02T13:26:13Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Bug\r\nI get an unhandled `UnicodeDecodeError` exception if the response has an invalid status code and the request contains binary payload (for FastHttpUser)\r\n\r\n### Expected behavior\r\n`UnicodeDecodeError` shouldn't be raised in case of non-utf-8 characters in the payload  \r\n\r\n### Actual behavior\r\nThat is a stack trace: \r\n```\r\n[2020-06-23 09:14:15,612] 7ab43366d074/ERROR/locust.user.task: 'utf-8' codec can't decode byte 0x95 in position 41: invalid start byte\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.8/site-packages/geventhttpclient/useragent.py\", line 360, in urlopen\r\n    self._verify_status(resp.status_code, url=req.url)\r\n  File \"/usr/local/lib/python3.8/site-packages/geventhttpclient/useragent.py\", line 302, in _verify_status\r\n    raise BadStatusCode(url, code=status_code)\r\ngeventhttpclient.useragent.BadStatusCode: URL http://url/endpoint: code=400\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.8/site-packages/locust/user/task.py\", line 284, in run\r\n    self.execute_next_task()\r\n  File \"/usr/local/lib/python3.8/site-packages/locust/user/task.py\", line 309, in execute_next_task\r\n    self.execute_task(self._task_queue.pop(0))\r\n  File \"/usr/local/lib/python3.8/site-packages/locust/user/task.py\", line 416, in execute_task\r\n    task(self.user)\r\n  File \"/app/stress_tests/locustfile.py\", line 95, in test_endpoint\r\n    result = self.client.make_request()\r\n  File \"/app/tests/base_client.py\", line 77, in make_request\r\n    return self.client.request(**kwargs)\r\n  File \"/usr/local/lib/python3.8/site-packages/locust/contrib/fasthttp.py\", line 227, in request\r\n    response = self._send_request_safe_mode(method, url, payload=data, headers=headers, **kwargs)\r\n  File \"/usr/local/lib/python3.8/site-packages/locust/contrib/fasthttp.py\", line 159, in _send_request_safe_mode\r\n    return self.client.urlopen(url, method=method, **kwargs)\r\n  File \"/usr/local/lib/python3.8/site-packages/geventhttpclient/useragent.py\", line 366, in urlopen\r\n    e.http_log = self._conversation_str(req.url, resp, payload=req.payload)\r\n  File \"/usr/local/lib/python3.8/site-packages/geventhttpclient/useragent.py\", line 424, in _conversation_str\r\n    ret += payload.decode('utf-8') + '\\n\\n'\r\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 41: invalid start byte\r\n```\r\n\r\n### Steps to reproduce\r\nBasically that's a known issue: an attempt to decode the fully binary string fails with `UnicodeDecodeError`. It might be reproduced even without locust, just try to decode any binary string:\r\n```\r\nIn [1]: import secrets                                                                                                                                                                                        \r\nIn [2]: binary_str = secrets.token_bytes(32)                                                                                                                                                                  \r\nIn [3]: binary_str.decode('utf-8')                                                                                                                                                                            \r\n---------------------------------------------------------------------------\r\nUnicodeDecodeError                        Traceback (most recent call last)\r\n<ipython-input-3-11a2204405d4> in <module>\r\n----> 1 binary_str.decode('utf-8')\r\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0xb7 in position 2: invalid start byte\r\n```\r\n\r\n### Environment\r\n\r\n- OS: Ubuntu 20.04\r\n- Python version: 3.8\r\n- Locust version: 1.0.2\r\n- Locust command line that you ran: `locust`\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1447/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1447/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1446", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1446/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1446/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1446/events", "html_url": "https://github.com/locustio/locust/issues/1446", "id": 643320141, "node_id": "MDU6SXNzdWU2NDMzMjAxNDE=", "number": 1446, "title": "Different readings on chart and in csv", "user": {"login": "pavelsaman", "id": 24702416, "node_id": "MDQ6VXNlcjI0NzAyNDE2", "avatar_url": "https://avatars.githubusercontent.com/u/24702416?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavelsaman", "html_url": "https://github.com/pavelsaman", "followers_url": "https://api.github.com/users/pavelsaman/followers", "following_url": "https://api.github.com/users/pavelsaman/following{/other_user}", "gists_url": "https://api.github.com/users/pavelsaman/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavelsaman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavelsaman/subscriptions", "organizations_url": "https://api.github.com/users/pavelsaman/orgs", "repos_url": "https://api.github.com/users/pavelsaman/repos", "events_url": "https://api.github.com/users/pavelsaman/events{/privacy}", "received_events_url": "https://api.github.com/users/pavelsaman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-06-22T19:49:51Z", "updated_at": "2020-08-30T06:40:19Z", "closed_at": "2020-08-30T06:40:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "The last response time chart reading says median=480 and 95 % percentile=2400:\r\n\r\n![image](https://user-images.githubusercontent.com/24702416/85329761-68f1d600-b4d3-11ea-9af3-2e6be2c049de.png)\r\n\r\nShouldn't they be aggregated values from all the previous measurements?\r\n\r\nCsv report states different values:\r\n\r\n![image](https://user-images.githubusercontent.com/24702416/85328506-20391d80-b4d1-11ea-8913-9e9e4ade218a.png)\r\n\r\nI'd expect these two to match.\r\n\r\nIt seems that the chart responds immediately when I press Stop button, but the same doesn't happen with *_stats.csv. When I have a look into *_stats_history.csv file, there're more values for later times as well, these are not included on the chart:\r\n\r\n![image](https://user-images.githubusercontent.com/24702416/85329002-00562980-b4d2-11ea-99a0-13c146dc901c.png)\r\n\r\nWhich makes the difference. Basically it means that the underlying data for the chart and *_stats.csv are different.\r\n\r\nMy locust version is 1.0.3", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1446/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1446/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1442", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1442/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1442/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1442/events", "html_url": "https://github.com/locustio/locust/issues/1442", "id": 642142303, "node_id": "MDU6SXNzdWU2NDIxNDIzMDM=", "number": 1442, "title": "Unable to stop load from web UI with 1.0.3", "user": {"login": "venkikonda", "id": 28502358, "node_id": "MDQ6VXNlcjI4NTAyMzU4", "avatar_url": "https://avatars.githubusercontent.com/u/28502358?v=4", "gravatar_id": "", "url": "https://api.github.com/users/venkikonda", "html_url": "https://github.com/venkikonda", "followers_url": "https://api.github.com/users/venkikonda/followers", "following_url": "https://api.github.com/users/venkikonda/following{/other_user}", "gists_url": "https://api.github.com/users/venkikonda/gists{/gist_id}", "starred_url": "https://api.github.com/users/venkikonda/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/venkikonda/subscriptions", "organizations_url": "https://api.github.com/users/venkikonda/orgs", "repos_url": "https://api.github.com/users/venkikonda/repos", "events_url": "https://api.github.com/users/venkikonda/events{/privacy}", "received_events_url": "https://api.github.com/users/venkikonda/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1003994742, "node_id": "MDU6TGFiZWwxMDAzOTk0NzQy", "url": "https://api.github.com/repos/locustio/locust/labels/waiting%20on%20contributor", "name": "waiting on contributor", "color": "5319e7", "default": false, "description": ""}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 22, "created_at": "2020-06-19T18:05:13Z", "updated_at": "2020-11-18T10:03:35Z", "closed_at": "2020-09-20T10:38:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi Team ,\r\n\r\ncould you please help on below issue..\r\n\r\nDescription of issue:\r\n\r\nSince upgrading to Locust 1.0.3 I often have difficulty stopping Locust from the web UI when running distributed. I click the Stop button, but the load doesn't actually stop. At best, it dips briefly but then resumes.\r\n\r\nExpected behavior:\r\nLoad stops almost immediately.\r\n\r\nActual behavior:\r\n\r\nIt seems slaves stop their load and then rejoin the pool and then have load immediately sent to them again.\r\n\r\nSteps to reproduce (for bug reports):\r\n\r\nRun Locust distributed with multiple slaves\r\nBegin a large load using the web UI\r\nWait several minutes after all users hatched\r\nAttempt to stop load using the web UI\r\n\r\n- OS: ubuntu 16.0\r\n- Python version: 3.8 \r\n- Locust version: 1.0.3\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):\r\n\r\nimport random\r\nfrom locust import HttpUser, task, SequentialTaskSet, between, tag\r\n\r\nclass IntranetTasks(SequentialTaskSet):\r\n\t@tag('login')\r\n\t@task\t\r\n\tdef on_start(self):\r\n\t\tself.client.post(\"login.action?login=true\", {\"username\":\"********\", \"password\":*****\"})\r\n\t\r\n\t@tag('NewGuy')\r\n\t@task\r\n\tdef testPage(self):\r\n\t\tself.client.get(\"display/00001/2019/07/01/Hello%2C+I%27m+the+New+Guy\")\r\n\t\r\n\t@tag('Display')\r\n\t@task\r\n\tdef testBlogPost(self):\r\n\t\tself.client.get(\"display/00008\")\r\n\r\n\t@tag('HomePage')\r\n\t@task\r\n\tdef testIndex(self):\r\n\t\tself.client.get(\"\")\r\n\t\t\r\n\t@tag('NewCFO')\r\n\t@task\r\n\tdef testCoronaPage(self):\r\n\t\tself.client.get(\"pages/viewpage.action?pageId=98895875\")\r\n\r\n\t@tag('logout')\r\n\t@task\r\n\tdef on_stop(self):\r\n\t\tself.client.post(\"logout.action?logout=true\", {\"username\":\"*******\", \"password\":\"****\"})\r\n\r\nclass WebUser(HttpUser):\r\n\twait_time = between(5, 9)\r\n\ttasks = {IntranetTasks:1}", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1442/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1442/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1440", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1440/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1440/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1440/events", "html_url": "https://github.com/locustio/locust/issues/1440", "id": 641283452, "node_id": "MDU6SXNzdWU2NDEyODM0NTI=", "number": 1440, "title": "Charts are twice as high as they need to", "user": {"login": "benallard", "id": 178188, "node_id": "MDQ6VXNlcjE3ODE4OA==", "avatar_url": "https://avatars.githubusercontent.com/u/178188?v=4", "gravatar_id": "", "url": "https://api.github.com/users/benallard", "html_url": "https://github.com/benallard", "followers_url": "https://api.github.com/users/benallard/followers", "following_url": "https://api.github.com/users/benallard/following{/other_user}", "gists_url": "https://api.github.com/users/benallard/gists{/gist_id}", "starred_url": "https://api.github.com/users/benallard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/benallard/subscriptions", "organizations_url": "https://api.github.com/users/benallard/orgs", "repos_url": "https://api.github.com/users/benallard/repos", "events_url": "https://api.github.com/users/benallard/events{/privacy}", "received_events_url": "https://api.github.com/users/benallard/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-06-18T15:03:18Z", "updated_at": "2020-06-22T07:03:32Z", "closed_at": "2020-06-22T07:03:32Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Describe the bug\r\nThe top half of the Charts is always empty. The automatic scaling seems to be a bit off.\r\n\r\n### Expected behavior\r\nThe data takes up (almost) the whole height of the Charts.\r\n\r\n### Actual behavior\r\n![image](https://user-images.githubusercontent.com/178188/85037281-6e72b780-b185-11ea-92b5-f05b18cb58cf.png)\r\n\r\n\r\n### Steps to reproduce\r\nStart it, wait a bit.\r\n\r\n### Environment\r\n\r\n- Locust version: 1.0.3\r\n- Firefox latest", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1440/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1440/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1439", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1439/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1439/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1439/events", "html_url": "https://github.com/locustio/locust/issues/1439", "id": 641023974, "node_id": "MDU6SXNzdWU2NDEwMjM5NzQ=", "number": 1439, "title": "django\u4e2d\u7684views\u8c03\u7528 \u811a\u672c\u4e2d\u7684\u51fd\u6570\u65f6\uff0c\u62a5\u9519\uff0c\u53c2\u8003\u7f51\u4e0a\u5efa\u8bae\u4fee\u6539monkey.patch_all(thread=False)\uff0c\u62a5\u9519\u8be6\u60c5\u5982\u4e0b When views in Django calls the function in the script, an error is reported. Please refer to the online suggestions for modification monkey.patch_ All (thread = false), the details of error reporting are as follows", "user": {"login": "lixiaolong41", "id": 35594214, "node_id": "MDQ6VXNlcjM1NTk0MjE0", "avatar_url": "https://avatars.githubusercontent.com/u/35594214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lixiaolong41", "html_url": "https://github.com/lixiaolong41", "followers_url": "https://api.github.com/users/lixiaolong41/followers", "following_url": "https://api.github.com/users/lixiaolong41/following{/other_user}", "gists_url": "https://api.github.com/users/lixiaolong41/gists{/gist_id}", "starred_url": "https://api.github.com/users/lixiaolong41/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lixiaolong41/subscriptions", "organizations_url": "https://api.github.com/users/lixiaolong41/orgs", "repos_url": "https://api.github.com/users/lixiaolong41/repos", "events_url": "https://api.github.com/users/lixiaolong41/events{/privacy}", "received_events_url": "https://api.github.com/users/lixiaolong41/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-06-18T08:43:13Z", "updated_at": "2020-06-20T20:28:12Z", "closed_at": "2020-06-20T20:28:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "- OS: centos7\r\n- Python version: 3.6.5\r\n- Locust version:1.0.3\r\n- Locust file contents (anonymized if necessary):\r\n\r\n@task\r\ndef my_task(self):\r\n    self.client.get(\"/\")\r\n\r\n@task\r\ndef task_404(self):\r\n    self.client.get(\"/non-existing-path\")\r\n\r\ndef main(press):\r\n    print(\"xxxxxxxxxx\")\r\n    # id = press.if_id\r\n    print(press)\r\n    user_dict = dict(wait_time=between(1, 3), host=\"https://docs.locust.io\", my_task=my_task, task_404=task_404)\r\n    # setup Environment and Runner\r\n    Users = type('Users', (HttpUser,), user_dict)\r\n    env = Environment(user_classes=[Users])\r\n    env.create_local_runner()\r\n\r\n    # start a WebUI instance\r\n    env.create_web_ui(port=8081)\r\n\r\n    # start a greenlet that periodically outputs the current stats\r\n    gevent.spawn(stats_printer(env.stats))\r\n\r\n    # start the test\r\n    env.runner.start(1, hatch_rate=10)\r\n    gevent.spawn_later(60, lambda: env.runner.quit())\r\n    env.runner.greenlet.join()\r\n    env.web_ui.stop()\r\n\r\nThe above is the content of script file.\r\n\r\ndjango:\r\nfrom .pressure import main\r\ndef press_run(request):\r\n    if request.method == 'POST':\r\n        thread_task = threading.Thread(target=main, args=(press,))\r\n        thread_task.start()\r\n        return HttpResponseRedirect(\"/pressure/case_list\")\r\n\r\n\r\n\r\nBefore modifying site-packages/locust/__init__.py  monkey.patch_all(thread=False)\uff1aerror\uff1a\r\nRuntimeError: cannot release un-acquired lock\r\nand\r\nMonkeyPatchWarning: Monkey-patching ssl after ssl has already been imported may lead to errors, including RecursionError on Python 3.6. It may also silently lead to incorrect behaviour on Python 3.7. Please monkey-patch earlier. See https://github.com/gevent/gevent/issues/1016. Modules that had direct imports (NOT patched): ['aiohttp.client_exceptions (/root/anaconda3/envs/safe/lib/python3.6/site-packages/aiohttp/client_exceptions.py)', 'aiohttp.client (/root/anaconda3/envs/safe/lib/python3.6/site-packages/aiohttp/client.py)', 'aiohttp.client_reqrep (/root/anaconda3/envs/safe/lib/python3.6/site-packages/aiohttp/client_reqrep.py)', 'urllib3.util (/root/anaconda3/envs/safe/lib/python3.6/site-packages/urllib3/util/__init__.py)', 'aiohttp.web_runner (/root/anaconda3/envs/safe/lib/python3.6/site-packages/aiohttp/web_runner.py)', 'aiohttp.web (/root/anaconda3/envs/safe/lib/python3.6/site-packages/aiohttp/web.py)', 'urllib3.util.ssl_ (/root/anaconda3/envs/safe/lib/python3.6/site-packages/urllib3/util/ssl_.py)', 'aiohttp.connector (/root/anaconda3/envs/safe/lib/python3.6/site-packages/aiohttp/connector.py)', 'aiohttp.worker (/root/anaconda3/envs/safe/lib/python3.6/site-packages/aiohttp/worker.py)']. \r\n  _monkey.patch_all()\r\n\r\n\r\nAfter modifying site-packages/locust/__init__.py  error\uff1agreenlet.error: cannot switch to a different thread and\r\nmaximum recursion depth exceeded while calling a Python object and locust no data\r\n\r\nWhen Django is not used\uff1abusiness as usual", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1439/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1439/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1433", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1433/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1433/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1433/events", "html_url": "https://github.com/locustio/locust/issues/1433", "id": 639894261, "node_id": "MDU6SXNzdWU2Mzk4OTQyNjE=", "number": 1433, "title": "Number of http request is greater than number of user given in UI", "user": {"login": "pankaj-kaushik", "id": 34515887, "node_id": "MDQ6VXNlcjM0NTE1ODg3", "avatar_url": "https://avatars.githubusercontent.com/u/34515887?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pankaj-kaushik", "html_url": "https://github.com/pankaj-kaushik", "followers_url": "https://api.github.com/users/pankaj-kaushik/followers", "following_url": "https://api.github.com/users/pankaj-kaushik/following{/other_user}", "gists_url": "https://api.github.com/users/pankaj-kaushik/gists{/gist_id}", "starred_url": "https://api.github.com/users/pankaj-kaushik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pankaj-kaushik/subscriptions", "organizations_url": "https://api.github.com/users/pankaj-kaushik/orgs", "repos_url": "https://api.github.com/users/pankaj-kaushik/repos", "events_url": "https://api.github.com/users/pankaj-kaushik/events{/privacy}", "received_events_url": "https://api.github.com/users/pankaj-kaushik/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-06-16T18:43:19Z", "updated_at": "2021-05-11T11:11:13Z", "closed_at": "2020-06-16T20:07:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nIn locust statistics, i can see that aggregated HTTP request is more than the number of user provided in UI.\r\n\r\nIdeally http request should be equal to number of user entered in UI.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1433/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1433/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1427", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1427/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1427/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1427/events", "html_url": "https://github.com/locustio/locust/issues/1427", "id": 638558849, "node_id": "MDU6SXNzdWU2Mzg1NTg4NDk=", "number": 1427, "title": "Call the runners.locust_runner.stop() function, sometimes it can be stopped, sometimes it cannot be stopped, and it stays within Time limit reached. Stopping Locust. or on_stop", "user": {"login": "sunshine122230", "id": 22783923, "node_id": "MDQ6VXNlcjIyNzgzOTIz", "avatar_url": "https://avatars.githubusercontent.com/u/22783923?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sunshine122230", "html_url": "https://github.com/sunshine122230", "followers_url": "https://api.github.com/users/sunshine122230/followers", "following_url": "https://api.github.com/users/sunshine122230/following{/other_user}", "gists_url": "https://api.github.com/users/sunshine122230/gists{/gist_id}", "starred_url": "https://api.github.com/users/sunshine122230/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sunshine122230/subscriptions", "organizations_url": "https://api.github.com/users/sunshine122230/orgs", "repos_url": "https://api.github.com/users/sunshine122230/repos", "events_url": "https://api.github.com/users/sunshine122230/events{/privacy}", "received_events_url": "https://api.github.com/users/sunshine122230/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-06-15T05:37:10Z", "updated_at": "2020-06-15T06:48:33Z", "closed_at": "2020-06-15T06:48:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version:\r\n- Locust version:\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1427/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1427/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1426", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1426/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1426/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1426/events", "html_url": "https://github.com/locustio/locust/issues/1426", "id": 638294775, "node_id": "MDU6SXNzdWU2MzgyOTQ3NzU=", "number": 1426, "title": "Distributed-mode (Discrepancy in total stats) : Locust master fails to acknowledge the \"last stats\" from slave during end of test", "user": {"login": "akash-work", "id": 12641826, "node_id": "MDQ6VXNlcjEyNjQxODI2", "avatar_url": "https://avatars.githubusercontent.com/u/12641826?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akash-work", "html_url": "https://github.com/akash-work", "followers_url": "https://api.github.com/users/akash-work/followers", "following_url": "https://api.github.com/users/akash-work/following{/other_user}", "gists_url": "https://api.github.com/users/akash-work/gists{/gist_id}", "starred_url": "https://api.github.com/users/akash-work/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akash-work/subscriptions", "organizations_url": "https://api.github.com/users/akash-work/orgs", "repos_url": "https://api.github.com/users/akash-work/repos", "events_url": "https://api.github.com/users/akash-work/events{/privacy}", "received_events_url": "https://api.github.com/users/akash-work/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}, {"id": 2115072627, "node_id": "MDU6TGFiZWwyMTE1MDcyNjI3", "url": "https://api.github.com/repos/locustio/locust/labels/non-critical", "name": "non-critical", "color": "c4e4c9", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-06-14T06:36:01Z", "updated_at": "2021-03-15T21:43:39Z", "closed_at": "2021-03-15T21:43:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "Description : \r\n\r\nI am executing the locust tests under distributed mode in a **Kubernetes** cluster. At the moment I am testing only 1 master - 1 slave configuration. At end of the tests, it is found that locust master fails to acknowledge the last stats from slave. On completion, the Locust master prints the following statement \"**Time limit reached. Stopping Locust.**\" and sends a **quit signal** to the slave/s with a wait time of  **0.5 seconds** to get reports from slaves. This is described as part of below code\r\n\r\n**main.py**\r\n```\r\n` def spawn_run_time_limit_greenlet():\r\n            logger.info(\"Run time limit set to %s seconds\" % options.run_time)\r\n            def timelimit_stop():\r\n                logger.info(\"Time limit reached. Stopping Locust.\")\r\n                runners.locust_runner.quit()\r\n            gevent.spawn_later(options.run_time, timelimit_stop)`\r\n```\r\n**runners.py**\r\n   ```\r\n def quit(self):\r\n        for client in self.clients.all:\r\n            self.server.send_to_client(Message(\"quit\", None, client.id))\r\n        gevent.sleep(0.5) # wait for final stats report from all slaves\r\n        self.greenlet.kill(block=True)\r\n```\r\nHowever in most of the cases it is found that by the time slaves sends the report to master, its **shutdown** is already invoked stopping it from receiving any stats. Here is one example of the locust master-slave logs\r\n\r\nAs per master logs (as shown below), the signal was sent around **2020-06-13 21:04:13,968** and then it waited for exactly 0,5 seconds and the shutdown process began at **2020-06-13 21:04:14,469**\r\n\r\n**[2020-06-13 21:04:13,968] locust-master-1-n9qxq/INFO/locust.main: Time limit reached. Stopping Locust.\r\n[2020-06-13 21:04:14,469] locust-master-1-n9qxq/INFO/locust.main: Shutting down (exit code 1), bye.\r\n[2020-06-13 21:04:14,470] locust-master-1-n9qxq/INFO/locust.main: Cleaning up runner...\r\n[2020-06-13 21:04:14,971] locust-master-1-n9qxq/INFO/locust.main: Running teardowns...**\r\n\r\nAs per the slave logs (as shown below), it received the message from master only at **[2020-06-13 21:04:15,727]** and by this time the master was already in shutdown process.\r\n\r\n**[2020-06-13 21:04:15,727] locust-slave-1-jqpq8/INFO/locust.runners: Got quit message from master, shutting down...\r\n[2020-06-13 21:04:16,632] locust-slave-1-jqpq8/INFO/locust.main: Shutting down (exit code 0), bye.\r\n[2020-06-13 21:04:16,632] locust-slave-1-jqpq8/INFO/locust.main: Cleaning up runner...\r\n[2020-06-13 21:04:16,632] locust-slave-1-jqpq8/INFO/locust.main: Running teardowns...**\r\n\r\nAs you can see, the master didn't rely on \"acknowledgment signal from slave\" rather it was depending on a wait time of 0.5 seconds which should not be the said criteria. This has resulted in loss of data wherein the master doesn't have the entire information of stats from the slave. So the aggregate results at master is less than the total requests tested by slave.\r\n\r\n### Expected behavior\r\nThe master should wait for the slave to send back the acknowledgement signal and the part of keeping time as the constant should be removed.\r\n\r\n\r\n### Environment\r\n\r\n- Python version: 3.8\r\n- Locust version: All the versions\r\n- Locust command line that you ran: \r\n     Locust master : **locust --no-web --expect-slaves=1 -c 10 -r 2 --run-time=10m --csv=<> --logfile=<> -f <some-path>/locustfile.py -H <application-api-url>  --master**\r\n     Locust slave : **locust --no-web -f <some-path>/locustfile.py -H -H <application-api-url>   --slave --master-host=<master-host-point> --master-port=<master port>**", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1426/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1426/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1425", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1425/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1425/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1425/events", "html_url": "https://github.com/locustio/locust/issues/1425", "id": 637760759, "node_id": "MDU6SXNzdWU2Mzc3NjA3NTk=", "number": 1425, "title": "Running locust with docker breaks pip install for some packages", "user": {"login": "Olamyy", "id": 14059714, "node_id": "MDQ6VXNlcjE0MDU5NzE0", "avatar_url": "https://avatars.githubusercontent.com/u/14059714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Olamyy", "html_url": "https://github.com/Olamyy", "followers_url": "https://api.github.com/users/Olamyy/followers", "following_url": "https://api.github.com/users/Olamyy/following{/other_user}", "gists_url": "https://api.github.com/users/Olamyy/gists{/gist_id}", "starred_url": "https://api.github.com/users/Olamyy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Olamyy/subscriptions", "organizations_url": "https://api.github.com/users/Olamyy/orgs", "repos_url": "https://api.github.com/users/Olamyy/repos", "events_url": "https://api.github.com/users/Olamyy/events{/privacy}", "received_events_url": "https://api.github.com/users/Olamyy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-06-12T13:44:57Z", "updated_at": "2020-06-17T12:40:04Z", "closed_at": "2020-06-12T20:01:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nWhen running locust in docker, it breaks the installation of some packages. For now, I've noticed the issue comes up with pandas, numpy and scipy. \r\nI believe this issue is more suited to locust because when I build the locust docker manually, all the packages install successfully.\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\n### Expected behavior\r\npip install should run without any error.\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n![image](https://user-images.githubusercontent.com/14059714/84508891-471e7500-acc3-11ea-9c5c-99615f14766b.png)\r\n![image](https://user-images.githubusercontent.com/14059714/84508920-50a7dd00-acc3-11ea-92ac-4d3ed82a418b.png)\r\n\r\n![image](https://user-images.githubusercontent.com/14059714/84508905-4ab1fc00-acc3-11ea-8cfc-54af7d15d4d7.png)\r\n\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\nVery simple dockerfile\r\n```Dockerfile\r\nFROM locustio/locust\r\n\r\nCOPY requirements.txt /tmp/custom-requirements.txt\r\n\r\nRUN pip3 install --upgrade -r /tmp/custom-requirements.txt\r\n\r\nCOPY locust-scripts /locust-scripts\r\n```\r\nContent of requirements.txt\r\n```\r\nboto3~=1.12.39\r\nsagemaker~=1.55.3\r\npandas\r\njinja2~=2.11.2\r\nconnexion>=1.1.4\r\nswagger-ui-bundle\r\nflask>=1.0.2\r\nrequests\r\n```\r\n\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: Mac OS\r\n- Python version: 3.8\r\n- Locust version: 1.0.2\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1425/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1425/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1424", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1424/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1424/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1424/events", "html_url": "https://github.com/locustio/locust/issues/1424", "id": 637743527, "node_id": "MDU6SXNzdWU2Mzc3NDM1Mjc=", "number": 1424, "title": "Master-host IP is not overrided by environment variable.", "user": {"login": "bat79a", "id": 10594983, "node_id": "MDQ6VXNlcjEwNTk0OTgz", "avatar_url": "https://avatars.githubusercontent.com/u/10594983?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bat79a", "html_url": "https://github.com/bat79a", "followers_url": "https://api.github.com/users/bat79a/followers", "following_url": "https://api.github.com/users/bat79a/following{/other_user}", "gists_url": "https://api.github.com/users/bat79a/gists{/gist_id}", "starred_url": "https://api.github.com/users/bat79a/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bat79a/subscriptions", "organizations_url": "https://api.github.com/users/bat79a/orgs", "repos_url": "https://api.github.com/users/bat79a/repos", "events_url": "https://api.github.com/users/bat79a/events{/privacy}", "received_events_url": "https://api.github.com/users/bat79a/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2020-06-12T13:17:13Z", "updated_at": "2020-06-18T12:35:42Z", "closed_at": "2020-06-15T08:06:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "#899 # Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nWhen you try to override the --master-host ip with an environnement variable (k8s configMap) the ip is not use by the worker. \r\n\r\nI have try this two variables without any effect :\r\n- LOCUST_MASTER_HOST\r\n- MASTER_HOST\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nThe worker will use the environment variable and the master will see this worker.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n- If I use the command worker --master-host=my_ip the master can see my worker.\r\n- If I try to set the --master-host with my environment variable, the master can't see my worker.\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: Docker/K8S with environment variable in a ConfigMap\r\n- Python version: 3.6.1\r\n- Locust version: 1.0.3\r\n- Locust command line that you ran: [\"locust\", \"-f\", \"locustfile.py\", \"--worker\"]\r\n- Locust file contents (anonymized if necessary): /", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1424/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1424/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1422", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1422/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1422/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1422/events", "html_url": "https://github.com/locustio/locust/issues/1422", "id": 637036921, "node_id": "MDU6SXNzdWU2MzcwMzY5MjE=", "number": 1422, "title": "ZMQ Error when running locust in distributed mode", "user": {"login": "Olamyy", "id": 14059714, "node_id": "MDQ6VXNlcjE0MDU5NzE0", "avatar_url": "https://avatars.githubusercontent.com/u/14059714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Olamyy", "html_url": "https://github.com/Olamyy", "followers_url": "https://api.github.com/users/Olamyy/followers", "following_url": "https://api.github.com/users/Olamyy/following{/other_user}", "gists_url": "https://api.github.com/users/Olamyy/gists{/gist_id}", "starred_url": "https://api.github.com/users/Olamyy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Olamyy/subscriptions", "organizations_url": "https://api.github.com/users/Olamyy/orgs", "repos_url": "https://api.github.com/users/Olamyy/repos", "events_url": "https://api.github.com/users/Olamyy/events{/privacy}", "received_events_url": "https://api.github.com/users/Olamyy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1003994742, "node_id": "MDU6TGFiZWwxMDAzOTk0NzQy", "url": "https://api.github.com/repos/locustio/locust/labels/waiting%20on%20contributor", "name": "waiting on contributor", "color": "5319e7", "default": false, "description": ""}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2020-06-11T13:54:59Z", "updated_at": "2020-06-30T13:37:54Z", "closed_at": "2020-06-30T13:37:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nI have a simple locust setup with a master and 50  slave workers. Everything seems fine but whenever the workers start loading, I get a ZMQError. I'm not sure if this is something I'm doing wrong on my end or from locust. \r\n![image](https://user-images.githubusercontent.com/14059714/84392410-a2d0fb80-abfa-11ea-8f6d-2108b0166457.png)\r\n\r\n### Expected behavior\r\nWorkers should be loaded without any error.\r\n\r\n### Actual behavior\r\n![image](https://user-images.githubusercontent.com/14059714/84392443-acf2fa00-abfa-11ea-9db2-af17a268dd34.png)\r\n\r\n### Steps to reproduce\r\n```bash\r\n# master\r\nlocust -f locustfile.py --master\r\n```\r\n\r\n```python\r\n# workers\r\nimport subprocesses\r\nprocesses = []\r\nfor _ in range(50):\r\n    print('Starting worker : {worker_id}')\r\n    s = subprocess.Popen([\r\n        'locust', '--loglevel', 'debug', '--worker', '-f', \"locust-scripts/simple.py\",\r\n        '--master-host', \"127.0.0.1\", '--host', None\r\n    ])\r\n    processes.append(s)\r\n\r\nfor s in processes:\r\n    s.communicate()\r\n```\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: Mac OS\r\n- Python version: 3.8\r\n- Locust version: 1.0.2\r\n- Locust command line that you ran: locust\r\n- Locust file contents (anonymized if necessary):\r\n\r\n```\r\nclass SimpleBehavior(TaskSet):\r\n\r\n    @task\r\n    def index(self):\r\n        self.client.get('/')\r\n\r\n\r\nclass MyLocust(HttpLocust):\r\n    task_set = SimpleBehavior\r\n    min_wait = 0\r\n    max_wait = 0\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1422/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1422/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1421", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1421/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1421/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1421/events", "html_url": "https://github.com/locustio/locust/issues/1421", "id": 636717201, "node_id": "MDU6SXNzdWU2MzY3MTcyMDE=", "number": 1421, "title": "Two test_stop events triggered when --run-time expires", "user": {"login": "lolwhitaker", "id": 15690490, "node_id": "MDQ6VXNlcjE1NjkwNDkw", "avatar_url": "https://avatars.githubusercontent.com/u/15690490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lolwhitaker", "html_url": "https://github.com/lolwhitaker", "followers_url": "https://api.github.com/users/lolwhitaker/followers", "following_url": "https://api.github.com/users/lolwhitaker/following{/other_user}", "gists_url": "https://api.github.com/users/lolwhitaker/gists{/gist_id}", "starred_url": "https://api.github.com/users/lolwhitaker/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lolwhitaker/subscriptions", "organizations_url": "https://api.github.com/users/lolwhitaker/orgs", "repos_url": "https://api.github.com/users/lolwhitaker/repos", "events_url": "https://api.github.com/users/lolwhitaker/events{/privacy}", "received_events_url": "https://api.github.com/users/lolwhitaker/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-06-11T04:58:36Z", "updated_at": "2020-06-23T15:26:04Z", "closed_at": "2020-06-23T15:26:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\non_stop event triggers twice when running with --run-time option.\r\n\r\n### Expected behavior\r\nWhile stop() is invoked twice, once for the run-time expiration and again when the last worker quits, I would expect only one on_stop event to trigger.\r\n\r\nCurrent workaround is to handle the first invocation and ignore the second, but it would be helpful to have a single event which indicates test completion so that actions like publishing test results can be performed without considering the possibility of it firing twice.\r\n\r\n### Actual behavior\r\nThe stop() method is invoked twice, once for the run-time expiration and again when the last worker quits.  Both invocations trigger the on_stop listener.  Without any context for these events included code must be written to ensure that any actions in the listener are only performed once.\r\n\r\n### Steps to reproduce\r\n1. Add on_stop listener to master script and log a message when it fires.\r\n\t\ti.e. `test is stopping`\r\n1. Launch a distributed headless load test using the `--run-time` flag\r\n1. Let the test complete cleanly and reach the run-time expiration\r\n1. Review the logging and notice that the on_stop message is logged twice\r\n\r\nRunning a test with `--run-time 3600`, here is the log output seen:\r\n```\r\n[2020-06-10 23:15:31,170] master-i0fcb20ff0d09d6000/INFO/root: Waiting for workers to be ready, 0 of 5 connected\r\n[2020-06-10 23:15:31,594] master-i0fcb20ff0d09d6000/INFO/locust.runners: Client 'worker-i0d546ad7c75f6145e_5cc723077cf6ee606ddd2cd2c78d3202' reported as ready. Currently 1 clients ready to swarm.\r\n[2020-06-10 23:15:31,595] master-i0fcb20ff0d09d6000/WARNING/locust.runners: Worker worker-i0d546ad7c75f6145e_5cc723077cf6ee606ddd2cd2c78d3202 exceeded cpu threshold (will only log this once per worker)\r\n[2020-06-10 23:15:31,596] master-i0fcb20ff0d09d6000/INFO/locust.runners: Client 'worker-i0b60627624f3c09a2_7c42adfd2885822af33a87ad70c6e1e2' reported as ready. Currently 2 clients ready to swarm.\r\n[2020-06-10 23:15:31,596] master-i0fcb20ff0d09d6000/WARNING/locust.runners: Worker worker-i0b60627624f3c09a2_7c42adfd2885822af33a87ad70c6e1e2 exceeded cpu threshold (will only log this once per worker)\r\n[2020-06-10 23:15:31,682] master-i0fcb20ff0d09d6000/INFO/locust.runners: Client 'worker-i067df301bf38422b1_3f58f5805cb10bbdf1287f2529576980' reported as ready. Currently 3 clients ready to swarm.\r\n[2020-06-10 23:15:31,684] master-i0fcb20ff0d09d6000/WARNING/locust.runners: Worker worker-i067df301bf38422b1_3f58f5805cb10bbdf1287f2529576980 exceeded cpu threshold (will only log this once per worker)\r\n[2020-06-10 23:15:31,687] master-i0fcb20ff0d09d6000/INFO/locust.runners: Client 'worker-i01af57f1c1e685003_c07c6aeb08912f27c5c5740a59200196' reported as ready. Currently 4 clients ready to swarm.\r\n[2020-06-10 23:15:31,687] master-i0fcb20ff0d09d6000/WARNING/locust.runners: Worker worker-i01af57f1c1e685003_c07c6aeb08912f27c5c5740a59200196 exceeded cpu threshold (will only log this once per worker)\r\n[2020-06-10 23:15:31,692] master-i0fcb20ff0d09d6000/INFO/locust.runners: Client 'worker-i05ba8e9d6e9d3f051_22b221cf0d4a4caa191f3bc92c01eee6' reported as ready. Currently 5 clients ready to swarm.\r\n[2020-06-10 23:15:31,693] master-i0fcb20ff0d09d6000/WARNING/locust.runners: Worker worker-i05ba8e9d6e9d3f051_22b221cf0d4a4caa191f3bc92c01eee6 exceeded cpu threshold (will only log this once per worker)\r\n[2020-06-10 23:15:32,171] master-i0fcb20ff0d09d6000/INFO/locust.runners: Sending hatch jobs of 10 users and 2.00 hatch rate to 5 ready clients\r\n[2020-06-10 23:15:32,171] master-i0fcb20ff0d09d6000/INFO/locust.main: Run time limit set to 3600 seconds\r\n[2020-06-10 23:15:32,172] master-i0fcb20ff0d09d6000/INFO/locust.main: Starting Locust 1.0.3\r\n[2020-06-11 00:15:32,171] master-i0fcb20ff0d09d6000/INFO/locust.main: Time limit reached. Stopping Locust.\r\n[2020-06-11 00:15:32,171] master-i0fcb20ff0d09d6000/INFO/root: test is stopping\r\n[2020-06-11 00:15:32,174] master-i0fcb20ff0d09d6000/INFO/locust.runners: Client 'worker-i0b60627624f3c09a2_7c42adfd2885822af33a87ad70c6e1e2' quit. Currently 0 clients connected.\r\n[2020-06-11 00:15:32,177] master-i0fcb20ff0d09d6000/INFO/locust.runners: Client 'worker-i067df301bf38422b1_3f58f5805cb10bbdf1287f2529576980' quit. Currently 0 clients connected.\r\n[2020-06-11 00:15:32,178] master-i0fcb20ff0d09d6000/INFO/locust.runners: Client 'worker-i05ba8e9d6e9d3f051_22b221cf0d4a4caa191f3bc92c01eee6' quit. Currently 0 clients connected.\r\n[2020-06-11 00:15:32,183] master-i0fcb20ff0d09d6000/INFO/locust.runners: Client 'worker-i01af57f1c1e685003_c07c6aeb08912f27c5c5740a59200196' quit. Currently 0 clients connected.\r\n[2020-06-11 00:15:32,194] master-i0fcb20ff0d09d6000/INFO/locust.runners: Client 'worker-i0d546ad7c75f6145e_5cc723077cf6ee606ddd2cd2c78d3202' quit. Currently 0 clients connected.\r\n[2020-06-11 00:15:32,194] master-i0fcb20ff0d09d6000/INFO/locust.runners: The last worker quit, stopping test.\r\n[2020-06-11 00:15:32,194] master-i0fcb20ff0d09d6000/INFO/root: test is stopping\r\n[2020-06-11 00:15:32,673] master-i0fcb20ff0d09d6000/INFO/locust.main: Running teardowns...\r\n[2020-06-11 00:15:33,174] master-i0fcb20ff0d09d6000/INFO/locust.main: Shutting down (exit code 0), bye.\r\n[2020-06-11 00:15:33,174] master-i0fcb20ff0d09d6000/INFO/locust.main: Cleaning up runner...\r\n```\r\n\r\n### Environment\r\n\r\n- OS: Ubuntu 16.04\r\n- Python version: 3.6.8\r\n- Locust version: 1.0.3\r\n- Locust command line that you ran: \r\n\r\n```\r\npython3 -m locust -f bin/locust_dummy_script.py  --headless --master --logfile locust.log -u 10 -r 2 --master-bind-host 127.0.0.1 --master-bind-port 5557 --web-host 127.0.0.1 --web-port 8089 --run-time 3600 --expect-workers 5\r\n```\r\n- Locust file contents (anonymized if necessary):\r\n\t```\r\n\t$ cat locust_dummy_script.py \r\n\t# coding: utf8\r\n\tfrom locust import User, TaskSet, task, events\r\n\timport logging\r\n\r\n\timport locust.stats\r\n\tlocust.stats.CSV_STATS_INTERVAL_SEC = 30 # default is 2 seconds\r\n\r\n\t@events.test_stop.add_listener\r\n\tdef on_test_stop(**kw):\r\n\t    logging.info(\"test is stopping\")\r\n\r\n\tclass MyTaskSet(TaskSet):\r\n\t    @task(20)\r\n\t    def hello(self):\r\n\t        pass\r\n\tclass Dummy(User):\r\n\t    tasks = [MyTaskSet]\r\n\t```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1421/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1421/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1420", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1420/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1420/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1420/events", "html_url": "https://github.com/locustio/locust/issues/1420", "id": 636385693, "node_id": "MDU6SXNzdWU2MzYzODU2OTM=", "number": 1420, "title": "Unable to avoid user session persistence after first run - HttpUser", "user": {"login": "vazkarvishal", "id": 13076513, "node_id": "MDQ6VXNlcjEzMDc2NTEz", "avatar_url": "https://avatars.githubusercontent.com/u/13076513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vazkarvishal", "html_url": "https://github.com/vazkarvishal", "followers_url": "https://api.github.com/users/vazkarvishal/followers", "following_url": "https://api.github.com/users/vazkarvishal/following{/other_user}", "gists_url": "https://api.github.com/users/vazkarvishal/gists{/gist_id}", "starred_url": "https://api.github.com/users/vazkarvishal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vazkarvishal/subscriptions", "organizations_url": "https://api.github.com/users/vazkarvishal/orgs", "repos_url": "https://api.github.com/users/vazkarvishal/repos", "events_url": "https://api.github.com/users/vazkarvishal/events{/privacy}", "received_events_url": "https://api.github.com/users/vazkarvishal/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-06-10T16:24:14Z", "updated_at": "2020-06-10T17:17:20Z", "closed_at": "2020-06-10T17:17:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hey Guys,\r\n\r\nI am using the latest version of Locust along with the HttpUser class in combination with TaskSets to make some nested API calls. However, after my spawned user completes the journey, I want all the cookies and ideally the session to be terminated and spawn a fresh user. I can't seem to find an easy way of doing this at the moment. \r\n\r\nCurrently, once the user is spawned for the first time, the journey passes fine. However, when the same spawned user runs the journey again, it fails because the session remembers the previous runs cookies and header data.\r\n\r\nexample code:\r\n```\r\nclass WebUser(HttpUser):\r\n\r\n    wait_time = between(1, 5)\r\n    host = \"https://someUrl\"\r\n\r\n    tasks = {UserBehaviour: 1}\r\n\r\nclass UserBehaviour(SequentialTaskSet):\r\n\r\n    @task\r\n        def getPlatformSessionId(self):\r\n            print(\"====STARTING====\")\r\n\r\n            with self.client.get(\"/auth\", catch_response=True) as response:\r\n            if response.cookies:\r\n                print(\"===== CLEAN Session ID=====   \" +\r\n                      print(response.cookies[\"Session\"])\r\n                print(\"====ENDING====\")\r\n```\r\n\r\nWhen I run the above code for the first time it works fine. However when the same user re-runs the HttpSession I get the following error because the cookie expected is persisted in the users session and a new cookie with a re-generated ID is not returned.\r\n\r\n```\r\n====STARTING====\r\n[2020-06-10 17:02:39,640] VishalVazkars-MacBook-Pro.local/ERROR/locust.user.task: \"name='Session', domain=None, path=None\"\r\nTraceback (most recent call last):\r\n  File \"/Users/vishalvazkar/Work/Playground/learning-locust/locust_venv/lib/python3.7/site-packages/locust/user/task.py\", line 284, in run\r\n    self.execute_next_task()\r\n  File \"/Users/vishalvazkar/Work/Playground/learning-locust/locust_venv/lib/python3.7/site-packages/locust/user/task.py\", line 309, in execute_next_task\r\n    self.execute_task(self._task_queue.pop(0))\r\n  File \"/Users/vishalvazkar/Work/Playground/learning-locust/locust_venv/lib/python3.7/site-packages/locust/user/task.py\", line 416, in execute_task\r\n    task(self.user)\r\n  File \"/Users/vishalvazkar/Work/Playground/learning-locust/locust_test/vodafone/main.py\", line 52, in getPlatformSessionId\r\n    get_decoded_id('platformSessionId\":\"(.*)\",', response.cookies[\"Session\"]))\r\n  File \"/Users/vishalvazkar/Work/Playground/learning-locust/locust_venv/lib/python3.7/site-packages/requests/cookies.py\", line 328, in __getitem__\r\n    return self._find_no_duplicates(name)\r\n  File \"/Users/vishalvazkar/Work/Playground/learning-locust/locust_venv/lib/python3.7/site-packages/requests/cookies.py\", line 399, in _find_no_duplicates\r\n    raise KeyError('name=%r, domain=%r, path=%r' % (name, domain, path))\r\nKeyError: \"name='Session', domain=None, path=None\"\r\n```\r\n\r\nAny help is appreciated!\r\nThanks,\r\nVish", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1420/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1420/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1418", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1418/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1418/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1418/events", "html_url": "https://github.com/locustio/locust/issues/1418", "id": 634784941, "node_id": "MDU6SXNzdWU2MzQ3ODQ5NDE=", "number": 1418, "title": "Locust Installation error on Ubuntu 16.04 and Debian Stretch", "user": {"login": "darkwizard242", "id": 40025815, "node_id": "MDQ6VXNlcjQwMDI1ODE1", "avatar_url": "https://avatars.githubusercontent.com/u/40025815?v=4", "gravatar_id": "", "url": "https://api.github.com/users/darkwizard242", "html_url": "https://github.com/darkwizard242", "followers_url": "https://api.github.com/users/darkwizard242/followers", "following_url": "https://api.github.com/users/darkwizard242/following{/other_user}", "gists_url": "https://api.github.com/users/darkwizard242/gists{/gist_id}", "starred_url": "https://api.github.com/users/darkwizard242/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/darkwizard242/subscriptions", "organizations_url": "https://api.github.com/users/darkwizard242/orgs", "repos_url": "https://api.github.com/users/darkwizard242/repos", "events_url": "https://api.github.com/users/darkwizard242/events{/privacy}", "received_events_url": "https://api.github.com/users/darkwizard242/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 17, "created_at": "2020-06-08T16:59:31Z", "updated_at": "2021-06-18T18:05:47Z", "closed_at": "2020-06-09T00:01:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nAs far as I understand, Locust package has moved from _**locustio**_ to [locust](https://pypi.org/project/locust/). I was developing an Ansible role to install locust on a few of Debian family operating systems such as the following:\r\n\r\n- Ubuntu 20.04\r\n- Ubuntu 18.04\r\n- Ubuntu 16.04\r\n- Debian Buster\r\n- Debian Stretch\r\n\r\nUsing python3's pip, locust is successfully installed on **Ubuntu 20.04**, **Ubuntu 18.04** and **Debian Buster**. However, it attempts to install **locustio** along with **locust** and errors out on **Ubuntu 16.04** and **Debian Stretch**.\r\n\r\n### Expected behavior\r\nClean installation on Ubuntu 16.04 and Debian Stretch.\r\n\r\n### Actual behavior\r\nOutputs below error (running locally within a docker container of ubuntu 16.04):\r\n```shell\r\n$ python3 -m pip install locust\r\nCollecting locust\r\n  Downloading locust-0.0.tar.gz (833 bytes)\r\nCollecting locustio\r\n  Downloading locustio-0.999.tar.gz (267 kB)\r\n     |################################| 267 kB 2.5 MB/s \r\nBuilding wheels for collected packages: locust, locustio\r\n  Building wheel for locust (setup.py) ... done\r\n  Created wheel for locust: filename=locust-0.0-py3-none-any.whl size=1042 sha256=f16b8e06507985e6c7922338e7ab884a279416f6ba98370cfb6e7931d3b41ffe\r\n  Stored in directory: /root/.cache/pip/wheels/fa/78/82/0d758e038e682fad3d3ece52a4724f9cb2822693ab6f504589\r\n  Building wheel for locustio (setup.py) ... error\r\n  ERROR: Command errored out with exit status 1:\r\n   command: /usr/bin/python3 -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'/tmp/pip-install-v2zs_a7d/locustio/setup.py'\"'\"'; __file__='\"'\"'/tmp/pip-install-v2zs_a7d/locustio/setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' bdist_wheel -d /tmp/pip-wheel-pyaprmw9\r\n       cwd: /tmp/pip-install-v2zs_a7d/locustio/\r\n  Complete output (89 lines):\r\n  running bdist_wheel\r\n  running build\r\n  running build_py\r\n  creating build\r\n  creating build/lib\r\n  creating build/lib/locust\r\n  copying locust/exception.py -> build/lib/locust\r\n  copying locust/runners.py -> build/lib/locust\r\n  copying locust/__init__.py -> build/lib/locust\r\n  copying locust/main.py -> build/lib/locust\r\n  copying locust/__main__.py -> build/lib/locust\r\n  copying locust/log.py -> build/lib/locust\r\n  copying locust/stats.py -> build/lib/locust\r\n  copying locust/event.py -> build/lib/locust\r\n  copying locust/argument_parser.py -> build/lib/locust\r\n  copying locust/env.py -> build/lib/locust\r\n  copying locust/clients.py -> build/lib/locust\r\n  copying locust/web.py -> build/lib/locust\r\n  creating build/lib/locust/test\r\n  copying locust/test/test_client.py -> build/lib/locust/test\r\n  copying locust/test/mock_locustfile.py -> build/lib/locust/test\r\n  copying locust/test/test_runners.py -> build/lib/locust/test\r\n  copying locust/test/test_fasthttp.py -> build/lib/locust/test\r\n  copying locust/test/test_wait_time.py -> build/lib/locust/test\r\n  copying locust/test/test_parser.py -> build/lib/locust/test\r\n  copying locust/test/__init__.py -> build/lib/locust/test\r\n  copying locust/test/testcases.py -> build/lib/locust/test\r\n  copying locust/test/test_zmqrpc.py -> build/lib/locust/test\r\n  copying locust/test/test_old_wait_api.py -> build/lib/locust/test\r\n  copying locust/test/test_web.py -> build/lib/locust/test\r\n  copying locust/test/mock_logging.py -> build/lib/locust/test\r\n  copying locust/test/test_util.py -> build/lib/locust/test\r\n  copying locust/test/test_taskratio.py -> build/lib/locust/test\r\n  copying locust/test/test_stats.py -> build/lib/locust/test\r\n  copying locust/test/test_log.py -> build/lib/locust/test\r\n  copying locust/test/test_tags.py -> build/lib/locust/test\r\n  copying locust/test/test_locust_class.py -> build/lib/locust/test\r\n  copying locust/test/test_sequential_taskset.py -> build/lib/locust/test\r\n  copying locust/test/test_main.py -> build/lib/locust/test\r\n  copying locust/test/util.py -> build/lib/locust/test\r\n  creating build/lib/locust/rpc\r\n  copying locust/rpc/protocol.py -> build/lib/locust/rpc\r\n  copying locust/rpc/zmqrpc.py -> build/lib/locust/rpc\r\n  copying locust/rpc/__init__.py -> build/lib/locust/rpc\r\n  creating build/lib/locust/util\r\n  copying locust/util/deprecation.py -> build/lib/locust/util\r\n  copying locust/util/exception_handler.py -> build/lib/locust/util\r\n  copying locust/util/cache.py -> build/lib/locust/util\r\n  copying locust/util/rounding.py -> build/lib/locust/util\r\n  copying locust/util/__init__.py -> build/lib/locust/util\r\n  copying locust/util/timespan.py -> build/lib/locust/util\r\n  creating build/lib/locust/user\r\n  copying locust/user/inspectuser.py -> build/lib/locust/user\r\n  copying locust/user/__init__.py -> build/lib/locust/user\r\n  copying locust/user/task.py -> build/lib/locust/user\r\n  copying locust/user/users.py -> build/lib/locust/user\r\n  copying locust/user/sequential_taskset.py -> build/lib/locust/user\r\n  copying locust/user/wait_time.py -> build/lib/locust/user\r\n  creating build/lib/locust/contrib\r\n  copying locust/contrib/fasthttp.py -> build/lib/locust/contrib\r\n  copying locust/contrib/__init__.py -> build/lib/locust/contrib\r\n  running egg_info\r\n  writing top-level names to locustio.egg-info/top_level.txt\r\n  writing locustio.egg-info/PKG-INFO\r\n  writing dependency_links to locustio.egg-info/dependency_links.txt\r\n  writing entry points to locustio.egg-info/entry_points.txt\r\n  reading manifest file 'locustio.egg-info/SOURCES.txt'\r\n  reading manifest template 'MANIFEST.in'\r\n  writing manifest file 'locustio.egg-info/SOURCES.txt'\r\n  creating build/lib/locust/static\r\n  copying locust/static/chart.js -> build/lib/locust/static\r\n  copying locust/static/echarts.common.min.js -> build/lib/locust/static\r\n  copying locust/static/jquery-1.11.3.min.js -> build/lib/locust/static\r\n  copying locust/static/jquery.jqote2.min.js -> build/lib/locust/static\r\n  copying locust/static/jquery.tools.min.js -> build/lib/locust/static\r\n  copying locust/static/locust.js -> build/lib/locust/static\r\n  copying locust/static/style.css -> build/lib/locust/static\r\n  copying locust/static/vintage.js -> build/lib/locust/static\r\n  creating build/lib/locust/static/img\r\n  copying locust/static/img/favicon.ico -> build/lib/locust/static/img\r\n  copying locust/static/img/logo.png -> build/lib/locust/static/img\r\n  copying locust/static/img/top_bg.png -> build/lib/locust/static/img\r\n  creating build/lib/locust/templates\r\n  copying locust/templates/index.html -> build/lib/locust/templates\r\n  installing to build/bdist.linux-x86_64/wheel\r\n  running install\r\n  \r\n  **** Locust package has moved from 'locustio' to 'locust'. Please update your reference (or pin your version to 0.14.6 if you dont want to update to 1.0) ****\r\n  \r\n  ----------------------------------------\r\n  ERROR: Failed building wheel for locustio\r\n  Running setup.py clean for locustio\r\nSuccessfully built locust\r\nFailed to build locustio\r\nInstalling collected packages: locustio, locust\r\n    Running setup.py install for locustio ... error\r\n    ERROR: Command errored out with exit status 1:\r\n     command: /usr/bin/python3 -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'/tmp/pip-install-v2zs_a7d/locustio/setup.py'\"'\"'; __file__='\"'\"'/tmp/pip-install-v2zs_a7d/locustio/setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' install --record /tmp/pip-record-bzfj941a/install-record.txt --single-version-externally-managed --compile --install-headers /usr/local/include/python3.5/locustio\r\n         cwd: /tmp/pip-install-v2zs_a7d/locustio/\r\n    Complete output (4 lines):\r\n    running install\r\n    \r\n    **** Locust package has moved from 'locustio' to 'locust'. Please update your reference (or pin your version to 0.14.6 if you dont want to update to 1.0) ****\r\n    \r\n    ----------------------------------------\r\nERROR: Command errored out with exit status 1: /usr/bin/python3 -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'/tmp/pip-install-v2zs_a7d/locustio/setup.py'\"'\"'; __file__='\"'\"'/tmp/pip-install-v2zs_a7d/locustio/setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' install --record /tmp/pip-record-bzfj941a/install-record.txt --single-version-externally-managed --compile --install-headers /usr/local/include/python3.5/locustio Check the logs for full command output.\r\n```\r\n\r\n### Steps to reproduce\r\nInstall locust on an ubuntu 16.04 or debian stretch docker image.\r\n\r\nOR try following:\r\n\r\n```shell\r\ndocker run -it darkwizard242/ansible:ubuntu-16.04 /bin/bash -c 'python3 -m pip install locust' \r\n```\r\n\r\n```shell\r\ndocker run -it darkwizard242/ansible:debian-stretch /bin/bash -c 'python3 -m pip install locust' \r\n```\r\n\r\n### Environment\r\n\r\n- OS: Ubuntu 16.04 & Debian Stretch\r\n- Python version: 3.5.2 (ubuntu 16.04) and 3.5.3 (debian-stretch)\r\n- Locust version: Default (as failure at installation process with certain operating systems)", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1418/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1418/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1417", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1417/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1417/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1417/events", "html_url": "https://github.com/locustio/locust/issues/1417", "id": 634397400, "node_id": "MDU6SXNzdWU2MzQzOTc0MDA=", "number": 1417, "title": "locust doesn't escape the double quotes in the csv output ", "user": {"login": "tobeczm", "id": 8512109, "node_id": "MDQ6VXNlcjg1MTIxMDk=", "avatar_url": "https://avatars.githubusercontent.com/u/8512109?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tobeczm", "html_url": "https://github.com/tobeczm", "followers_url": "https://api.github.com/users/tobeczm/followers", "following_url": "https://api.github.com/users/tobeczm/following{/other_user}", "gists_url": "https://api.github.com/users/tobeczm/gists{/gist_id}", "starred_url": "https://api.github.com/users/tobeczm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tobeczm/subscriptions", "organizations_url": "https://api.github.com/users/tobeczm/orgs", "repos_url": "https://api.github.com/users/tobeczm/repos", "events_url": "https://api.github.com/users/tobeczm/events{/privacy}", "received_events_url": "https://api.github.com/users/tobeczm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-06-08T08:58:31Z", "updated_at": "2020-06-16T13:34:26Z", "closed_at": "2020-06-16T13:34:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n```\r\n    @task(1)\r\n    def get(self, size):\r\n        self.client.get(\"/cash/{}\".format(size), name='{\"scenario\":\"get cashes\",\"path\":\"/cash/[amount]\",\"arguments\":[{\"size\":1}]}'))\r\n\r\n```\r\n\r\n\r\n\r\n### Expected behavior\r\nthe quotes should be escaped as below:\r\n```\r\n\"Type\",\"Name\",...\r\n\"GET\",\"{\"\"scenario\"\": \"\"get cashes\"\", \"\"path\"\": \"\"/cash/[amount]\"\", \"\"arguments\"\": [{\"\"size\"\": 1}]}\", ...\r\n```\r\n\r\n### Actual behavior\r\nin the csv output is looks as below, the quotes are not escaped.\r\n\r\n```\r\n\"Type\",\"Name\",...\r\n\"GET\",\"{\"scenario\": \"get cashes\", \"path\": \"/cash/[amount]\", \"arguments\": [{\"size\": 1}]}\", ...\r\n```\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version:3.8\r\n- Locust version: 1.0.2\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1417/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1417/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1407", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1407/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1407/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1407/events", "html_url": "https://github.com/locustio/locust/issues/1407", "id": 628565102, "node_id": "MDU6SXNzdWU2Mjg1NjUxMDI=", "number": 1407, "title": "workers do not terminate tasks when master exits ", "user": {"login": "chrishare08", "id": 58052919, "node_id": "MDQ6VXNlcjU4MDUyOTE5", "avatar_url": "https://avatars.githubusercontent.com/u/58052919?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chrishare08", "html_url": "https://github.com/chrishare08", "followers_url": "https://api.github.com/users/chrishare08/followers", "following_url": "https://api.github.com/users/chrishare08/following{/other_user}", "gists_url": "https://api.github.com/users/chrishare08/gists{/gist_id}", "starred_url": "https://api.github.com/users/chrishare08/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chrishare08/subscriptions", "organizations_url": "https://api.github.com/users/chrishare08/orgs", "repos_url": "https://api.github.com/users/chrishare08/repos", "events_url": "https://api.github.com/users/chrishare08/events{/privacy}", "received_events_url": "https://api.github.com/users/chrishare08/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1003994742, "node_id": "MDU6TGFiZWwxMDAzOTk0NzQy", "url": "https://api.github.com/repos/locustio/locust/labels/waiting%20on%20contributor", "name": "waiting on contributor", "color": "5319e7", "default": false, "description": ""}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-06-01T16:19:58Z", "updated_at": "2020-06-20T20:29:49Z", "closed_at": "2020-06-20T20:29:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n\r\n### workers do not terminate tasks when master exits \r\nWhen executing a task sequence and the worker terminates after run-time has elapsed, the workers keep running even after stop-timeout has passed.\r\n\r\n### Expected behavior\r\nWhen the master reaches the run-time limit, is should signal the workers to stop new tasks and apply the stop-timeout to their pending tasks and eventually the workers and master should exist when the stop-timeout has been reached.\r\n\r\n### Actual behavior\r\nRunning the command on the master:\r\n\r\n```\r\nlocust --loglevel=DEBUG --headless -u 250 --run-time=10m --stop-timeout=600 --host platform --logfile=debug.log -r 1 --csv test-csv --master --expect-workers=2\r\n```\r\n\r\nand running the command\r\n\r\n```\r\nlocust --worker --master-host=locust-master --master-port=5557 --loglevel=DEBUG --logfile=debug.log \r\n```\r\n\r\nresults in the master terminating when run-time has reached, but the workers continue to execute until killed.\r\n\r\n### Steps to reproduce\r\nExecute those two commands \r\n\r\n### Environment\r\n\r\n- OS: Linux\r\n- Python version: 3.7.6\r\n- Locust version: 1.0.2\r\n- Locust command line that you ran: see above\r\n- Locust file contents (anonymized if necessary):\r\n\r\n```\r\nimport os\r\nimport sys\r\nimport re\r\nimport csv\r\nimport json\r\nimport logging\r\nimport time\r\nfrom datetime import datetime\r\nimport socket\r\nfrom random import *\r\nfrom locust import HttpUser, TaskSet, between, SequentialTaskSet, task, events\r\n\r\n# Global variale defintion\r\niterationCounter = 0        # how many iterations have we done\r\nmaxIterations = 0           # maximum number of iterations\r\ncredentials_file = \"credentials.txt\"\r\n# list to store the available credentials in.  We will use this to randomly select a user\r\ncredentials = []\r\n# the node name\r\nnode = socket.getaddrinfo(socket.gethostname(), 0,\r\n                          flags=socket.AI_CANONNAME)[0][3]\r\n# define the results file\r\nnow = datetime.now().strftime(\"%m%d%Y%H%M%S\")\r\niteration_csv = f\"{now}-{node.replace('.','-')}-results.csv\"\r\n\r\niteration_fh = None         # file handle for the iteration.csv file\r\niteration_writer = None     # CSV writer object\r\nis_worker = True            # this is set to false if this is the master\r\nwrote_header = False        # true once the header is written\r\niteration_csv_fields = 0    # how many fields in the results file\r\n\r\nhttp_status_codes = {\r\n    \"100\": \"Continue\",\r\n    \"101\": \"Switching Protocols\",\r\n    \"200\": \"OK\",\r\n    \"201\":  \"Created\",\r\n    \"202\": \"Accepted\",\r\n    \"203\": \"Non-Authoritative Information\",\r\n    \"204\": \"No Content\",\r\n    \"205\": \"Reset Content\",\r\n    \"206\": \"Partial Content\",\r\n    \"300\": \"Multiple Choices\",\r\n    \"301\": \"Moved Permanently\",\r\n    \"302\": \"Found\",\r\n    \"303\": \"See Other\",\r\n    \"304\": \"Not Modified\",\r\n    \"305\": \"Use Proxy\",\r\n    \"307\": \"Temporary Redirect\",\r\n    \"400\": \"Bad Request\",\r\n    \"401\": \"Unauthorized\",\r\n    \"402\": \"Payment Required\",\r\n    \"403\": \"Forbidden\",\r\n    \"404\": \"Not Found\",\r\n    \"405\": \"Method Not Allowed\",\r\n    \"406\": \"Not Acceptable\",\r\n    \"407\": \"Proxy Authentication Required\",\r\n    \"408\": \"Request Timeout\",\r\n    \"409\": \"Conflict\",\r\n    \"410\": \"Gone\",\r\n    \"411\": \"Length Required\",\r\n    \"412\": \"Precondition Failed\",\r\n    \"413\": \"Payload Too Large\",\r\n    \"414\": \"URI Too Long\",\r\n    \"415\": \"Unsupported Media Type\",\r\n    \"416\": \"Range Not Satisfiable\",\r\n    \"417\": \"Expectation Failed\",\r\n    \"426\": \"Upgrade Required\",\r\n    \"500\": \"Internal Server Error\",\r\n    \"501\": \"Not Implemented\",\r\n    \"502\": \"Bad Gateway\",\r\n    \"503\": \"Service Unavailable\",\r\n    \"504\": \"Gateway Timeout\",\r\n    \"505\": \"HTTP Version Not Supported\"\r\n}\r\n\r\n\r\ndef get_company(**kwargs):\r\n    \"\"\"\r\n    params: \r\n\r\n    company = kwargs.get('Company', None)\r\n\r\n    connection_object = kwargs.get('Connection', None)\r\n\r\n    returns: \r\n\r\n    dict with company endpoint details on success\r\n\r\n    None on failure\r\n    \"\"\"\r\n    __me__ = \"get_company\"\r\n\r\n    # get the parameter data\r\n    company = kwargs.get('Company', None)\r\n    connection_object = kwargs.get('Connection', None)\r\n    task_name = kwargs.get('TaskName', \"Undefined\")\r\n\r\n    # no company provided in the parameters\r\n    if company is None:\r\n        logging.critical(\r\n            f\"{__me__}: Iteration[{iterationCounter}] no company provided.\")\r\n        return None\r\n    # no connection object provided in the parameters\r\n    if connection_object is None:\r\n        logging.critical(\r\n            f\"{__me__}: Iteration[{iterationCounter}] no connection object provided.\")\r\n        return None\r\n\r\n    # set the endpoint URL\r\n    endpoint = f\"https://api.DOMAIN/v1/customerconfiguration?name={company}\"\r\n    logging.debug(\r\n        f\"{__me__}: Iteration[{iterationCounter}] Company: {company} URL: {endpoint}\")\r\n\r\n    # connect to the endpoint\r\n    with connection_object.client.get(endpoint, name=task_name, catch_response=True) as response:\r\n        if response.content is None:\r\n            # the response body is empty so set it as an error and return\r\n            response.failure(\r\n                f\"Recevied no data from {endpoint} Status={str(response.status_code)}\")\r\n            return None\r\n        # retrieve the JSON response body\r\n        msg = json.loads(response.content.decode('utf-8'))\r\n        logging.debug(\r\n            f\"{__me__}: Iteration[{iterationCounter}] response = {msg}\")\r\n\r\n        # set the task name for the locust reporting\r\n        if task_name in msg:\r\n            response.locust_request_meta['name'] = task_name\r\n\r\n        if response.status_code == 200:\r\n            # we got a successful response\r\n            if msg is None:\r\n                # if there is no response body, mark this as a failure\r\n                response.failure(\r\n                    f\"Recevied no data [{str(response.status_code)}] Content: {str(msg)}\")\r\n                logging.error(\r\n                    f\"{__me__}: Iteration[{iterationCounter}] Iteration[{iterationCounter}] Recevied no data [{str(response.status_code)}] Content: {str(msg)}\")\r\n            else:\r\n                # we have a valid response body so mark it as success and return the JSON response\r\n                response.success()\r\n                return msg\r\n        else:\r\n            # we got a non 200 status code, so this is a failure.\r\n            response.failure(\r\n                f\"Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n            logging.error(\r\n                f\"{__me__}: Iteration[{iterationCounter}] Iteration[{iterationCounter}] Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n\r\n        return None\r\n\r\n\r\ndef do_user_sign_in(**kwargs):\r\n    \"\"\"\r\n    do_user_sign_in(**kwargs) - log in to the Fieldcast platform\r\n\r\n    params:\r\n\r\n    endpoint = kwargs.get('endpoint',None)\r\n\r\n    authId = kwargs.get('auth',None)\r\n\r\n    app = kwargs.get('app', None)\r\n\r\n    connection_object = kwargs.get('Connection', None)\r\n\r\n    returns: \r\n\r\n    on success, dict  with authentication details\r\n\r\n    on failure, returns None\r\n    \"\"\"\r\n    # set up local variables\r\n    __me__ = \"do_user_sign_in\"\r\n\r\n    # retrieve the function paraneters\r\n    endpoint = kwargs.get('Endpoint', None)\r\n    authId = kwargs.get('Auth', None)\r\n    app = kwargs.get('App', None)\r\n    connection_object = kwargs.get('Connection', None)\r\n    task_name = kwargs.get('TaskName', \"Undefined\")\r\n    user_name = kwargs.get('UserName', None)\r\n    password = kwargs.get('Password', None)\r\n\r\n    if endpoint is None:\r\n        logging.critical(f\"{__me__}: Parameter error: endpoint not specified\")\r\n        return None\r\n    if authId is None:\r\n        logging.critical(\r\n            f\"{__me__}: Parameter error: authorizationId not specified\")\r\n        return None\r\n    if app is None:\r\n        logging.critical(\r\n            f\"{__me__}: Parameter error: applicationId not specified\")\r\n        return None\r\n    if connection_object is None:\r\n        logging.critical(\r\n            f\"{__me__}: Parameter error: connection_object not specified\")\r\n        return None\r\n\r\n    #\r\n    # User sign in\r\n    #\r\n    if endpoint.rfind('/') < 0:\r\n        # endpoint doesn't end with a /\r\n        actual_url = endpoint+'/api/login'\r\n    else:\r\n        # endpoint ends with a /\r\n        actual_url = endpoint+'api/login'\r\n\r\n    headers = {\"user-agent\": \"locust\",\r\n               \"Authorization\": authId,\r\n               \"Content-Type\": \"application/json\",\r\n               \"Host\": endpoint.replace(\"https://\", \"\").replace(\"/\", \"\")}\r\n    data = {\"applicationId\": app,\r\n            \"loginId\": user_name,\r\n            \"password\": password,\r\n            \"device\": \"locust-load-test\",\r\n            \"metaData\": {\r\n                \"device\": {\r\n                    \"description\": \"Python\",\r\n                    \"type\": \"BROWSER\",\r\n                    \"name\": \"locust-load-test\"\r\n                }\r\n            }\r\n            }\r\n\r\n    logging.debug(\r\n        f\"{__me__}: Iteration[{iterationCounter}] Iteration[{iterationCounter}] POST headers = {headers}\")\r\n    logging.debug(\r\n        f\"{__me__}: Iteration[{iterationCounter}] Iteration[{iterationCounter}] POST body = {data}\")\r\n\r\n    try:\r\n        with connection_object.client.post(actual_url, headers=headers, json=data, name=task_name, catch_response=True) as response:\r\n            # response = requests.post(url, headers=headers, json=data)\r\n            msg = json.loads(response.content.decode('utf-8'))\r\n            logging.debug(\r\n                f\"{__me__}: Iteration[{iterationCounter}] Iteration[{iterationCounter}] response = {msg}\")\r\n\r\n            if task_name in msg:\r\n                response.locust_request_meta['name'] = task_name\r\n\r\n            if response.status_code <= 200:\r\n                if msg is None:\r\n                    response.failure(\r\n                        f\"Recevied no data [{str(response.status_code)}] Content: {str(msg)}\")\r\n                    logging.error(\r\n                        f\"{__me__}: Iteration[{iterationCounter}] Iteration[{iterationCounter}] Recevied no data [{str(response.status_code)}] Content: {str(msg)}\")\r\n                else:\r\n                    response.success()\r\n                    return msg\r\n            elif response.status_code == 400:\r\n                response.failure(\r\n                    f\"Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                logging.error(\r\n                    f\"{__me__}: Iteration[{iterationCounter}] Iteration[{iterationCounter}] Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                return None\r\n            elif response.status_code == 404:\r\n                response.failure(\r\n                    f\"Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                logging.error(\r\n                    f\"{__me__}: Iteration[{iterationCounter}] Iteration[{iterationCounter}] Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                return None\r\n    except Exception as e:\r\n        logging.error(\r\n            f\"{__me__}: Iteration[{iterationCounter}] data={data} error={str(e)}\")\r\n\r\n    if response.content is not None:\r\n        return json.loads(response.content.decode('utf-8'))\r\n    else:\r\n        return None\r\n\r\n\r\ndef get_current_user(**kwargs):\r\n    \"\"\"\r\n    params: \r\n    endpoint = kwargs.get('Endpoint',None)\r\n    authId = kwargs.get('Auth',None)\r\n    userid = kwargs.get('Userid', None)\r\n    connection_object = kwargs.get('Connection', None)\r\n    returns: dict with user details\r\n    \"\"\"\r\n    __me__ = \"get_current_user\"\r\n\r\n    endpoint = kwargs.get('Endpoint', None)\r\n    authId = kwargs.get('Auth', None)\r\n    userid = kwargs.get('Userid', None)\r\n    connection_object = kwargs.get('Connection', None)\r\n    task_name = kwargs.get('TaskName', \"Undefined\")\r\n\r\n    if endpoint is None:\r\n        raise AttributeError(\"Parameter error: endpoint not specified\")\r\n    if authId is None:\r\n        raise AttributeError(\"Parameter error: authId not specified\")\r\n    if userid is None:\r\n        raise AttributeError(\"Parameter error: userid not specified\")\r\n    if connection_object is None:\r\n        raise AttributeError(\r\n            \"Parameter error: connection_object not specified\")\r\n\r\n    host = re.sub('\\.co.*$', '.co', endpoint)\r\n    headers = {\"user-agent\": \"python-probe-v1.0\",\r\n               \"Authorization\": authId,\r\n               \"Content-Type\": \"application/json\",\r\n               \"Host\": host.replace(\"https://\", \"\")\r\n               }\r\n    data = {\r\n    }\r\n\r\n    logging.debug(\r\n        f\"{__me__}: Iteration[{iterationCounter}] POST headers = {headers}\")\r\n    logging.debug(\r\n        f\"{__me__}: Iteration[{iterationCounter}] POST body = {data}\")\r\n\r\n    try:\r\n        with connection_object.client.post(endpoint, headers=headers, json=data, name=task_name, catch_response=True) as response:\r\n            # response = requests.post(url, headers=headers, json=data)\r\n            msg = json.loads(response.content.decode('utf-8'))\r\n            logging.debug(\r\n                f\"{__me__}: Iteration[{iterationCounter}] response = {msg}\")\r\n            if task_name in msg:\r\n                response.locust_request_meta['name'] = task_name\r\n\r\n            if response.status_code <= 200:\r\n                if msg is None:\r\n                    response.failure(\r\n                        f\"Recevied no data [{str(response.status_code)}] Content: {str(msg)}\")\r\n                    logging.error(\r\n                        f\"{__me__}: Iteration[{iterationCounter}] Recevied no data [{str(response.status_code)}] Content: {str(msg)}\")\r\n                else:\r\n                    response.success()\r\n                    return msg\r\n            elif response.status_code == 400:\r\n                response.failure(\r\n                    f\"Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                logging.error(\r\n                    f\"{__me__}: Iteration[{iterationCounter}] Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                return None\r\n            elif response.status_code == 404:\r\n                response.failure(\r\n                    f\"Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                logging.error(\r\n                    f\"{__me__}: Iteration[{iterationCounter}] Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                return None\r\n    except Exception as e:\r\n        logging.error(f\"{__me__}: Iteration[{iterationCounter}] [ERROR]: {e}\")\r\n        logging.error(\r\n            f\"{__me__}: Iteration[{iterationCounter}] headers={headers}\")\r\n        logging.error(f\"{__me__}: Iteration[{iterationCounter}] data={data}\")\r\n\r\n\r\ndef get_latest_privacy_policy(**kwargs):\r\n    \"\"\"\r\n    params: \r\n    endpoint = kwargs.get('Endpoint',None)\r\n    authId = kwargs.get('Auth',None)\r\n    userid = kwargs.get('Userid', None)\r\n    connection_object = kwargs.get('Connection', None)\r\n    returns: dict with user details\r\n    \"\"\"\r\n    __me__ = \"get_latest_privacy_policy\"\r\n\r\n    endpoint = kwargs.get('Endpoint', None)\r\n    authId = kwargs.get('Auth', None)\r\n    connection_object = kwargs.get('Connection', None)\r\n    task_name = kwargs.get('TaskName', \"Undefined\")\r\n\r\n    if endpoint is None:\r\n        raise AttributeError(\"Parameter error: endpoint not specified\")\r\n    if authId is None:\r\n        raise AttributeError(\"Parameter error: authId not specified\")\r\n    if connection_object is None:\r\n        raise AttributeError(\r\n            \"Parameter error: connection_object not specified\")\r\n\r\n    host = re.sub('\\.co.*$', '.co', endpoint)\r\n    headers = {\"user-agent\": \"python-probe-v1.0\",\r\n               \"Authorization\": authId,\r\n               \"Content-Type\": \"application/json\",\r\n               \"Host\": host.replace(\"https://\", \"\")\r\n               }\r\n    data = {\r\n    }\r\n\r\n    logging.debug(\r\n        f\"{__me__}: Iteration[{iterationCounter}] POST headers = {headers}\")\r\n    logging.debug(\r\n        f\"{__me__}: Iteration[{iterationCounter}] POST body = {data}\")\r\n\r\n    try:\r\n        with connection_object.client.post(endpoint, headers=headers, json=data, name=task_name, catch_response=True) as response:\r\n            # response = requests.post(url, headers=headers, json=data)\r\n            msg = json.loads(response.content.decode('utf-8'))\r\n            logging.debug(\r\n                f\"{__me__}: Iteration[{iterationCounter}] response = {msg}\")\r\n            if task_name in msg:\r\n                response.locust_request_meta['name'] = task_name\r\n\r\n            if response.status_code <= 200:\r\n                if msg is None:\r\n                    response.failure(\r\n                        f\"Recevied no data [{str(response.status_code)}] Content: {str(msg)}\")\r\n                    logging.error(\r\n                        f\"{__me__}: Iteration[{iterationCounter}] Recevied no data [{str(response.status_code)}] Content: {str(msg)}\")\r\n                else:\r\n                    response.success()\r\n                    return msg\r\n            elif response.status_code == 400:\r\n                response.failure(\r\n                    f\"Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                logging.error(\r\n                    f\"{__me__}: Iteration[{iterationCounter}] Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                return None\r\n            elif response.status_code == 404:\r\n                response.failure(\r\n                    f\"Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                logging.error(\r\n                    f\"{__me__}: Iteration[{iterationCounter}] Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                return None\r\n    except Exception as e:\r\n        logging.error(f\"{__me__}: Iteration[{iterationCounter}] [ERROR]: {e}\")\r\n        logging.error(\r\n            f\"{__me__}: Iteration[{iterationCounter}] headers={headers}\")\r\n        logging.error(f\"{__me__}: Iteration[{iterationCounter}] data={data}\")\r\n\r\n\r\ndef do_upsert_eula(**kwargs):\r\n    \"\"\"\r\n    params: \r\n    endpoint = kwargs.get('Endpoint',None)\r\n    authId = kwargs.get('Auth',None)\r\n    userid = kwargs.get('Userid', None)\r\n    connection_object = kwargs.get('Connection', None)\r\n    returns: dict with user details\r\n    \"\"\"\r\n    __me__ = \"do_upsert_eula\"\r\n\r\n    endpoint = kwargs.get('Endpoint', None)\r\n    authId = kwargs.get('Auth', None)\r\n    userid = kwargs.get('Userid', None)\r\n    connection_object = kwargs.get('Connection', None)\r\n    task_name = kwargs.get('TaskName', \"Undefined\")\r\n\r\n    if endpoint is None:\r\n        raise AttributeError(\"Parameter error: endpoint not specified\")\r\n    if authId is None:\r\n        raise AttributeError(\"Parameter error: authId not specified\")\r\n    if userid is None:\r\n        raise AttributeError(\"Parameter error: userid not specified\")\r\n    if connection_object is None:\r\n        raise AttributeError(\r\n            \"Parameter error: connection_object not specified\")\r\n\r\n    host = re.sub('\\.co.*$', '.co', endpoint)\r\n    headers = {\"user-agent\": \"python-probe-v1.0\",\r\n               \"Authorization\": authId,\r\n               \"Content-Type\": \"application/json\",\r\n               \"Host\": host.replace(\"https://\", \"\")\r\n               }\r\n    data = {\r\n    }\r\n\r\n    logging.debug(\r\n        f\"{__me__}: Iteration[{iterationCounter}] POST headers = {headers}\")\r\n    logging.debug(\r\n        f\"{__me__}: Iteration[{iterationCounter}] POST body = {data}\")\r\n\r\n    try:\r\n        with connection_object.client.post(endpoint, headers=headers, json=data, name=task_name, catch_response=True) as response:\r\n            msg = json.loads(response.content.decode('utf-8'))\r\n            logging.debug(\r\n                f\"{__me__}: Iteration[{iterationCounter}] response = {msg}\")\r\n            if task_name in msg:\r\n                response.locust_request_meta['name'] = task_name\r\n\r\n            if response.status_code <= 200:\r\n                if msg is None:\r\n                    response.failure(\r\n                        f\"Recevied no data [{str(response.status_code)}] Content: {str(msg)}\")\r\n                    logging.error(\r\n                        f\"{__me__}: Iteration[{iterationCounter}] Recevied no data [{str(response.status_code)}] Content: {str(msg)}\")\r\n                else:\r\n                    response.success()\r\n                    return msg\r\n            if response.status_code == 400:\r\n                response.failure(\"Got unexpected response code: \" +\r\n                                 str(response.status_code) + \" Error: \" + str(msg))\r\n                logging.error(\r\n                    f\"{__me__}: Iteration[{iterationCounter}] Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                return None\r\n            elif response.status_code == 404:\r\n                response.failure(\"Got unexpected response code: \" +\r\n                                 str(response.status_code) + \" Error: \" + str(msg))\r\n                logging.error(\r\n                    f\"{__me__}: Iteration[{iterationCounter}] Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                return None\r\n    except Exception as e:\r\n        response.failure(f\"Error on connect: {e}\")\r\n        logging.error(f\"{__me__}: Iteration[{iterationCounter}] [ERROR]: {e}\")\r\n        logging.error(\r\n            f\"{__me__}: Iteration[{iterationCounter}] headers={headers}\")\r\n        logging.error(f\"{__me__}: Iteration[{iterationCounter}] data={data}\")\r\n\r\n    logging.error(\r\n        f\"{__me__}: Iteration[{iterationCounter}] status={response.status_code}\")\r\n    if response.status_code <= 200:\r\n        content = response.content\r\n        if content is None:\r\n            response.failure(f\"Recevied no data [{str(response.status_code)}]\")\r\n            return None\r\n        else:\r\n            content = json.loads(content.decode('utf-8'))\r\n        return content\r\n\r\n\r\ndef do_upsert_device(**kwargs):\r\n    \"\"\"\r\n    params: \r\n    endpoint = kwargs.get('Endpoint',None)\r\n    authId = kwargs.get('Auth',None)\r\n    userid = kwargs.get('Userid', None)\r\n    connection_object = kwargs.get('Connection', None)\r\n    returns: dict with user details\r\n    \"\"\"\r\n    __me__ = \"do_upsert_device\"\r\n\r\n    endpoint = kwargs.get('Endpoint', None)\r\n    authId = kwargs.get('Auth', None)\r\n    userid = kwargs.get('Userid', None)\r\n    connection_object = kwargs.get('Connection', None)\r\n    email = kwargs.get('Email', None)\r\n    first_name = kwargs.get('FirstName', None)\r\n    last_name = kwargs.get('LastName', None)\r\n    task_name = kwargs.get('TaskName', \"Undefined\")\r\n\r\n    if endpoint is None:\r\n        raise AttributeError(\"Parameter error: endpoint not specified\")\r\n    if authId is None:\r\n        raise AttributeError(\"Parameter error: authId not specified\")\r\n    if userid is None:\r\n        raise AttributeError(\"Parameter error: userid not specified\")\r\n    if connection_object is None:\r\n        raise AttributeError(\r\n            \"Parameter error: connection_object not specified\")\r\n\r\n    host = re.sub('\\.co.*$', '.co', endpoint)\r\n    headers = {\"user-agent\": \"python-probe-v1.0\",\r\n               \"Authorization\": authId,\r\n               \"Content-Type\": \"application/json\",\r\n               \"Host\": host.replace(\"https://\", \"\")\r\n               }\r\n    data = {\r\n    }\r\n\r\n    logging.debug(\r\n        f\"{__me__}: Iteration[{iterationCounter}] POST headers = {headers}\")\r\n    logging.debug(\r\n        f\"{__me__}: Iteration[{iterationCounter}] POST body = {data}\")\r\n\r\n    try:\r\n        with connection_object.client.post(endpoint, headers=headers, json=data, name=task_name, catch_response=True) as response:\r\n            msg = json.loads(response.content.decode('utf-8'))\r\n            logging.debug(\r\n                f\"{__me__}: Iteration[{iterationCounter}] response = {msg}\")\r\n            if task_name in msg:\r\n                response.locust_request_meta['name'] = task_name\r\n\r\n            if response.status_code <= 200:\r\n                if msg is None:\r\n                    response.failure(\r\n                        f\"Recevied no data [{str(response.status_code)}] Content: {str(msg)}\")\r\n                    logging.error(\r\n                        f\"{__me__}: Iteration[{iterationCounter}] Recevied no data [{str(response.status_code)}] Content: {str(msg)}\")\r\n                else:\r\n                    response.success()\r\n                    return msg\r\n            elif response.status_code == 400:\r\n                response.failure(\"Got unexpected response code: \" +\r\n                                 str(response.status_code) + \" Error: \" + str(msg))\r\n                logging.error(\r\n                    f\"{__me__}: Iteration[{iterationCounter}] Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                return None\r\n            elif response.status_code == 404:\r\n                response.failure(\"Got unexpected response code: \" +\r\n                                 str(response.status_code) + \" Error: \" + str(msg))\r\n                logging.error(\r\n                    f\"{__me__}: Iteration[{iterationCounter}] Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                return None\r\n    except Exception as e:\r\n        logging.error(f\"{__me__}: Iteration[{iterationCounter}] [ERROR]: {e}\")\r\n        logging.error(\r\n            f\"{__me__}: Iteration[{iterationCounter}] headers={headers}\")\r\n        logging.error(f\"{__me__}: Iteration[{iterationCounter}] data={data}\")\r\n\r\n\r\ndef get_podcast_list(**kwargs):\r\n\r\n    __me__ = \"get_podcast_list\"\r\n    endpoint = kwargs.get('endpoint', None)\r\n    authId = kwargs.get('auth', None)\r\n    connection_object = kwargs.get('Connection', None)\r\n    task_name = kwargs.get('TaskName', \"Undefined\")\r\n\r\n    if endpoint is None:\r\n        logging.critical(\r\n            f\"{__me__}: Iteration[{iterationCounter}] Parameter error: endpoint not specified\")\r\n        return None\r\n    if authId is None:\r\n        logging.critical(\r\n            f\"{__me__}: Iteration[{iterationCounter}] Parameter error: authorizationId not specified\")\r\n        return None\r\n\r\n    url = endpoint\r\n    host = re.sub('\\.co.*$', '.co', url)\r\n    headers = {\"user-agent\": \"python-probe-v1.0\",\r\n               \"Authorization\": authId,\r\n               \"Content-Type\": \"application/json\",\r\n               \"Host\": host.replace(\"https://\", \"\")\r\n               }\r\n    data = {\r\n    }\r\n\r\n    logging.debug(\r\n        f\"{__me__}: Iteration[{iterationCounter}] POST headers = {headers}\")\r\n    logging.debug(\r\n        f\"{__me__}: Iteration[{iterationCounter}] POST body = {data}\")\r\n\r\n    try:\r\n        with connection_object.client.post(endpoint, headers=headers, json=data, name=task_name, catch_response=True) as response:\r\n            msg = json.loads(response.content.decode('utf-8'))\r\n            msg = msg['data']\r\n            logging.debug(\r\n                f\"{__me__}: Iteration[{iterationCounter}] response = {msg}\")\r\n\r\n            if task_name in msg:\r\n                response.locust_request_meta['name'] = task_name\r\n\r\n            if response.status_code <= 200:\r\n                if msg is None:\r\n                    response.failure(\r\n                        f\"Recevied no data [{str(response.status_code)}] Content: {str(msg)}\")\r\n                    logging.error(\r\n                        f\"{__me__}: Iteration[{iterationCounter}] Recevied no data [{str(response.status_code)}] Content: {str(msg)}\")\r\n                else:\r\n                    response.success()\r\n                    return msg\r\n            elif response.status_code == 400:\r\n                response.failure(\"Got unexpected response code: \" +\r\n                                 str(response.status_code) + \" Error: \" + str(msg))\r\n                logging.error(\r\n                    f\"{__me__}: Iteration[{iterationCounter}] Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                return None\r\n            elif response.status_code == 404:\r\n                response.failure(\"Got unexpected response code: \" +\r\n                                 str(response.status_code) + \" Error: \" + str(msg))\r\n                logging.error(\r\n                    f\"{__me__}: Iteration[{iterationCounter}] Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                return None\r\n    except Exception as e:\r\n        response.failure(f\"Endpoint connection failure: {endpoint}: {e}\")\r\n        logging.error(f\"{__me__}: Iteration[{iterationCounter}] [ERROR]: {e}\")\r\n        logging.error(\r\n            f\"{__me__}: Iteration[{iterationCounter}] headers={headers}\")\r\n        logging.error(f\"{__me__}: Iteration[{iterationCounter}] data={data}\")\r\n\r\n\r\ndef get_episodes_from_podcast(**kwargs):\r\n    \"\"\" params: endpoint: url to send request to\r\n        authId: bearer token\r\n        podcast: podcast id\r\n    \"\"\"\r\n    __me__ = \"get_episodes_from_podcast\"\r\n    endpoint = kwargs.get('endpoint', None)\r\n    authId = kwargs.get('auth', None)\r\n    podcast_id = kwargs.get('podcast', None)\r\n    connection_object = kwargs.get('Connection', None)\r\n    task_name = kwargs.get('TaskName', \"Undefined\")\r\n\r\n    if endpoint is None:\r\n        logging.critical(\"Parameter error: endpoint not specified\")\r\n        return None\r\n    if authId is None:\r\n        logging.critical(\"Parameter error: authorizationId not specified\")\r\n        return None\r\n    if podcast_id is None:\r\n        logging.critical(\"Parameter error: podcast not specified\")\r\n        return None\r\n\r\n    host = re.sub('\\.co.*$', '.co', endpoint)\r\n    headers = {\"user-agent\": \"python-probe-v1.0\",\r\n               \"Authorization\": authId,\r\n               \"Content-Type\": \"application/json\",\r\n               \"Host\": host.replace(\"https://\", \"\")\r\n               }\r\n    data = {\r\n        \"operationName\": \"ListEpisodesForPodcastOrderByNumber\",\r\n        \"variables\": {\r\n            \"episodePodcastId\": podcast_id,\r\n            \"offset\": 0\r\n        },\r\n    }\r\n\r\n    logging.debug(\r\n        f\"{__me__}: Iteration[{iterationCounter}] POST headers = {headers}\")\r\n    logging.debug(\r\n        f\"{__me__}: Iteration[{iterationCounter}] POST body = {data}\")\r\n\r\n    try:\r\n        with connection_object.client.post(endpoint, headers=headers, json=data, name=task_name, catch_response=True) as response:\r\n            msg = json.loads(response.content.decode('utf-8'))\r\n            msg = msg['data']\r\n            logging.debug(\r\n                f\"{__me__}: Iteration[{iterationCounter}] response = {msg}\")\r\n            if task_name in msg:\r\n                response.locust_request_meta['name'] = task_name\r\n\r\n            if response.status_code <= 200:\r\n                if msg is None:\r\n                    response.failure(\r\n                        f\"Recevied no data [{str(response.status_code)}] Content: {str(msg)}\")\r\n                    logging.error(\r\n                        f\"{__me__}: Iteration[{iterationCounter}] Recevied no data [{str(response.status_code)}] Content: {str(msg)}\")\r\n                else:\r\n                    response.success()\r\n                    return msg\r\n            elif response.status_code == 400:\r\n                response.failure(\"Got unexpected response code: \" +\r\n                                 str(response.status_code) + \" Error: \" + str(msg))\r\n                logging.error(\r\n                    f\"{__me__}: Iteration[{iterationCounter}] Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                return None\r\n            elif response.status_code == 404:\r\n                response.failure(\"Got unexpected response code: \" +\r\n                                 str(response.status_code) + \" Error: \" + str(msg))\r\n                logging.error(\r\n                    f\"{__me__}: Iteration[{iterationCounter}] Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                return None\r\n    except Exception as e:\r\n        logging.error(f\"{__me__}: Iteration[{iterationCounter}] [ERROR]: {e}\")\r\n        logging.error(\r\n            f\"{__me__}: Iteration[{iterationCounter}] headers={headers}\")\r\n        logging.error(f\"{__me__}: Iteration[{iterationCounter}] data={data}\")\r\n\r\n\r\ndef get_episode_by_id(**kwargs):\r\n    \"\"\" params: endpoint: url to send request to\r\n        authId: bearer token\r\n        podcast: podcast id\r\n    \"\"\"\r\n    __me__ = \"get_episodes_from_podcast\"\r\n    endpoint = kwargs.get('endpoint', None)\r\n    authId = kwargs.get('auth', None)\r\n    podcast_id = kwargs.get('podcast', None)\r\n    connection_object = kwargs.get('Connection', None)\r\n    task_name = kwargs.get('TaskName', \"Undefined\")\r\n\r\n    if endpoint is None:\r\n        logging.critical(\"Parameter error: endpoint not specified\")\r\n        return None\r\n    if authId is None:\r\n        logging.critical(\"Parameter error: authorizationId not specified\")\r\n        return None\r\n    if podcast_id is None:\r\n        logging.critical(\"Parameter error: podcast not specified\")\r\n        return None\r\n\r\n    host = re.sub('\\.co.*$', '.co', endpoint)\r\n    headers = {\"user-agent\": \"python-probe-v1.0\",\r\n               \"Authorization\": authId,\r\n               \"Content-Type\": \"application/json\",\r\n               \"Host\": host.replace(\"https://\", \"\")\r\n               }\r\n    data = {\r\n        \"operationName\": \"ListEpisodesForPodcastOrderByNumber\",\r\n        \"variables\": {\r\n            \"episodePodcastId\": podcast_id,\r\n            \"offset\": 0\r\n        },\r\n    }\r\n\r\n    logging.debug(\r\n        f\"{__me__}: Iteration[{iterationCounter}] POST headers = {headers}\")\r\n    logging.debug(\r\n        f\"{__me__}: Iteration[{iterationCounter}] POST body = {data}\")\r\n\r\n    try:\r\n        with connection_object.client.post(endpoint, headers=headers, json=data, name=task_name, catch_response=True) as response:\r\n            msg = json.loads(response.content.decode('utf-8'))\r\n            msg = msg['data']\r\n            logging.debug(\r\n                f\"{__me__}: Iteration[{iterationCounter}] response = {msg}\")\r\n            if task_name in msg:\r\n                response.locust_request_meta['name'] = task_name\r\n\r\n            if response.status_code <= 200:\r\n                if msg is None:\r\n                    response.failure(\r\n                        f\"Recevied no data [{str(response.status_code)}] Content: {str(msg)}\")\r\n                    logging.error(\r\n                        f\"{__me__}: Iteration[{iterationCounter}] Recevied no data [{str(response.status_code)}] Content: {str(msg)}\")\r\n                else:\r\n                    response.success()\r\n                    return msg\r\n            elif response.status_code == 400:\r\n                response.failure(\"Got unexpected response code: \" +\r\n                                 str(response.status_code) + \" Error: \" + str(msg))\r\n                logging.error(\r\n                    f\"{__me__}: Iteration[{iterationCounter}] Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                return None\r\n            elif response.status_code == 404:\r\n                response.failure(\"Got unexpected response code: \" +\r\n                                 str(response.status_code) + \" Error: \" + str(msg))\r\n                logging.error(\r\n                    f\"{__me__}: Iteration[{iterationCounter}] Got unexpected response code: [{str(response.status_code)}] Error: {str(msg)}\")\r\n                return None\r\n    except Exception as e:\r\n        logging.error(f\"{__me__}: Iteration[{iterationCounter}] [ERROR]: {e}\")\r\n        logging.error(\r\n            f\"{__me__}: Iteration[{iterationCounter}] headers={headers}\")\r\n        logging.error(f\"{__me__}: Iteration[{iterationCounter}] data={data}\")\r\n\r\n\r\ndef get_episode_mp3(**kwargs):\r\n    \"\"\" params: endpoint: url to send request to\r\n        authId: bearer token\r\n        episode: path to the audio object\r\n    \"\"\"\r\n    __me__ = \"get_episode_mp3\"\r\n\r\n    endpoint = kwargs.get('endpoint', None)\r\n    authId = kwargs.get('auth', None)\r\n    episode_path = kwargs.get('episode', None)\r\n    episode_id = kwargs.get('episode_id', None)\r\n    token = kwargs.get('token', None)\r\n    connection_object = kwargs.get('Connection', None)\r\n    task_name = kwargs.get('TaskName', \"Undefined\")\r\n\r\n    if endpoint is None:\r\n        logging.critical(\"Parameter error: endpoint not specified\")\r\n        return None\r\n    if authId is None:\r\n        logging.critical(\"Parameter error: authorizationId not specified\")\r\n        return None\r\n    if episode_path is None:\r\n        logging.critical(\"Parameter error: episode not specified\")\r\n        return None\r\n    if episode_id is None:\r\n        logging.critical(\"Parameter error: episode_id not specified\")\r\n        return None\r\n\r\n    host = re.sub('\\.co.*$', '.co', endpoint)\r\n    headers = {\"user-agent\": \"python-probe-v1.0\",\r\n               \"Authorization\": authId,\r\n               \"Connection\": \"Keep-Alive\",\r\n               \"Content-Type\": \"audio/mpeg\",\r\n               \"Accept-Encoding\": \"gzip, deflate\",\r\n               \"Host\": host.replace(\"https://\", \"\")\r\n               }\r\n\r\n    target = f\"{endpoint}{episode_path}?apiVersion=1&type=episode&episodeId={episode_id}&role=ROLE&jwt={token}\"\r\n    logging.debug(f\"{__me__}: Iteration[{iterationCounter}] {target}\")\r\n\r\n    try:\r\n        with connection_object.client.get(target, headers=headers, name=task_name, stream=True, catch_response=True) as response:\r\n\r\n            logging.debug(\r\n                f\"{__me__}: Iteration[{iterationCounter}] length of content is {len(response.content)}\")\r\n            response.locust_request_meta['name'] = task_name\r\n\r\n            if response.status_code <= 200:\r\n                if len(response.content) <= 0:\r\n                    response.failure(\r\n                        f\"Recevied no data [{str(response.status_code)}]\")\r\n                    logging.error(\r\n                        f\"{__me__}: Iteration[{iterationCounter}] Recevied no data [{str(response.status_code)}] Endpoint: {endpoint} Episode Id: {episode_id} Episode Path: {episode_path} \")\r\n                else:\r\n                    logging.debug(\r\n                        f\"{__me__}: Iteration[{iterationCounter}] Recevied {len(response.content)}\")\r\n                    response.success()\r\n            else:\r\n                response.failure(\r\n                    f\"Got unexpected response code: [{str(response.status_code)}={http_status_codes[str(response.status_code)]}] Endpoint: {endpoint} Episode Path: {episode_path} Episode Id: {episode_id}\")\r\n                logging.error(\r\n                    f\"{__me__}: Iteration[{iterationCounter}] Got unexpected response code: [{str(response.status_code)}={http_status_codes[str(response.status_code)]}] Target: {target}\")\r\n                return None\r\n    except Exception as e:\r\n        logging.error(\r\n            f\"{__me__}: Iteration[{iterationCounter}] [ERROR]: {e} retrieving {target}\")\r\n        logging.error(\r\n            f\"{__me__}: Iteration[{iterationCounter}] headers={headers}\")\r\n        logging.error(f\"{__me__}: Iteration[{iterationCounter}] data={target}\")\r\n    finally:\r\n        response = \"\"\r\n\r\n    return None\r\n\r\n\r\ndef error406(**kwargs):\r\n    \"\"\"\r\n    error406(**kwargs) - use  a fake endpoint to generate a 406 error from the ALB\r\n\r\n    Success is a  406 status code.\r\n    Failure is a non-406 status code\r\n\r\n    params: error406(Connection=connection_object, TaskName=string)\r\n\r\n    returns: None\r\n    \"\"\"\r\n    __me__ = \"error406\"\r\n\r\n    connection_object = kwargs.get('Connection', None)\r\n    task_name = kwargs.get('TaskName', \"Undefined\")\r\n\r\n    if connection_object is None:\r\n        logging.critical(\r\n            f\"{__me__}: Iteration[{iterationCounter}] no  connection supplied.\")\r\n        return None\r\n\r\n    endpoint = f\"https://query.DOMAIN/test\"\r\n    with connection_object.client.get(endpoint, name=task_name, catch_response=True) as response:\r\n        response.locust_request_meta['name'] = task_name\r\n\r\n        if response.status_code == 406:\r\n            response.success()\r\n        else:\r\n            response.failure(\r\n                f\"{__me__}: Got unexpected response code: [{str(response.status_code)}={http_status_codes[str(response.status_code)]}]\")\r\n\r\n    return None\r\n\r\n\r\ndef choose_user():\r\n    \"\"\"\r\n    choose_user() - randomly select a user from the global credentials list\r\n\r\n    params: none\r\n\r\n    returns: user_name, password\r\n    \"\"\"\r\n    # global credential list\r\n    global credentials\r\n\r\n    # if the global credentials list is empty, load it\r\n    if not credentials:\r\n        load_credentials()\r\n\r\n    # randomly select a user from the credentials list\r\n    selected_user = randrange(0, len(credentials), 1)\r\n    # log the selected user information\r\n    logging.debug(\r\n        f\"choose_user: random {selected_user} = {credentials[selected_user]}\")\r\n    # split the value into a username and password\r\n    user_name, password = credentials[selected_user].split(',')\r\n    # return the user_name and password to the caller\r\n    return user_name, password\r\n\r\n\r\ndef open_csv():\r\n    \"\"\"\r\n    open_csv(): open the iteration_csv file and create the CSV writer object\r\n\r\n    params: none\r\n\r\n    returs: none (sets value of two global variables)\r\n    \"\"\"\r\n    global iteration_fh\r\n    global iteration_writer\r\n\r\n    if wrote_header is True:\r\n        logging.debug(\"open_csv: opening in append mode\")\r\n        iteration_fh = open(iteration_csv, 'a')\r\n    else:\r\n        logging.debug(\"open_csv: opening in write mode\")\r\n        iteration_fh = open(iteration_csv, 'w')\r\n\r\n    iteration_writer = csv.writer(iteration_fh)\r\n\r\n    return None\r\n\r\n\r\ndef write_csv(**kwargs):\r\n    \"\"\"\r\n    write_csv(Data=list) - writes list to CSV file using CSV writer object\r\n\r\n    params: list item to write to CSV\r\n\r\n    returns: number of bytes written\r\n    \"\"\"\r\n    data = kwargs.get('Data', None)\r\n\r\n    if data is not None:\r\n        if iteration_fh is None:\r\n            logging.debug(\"write_csv: no file handle\")\r\n            open_csv()\r\n        iteration_writer.writerow(data)\r\n        logging.debug(f\"write_csv: wrote {str(sys.getsizeof(data))} bytes\")\r\n\r\n    return str(sys.getsizeof(data))\r\n\r\n\r\ndef write_csv_header(**kwargs):\r\n    \"\"\"\r\n    write_csv_header(**kwargs): write the CSV file header\r\n\r\n    params: none\r\n\r\n    returns: None sets global variable wrote_header and iteration_csv_fields\r\n    \"\"\"\r\n    global wrote_header             # sets to True before return\r\n    global iteration_csv_fields     # number of fields in the output\r\n\r\n    if wrote_header is True:\r\n        # If we have written the header already, return\r\n        return None\r\n\r\n    # define list to write to the CSV file.  This is defined to\r\n    # match the order the tasks are called.  Changing the order of the\r\n    # tasks will require the headers to be adjusted.\r\n    iteration_pass = []\r\n    iteration_pass.append(\"Hostname\")\r\n    iteration_pass.append(\"Email Address\")\r\n    iteration_pass.append(\"Iteration\")\r\n    iteration_pass.append(\"Company Configuration\")\r\n    iteration_pass.append(\"User Sign In\")\r\n    iteration_pass.append(\"Get Current User Details\")\r\n    iteration_pass.append(\"Get Latest Privacy Policy\")\r\n    iteration_pass.append(\"Upsert EULA\")\r\n    iteration_pass.append(\"Upsert Device\")\r\n    iteration_pass.append(\"Get/Select Podcast\")\r\n    iteration_pass.append(\"Get/Select Episode\")\r\n    iteration_pass.append(\"Get Audio File\")\r\n    iteration_pass.append(\"Total Time\")\r\n\r\n    # set the value of the global variable iteration_csv_fields\r\n    iteration_csv_fields = len(iteration_pass)\r\n    # write the header to the CSV\r\n    write_csv(Data=iteration_pass)\r\n    # set the wrote_header flag\r\n    wrote_header = True\r\n\r\n    return None\r\n\r\n\r\ndef load_credentials():\r\n    \"\"\"\r\n    load_credentials - load credentials file into a list\r\n\r\n    credentials file is defined as a global varable\r\n\r\n    credentials list is a global variable\r\n\r\n    params: none\r\n\r\n    returns: number of credentials loaded\r\n    \"\"\"\r\n    global credentials      # global list storing the credentials\r\n\r\n    logging.debug(f\"load_credentials: loading credentials data into list\")\r\n    with open(credentials_file) as f:\r\n        credentials = f.read().splitlines()\r\n\r\n    return len(credentials)\r\n\r\n\r\n@events.test_start.add_listener\r\ndef on_test_start(**kwargs):\r\n\r\n    global maxIterations\r\n    global iterationCounter\r\n    global credentials\r\n    global node\r\n\r\n    #iteration_pass = []\r\n    # print(\"on_test_start\")\r\n    iterationCounter = 0\r\n    envMaxIterations = os.getenv(\"MAX_ITERATIONS\")\r\n    if envMaxIterations is None:\r\n        maxIterations = 0\r\n        logging.warning(\r\n            f\"maxIterations is not defined in the environment.  Ignoring iteration count.\")\r\n    else:\r\n        maxIterations = int(envMaxIterations)\r\n        logging.info(f\"maxIterations is set to {maxIterations}\")\r\n\r\n    # Check to see if the CSV writer open is defined.  If not, configure it\r\n    if iteration_fh is None:\r\n        open_csv()\r\n        write_csv_header()\r\n        is_worker = False\r\n\r\n    # Prepare the credentials\r\n    load_credentials()\r\n\r\n\r\n@events.test_stop.add_listener\r\ndef on_test_stop(**kwargs):\r\n\r\n    logging.info(\"done\")\r\n    if iteration_fh is not None:\r\n        iteration_fh.close()\r\n    sys.exit(0)\r\n\r\n\r\ndef add_blanks(**kwargs):\r\n    \"\"\"\r\n    add_blanks (**kwargs): add additional fields to the provided list\r\n\r\n    params: Data=list, Length=target list length\r\n\r\n    returns: list with added empty items\r\n    \"\"\"\r\n    data = kwargs.get('Data', None)\r\n    length = kwargs.get('Length', None)\r\n\r\n    if data is None:\r\n        logging.error(\"add_blanks: no data passed in to process\")\r\n        return data\r\n\r\n    while len(data) <= length:\r\n        data.append(\"\")\r\n\r\n    return data\r\n\r\n\r\nclass UserBehavior(SequentialTaskSet):\r\n\r\n    iteration_pass = []\r\n    iteration_start = 0.0\r\n    user_name = \"\"\r\n    password = \"\"\r\n    config = {}\r\n    auth_token = \"\"\r\n    user_id = \"\"\r\n    auth_details = {}\r\n    selected_podcast_id = 0\r\n    selected_episode_id = 0\r\n\r\n    def on_start(self):\r\n\r\n        global iterationCounter\r\n\r\n        if is_worker is True:\r\n            if iteration_fh is None:\r\n                logging.debug(\r\n                    \"on_start: worker task: no CSV file handle.  opening file\")\r\n                open_csv()\r\n                write_csv_header()\r\n\r\n        if not credentials:\r\n            load_credentials()\r\n\r\n        self.iteration_start = time.time()\r\n        iterationCounter = iterationCounter + 1\r\n        self.iteration_pass = []\r\n        #print(f\"on_start: IterationCount = {iterationCounter}\")\r\n        self.user_name, self.password = choose_user()\r\n        self.iteration_pass.append(node)\r\n        self.iteration_pass.append(self.user_name)\r\n        self.iteration_pass.append(iterationCounter)\r\n        # print(self.iteration_pass)\r\n        # print(\r\n        #     f\"on_start: iteration_detail list is {str(sys.getsizeof(iteration_detail))} bytes\")\r\n\r\n    def on_stop(self):\r\n        \"\"\"\r\n        on_stop - execute steps when the user task is stopped\r\n\r\n        params: None\r\n\r\n        returns: none\r\n        \"\"\"\r\n        # global iteration_detail\r\n        global iteration_fh\r\n\r\n        # print(\"on_stop)\")\r\n        # take the current interaction data and add it to the entire set\r\n        end_time = time.time()\r\n        iteration_time = end_time - self.iteration_start\r\n        print(\r\n            f\"start = {self.iteration_start} end = {end_time} diff = {end_time - self.iteration_start}\")\r\n        logging.info(\r\n            f\"on_stop: Iteration[{iterationCounter}] total time is {iteration_time:.2f}s {iteration_time*1000:.2f}ms  (includes random wait time)\")\r\n        if len(self.iteration_pass) < iteration_csv_fields:\r\n            self.iteration_pass = add_blanks(\r\n                Data=self.iteration_pass, Length=iteration_csv_fields - 1)\r\n\r\n        self.iteration_pass.append(iteration_time*1000)\r\n        # iteration_detail.append(self.iteration_pass)\r\n        if iteration_fh is None:\r\n            logging.debug(\r\n                \"on_stop: worker task: no CSV file handle.  opening file\")\r\n            open_csv()\r\n            write_csv_header()\r\n        write_csv(Data=self.iteration_pass)\r\n        if is_worker is True:\r\n            logging.debug(\"on_stop: worker task complete: closing CSV file\")\r\n            iteration_fh.close()\r\n            iteration_fh = None\r\n\r\n        # logging.debug(\r\n        #     f\"on_stop: iteration_detail list is {str(sys.getsizeof(iteration_detail))} bytes\")\r\n        #print(f\"stop: {self.iteration_pass}\")\r\n\r\n    @task()\r\n    def task1(self):\r\n        #global config\r\n\r\n        stime = time.time()\r\n        self.config = get_company(Connection=self, Company=\"LoadTest\",\r\n                                  TaskName=\"Task 1: Company Configuration\")\r\n\r\n        end_time = time.time()\r\n        iteration_time = end_time - stime\r\n\r\n        if self.config is None:\r\n            iteration_time = -1\r\n            self.iteration_pass.append(iteration_time)\r\n            logging.error(\r\n            f\"Company Configuration: Iteration[{iterationCounter}] returned no company configuration information.  skipping user.\")\r\n            self.interrupt()\r\n        else:\r\n            logging.info(\r\n                f\"Company Configuration: Iteration[{iterationCounter}] time is {iteration_time:.2f}s {iteration_time*1000:.2f}ms\")\r\n            # Add the time in milliseconds\r\n            self.iteration_pass.append(iteration_time*1000)\r\n\r\n    @task()\r\n    def task2(self):\r\n\r\n        # global auth_token\r\n        # global user_id\r\n        # global auth_details\r\n\r\n        stime = time.time()\r\n        response = do_user_sign_in(Connection=self, Endpoint=self.config['authEndpoint'],\r\n                                   Auth=self.config[\"authorizationId\"],\r\n                                   App=self.config[\"applicationId\"],\r\n                                   TaskName=\"Task 2: User Sign In\",\r\n                                   UserName=self.user_name,\r\n                                   Password=self.password)\r\n\r\n        if response is None:\r\n            self.auth_token = None\r\n        else:\r\n            self.auth_token = response['token']\r\n            self.user_id = response['user']['id']\r\n            self.auth_details = response\r\n\r\n        end_time = time.time()\r\n        iteration_time = end_time - stime\r\n        logging.info(\r\n            f\"User Sign In: Iteration[{iterationCounter}] time is {iteration_time:.2f}s {iteration_time*1000:.2f}ms\")\r\n        # Add the time in milliseconds\r\n        self.iteration_pass.append(iteration_time * 1000)\r\n\r\n    @task()\r\n    def task3(self):\r\n        if self.auth_token is not None:\r\n            stime = time.time()\r\n            response = get_current_user(Connection=self, Endpoint=self.config['apiEndpoint'],\r\n                                        Auth=f\"Bearer {self.auth_token}\",\r\n                                        Userid=self.user_id,\r\n                                        TaskName=\"Task 3: Get Current User Details\")\r\n            logging.debug(\r\n                f\"Iteration[{iterationCounter}] user details: {response}\")\r\n            end_time = time.time()\r\n            iteration_time = end_time - stime\r\n            logging.info(\r\n                f\"Get Current User Details: Iteration[{iterationCounter}] time is {iteration_time:.2f}s {iteration_time*1000:.2f}ms\")\r\n            # Add the time in milliseconds\r\n            self.iteration_pass.append(iteration_time * 1000)\r\n        else:\r\n            logging.error(\r\n                \"Task3: Iteration[{iterationCounter}] [ERROR] no auth_token\")\r\n\r\n    @task()\r\n    def task4(self):\r\n        if self.auth_token is not None:\r\n            stime = time.time()\r\n            response = get_latest_privacy_policy(Connection=self,\r\n                                                 Endpoint=self.config['apiEndpoint'],\r\n                                                 Auth=f\"Bearer {self.auth_token}\",\r\n                                                 TaskName=\"Task 4: Get Latest Privacy Policy\")\r\n            logging.debug(\r\n                f\"Iteration[{iterationCounter}] lastest privacy policy: {response}\")\r\n            end_time = time.time()\r\n            iteration_time = end_time - stime\r\n            logging.info(\r\n                f\"Get Latest Privacy Policy: Iteration[{iterationCounter}] time is {iteration_time:.2f}s {iteration_time*1000:.2f}ms\")\r\n            # Add the time in milliseconds\r\n            self.iteration_pass.append(iteration_time * 1000)\r\n        else:\r\n            logging.error(\r\n                \"Task4: Iteration[{iterationCounter}] [ERROR] no auth_token\")\r\n\r\n    @task()\r\n    def task5(self):\r\n        if self.auth_token is not None:\r\n            stime = time.time()\r\n            response = do_upsert_eula(Connection=self, Endpoint=self.config['apiEndpoint'],\r\n                                      Auth=f\"Bearer {self.auth_token}\",\r\n                                      Userid=self.user_id,\r\n                                      TaskName=\"Task 5: Upsert EULA\")\r\n            if response is not None:\r\n                logging.debug(\r\n                    f\"Upsert EULA: Iteration[{iterationCounter}] upsert_eula: {response}\")\r\n            else:\r\n                logging.error(\r\n                    f\"Upsert EULA: Iteration[{iterationCounter}] upsert_eula: no data from endpoint.\")\r\n\r\n            end_time = time.time()\r\n            iteration_time = end_time - stime\r\n            self.iteration_pass.append(iteration_time * 1000)\r\n            logging.info(\r\n                f\"Upsert EULA: Iteration[{iterationCounter}] time is {iteration_time:.2f}s {iteration_time*1000:.2f}ms\")\r\n        else:\r\n            logging.error(\r\n                \"Upsert EULA: Iteration[{iterationCounter}] [ERROR] no auth_token\")\r\n\r\n    @task()\r\n    def task6(self):\r\n        if self.auth_token is not None:\r\n            stime = time.time()\r\n            response = do_upsert_device(Connection=self, Endpoint=self.config['apiEndpoint'],\r\n                                        Auth=f\"Bearer {self.auth_token}\",\r\n                                        Userid=self.user_id,\r\n                                        Email=self.auth_details['user']['email'],\r\n                                        FirstName=self.auth_details['user']['firstName'],\r\n                                        LastName=self.auth_details['user']['lastName'],\r\n                                        TaskName=\"Task 6: Upsert Device Details\")\r\n\r\n            logging.debug(\r\n                f\"Upsert Device: Iteration[{iterationCounter}] upsert_device: {response}\")\r\n            end_time = time.time()\r\n            iteration_time = end_time - stime\r\n            self.iteration_pass.append(iteration_time * 1000)\r\n            logging.info(\r\n                f\"Upsert Device: Iteration[{iterationCounter}] time is {iteration_time:.2f}s {iteration_time*1000:.2f}ms\")\r\n        else:\r\n            logging.error(\r\n                \"Upsert Device: Iteration[{iterationCounter}] [ERROR] no auth_token\")\r\n\r\n    @task()\r\n    def task7(self):\r\n\r\n        #global selected_podcast_id\r\n        stime = time.time()\r\n        response = get_podcast_list(Connection=self, endpoint=self.config['apiEndpoint'],\r\n                                    auth=f\"Bearer {self.auth_token}\",\r\n                                    TaskName=\"Task 7: Get Podcast List\")\r\n\r\n        if response is not None:\r\n            podcast_list = response['Podcasts']\r\n            selected_podcast = randrange(0, len(podcast_list), 1)\r\n            logging.debug(\r\n                f\"Iteration[{iterationCounter}] Selected podcast: {selected_podcast} of possible {len(podcast_list)}\")\r\n            logging.debug(\r\n                f\"Iteration[{iterationCounter}] Selected podcast details: {podcast_list[selected_podcast]}\")\r\n            self.selected_podcast_id = podcast_list[selected_podcast]['id']\r\n            logging.debug(\r\n                f\"Iteration[{iterationCounter}] Selected podcast id: {self.selected_podcast_id}\")\r\n        else:\r\n            logging.error(\r\n                f\"Iteration[{iterationCounter}] Podcast list is empty.\")\r\n\r\n        end_time = time.time()\r\n        iteration_time = end_time - stime\r\n        self.iteration_pass.append(iteration_time * 1000)\r\n        logging.info(\r\n            f\"Get/Select Podcast: Iteration[{iterationCounter}] time is {iteration_time:.2f}s {iteration_time*1000:.2f}ms\")\r\n\r\n    @task()\r\n    def task8(self):\r\n\r\n        #global selected_episode_id\r\n        #global selected_episode_object\r\n\r\n        stime = time.time()\r\n\r\n        response = get_episodes_from_podcast(Connection=self, endpoint=self.config['apiEndpoint'],\r\n                                             auth=f\"Bearer {self.auth_token}\",\r\n                                             podcast=self.selected_podcast_id,\r\n                                             TaskName=\"Task 8: Get Episodes for Podcast\")\r\n        # Select a random episode\r\n\r\n        if response is not None:\r\n            episode_list = response['Episodes']\r\n            selected_episode = randrange(0, len(episode_list), 1)\r\n            self.selected_episode_id = episode_list[selected_episode]['id']\r\n            logging.debug(\r\n                f\"Iteration[{iterationCounter}] Selected episode: {selected_episode} of possible {len(episode_list)}\")\r\n            logging.debug(\r\n                f\"Iteration[{iterationCounter}] Selected episode details: {episode_list[selected_episode]}\")\r\n            self.selected_episode_object = episode_list[selected_episode]['objectPath']\r\n            logging.debug(\r\n                f\"Iteration[{iterationCounter}] selected episode id = {self.selected_episode_id}\")\r\n            logging.debug(\r\n                f\"Iteration[{iterationCounter}] selected episode object = {self.selected_episode_object}\")\r\n        else:\r\n            logging.error(\r\n                f\"Iteration[{iterationCounter}] selected_podcast_id is None.\")\r\n\r\n        end_time = time.time()\r\n        iteration_time = end_time - stime\r\n        self.iteration_pass.append(iteration_time * 1000)\r\n        logging.info(\r\n            f\"Get/Select Episode: Iteration[{iterationCounter}] time is {iteration_time:.2f}s {iteration_time*1000:.2f}ms\")\r\n\r\n    @task()\r\n    def task9(self):\r\n\r\n        if self.selected_episode_id is None:\r\n            logging.error(\r\n                f\"Iteration[{iterationCounter}] selected_episode_id is None.\")\r\n            return\r\n\r\n        stime = time.time()\r\n        get_episode_mp3(Connection=self, endpoint=self.config['cdnUrl'],\r\n                        auth=f\"Bearer {self.auth_token}\",\r\n                        token=self.auth_token,\r\n                        episode=self.selected_episode_object,\r\n                        episode_id=self.selected_episode_id,\r\n                        TaskName=\"Task 9: Get Episode Audio File\")\r\n        end_time = time.time()\r\n        iteration_time = end_time - stime\r\n        self.iteration_pass.append(iteration_time * 1000)\r\n        logging.info(\r\n            f\"Download Episode Audio: Iteration[{iterationCounter}] time is {iteration_time:.2f}s {iteration_time*1000:.2f}ms\")\r\n\r\n    # @task()\r\n    # def task10(self):\r\n    #     get_additional_content(Connection=self, endpoint=config['cdnUrl'],\r\n    #                         auth=f\"Bearer {auth_token}\",\r\n    #                         token=auth_token,\r\n    #                         episode=selected_episode_object,\r\n    #                         episode_id=selected_episode_id,\r\n    #                     TaskName=\"Task 10: Get Additional Content\")\r\n\r\n    @task()\r\n    def task99(self):\r\n        \"\"\"\r\n        task99 - check maximum iterations and interrupt the user\r\n        \"\"\"\r\n\r\n        if maxIterations > 0:\r\n            if iterationCounter > maxIterations:\r\n                logging.info(\r\n                    f\"Reached threshold: {iterationCounter}/{maxIterations}\")\r\n                self.on_stop(self)\r\n                #raise StopLocust()\r\n\r\n        self.interrupt()\r\n\r\n    # ---- END OF TASKS -----\r\n\r\n\r\nclass User(HttpUser):\r\n    tasks = [UserBehavior]\r\n    wait_time = between(1, 5)\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1407/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1407/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1399", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1399/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1399/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1399/events", "html_url": "https://github.com/locustio/locust/issues/1399", "id": 626134755, "node_id": "MDU6SXNzdWU2MjYxMzQ3NTU=", "number": 1399, "title": "Inconsistencies in latencies reported by locust and %D apache custom log directive", "user": {"login": "vsag96", "id": 39757522, "node_id": "MDQ6VXNlcjM5NzU3NTIy", "avatar_url": "https://avatars.githubusercontent.com/u/39757522?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vsag96", "html_url": "https://github.com/vsag96", "followers_url": "https://api.github.com/users/vsag96/followers", "following_url": "https://api.github.com/users/vsag96/following{/other_user}", "gists_url": "https://api.github.com/users/vsag96/gists{/gist_id}", "starred_url": "https://api.github.com/users/vsag96/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vsag96/subscriptions", "organizations_url": "https://api.github.com/users/vsag96/orgs", "repos_url": "https://api.github.com/users/vsag96/repos", "events_url": "https://api.github.com/users/vsag96/events{/privacy}", "received_events_url": "https://api.github.com/users/vsag96/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-05-28T00:57:46Z", "updated_at": "2020-06-05T08:32:54Z", "closed_at": "2020-05-28T22:40:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nI have an apache server, which reports the time when it was done servicing a request in microseconds. I have a script which calculates the maximum time taken to service a request. \r\n\r\nNote:When apache says the time taken to service a request, what it means is when the last byte of the response was received at the TCP stack of the client(This is the one that makes the most sense to me).\r\n\r\nI ran locust on localhost(same machine as the server) and over a network. \r\n\r\n## Localhost Locust and Apache times\r\n```\r\n50%    66%     75%     80%   90%    95%    98%    99%  99.9% 99.99%   100%\r\n810   1100   1300   1500   2200   5100   7000   8100  10000  10000  10000\r\n720    990   1200   1300   1800   3600   7700   8300  10000  10000  10000\r\n740   1000   1200   1400   1800   3700   7800   8400   9300  10000  10000\r\n```\r\n\r\nApache Max request completion time: 4103224(in Micro second so 4 seconds????)\r\n\r\n\r\n## Over Network Locust and Apache times\r\n\r\n\r\n```\r\nPercentage of the requests completed within given times\r\n50%    66%     75%     80%   90%    95%    98%    99%  99.9% 99.99%   100%  \r\n1300   1800   2200   2400   4700   8600  12000  14000  18000  18000  18000\r\n1000   1400   1800   2000   2700   6400  13000  14000  20000  20000  20000\r\n1100   1600   1800   2100   2700   3300   7900  11000  14000  14000  14000\r\n```\r\n\r\nApache Max request completion time: 11466549(in Micro second so 11 seconds????) \r\n\r\n### Expected behavior\r\nTime reported by apache should be less than or equal to the time reported by the 100th percentile latency of locust.\r\n\r\n### Actual behavior\r\nLocust reports latencies less than that of apache. This should be impossible, at least in my mind.\r\n\r\n### Steps to reproduce\r\nI do nothing special on the apache side. I just made a few modifications to the default configuration. If you guys want I'll send the apache config and the script I used to calculate apache bandwidth.\r\n\r\n### Environment\r\n\r\n- OS: Ubuntu 18.04\r\n- Python version: 3.6.9\r\n- Locust version:1.0.2\r\n- Locust command line that you ran: locust --headless -u 100 -r 1  -H http://x.x.x.x -f locust_tests/generate_workload.py -t 120s\r\n- Locust file contents (anonymized if necessary):\r\nhttps://gist.github.com/vsag96/6fadfd674175a3d326f4ca7be1e66685", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1399/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1399/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1394", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1394/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1394/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1394/events", "html_url": "https://github.com/locustio/locust/issues/1394", "id": 624087816, "node_id": "MDU6SXNzdWU2MjQwODc4MTY=", "number": 1394, "title": "Update flask version", "user": {"login": "cyberw", "id": 1134328, "node_id": "MDQ6VXNlcjExMzQzMjg=", "avatar_url": "https://avatars.githubusercontent.com/u/1134328?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cyberw", "html_url": "https://github.com/cyberw", "followers_url": "https://api.github.com/users/cyberw/followers", "following_url": "https://api.github.com/users/cyberw/following{/other_user}", "gists_url": "https://api.github.com/users/cyberw/gists{/gist_id}", "starred_url": "https://api.github.com/users/cyberw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cyberw/subscriptions", "organizations_url": "https://api.github.com/users/cyberw/orgs", "repos_url": "https://api.github.com/users/cyberw/repos", "events_url": "https://api.github.com/users/cyberw/events{/privacy}", "received_events_url": "https://api.github.com/users/cyberw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-05-25T06:53:41Z", "updated_at": "2020-05-25T15:29:22Z", "closed_at": "2020-05-25T15:29:22Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "Our minimum required flask version is too old (saw at least one person having an issue https://stackoverflow.com/questions/61969924/typeerror-when-i-run-a-locustfile-py)\r\n\r\nhttps://flask.palletsprojects.com/en/1.1.x/changelog/#version-0-12-5 is a minimum, but we should probably go to 1.x right away.\r\n\r\nI can do the PR", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1394/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1394/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1393", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1393/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1393/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1393/events", "html_url": "https://github.com/locustio/locust/issues/1393", "id": 623708906, "node_id": "MDU6SXNzdWU2MjM3MDg5MDY=", "number": 1393, "title": "stop-timeout option is not working. Tests are stopped immediately after configured run time.", "user": {"login": "rohithkumar31", "id": 5706807, "node_id": "MDQ6VXNlcjU3MDY4MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/5706807?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rohithkumar31", "html_url": "https://github.com/rohithkumar31", "followers_url": "https://api.github.com/users/rohithkumar31/followers", "following_url": "https://api.github.com/users/rohithkumar31/following{/other_user}", "gists_url": "https://api.github.com/users/rohithkumar31/gists{/gist_id}", "starred_url": "https://api.github.com/users/rohithkumar31/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rohithkumar31/subscriptions", "organizations_url": "https://api.github.com/users/rohithkumar31/orgs", "repos_url": "https://api.github.com/users/rohithkumar31/repos", "events_url": "https://api.github.com/users/rohithkumar31/events{/privacy}", "received_events_url": "https://api.github.com/users/rohithkumar31/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1003994742, "node_id": "MDU6TGFiZWwxMDAzOTk0NzQy", "url": "https://api.github.com/repos/locustio/locust/labels/waiting%20on%20contributor", "name": "waiting on contributor", "color": "5319e7", "default": false, "description": ""}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-05-23T17:49:35Z", "updated_at": "2020-05-30T18:21:44Z", "closed_at": "2020-05-30T18:21:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nTried running locust test with runtime '6 hours' and stop time '10 hours' in seconds. I needed extra stop time because I had to do s3 cleanup as part of my test. But the locust runner stops immediately after 6 hours. The stop time is not considered.\r\n\r\n### Expected behavior\r\nThe stop time should be respected and the currently running tasks should be allowed continue to completion\r\n\r\n### Actual behavior\r\nTest is abruptly killed after configured runtime\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n1. Created a locust test \r\n2. Triggered the test for 6 hours with options (-t 6h -s 36000 )\r\n### Environment\r\n\r\n- OS: Ubuntu\r\n- Python version: 3.8\r\n- Locust version: 1.0.1\r\n- Locust command line that you ran: locust -f locustfile.py -u 100 -r 1 -t 6h -s 36000", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1393/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1393/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1391", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1391/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1391/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1391/events", "html_url": "https://github.com/locustio/locust/issues/1391", "id": 623221692, "node_id": "MDU6SXNzdWU2MjMyMjE2OTI=", "number": 1391, "title": "Search is broken on readthedocs", "user": {"login": "cyberw", "id": 1134328, "node_id": "MDQ6VXNlcjExMzQzMjg=", "avatar_url": "https://avatars.githubusercontent.com/u/1134328?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cyberw", "html_url": "https://github.com/cyberw", "followers_url": "https://api.github.com/users/cyberw/followers", "following_url": "https://api.github.com/users/cyberw/following{/other_user}", "gists_url": "https://api.github.com/users/cyberw/gists{/gist_id}", "starred_url": "https://api.github.com/users/cyberw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cyberw/subscriptions", "organizations_url": "https://api.github.com/users/cyberw/orgs", "repos_url": "https://api.github.com/users/cyberw/repos", "events_url": "https://api.github.com/users/cyberw/events{/privacy}", "received_events_url": "https://api.github.com/users/cyberw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 77651414, "node_id": "MDU6TGFiZWw3NzY1MTQxNA==", "url": "https://api.github.com/repos/locustio/locust/labels/documentation", "name": "documentation", "color": "207de5", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-05-22T13:51:24Z", "updated_at": "2020-06-01T07:49:02Z", "closed_at": "2020-06-01T07:49:01Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "Clicking search does nothing at all. I want to fix it but dont have the time right now :-/\r\n\r\nProbably related to the sphinx-search feature.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1391/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1391/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1390", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1390/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1390/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1390/events", "html_url": "https://github.com/locustio/locust/issues/1390", "id": 623094622, "node_id": "MDU6SXNzdWU2MjMwOTQ2MjI=", "number": 1390, "title": "OSError: [Errno 98] Address already in use in locust", "user": {"login": "kevalRPansuriya", "id": 37825293, "node_id": "MDQ6VXNlcjM3ODI1Mjkz", "avatar_url": "https://avatars.githubusercontent.com/u/37825293?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kevalRPansuriya", "html_url": "https://github.com/kevalRPansuriya", "followers_url": "https://api.github.com/users/kevalRPansuriya/followers", "following_url": "https://api.github.com/users/kevalRPansuriya/following{/other_user}", "gists_url": "https://api.github.com/users/kevalRPansuriya/gists{/gist_id}", "starred_url": "https://api.github.com/users/kevalRPansuriya/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kevalRPansuriya/subscriptions", "organizations_url": "https://api.github.com/users/kevalRPansuriya/orgs", "repos_url": "https://api.github.com/users/kevalRPansuriya/repos", "events_url": "https://api.github.com/users/kevalRPansuriya/events{/privacy}", "received_events_url": "https://api.github.com/users/kevalRPansuriya/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-05-22T09:55:23Z", "updated_at": "2020-05-22T10:50:52Z", "closed_at": "2020-05-22T10:28:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n### Describe the bug\r\nI am running MQTT bases application and I am running client script which is connecting to the cloud\r\nI want to simulate how many devices a cloud can handle I am using AWS ec2 instance to run locust script each device use 3 socket connection\r\nI am running 14100 devices script each one is using 3 socket connection \r\ntotal socket connection open during this test is 42224\r\n\r\ncommand : ss -s\r\nresult:\r\nTotal: 42404 (kernel 0)\r\nTCP:   42225 (estab 42222, closed 0, orphaned 0, synrecv 0, timewait 0/0), ports 0\r\n\r\nTransport Total     IP        IPv6\r\n*\t  0         -         -        \r\nRAW\t  1         0         1        \r\nUDP\t  2         2         0        \r\nTCP\t  42225     42224     1        \r\nINET\t  42228     42226     2        \r\nFRAG\t  0         0         0 \r\n\r\n\r\n### Expected behavior\r\nscript should run without error OSError: [Errno 98] Address already in use in locust\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\nrun any application that open more than 40k socket connection. \r\n\r\n### Environment\r\n\r\n- OS: Ubuntu 18.04.4 LTS\r\n- Python version: Python 3.6.9  [GCC 8.4.0] on Linux\r\n- Locust version:locust 0.14.6\r\n- Locust command line that you ran:\r\nnohup env instance=0 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=300 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=600 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=900 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=1200 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=1500 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=1800 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=2100 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=2400 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=2700 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=3000 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=3300 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=3600 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=3900 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=4200 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=4500 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=4800 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=5100 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=5400 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=5700 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=6000 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=6300 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=6600 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=6900 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=7200 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=7500 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=7800 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=8100 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=8400 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=8700 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=9000 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=9300 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=9600 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=9900 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=10200 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=10500 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=10800 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=11100 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=11400 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=11700 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=12000 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=12300 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=12600 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=12900 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=13200 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=13500 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=13800 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\nnohup env instance=14100 locust -f locust_2.0_device_service.py --no-web -H \"\" -r 10 -c 300 &\r\n\r\n\r\n\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1390/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1390/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1389", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1389/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1389/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1389/events", "html_url": "https://github.com/locustio/locust/issues/1389", "id": 623078508, "node_id": "MDU6SXNzdWU2MjMwNzg1MDg=", "number": 1389, "title": "Using deprecated classes cause a crash", "user": {"login": "akaihola", "id": 13725, "node_id": "MDQ6VXNlcjEzNzI1", "avatar_url": "https://avatars.githubusercontent.com/u/13725?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akaihola", "html_url": "https://github.com/akaihola", "followers_url": "https://api.github.com/users/akaihola/followers", "following_url": "https://api.github.com/users/akaihola/following{/other_user}", "gists_url": "https://api.github.com/users/akaihola/gists{/gist_id}", "starred_url": "https://api.github.com/users/akaihola/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akaihola/subscriptions", "organizations_url": "https://api.github.com/users/akaihola/orgs", "repos_url": "https://api.github.com/users/akaihola/repos", "events_url": "https://api.github.com/users/akaihola/events{/privacy}", "received_events_url": "https://api.github.com/users/akaihola/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-05-22T09:26:05Z", "updated_at": "2020-05-25T14:41:33Z", "closed_at": "2020-05-22T11:28:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nWhen using a deprecated old name for a class which has been renamed, locust crashes.\r\n\r\n### Expected behavior\r\nA deprecation warning should be displayed instead, and the original behavior still executed. The user should still have the option to either crash on, notify about or silently ignore usages of deprecated functionality.\r\n\r\nFor instance, this should by default still work and log a deprecation warning:\r\n```python\r\nclass MyLocust(HttpLocust):\r\n    ...\r\n```\r\n\r\nThis should be implemented using `warnings.warn('<message>', DeprecationWarning)` as shown in Python documentation.\r\n\r\n### Actual behavior\r\nLocust raises a `DeprecationWarning` exception.\r\n\r\n### Steps to reproduce\r\n```python\r\n$ python\r\n>>> from locust import HttpLocust\r\n>>> class X(HttpLocust): ...\r\n... \r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"locust/util/deprecation.py\", line 23, in __new__\r\n    raise DeprecationWarning(deprecation_message)\r\nDeprecationWarning: The HttpLocust class has been renamed to HttpUser in version 1.0. For more info see: https://docs.locust.io/en/latest/changelog.html#changelog-1-0\r\n```\r\n\r\n### Environment\r\n\r\n- OS: Fedora 30\r\n- Python version: 3.7\r\n- Locust version: 1.0.1\r\n\r\nSee also:\r\n- [Software deprecation](https://en.wikipedia.org/wiki/Deprecation#Software_deprecation) on Wikipedia\r\n- [warnings](https://docs.python.org/3/library/warnings.html) \u2013 Warning control in Python documentation", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1389/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1389/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1387", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1387/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1387/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1387/events", "html_url": "https://github.com/locustio/locust/issues/1387", "id": 621405800, "node_id": "MDU6SXNzdWU2MjE0MDU4MDA=", "number": 1387, "title": "'Module' object is not callable", "user": {"login": "MarcSteven", "id": 13824297, "node_id": "MDQ6VXNlcjEzODI0Mjk3", "avatar_url": "https://avatars.githubusercontent.com/u/13824297?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarcSteven", "html_url": "https://github.com/MarcSteven", "followers_url": "https://api.github.com/users/MarcSteven/followers", "following_url": "https://api.github.com/users/MarcSteven/following{/other_user}", "gists_url": "https://api.github.com/users/MarcSteven/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarcSteven/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarcSteven/subscriptions", "organizations_url": "https://api.github.com/users/MarcSteven/orgs", "repos_url": "https://api.github.com/users/MarcSteven/repos", "events_url": "https://api.github.com/users/MarcSteven/events{/privacy}", "received_events_url": "https://api.github.com/users/MarcSteven/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-05-20T02:13:04Z", "updated_at": "2020-11-05T06:55:15Z", "closed_at": "2020-07-02T20:43:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n\r\n### Describe the bug\r\nWhen I executed the command line order, it showed the error 'Module' object is not callable'\r\n\r\n`locust --host='hostname' --locustfile locustfile.py`\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nRun successfully\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nIt failed and displayed the error -Module object is not callable\r\n\r\n### Steps to reproduce\r\n\r\n\r\n### Environment\r\n\r\n- OS:Mac OS 10.15.4\r\n- Python version:3.8.2\r\n- Locust version:0.14.6\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1387/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1387/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1385", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1385/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1385/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1385/events", "html_url": "https://github.com/locustio/locust/issues/1385", "id": 620948321, "node_id": "MDU6SXNzdWU2MjA5NDgzMjE=", "number": 1385, "title": "Got \"unknown user exception\" when use --step-load and --step-clients", "user": {"login": "yunfan", "id": 438913, "node_id": "MDQ6VXNlcjQzODkxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/438913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yunfan", "html_url": "https://github.com/yunfan", "followers_url": "https://api.github.com/users/yunfan/followers", "following_url": "https://api.github.com/users/yunfan/following{/other_user}", "gists_url": "https://api.github.com/users/yunfan/gists{/gist_id}", "starred_url": "https://api.github.com/users/yunfan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yunfan/subscriptions", "organizations_url": "https://api.github.com/users/yunfan/orgs", "repos_url": "https://api.github.com/users/yunfan/repos", "events_url": "https://api.github.com/users/yunfan/events{/privacy}", "received_events_url": "https://api.github.com/users/yunfan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 77651414, "node_id": "MDU6TGFiZWw3NzY1MTQxNA==", "url": "https://api.github.com/repos/locustio/locust/labels/documentation", "name": "documentation", "color": "207de5", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-05-19T12:47:10Z", "updated_at": "2020-05-19T13:39:54Z", "closed_at": "2020-05-19T13:29:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "# Describe the bug\r\n\r\ni was using the typical step-load mode copy from the document\r\n\r\n```\r\nlocust --headless -u 1000 -r 100 --run-time 30m --step-load --step-clients 10 --step-time 20m\r\n```\r\n\r\nand got a \"unknown user exception like the follow\r\n\r\n```\r\n[2020-05-19 20:41:59,569] brix/ERROR/locust.main: Unknown User(s): 10\r\n```\r\n\r\n### Environment\r\n\r\n- OS: ubuntu 20.04 x86_64\r\n- Python version: 3.8.2\r\n- Locust version: 1.0.1\r\n- Locust command line that you ran: `locust --headless -u 1000 -r 100 --run-time 30m --step-load --step-clients 10 --step-time 20m`\r\n- Locust file contents (anonymized if necessary): ", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1385/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1385/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1379", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1379/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1379/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1379/events", "html_url": "https://github.com/locustio/locust/issues/1379", "id": 619896954, "node_id": "MDU6SXNzdWU2MTk4OTY5NTQ=", "number": 1379, "title": "SequentialTaskSet is broken when using local class members (headless mode)", "user": {"login": "efology", "id": 16097165, "node_id": "MDQ6VXNlcjE2MDk3MTY1", "avatar_url": "https://avatars.githubusercontent.com/u/16097165?v=4", "gravatar_id": "", "url": "https://api.github.com/users/efology", "html_url": "https://github.com/efology", "followers_url": "https://api.github.com/users/efology/followers", "following_url": "https://api.github.com/users/efology/following{/other_user}", "gists_url": "https://api.github.com/users/efology/gists{/gist_id}", "starred_url": "https://api.github.com/users/efology/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/efology/subscriptions", "organizations_url": "https://api.github.com/users/efology/orgs", "repos_url": "https://api.github.com/users/efology/repos", "events_url": "https://api.github.com/users/efology/events{/privacy}", "received_events_url": "https://api.github.com/users/efology/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-05-18T04:22:06Z", "updated_at": "2020-05-18T11:57:20Z", "closed_at": "2020-05-18T11:57:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nTrying to execute a SequentialTaskSet in headless mode, store result's from first task, and use it in second task\r\n\r\n### Expected behavior\r\nExecute first task, retrieve json, store it as dict in SequentialTaskSet object, execute second task and access the variable.\r\n\r\n### Actual behavior\r\nExecute first task, json is retrieved, stored. In second task upon trying to access the stored data, I get following exceptions:\r\n1.) AttributeError: 'dict' object has no attribute '_state'\r\n2.) AttributeError: 'dict' object has no attribute 'environment'\r\n\r\n### Steps to reproduce\r\nStart provided mockserver.py (flask) on localhost:5000, then run provided locust file (sequence_test.py) with command lines specified\r\n\r\n\r\n\r\n### Environment\r\n\r\n- OS: \r\nUbuntu 18.04.4 LTS running in WSL\r\n Linux PSALA059 4.4.0-18990-Microsoft #1-Microsoft Sat Sep 21 17:04:00 PST 2019 x86_64 x86_64 x86_64 GNU/Linux\r\n- Python version:\r\n3.6.9\r\n- Locust version:\r\nlocust 1.0.1\r\n- Locust command line that you ran:\r\nrun master locust:\r\n` locust -f sequence_test.py --host=http://localhost:5000 --master --expect-workers=1 --headless -u 1 -r 1 -t 1h`\r\n\r\nrun worker locust:\r\n`locust -f sequence_test.py --worker --master-host=127.0.0.1 --host=http://localhost:5000`\r\n\r\n- Locust file contents (anonymized if necessary):\r\n[locust-1.0.1-sequence-bug.zip](https://github.com/locustio/locust/files/4641968/locust-1.0.1-sequence-bug.zip)\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1379/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1379/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1376", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1376/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1376/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1376/events", "html_url": "https://github.com/locustio/locust/issues/1376", "id": 619212832, "node_id": "MDU6SXNzdWU2MTkyMTI4MzI=", "number": 1376, "title": "dynamic credentials examples refers to HttpUser which doesn't exist in module locust", "user": {"login": "chrishare08", "id": 58052919, "node_id": "MDQ6VXNlcjU4MDUyOTE5", "avatar_url": "https://avatars.githubusercontent.com/u/58052919?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chrishare08", "html_url": "https://github.com/chrishare08", "followers_url": "https://api.github.com/users/chrishare08/followers", "following_url": "https://api.github.com/users/chrishare08/following{/other_user}", "gists_url": "https://api.github.com/users/chrishare08/gists{/gist_id}", "starred_url": "https://api.github.com/users/chrishare08/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chrishare08/subscriptions", "organizations_url": "https://api.github.com/users/chrishare08/orgs", "repos_url": "https://api.github.com/users/chrishare08/repos", "events_url": "https://api.github.com/users/chrishare08/events{/privacy}", "received_events_url": "https://api.github.com/users/chrishare08/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-05-15T20:04:57Z", "updated_at": "2020-09-18T23:55:29Z", "closed_at": "2020-05-16T20:16:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n### Describe the bug\r\nThe [dynamic credentials example](https://github.com/locustio/locust/blob/master/examples/dynamice_user_credentials.py), attempts to import HttpUser.  locust 0.14.4 doesn't not contain this class.  the error generated is:\r\n\r\n```\r\ncannot import name 'HttpUser' from 'locust' (/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/locustio-0.14.4-py3.8.egg/locust/__init__.py)\r\n```\r\n\r\n### Expected behavior\r\nThe example should be functional (even it results in an error against a target) since it is supposed to be a usable example.\r\n\r\n### Actual behavior\r\nAttempting to use this as an example yields an import error on Python 3.8\r\n\r\n### Steps to reproduce\r\n1. Copy the contents of the example into a locustfile.\r\n2. run locust.\r\n3. See this result:\r\n\r\n```\r\n[2020-05-15 20:01:02,692] fieldcast/ERROR/stderr: from locust import HttpUser, TaskSet, task, between\r\n[2020-05-15 20:01:02,692] fieldcast/ERROR/stderr: \r\n[2020-05-15 20:01:02,692] fieldcast/ERROR/stderr: ImportError\r\n[2020-05-15 20:01:02,692] fieldcast/ERROR/stderr: :\r\n[2020-05-15 20:01:02,692] fieldcast/ERROR/stderr: cannot import name 'HttpUser' from 'locust' (/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/locustio-0.14.4-py3.8.egg/locust/__init__.py)\r\n[2020-05-15 20:01:02,692] fieldcast/ERROR/stderr: \r\n```\r\n\r\n\r\n### Environment\r\n\r\n- OS: macOS 10.15.4 Catalina\r\n- Python version: 3.8\r\n- Locust version: 0.14.4\r\n- Locust command line that you ran: locust\r\n- Locust file contents (anonymized if necessary):\r\nsee the file at https://github.com/locustio/locust/blob/master/examples/dynamice_user_credentials.py\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1376/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1376/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1372", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1372/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1372/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1372/events", "html_url": "https://github.com/locustio/locust/issues/1372", "id": 617371014, "node_id": "MDU6SXNzdWU2MTczNzEwMTQ=", "number": 1372, "title": "OOM error with master/slaves setup (zeromq, windows)", "user": {"login": "mparent", "id": 2796349, "node_id": "MDQ6VXNlcjI3OTYzNDk=", "avatar_url": "https://avatars.githubusercontent.com/u/2796349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mparent", "html_url": "https://github.com/mparent", "followers_url": "https://api.github.com/users/mparent/followers", "following_url": "https://api.github.com/users/mparent/following{/other_user}", "gists_url": "https://api.github.com/users/mparent/gists{/gist_id}", "starred_url": "https://api.github.com/users/mparent/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mparent/subscriptions", "organizations_url": "https://api.github.com/users/mparent/orgs", "repos_url": "https://api.github.com/users/mparent/repos", "events_url": "https://api.github.com/users/mparent/events{/privacy}", "received_events_url": "https://api.github.com/users/mparent/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 30, "created_at": "2020-05-13T11:30:07Z", "updated_at": "2021-08-05T10:13:16Z", "closed_at": "2021-08-05T10:12:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi !\r\n \r\n### Describe the bug\r\nAn out of memory error occurs with ZeroMQ trying to allocate a crazy amount of memory in decoded_allocator, sometime up to several petabytes. This might very well be a ZeroMQ bug : \r\n` OUT OF MEMORY (bundled\\zeromq\\src\\decoder_allocators.cpp:89)`\r\n \r\nI added some logs and recompiled pyzmq to check what's going on. Upon further investigation, _max_counters seems to take a crazy value at some point. See [zmq_logs.txt](https://github.com/locustio/locust/files/4618065/zmq_logs.txt)\r\nAs you can see, allocator instance 0x0000016A9270F700 is constructed with _max_counters=249, but before crash its value has changed to 1557249601288, which causes a malloc of several terabytes.\r\n \r\n \r\n### Steps to reproduce\r\nSorry, I couldn't find a surefire way to reproduce this one. It seems kind of random. It sometime happens before the test is even started, sometime when the test is stopped. Sometime it doesn't happen at all. It does seem to happen more often when stopping a test in the web UI. Simply run the ps1 attached and do some stuff in the web UI.\r\n \r\n### Environment\r\n \r\n- OS: Windows 10.0.18362.778\r\n- Python version: 3.6\r\n- Locust version: 0.14.6\r\n- Locust files : [test_locust.zip](https://github.com/locustio/locust/files/4618016/test_locust.zip)\r\n \r\nI managed to repro the bug on two computers : my work computer and my personal computer. Both are on Windows 10/Python 3.6 that comes with VS2017, but my personal computer has a pristine python environent, just ran pip install locustio.\r\n\r\nAm I doing something I'm not supposed to ?\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1372/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1372/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1369", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1369/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1369/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1369/events", "html_url": "https://github.com/locustio/locust/issues/1369", "id": 616277222, "node_id": "MDU6SXNzdWU2MTYyNzcyMjI=", "number": 1369, "title": "FastHttpLocust + SNI", "user": {"login": "ecc256", "id": 15874603, "node_id": "MDQ6VXNlcjE1ODc0NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/15874603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecc256", "html_url": "https://github.com/ecc256", "followers_url": "https://api.github.com/users/ecc256/followers", "following_url": "https://api.github.com/users/ecc256/following{/other_user}", "gists_url": "https://api.github.com/users/ecc256/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecc256/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecc256/subscriptions", "organizations_url": "https://api.github.com/users/ecc256/orgs", "repos_url": "https://api.github.com/users/ecc256/repos", "events_url": "https://api.github.com/users/ecc256/events{/privacy}", "received_events_url": "https://api.github.com/users/ecc256/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-05-12T00:43:07Z", "updated_at": "2020-05-18T19:36:28Z", "closed_at": "2020-05-18T19:36:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "Getting weird issue with **FastHttpLocust** again.\r\nIt works fine from client.\r\nBut server (OpenResty) has **SNI** based bindings and show tons of errors like\r\n_... failed to get SNI ..._ \r\nand falls back to default certificate. :(\r\n\r\nSame exact code works fine with **HttpLocust**.\r\nDon\u2019t know how to help somebody to reproduce\u2026\r\n\r\nAm I missing something (simple?) with **FastHttpLocust**?\r\nAFAIR, it\u2019s up to the https client to send **SNI** or not, right?\r\n\r\n```\r\nurl = f'{https}://{host}{url}'\r\nheaders = {\r\n\t'Host': host,\r\n}\r\nself.client.get(url, name=url, headers=headers)\r\n```\r\n\r\n```\r\n(locust382) ubuntu@...:~$ conda list\r\n# packages in environment at /home/ubuntu/anaconda3/envs/locust382:\r\n#\r\n# Name                    Version                   Build  Channel\r\n_libgcc_mutex             0.1                        main  \r\nca-certificates           2020.1.1                      0  \r\ncertifi                   2020.4.5.1               py38_0  \r\nchardet                   3.0.4                    pypi_0    pypi\r\nclick                     7.1.1                    pypi_0    pypi\r\nconfigargparse            1.2.1                    pypi_0    pypi\r\nflask                     1.1.2                    pypi_0    pypi\r\nflask-basicauth           0.2.0                    pypi_0    pypi\r\ngevent                    1.5.0                    pypi_0    pypi\r\ngeventhttpclient-wheels   1.3.1.dev3               pypi_0    pypi\r\ngreenlet                  0.4.15                   pypi_0    pypi\r\nidna                      2.9                      pypi_0    pypi\r\nitsdangerous              1.1.0                    pypi_0    pypi\r\njinja2                    2.11.2                   pypi_0    pypi\r\nld_impl_linux-64          2.33.1               h53a641e_7  \r\nlibedit                   3.1.20181209         hc058e9b_0  \r\nlibffi                    3.2.1                hd88cf55_4  \r\nlibgcc-ng                 9.1.0                hdf63c60_0  \r\nlibstdcxx-ng              9.1.0                hdf63c60_0  \r\nlocustio                  1.0.0                     dev_0    <develop>\r\nmarkupsafe                1.1.1                    pypi_0    pypi\r\nmsgpack                   1.0.0                    pypi_0    pypi\r\nncurses                   6.2                  he6710b0_0  \r\nopenssl                   1.1.1g               h7b6447c_0  \r\npip                       20.0.2                   py38_1  \r\npsutil                    5.7.0                    pypi_0    pypi\r\npython                    3.8.2                hcf32534_0  \r\npyzmq                     19.0.0                   pypi_0    pypi\r\nreadline                  8.0                  h7b6447c_0  \r\nrequests                  2.23.0                   pypi_0    pypi\r\nsetuptools                46.1.3                   py38_0  \r\nsix                       1.14.0                   pypi_0    pypi\r\nsqlite                    3.31.1               h62c20be_1  \r\ntk                        8.6.8                hbc83047_0  \r\nurllib3                   1.25.9                   pypi_0    pypi\r\nwerkzeug                  1.0.1                    pypi_0    pypi\r\nwheel                     0.34.2                   py38_0  \r\nxz                        5.2.5                h7b6447c_0  \r\nzlib                      1.2.11               h7b6447c_3  \r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1369/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1369/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1364", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1364/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1364/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1364/events", "html_url": "https://github.com/locustio/locust/issues/1364", "id": 613753764, "node_id": "MDU6SXNzdWU2MTM3NTM3NjQ=", "number": 1364, "title": "installation is successful but it's not available", "user": {"login": "MarcSteven", "id": 13824297, "node_id": "MDQ6VXNlcjEzODI0Mjk3", "avatar_url": "https://avatars.githubusercontent.com/u/13824297?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarcSteven", "html_url": "https://github.com/MarcSteven", "followers_url": "https://api.github.com/users/MarcSteven/followers", "following_url": "https://api.github.com/users/MarcSteven/following{/other_user}", "gists_url": "https://api.github.com/users/MarcSteven/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarcSteven/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarcSteven/subscriptions", "organizations_url": "https://api.github.com/users/MarcSteven/orgs", "repos_url": "https://api.github.com/users/MarcSteven/repos", "events_url": "https://api.github.com/users/MarcSteven/events{/privacy}", "received_events_url": "https://api.github.com/users/MarcSteven/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-05-07T03:52:32Z", "updated_at": "2020-06-06T08:26:05Z", "closed_at": "2020-06-06T08:26:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nI installed it successfully but now it's still not available .\r\n### Expected behavior\r\nI hope it's available now \r\n### Actual behavior\r\nit's not available at present.\r\n### Steps to reproduce\r\nstep1:\r\n`pip3 install locust\r\n`\r\nstep2:\r\n\r\n`locust --help`\r\n\r\n\r\n\r\n### Environment\r\n\r\n- OS:10.15.2\r\n- Python version:3.6.8\r\n- Locust version:0.0.0(when I installed it and then it showed the version is equal to 0.0.0)\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1364/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1364/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1360", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1360/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1360/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1360/events", "html_url": "https://github.com/locustio/locust/issues/1360", "id": 610015805, "node_id": "MDU6SXNzdWU2MTAwMTU4MDU=", "number": 1360, "title": "FastHttpUser doesn't use the SNI TLS extension", "user": {"login": "gileri", "id": 493438, "node_id": "MDQ6VXNlcjQ5MzQzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/493438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gileri", "html_url": "https://github.com/gileri", "followers_url": "https://api.github.com/users/gileri/followers", "following_url": "https://api.github.com/users/gileri/following{/other_user}", "gists_url": "https://api.github.com/users/gileri/gists{/gist_id}", "starred_url": "https://api.github.com/users/gileri/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gileri/subscriptions", "organizations_url": "https://api.github.com/users/gileri/orgs", "repos_url": "https://api.github.com/users/gileri/repos", "events_url": "https://api.github.com/users/gileri/events{/privacy}", "received_events_url": "https://api.github.com/users/gileri/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-04-30T13:49:04Z", "updated_at": "2020-05-04T20:34:24Z", "closed_at": "2020-05-04T20:02:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nSome web server/reverse proxy require the client to announce which hostname it wants to connect to. It's done via the [Server Name Indication](https://en.wikipedia.org/wiki/Server_Name_Indication) TLS extension. This allow sharing the same public IP between multiple hostnames. locust.io for example uses Cloudflare, which requires SNI in this setup.\r\n\r\nUnlike `HttpUser`, `FastHttpUser` doesn't send the SNI extension, making all TLS connection to SNI-requiring servers fail.\r\n\r\nUsers are [warned](https://github.com/locustio/locust/blob/de53ef8cf7941dd67f83405ea0012b9ee323a905/docs/increase-performance.rst) that `FastHttpUser` doesn't necessarily implement the same feature set as `HttpUser`, but `geventhttpclient`, used by `FastHttpUser` [does support SNI](https://github.com/gwik/geventhttpclient/pull/109) in the included version.\r\n\r\n### Expected behavior\r\nThe FastHttpUser client send the SNI extension as `host`, and the TLS connection succeed.\r\n\r\n### Actual behavior\r\nThe following error is obtained and every TLS connection \r\n`SSLError(1, '[SSL: SSLV3_ALERT_HANDSHAKE_FAILURE] sslv3 alert handshake failure (_ssl.c:1108)')`\r\n\r\nIt can confirmed by capturing the TLS Client Hello network packet.\r\n\r\n### Steps to reproduce\r\n`locustfile.py` : \r\n```python\r\nfrom locust import task, between\r\nfrom locust.contrib.fasthttp import FastHttpUser\r\n\r\nclass ApiUser(FastHttpUser):\r\n    wait_time = between(1.0, 8.0)\r\n\r\n    @task(1)\r\n    def index(self):\r\n        self.client.get(\"/\")\r\n```\r\nExecute\r\n`% locust -H 'https://locust.io' --headless`\r\n\r\n### Environment\r\n\r\n- OS: Archlinux up to date as of 2020-04-30\r\n- Python version: 3.8.2\r\n- Locust version: git master @5cad1cb5921ff84298d357e0a5ba42bdc0390acc\r\n- Locust command line that you ran: `locust -H 'https://locust.io' --headless`", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1360/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1360/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1337", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1337/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1337/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1337/events", "html_url": "https://github.com/locustio/locust/issues/1337", "id": 602354801, "node_id": "MDU6SXNzdWU2MDIzNTQ4MDE=", "number": 1337, "title": "DEBUG output in docker is not working", "user": {"login": "rcortez-la", "id": 5376704, "node_id": "MDQ6VXNlcjUzNzY3MDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5376704?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rcortez-la", "html_url": "https://github.com/rcortez-la", "followers_url": "https://api.github.com/users/rcortez-la/followers", "following_url": "https://api.github.com/users/rcortez-la/following{/other_user}", "gists_url": "https://api.github.com/users/rcortez-la/gists{/gist_id}", "starred_url": "https://api.github.com/users/rcortez-la/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rcortez-la/subscriptions", "organizations_url": "https://api.github.com/users/rcortez-la/orgs", "repos_url": "https://api.github.com/users/rcortez-la/repos", "events_url": "https://api.github.com/users/rcortez-la/events{/privacy}", "received_events_url": "https://api.github.com/users/rcortez-la/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/locustio/locust/milestones/5", "html_url": "https://github.com/locustio/locust/milestone/5", "labels_url": "https://api.github.com/repos/locustio/locust/milestones/5/labels", "id": 5187312, "node_id": "MDk6TWlsZXN0b25lNTE4NzMxMg==", "number": 5, "title": "1.0", "description": "Locust 1.0", "creator": {"login": "heyman", "id": 54217, "node_id": "MDQ6VXNlcjU0MjE3", "avatar_url": "https://avatars.githubusercontent.com/u/54217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/heyman", "html_url": "https://github.com/heyman", "followers_url": "https://api.github.com/users/heyman/followers", "following_url": "https://api.github.com/users/heyman/following{/other_user}", "gists_url": "https://api.github.com/users/heyman/gists{/gist_id}", "starred_url": "https://api.github.com/users/heyman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/heyman/subscriptions", "organizations_url": "https://api.github.com/users/heyman/orgs", "repos_url": "https://api.github.com/users/heyman/repos", "events_url": "https://api.github.com/users/heyman/events{/privacy}", "received_events_url": "https://api.github.com/users/heyman/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 16, "state": "closed", "created_at": "2020-03-10T14:32:10Z", "updated_at": "2020-05-25T12:11:59Z", "due_on": "2020-04-29T07:00:00Z", "closed_at": "2020-05-25T12:11:59Z"}, "comments": 5, "created_at": "2020-04-18T01:59:05Z", "updated_at": "2020-04-29T19:35:02Z", "closed_at": "2020-04-19T15:56:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nUsing the DEBUG option in a docker-compose file is not very verbose on the terminal. Same results without DEBUG\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\nWith this option and a few print(\"something\") lines the terminal output shows important information.\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\nThis is what I see using the latest build in docker with a print(\"access token\")\r\n```\r\nubuntu@ip-10-22-194-7:~/randlex-locust$ sudo docker-compose logs\r\nAttaching to standalone\r\nstandalone    | Starting Locust in standalone mode...\r\nstandalone    | $ locust --web-port 8089 --loglevel DEBUG -f /mnt/locust/locustfile.py -H http://asite.org\r\nstandalone    | [2020-04-18 01:29:13,417] standalone/INFO/locust.main: Starting web monitor at http://*:8089\r\nstandalone    | [2020-04-18 01:29:13,417] standalone/INFO/locust.main: Starting Locust 0.14.5\r\nstandalone    | [2020-04-18 01:29:27,774] standalone/INFO/locust.runners: Hatching and swarming 3 users at the rate 1 users/s (0 users already running)...\r\nstandalone    | [2020-04-18 01:29:27,776] standalone/DEBUG/urllib3.connectionpool: Starting new HTTP connection (1): asite.org:80\r\nstandalone    | [2020-04-18 01:29:27,931] standalone/DEBUG/urllib3.connectionpool: http://asite.org:80 \"POST /api/security/auth/token/obtain/ HTTP/1.1\" 200 571\r\nstandalone    | [2020-04-18 01:29:27,932] standalone/INFO/stdout: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNTg3MTc2OTY3LCJqdGkiOiI0ZWMxZmVmZmZhOWQ0NTJjYmE5MGUwZDBmNDRmYWQ5NiIsInVzZXJfaWQiOjE2LCJvcmlnaW5hbF9pYXQiOjE1ODcxNzMzNjcsInJlZnJlc2hfaW50ZXJ2YWwiOjEyMH0.dmrtk6z2Ln5T66ERmQwbDWoKNW6SW9sk-GCj0H_XC0E\r\n```\r\n\r\nUsing locustio/lociust:master\r\n```\r\nubuntu@ip-10-22-194-7:~/randlex-locust$ sudo docker-compose logs\r\nAttaching to standalone\r\nstandalone    | Starting Locust in standalone mode...\r\nstandalone    | $ locust --web-port 8089 -f /mnt/locust/locustfile.py -H http://asite.org\r\nstandalone    | [2020-04-18 01:43:18,047] standalone/INFO/locust.main: Starting web monitor at http://*:8089\r\nstandalone    | [2020-04-18 01:43:18,056] standalone/INFO/locust.main: Starting Locust 1.0.0\r\nstandalone    | [2020-04-18 01:43:28,940] standalone/INFO/locust.runners: Hatching and swarming 3 users at the rate 1 users/s (0 users already running)...\r\nstandalone    | [2020-04-18 01:43:30,942] standalone/INFO/locust.runners: All locusts hatched: WebsiteUser: 3 (0 already running)\r\n```\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\ndocker pull locustio/locust:master\r\nlauch docker-compose\r\n```\r\nversion: '3'\r\nservices:\r\n  standalone:\r\n    image: \"locustio/locust:master\"\r\n    container_name: standalone\r\n    hostname: standalone\r\n    ports:\r\n     - \"80:8089\"\r\n    environment:\r\n      LOCUSTFILE_PATH: /mnt/locust/locustfile.py\r\n      TARGET_URL: http://asite.org\r\n      LOCUST_MODE: standalone\r\n      LOCUST_OPTS: \"--web-port 8089 --loglevel DEBUG\"\r\n    volumes:\r\n      - ./locust-scripts:/mnt/locust\r\n```\r\n### Environment\r\n\r\n- OS: ubuntu 18 and docker 18\r\n- Python version: \r\n- Locust version: locustio/locust:master\r\n- Locust command line that you ran:  sudo docker-compose up -d\r\n- Locust file contents (anonymized if necessary):\r\nI'm experimenting with SequentialTaskSet since I was having problems with @seq_task.\r\n```\r\nfrom locust import HttpLocust, SequentialTaskSet, TaskSet, task, between\r\n\"\"\"from locust.exception import StopLocust\"\"\"\r\n\r\nclass Keyness(SequentialTaskSet):\r\n    def on_start(self):\r\n        \"\"\" on_start is called when a Locust start before any task is scheduled \"\"\"\r\n        \"\"\"self.client.verify = False\"\"\"\r\n        self.login()\r\n\r\n    def on_stop(self):\r\n        \"\"\" on_stop is called when the TaskSet is stopping \"\"\"\r\n        self.logout()\r\n\r\n    def login(self):\r\n        self.response = self.client.post(\"/api/security/auth/token/obtain/\", \r\n            {\"username\":\"loadtester\", \"password\":\"Password1\"}, headers =\r\n            {\"Connection\": \"Keep-Alive\"})\r\n        js = self.response.json()\r\n        self.rspAcs = js[\"access\"]\r\n        print(self.rspAcs, ' ')\r\n        \r\n    def logout(self):\r\n        self.client.post(\"/api/security/auth/token/obtain/\", \r\n            {\"username\":\"loadtester\", \"password\":\"Password1\"})\r\n\r\n    @task(1)\r\n    def projects(self):\r\n        self.client.get(\"/api/analysis/project/project/\", headers=\r\n            {\"Authorization\": \"Bearer \" + self.rspAcs,\r\n            \"Connection\": \"Keep-Alive\"})\r\n        print(self.rspAcs, ' ')\r\n\r\n    @task(1)\r\n    def new_project(self):\r\n        self.client.post(\"/api/analysis/project/project/\", headers=\r\n            {\"Authorization\": \"Bearer \" + self.rspAcs,\r\n            \"Connection\": \"Keep-Alive\"}, json=\r\n                {\"project_name\":\"new_project\"})\r\n        print(self.rspAcs, ' ')\r\n\r\n    \"\"\"@task\r\n    def stop(self):\r\n        self.interrupt()\"\"\"\r\n\r\n    @task\r\n    def done(self):\r\n        raise StopLocust()\r\n\r\nclass WebsiteUser(HttpLocust):\r\n    tasks = [Keyness]\r\n    wait_time = between(5, 9)\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1337/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1337/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1322", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1322/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1322/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1322/events", "html_url": "https://github.com/locustio/locust/issues/1322", "id": 597721162, "node_id": "MDU6SXNzdWU1OTc3MjExNjI=", "number": 1322, "title": "Docker image: worker mode not starting correctly", "user": {"login": "liliankasem", "id": 2198905, "node_id": "MDQ6VXNlcjIxOTg5MDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2198905?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liliankasem", "html_url": "https://github.com/liliankasem", "followers_url": "https://api.github.com/users/liliankasem/followers", "following_url": "https://api.github.com/users/liliankasem/following{/other_user}", "gists_url": "https://api.github.com/users/liliankasem/gists{/gist_id}", "starred_url": "https://api.github.com/users/liliankasem/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liliankasem/subscriptions", "organizations_url": "https://api.github.com/users/liliankasem/orgs", "repos_url": "https://api.github.com/users/liliankasem/repos", "events_url": "https://api.github.com/users/liliankasem/events{/privacy}", "received_events_url": "https://api.github.com/users/liliankasem/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-04-10T06:26:22Z", "updated_at": "2020-04-13T22:52:51Z", "closed_at": "2020-04-10T06:42:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nWhen running the latests docker image with `LOCUST_MODE` set to `worker`, locust should start in worker mode, but it does not.\r\n\r\nIt seems to start in standalone mode and the correct `LOCUST_OPTS` from the `docker_start.sh` file are not being set.\r\n\r\n### Expected behavior\r\nWhen the container runs, I should see:\r\n\r\n```\r\nStarting Locust in worker mode...\r\n$ locust  -f /tests/locustfile.py -H ${TARGET_URL} --worker --master-host=${LOCUST_MASTER_HOST} --master-port=${LOCUST_MASTER_PORT:-5557}\r\n```\r\nLine 19 in the docker file should take effect:\r\nhttps://github.com/locustio/locust/blob/master/docker_start.sh\r\n\r\n### Actual behavior\r\nIt seems to recognise that the mode was set to worker, but the options are not getting updated to run in worker mode:\r\n\r\n```\r\nStarting Locust in worker mode...\r\n$ locust  -f /tests/locustfile.py -H http://something\r\n[2020-04-10 06:05:33,874] moma-locust-worker-c8m79/INFO/locust.main: Starting web monitor at http://*:8089\r\n[2020-04-10 06:05:33,874] moma-locust-worker-c8m79/INFO/locust.main: Starting Locust 0.14.5\r\n```\r\n\r\n### Steps to reproduce\r\nRun the docker image with these environment variables set\r\n\r\n```\r\n      LOCUST_MODE:         worker\r\n      LOCUST_MASTER_HOST:  something\r\n      TARGET_URL:          http://something\r\n      LOCUSTFILE_PATH:     /tests/locustfile.py\r\n```\r\n\r\n### Environment\r\n\r\n- OS: docker\r\n- Python version: official locust docker image (latest)\r\n- Locust version: 0.14.5\r\n\r\nThis docker-compose give the same issue:\r\n```\r\nx-common: &common\r\n  image: locustio/locust\r\n  environment: &common-env\r\n    TARGET_URL: http://localhost:8080\r\n    LOCUSTFILE_PATH: /tests/locustfile.py\r\n  volumes:\r\n    - ./tests:/tests\r\n\r\nservices:\r\n  locust-master:\r\n    <<: *common\r\n    ports:\r\n      - 8089:8089\r\n    environment:\r\n      <<: *common-env\r\n      LOCUST_MODE: master\r\n\r\n  locust-worker:\r\n    <<: *common\r\n    depends_on: [locust-master]\r\n    environment:\r\n      <<: *common-env\r\n      LOCUST_MODE: worker\r\n      LOCUST_MASTER_HOST: locust-master\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1322/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1322/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1318", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1318/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1318/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1318/events", "html_url": "https://github.com/locustio/locust/issues/1318", "id": 595904320, "node_id": "MDU6SXNzdWU1OTU5MDQzMjA=", "number": 1318, "title": "Debugging not possible due to Fatal Python error: Cannot recover from stack overflow.", "user": {"login": "RobDBob", "id": 6172430, "node_id": "MDQ6VXNlcjYxNzI0MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/6172430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RobDBob", "html_url": "https://github.com/RobDBob", "followers_url": "https://api.github.com/users/RobDBob/followers", "following_url": "https://api.github.com/users/RobDBob/following{/other_user}", "gists_url": "https://api.github.com/users/RobDBob/gists{/gist_id}", "starred_url": "https://api.github.com/users/RobDBob/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RobDBob/subscriptions", "organizations_url": "https://api.github.com/users/RobDBob/orgs", "repos_url": "https://api.github.com/users/RobDBob/repos", "events_url": "https://api.github.com/users/RobDBob/events{/privacy}", "received_events_url": "https://api.github.com/users/RobDBob/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-04-07T14:19:07Z", "updated_at": "2020-04-11T07:46:54Z", "closed_at": "2020-04-10T08:07:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nAny attempt to use debugger on working code results in Fatal Python error.\r\nNote: code in non-debug mode works fine, test execute as expected. UI is spawn on localhost address and it is usable.\r\n\r\n### Expected behavior\r\nNo error and able to debug.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\nConnected to pydev debugger (build 191.7479.30)\r\nFatal Python error: Cannot recover from stack overflow.\r\n\r\nThread 0x00005a30 (most recent call first):\r\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2019.1.3\\helpers\\pydev\\pydevd.py\", line 114 in _on_run\r\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2019.1.3\\helpers\\pydev\\_pydevd_bundle\\pydevd_comm.py\", line 321 in run\r\n  File \"C:\\Python37\\lib\\threading.py\", line 917 in _bootstrap_inner\r\n  File \"C:\\Python37\\lib\\threading.py\", line 885 in _bootstrap\r\n\r\nThread 0x00005994 (most recent call first):\r\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2019.1.3\\helpers\\pydev\\_pydevd_bundle\\pydevd_comm.py\", line 383 in _on_run\r\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2019.1.3\\helpers\\pydev\\_pydevd_bundle\\pydevd_comm.py\", line 321 in run\r\n  File \"C:\\Python37\\lib\\threading.py\", line 917 in _bootstrap_inner\r\n  File \"C:\\Python37\\lib\\threading.py\", line 885 in _bootstrap\r\n\r\nCurrent thread 0x00005630 (most recent call first):\r\n  File \"C:\\Python37\\lib\\threading.py\", line 1222 in current_thread\r\n  File \"C:\\Python37\\lib\\threading.py\", line 1222 in current_thread\r\n  File \"C:\\Python37\\lib\\threading.py\", line 1222 in current_thread\r\n  File \"C:\\Python37\\lib\\threading.py\", line 1222 in current_thread\r\n(...)\r\nThread 0x00005b04 (most recent call first):\r\n  File \"<frozen importlib._bootstrap>\", line 98 in acquire\r\n  File \"<frozen importlib._bootstrap>\", line 202 in _lock_unlock_module\r\n  File \"C:\\Repos\\qa-functional-automation-entitlement-services\\venv\\lib\\site-packages\\locust\\core.py\", line 17 in <module>\r\n  File \"<frozen importlib._bootstrap>\", line 219 in _call_with_frames_removed\r\n  File \"<frozen importlib._bootstrap_external>\", line 728 in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 677 in _load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 967 in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 983 in _find_and_load\r\n  File \"C:\\Repos\\qa-functional-automation-entitlement-services\\venv\\lib\\site-packages\\locust\\__init__.py\", line 1 in <module>\r\n  File \"<frozen importlib._bootstrap>\", line 219 in _call_with_frames_removed\r\n  File \"<frozen importlib._bootstrap_external>\", line 728 in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 677 in _load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 967 in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 983 in _find_and_load\r\n  File \"C:/Repos/qa-functional-automation-entitlement-services/test_some.py\", line 4 in <module>\r\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2019.1.3\\helpers\\pydev\\_pydev_imps\\_pydev_execfile.py\", line 18 in execfile\r\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2019.1.3\\helpers\\pydev\\pydevd.py\", line 1147 in run\r\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2019.1.3\\helpers\\pydev\\pydevd.py\", line 1752 in main\r\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2019.1.3\\helpers\\pydev\\pydevd.py\", line 1758 in <module>\r\n\r\nProcess finished with exit code -1073740791 (0xC0000409)\r\n\r\n### Steps to reproduce\r\nFollowed steps from accepted solution with remote debugging (see https://github.com/locustio/locust/issues/613)\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\nPyCharm 2019.1.3 (Professional Edition)\r\nBuild #PY-191.7479.30, built on May 29, 2019\r\nYou have a perpetual fallback license for this version\r\nSubscription is active until January 1, 2021\r\nJRE: 11.0.2+9-b159.60 amd64\r\nJVM: OpenJDK 64-Bit Server VM by JetBrains s.r.o\r\nWindows 10 10.0\r\n- OS: Windows 10, JetBrains Intellij PyCharm \r\n- Python version: 3.7\r\n- Locust version: 0.14.5\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1318/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1318/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1315", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1315/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1315/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1315/events", "html_url": "https://github.com/locustio/locust/issues/1315", "id": 595049194, "node_id": "MDU6SXNzdWU1OTUwNDkxOTQ=", "number": 1315, "title": "Can't run Locust distributed with --csv-full-history ", "user": {"login": "heyman", "id": 54217, "node_id": "MDQ6VXNlcjU0MjE3", "avatar_url": "https://avatars.githubusercontent.com/u/54217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/heyman", "html_url": "https://github.com/heyman", "followers_url": "https://api.github.com/users/heyman/followers", "following_url": "https://api.github.com/users/heyman/following{/other_user}", "gists_url": "https://api.github.com/users/heyman/gists{/gist_id}", "starred_url": "https://api.github.com/users/heyman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/heyman/subscriptions", "organizations_url": "https://api.github.com/users/heyman/orgs", "repos_url": "https://api.github.com/users/heyman/repos", "events_url": "https://api.github.com/users/heyman/events{/privacy}", "received_events_url": "https://api.github.com/users/heyman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/locustio/locust/milestones/5", "html_url": "https://github.com/locustio/locust/milestone/5", "labels_url": "https://api.github.com/repos/locustio/locust/milestones/5/labels", "id": 5187312, "node_id": "MDk6TWlsZXN0b25lNTE4NzMxMg==", "number": 5, "title": "1.0", "description": "Locust 1.0", "creator": {"login": "heyman", "id": 54217, "node_id": "MDQ6VXNlcjU0MjE3", "avatar_url": "https://avatars.githubusercontent.com/u/54217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/heyman", "html_url": "https://github.com/heyman", "followers_url": "https://api.github.com/users/heyman/followers", "following_url": "https://api.github.com/users/heyman/following{/other_user}", "gists_url": "https://api.github.com/users/heyman/gists{/gist_id}", "starred_url": "https://api.github.com/users/heyman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/heyman/subscriptions", "organizations_url": "https://api.github.com/users/heyman/orgs", "repos_url": "https://api.github.com/users/heyman/repos", "events_url": "https://api.github.com/users/heyman/events{/privacy}", "received_events_url": "https://api.github.com/users/heyman/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 16, "state": "closed", "created_at": "2020-03-10T14:32:10Z", "updated_at": "2020-05-25T12:11:59Z", "due_on": "2020-04-29T07:00:00Z", "closed_at": "2020-05-25T12:11:59Z"}, "comments": 1, "created_at": "2020-04-06T11:51:09Z", "updated_at": "2020-04-06T22:05:25Z", "closed_at": "2020-04-06T22:02:43Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\nRunning Locust distributed and use the `--csv-full-history` option will cause an exception\r\n\r\n<details>\r\n<summary>Stacktrace</summary>\r\n\r\n```\r\n[2020-04-06 13:01:45,700] Jonatans-Air.localdomain/ERROR/stderr: Traceback (most recent call last):\r\n[2020-04-06 13:01:45,700] Jonatans-Air.localdomain/ERROR/stderr: File \"/Users/heyman/virtualenvs/locust/bin/locust\", line 11, in <module>\r\n[2020-04-06 13:01:45,702] Jonatans-Air.localdomain/ERROR/stderr:\r\n[2020-04-06 13:01:45,702] Jonatans-Air.localdomain/ERROR/stderr: load_entry_point('locustio', 'console_scripts', 'locust')()\r\n[2020-04-06 13:01:45,702] Jonatans-Air.localdomain/ERROR/stderr:\r\n[2020-04-06 13:01:45,702] Jonatans-Air.localdomain/ERROR/stderr: File \"/Users/heyman/projects/locust/locust/main.py\", line 297, in main\r\n[2020-04-06 13:01:45,703] Jonatans-Air.localdomain/ERROR/stderr:\r\n[2020-04-06 13:01:45,703] Jonatans-Air.localdomain/ERROR/stderr: shutdown(code=code)\r\n[2020-04-06 13:01:45,703] Jonatans-Air.localdomain/ERROR/stderr:\r\n[2020-04-06 13:01:45,704] Jonatans-Air.localdomain/ERROR/stderr: File \"/Users/heyman/projects/locust/locust/main.py\", line 281, in shutdown\r\n[2020-04-06 13:01:45,705] Jonatans-Air.localdomain/ERROR/stderr:\r\n[2020-04-06 13:01:45,705] Jonatans-Air.localdomain/ERROR/stderr: write_stat_csvs(runner.stats, options.csvfilebase, options.stats_history_enabled)\r\n[2020-04-06 13:01:45,705] Jonatans-Air.localdomain/ERROR/stderr:\r\n[2020-04-06 13:01:45,706] Jonatans-Air.localdomain/ERROR/stderr: File \"/Users/heyman/projects/locust/locust/stats.py\", line 757, in write_stat_csvs\r\n[2020-04-06 13:01:45,706] Jonatans-Air.localdomain/ERROR/stderr:\r\n[2020-04-06 13:01:45,706] Jonatans-Air.localdomain/ERROR/stderr: f.write(stats_history_csv(stats, stats_history_enabled) + \"\\n\")\r\n[2020-04-06 13:01:45,707] Jonatans-Air.localdomain/ERROR/stderr:\r\n[2020-04-06 13:01:45,707] Jonatans-Air.localdomain/ERROR/stderr: File \"/Users/heyman/projects/locust/locust/stats.py\", line 871, in stats_history_csv\r\n[2020-04-06 13:01:45,708] Jonatans-Air.localdomain/ERROR/stderr:\r\n[2020-04-06 13:01:45,708] Jonatans-Air.localdomain/ERROR/stderr: percentile_str = ','.join([\r\n[2020-04-06 13:01:45,708] Jonatans-Air.localdomain/ERROR/stderr:\r\n[2020-04-06 13:01:45,708] Jonatans-Air.localdomain/ERROR/stderr: File \"/Users/heyman/projects/locust/locust/stats.py\", line 872, in <listcomp>\r\n[2020-04-06 13:01:45,709] Jonatans-Air.localdomain/ERROR/stderr:\r\n[2020-04-06 13:01:45,710] Jonatans-Air.localdomain/ERROR/stderr: str(int(s.get_current_response_time_percentile(x) or 0)) for x in PERCENTILES_TO_REPORT])\r\n[2020-04-06 13:01:45,710] Jonatans-Air.localdomain/ERROR/stderr:\r\n[2020-04-06 13:01:45,710] Jonatans-Air.localdomain/ERROR/stderr: File \"/Users/heyman/projects/locust/locust/stats.py\", line 508, in get_current_response_time_percentile\r\n[2020-04-06 13:01:45,711] Jonatans-Air.localdomain/ERROR/stderr:\r\n[2020-04-06 13:01:45,711] Jonatans-Air.localdomain/ERROR/stderr: raise ValueError(\"StatsEntry.use_response_times_cache must be set to True if we should be able to calculate the _current_ response time percentile\")\r\n[2020-04-06 13:01:45,711] Jonatans-Air.localdomain/ERROR/stderr:\r\n[2020-04-06 13:01:45,711] Jonatans-Air.localdomain/ERROR/stderr: ValueError\r\n[2020-04-06 13:01:45,711] Jonatans-Air.localdomain/ERROR/stderr: :\r\n[2020-04-06 13:01:45,711] Jonatans-Air.localdomain/ERROR/stderr: StatsEntry.use_response_times_cache must be set to True if we should be able to calculate the _current_ response time percentile\r\n[2020-04-06 13:01:45,711] Jonatans-Air.localdomain/ERROR/stderr:\r\n```\r\n</details>\r\n\r\n### Steps to reproduce\r\n\r\nStart a locust master node with the `--csv` and `--csv-full-history` options, and at least one Worker node. \r\n\r\n### Problem & possible solutions\r\n\r\nIn order to be able to calculate *current* response time percentiles (for the last 10 seconds) we copy the response times dict every second and cache it for the past 20 seconds. For performance and memory reasons (IIRC) we only do this for the Aggregated `StatsEntry`, however  this seems to have been turned on (probably without knowing the full implications) by d7c76569, but that would not turn on response time caching for the Master node stats when running Locust distributed.\r\n\r\nAs I see it we have two options.\r\n\r\n* It could be that the optimization isn't needed (we've gotten no reports on bad performance since d7c76569 was merged AFAIK), and in that case we should fix so that the response time caching works on the Master node as well. However we would need to do benchmarks to make sure that this doesn't significantly decrease performance or increase memory footprint.\r\n* We could change so that we only report current response times for the Aggregated row in the history CSV file.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1315/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1315/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1307", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1307/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1307/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1307/events", "html_url": "https://github.com/locustio/locust/issues/1307", "id": 593272177, "node_id": "MDU6SXNzdWU1OTMyNzIxNzc=", "number": 1307, "title": "network_timeout is not respected", "user": {"login": "rokcarl", "id": 42874, "node_id": "MDQ6VXNlcjQyODc0", "avatar_url": "https://avatars.githubusercontent.com/u/42874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rokcarl", "html_url": "https://github.com/rokcarl", "followers_url": "https://api.github.com/users/rokcarl/followers", "following_url": "https://api.github.com/users/rokcarl/following{/other_user}", "gists_url": "https://api.github.com/users/rokcarl/gists{/gist_id}", "starred_url": "https://api.github.com/users/rokcarl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rokcarl/subscriptions", "organizations_url": "https://api.github.com/users/rokcarl/orgs", "repos_url": "https://api.github.com/users/rokcarl/repos", "events_url": "https://api.github.com/users/rokcarl/events{/privacy}", "received_events_url": "https://api.github.com/users/rokcarl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-04-03T10:12:03Z", "updated_at": "2020-04-06T19:31:40Z", "closed_at": "2020-04-06T18:27:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm using `network_timeout = 1.0` on a `FastHttpLocust` subclass, but the slow pages still succeed. I would expect that after 1.0s, the request would stop and another one would start. Additionally, I would expect the page load to count as an error. What I'm seeing though is that Locust is waiting for the page to load and counting it as a success.\r\n\r\nI know there's a [test](https://github.com/locustio/locust/blob/1ae39d017a3da1165f9ad958413740ef0a51070a/locust/test/test_fasthttp.py#L267) in the codebase for this, but it only checks if there was an error in the slow page, but this could be due to other things.\r\n\r\n<details>\r\n<summary>Code for my Flask test web server `app.py`</summary>\r\n\r\n    import random\r\n    import time\r\n    from flask import Flask\r\n    app = Flask(__name__)\r\n    \r\n    @app.route('/')\r\n    def hello_world():\r\n        time.sleep(random.random() * 0.9)\r\n        return 'Hello, World!'\r\n    \r\n    \r\n    @app.route('/slow')\r\n    def slow():\r\n        sleep = 3 + random.random()\r\n        time.sleep(sleep)\r\n        return f'Took me {sleep} s.'\r\n    \r\n    \r\n    \r\n    @app.route('/400')\r\n    def bad_request():\r\n        return 'Bad Request for your data', 400\r\n\r\n</details>\r\n\r\n<details>\r\n<summary>My `locust.py` file:</summary>\r\n\r\n    from locust import TaskSet\r\n    from locust.contrib.fasthttp import FastHttpLocust\r\n    from locust.wait_time import constant_pacing\r\n    \r\n    \r\n    def index(l):\r\n        l.client.get(\"/slow\")\r\n    \r\n    \r\n    class UserBehavior(TaskSet):\r\n        tasks = {index: 1}\r\n    \r\n    \r\n    class WebsiteUser(FastHttpLocust):\r\n        task_set = UserBehavior\r\n        wait_time = constant_pacing(1.0)\r\n        network_timeout = 1.0\r\n        connection_timeout = 1.0\r\n</details>\r\n\r\nI run the web server with `flask run --reload` (need `pip install flask`) and run the locust without the GUI using `locust -f locust.py --no-web -c 10 -r 10 -t 10s --host http://localhost:5000`.\r\n\r\n<details>\r\n<summary>Here are the results</summary>\r\n\r\n    locust -f locust.py --no-web -c 10 -r 10 -t 10s --host http://localhost:5000\r\n    [2020-04-03 12:07:19,301] Roks-MacBook-Pro-2.local/INFO/locust.runners: Hatching and swarming 10 users at the rate 10 users/s (0 users already running)...\r\n    [2020-04-03 12:07:20,229] Roks-MacBook-Pro-2.local/INFO/locust.runners: All locusts hatched: WebsiteUser: 10 (0 already running)\r\n    [2020-04-03 12:07:20,306] Roks-MacBook-Pro-2.local/INFO/locust.main: Run time limit set to 10 seconds\r\n    [2020-04-03 12:07:20,306] Roks-MacBook-Pro-2.local/INFO/locust.main: Starting Locust 0.14.5\r\n     Name                                                          # reqs      # fails     Avg     Min     Max  |  Median   req/s failures/s\r\n    --------------------------------------------------------------------------------------------------------------------------------------------\r\n    --------------------------------------------------------------------------------------------------------------------------------------------\r\n     Aggregated                                                         0     0(0.00%)       0       0       0  |       0    0.00    0.00\r\n    \r\n     Name                                                          # reqs      # fails     Avg     Min     Max  |  Median   req/s failures/s\r\n    --------------------------------------------------------------------------------------------------------------------------------------------\r\n    --------------------------------------------------------------------------------------------------------------------------------------------\r\n     Aggregated                                                         0     0(0.00%)       0       0       0  |       0    0.00    0.00\r\n    \r\n     Name                                                          # reqs      # fails     Avg     Min     Max  |  Median   req/s failures/s\r\n    --------------------------------------------------------------------------------------------------------------------------------------------\r\n     GET /slow                                                         10     0(0.00%)    3574    3100    4001  |    3400    0.00    0.00\r\n    --------------------------------------------------------------------------------------------------------------------------------------------\r\n     Aggregated                                                        10     0(0.00%)    3574    3100    4001  |    3400    0.00    0.00\r\n    \r\n     Name                                                          # reqs      # fails     Avg     Min     Max  |  Median   req/s failures/s\r\n    --------------------------------------------------------------------------------------------------------------------------------------------\r\n     GET /slow                                                         10     0(0.00%)    3574    3100    4001  |    3400    0.00    0.00\r\n    --------------------------------------------------------------------------------------------------------------------------------------------\r\n     Aggregated                                                        10     0(0.00%)    3574    3100    4001  |    3400    0.00    0.00\r\n    \r\n     Name                                                          # reqs      # fails     Avg     Min     Max  |  Median   req/s failures/s\r\n    --------------------------------------------------------------------------------------------------------------------------------------------\r\n     GET /slow                                                         20     0(0.00%)    3516    3095    4001  |    3400    1.43    0.00\r\n    --------------------------------------------------------------------------------------------------------------------------------------------\r\n     Aggregated                                                        20     0(0.00%)    3516    3095    4001  |    3400    1.43    0.00\r\n    \r\n    [2020-04-03 12:07:30,307] Roks-MacBook-Pro-2.local/INFO/locust.main: Time limit reached. Stopping Locust.\r\n    [2020-04-03 12:07:30,309] Roks-MacBook-Pro-2.local/INFO/locust.main: Shutting down (exit code 0), bye.\r\n    [2020-04-03 12:07:30,309] Roks-MacBook-Pro-2.local/INFO/locust.main: Cleaning up runner...\r\n    [2020-04-03 12:07:30,309] Roks-MacBook-Pro-2.local/INFO/locust.main: Running teardowns...\r\n     Name                                                          # reqs      # fails     Avg     Min     Max  |  Median   req/s failures/s\r\n    --------------------------------------------------------------------------------------------------------------------------------------------\r\n     GET /slow                                                         21     0(0.00%)    3502    3095    4001  |    3400    1.91    0.00\r\n    --------------------------------------------------------------------------------------------------------------------------------------------\r\n     Aggregated                                                        21     0(0.00%)    3502    3095    4001  |    3400    1.91    0.00\r\n    \r\n    Percentage of the requests completed within given times\r\n     Type                 Name                                                           # reqs    50%    66%    75%    80%    90%    95%    98%    99%  99.9% 99.99%   100%\r\n    ------------------------------------------------------------------------------------------------------------------------------------------------------\r\n     GET                  /slow                                                              21   3400   3600   3700   3800   4000   4000   4000   4000   4000   4000   4000\r\n    ------------------------------------------------------------------------------------------------------------------------------------------------------\r\n     None                 Aggregated                                                         21   3400   3600   3700   3800   4000   4000   4000   4000   4000   4000   4000\r\n\r\n</details>\r\n\r\nYou can see that all the requests were successful, but all of them should have failed and there should have been more requests, as each one should fail after 1.0 s.\r\n\r\nEnvironment:\r\n\r\n- OS: Mac OS\r\n- Python version: Python 3.7.1\r\n- Locust version: 0.14.5\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1307/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1307/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1300", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1300/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1300/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1300/events", "html_url": "https://github.com/locustio/locust/issues/1300", "id": 588392305, "node_id": "MDU6SXNzdWU1ODgzOTIzMDU=", "number": 1300, "title": "Empty aggregated result with example.py", "user": {"login": "del-zhenwu", "id": 56623710, "node_id": "MDQ6VXNlcjU2NjIzNzEw", "avatar_url": "https://avatars.githubusercontent.com/u/56623710?v=4", "gravatar_id": "", "url": "https://api.github.com/users/del-zhenwu", "html_url": "https://github.com/del-zhenwu", "followers_url": "https://api.github.com/users/del-zhenwu/followers", "following_url": "https://api.github.com/users/del-zhenwu/following{/other_user}", "gists_url": "https://api.github.com/users/del-zhenwu/gists{/gist_id}", "starred_url": "https://api.github.com/users/del-zhenwu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/del-zhenwu/subscriptions", "organizations_url": "https://api.github.com/users/del-zhenwu/orgs", "repos_url": "https://api.github.com/users/del-zhenwu/repos", "events_url": "https://api.github.com/users/del-zhenwu/events{/privacy}", "received_events_url": "https://api.github.com/users/del-zhenwu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-03-26T12:42:00Z", "updated_at": "2020-04-06T09:53:54Z", "closed_at": "2020-04-06T09:53:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nTest with example.py\r\n```\r\nfrom locust import Locust, TaskSet, task, between\r\n\r\nclass MyTaskSet(TaskSet):\r\n    @task\r\n    def my_task(self):\r\n        print(\"Locust instance (%r) executing my_task\" % (self.locust))\r\n\r\nclass MyLocust(Locust):\r\n    task_set = MyTaskSet\r\n    wait_time = between(1,2)\r\n```\r\n\r\nGot empty report\r\n```\r\n2020-03-26 12:34:20,558] c712a0200be0/INFO/locust.main: Time limit reached. Stopping Locust.\r\n[2020-03-26 12:34:20,559] c712a0200be0/INFO/locust.main: Shutting down (exit code 0), bye.\r\n[2020-03-26 12:34:20,559] c712a0200be0/INFO/locust.main: Cleaning up runner...\r\n[2020-03-26 12:34:20,559] c712a0200be0/INFO/locust.main: Running teardowns...\r\n Name                                                          # reqs      # fails     Avg     Min     Max  |  Median   req/s failures/s\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                         0     0(0.00%)       0       0       0  |       0    0.00    0.00\r\n\r\nPercentage of the requests completed within given times\r\n Type                 Name                                                           # reqs    50%    66%    75%    80%    90%    95%    98%    99%  99.9% 99.99%   100%\r\n------------------------------------------------------------------------------------------------------------------------------------------------------\r\n------------------------------------------------------------------------------------------------------------------------------------------------------\r\n```\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS:\r\n- Python version: 3.7\r\n- Locust version: Latest version\r\n- Locust command line that you ran: `locust -f example.py --no-web -c 10  -t10s`\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1300/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1300/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1296", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1296/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1296/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1296/events", "html_url": "https://github.com/locustio/locust/issues/1296", "id": 586770017, "node_id": "MDU6SXNzdWU1ODY3NzAwMTc=", "number": 1296, "title": "Task hatching in locust", "user": {"login": "Jasnoor1", "id": 22678193, "node_id": "MDQ6VXNlcjIyNjc4MTkz", "avatar_url": "https://avatars.githubusercontent.com/u/22678193?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jasnoor1", "html_url": "https://github.com/Jasnoor1", "followers_url": "https://api.github.com/users/Jasnoor1/followers", "following_url": "https://api.github.com/users/Jasnoor1/following{/other_user}", "gists_url": "https://api.github.com/users/Jasnoor1/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jasnoor1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jasnoor1/subscriptions", "organizations_url": "https://api.github.com/users/Jasnoor1/orgs", "repos_url": "https://api.github.com/users/Jasnoor1/repos", "events_url": "https://api.github.com/users/Jasnoor1/events{/privacy}", "received_events_url": "https://api.github.com/users/Jasnoor1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-24T08:05:58Z", "updated_at": "2020-04-13T21:18:43Z", "closed_at": "2020-04-13T21:18:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\". Do not immediately post your issue here after posting to SO, wait for an answer there instead.\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nWhen we read the csv file in a task in locust, can we not predict the all rows of csv has been read from the csv.\r\n\r\nFor example, i have a csv of 10 rows and i want to pass in the locust for the performance and i am not seeing any way to see whether this all 10 rows has been hatched during the performance\r\n\r\n### Expected behavior\r\n<!-- Tell us what you think should happen -->\r\n\r\nI want that the csv hatched once for all the rows.\r\n\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead. Include screenshots if this an issue with the GUI. -->\r\n\r\n\r\nIt hatched the csv randomly and some time it hatched the same row again and again.\r\n\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example) --> \r\n\r\n### Environment\r\n\r\n- OS: Unix\r\n- Python version: 2.7\r\n- Locust version: 0.7.5\r\n- Locust command line that you ran:\r\n- Locust file contents (anonymized if necessary):\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1296/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1296/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1295", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1295/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1295/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1295/events", "html_url": "https://github.com/locustio/locust/issues/1295", "id": 586473349, "node_id": "MDU6SXNzdWU1ODY0NzMzNDk=", "number": 1295, "title": "on_master_stop_hatching is not triggered on master when hatching terminates", "user": {"login": "endejoli", "id": 16251873, "node_id": "MDQ6VXNlcjE2MjUxODcz", "avatar_url": "https://avatars.githubusercontent.com/u/16251873?v=4", "gravatar_id": "", "url": "https://api.github.com/users/endejoli", "html_url": "https://github.com/endejoli", "followers_url": "https://api.github.com/users/endejoli/followers", "following_url": "https://api.github.com/users/endejoli/following{/other_user}", "gists_url": "https://api.github.com/users/endejoli/gists{/gist_id}", "starred_url": "https://api.github.com/users/endejoli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/endejoli/subscriptions", "organizations_url": "https://api.github.com/users/endejoli/orgs", "repos_url": "https://api.github.com/users/endejoli/repos", "events_url": "https://api.github.com/users/endejoli/events{/privacy}", "received_events_url": "https://api.github.com/users/endejoli/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-03-23T19:43:30Z", "updated_at": "2020-06-06T08:52:53Z", "closed_at": "2020-06-06T08:52:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nWhen the hatching terminates on_master_stop_hatching  is not triggered on the master but on_master_start_hatching triggers just fine\r\n\r\nLocustfile.py\r\n-------------\r\nfrom locust import Locust, HttpLocust, TaskSet, task, between, events\r\nimport json,time\r\nclass UserBehavior(TaskSet):\r\n      \r\n    @task(1)    \r\n    def create_item(self):\r\n        headers = {'content-type': 'application/json'}\r\n        self.client.post(\"/create\",data= json.dumps({\r\n          \"title\": \"PT\",\r\n          \"description\": \"This  is used for performance test\"\r\n    }), \r\n    headers=headers, \r\n    name = \"Create a new item\")\r\n\r\n    @task(1)    \r\n    def list_items(self):\r\n        headers = {'content-type': 'application/json'}\r\n        self.client.get(\"/list\", \r\n        headers=headers, \r\n        name = \"List all items\")\r\nclass WebsiteUser(HttpLocust):\r\n    def setup(self):\r\n      print(\"Hello.. I am just starting the test\")\r\n    task_set = UserBehavior\r\n    wait_time = between(3, 25)\r\n    def on_master_stop_hatching():\r\n      print(\"***************************\")\r\n      print(\"I am stopping on master\")\r\n      print(\"***************************\")\r\n    events.master_stop_hatching += on_master_stop_hatching\r\n\r\nMaster\r\n---------\r\nlocust --host=https://test.com  --master --no-web --expect-slaves=1 -c 10 -r 10 --run-time=10s\r\n\r\nSlave\r\n-----\r\nlocust -f locustfile.py --slave\r\n\r\n### Expected behavior\r\nMaster console should print\r\n ************************************\r\n    \"I am stopping on master\"\r\n************************************\r\n\r\n### Actual behavior\r\n Nothing gets printed \r\n### Steps to reproduce\r\n1. Please use the above locustfile and commands to reproduce the same\r\n\r\n### Environment\r\n\r\n- OS: Windows\r\n- Python version: 3.7.4\r\n- Locust version:  0.14.5\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1295/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1295/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1293", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1293/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1293/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1293/events", "html_url": "https://github.com/locustio/locust/issues/1293", "id": 584915448, "node_id": "MDU6SXNzdWU1ODQ5MTU0NDg=", "number": 1293, "title": "Exception throws on attempt to report request results to master", "user": {"login": "eduardrudko", "id": 38434976, "node_id": "MDQ6VXNlcjM4NDM0OTc2", "avatar_url": "https://avatars.githubusercontent.com/u/38434976?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eduardrudko", "html_url": "https://github.com/eduardrudko", "followers_url": "https://api.github.com/users/eduardrudko/followers", "following_url": "https://api.github.com/users/eduardrudko/following{/other_user}", "gists_url": "https://api.github.com/users/eduardrudko/gists{/gist_id}", "starred_url": "https://api.github.com/users/eduardrudko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eduardrudko/subscriptions", "organizations_url": "https://api.github.com/users/eduardrudko/orgs", "repos_url": "https://api.github.com/users/eduardrudko/repos", "events_url": "https://api.github.com/users/eduardrudko/events{/privacy}", "received_events_url": "https://api.github.com/users/eduardrudko/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-20T08:32:05Z", "updated_at": "2020-03-20T08:46:47Z", "closed_at": "2020-03-20T08:46:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "#899 # Describe the bug\r\nHi all, i'm currently trying to use locust with java client in distributed mode. I have wrote a simple custom task that sends GET request to version.  The approach i'm using described here: https://www.blazemeter.com/blog/locust-performance-testing-using-java-and-kotlin/\r\nSo problem i'm struggling with is that when the following line is executed:\r\nLocust.getInstance().recordSuccess(String requestType, String name, long responseTime, long contentLength);\r\nor \r\nLocust.getInstance().recordFailure(String requestType, String name, long responseTime, String error\r\n\r\nThe Locust master node throwing an exception and states the following:  \r\n[2020-03-20 07:59:40,262] 5e94371d5d92/INFO/locust.util.exception_handler: Exception found on retry 1: -- retry after 1s\r\n\r\nI'm running locust in docker and i've tried different versions of Python and Locust master.\r\nThe most stable combination i've found is Python 3.6 + Locustio 0.11.0\r\n\r\nHere is the full log:\r\ndocker run -ti -p 5557:5557 -p 8089:8089 locust\r\n[2020-03-20 07:46:10,978] 5e94371d5d92/INFO/locust.main: Starting web monitor at *:8089\r\n[2020-03-20 07:46:10,991] 5e94371d5d92/INFO/locust.main: Starting Locust 0.11.0\r\n[2020-03-20 07:59:22,425] 5e94371d5d92/INFO/locust.runners: Client 'macbook0258_226e0d2986be793d6ac910f36f141a4c' reported as ready. Currently 1 clients ready to swarm.\r\n[2020-03-20 07:59:37,413] 5e94371d5d92/INFO/locust.runners: Sending hatch jobs to 1 ready clients\r\n[2020-03-20 07:59:40,262] 5e94371d5d92/INFO/locust.util.exception_handler: Exception found on retry 1: -- retry after 1s\r\n[2020-03-20 07:59:43,269] 5e94371d5d92/INFO/locust.util.exception_handler: Exception found on retry 1: -- retry after 1s\r\n[2020-03-20 07:59:46,272] 5e94371d5d92/INFO/locust.util.exception_handler: Exception found on retry 1: -- retry after 1s\r\n[2020-03-20 07:59:49,281] 5e94371d5d92/INFO/locust.util.exception_handler: Exception found on retry 1: -- retry after 1s\r\n[2020-03-20 07:59:52,254] 5e94371d5d92/INFO/locust.util.exception_handler: Exception found on retry 1: -- retry after 1s\r\n[2020-03-20 07:59:55,261] 5e94371d5d92/INFO/locust.util.exception_handler: Exception found on retry 1: -- retry after 1s\r\n[2020-03-20 07:59:58,267] 5e94371d5d92/INFO/locust.util.exception_handler: Exception found on retry 1: -- retry after 1s\r\n\r\n### Expected behavior\r\nThe request results should have been recorded and displayed on UI\r\n\r\n### Actual behavior\r\nThe request results have not been recorded and exception thrown.\r\n\r\n### Steps to reproduce\r\n1. Implement simple custom task using the instructions described https://www.blazemeter.com/blog/locust-performance-testing-using-java-and-kotlin/\r\n2. In custom task send some simple request and record results\r\n3. Setup Locust master and run the following command : locust -f locust-master.py --master --master-bind-host=127.0.0.1 --master-bind-port=5557\r\n3. Check heartbeat on Locust masters output\r\n4. Goto UI and run performance.\r\n\r\n### Environment\r\n\r\n- OS: macOS Mojave : 10.14.6\r\n- Python version: python:3.6.8\r\n- Locust version: 0.11.0\r\n- Locust command line that you ran: locust -f /locust-master.py --master --master-bind-host=0.0.0.0 --master-bind-port=5557\r\n- Locust file contents (anonymized if necessary):\r\nfrom locust import Locust, TaskSet, task\r\nclass DummyTask(TaskSet):\r\n    @task(1)\r\n    def dummy(self):\r\n        pass\r\nclass Dummy(Locust):\r\n    task_set = DummyTask\r\n\r\nAlso i'm using locust4j lib https://github.com/myzhan/locust4j - 1.0.8\r\n\r\nP.S.\r\nI've tried different approaches, local run, docker, different Python versions, Locust versions, Locust4j versions and OS types, Including Windows 10 and have no ideas anymore whats wrong.\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1293/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1293/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1288", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1288/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1288/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1288/events", "html_url": "https://github.com/locustio/locust/issues/1288", "id": 579798734, "node_id": "MDU6SXNzdWU1Nzk3OTg3MzQ=", "number": 1288, "title": "Can't access web interface", "user": {"login": "agniveshadhikari", "id": 23560829, "node_id": "MDQ6VXNlcjIzNTYwODI5", "avatar_url": "https://avatars.githubusercontent.com/u/23560829?v=4", "gravatar_id": "", "url": "https://api.github.com/users/agniveshadhikari", "html_url": "https://github.com/agniveshadhikari", "followers_url": "https://api.github.com/users/agniveshadhikari/followers", "following_url": "https://api.github.com/users/agniveshadhikari/following{/other_user}", "gists_url": "https://api.github.com/users/agniveshadhikari/gists{/gist_id}", "starred_url": "https://api.github.com/users/agniveshadhikari/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/agniveshadhikari/subscriptions", "organizations_url": "https://api.github.com/users/agniveshadhikari/orgs", "repos_url": "https://api.github.com/users/agniveshadhikari/repos", "events_url": "https://api.github.com/users/agniveshadhikari/events{/privacy}", "received_events_url": "https://api.github.com/users/agniveshadhikari/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-12T09:20:33Z", "updated_at": "2020-03-17T06:03:37Z", "closed_at": "2020-03-17T06:03:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nCan't access web interface\r\n\r\n### Expected behavior\r\nShould be able to access web interface at 127.0.0.1:8089 or localhost:8089\r\n\r\n### Actual behavior\r\nNot able to access web interface at 127.0.0.1:8089 or localhost:8089\r\n\r\n### Steps to reproduce\r\n`$ locust` \r\n\r\n### Environment\r\n\r\n- OS: Win10\r\n- Python version: 3.6.8\r\n- Locust version: 0.14.5\r\n- Locust command line that you ran: locust\r\n- Locust file contents (anonymized if necessary):\r\n\r\n```\r\nfrom locust import HttpLocust, TaskSet, task, between\r\nfrom msal import PublicClientApplication\r\n\r\nclass UserBehaviour(TaskSet):\r\n    def on_start(self):\r\n        print(\"on_start called\")\r\n        self.app = PublicClientApplication(\r\n            \"<app id>\",\r\n            authority=\"<aad authority>\")\r\n\r\n        result = self.app.acquire_token_by_username_password(\r\n            \"<user creds>\",\r\n            \"<user creds>\",\r\n            scopes=[\r\n                \"<microsoft aad scope>\",\r\n            ]\r\n        )\r\n\r\n        if not result:\r\n            raise Exception(\"result is empty, couldn't get first tokem\")\r\n\r\n        print(\"on_start completed\")\r\n\r\n\r\n\r\n    def on_stop(self):\r\n        \"\"\" on_stop is called when the TaskSet is stopping \"\"\"\r\n        pass\r\n\r\n    def getToken(self):\r\n        return self.app.acquire_token_silent(\r\n            [\"<microsoft aad scope>\"],\r\n            account=self.app.get_accounts()[0]\r\n        )['access_token']\r\n    \r\n\r\n    @task(1)\r\n    def farmGetAll(self):\r\n        token = self.getToken()\r\n        self.client.get(\"/Farm\", headers={\"Authorization\": \"Bearer \" + token}, verify=False)\r\n\r\n    @task(1)\r\n    def ruleGetAll(self):\r\n        token = self.getToken()\r\n        self.client.get(\"/Rule\", headers={\"Authorization\": \"Bearer \" + token}, verify=False)\r\n\r\nclass WebsiteUser(HttpLocust):\r\n    task_set = UserBehaviour\r\n    wait_time = between(2, 5)\r\n```\r\n\r\n\r\nLogs from the console:\r\n```\r\n[2020-03-12 14:41:36,066] DESKTOP-SF6MB84/INFO/locust.main: Starting web monitor at http://*:8089\r\n[2020-03-12 14:41:36,066] DESKTOP-SF6MB84/INFO/locust.main: Starting Locust 0.14.5\r\n[2020-03-12 14:41:44,334] DESKTOP-SF6MB84/ERROR/stderr: Traceback (most recent call last):\r\n[2020-03-12 14:41:44,335] DESKTOP-SF6MB84/ERROR/stderr: \r\n[2020-03-12 14:41:44,335] DESKTOP-SF6MB84/ERROR/stderr: File \"c:\\users\\agadhika\\appdata\\local\\programs\\python\\python36\\lib\\site-packages\\gevent\\pywsgi.py\", line 666, in handle_one_request\r\n    if not self.read_request(self.requestline):\r\n[2020-03-12 14:41:44,336] DESKTOP-SF6MB84/ERROR/stderr:\r\n[2020-03-12 14:41:44,341] DESKTOP-SF6MB84/ERROR/stderr: File \"c:\\users\\agadhika\\appdata\\local\\programs\\python\\python36\\lib\\site-packages\\gevent\\pywsgi.py\", line 531, in read_request\r\n    raise _InvalidClientRequest('Invalid HTTP method: %r' % (raw_requestline,))\r\n[2020-03-12 14:41:44,342] DESKTOP-SF6MB84/ERROR/stderr:\r\n[2020-03-12 14:41:44,343] DESKTOP-SF6MB84/ERROR/stderr: gevent.pywsgi._InvalidClientRequest: Invalid HTTP method: '\\x16\\x03\\x01\\x02\\x00\\x01\\x00\\x01\u00fc\\x03\\x0389zya\u00b4RM\u00e6\u00c7\u00f9*\\x87\\x10\\x9d\\x1bY\u00edS\u00b9\u00db\\x05I\u00cdK\\r\u00c5\u00dd\\x85\\x8fX\u00a8 \u00dd\u00a3b\u00e6\\x86p\u00b4\u00fa\\x10\u00c1a\u00ceL\u00b4\u00d7(\u00d1\u00f0`%al\\x08\u00dd?\\x0e[\u00a9p\\t\\x1cQ\\x00\"\u00da\u00da\\x13\\x01\\x13\\x02\\x13\\x03\u00c0+\u00c0/\u00c0,\u00c00\u00cc\u00a9\u00cc\u00a8\u00c0\\x13\u00c0\\x14\\x00\\x9c\\x00\\x9d\\x00/\\x005\\x00\\n'\r\n```\r\n\r\nAt localhost:8089, chrome says:\r\n```\r\nThis site can\u2019t provide a secure connectionlocalhost sent an invalid response.\r\nTry running Windows Network Diagnostics.\r\nERR_SSL_PROTOCOL_ERROR\r\n```\r\n\r\nAt 127.0.0.1:8089, chrome says:\r\n```\r\nThis site can\u2019t be reached127.0.0.1 refused to connect.\r\nTry:\r\n\r\nChecking the connection\r\nChecking the proxy and the firewall\r\nERR_CONNECTION_REFUSED\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1288/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1288/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1279", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1279/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1279/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1279/events", "html_url": "https://github.com/locustio/locust/issues/1279", "id": 577035719, "node_id": "MDU6SXNzdWU1NzcwMzU3MTk=", "number": 1279, "title": "Web page is confused when I shutdown the only slave", "user": {"login": "GuoTengda1993", "id": 36886351, "node_id": "MDQ6VXNlcjM2ODg2MzUx", "avatar_url": "https://avatars.githubusercontent.com/u/36886351?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuoTengda1993", "html_url": "https://github.com/GuoTengda1993", "followers_url": "https://api.github.com/users/GuoTengda1993/followers", "following_url": "https://api.github.com/users/GuoTengda1993/following{/other_user}", "gists_url": "https://api.github.com/users/GuoTengda1993/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuoTengda1993/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuoTengda1993/subscriptions", "organizations_url": "https://api.github.com/users/GuoTengda1993/orgs", "repos_url": "https://api.github.com/users/GuoTengda1993/repos", "events_url": "https://api.github.com/users/GuoTengda1993/events{/privacy}", "received_events_url": "https://api.github.com/users/GuoTengda1993/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149037, "node_id": "MDU6TGFiZWwxNDkwMzc=", "url": "https://api.github.com/repos/locustio/locust/labels/web%20interface", "name": "web interface", "color": "0e8a16", "default": false, "description": null}, {"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-06T16:20:13Z", "updated_at": "2020-04-16T18:16:44Z", "closed_at": "2020-04-16T18:16:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nI started locust as master-slave mode (just 1 slave). When locust is running, I shutdown the slave.\r\nWhen I refresh the web page, it become confused, refresh is useless.\r\n![image](https://user-images.githubusercontent.com/36886351/76100770-385f5c80-6008-11ea-92c7-d8601cf8d2d5.png)\r\nIn console, master already set the slave missing\r\n![console](https://user-images.githubusercontent.com/36886351/76101111-d94e1780-6008-11ea-9219-edfd14e1b6c0.png)\r\n\r\n### Expected behavior\r\nWeb page is OK\r\n\r\n### Actual behavior\r\nSee the image above\r\n\r\n### Steps to reproduce\r\n1. run locust master;\r\n2. run 1 slave;\r\n3. shutdown slave;\r\n4. press \"Stop\" button\r\n5. refresh the web page\r\n\r\n### Environment\r\n\r\n- OS: win 7 x64\r\n- Python version: 3.7.0\r\n- Locust version: 0.14.4\r\n- Locust command line that you ran: locust -f boomer_master.py --master\r\n- Locust file contents (anonymized if necessary):  Golang scripts (drived by boomer), I think it doesn't matter with this bug.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1279/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1279/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1278", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1278/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1278/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1278/events", "html_url": "https://github.com/locustio/locust/issues/1278", "id": 574643942, "node_id": "MDU6SXNzdWU1NzQ2NDM5NDI=", "number": 1278, "title": "[Documentation] Bleeding Edge link is broken", "user": {"login": "JoaoGFarias", "id": 1585655, "node_id": "MDQ6VXNlcjE1ODU2NTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1585655?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JoaoGFarias", "html_url": "https://github.com/JoaoGFarias", "followers_url": "https://api.github.com/users/JoaoGFarias/followers", "following_url": "https://api.github.com/users/JoaoGFarias/following{/other_user}", "gists_url": "https://api.github.com/users/JoaoGFarias/gists{/gist_id}", "starred_url": "https://api.github.com/users/JoaoGFarias/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JoaoGFarias/subscriptions", "organizations_url": "https://api.github.com/users/JoaoGFarias/orgs", "repos_url": "https://api.github.com/users/JoaoGFarias/repos", "events_url": "https://api.github.com/users/JoaoGFarias/events{/privacy}", "received_events_url": "https://api.github.com/users/JoaoGFarias/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-03T12:47:05Z", "updated_at": "2020-03-03T15:37:13Z", "closed_at": "2020-03-03T15:37:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\nThe link for the Bleeding Edge version, as described [here](https://github.com/locustio/locust/blob/8f7b6328f7a12282474d6d9ba8283ba4b594da1e/docs/installation.rst) is broken.\r\n\r\n### Expected behavior\r\nThe link should work :)\r\n\r\n### Actual behavior\r\n```pip install``` doesn't work on the link.\r\n\r\n![image](https://user-images.githubusercontent.com/1585655/75776996-68330980-5d55-11ea-9c4d-99a1270f8326.png)\r\n\r\n\r\n### Steps to reproduce\r\nRun ```pip3 install -e git://github.com/locustio/locust.git@master#egg=locustio```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1278/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1278/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1277", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1277/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1277/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1277/events", "html_url": "https://github.com/locustio/locust/issues/1277", "id": 574391508, "node_id": "MDU6SXNzdWU1NzQzOTE1MDg=", "number": 1277, "title": "I had increase open file limit but still exception \"Device or resource busy\"? ", "user": {"login": "theanhvo", "id": 22842153, "node_id": "MDQ6VXNlcjIyODQyMTUz", "avatar_url": "https://avatars.githubusercontent.com/u/22842153?v=4", "gravatar_id": "", "url": "https://api.github.com/users/theanhvo", "html_url": "https://github.com/theanhvo", "followers_url": "https://api.github.com/users/theanhvo/followers", "following_url": "https://api.github.com/users/theanhvo/following{/other_user}", "gists_url": "https://api.github.com/users/theanhvo/gists{/gist_id}", "starred_url": "https://api.github.com/users/theanhvo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/theanhvo/subscriptions", "organizations_url": "https://api.github.com/users/theanhvo/orgs", "repos_url": "https://api.github.com/users/theanhvo/repos", "events_url": "https://api.github.com/users/theanhvo/events{/privacy}", "received_events_url": "https://api.github.com/users/theanhvo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-03T03:29:00Z", "updated_at": "2020-04-12T22:16:43Z", "closed_at": "2020-04-12T22:16:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "With Logs\r\n```\r\nMar  3 09:32:32 loadtest-v2 locust: thread_result.set(func(*args, **kwargs))\r\nMar  3 09:32:32 loadtest-v2 locust: [2020-03-03 09:32:32,558] loadtest-v2/ERROR/stderr:\r\nMar  3 09:32:32 loadtest-v2 locust: [2020-03-03 09:32:32,558] loadtest-v2/ERROR/stderr: OSError: [Errno 16] Device or resource busy\r\nMar  3 09:32:32 loadtest-v2 locust: [2020-03-03 09:32:32,558] loadtest-v2/ERROR/stderr:\r\nMar  3 09:32:32 loadtest-v2 locust: [2020-03-03 09:32:32,558] loadtest-v2/ERROR/stderr: 2020-03-03T02:32:32Z\r\nMar  3 09:32:32 loadtest-v2 locust: [2020-03-03 09:32:32,559] loadtest-v2/ERROR/stderr:\r\nMar  3 09:32:32 loadtest-v2 locust: [2020-03-03 09:32:32,559] loadtest-v2/ERROR/stderr: (<ThreadPoolWorker at 0x7f6f9aa7ccc0 thread_ident=0x7f6f8dbe5700 hub=<Hub at 0x7f6f93947588 thread_ident=0x7f6fa2693740>>, <built-in function getaddrinfo>) failed with OSError\r\nMar  3 09:32:32 loadtest-v2 locust: [2020-03-03 09:32:32,559] loadtest-v2/ERROR/stderr: Traceback (most recent call last):\r\nMar  3 09:33:11 loadtest-v2 locust: [2020-03-03 09:33:11,683] loadtest-v2/WARNING/urllib3.connectionpool: Connection pool is full, discarding connection: ...\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1277/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1277/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1276", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1276/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1276/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1276/events", "html_url": "https://github.com/locustio/locust/issues/1276", "id": 574351518, "node_id": "MDU6SXNzdWU1NzQzNTE1MTg=", "number": 1276, "title": "Locust Web Dashboard Charts, Slaves sections not working after certain time", "user": {"login": "abinjaik", "id": 26336277, "node_id": "MDQ6VXNlcjI2MzM2Mjc3", "avatar_url": "https://avatars.githubusercontent.com/u/26336277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abinjaik", "html_url": "https://github.com/abinjaik", "followers_url": "https://api.github.com/users/abinjaik/followers", "following_url": "https://api.github.com/users/abinjaik/following{/other_user}", "gists_url": "https://api.github.com/users/abinjaik/gists{/gist_id}", "starred_url": "https://api.github.com/users/abinjaik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abinjaik/subscriptions", "organizations_url": "https://api.github.com/users/abinjaik/orgs", "repos_url": "https://api.github.com/users/abinjaik/repos", "events_url": "https://api.github.com/users/abinjaik/events{/privacy}", "received_events_url": "https://api.github.com/users/abinjaik/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149037, "node_id": "MDU6TGFiZWwxNDkwMzc=", "url": "https://api.github.com/repos/locustio/locust/labels/web%20interface", "name": "web interface", "color": "0e8a16", "default": false, "description": null}, {"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2020-03-03T01:13:18Z", "updated_at": "2020-03-12T13:16:18Z", "closed_at": "2020-03-12T13:16:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "We are getting issues on Locust Web Dashboard after some time or certain load. Initially we thought its related to errors on our scripts, but even with zero errors/exception on our locust scripts we are getting \"Charts\" with no graphs or values on it . Same with \"Slaves\" Tab, its not displaying any info at all. Also, the top right on dashboard we have a RPS indicator that also fails. I did refresh few times, its only showing latest data on \"Statistics\" tab, **but \"Charts\", \"Slaves\" tab have no information. We are using Locust 0.14.4.. I saw different bug with similar description, but that tells it got fixed with an earlier version.\r\n\r\n**I checked Firefox browser console and its displaying an error on locust.js -SyntaxError: invalid escape sequence**\r\n\r\n![image](https://user-images.githubusercontent.com/26336277/75732724-24ce9180-5ca8-11ea-81e3-b4fc9fc58a36.png)\r\n\r\nI tried the same with Chrome, it is also pointing with locust.js file\r\n\r\n![image](https://user-images.githubusercontent.com/26336277/75732782-55163000-5ca8-11ea-8897-95542a3e4f07.png)\r\n\r\n[UPDATE] : Its seems this error happens when there are more RPS, when we tried with a \"sleep\" inside our Locust code --- we were able to run for quite a long than previous runs, but in the end it failed.\r\n\r\nPlease help with your inputs.\r\n\r\n\r\n\r\n\r\n\r\n### Environment\r\nOS: Linux Ubuntu( acutally a VM on Azure) - Linux 5.0.0-1032-azure x86_64\r\nPython version: Python 3.6.9\r\nLocust version: locust 0.14.4", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1276/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1276/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1263", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1263/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1263/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1263/events", "html_url": "https://github.com/locustio/locust/issues/1263", "id": 568499268, "node_id": "MDU6SXNzdWU1Njg0OTkyNjg=", "number": 1263, "title": "Connection pool is full, discarding connection | 'Connection aborted.', RemoteDisconnected('Remote end closed connection without response", "user": {"login": "abinjaik", "id": 26336277, "node_id": "MDQ6VXNlcjI2MzM2Mjc3", "avatar_url": "https://avatars.githubusercontent.com/u/26336277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abinjaik", "html_url": "https://github.com/abinjaik", "followers_url": "https://api.github.com/users/abinjaik/followers", "following_url": "https://api.github.com/users/abinjaik/following{/other_user}", "gists_url": "https://api.github.com/users/abinjaik/gists{/gist_id}", "starred_url": "https://api.github.com/users/abinjaik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abinjaik/subscriptions", "organizations_url": "https://api.github.com/users/abinjaik/orgs", "repos_url": "https://api.github.com/users/abinjaik/repos", "events_url": "https://api.github.com/users/abinjaik/events{/privacy}", "received_events_url": "https://api.github.com/users/abinjaik/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 20, "created_at": "2020-02-20T18:49:58Z", "updated_at": "2020-03-03T00:58:07Z", "closed_at": "2020-03-03T00:58:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am new to Locust Load testing framework and in process of migrating my existing Azure cloud based Performance testing C# scripts to Locust's Python based scripts. Our team almost completed migration of scripts. But during our load tests, we are getting errors as below, which fails to create new requests from the machine due to high CPU utilization or because of so many exception on Locust. We are running with Locust web based mode - details are indicated below. These scripts are working fine on smaller loads of 50 to 100 users. Issue happens only when we run tests with higher loads above 500 to 3500 users\r\n\r\n\"Error 1 -('Connection aborted.', RemoteDisconnected('Remote end closed connection without response',))\"\r\n\r\n\"Error 2 : Connection pool is full, discarding connection\"\r\n\r\n### Environment\r\nOur Load testing configurations are : \"3500 users at a hatch rate of 5 users per second\". Running natively(no docker container) on a 8 Core , 16 Gb Linux Ubuntu Virtual machine on Azure. ulimit set as 50,000 on Linux machine.\r\n\r\nPlease help us with your thoughts\r\n\r\n###sample code\r\nimport os \r\nimport sys\r\nsys.path.append(os.environ.get('WORKDIR', os.getcwd()))\r\n\r\nfrom locust import HttpLocust, TaskSet, task\r\nfrom locust.wait_time import between\r\n\r\nclass ContactUsBehavior(TaskSet):\r\n\r\n\r\n    wait_time = AppUtil.get_wait_time_function(2)\r\n\r\n\r\n    @task(1)\r\n    def post_load_test_contact(self):\r\n        data = { \"ContactName\" : \"Mane\"\r\n            , \"Email\" : \"someone@someone.com\"\r\n            , \"EmailVerifaction\" : \"someone@someone.com\"\r\n            , \"TelephoneContact\" : \"\"\r\n            , \"PhoneNumber\" : \"\"\r\n            , \"ContactReason\" : \"Other\"            \r\n            , \"OtherComment\" : \"TEST Comments 2019-12-30\"\r\n            , \"Agree\" : \"true\"\r\n             }\r\n        self.client.post(\"app/contactform\", self.client, 'Contact us submission', post_data = data)\r\n\r\n\r\nclass UnauthenticatedUser(HttpLocust):\r\n    task_set = ContactUsBehavior\r\n    # host is override-able\r\n    host = 'https://app.devurl.com/'\r\n\r\n\r\n- OS: Linux Ubuntu( acutally a VM on Azure)  - Linux 5.0.0-1032-azure x86_64\r\n- Python version: Python 3.6.9\r\n- Locust version: locust 0.14.4\r\n- Locust command line that you ran:~/LocustPythonScripts$ locust -f LocustTestCases.py -H https://appURL/ GeneralUser\r\n- Locust file contents (anonymized if necessary): see above sample file", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1263/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1263/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1262", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1262/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1262/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1262/events", "html_url": "https://github.com/locustio/locust/issues/1262", "id": 568261700, "node_id": "MDU6SXNzdWU1NjgyNjE3MDA=", "number": 1262, "title": "Malformed urls when passing a relative path without initial slash to HttpSession.get and similar methods", "user": {"login": "dennisvang", "id": 29799340, "node_id": "MDQ6VXNlcjI5Nzk5MzQw", "avatar_url": "https://avatars.githubusercontent.com/u/29799340?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dennisvang", "html_url": "https://github.com/dennisvang", "followers_url": "https://api.github.com/users/dennisvang/followers", "following_url": "https://api.github.com/users/dennisvang/following{/other_user}", "gists_url": "https://api.github.com/users/dennisvang/gists{/gist_id}", "starred_url": "https://api.github.com/users/dennisvang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dennisvang/subscriptions", "organizations_url": "https://api.github.com/users/dennisvang/orgs", "repos_url": "https://api.github.com/users/dennisvang/repos", "events_url": "https://api.github.com/users/dennisvang/events{/privacy}", "received_events_url": "https://api.github.com/users/dennisvang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}, {"id": 2115072627, "node_id": "MDU6TGFiZWwyMTE1MDcyNjI3", "url": "https://api.github.com/repos/locustio/locust/labels/non-critical", "name": "non-critical", "color": "c4e4c9", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-02-20T12:20:09Z", "updated_at": "2020-11-12T17:54:30Z", "closed_at": "2020-11-12T17:54:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\nWhen specifying a host *without trailing slash*, e.g. `https://httpbin.org` and then sending a request using a relative url (path) *without an initial slash*, e.g. `self.client.get('anything')`, the resulting url is malformed, e.g. `'https://httpbin.organything'`, causing corresponding task to fail. \r\n\r\n\r\n### Expected behavior\r\n\r\nI would expect the url to be built correctly, regardless of any missing or redundant slashes at the end of the specified host or at the start of the path.\r\n\r\nFor example, using `urlunparse` would give the desired result, e.g. `urlunparse(['https','httpbin.org','anything','','',''])` results in `'https://httpbin.org/anything'`, as expected.\r\n\r\nNote that `urlunparse` is already used elsewhere, [e.g. for the base_url](https://github.com/locustio/locust/blob/master/locust/clients.py#L62), so why not use it here as well? \r\n\r\nPerhaps this should be an enhancement request, rather than a bug report, but it may lead to unexpected results.\r\n\r\nSome references: [RFC 1808 section 2.1](https://tools.ietf.org/html/rfc1808#section-2.1), [RFC 1738 section 3.1](https://tools.ietf.org/html/rfc1738#section-3.1)\r\n\r\n### Actual behavior\r\n\r\nRelative path is appended to host without regard for slashes:\r\n\r\n`host = 'https://httpbin.org'` and path `'anything'` results in absolute url `'https://httpbin.organything'`\r\n\r\nCaused by the `_build_url` method: https://github.com/locustio/locust/blob/master/locust/clients.py#L71\r\n\r\n\r\n### Steps to reproduce\r\n\r\nHere's a minimal example:\r\n\r\n    from locust import HttpLocust, TaskSet, between, task\r\n\r\n\r\n    class UserBehavior(TaskSet):\r\n\r\n        @task(1)\r\n        def with_initial_slash(self):\r\n            self.client.get('/anything')\r\n\r\n        @task(1)\r\n        def without_initial_slash(self):\r\n            self.client.get('anything')\r\n\r\n\r\n    class WebsiteUser(HttpLocust):\r\n        host = 'https://httpbin.org'  # no trailing slash\r\n        task_set = UserBehavior\r\n        wait_time = between(1, 2)\r\n\r\n\r\n### Environment\r\n\r\n- OS: ubuntu 18 LTS\r\n- Python version: 3.7\r\n- Locust version: 0.14.4\r\n- Locust command line that you ran: `locust -f minimal_example.py`\r\n- Locust file contents (anonymized if necessary): see above", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1262/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1262/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1258", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1258/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1258/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1258/events", "html_url": "https://github.com/locustio/locust/issues/1258", "id": 566872284, "node_id": "MDU6SXNzdWU1NjY4NzIyODQ=", "number": 1258, "title": "Code blocks in docs not rendered", "user": {"login": "grahamrhay", "id": 180700, "node_id": "MDQ6VXNlcjE4MDcwMA==", "avatar_url": "https://avatars.githubusercontent.com/u/180700?v=4", "gravatar_id": "", "url": "https://api.github.com/users/grahamrhay", "html_url": "https://github.com/grahamrhay", "followers_url": "https://api.github.com/users/grahamrhay/followers", "following_url": "https://api.github.com/users/grahamrhay/following{/other_user}", "gists_url": "https://api.github.com/users/grahamrhay/gists{/gist_id}", "starred_url": "https://api.github.com/users/grahamrhay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/grahamrhay/subscriptions", "organizations_url": "https://api.github.com/users/grahamrhay/orgs", "repos_url": "https://api.github.com/users/grahamrhay/repos", "events_url": "https://api.github.com/users/grahamrhay/events{/privacy}", "received_events_url": "https://api.github.com/users/grahamrhay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-02-18T12:51:53Z", "updated_at": "2020-02-19T09:23:06Z", "closed_at": "2020-02-19T09:15:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\nThis could be a problem with my browser, but some of the code blocks in the docs aren't rendered:\r\n\r\n![image](https://user-images.githubusercontent.com/180700/74737552-f46d0900-524c-11ea-8637-fde17a282321.png)\r\n\r\nSame on GH: https://github.com/locustio/locust/blob/master/docs/running-locust-docker.rst (I had to look at the raw version to see the info)\r\n\r\n### Expected behavior\r\n\r\nCode blocks are rendered\r\n\r\n### Actual behavior\r\n\r\nCode blocks are not rendered (see screenshot above)\r\n\r\n### Steps to reproduce\r\n\r\nGo to https://docs.locust.io/en/stable/running-locust-docker.html\r\n\r\n### Environment\r\n\r\nChromium 79 on Arch Linux (Gnome). Tried in incognito just to make sure it wasn't one of my plugins", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1258/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1258/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1257", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1257/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1257/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1257/events", "html_url": "https://github.com/locustio/locust/issues/1257", "id": 565085260, "node_id": "MDU6SXNzdWU1NjUwODUyNjA=", "number": 1257, "title": "Issue with gevent ", "user": {"login": "JulioBarros", "id": 17699, "node_id": "MDQ6VXNlcjE3Njk5", "avatar_url": "https://avatars.githubusercontent.com/u/17699?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JulioBarros", "html_url": "https://github.com/JulioBarros", "followers_url": "https://api.github.com/users/JulioBarros/followers", "following_url": "https://api.github.com/users/JulioBarros/following{/other_user}", "gists_url": "https://api.github.com/users/JulioBarros/gists{/gist_id}", "starred_url": "https://api.github.com/users/JulioBarros/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JulioBarros/subscriptions", "organizations_url": "https://api.github.com/users/JulioBarros/orgs", "repos_url": "https://api.github.com/users/JulioBarros/repos", "events_url": "https://api.github.com/users/JulioBarros/events{/privacy}", "received_events_url": "https://api.github.com/users/JulioBarros/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 16, "created_at": "2020-02-14T03:45:38Z", "updated_at": "2020-03-23T18:16:26Z", "closed_at": "2020-03-23T18:16:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\nLocust had been running fine a few months ago. Went to start it the other day and started getting errors in gevent/_tblib.py, line 202 - TypeError: an integer is required (got type bytes). Then the process exits.\r\n\r\nI don't know what could have changed in the meantime. I had been using 0.13.02 tried 0.14.4 and got the same error.  I'm on Mac OS X 10.15.3 with libev: stable 4.31.\r\n\r\n### Expected behavior\r\nIt should have run as normal\r\n\r\n### Actual behavior\r\nThrows exception and quits.\r\n\r\n### Steps to reproduce\r\nNot sure. Don't think it is a code error.\r\n\r\n### Environment\r\n\r\n- OS: Mac OS X 10.15.3 \r\n- Python version: 3.7 & 3.8\r\n- Locust version:  0.13.02 and 0.14.4\r\n- Locust command line that you ran: locust\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1257/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1257/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1254", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1254/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1254/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1254/events", "html_url": "https://github.com/locustio/locust/issues/1254", "id": 560296172, "node_id": "MDU6SXNzdWU1NjAyOTYxNzI=", "number": 1254, "title": "Unable to install on windows", "user": {"login": "scottkirwanthomas", "id": 1726379, "node_id": "MDQ6VXNlcjE3MjYzNzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1726379?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scottkirwanthomas", "html_url": "https://github.com/scottkirwanthomas", "followers_url": "https://api.github.com/users/scottkirwanthomas/followers", "following_url": "https://api.github.com/users/scottkirwanthomas/following{/other_user}", "gists_url": "https://api.github.com/users/scottkirwanthomas/gists{/gist_id}", "starred_url": "https://api.github.com/users/scottkirwanthomas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scottkirwanthomas/subscriptions", "organizations_url": "https://api.github.com/users/scottkirwanthomas/orgs", "repos_url": "https://api.github.com/users/scottkirwanthomas/repos", "events_url": "https://api.github.com/users/scottkirwanthomas/events{/privacy}", "received_events_url": "https://api.github.com/users/scottkirwanthomas/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2020-02-05T11:01:31Z", "updated_at": "2022-11-28T09:06:51Z", "closed_at": "2020-02-06T10:34:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI'm unable to install on widows 10.  I've tried python version 3.8 and downgraded to 3.7.6 as a colleague has successfully installed locust with this version.\r\n\r\nIt still fails.  It always provides the following: \r\n\r\n\"ERROR: Could not build wheels for gevent which use PEP 517 and cannot be installed directly\"\r\n\r\nI've tried installing the compiled gevent as per the locust installation instructions but that doesnt work either.\r\n\r\nI'm at a loss, please help.\r\n\r\nFull Exception is:\r\n```\r\n ERROR: Command errored out with exit status 1:\r\n   command: 'c:\\program files\\python37\\python.exe' 'c:\\program files\\python37\\lib\\site-packages\\pip\\_vendor\\pep517\\_in_process.py' build_wheel 'C:\\Users\\u6073762\\AppData\\Local\\Temp\\tmp67jt7egq'\r\n       cwd: C:\\Users\\u6073762\\AppData\\Local\\Temp\\pip-install-z1pqeevk\\gevent\r\n  Complete output (470 lines):\r\n  running bdist_wheel\r\n  running build\r\n  running build_py\r\n  creating build\r\n  creating build\\lib.win-amd64-3.7\r\n  creating build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\ares.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\backdoor.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\baseserver.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\builtins.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\core.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\event.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\events.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\exceptions.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\fileobject.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\greenlet.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\hub.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\local.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\lock.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\monkey.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\os.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\pool.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\pywsgi.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\queue.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\resolver_ares.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\resolver_thread.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\select.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\server.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\signal.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\socket.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\ssl.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\subprocess.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\thread.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\threading.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\threadpool.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\time.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\timeout.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\util.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\win32util.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_abstract_linkable.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_compat.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_config.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_fileobjectcommon.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_fileobjectposix.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_greenlet_primitives.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_hub_local.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_hub_primitives.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_ident.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_imap.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_interfaces.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_monitor.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_patcher.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_semaphore.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_socket2.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_socket3.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_socketcommon.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_ssl2.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_ssl3.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_sslgte279.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_tblib.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_threading.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_tracer.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_util.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_util_py2.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_waiter.py -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\__init__.py -> build\\lib.win-amd64-3.7\\gevent\r\n  creating build\\lib.win-amd64-3.7\\gevent\\libev\r\n  copying src\\gevent\\libev\\corecffi.py -> build\\lib.win-amd64-3.7\\gevent\\libev\r\n  copying src\\gevent\\libev\\watcher.py -> build\\lib.win-amd64-3.7\\gevent\\libev\r\n  copying src\\gevent\\libev\\_corecffi_build.py -> build\\lib.win-amd64-3.7\\gevent\\libev\r\n  copying src\\gevent\\libev\\__init__.py -> build\\lib.win-amd64-3.7\\gevent\\libev\r\n  creating build\\lib.win-amd64-3.7\\gevent\\libuv\r\n  copying src\\gevent\\libuv\\loop.py -> build\\lib.win-amd64-3.7\\gevent\\libuv\r\n  copying src\\gevent\\libuv\\watcher.py -> build\\lib.win-amd64-3.7\\gevent\\libuv\r\n  copying src\\gevent\\libuv\\_corecffi_build.py -> build\\lib.win-amd64-3.7\\gevent\\libuv\r\n  copying src\\gevent\\libuv\\__init__.py -> build\\lib.win-amd64-3.7\\gevent\\libuv\r\n  creating build\\lib.win-amd64-3.7\\gevent\\resolver\r\n  copying src\\gevent\\resolver\\ares.py -> build\\lib.win-amd64-3.7\\gevent\\resolver\r\n  copying src\\gevent\\resolver\\blocking.py -> build\\lib.win-amd64-3.7\\gevent\\resolver\r\n  copying src\\gevent\\resolver\\dnspython.py -> build\\lib.win-amd64-3.7\\gevent\\resolver\r\n  copying src\\gevent\\resolver\\thread.py -> build\\lib.win-amd64-3.7\\gevent\\resolver\r\n  copying src\\gevent\\resolver\\_addresses.py -> build\\lib.win-amd64-3.7\\gevent\\resolver\r\n  copying src\\gevent\\resolver\\_hostsfile.py -> build\\lib.win-amd64-3.7\\gevent\\resolver\r\n  copying src\\gevent\\resolver\\__init__.py -> build\\lib.win-amd64-3.7\\gevent\\resolver\r\n  creating build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\errorhandler.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\exception.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\flaky.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\hub.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\leakcheck.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\modules.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\monkey_test.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\openfiles.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\params.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\patched_tests_setup.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\resources.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\six.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\skipping.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\sockets.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\support.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\switching.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\sysinfo.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\testcase.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\testrunner.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\timing.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\travis.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\util.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  copying src\\gevent\\testing\\__init__.py -> build\\lib.win-amd64-3.7\\gevent\\testing\r\n  creating build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\getaddrinfo_module.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\known_failures.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\lock_tests.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__all__.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__api.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__api_timeout.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__ares_host_result.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__ares_timeout.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__backdoor.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__close_backend_fd.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__compat.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__core.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__core_async.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__core_callback.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__core_fork.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__core_loop_run.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__core_loop_run_sig_mod.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__core_stat.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__core_timer.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__core_watcher.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__destroy.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__destroy_default_loop.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__doctests.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__environ.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__event.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__events.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__examples.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__example_echoserver.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__example_portforwarder.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__example_udp_client.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__example_udp_server.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__example_webproxy.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__example_wsgiserver.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__example_wsgiserver_ssl.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__exc_info.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__execmodules.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__fileobject.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__getaddrinfo_import.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__greenio.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__greenlet.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__GreenletExit.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__greenletset.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__greenness.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__hub.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__hub_join.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__hub_join_timeout.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__import_blocking_in_greenlet.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__import_wait.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__issue112.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__issue230.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__issue330.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__issue467.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__issue6.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__issue600.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__issue607.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__issue639.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__issues461_471.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__issue_728.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__iwait.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__joinall.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__local.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__loop_callback.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__makefile_ref.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__memleak.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__monkey.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__monkey_builtins_future.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__monkey_futures_thread.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__monkey_hub_in_thread.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__monkey_logging.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__monkey_multiple_imports.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__monkey_queue.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__monkey_scope.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__monkey_selectors.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__monkey_sigchld.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__monkey_sigchld_2.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__monkey_sigchld_3.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__monkey_ssl_warning.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__monkey_ssl_warning2.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__monkey_ssl_warning3.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__nondefaultloop.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__order.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__os.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__pool.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__pywsgi.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__queue.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__real_greenlet.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__refcount.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__refcount_core.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__select.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__semaphore.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__server.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__server_pywsgi.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__signal.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__sleep0.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__socket.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__socketpair.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__socket_close.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__socket_dns.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__socket_dns6.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__socket_errors.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__socket_ex.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__socket_send_memoryview.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__socket_ssl.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__socket_timeout.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__ssl.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__subprocess.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__subprocess_interrupted.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__subprocess_poll.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__systemerror.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__threading.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__threading_2.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__threading_before_monkey.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__threading_holding_lock_while_monkey.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__threading_monkey_in_thread.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__threading_native_before_monkey.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__threading_patched_local.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__threading_vs_settrace.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__threadpool.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__threadpool_executor_patched.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__timeout.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test__util.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test___config.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test___ident.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test___monitor.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test___monkey_patching.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\_blocks_at_top_level.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\_imports_at_top_level.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\_imports_imports_at_top_level.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\_import_import_patch.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\_import_patch.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\_import_wait.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\__init__.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\__main__.py -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  creating build\\lib.win-amd64-3.7\\gevent\\_ffi\r\n  copying src\\gevent\\_ffi\\callback.py -> build\\lib.win-amd64-3.7\\gevent\\_ffi\r\n  copying src\\gevent\\_ffi\\loop.py -> build\\lib.win-amd64-3.7\\gevent\\_ffi\r\n  copying src\\gevent\\_ffi\\watcher.py -> build\\lib.win-amd64-3.7\\gevent\\_ffi\r\n  copying src\\gevent\\_ffi\\__init__.py -> build\\lib.win-amd64-3.7\\gevent\\_ffi\r\n  creating build\\lib.win-amd64-3.7\\gevent\\tests\\monkey_package\r\n  copying src\\gevent\\tests\\monkey_package\\issue302monkey.py -> build\\lib.win-amd64-3.7\\gevent\\tests\\monkey_package\r\n  copying src\\gevent\\tests\\monkey_package\\script.py -> build\\lib.win-amd64-3.7\\gevent\\tests\\monkey_package\r\n  copying src\\gevent\\tests\\monkey_package\\__init__.py -> build\\lib.win-amd64-3.7\\gevent\\tests\\monkey_package\r\n  copying src\\gevent\\tests\\monkey_package\\__main__.py -> build\\lib.win-amd64-3.7\\gevent\\tests\\monkey_package\r\n  running egg_info\r\n  writing src\\gevent.egg-info\\PKG-INFO\r\n  writing dependency_links to src\\gevent.egg-info\\dependency_links.txt\r\n  writing entry points to src\\gevent.egg-info\\entry_points.txt\r\n  writing requirements to src\\gevent.egg-info\\requires.txt\r\n  writing top-level names to src\\gevent.egg-info\\top_level.txt\r\n  reading manifest file 'src\\gevent.egg-info\\SOURCES.txt'\r\n  reading manifest template 'MANIFEST.in'\r\n  warning: no files found matching 'changelog.rst'\r\n  warning: no files found matching 'Makefile.ext'\r\n  warning: no files found matching 'known_failures.py'\r\n  warning: no files found matching '.pep8'\r\n  no previously-included directories found matching '*\\__pycache__'\r\n  warning: no previously-included files matching '*.so' found anywhere in distribution\r\n  warning: no previously-included files matching '*.o' found anywhere in distribution\r\n  warning: no previously-included files matching '*.lo' found anywhere in distribution\r\n  warning: no previously-included files matching '*.la' found anywhere in distribution\r\n  warning: no previously-included files matching '.dirstamp' found anywhere in distribution\r\n  warning: no previously-included files matching 'config.log' found anywhere in distribution\r\n  warning: no previously-included files matching 'config.status' found anywhere in distribution\r\n  warning: no previously-included files matching 'config.cache' found anywhere in distribution\r\n  no previously-included directories found matching 'docs\\_build'\r\n  warning: no previously-included files matching '*.pyc' found anywhere in distribution\r\n  warning: no previously-included files matching '.coverage' found under directory 'src\\greentest'\r\n  no previously-included directories found matching 'src\\greentest\\htmlcov'\r\n  warning: no previously-included files matching 'stamp-h?' found under directory 'deps\\c-ares'\r\n  warning: no previously-included files matching 'ares_build.h.orig' found under directory 'deps\\c-ares'\r\n  warning: no previously-included files matching '_corecffi.c' found under directory 'src\\gevent'\r\n  warning: no previously-included files found matching 'configure-output'\r\n  warning: no previously-included files found matching 'configure-output.txt'\r\n  warning: no previously-included files found matching 'deps\\TAGS'\r\n  warning: no previously-included files found matching 'deps\\c-ares\\ares_build.h'\r\n  warning: no previously-included files found matching 'deps\\c-ares\\ares_config.h'\r\n  warning: no previously-included files found matching 'deps\\c-ares\\libcares.pc'\r\n  warning: no previously-included files found matching 'deps\\c-ares\\libtool'\r\n  warning: no previously-included files found matching 'deps\\c-ares\\Makefile'\r\n  no previously-included directories found matching 'deps\\c-ares\\.deps'\r\n  no previously-included directories found matching 'deps\\c-ares\\.libs'\r\n  no previously-included directories found matching 'deps\\libev\\.deps'\r\n  no previously-included directories found matching 'deps\\libev\\.libs'\r\n  warning: no previously-included files matching 'Makefile' found under directory 'deps\\libev'\r\n  warning: no previously-included files matching 'libtool' found under directory 'deps\\libev'\r\n  warning: no previously-included files matching 'stamp-h?' found under directory 'deps\\libev'\r\n  warning: no previously-included files matching 'config.h' found under directory 'deps\\libev'\r\n  no previously-included directories found matching 'deps\\libuv\\.deps'\r\n  no previously-included directories found matching 'deps\\libuv\\.libs'\r\n  no previously-included directories found matching 'deps\\libuv\\src\\.deps'\r\n  no previously-included directories found matching 'deps\\libuv\\src\\unix\\.deps'\r\n  no previously-included directories found matching 'deps\\libuv\\src\\win\\.deps'\r\n  no previously-included directories found matching 'deps\\libuv\\test\\.deps'\r\n  no previously-included directories found matching 'deps\\libuv\\autom4te.cache'\r\n  no previously-included directories found matching 'deps\\libuv\\m4'\r\n  warning: no previously-included files matching 'Makefile' found under directory 'deps\\libuv'\r\n  warning: no previously-included files matching 'Makefile.in' found under directory 'deps\\libuv'\r\n  warning: no previously-included files matching 'ar-lib' found under directory 'deps\\libuv'\r\n  warning: no previously-included files matching 'aclocal.m4' found under directory 'deps\\libuv'\r\n  warning: no previously-included files matching 'compile' found under directory 'deps\\libuv'\r\n  warning: no previously-included files matching 'configure' found under directory 'deps\\libuv'\r\n  warning: no previously-included files matching 'depcomp' found under directory 'deps\\libuv'\r\n  warning: no previously-included files matching 'install-sh' found under directory 'deps\\libuv'\r\n  warning: no previously-included files matching 'libtool' found under directory 'deps\\libuv'\r\n  warning: no previously-included files matching 'libuv.pc' found under directory 'deps\\libuv'\r\n  warning: no previously-included files matching 'ltmain.sh' found under directory 'deps\\libuv'\r\n  warning: no previously-included files matching 'missing' found under directory 'deps\\libuv'\r\n  writing manifest file 'src\\gevent.egg-info\\SOURCES.txt'\r\n  copying src\\gevent\\__abstract_linkable.pxd -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\__greenlet_primitives.pxd -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\__hub_local.pxd -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\__hub_primitives.pxd -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\__ident.pxd -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\__imap.pxd -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\__semaphore.pxd -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\__tracer.pxd -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\__waiter.pxd -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_abstract_linkable.c -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_abstract_linkable.html -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_event.pxd -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_greenlet.pxd -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_greenlet_primitives.c -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_greenlet_primitives.html -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_hub_local.c -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_hub_local.html -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_hub_primitives.c -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_hub_primitives.html -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_ident.c -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_ident.html -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_imap.c -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_imap.html -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_local.pxd -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_queue.pxd -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_semaphore.c -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_semaphore.html -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_tracer.c -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_tracer.html -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_waiter.c -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\_waiter.html -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\event.c -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\event.html -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\greenlet.c -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\greenlet.html -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\local.c -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\local.html -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\queue.c -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\queue.html -> build\\lib.win-amd64-3.7\\gevent\r\n  copying src\\gevent\\libev\\_corecffi_cdef.c -> build\\lib.win-amd64-3.7\\gevent\\libev\r\n  copying src\\gevent\\libev\\_corecffi_source.c -> build\\lib.win-amd64-3.7\\gevent\\libev\r\n  copying src\\gevent\\libev\\callbacks.c -> build\\lib.win-amd64-3.7\\gevent\\libev\r\n  copying src\\gevent\\libev\\callbacks.h -> build\\lib.win-amd64-3.7\\gevent\\libev\r\n  copying src\\gevent\\libev\\corecext.c -> build\\lib.win-amd64-3.7\\gevent\\libev\r\n  copying src\\gevent\\libev\\corecext.h -> build\\lib.win-amd64-3.7\\gevent\\libev\r\n  copying src\\gevent\\libev\\corecext.html -> build\\lib.win-amd64-3.7\\gevent\\libev\r\n  copying src\\gevent\\libev\\corecext.pyx -> build\\lib.win-amd64-3.7\\gevent\\libev\r\n  copying src\\gevent\\libev\\libev.h -> build\\lib.win-amd64-3.7\\gevent\\libev\r\n  copying src\\gevent\\libev\\libev.pxd -> build\\lib.win-amd64-3.7\\gevent\\libev\r\n  copying src\\gevent\\libev\\libev_vfd.h -> build\\lib.win-amd64-3.7\\gevent\\libev\r\n  copying src\\gevent\\libev\\stathelper.c -> build\\lib.win-amd64-3.7\\gevent\\libev\r\n  copying src\\gevent\\libuv\\_corecffi_cdef.c -> build\\lib.win-amd64-3.7\\gevent\\libuv\r\n  copying src\\gevent\\libuv\\_corecffi_source.c -> build\\lib.win-amd64-3.7\\gevent\\libuv\r\n  copying src\\gevent\\resolver\\cares.c -> build\\lib.win-amd64-3.7\\gevent\\resolver\r\n  copying src\\gevent\\resolver\\cares.html -> build\\lib.win-amd64-3.7\\gevent\\resolver\r\n  copying src\\gevent\\resolver\\cares.pyx -> build\\lib.win-amd64-3.7\\gevent\\resolver\r\n  copying src\\gevent\\resolver\\cares_ntop.h -> build\\lib.win-amd64-3.7\\gevent\\resolver\r\n  copying src\\gevent\\resolver\\cares_pton.h -> build\\lib.win-amd64-3.7\\gevent\\resolver\r\n  copying src\\gevent\\resolver\\dnshelper.c -> build\\lib.win-amd64-3.7\\gevent\\resolver\r\n  copying src\\gevent\\resolver\\libcares.pxd -> build\\lib.win-amd64-3.7\\gevent\\resolver\r\n  creating build\\lib.win-amd64-3.7\\gevent\\testing\\coveragesite\r\n  copying src\\gevent\\testing\\coveragesite\\sitecustomize.py -> build\\lib.win-amd64-3.7\\gevent\\testing\\coveragesite\r\n  copying src\\gevent\\tests\\2_7_keycert.pem -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\badcert.pem -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\badkey.pem -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\hosts_file.txt -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\https_svn_python_org_root.pem -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\keycert.pem -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\nullcert.pem -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\server.crt -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\server.key -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\sha256.pem -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test_server.crt -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\test_server.key -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\tests_that_dont_do_leakchecks.txt -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\tests_that_dont_monkeypatch.txt -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\tests_that_dont_use_resolver.txt -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  copying src\\gevent\\tests\\wrongcert.pem -> build\\lib.win-amd64-3.7\\gevent\\tests\r\n  running build_ext\r\n  generating cffi module 'build\\\\temp.win-amd64-3.7\\\\Release\\\\gevent.libuv._corecffi.c'\r\n  creating build\\temp.win-amd64-3.7\r\n  creating build\\temp.win-amd64-3.7\\Release\r\n  building 'gevent.libev.corecext' extension\r\n  Traceback (most recent call last):\r\n    File \"c:\\program files\\python37\\lib\\site-packages\\pip\\_vendor\\pep517\\_in_process.py\", line 257, in <module>\r\n      main()\r\n    File \"c:\\program files\\python37\\lib\\site-packages\\pip\\_vendor\\pep517\\_in_process.py\", line 240, in main\r\n      json_out['return_val'] = hook(**hook_input['kwargs'])\r\n    File \"c:\\program files\\python37\\lib\\site-packages\\pip\\_vendor\\pep517\\_in_process.py\", line 182, in build_wheel\r\n      metadata_directory)\r\n    File \"C:\\Users\\u6073762\\AppData\\Local\\Temp\\pip-build-env-qxd0pzq1\\overlay\\Lib\\site-packages\\setuptools\\build_meta.py\", line 209, in build_wheel\r\n      wheel_directory, config_settings)\r\n    File \"C:\\Users\\u6073762\\AppData\\Local\\Temp\\pip-build-env-qxd0pzq1\\overlay\\Lib\\site-packages\\setuptools\\build_meta.py\", line 194, in _build_with_temp_dir\r\n      self.run_setup()\r\n    File \"C:\\Users\\u6073762\\AppData\\Local\\Temp\\pip-build-env-qxd0pzq1\\overlay\\Lib\\site-packages\\setuptools\\build_meta.py\", line 243, in run_setup\r\n      self).run_setup(setup_script=setup_script)\r\n    File \"C:\\Users\\u6073762\\AppData\\Local\\Temp\\pip-build-env-qxd0pzq1\\overlay\\Lib\\site-packages\\setuptools\\build_meta.py\", line 142, in run_setup\r\n      exec(compile(code, __file__, 'exec'), locals())\r\n    File \"setup.py\", line 420, in <module>\r\n      run_setup(EXT_MODULES)\r\n    File \"setup.py\", line 404, in run_setup\r\n      \"signal_os_incompat = gevent.monkey:_subscribe_signal_os\",\r\n    File \"C:\\Users\\u6073762\\AppData\\Local\\Temp\\pip-build-env-qxd0pzq1\\overlay\\Lib\\site-packages\\setuptools\\__init__.py\", line 145, in setup\r\n      return distutils.core.setup(**attrs)\r\n    File \"c:\\program files\\python37\\lib\\distutils\\core.py\", line 148, in setup\r\n      dist.run_commands()\r\n    File \"c:\\program files\\python37\\lib\\distutils\\dist.py\", line 966, in run_commands\r\n      self.run_command(cmd)\r\n    File \"c:\\program files\\python37\\lib\\distutils\\dist.py\", line 985, in run_command\r\n      cmd_obj.run()\r\n    File \"C:\\Users\\u6073762\\AppData\\Local\\Temp\\pip-build-env-qxd0pzq1\\overlay\\Lib\\site-packages\\wheel\\bdist_wheel.py\", line 223, in run\r\n      self.run_command('build')\r\n    File \"c:\\program files\\python37\\lib\\distutils\\cmd.py\", line 313, in run_command\r\n      self.distribution.run_command(command)\r\n    File \"c:\\program files\\python37\\lib\\distutils\\dist.py\", line 985, in run_command\r\n      cmd_obj.run()\r\n    File \"c:\\program files\\python37\\lib\\distutils\\command\\build.py\", line 135, in run\r\n      self.run_command(cmd_name)\r\n    File \"c:\\program files\\python37\\lib\\distutils\\cmd.py\", line 313, in run_command\r\n      self.distribution.run_command(command)\r\n    File \"c:\\program files\\python37\\lib\\distutils\\dist.py\", line 985, in run_command\r\n      cmd_obj.run()\r\n    File \"C:\\Users\\u6073762\\AppData\\Local\\Temp\\pip-build-env-qxd0pzq1\\overlay\\Lib\\site-packages\\cffi\\setuptools_ext.py\", line 142, in run\r\n      base_class.run(self)\r\n    File \"C:\\Users\\u6073762\\AppData\\Local\\Temp\\pip-build-env-qxd0pzq1\\overlay\\Lib\\site-packages\\setuptools\\command\\build_ext.py\", line 84, in run\r\n      _build_ext.run(self)\r\n    File \"C:\\Users\\u6073762\\AppData\\Local\\Temp\\pip-build-env-qxd0pzq1\\overlay\\Lib\\site-packages\\Cython\\Distutils\\old_build_ext.py\", line 186, in run\r\n      _build_ext.build_ext.run(self)\r\n    File \"c:\\program files\\python37\\lib\\distutils\\command\\build_ext.py\", line 340, in run\r\n      self.build_extensions()\r\n    File \"C:\\Users\\u6073762\\AppData\\Local\\Temp\\pip-build-env-qxd0pzq1\\overlay\\Lib\\site-packages\\Cython\\Distutils\\old_build_ext.py\", line 195, in build_extensions\r\n      _build_ext.build_ext.build_extensions(self)\r\n    File \"c:\\program files\\python37\\lib\\distutils\\command\\build_ext.py\", line 449, in build_extensions\r\n      self._build_extensions_serial()\r\n    File \"c:\\program files\\python37\\lib\\distutils\\command\\build_ext.py\", line 474, in _build_extensions_serial\r\n      self.build_extension(ext)\r\n    File \"C:\\Users\\u6073762\\AppData\\Local\\Temp\\pip-install-z1pqeevk\\gevent\\_setuputils.py\", line 265, in build_extension\r\n      return build_ext.build_extension(self, ext)\r\n    File \"C:\\Users\\u6073762\\AppData\\Local\\Temp\\pip-build-env-qxd0pzq1\\overlay\\Lib\\site-packages\\setuptools\\command\\build_ext.py\", line 205, in build_extension\r\n      _build_ext.build_extension(self, ext)\r\n    File \"c:\\program files\\python37\\lib\\distutils\\command\\build_ext.py\", line 534, in build_extension\r\n      depends=ext.depends)\r\n    File \"c:\\program files\\python37\\lib\\distutils\\_msvccompiler.py\", line 346, in compile\r\n      self.initialize()\r\n    File \"c:\\program files\\python37\\lib\\distutils\\_msvccompiler.py\", line 239, in initialize\r\n      vc_env = _get_vc_env(plat_spec)\r\n    File \"C:\\Users\\u6073762\\AppData\\Local\\Temp\\pip-build-env-qxd0pzq1\\overlay\\Lib\\site-packages\\setuptools\\msvc.py\", line 171, in msvc14_get_vc_env\r\n      return EnvironmentInfo(plat_spec, vc_min_ver=14.0).return_env()\r\n    File \"C:\\Users\\u6073762\\AppData\\Local\\Temp\\pip-build-env-qxd0pzq1\\overlay\\Lib\\site-packages\\setuptools\\msvc.py\", line 1620, in return_env\r\n      if self.vs_ver >= 14 and isfile(self.VCRuntimeRedist):\r\n    File \"c:\\program files\\python37\\lib\\genericpath.py\", line 30, in isfile\r\n      st = os.stat(path)\r\n  TypeError: stat: path should be string, bytes, os.PathLike or integer, not NoneType\r\n  ----------------------------------------\r\n  ERROR: Failed building wheel for gevent\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1254/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1254/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1252", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1252/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1252/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1252/events", "html_url": "https://github.com/locustio/locust/issues/1252", "id": 559485473, "node_id": "MDU6SXNzdWU1NTk0ODU0NzM=", "number": 1252, "title": "locust.contrib.fasthttp.FastHttpLocust does not support multipart/form-data", "user": {"login": "pcdinh", "id": 42888, "node_id": "MDQ6VXNlcjQyODg4", "avatar_url": "https://avatars.githubusercontent.com/u/42888?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcdinh", "html_url": "https://github.com/pcdinh", "followers_url": "https://api.github.com/users/pcdinh/followers", "following_url": "https://api.github.com/users/pcdinh/following{/other_user}", "gists_url": "https://api.github.com/users/pcdinh/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcdinh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcdinh/subscriptions", "organizations_url": "https://api.github.com/users/pcdinh/orgs", "repos_url": "https://api.github.com/users/pcdinh/repos", "events_url": "https://api.github.com/users/pcdinh/events{/privacy}", "received_events_url": "https://api.github.com/users/pcdinh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}, {"id": 2115072627, "node_id": "MDU6TGFiZWwyMTE1MDcyNjI3", "url": "https://api.github.com/repos/locustio/locust/labels/non-critical", "name": "non-critical", "color": "c4e4c9", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-02-04T04:47:29Z", "updated_at": "2021-03-15T21:44:51Z", "closed_at": "2021-03-15T21:44:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\nI tried to upload a file using FastHttpLocust and got an exception\r\n\r\n```\r\n  File \"c:\\python37\\lib\\site-packages\\locust\\contrib\\fasthttp.py\", line 236, in post\r\n    return self.request(\"POST\", path, data=data, **kwargs)\r\n  File \"c:\\python37\\lib\\site-packages\\locust\\contrib\\fasthttp.py\", line 178, in request\r\n    response = self._send_request_safe_mode(method, url, payload=data, headers=headers, **kwargs)\r\n  File \"c:\\python37\\lib\\site-packages\\locust\\contrib\\fasthttp.py\", line 124, in _send_request_safe_mode\r\n    return self.client.urlopen(url, method=method, **kwargs)\r\n  File \"c:\\python37\\lib\\site-packages\\geventhttpclient\\useragent.py\", line 333, in urlopen\r\n    req = self._make_request(url, method=method, headers=headers, payload=payload)\r\n  File \"c:\\python37\\lib\\site-packages\\geventhttpclient\\useragent.py\", line 285, in _make_request\r\n    raise NotImplementedError\r\nNotImplementedError\r\n```\r\n\r\nThe geventhttpclient code confirms that this feature is not supported\r\n\r\n```\r\n    def _make_request(self, url, method='GET', headers=None, payload=None):\r\n        req_headers = self.default_headers.copy()\r\n        if headers:\r\n            req_headers.update(headers)\r\n        if payload:\r\n            # Adjust headers depending on payload content\r\n            content_type = req_headers.get('content-type', None)\r\n            if not content_type and isinstance(payload, dict):\r\n                req_headers['content-type'] = \"application/x-www-form-urlencoded; charset=utf-8\"\r\n                payload = urlencode(payload)\r\n            elif not content_type and isinstance(payload, text_type):\r\n                req_headers['content-type'] = 'text/plain; charset=utf-8'\r\n            elif not content_type:\r\n                req_headers['content-type'] = 'application/octet-stream'\r\n            elif content_type.startswith(\"multipart/form-data\"):\r\n                # See restkit for some example implementation\r\n                # TODO: Implement it\r\n                raise NotImplementedError\r\n        return CompatRequest(url, method=method, headers=req_headers, payload=payload)\r\n```\r\n\r\nI expect that feature is supported. If it is not available for the moment, the document should mention it. \r\n\r\n- OS: Windows 10, Ubuntu 18\r\n- Python version: 3.7\r\n- Locust version: 0.13.5, 0.14.4\r\n- Locust command line that you ran: locust --no-web -c 15 -r 1 --only-summary --host=http://localhost:5000 -f client/upload_loadtests.py\r\n- Locust file contents (anonymized if necessary):", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1252/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1252/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1246", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1246/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1246/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1246/events", "html_url": "https://github.com/locustio/locust/issues/1246", "id": 555660537, "node_id": "MDU6SXNzdWU1NTU2NjA1Mzc=", "number": 1246, "title": "FastHttpLocust times out when HttpLocust does not", "user": {"login": "ThatOhio", "id": 10838863, "node_id": "MDQ6VXNlcjEwODM4ODYz", "avatar_url": "https://avatars.githubusercontent.com/u/10838863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ThatOhio", "html_url": "https://github.com/ThatOhio", "followers_url": "https://api.github.com/users/ThatOhio/followers", "following_url": "https://api.github.com/users/ThatOhio/following{/other_user}", "gists_url": "https://api.github.com/users/ThatOhio/gists{/gist_id}", "starred_url": "https://api.github.com/users/ThatOhio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ThatOhio/subscriptions", "organizations_url": "https://api.github.com/users/ThatOhio/orgs", "repos_url": "https://api.github.com/users/ThatOhio/repos", "events_url": "https://api.github.com/users/ThatOhio/events{/privacy}", "received_events_url": "https://api.github.com/users/ThatOhio/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-01-27T15:44:07Z", "updated_at": "2020-02-03T13:55:26Z", "closed_at": "2020-02-03T13:55:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- \r\nIf you have a general question about how to use Locust, please check Stack Overflow first https://stackoverflow.com/questions/tagged/locust\r\n\r\nYou can also ask new questions on SO, https://stackoverflow.com/questions/ask just remember to tag your question with \"locust\".\r\n\r\nUse this form only for reporting actual bugs in locust. Be mindful that the developers of locust are unpaid volunteers, so make sure you have tried everything you can think of before filing a bug :) \r\n-->\r\n\r\n### Describe the bug\r\nWhile running some performance tests the last few weeks, I noticed that while using the FastHttpLocust client my requests would timeout at 5 seconds consistently on any request that took over 5 seconds to return. When using HttpLocust there was no timeout. I did not see an obvious setting I could change to increase the timeout for FastHttpLocust, and even if that setting exists, I would expect the defaults for both to be the same. \r\n\r\n### Expected behavior\r\nThe length of the timeout for both FastHttpLocust and HttpLocust should be the same, so that a timeout does not occur while using one or the other.\r\n\r\n### Actual behavior\r\nIf a request made with FastHttpLocust takes more than 5 seconds, but less than the default timeout for HttpLocust (I do not know this timeout, I believe it is 60 seconds?), the request should not timeout. The default timeout settings for FastHttpLocust should mirror that of HttpLocust.\r\n\r\n### Steps to reproduce\r\nWe setup an endpoint that simply waited 10 seconds and then returned, running the same locust file but swapping out HttpLocust with FastHttpLocust would produce different results (FastHttpLocust timing out after 5 seconds where HttpLocust did not). \r\n\r\n### Environment\r\n\r\n- OS: Ubuntu\r\n- Python version: 3.6.9\r\n- Locust version: 0.13.5\r\n- Locust command line that you ran: locust --host=http://web.site -f some_file.py\r\n- Locust file contents (anonymized if necessary): \r\n```\r\nfrom locust import HttpLocust, TaskSet, between\r\nfrom locust.contrib.fasthttp import FastHttpLocust\r\n\r\n\r\ndef TimeoutTest(l):\r\n    l.client.get('/timeout_test.php')\r\n\r\n\r\nclass UserBehavior(TaskSet):\r\n    tasks = {TimeoutTest: 1}\r\n\r\n\r\nclass WebsiteUser(FastHttpLocust):\r\n    task_set = UserBehavior\r\n    wait_time = between(1.0, 2.0)\r\n```\r\nSwapping FastHttpLocust for HttpLocust to perform the same request with the HttpLocust. Our \"/timeout_test.php\" page was simply waiting 10 seconds to return. ", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1246/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1246/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1233", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1233/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1233/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1233/events", "html_url": "https://github.com/locustio/locust/issues/1233", "id": 551248722, "node_id": "MDU6SXNzdWU1NTEyNDg3MjI=", "number": 1233, "title": "\u5f53'content-encoding': 'utf-8'\u65f6\u4f1a\u51fa\u73b0\u5f02\u5e38", "user": {"login": "3638836363", "id": 37776695, "node_id": "MDQ6VXNlcjM3Nzc2Njk1", "avatar_url": "https://avatars.githubusercontent.com/u/37776695?v=4", "gravatar_id": "", "url": "https://api.github.com/users/3638836363", "html_url": "https://github.com/3638836363", "followers_url": "https://api.github.com/users/3638836363/followers", "following_url": "https://api.github.com/users/3638836363/following{/other_user}", "gists_url": "https://api.github.com/users/3638836363/gists{/gist_id}", "starred_url": "https://api.github.com/users/3638836363/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/3638836363/subscriptions", "organizations_url": "https://api.github.com/users/3638836363/orgs", "repos_url": "https://api.github.com/users/3638836363/repos", "events_url": "https://api.github.com/users/3638836363/events{/privacy}", "received_events_url": "https://api.github.com/users/3638836363/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-01-17T07:23:28Z", "updated_at": "2020-01-17T10:11:24Z", "closed_at": "2020-01-17T10:11:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "Python36\\Lib\\site-packages\\geventhttpclient\\useragent.py  line:190\r\n\r\n\u6570\u636e\uff1a\r\n Headers({'Server': 'openresty/1.13.6.2', 'Date': 'Fri, 17 Jan 2020 07:06:03 GMT', 'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '128', 'Connection': 'keep-alive', 'content-encoding': 'utf-8'})", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1233/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1233/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1232", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1232/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1232/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1232/events", "html_url": "https://github.com/locustio/locust/issues/1232", "id": 550837756, "node_id": "MDU6SXNzdWU1NTA4Mzc3NTY=", "number": 1232, "title": "Time units are wrong for response times", "user": {"login": "zevaverbach", "id": 2838836, "node_id": "MDQ6VXNlcjI4Mzg4MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/2838836?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zevaverbach", "html_url": "https://github.com/zevaverbach", "followers_url": "https://api.github.com/users/zevaverbach/followers", "following_url": "https://api.github.com/users/zevaverbach/following{/other_user}", "gists_url": "https://api.github.com/users/zevaverbach/gists{/gist_id}", "starred_url": "https://api.github.com/users/zevaverbach/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zevaverbach/subscriptions", "organizations_url": "https://api.github.com/users/zevaverbach/orgs", "repos_url": "https://api.github.com/users/zevaverbach/repos", "events_url": "https://api.github.com/users/zevaverbach/events{/privacy}", "received_events_url": "https://api.github.com/users/zevaverbach/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1003994742, "node_id": "MDU6TGFiZWwxMDAzOTk0NzQy", "url": "https://api.github.com/repos/locustio/locust/labels/waiting%20on%20contributor", "name": "waiting on contributor", "color": "5319e7", "default": false, "description": ""}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-01-16T14:20:45Z", "updated_at": "2020-02-10T09:07:59Z", "closed_at": "2020-02-10T09:07:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "Let me know if you'd like some help fixing this, I imagine it's a pretty simple one!\r\n\r\n### Describe the bug\r\nRelated to #303, what's being reported are not milliseconds but actually `milliseconds * 10`.\r\n\r\n### Expected behavior\r\nFor my specific case, I observe about a four-second response time for an endpoint I'm testing, but what's reported is more like 40 seconds on average.\r\n\r\n### Actual behavior\r\nSee above.\r\n\r\n### Steps to reproduce\r\nself-evident\r\n\r\n### Environment\r\n\r\n- OS: MacOS latest\r\n- Python version: 3.6.8\r\n- Locust version: 0.13.5\r\n- Locust command line that you ran: just launched it with my module\r\n- Locust file contents (anonymized if necessary): irrelevant", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1232/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1232/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1225", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1225/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1225/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1225/events", "html_url": "https://github.com/locustio/locust/issues/1225", "id": 550048790, "node_id": "MDU6SXNzdWU1NTAwNDg3OTA=", "number": 1225, "title": "Report statistical errors", "user": {"login": "kangliangtang", "id": 35226217, "node_id": "MDQ6VXNlcjM1MjI2MjE3", "avatar_url": "https://avatars.githubusercontent.com/u/35226217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kangliangtang", "html_url": "https://github.com/kangliangtang", "followers_url": "https://api.github.com/users/kangliangtang/followers", "following_url": "https://api.github.com/users/kangliangtang/following{/other_user}", "gists_url": "https://api.github.com/users/kangliangtang/gists{/gist_id}", "starred_url": "https://api.github.com/users/kangliangtang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kangliangtang/subscriptions", "organizations_url": "https://api.github.com/users/kangliangtang/orgs", "repos_url": "https://api.github.com/users/kangliangtang/repos", "events_url": "https://api.github.com/users/kangliangtang/events{/privacy}", "received_events_url": "https://api.github.com/users/kangliangtang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1003994742, "node_id": "MDU6TGFiZWwxMDAzOTk0NzQy", "url": "https://api.github.com/repos/locustio/locust/labels/waiting%20on%20contributor", "name": "waiting on contributor", "color": "5319e7", "default": false, "description": ""}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2020-01-15T08:56:02Z", "updated_at": "2020-02-10T09:08:22Z", "closed_at": "2020-02-10T09:08:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "Click pause during operation. The interface statistics in the report are wrong. For example, the report counts 99 times of an interface execution, but 100 times of actual execution.\r\n\r\n- OS:\r\n- Python version:  3.5\r\n- Locust version: 0.12.2\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1225/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1225/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1224", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1224/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1224/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1224/events", "html_url": "https://github.com/locustio/locust/issues/1224", "id": 549978091, "node_id": "MDU6SXNzdWU1NDk5NzgwOTE=", "number": 1224, "title": "Locust Web Ui not Accessible When Running on Mac OS Docker Desktop", "user": {"login": "steventranjs", "id": 6488765, "node_id": "MDQ6VXNlcjY0ODg3NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/6488765?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steventranjs", "html_url": "https://github.com/steventranjs", "followers_url": "https://api.github.com/users/steventranjs/followers", "following_url": "https://api.github.com/users/steventranjs/following{/other_user}", "gists_url": "https://api.github.com/users/steventranjs/gists{/gist_id}", "starred_url": "https://api.github.com/users/steventranjs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steventranjs/subscriptions", "organizations_url": "https://api.github.com/users/steventranjs/orgs", "repos_url": "https://api.github.com/users/steventranjs/repos", "events_url": "https://api.github.com/users/steventranjs/events{/privacy}", "received_events_url": "https://api.github.com/users/steventranjs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1003994742, "node_id": "MDU6TGFiZWwxMDAzOTk0NzQy", "url": "https://api.github.com/repos/locustio/locust/labels/waiting%20on%20contributor", "name": "waiting on contributor", "color": "5319e7", "default": false, "description": ""}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-15T05:40:31Z", "updated_at": "2020-10-05T12:37:12Z", "closed_at": "2020-02-10T09:07:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n- When starting locust using docker in Mac OS, I am unable to access web UI\r\n- However it's works on Ubuntu\r\n\r\n### Steps to reproduce\r\n```\r\ngit clone https://github.com/locustio/locust.git\r\ncd locust/examples/docker-compose\r\ndocker-compose up -d\r\n```\r\n### Expected behavior\r\n- http://localhost:8089/ should be successfully loaded from chrome\r\n\r\n### Actual behavior\r\n- Unable to access http://localhost:8089/ from chrome\r\n- However if running on Ubuntu, I am able to access\r\n\r\n### Environment settings\r\n- OS: Macos Catalina with Docker Desktop (version 2.1.0.4)\r\n- Python version: From latest locustio/locust docker image\r\n- Locust version: Latest locustio/locust docker image\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1224/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1224/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1222", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1222/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1222/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1222/events", "html_url": "https://github.com/locustio/locust/issues/1222", "id": 549552678, "node_id": "MDU6SXNzdWU1NDk1NTI2Nzg=", "number": 1222, "title": "FastHttpLocust gives error when using valid url.", "user": {"login": "Lars-Kristian", "id": 8088856, "node_id": "MDQ6VXNlcjgwODg4NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/8088856?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lars-Kristian", "html_url": "https://github.com/Lars-Kristian", "followers_url": "https://api.github.com/users/Lars-Kristian/followers", "following_url": "https://api.github.com/users/Lars-Kristian/following{/other_user}", "gists_url": "https://api.github.com/users/Lars-Kristian/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lars-Kristian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lars-Kristian/subscriptions", "organizations_url": "https://api.github.com/users/Lars-Kristian/orgs", "repos_url": "https://api.github.com/users/Lars-Kristian/repos", "events_url": "https://api.github.com/users/Lars-Kristian/events{/privacy}", "received_events_url": "https://api.github.com/users/Lars-Kristian/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-01-14T13:01:48Z", "updated_at": "2020-01-16T14:09:54Z", "closed_at": "2020-01-16T14:09:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "When using **FastHttpLocust** with an valid URL, the following error is emitted.\r\n```\r\nLocustError: Invalid host (`https://hostname/path`). The specified host string must be a base URL without a trailing slash.\r\n```\r\nThe regex `r\"^https?://[^/]+$\"` in file `locust/contrib/fasthttp.py` seems to be wrong.\r\n\r\nIt maches `https://hostname` and not `https://hostname/path` error message warned about `https://hostname/path/`\r\n\r\n### Environment settings\r\n\r\n- OS: Windows 10\r\n- Python version: 2.7\r\n- Locust version: 0.13.5\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1222/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1222/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1214", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1214/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1214/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1214/events", "html_url": "https://github.com/locustio/locust/issues/1214", "id": 545339810, "node_id": "MDU6SXNzdWU1NDUzMzk4MTA=", "number": 1214, "title": "ModuleNotFoundError when importing 'locust'", "user": {"login": "alex-vungle", "id": 42924996, "node_id": "MDQ6VXNlcjQyOTI0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/42924996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alex-vungle", "html_url": "https://github.com/alex-vungle", "followers_url": "https://api.github.com/users/alex-vungle/followers", "following_url": "https://api.github.com/users/alex-vungle/following{/other_user}", "gists_url": "https://api.github.com/users/alex-vungle/gists{/gist_id}", "starred_url": "https://api.github.com/users/alex-vungle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alex-vungle/subscriptions", "organizations_url": "https://api.github.com/users/alex-vungle/orgs", "repos_url": "https://api.github.com/users/alex-vungle/repos", "events_url": "https://api.github.com/users/alex-vungle/events{/privacy}", "received_events_url": "https://api.github.com/users/alex-vungle/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1003994742, "node_id": "MDU6TGFiZWwxMDAzOTk0NzQy", "url": "https://api.github.com/repos/locustio/locust/labels/waiting%20on%20contributor", "name": "waiting on contributor", "color": "5319e7", "default": false, "description": ""}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-04T22:24:59Z", "updated_at": "2020-01-13T17:20:38Z", "closed_at": "2020-01-13T17:20:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi all,\r\n\r\nI am a newbie to Locust, I'm currently not be able to follow the tutorial to successfully run my first locust script for the ModuleNotFoundError, I tried downgrade the locust version from 0.3.15 to 0.3.14 but still can't get it work\r\n\r\n### Steps to reproduce \r\n1.  Install the locust by pip command: pip3 install locustio\r\n2. Open python interactive shell by shooting python3 on the terminal;\r\n3. import locust;\r\n\r\n### Actual behavior\r\n1. A ModuleNotFoundError pops up, it says: no module named 'locust', however I can run locust executable on the terminal successfully;\r\nPls check the screenshot attached in below:\r\n<img width=\"851\" alt=\"Screen Shot 2020-01-05 at 06 11 19\" src=\"https://user-images.githubusercontent.com/42924996/71772284-ef494880-2f83-11ea-945c-14c5d2012495.png\">\r\n\r\n\r\n\r\n### Environment settings\r\n\r\n- OS: MacOS Cataline 10.15\r\n- Python version: Python 3.7.3\r\n- Locust version: 0.13.5(latest version), 0.13.4\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1214/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1214/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1213", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1213/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1213/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1213/events", "html_url": "https://github.com/locustio/locust/issues/1213", "id": 544635180, "node_id": "MDU6SXNzdWU1NDQ2MzUxODA=", "number": 1213, "title": "Users are not evenly balanced across slaves when adding new slaves during test", "user": {"login": "max-rocket-internet", "id": 8859277, "node_id": "MDQ6VXNlcjg4NTkyNzc=", "avatar_url": "https://avatars.githubusercontent.com/u/8859277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/max-rocket-internet", "html_url": "https://github.com/max-rocket-internet", "followers_url": "https://api.github.com/users/max-rocket-internet/followers", "following_url": "https://api.github.com/users/max-rocket-internet/following{/other_user}", "gists_url": "https://api.github.com/users/max-rocket-internet/gists{/gist_id}", "starred_url": "https://api.github.com/users/max-rocket-internet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/max-rocket-internet/subscriptions", "organizations_url": "https://api.github.com/users/max-rocket-internet/orgs", "repos_url": "https://api.github.com/users/max-rocket-internet/repos", "events_url": "https://api.github.com/users/max-rocket-internet/events{/privacy}", "received_events_url": "https://api.github.com/users/max-rocket-internet/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1003994742, "node_id": "MDU6TGFiZWwxMDAzOTk0NzQy", "url": "https://api.github.com/repos/locustio/locust/labels/waiting%20on%20contributor", "name": "waiting on contributor", "color": "5319e7", "default": false, "description": ""}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-01-02T15:54:29Z", "updated_at": "2020-06-30T13:36:19Z", "closed_at": "2020-06-30T13:36:19Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\nAutoscaling of slaves feature was added by enabling the recalculation and update of users per slave when a new slave connects. But in my testing the first slave always has a considerably higher amount of users running from it.\r\n\r\n### Expected behavior\r\n\r\nEvery slave should be running roughly the same amount of users after rebalancing.\r\n\r\n### Actual behavior\r\n\r\nThe first slave is at 23 users and 70% CPU where the others are at 2-8 users and 10-30% CPU.\r\n\r\n![Screen Shot 2020-01-02 at 16 39 30](https://user-images.githubusercontent.com/8859277/71675719-b4c28e80-2d7e-11ea-8341-f3ca132d94e9.png)\r\n\r\n![Screen Shot 2020-01-02 at 16 41 28](https://user-images.githubusercontent.com/8859277/71675747-c5730480-2d7e-11ea-8cbf-b97f1f95506e.png)\r\n\r\nLogs from the first slave:\r\n\r\n```\r\n\u2502 [2020-01-02 15:19:12,726] locust-large-slave-5766897bc6-62rr2/INFO/locust.main: Starting Locust 0.13.5                                                                                                                                                                           \u2502\r\n\u2502 [2020-01-02 15:25:08,500] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Hatching and swarming 800 clients at the rate 0.1 clients/s...                                                                                                                                \u2502\r\n\u2502 [2020-01-02 15:26:35,493] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 400 locusts                                                                                                                                                                           \u2502\r\n\u2502 [2020-01-02 15:26:36,554] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 133 locusts                                                                                                                                                                           \u2502\r\n\u2502 [2020-01-02 15:28:37,954] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 67 locusts                                                                                                                                                                            \u2502\r\n\u2502 [2020-01-02 15:28:38,219] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 67 locusts                                                                                                                                                                            \u2502\r\n\u2502 [2020-01-02 15:28:53,136] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 18 locusts                                                                                                                                                                            \u2502\r\n\u2502 [2020-01-02 15:30:41,591] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 15 locusts                                                                                                                                                                            \u2502\r\n\u2502 [2020-01-02 15:30:41,731] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 11 locusts                                                                                                                                                                            \u2502\r\n\u2502 [2020-01-02 15:33:39,727] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 9 locusts                                                                                                                                                                             \u2502\r\n\u2502 [2020-01-02 15:33:40,021] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 7 locusts                                                                                                                                                                             \u2502\r\n\u2502 [2020-01-02 15:33:40,248] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 6 locusts                                                                                                                                                                             \u2502\r\n\u2502 [2020-01-02 15:33:40,846] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 5 locusts                                                                                                                                                                             \u2502\r\n\u2502 [2020-01-02 15:33:42,703] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 4 locusts                                                                                                                                                                             \u2502\r\n\u2502 [2020-01-02 15:33:45,694] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 4 locusts                                                                                                                                                                             \u2502\r\n\u2502 [2020-01-02 15:33:46,696] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 4 locusts                                                                                                                                                                             \u2502\r\n\u2502 [2020-01-02 15:33:47,695] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 3 locusts                                                                                                                                                                             \u2502\r\n\u2502 [2020-01-02 15:37:41,527] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 2 locusts                                                                                                                                                                             \u2502\r\n\u2502 [2020-01-02 15:37:43,025] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 2 locusts                                                                                                                                                                             \u2502\r\n\u2502 [2020-01-02 15:37:43,235] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 3 locusts                                                                                                                                                                             \u2502\r\n\u2502 [2020-01-02 15:37:43,325] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 2 locusts                                                                                                                                                                             \u2502\r\n\u2502 [2020-01-02 15:37:43,867] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 1 locusts                                                                                                                                                                             \u2502\r\n\u2502 [2020-01-02 15:37:44,173] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 2 locusts                                                                                                                                                                             \u2502\r\n\u2502 [2020-01-02 15:37:46,293] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 1 locusts                                                                                                                                                                             \u2502\r\n\u2502 [2020-01-02 15:37:47,196] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 2 locusts                                                                                                                                                                             \u2502\r\n\u2502 [2020-01-02 15:37:47,692] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 1 locusts                                                                                                                                                                             \u2502\r\n\u2502 [2020-01-02 15:37:48,396] locust-large-slave-5766897bc6-62rr2/INFO/locust.runners: Killing 1 locusts                                                                                                                                                                             \u2502\r\n```\r\n\r\n### Steps to reproduce\r\n\r\nRun a load test, autoscale slaves from 1 to 10+.\r\n\r\n### Environment settings\r\n\r\n- OS: Docker image on k8s\r\n- Python version: official docker image\r\n- Locust version: `0.13.5`\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1213/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1213/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1209", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1209/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1209/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1209/events", "html_url": "https://github.com/locustio/locust/issues/1209", "id": 542551661, "node_id": "MDU6SXNzdWU1NDI1NTE2NjE=", "number": 1209, "title": "Got 400 Bad Request when using FastHttpLocust", "user": {"login": "pharrellyhy", "id": 16664753, "node_id": "MDQ6VXNlcjE2NjY0NzUz", "avatar_url": "https://avatars.githubusercontent.com/u/16664753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pharrellyhy", "html_url": "https://github.com/pharrellyhy", "followers_url": "https://api.github.com/users/pharrellyhy/followers", "following_url": "https://api.github.com/users/pharrellyhy/following{/other_user}", "gists_url": "https://api.github.com/users/pharrellyhy/gists{/gist_id}", "starred_url": "https://api.github.com/users/pharrellyhy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pharrellyhy/subscriptions", "organizations_url": "https://api.github.com/users/pharrellyhy/orgs", "repos_url": "https://api.github.com/users/pharrellyhy/repos", "events_url": "https://api.github.com/users/pharrellyhy/events{/privacy}", "received_events_url": "https://api.github.com/users/pharrellyhy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1003994742, "node_id": "MDU6TGFiZWwxMDAzOTk0NzQy", "url": "https://api.github.com/repos/locustio/locust/labels/waiting%20on%20contributor", "name": "waiting on contributor", "color": "5319e7", "default": false, "description": ""}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-12-26T13:07:41Z", "updated_at": "2020-01-17T08:43:16Z", "closed_at": "2020-01-17T08:43:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please note: For general questions about how to use Locust, use either the Slack link provided in the Readme or [ask a question on Stack Overflow](https://stackoverflow.com/questions/ask) tagged Locust.-->\r\n\r\n### Describe the bug\r\nGot `400 Bad Request: The browser (or proxy) sent a request that this server could not understand` error when using FastHttpLocust to post a request from WSGI.\r\n\r\n### Expected behavior\r\nShould work without this error.\r\n\r\n### Actual behavior\r\nGot `400 Bad Request: The browser (or proxy) sent a request that this server could not understand` error when using FastHttpLocust to post a request from WSGI.\r\n\r\n### Steps to reproduce\r\n```python\r\nimport json\r\nfrom locust import TaskSet, between, task\r\nfrom locust.contrib.fasthttp import FastHttpLocust\r\n\r\n\r\nIMAGE_PATH = '2019.12.17_14.57.47.749_original.jpg'\r\n\r\nimage = open(IMAGE_PATH, 'rb').read()\r\n\r\nserving_url = 'http://127.0.0.1:3000/predict'\r\nbody = {'device': 'load_test', 'keypoint_model': 2}\r\n\r\nfiles = {'params': (None, json.dumps(body), 'application/json'),\r\n         'image': ('predict.jpg', image, 'application/octet-stream')\r\n         }\r\n\r\nclass UserBehavior(TaskSet):\r\n    @task\r\n    def serve(l):\r\n        r = l.client.post(serving_url, files)\r\n        print('status code: ', r.status_code)\r\n        print('content: ', r.content)\r\n\r\n\r\nclass WebsiteUser(FastHttpLocust):\r\n    task_set = UserBehavior\r\n    wait_time = between(1, 3)\r\n\r\n```\r\nInstead, if I use normal HttpLocust, it works fine.\r\n```python\r\nimport json\r\nfrom locust import HttpLocust, TaskSet, between, task\r\nfrom locust.contrib.fasthttp import FastHttpLocust\r\n\r\n\r\nIMAGE_PATH = '2019.12.17_14.57.47.749_original.jpg'\r\n\r\nimage = open(IMAGE_PATH, 'rb').read()\r\n\r\nserving_url = 'http://127.0.0.1:3000/predict'\r\nbody = {'device': 'load_test', 'keypoint_model': 2}\r\n\r\nfiles = {'params': (None, json.dumps(body), 'application/json'),\r\n         'image': ('predict.jpg', image, 'application/octet-stream')\r\n         }\r\n\r\n\r\ndef post_predict(l):\r\n      with l.client.post(serving_url, files=files) as r:\r\n          print('status code: ', r.status_code)\r\n          print('content: ', r.content)\r\n\r\n\r\nclass UserBehavior(TaskSet):\r\n    tasks = {post_predict: 1}\r\n\r\n\r\nclass WebsiteUser(HttpLocust):\r\n    task_set = UserBehavior\r\n    wait_time = between(1, 3)\r\n\r\n```\r\n\r\nAny idea on this? Thanks.\r\n\r\n### Environment settings\r\n\r\n- OS: MacOS\r\n- Python version: 3.6.8\r\n- Locust version: 0.13.5\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1209/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1209/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1206", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1206/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1206/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1206/events", "html_url": "https://github.com/locustio/locust/issues/1206", "id": 541955392, "node_id": "MDU6SXNzdWU1NDE5NTUzOTI=", "number": 1206, "title": "[Nested TaskSet] Child TaskSet's on_stop method is not called when GreenletExit", "user": {"login": "da-zhanglei", "id": 7961547, "node_id": "MDQ6VXNlcjc5NjE1NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/7961547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/da-zhanglei", "html_url": "https://github.com/da-zhanglei", "followers_url": "https://api.github.com/users/da-zhanglei/followers", "following_url": "https://api.github.com/users/da-zhanglei/following{/other_user}", "gists_url": "https://api.github.com/users/da-zhanglei/gists{/gist_id}", "starred_url": "https://api.github.com/users/da-zhanglei/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/da-zhanglei/subscriptions", "organizations_url": "https://api.github.com/users/da-zhanglei/orgs", "repos_url": "https://api.github.com/users/da-zhanglei/repos", "events_url": "https://api.github.com/users/da-zhanglei/events{/privacy}", "received_events_url": "https://api.github.com/users/da-zhanglei/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/locustio/locust/milestones/5", "html_url": "https://github.com/locustio/locust/milestone/5", "labels_url": "https://api.github.com/repos/locustio/locust/milestones/5/labels", "id": 5187312, "node_id": "MDk6TWlsZXN0b25lNTE4NzMxMg==", "number": 5, "title": "1.0", "description": "Locust 1.0", "creator": {"login": "heyman", "id": 54217, "node_id": "MDQ6VXNlcjU0MjE3", "avatar_url": "https://avatars.githubusercontent.com/u/54217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/heyman", "html_url": "https://github.com/heyman", "followers_url": "https://api.github.com/users/heyman/followers", "following_url": "https://api.github.com/users/heyman/following{/other_user}", "gists_url": "https://api.github.com/users/heyman/gists{/gist_id}", "starred_url": "https://api.github.com/users/heyman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/heyman/subscriptions", "organizations_url": "https://api.github.com/users/heyman/orgs", "repos_url": "https://api.github.com/users/heyman/repos", "events_url": "https://api.github.com/users/heyman/events{/privacy}", "received_events_url": "https://api.github.com/users/heyman/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 16, "state": "closed", "created_at": "2020-03-10T14:32:10Z", "updated_at": "2020-05-25T12:11:59Z", "due_on": "2020-04-29T07:00:00Z", "closed_at": "2020-05-25T12:11:59Z"}, "comments": 3, "created_at": "2019-12-24T01:45:27Z", "updated_at": "2020-04-03T15:35:14Z", "closed_at": "2020-04-03T15:35:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nI have a locustfile like this. The LightSet and HeavySet 's on_stop method is never called.\r\nThe background is, I want to do some cleanup works in LightSet and HeavySet respectively.\r\nIs there anyway to do it?\r\n\r\n```python\r\n\r\nfrom locust import HttpLocust, task, TaskSet, constant\r\n\r\n\r\nclass LightSet(TaskSet):\r\n    @task(1)\r\n    def light_1(self):\r\n        print('Light 1')\r\n\r\n    def on_stop(self):\r\n        print('Light stop')\r\n\r\n\r\nclass HeavySet(TaskSet):\r\n    @task(1)\r\n    def heavy_1(self):\r\n        print('Heavy 1')\r\n\r\n    def on_stop(self):\r\n        print('Heavy stop')\r\n\r\n\r\nclass LightAndHeavySet(TaskSet):\r\n    tasks = {LightSet: 2, HeavySet: 8}\r\n\r\n\r\nclass User(HttpLocust):\r\n    task_set = LightAndHeavySet\r\n    wait_time = constant(1)\r\n    host = 'localhost'\r\n\r\n```\r\n\r\n### Expected behavior\r\n\r\nThe LightSet and HeavySet 's on_stop should be called.\r\n\r\nOr there is a workaround to do the cleanup for child TaskSet.\r\n\r\n### Actual behavior\r\nThe LightSet and HeavySet 's on_stop is not called.\r\nI cannot find a way to do it(By looking at Docs and StackOverflow).\r\n\r\n### Steps to reproduce\r\n\r\n### Environment settings\r\n\r\n- OS: Mac OS\r\n- Python version: 3.7\r\n- Locust version: 0.13.5\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1206/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1206/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1203", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1203/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1203/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1203/events", "html_url": "https://github.com/locustio/locust/issues/1203", "id": 541285134, "node_id": "MDU6SXNzdWU1NDEyODUxMzQ=", "number": 1203, "title": "Using FastHttpLocust gives a 'dict object ", "user": {"login": "krishnakeshan", "id": 23151728, "node_id": "MDQ6VXNlcjIzMTUxNzI4", "avatar_url": "https://avatars.githubusercontent.com/u/23151728?v=4", "gravatar_id": "", "url": "https://api.github.com/users/krishnakeshan", "html_url": "https://github.com/krishnakeshan", "followers_url": "https://api.github.com/users/krishnakeshan/followers", "following_url": "https://api.github.com/users/krishnakeshan/following{/other_user}", "gists_url": "https://api.github.com/users/krishnakeshan/gists{/gist_id}", "starred_url": "https://api.github.com/users/krishnakeshan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/krishnakeshan/subscriptions", "organizations_url": "https://api.github.com/users/krishnakeshan/orgs", "repos_url": "https://api.github.com/users/krishnakeshan/repos", "events_url": "https://api.github.com/users/krishnakeshan/events{/privacy}", "received_events_url": "https://api.github.com/users/krishnakeshan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}, {"id": 2115072627, "node_id": "MDU6TGFiZWwyMTE1MDcyNjI3", "url": "https://api.github.com/repos/locustio/locust/labels/non-critical", "name": "non-critical", "color": "c4e4c9", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-12-21T05:17:01Z", "updated_at": "2022-08-30T15:15:04Z", "closed_at": "2021-03-15T21:45:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please note: For general questions about how to use Locust, use either the Slack link provided in the Readme or [ask a question on Stack Overflow](https://stackoverflow.com/questions/ask) tagged Locust.-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\n### Expected behavior\r\n<!-- Tell us what should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example). Or even better - a pull request with a failing unit test --> \r\n\r\n### Environment settings\r\n\r\n- OS:\r\n- Python version:\r\n- Locust version:\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1203/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1203/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1202", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1202/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1202/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1202/events", "html_url": "https://github.com/locustio/locust/issues/1202", "id": 541187708, "node_id": "MDU6SXNzdWU1NDExODc3MDg=", "number": 1202, "title": "--csv-full-history throws error when in master/slave mode", "user": {"login": "uprichard", "id": 6080848, "node_id": "MDQ6VXNlcjYwODA4NDg=", "avatar_url": "https://avatars.githubusercontent.com/u/6080848?v=4", "gravatar_id": "", "url": "https://api.github.com/users/uprichard", "html_url": "https://github.com/uprichard", "followers_url": "https://api.github.com/users/uprichard/followers", "following_url": "https://api.github.com/users/uprichard/following{/other_user}", "gists_url": "https://api.github.com/users/uprichard/gists{/gist_id}", "starred_url": "https://api.github.com/users/uprichard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/uprichard/subscriptions", "organizations_url": "https://api.github.com/users/uprichard/orgs", "repos_url": "https://api.github.com/users/uprichard/repos", "events_url": "https://api.github.com/users/uprichard/events{/privacy}", "received_events_url": "https://api.github.com/users/uprichard/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-12-20T20:35:58Z", "updated_at": "2020-06-06T08:55:40Z", "closed_at": "2020-06-06T08:55:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "Steps:\r\nStart a test in master/slave mode ie.\r\nlocust -f test.py --no-web --host http://example.com -t 10  --csv-full-history --csv master --master\r\nThen start a slave\r\nlocust -f test.py --no-web --host http://example.com  --slave\r\n\r\nError:\r\nFollowing exception is listed twice\r\n\r\n> [2019-12-20 12:31:58,477] me/ERROR/stderr: Traceback (most recent call last):\r\n[2019-12-20 12:31:58,477] me/ERROR/stderr: \r\n[2019-12-20 12:31:58,477] me/ERROR/stderr: File \"src/gevent/greenlet.py\", line 818, in gevent._greenlet.Greenlet.run\r\n[2019-12-20 12:31:58,477] me/ERROR/stderr: \r\n[2019-12-20 12:31:58,477] me/ERROR/stderr: File \"/Users/me/PythonVersions/locust/lib/python3.7/site-packages/locust/stats.py\", line 763, in stats_writer\r\n    write_stat_csvs(base_filepath, stats_history_enabled)\r\n[2019-12-20 12:31:58,477] me/ERROR/stderr: \r\n[2019-12-20 12:31:58,477] me/ERROR/stderr: File \"/Users/me/PythonVersions/locust/lib/python3.7/site-packages/locust/stats.py\", line 773, in write_stat_csvs\r\n    f.write(stats_history_csv(stats_history_enabled) + \"\\n\")\r\n[2019-12-20 12:31:58,477] me/ERROR/stderr: \r\n[2019-12-20 12:31:58,477] me/ERROR/stderr: File \"/Users/me/PythonVersions/locust/lib/python3.7/site-packages/locust/stats.py\", line 887, in stats_history_csv\r\n    str(int(s.get_current_response_time_percentile(x) or 0)) for x in PERCENTILES_TO_REPORT])\r\n[2019-12-20 12:31:58,477] me/ERROR/stderr: \r\n[2019-12-20 12:31:58,477] me/ERROR/stderr: File \"/Users/me/PythonVersions/locust/lib/python3.7/site-packages/locust/stats.py\", line 887, in <listcomp>\r\n    str(int(s.get_current_response_time_percentile(x) or 0)) for x in PERCENTILES_TO_REPORT])\r\n[2019-12-20 12:31:58,478] me/ERROR/stderr: \r\n[2019-12-20 12:31:58,478] me/ERROR/stderr: File \"/Users/me/PythonVersions/locust/lib/python3.7/site-packages/locust/stats.py\", line 511, in get_current_response_time_percentile\r\n    raise ValueError(\"StatsEntry.use_response_times_cache must be set to True if we should be able to calculate the _current_ response time percentile\")\r\n[2019-12-20 12:31:58,478] me/ERROR/stderr: \r\n[2019-12-20 12:31:58,478] me/ERROR/stderr: ValueError: StatsEntry.use_response_times_cache must be set to True if we should be able to calculate the _current_ response time percentile\r\n[2019-12-20 12:31:58,478] me/ERROR/stderr: \r\n[2019-12-20 12:31:58,478] me/ERROR/stderr: 2019-12-20T20:31:58Z\r\n[2019-12-20 12:31:58,478] me/ERROR/stderr: \r\n[2019-12-20 12:31:58,478] me/ERROR/stderr: <Greenlet at 0x10b0b6ef0: stats_writer('master', True)> failed with ValueError\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1202/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1202/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1201", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1201/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1201/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1201/events", "html_url": "https://github.com/locustio/locust/issues/1201", "id": 539639800, "node_id": "MDU6SXNzdWU1Mzk2Mzk4MDA=", "number": 1201, "title": "Locust Slaves take a long time to attach to master when there are lots of slaves (>500)", "user": {"login": "sj2208", "id": 8023118, "node_id": "MDQ6VXNlcjgwMjMxMTg=", "avatar_url": "https://avatars.githubusercontent.com/u/8023118?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sj2208", "html_url": "https://github.com/sj2208", "followers_url": "https://api.github.com/users/sj2208/followers", "following_url": "https://api.github.com/users/sj2208/following{/other_user}", "gists_url": "https://api.github.com/users/sj2208/gists{/gist_id}", "starred_url": "https://api.github.com/users/sj2208/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sj2208/subscriptions", "organizations_url": "https://api.github.com/users/sj2208/orgs", "repos_url": "https://api.github.com/users/sj2208/repos", "events_url": "https://api.github.com/users/sj2208/events{/privacy}", "received_events_url": "https://api.github.com/users/sj2208/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 538798664, "node_id": "MDU6TGFiZWw1Mzg3OTg2NjQ=", "url": "https://api.github.com/repos/locustio/locust/labels/needs%20reproducing", "name": "needs reproducing", "color": "f9d0c4", "default": false, "description": null}, {"id": 1003994742, "node_id": "MDU6TGFiZWwxMDAzOTk0NzQy", "url": "https://api.github.com/repos/locustio/locust/labels/waiting%20on%20contributor", "name": "waiting on contributor", "color": "5319e7", "default": false, "description": ""}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-12-18T12:03:27Z", "updated_at": "2020-07-07T19:54:20Z", "closed_at": "2020-06-30T13:37:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n**### Describe the bug**\r\nLatest version - While spawning a distributed cluster of around 1000 slaves per master, seeing slowness in the way slaves register to master. Till 550- 600 slaves it happens within seconds but after that 2 slaves( 1 VM is of 2 core ) register to master every second. \r\nDue to this overall it takes too much time to spawn a cluster of 1000 slaves. \r\n\r\nThis issue was clearly not present in version 0.8a2 and is present in the latest version. \r\nI have a setup of 1000 virtual machines( 2 core each ) on Azure and requirement is to setup big clusters of 1000 unique external IPs to do the test. \r\nI am easily able to reproduce this in latest version of locust with python 2.7 and also 3.5.3 \r\n\r\n\r\nFor the time being I rolled back to 0.8a2 version of locust and everything seems to be working fine and I am able to spawn the same cluster with same set of scripts. \r\n\r\n- OS: Debian 9\r\n- Python version: 2.7, 3.5.3\r\n- Locust version: latest\r\n\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1201/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1201/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1198", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1198/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1198/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1198/events", "html_url": "https://github.com/locustio/locust/issues/1198", "id": 538604148, "node_id": "MDU6SXNzdWU1Mzg2MDQxNDg=", "number": 1198, "title": "Fix percentiles printed in _stats.csv file", "user": {"login": "mehta-ankit", "id": 22157398, "node_id": "MDQ6VXNlcjIyMTU3Mzk4", "avatar_url": "https://avatars.githubusercontent.com/u/22157398?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mehta-ankit", "html_url": "https://github.com/mehta-ankit", "followers_url": "https://api.github.com/users/mehta-ankit/followers", "following_url": "https://api.github.com/users/mehta-ankit/following{/other_user}", "gists_url": "https://api.github.com/users/mehta-ankit/gists{/gist_id}", "starred_url": "https://api.github.com/users/mehta-ankit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mehta-ankit/subscriptions", "organizations_url": "https://api.github.com/users/mehta-ankit/orgs", "repos_url": "https://api.github.com/users/mehta-ankit/repos", "events_url": "https://api.github.com/users/mehta-ankit/events{/privacy}", "received_events_url": "https://api.github.com/users/mehta-ankit/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-12-16T19:23:54Z", "updated_at": "2019-12-16T20:47:25Z", "closed_at": "2019-12-16T20:47:25Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please note: For general questions about how to use Locust, use either the Slack link provided in the Readme or [ask a question on Stack Overflow](https://stackoverflow.com/questions/ask) tagged Locust.-->\r\n\r\n### Describe the bug\r\nUsing `--csv` flag in 0.13.3 version of locust (after https://github.com/locustio/locust/pull/1146 was merged) only prints percentiles in the sliding window of `CURRENT_RESPONSE_TIME_PERCENTILE_WINDOW`. This happened because instead of using `get_response_time_percentile` i added `get_current_response_time_percentile` to `requests_csv` function.\r\n\r\n### Expected behavior\r\nThe percentiles printed in this file should be percentiles over the test run duration instead of over the last sliding window duration (which is 10 seconds as default). Since we anyways get the granularity of each interval of stats entries in `_stats_history.csv` with the `--csv--full-history` flag.\r\n\r\n### Actual behavior\r\nThe percentiles printed are for only the last 10 seconds of the test run. Since this file is overwritten at every interval using get_current_response_time_percentile() function only gives us that last duration percentiles.\r\n\r\n### Steps to reproduce\r\nRun a locust test using --csv flag and look at the `_stats.csv` file.\r\n\r\n### Environment settings\r\n\r\n- OS: Mac OSX 10.14.6 (Terminal info: Darwin Kernel Version 18.7.0)\r\n- Python version: 3.7.4\r\n- Locust version: 0.13.3\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1198/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1198/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1195", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1195/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1195/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1195/events", "html_url": "https://github.com/locustio/locust/issues/1195", "id": 537532649, "node_id": "MDU6SXNzdWU1Mzc1MzI2NDk=", "number": 1195, "title": "set default Accept-Encoding to \"gzip, deflate\" in FastHttpLocust to match HttpLocust behaviour", "user": {"login": "cyberw", "id": 1134328, "node_id": "MDQ6VXNlcjExMzQzMjg=", "avatar_url": "https://avatars.githubusercontent.com/u/1134328?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cyberw", "html_url": "https://github.com/cyberw", "followers_url": "https://api.github.com/users/cyberw/followers", "following_url": "https://api.github.com/users/cyberw/following{/other_user}", "gists_url": "https://api.github.com/users/cyberw/gists{/gist_id}", "starred_url": "https://api.github.com/users/cyberw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cyberw/subscriptions", "organizations_url": "https://api.github.com/users/cyberw/orgs", "repos_url": "https://api.github.com/users/cyberw/repos", "events_url": "https://api.github.com/users/cyberw/events{/privacy}", "received_events_url": "https://api.github.com/users/cyberw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-12-13T12:48:28Z", "updated_at": "2019-12-17T07:50:14Z", "closed_at": "2019-12-17T07:50:14Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "I'm going to fix this right away, but I'm adding this ticket to make it clear that a change has been done.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1195/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1195/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1193", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1193/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1193/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1193/events", "html_url": "https://github.com/locustio/locust/issues/1193", "id": 537007695, "node_id": "MDU6SXNzdWU1MzcwMDc2OTU=", "number": 1193, "title": "FastHttpLocust is very slow at returning the response text", "user": {"login": "cyberw", "id": 1134328, "node_id": "MDQ6VXNlcjExMzQzMjg=", "avatar_url": "https://avatars.githubusercontent.com/u/1134328?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cyberw", "html_url": "https://github.com/cyberw", "followers_url": "https://api.github.com/users/cyberw/followers", "following_url": "https://api.github.com/users/cyberw/following{/other_user}", "gists_url": "https://api.github.com/users/cyberw/gists{/gist_id}", "starred_url": "https://api.github.com/users/cyberw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cyberw/subscriptions", "organizations_url": "https://api.github.com/users/cyberw/orgs", "repos_url": "https://api.github.com/users/cyberw/repos", "events_url": "https://api.github.com/users/cyberw/events{/privacy}", "received_events_url": "https://api.github.com/users/cyberw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-12-12T14:21:24Z", "updated_at": "2019-12-17T07:50:01Z", "closed_at": "2019-12-17T07:50:01Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "Getting resp.text when using FastHttpLocust does a string decode (fasthttp.py:257) and it is crazy slow for large responses (~12s for a 1.5MB payload).\r\n\r\n        with self.client.request(method, f\"https://{host}{url}\", name, catch_response=True) as resp:\r\n            t = resp.text: # this takes ages\r\n            ....\r\n            return resp", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1193/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1193/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1191", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1191/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1191/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1191/events", "html_url": "https://github.com/locustio/locust/issues/1191", "id": 535433007, "node_id": "MDU6SXNzdWU1MzU0MzMwMDc=", "number": 1191, "title": "Error generating request statistics CSV in master\u2013slave mode", "user": {"login": "mjstrasser", "id": 168173, "node_id": "MDQ6VXNlcjE2ODE3Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/168173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mjstrasser", "html_url": "https://github.com/mjstrasser", "followers_url": "https://api.github.com/users/mjstrasser/followers", "following_url": "https://api.github.com/users/mjstrasser/following{/other_user}", "gists_url": "https://api.github.com/users/mjstrasser/gists{/gist_id}", "starred_url": "https://api.github.com/users/mjstrasser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mjstrasser/subscriptions", "organizations_url": "https://api.github.com/users/mjstrasser/orgs", "repos_url": "https://api.github.com/users/mjstrasser/repos", "events_url": "https://api.github.com/users/mjstrasser/events{/privacy}", "received_events_url": "https://api.github.com/users/mjstrasser/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-12-10T01:20:19Z", "updated_at": "2019-12-17T09:46:31Z", "closed_at": "2019-12-17T09:46:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nAfter applying load in master\u2013slave mode, generating request statistics causes an error.\r\n\r\nA `ValueError` is raised by `StatsEntry.get_current_response_time_percentile()` when it is called by `requests_csv()`. This is a change introduced by commit [44c3fffd5434c04034acc467184ad073b68f140c](https://github.com/locustio/locust/pull/1146/commits/44c3fffd5434c04034acc467184ad073b68f140c).\r\n\r\nThe error is not raised when not in master\u2013slave mode.\r\n\r\n### Expected behavior\r\nA CSV should be generated (and downloaded in web mode).\r\n\r\n### Actual behavior\r\nAn error is raised and no CSV is generated. In web mode a blank page is shown with only the words `Internal Server Error`. Returning to the web interface resets any chart information.\r\n\r\n### Steps to reproduce\r\nIn web mode:\r\n\r\n1. Start the master and slave processes.\r\n2. Start a swarm in the web interface.\r\n3. Go to the **Download Data** tab and click **Download request statistics CSV**.\r\n\r\nIn non-web mode.\r\n1. Start the slave process.\r\n2. Start the master process with the `--csv` option.\r\n\r\n### Environment settings\r\n\r\n- OS: MacOS, Linux\r\n- Python version: 3.7\r\n- Locust version: 0.13.2\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1191/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1191/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1188", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1188/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1188/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1188/events", "html_url": "https://github.com/locustio/locust/issues/1188", "id": 533827422, "node_id": "MDU6SXNzdWU1MzM4Mjc0MjI=", "number": 1188, "title": "SSLV3_ALERT_HANDSHAKE_FAILURE error with FastHttpLocust", "user": {"login": "hungcuongvt90", "id": 47652253, "node_id": "MDQ6VXNlcjQ3NjUyMjUz", "avatar_url": "https://avatars.githubusercontent.com/u/47652253?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hungcuongvt90", "html_url": "https://github.com/hungcuongvt90", "followers_url": "https://api.github.com/users/hungcuongvt90/followers", "following_url": "https://api.github.com/users/hungcuongvt90/following{/other_user}", "gists_url": "https://api.github.com/users/hungcuongvt90/gists{/gist_id}", "starred_url": "https://api.github.com/users/hungcuongvt90/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hungcuongvt90/subscriptions", "organizations_url": "https://api.github.com/users/hungcuongvt90/orgs", "repos_url": "https://api.github.com/users/hungcuongvt90/repos", "events_url": "https://api.github.com/users/hungcuongvt90/events{/privacy}", "received_events_url": "https://api.github.com/users/hungcuongvt90/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-12-06T08:51:52Z", "updated_at": "2020-04-12T22:19:01Z", "closed_at": "2020-04-12T22:19:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please note: For general questions about how to use Locust, use either the Slack link provided in the Readme or [ask a question on Stack Overflow](https://stackoverflow.com/questions/ask) tagged Locust.-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nI'm trying to use FastHttpLocust but I'm getting error with https url. Any suggestion to fix this ? Thank you\r\n\r\n\"SSLError(1, '[SSL: SSLV3_ALERT_HANDSHAKE_FAILURE] sslv3 alert handshake failure (_ssl.c:1076)')\"\r\n\r\n### Expected behavior\r\n\r\n### Actual behavior\r\n\r\n### Steps to reproduce \r\n\r\n### Environment settings\r\n\r\n- OS: Alpine3.10\r\n- Python version: 3.7.4\r\n- Locust version: 0.13.2\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1188/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1188/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1182", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1182/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1182/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1182/events", "html_url": "https://github.com/locustio/locust/issues/1182", "id": 531055968, "node_id": "MDU6SXNzdWU1MzEwNTU5Njg=", "number": 1182, "title": "Time response graph is not working on master/slave configuration", "user": {"login": "davidgca", "id": 26218314, "node_id": "MDQ6VXNlcjI2MjE4MzE0", "avatar_url": "https://avatars.githubusercontent.com/u/26218314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidgca", "html_url": "https://github.com/davidgca", "followers_url": "https://api.github.com/users/davidgca/followers", "following_url": "https://api.github.com/users/davidgca/following{/other_user}", "gists_url": "https://api.github.com/users/davidgca/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidgca/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidgca/subscriptions", "organizations_url": "https://api.github.com/users/davidgca/orgs", "repos_url": "https://api.github.com/users/davidgca/repos", "events_url": "https://api.github.com/users/davidgca/events{/privacy}", "received_events_url": "https://api.github.com/users/davidgca/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-12-02T11:07:54Z", "updated_at": "2020-03-04T15:08:52Z", "closed_at": "2019-12-02T13:11:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "After migrating to last python and locust releases and running a master-slave configuration in docker (one container for each master-slave node), the time response graph is not working: \"No data\" is showing by move pointer to the response-time line  (see attached images). \r\n\r\n![Locust error1](https://user-images.githubusercontent.com/26218314/69954255-28147e80-14fb-11ea-9bd4-a6c43a0ca3e9.png)\r\n\r\n![error locust summary1](https://user-images.githubusercontent.com/26218314/69954264-2e0a5f80-14fb-11ea-8900-52a9fa0f13c0.png)\r\n\r\n\r\n\r\nNOTE: Download data function is working well\r\n\r\n### Expected behaviour\r\nTime response graph should display all average response time distribution for the current execution\r\n\r\n### Actual behaviour\r\nAfter some seconds average response time goto \"No data\", Clicking on reset stats, the data return for 2-3 seconds and again drop to 0. The behaviours cannot be reproduced on a single container execution (without master/slaves):\r\n\r\n![error locust 4](https://user-images.githubusercontent.com/26218314/69954629-08ca2100-14fc-11ea-92e9-964bb77a5e96.png)\r\n\r\n\r\n### Steps to reproduce\r\nUpdate locust and python to last releases and rerun the cluster\r\n\r\n### Environment settings\r\n\r\nLocust version: 0.13.1\r\nPython/alpine version: python:3.8.0-alpine3.10\r\ndocker version:17.05.0-ce running on debian 9\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1182/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1182/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1177", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1177/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1177/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1177/events", "html_url": "https://github.com/locustio/locust/issues/1177", "id": 530194023, "node_id": "MDU6SXNzdWU1MzAxOTQwMjM=", "number": 1177, "title": "Unable to properly connect multiple slaves,  master Automatic disconnection", "user": {"login": "25342373", "id": 48433575, "node_id": "MDQ6VXNlcjQ4NDMzNTc1", "avatar_url": "https://avatars.githubusercontent.com/u/48433575?v=4", "gravatar_id": "", "url": "https://api.github.com/users/25342373", "html_url": "https://github.com/25342373", "followers_url": "https://api.github.com/users/25342373/followers", "following_url": "https://api.github.com/users/25342373/following{/other_user}", "gists_url": "https://api.github.com/users/25342373/gists{/gist_id}", "starred_url": "https://api.github.com/users/25342373/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/25342373/subscriptions", "organizations_url": "https://api.github.com/users/25342373/orgs", "repos_url": "https://api.github.com/users/25342373/repos", "events_url": "https://api.github.com/users/25342373/events{/privacy}", "received_events_url": "https://api.github.com/users/25342373/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-11-29T07:23:24Z", "updated_at": "2020-01-11T19:36:11Z", "closed_at": "2020-01-11T19:33:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please note: For general questions about how to use Locust, use either the Slack link provided in the Readme or [ask a question on Stack Overflow](https://stackoverflow.com/questions/ask) tagged Locust.-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\n### Expected behavior\r\n<!-- Tell us what should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example). Or even better - a pull request with a failing unit test --> \r\n\r\n### Environment settings\r\n\r\n- OS:\r\n- Python version:\r\n- Locust version:\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1177/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1177/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1176", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1176/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1176/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1176/events", "html_url": "https://github.com/locustio/locust/issues/1176", "id": 530194011, "node_id": "MDU6SXNzdWU1MzAxOTQwMTE=", "number": 1176, "title": "Unable to properly connect multiple slaves,  master ", "user": {"login": "25342373", "id": 48433575, "node_id": "MDQ6VXNlcjQ4NDMzNTc1", "avatar_url": "https://avatars.githubusercontent.com/u/48433575?v=4", "gravatar_id": "", "url": "https://api.github.com/users/25342373", "html_url": "https://github.com/25342373", "followers_url": "https://api.github.com/users/25342373/followers", "following_url": "https://api.github.com/users/25342373/following{/other_user}", "gists_url": "https://api.github.com/users/25342373/gists{/gist_id}", "starred_url": "https://api.github.com/users/25342373/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/25342373/subscriptions", "organizations_url": "https://api.github.com/users/25342373/orgs", "repos_url": "https://api.github.com/users/25342373/repos", "events_url": "https://api.github.com/users/25342373/events{/privacy}", "received_events_url": "https://api.github.com/users/25342373/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-11-29T07:23:22Z", "updated_at": "2019-11-29T08:47:02Z", "closed_at": "2019-11-29T08:47:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please note: For general questions about how to use Locust, use either the Slack link provided in the Readme or [ask a question on Stack Overflow](https://stackoverflow.com/questions/ask) tagged Locust.-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\n\r\n### Expected behavior\r\n<!-- Tell us what should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead -->\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example). Or even better - a pull request with a failing unit test --> \r\n\r\n### Environment settings\r\n\r\n- OS:\r\n- Python version:\r\n- Locust version:\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1176/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1176/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1174", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1174/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1174/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1174/events", "html_url": "https://github.com/locustio/locust/issues/1174", "id": 529519687, "node_id": "MDU6SXNzdWU1Mjk1MTk2ODc=", "number": 1174, "title": "RuntimeError: Set changed size during iteration on Python 3.6", "user": {"login": "cjw296", "id": 632049, "node_id": "MDQ6VXNlcjYzMjA0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/632049?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjw296", "html_url": "https://github.com/cjw296", "followers_url": "https://api.github.com/users/cjw296/followers", "following_url": "https://api.github.com/users/cjw296/following{/other_user}", "gists_url": "https://api.github.com/users/cjw296/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjw296/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjw296/subscriptions", "organizations_url": "https://api.github.com/users/cjw296/orgs", "repos_url": "https://api.github.com/users/cjw296/repos", "events_url": "https://api.github.com/users/cjw296/events{/privacy}", "received_events_url": "https://api.github.com/users/cjw296/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2019-11-27T18:49:54Z", "updated_at": "2020-01-16T15:13:21Z", "closed_at": "2020-01-16T15:13:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\nRunning a simple locust script on Python 3.6, I occasionally get the following when shutting down locust, either via the red stop button or ctrl-c on the python process:\r\n\r\n```\r\n Traceback (most recent call last):\r\n File \"gevent/pywsgi.py\", line 964, in handle_one_response\r\n    self.run_application()\r\n File \"gevent/pywsgi.py\", line 911, in run_application\r\n    self.result = self.application(self.environ, self.start_response)\r\n File \"flask/app.py\", line 2463, in __call__\r\n    return self.wsgi_app(environ, start_response)\r\n File \"flask/app.py\", line 2449, in wsgi_app\r\n    response = self.handle_exception(e)\r\n File \"flask/app.py\", line 1866, in handle_exception\r\n    reraise(exc_type, exc_value, tb)\r\n File \"flask/_compat.py\", line 39, in reraise\r\n    raise value\r\n File \"flask/app.py\", line 2446, in wsgi_app\r\n    response = self.full_dispatch_request()\r\n File \"flask/app.py\", line 1951, in full_dispatch_request\r\n    rv = self.handle_user_exception(e)\r\n File \"flask/app.py\", line 1820, in handle_user_exception\r\n    reraise(exc_type, exc_value, tb)\r\n File \"flask/_compat.py\", line 39, in reraise\r\n    raise value\r\n File \"flask/app.py\", line 1949, in full_dispatch_request\r\n    rv = self.dispatch_request()\r\n File \"flask/app.py\", line 1935, in dispatch_request\r\n    return self.view_functions[rule.endpoint](**req.view_args)\r\n File \"locust/web.py\", line 85, in stop\r\n    runners.locust_runner.stop()\r\n File \"locust/runners.py\", line 196, in stop\r\n    for locust_greenlet in self.locusts:\r\n RuntimeError: Set changed size during iteration\r\n 2019-11-27T18:41:36Z\r\n {'REMOTE_..., (hidden keys: 26)} failed with RuntimeError\r\n```\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example). Or even better - a pull request with a failing unit test --> \r\n\r\n### Environment settings\r\n\r\n- OS: RHEL 7\r\n- Python version: 3.6.7\r\n\r\n- Packages:\r\n```\r\ncertifi                 2019.9.11  Python package for providing Mozilla's CA Bundle.\r\nchardet                 3.0.4      Universal encoding detector for Python 2 and 3\r\nclick                   7.0        Composable command line interface toolkit\r\nfaker                   2.0.4      Faker is a Python package that generates fake data for you.\r\nflask                   1.1.1      A simple framework for building complex web applications.\r\ngevent                  1.5a2      Coroutine-based network library\r\ngeventhttpclient-wheels 1.3.1.dev2 Pre-built wheels for geventhttpclient\r\ngreenlet                0.4.15     Lightweight in-process concurrent programming\r\nidna                    2.8        Internationalized Domain Names in Applications (IDNA)\r\nitsdangerous            1.1.0      Various helpers to pass data to untrusted environments and back.\r\njinja2                  2.10.3     A very fast and expressive template engine.\r\nJSON.\r\nlocustio                0.13.2     Website load testing framework\r\nmarkupsafe              1.1.1      Safely add untrusted strings to HTML/XML markup.\r\nmsgpack-python          0.5.6      MessagePack (de)serializer.\r\npython-dateutil         2.8.1      Extensions to the standard Python datetime module\r\npytz                    2019.3     World timezone definitions, modern and historical\r\npyzmq                   18.1.1     Python bindings for 0MQ\r\nrequests                2.22.0     Python HTTP for Humans.\r\nsix                     1.13.0     Python 2 and 3 compatibility utilities\r\ntext-unidecode          1.3        The most basic Text::Unidecode port\r\nurllib3                 1.25.7     HTTP library with thread-safe connection pooling, file post, and more.\r\nwerkzeug                0.16.0     The comprehensive WSGI web application library.\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1174/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1174/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1172", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1172/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1172/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1172/events", "html_url": "https://github.com/locustio/locust/issues/1172", "id": 528527316, "node_id": "MDU6SXNzdWU1Mjg1MjczMTY=", "number": 1172, "title": "Zero exit code on exception", "user": {"login": "mofr", "id": 1718475, "node_id": "MDQ6VXNlcjE3MTg0NzU=", "avatar_url": "https://avatars.githubusercontent.com/u/1718475?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mofr", "html_url": "https://github.com/mofr", "followers_url": "https://api.github.com/users/mofr/followers", "following_url": "https://api.github.com/users/mofr/following{/other_user}", "gists_url": "https://api.github.com/users/mofr/gists{/gist_id}", "starred_url": "https://api.github.com/users/mofr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mofr/subscriptions", "organizations_url": "https://api.github.com/users/mofr/orgs", "repos_url": "https://api.github.com/users/mofr/repos", "events_url": "https://api.github.com/users/mofr/events{/privacy}", "received_events_url": "https://api.github.com/users/mofr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-11-26T06:56:06Z", "updated_at": "2019-11-30T17:50:54Z", "closed_at": "2019-11-28T18:28:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "# Description\r\nLocust returns zero exit code when an unexpected exception occurs in the task set.\r\n\r\n### Expected behavior\r\nThe exit code is 1.\r\n\r\n### Actual behavior\r\nThe exit code is 0.\r\n\r\n### Steps to reproduce\r\n```\r\nclass ExampleTaskSet(TaskSet):\r\n    @task()\r\n    def task1(self):\r\n        raise Exception('Test exception')\r\n```\r\n\r\n### Environment settings\r\n- OS: Ubuntu 16.04\r\n- Python version: CPython 3.6.3\r\n- Locust version: 0.13.2\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1172/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1172/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1171", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1171/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1171/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1171/events", "html_url": "https://github.com/locustio/locust/issues/1171", "id": 528072670, "node_id": "MDU6SXNzdWU1MjgwNzI2NzA=", "number": 1171, "title": "In the on_start function variable values are not updating but methods under the on_start function were triggered", "user": {"login": "rahim04a4", "id": 15208040, "node_id": "MDQ6VXNlcjE1MjA4MDQw", "avatar_url": "https://avatars.githubusercontent.com/u/15208040?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rahim04a4", "html_url": "https://github.com/rahim04a4", "followers_url": "https://api.github.com/users/rahim04a4/followers", "following_url": "https://api.github.com/users/rahim04a4/following{/other_user}", "gists_url": "https://api.github.com/users/rahim04a4/gists{/gist_id}", "starred_url": "https://api.github.com/users/rahim04a4/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rahim04a4/subscriptions", "organizations_url": "https://api.github.com/users/rahim04a4/orgs", "repos_url": "https://api.github.com/users/rahim04a4/repos", "events_url": "https://api.github.com/users/rahim04a4/events{/privacy}", "received_events_url": "https://api.github.com/users/rahim04a4/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-11-25T13:03:20Z", "updated_at": "2020-01-11T19:38:33Z", "closed_at": "2020-01-11T19:38:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "In the on_start function variable values are not updating but methods under the on_start function were triggered\r\n\r\n\r\n### Describe the bug\r\nI have a functionality like need to create new folder for every stop and start of locust application.\r\nFor this i'm taking the current date and creating folder based on that datetime. It is working fine when we kill the locust service and re-start with command. But when i'm trying through web, means stop the test and start the new functionality not working as expected. But i wrote archive functionality based date, it is replacing existing files because data is not updating.  \r\n\r\n### Expected behavior\r\nDate should update when we stop and start a test through web(It should create a new folder when we stop and start a test through web).\r\n\r\n\r\n### Actual behavior\r\nDate remains same  when we stop and start a test through web\r\n\r\n### Steps to reproduce\r\nclass WebsiteUser(HttpLocust):\r\n    task_set = UserBehavior\r\n    min_wait = 5000\r\n    max_wait = 9000\r\n    #weight=200\r\n    h = 0\r\n\r\n\r\n\r\n\r\n\r\n    def __init__(self, *args, **kwargs):\r\n        super(WebsiteUser, self).__init__(*args, **kwargs)\r\n        print('######### Intiating files  ##########')\r\n\r\n        self.dir_path = os.path.dirname(os.path.realpath(__file__))\r\n        self.root_path = self.dir_path + os.path.sep +'Perf_Stats'\r\n        self.archive   = self.dir_path + os.path.sep + 'archive'\r\n        self.url, self.userId, self.password, self.buildVersion,self.aws_bucket = get_wow_conf()\r\n\r\n        tmp_datename = self.clean_files()  -- this clean_files method triggered\r\n        self.datename = tmp_datename   -- this is not working, same datetime is displaying \r\n        #self.upload_files_to_s3()\r\n\r\n        #self.datename = self.get_time() # str(datetime.now().strftime(\"%Y_%m_%d_%H_%M_%S\"))\r\n        print('######### cleaning files  ##########')\r\n        print('############## setup class in one ###########')\r\n\r\n\r\n\r\n    def setup(self):\r\n\r\n\r\n        events.request_success += self.hook_request_success\r\n        #events.request_failure += self.hook_request_success\r\n\r\n\r\n\r\n    def teardown(self):\r\n        pass\r\n\r\n    def get_time(self):\r\n        return str(datetime.now().strftime(\"%Y_%m_%d_%H_%M_%S\"))\r\n\r\n    def clean_files(self):\r\n        import shutil\r\n        try :\r\n            root_path = self.root_path\r\n            archive   = self.archive\r\n\r\n            if os.path.isdir(archive) == True:\r\n                shutil.rmtree(archive)\r\n\r\n            shutil.move(root_path,archive)\r\n            shutil.rmtree(root_path)\r\n        except Exception as e:\r\n            print(e)\r\n        return str(datetime.now().strftime(\"%Y_%m_%d_%H_%M_%S\"))\r\n\r\n    def upload_files_to_s3(self):\r\n        try:\r\n            s3 = boto3.client('s3')\r\n            root_path = self.root_path\r\n            bucket_name = self.aws_bucket  # s3 bucket name\r\n            #root_path = '/home/ec2-user/rs'  # local folder for upload\r\n            # root_path = '/Users/Rahim.Sheik/PycharmProjects/cng-wow/test/PerformenceTests/Perf_Stats'\r\n            # my_bucket = s3_resource.Bucket(bucket_name)\r\n\r\n            for path, subdirs, files in os.walk(root_path):\r\n                path = path.replace(\"\\\\\", \"/\")\r\n                print(path)\r\n                directory_name = path.replace(root_path, \"\")\r\n                # print(directory_name)\r\n                print(files)\r\n                print(type(files))\r\n                files = [i for i in files if i.endswith('.csv')]\r\n                print(files)\r\n                for file in files:\r\n                    op_filepath = 'Wow_perf_out' + os.path.sep + file[:-13] + os.path.sep + file\r\n                    filepath = path + os.path.sep + file\r\n                    print('file is', file)\r\n                    print('output file path ', op_filepath)\r\n                    print('full file path', filepath)\r\n\r\n                    s3.upload_file(filepath, 'cng-input', op_filepath)\r\n                    # my_bucket.upload_file(os.path.join(path, file), directory_name+os.path.sep+file)\r\n            self.clean_files()\r\n\r\n        except Exception as err:\r\n            print(err)\r\n\r\n\r\n    def _upload_files_to_s3(self):\r\n        '''\r\n\r\n        s3 = boto3.client('s3')\r\n        root_path = self.root_path\r\n        #res1 = s3.upload_file('/home/ec2-user/abc.txt', 'cng-input', 'sample/{}'.format('abc.txt'))\r\n        for path, subdirs, files in os.walk(root_path):\r\n            path = path.replace(\"\\\\\", \"/\")\r\n            directory_name = path.replace(root_path, \"\")\r\n            for file in files:\r\n                s3.upload_file(os.path.join(path, file), directory_name + os.path.sep + file)\r\n        '''\r\n        s3_resource = boto3.resource(\"s3\", region_name=\"us-east-1\")\r\n        bucket_name = \"cng-input\"  # s3 bucket name\r\n        #root_path = '/Users/Rahim.Sheik/PycharmProjects/cng-wow/test/'  # local folder for upload\r\n\r\n        my_bucket = s3_resource.Bucket(bucket_name)\r\n\r\n        for path, subdirs, files in os.walk(self.archive):\r\n            path = path.replace(\"\\\\\", \"/\")\r\n            directory_name = path.replace(self.archive, \"\")\r\n            for file in files:\r\n                my_bucket.upload_file(os.path.join(path, file), directory_name + '/' + file)\r\n        pass\r\n\r\n\r\n\r\n\r\n\r\n    # hook that is fired each time the request ends up with success\r\n    def hook_request_success(self, request_type, name, response_time, response_length, **kw):\r\n\r\n        print('path is ',self.root_path)\r\n        file =  'Perf_Stats_'+ self.datename +'.csv'\r\n\r\n        print('os path sep :',os.path.sep)\r\n\r\n        #dir_path = self.dir_path + os.path.sep + 'Perf_Stats'\r\n        PATH     = self.root_path + os.path.sep + file\r\n\r\n        print('######### Path is {} #########'.format(PATH))\r\n        print('\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039         \u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039',request_type, name, response_time, response_length, **kw)\r\n        try :\r\n\r\n            if os.path.isdir(self.root_path):\r\n                pass\r\n            else:\r\n                try:\r\n                    os.makedirs(self.root_path)\r\n                except OSError:\r\n                    print(\"Creation of the directory %s failed\" % self.root_path)\r\n                else:\r\n                    print(\"Successfully created the directory %s \" % self.root_path)\r\n\r\n        except Exception as e:\r\n            print(e)\r\n\r\n        #self.file = open('stats.csv', 'a')\r\n        if os.path.isfile(PATH) and os.access(PATH, os.R_OK):\r\n\r\n            print(\"File exists and is readable\")\r\n            self.file = open(PATH, 'a')\r\n            self.file.write(request_type + \",\" + name + \",\" + str(response_time)+ \",\" +str(datetime.now().strftime(\"%Y-%m-%d %H:%M:%S.%f\")) + \"\\n\")\r\n            self.file.close()\r\n            #return True\r\n        else:\r\n            print(\"Either the file is missing or not readable\")\r\n            self.file = open(PATH, 'a')\r\n\r\n            self.file.write('Request_Type' + \",\" + 'Name' + \",\" + 'Response_Time(ms)' + \",\" + 'Log_date'  + \"\\n\")\r\n            self.file.write(request_type + \",\" + name + \",\" + str(response_time) + \",\" + str(\r\n                datetime.now().strftime(\"%Y-%m-%d %H:%M:%S.%f\")) + \"\\n\")\r\n            self.file.close()\r\n            #return False\r\n\r\n\r\n\r\n        print('############ Logging stats #############',request_type, name, response_time, response_length)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n### Environment settings\r\n\r\n- OS:  windows\r\n- Python version: 3.7\r\n- Locust version: 0.12.2\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1171/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1171/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1170", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1170/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1170/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1170/events", "html_url": "https://github.com/locustio/locust/issues/1170", "id": 527568641, "node_id": "MDU6SXNzdWU1Mjc1Njg2NDE=", "number": 1170, "title": "Some exceptions occurred during installation of version >0.13.0 (exclude 0.13.0)", "user": {"login": "MrPaddi", "id": 24726851, "node_id": "MDQ6VXNlcjI0NzI2ODUx", "avatar_url": "https://avatars.githubusercontent.com/u/24726851?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MrPaddi", "html_url": "https://github.com/MrPaddi", "followers_url": "https://api.github.com/users/MrPaddi/followers", "following_url": "https://api.github.com/users/MrPaddi/following{/other_user}", "gists_url": "https://api.github.com/users/MrPaddi/gists{/gist_id}", "starred_url": "https://api.github.com/users/MrPaddi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MrPaddi/subscriptions", "organizations_url": "https://api.github.com/users/MrPaddi/orgs", "repos_url": "https://api.github.com/users/MrPaddi/repos", "events_url": "https://api.github.com/users/MrPaddi/events{/privacy}", "received_events_url": "https://api.github.com/users/MrPaddi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901882, "node_id": "MDU6TGFiZWwxNjM1OTAxODgy", "url": "https://api.github.com/repos/locustio/locust/labels/wontfix", "name": "wontfix", "color": "ddcccc", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-11-23T15:10:30Z", "updated_at": "2019-12-02T15:31:58Z", "closed_at": "2019-12-02T14:04:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nWhen I install the lastest locustio in win10 by pip, some exception occurred:\r\n\r\n    File \"D:\\DOC\\PythonProject\\sanic_learn\\venv\\lib\\site-packages\\pip-19.0.3-py3.7.egg\\pip\\_internal\\req\\req_install.py\", line 913, in install\r\n      use_user_site=use_user_site, pycompile=pycompile,\r\n    File \"D:\\DOC\\PythonProject\\sanic_learn\\venv\\lib\\site-packages\\pip-19.0.3-py3.7.egg\\pip\\_internal\\req\\req_install.py\", line 445, in move_wheel_files\r\n      warn_script_location=warn_script_location,\r\n    File \"D:\\DOC\\PythonProject\\sanic_learn\\venv\\lib\\site-packages\\pip-19.0.3-py3.7.egg\\pip\\_internal\\wheel.py\", line 458, in move_wheel_files\r\n      clobber(source, dest, False, fixer=fixer, filter=filter)\r\n    File \"D:\\DOC\\PythonProject\\sanic_learn\\venv\\lib\\site-packages\\pip-19.0.3-py3.7.egg\\pip\\_internal\\wheel.py\", line 424, in clobber\r\n      record_installed(srcfile, destfile, changed)\r\n    File \"D:\\DOC\\PythonProject\\sanic_learn\\venv\\lib\\site-packages\\pip-19.0.3-py3.7.egg\\pip\\_internal\\wheel.py\", line 351, in record_installed\r\n      newpath = normpath(destfile, lib_dir)\r\n    File \"D:\\DOC\\PythonProject\\sanic_learn\\venv\\lib\\site-packages\\pip-19.0.3-py3.7.egg\\pip\\_internal\\wheel.py\", line 68, in normpath\r\n      return os.path.relpath(src, p).replace(os.path.sep, '/')\r\n    File \"d:\\ProgramData\\Anaconda3\\lib\\ntpath.py\", line 562, in relpath\r\n      path_drive, start_drive))\r\n  ValueError: path is on mount 'D:', start on mount 'C:'\r\n\r\nIt's success when I install version 0.13.0\r\n\r\nThere are not found same example in issues, so I report it as bug\r\n\r\n### Environment settings\r\n\r\n- OS: win10\r\n- Python version: 3.7.4\r\n- Locust version: >0.13.0\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1170/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1170/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1169", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1169/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1169/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1169/events", "html_url": "https://github.com/locustio/locust/issues/1169", "id": 527544793, "node_id": "MDU6SXNzdWU1Mjc1NDQ3OTM=", "number": 1169, "title": "Got error using locust when it is installed using python -m", "user": {"login": "zeinababbasi", "id": 19946389, "node_id": "MDQ6VXNlcjE5OTQ2Mzg5", "avatar_url": "https://avatars.githubusercontent.com/u/19946389?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zeinababbasi", "html_url": "https://github.com/zeinababbasi", "followers_url": "https://api.github.com/users/zeinababbasi/followers", "following_url": "https://api.github.com/users/zeinababbasi/following{/other_user}", "gists_url": "https://api.github.com/users/zeinababbasi/gists{/gist_id}", "starred_url": "https://api.github.com/users/zeinababbasi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zeinababbasi/subscriptions", "organizations_url": "https://api.github.com/users/zeinababbasi/orgs", "repos_url": "https://api.github.com/users/zeinababbasi/repos", "events_url": "https://api.github.com/users/zeinababbasi/events{/privacy}", "received_events_url": "https://api.github.com/users/zeinababbasi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-11-23T11:16:46Z", "updated_at": "2020-01-11T19:25:28Z", "closed_at": "2020-01-11T19:25:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Description\r\nI have installed **locust** as explained in the docs with `python3 -m pip install locustio` and the installation process has returned no errors. But when I called `locust --help`, I got this error:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/zeinab/.local/bin/locust\", line 7, in <module>\r\n    from locust.main import main\r\n  File \"/home/zeinab/.local/lib/python3.6/site-packages/locust/__init__.py\", line 1, in <module>\r\n    from .core import HttpLocust, Locust, TaskSet, TaskSequence, task, seq_task\r\n  File \"/home/zeinab/.local/lib/python3.6/site-packages/locust/core.py\", line 17, in <module>\r\n    monkey.patch_all()\r\n  File \"/home/zeinab/.local/lib/python3.6/site-packages/gevent/monkey.py\", line 1087, in patch_all\r\n    _notify_patch(events.GeventWillPatchAllEvent(modules_to_patch, kwargs), _warnings)\r\n  File \"/home/zeinab/.local/lib/python3.6/site-packages/gevent/monkey.py\", line 173, in _notify_patch\r\n    notify_and_call_entry_points(event)\r\n  File \"/home/zeinab/.local/lib/python3.6/site-packages/gevent/events.py\", line 112, in notify_and_call_entry_points\r\n    subscriber = plugin.load()\r\n  File \"/home/zeinab/.local/lib/python3.6/site-packages/pkg_resources/__init__.py\", line 2433, in load\r\n    self.require(*args, **kwargs)\r\n  File \"/home/zeinab/.local/lib/python3.6/site-packages/pkg_resources/__init__.py\", line 2456, in require\r\n    items = working_set.resolve(reqs, env, installer, extras=self.extras)\r\n  File \"/home/zeinab/.local/lib/python3.6/site-packages/pkg_resources/__init__.py\", line 786, in resolve\r\n    raise DistributionNotFound(req, requirers)\r\npkg_resources.DistributionNotFound: The 'psutil>=5.6.1; platform_python_implementation == \"CPython\" or sys_platform != \"win32\" and extra == \"recommended\"' distribution was not found and is required by the application\r\n```\r\n\r\nI tried to install it using pip directly; i.e. `pip3 install locustio`. This time it was installed completely and calling **locust** returns no error. \r\nWhile installing the **locustio** with the second approach, the **pip3** installed **psutil** which was not installed when using first command:\r\n```\r\nCollecting psutil>=5.6.1; platform_python_implementation == \"CPython\" or sys_platform != \"win32\" and extra == \"recommended\" (from gevent==1.5a2->locustio)\r\n\r\n  Downloading https://files.pythonhosted.org/packages/03/9a/95c4b3d0424426e5fd94b5302ff74cea44d5d4f53466e1228ac8e73e14b4/psutil-5.6.5.tar.gz (447kB)\r\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 450kB 460kB/s \r\n```\r\n\r\n### Environment settings\r\n- OS: Ubuntu 18.04\r\n- Python version: 3.7.6; it is installed inside a virtual environment which was created using **pyenv**.\r\n- Locust version: 0.13.2\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1169/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1169/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1168", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1168/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1168/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1168/events", "html_url": "https://github.com/locustio/locust/issues/1168", "id": 525934030, "node_id": "MDU6SXNzdWU1MjU5MzQwMzA=", "number": 1168, "title": "Stats are reset when re-balancing users across slave nodes", "user": {"login": "heyman", "id": 54217, "node_id": "MDQ6VXNlcjU0MjE3", "avatar_url": "https://avatars.githubusercontent.com/u/54217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/heyman", "html_url": "https://github.com/heyman", "followers_url": "https://api.github.com/users/heyman/followers", "following_url": "https://api.github.com/users/heyman/following{/other_user}", "gists_url": "https://api.github.com/users/heyman/gists{/gist_id}", "starred_url": "https://api.github.com/users/heyman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/heyman/subscriptions", "organizations_url": "https://api.github.com/users/heyman/orgs", "repos_url": "https://api.github.com/users/heyman/repos", "events_url": "https://api.github.com/users/heyman/events{/privacy}", "received_events_url": "https://api.github.com/users/heyman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2019-11-20T16:54:04Z", "updated_at": "2020-01-27T09:59:03Z", "closed_at": "2020-01-24T12:35:16Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "When running locust with `--reset-stats` in distributed mode, the stats are reset every time a new slave connects (when the re-balancing of the simulated users occur). The stats should only be reset when the initial hatching is complete, and not when re-balancing users.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1168/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1168/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1162", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1162/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1162/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1162/events", "html_url": "https://github.com/locustio/locust/issues/1162", "id": 525080152, "node_id": "MDU6SXNzdWU1MjUwODAxNTI=", "number": 1162, "title": "`--stop-timeout` is not respected when changing number of running Users in distributed mode", "user": {"login": "heyman", "id": 54217, "node_id": "MDQ6VXNlcjU0MjE3", "avatar_url": "https://avatars.githubusercontent.com/u/54217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/heyman", "html_url": "https://github.com/heyman", "followers_url": "https://api.github.com/users/heyman/followers", "following_url": "https://api.github.com/users/heyman/following{/other_user}", "gists_url": "https://api.github.com/users/heyman/gists{/gist_id}", "starred_url": "https://api.github.com/users/heyman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/heyman/subscriptions", "organizations_url": "https://api.github.com/users/heyman/orgs", "repos_url": "https://api.github.com/users/heyman/repos", "events_url": "https://api.github.com/users/heyman/events{/privacy}", "received_events_url": "https://api.github.com/users/heyman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-11-19T15:25:24Z", "updated_at": "2019-11-19T15:46:08Z", "closed_at": "2019-11-19T15:46:08Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Describe the bug\r\nWhen running Locust distributed, and changing the number of simulated Users (e.g. if a new slave node connects), simulated users will be killed immediately without respecting `--stop-timeout`\r\n\r\n### Expected behavior\r\nRunning locust user should get a chance to finish their tasks within the specified `stop-timeout`.\r\n\r\n### Actual behavior\r\nRunning locust users are killed immediately.\r\n\r\n### Fix\r\nI'm currently working on a fix for this.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1162/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1162/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1160", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1160/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1160/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1160/events", "html_url": "https://github.com/locustio/locust/issues/1160", "id": 525009509, "node_id": "MDU6SXNzdWU1MjUwMDk1MDk=", "number": 1160, "title": "Weight attribute on Locust class does not work", "user": {"login": "kob555", "id": 52236047, "node_id": "MDQ6VXNlcjUyMjM2MDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/52236047?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kob555", "html_url": "https://github.com/kob555", "followers_url": "https://api.github.com/users/kob555/followers", "following_url": "https://api.github.com/users/kob555/following{/other_user}", "gists_url": "https://api.github.com/users/kob555/gists{/gist_id}", "starred_url": "https://api.github.com/users/kob555/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kob555/subscriptions", "organizations_url": "https://api.github.com/users/kob555/orgs", "repos_url": "https://api.github.com/users/kob555/repos", "events_url": "https://api.github.com/users/kob555/events{/privacy}", "received_events_url": "https://api.github.com/users/kob555/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 538798664, "node_id": "MDU6TGFiZWw1Mzg3OTg2NjQ=", "url": "https://api.github.com/repos/locustio/locust/labels/needs%20reproducing", "name": "needs reproducing", "color": "f9d0c4", "default": false, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-11-19T13:28:23Z", "updated_at": "2019-11-20T15:22:20Z", "closed_at": "2019-11-20T15:18:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n* There are two locusts defined: LocustA and LocustB\r\n* LocustA has TaskSetA assigned and LocustB has TaskSetB assigned.\r\n* Each task set has one task, which creates a new file. \r\n* File name pattern allows to count, how many file where created by each task set.\r\n* LocustA has weight set to `wa`, LocustB has weight set to `wb`.\r\n* The expected distribution of tasksetA is `wa / (wa + wb)`\r\n* After running locust, the actual distribution of the runs does not reflect the defined weights. \r\n\r\n### Expected behavior\r\n* Distribute the executions of the task sets to a wa:wb ratio, so that `wa / (wa + wb) * 100%`  of the executions are TaskSetA.\r\n\r\n### Actual behavior\r\n* The execution ratio of TaskSetA is different than `wa / (wa + wb) * 100%`, e.g. for a 1:9 defined ratio, the actual result is around 3:7.\r\n\r\n### Steps to reproduce\r\nminimal.py\r\n```\r\nimport datetime\r\nfrom locust import task, TaskSet, constant, Locust\r\n\r\n\r\ndef Write(prefix):\r\n    d = datetime.datetime.now()\r\n    timestamp = d.strftime(\"%Y-%m-%d_%H-%M-%S-%f\")\r\n    directory = \"C:\\\\TEMP\"\r\n\r\n    with open(directory + \"\\\\\" + prefix + \"_\" + timestamp + \".txt\", \"w\") as text_file:\r\n        text_file.write(\"\")\r\n\r\n\r\nclass TaskSetA(TaskSet):\r\n    @task\r\n    def TaskA(self):\r\n        print \"TaskSetA started\"\r\n        Write(\"TaskSetA\")\r\n\r\n\r\nclass TaskSetB(TaskSet):\r\n    @task\r\n    def TaskB(self):\r\n        print \"TaskSetB started\"\r\n        Write(\"TaskSetB\")\r\n\r\n\r\nclass LocustA(Locust):\r\n    weight = 1\r\n    task_set = TaskSetA\r\n    wait_time = constant(0.5)\r\n\r\n\r\nclass LocustB(Locust):\r\n    weight = 9\r\n    task_set = TaskSetB\r\n    wait_time = constant(0.5)\r\n```\r\n\r\nStart it:\r\n```\r\nlocust -f minimal.py\r\n```\r\n\r\nGo to web interface:\r\nhttp://localhost:8089/\r\nStart swarming with these parameters:\r\n* Number of users = 100\r\n* Hatch rate = 100\r\n* Host = http://localhost\r\n\t\r\nPress stop after a while and count the files in the output directory:\r\n```\r\nls -l|grep TaskSetA|wc\r\nls -l|grep TaskSetB|wc\r\n```\r\nThere is a high discrepancy between the defined ratio 1:9 and the actual ratio of the files.\r\n\r\n### Environment settings\r\n\r\n- OS: Microsoft Windows [Version 10.0.17134.1130]\r\n- Python version: 2.7.17\r\n- Locust version: 0.13.1\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1160/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1160/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1158", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1158/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1158/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1158/events", "html_url": "https://github.com/locustio/locust/issues/1158", "id": 524499935, "node_id": "MDU6SXNzdWU1MjQ0OTk5MzU=", "number": 1158, "title": "Slave count stuck at 3 instead of decreasing to 1 due to \"missing\"", "user": {"login": "max-rocket-internet", "id": 8859277, "node_id": "MDQ6VXNlcjg4NTkyNzc=", "avatar_url": "https://avatars.githubusercontent.com/u/8859277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/max-rocket-internet", "html_url": "https://github.com/max-rocket-internet", "followers_url": "https://api.github.com/users/max-rocket-internet/followers", "following_url": "https://api.github.com/users/max-rocket-internet/following{/other_user}", "gists_url": "https://api.github.com/users/max-rocket-internet/gists{/gist_id}", "starred_url": "https://api.github.com/users/max-rocket-internet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/max-rocket-internet/subscriptions", "organizations_url": "https://api.github.com/users/max-rocket-internet/orgs", "repos_url": "https://api.github.com/users/max-rocket-internet/repos", "events_url": "https://api.github.com/users/max-rocket-internet/events{/privacy}", "received_events_url": "https://api.github.com/users/max-rocket-internet/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2019-11-18T17:08:12Z", "updated_at": "2021-08-11T13:00:27Z", "closed_at": "2020-01-03T12:31:37Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Master logs after slaves scaling down:\r\n\r\n```\r\n[2019-11-18 16:57:02,829] locust-opa-master-787476b668-74txj/INFO/locust.main: Starting web monitor at *:8089\r\n[2019-11-18 16:57:02,830] locust-opa-master-787476b668-74txj/INFO/locust.main: Starting Locust 0.13.1\r\n[2019-11-18 16:57:24,100] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-cjkwb_594d3fd33f864c34aaabbb987cd79e65' reported as ready. Currently 1 clients ready to swarm.\r\n[2019-11-18 16:57:24,210] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-pljft_240da2aa2ada4a0993fad606fb5976e0' reported as ready. Currently 2 clients ready to swarm.\r\n[2019-11-18 16:57:24,221] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-zckdc_b42adb57f2d34ef885b0bcc228068102' reported as ready. Currently 3 clients ready to swarm.\r\n[2019-11-18 16:57:24,253] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-z2g29_7772633197e6471b9344951aba939c39' reported as ready. Currently 4 clients ready to swarm.\r\n[2019-11-18 16:57:24,356] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-d95g2_a3a40cf055d749ea8b6c0e3246f22faa' reported as ready. Currently 5 clients ready to swarm.\r\n[2019-11-18 16:57:24,381] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-mm7dt_ee79eead69c84802a096a12f6e6ef1e5' reported as ready. Currently 6 clients ready to swarm.\r\n[2019-11-18 16:57:24,388] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-b7c2k_a961e9574df048739d1057d70dff35bd' reported as ready. Currently 7 clients ready to swarm.\r\n[2019-11-18 16:57:24,612] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-kfjh2_c080829438e64f76a02090adaad1a0dc' reported as ready. Currently 8 clients ready to swarm.\r\n[2019-11-18 16:57:24,626] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-d2kg5_d5ee1c3c3dcb4762b87872edcdcb0e28' reported as ready. Currently 9 clients ready to swarm.\r\n[2019-11-18 16:57:24,636] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-hwh4v_77d2b07171a549fd9af73a8a86222c81' reported as ready. Currently 10 clients ready to swarm.\r\n[2019-11-18 16:57:24,690] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-vpfnf_5217f03d668f4bf2b3ae7580e8e701eb' reported as ready. Currently 11 clients ready to swarm.\r\n[2019-11-18 16:57:24,764] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-sl24v_0da998e92bcd46b1ba7161d260bc3edf' reported as ready. Currently 12 clients ready to swarm.\r\n[2019-11-18 16:57:24,786] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-nw5ln_97ac9424368546b1b947441ce2d11f3a' reported as ready. Currently 13 clients ready to swarm.\r\n[2019-11-18 16:57:24,804] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-w6lhx_fa3a32665a814af8af8fca9657814d1f' reported as ready. Currently 14 clients ready to swarm.\r\n[2019-11-18 16:57:24,932] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-qr4tf_8ff013c045e7445494154d52f3a5dda7' reported as ready. Currently 15 clients ready to swarm.\r\n[2019-11-18 16:57:25,074] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-jb2rr_8e423e848d9b442e9cfc02d6c1cd6aca' reported as ready. Currently 16 clients ready to swarm.\r\n[2019-11-18 16:57:34,843] locust-opa-master-787476b668-74txj/INFO/locust.runners: Slave locust-opa-slave-86cf6df9fb-zckdc_b42adb57f2d34ef885b0bcc228068102 failed to send heartbeat, setting state to missing.\r\n[2019-11-18 16:57:34,843] locust-opa-master-787476b668-74txj/INFO/locust.runners: Slave locust-opa-slave-86cf6df9fb-z2g29_7772633197e6471b9344951aba939c39 failed to send heartbeat, setting state to missing.\r\n[2019-11-18 17:02:30,550] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-b7c2k_a961e9574df048739d1057d70dff35bd' quit. Currently 13 clients connected.\r\n[2019-11-18 17:02:30,557] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-vpfnf_5217f03d668f4bf2b3ae7580e8e701eb' quit. Currently 12 clients connected.\r\n[2019-11-18 17:02:30,559] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-sl24v_0da998e92bcd46b1ba7161d260bc3edf' quit. Currently 11 clients connected.\r\n[2019-11-18 17:02:30,560] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-jb2rr_8e423e848d9b442e9cfc02d6c1cd6aca' quit. Currently 10 clients connected.\r\n[2019-11-18 17:02:30,563] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-kfjh2_c080829438e64f76a02090adaad1a0dc' quit. Currently 9 clients connected.\r\n[2019-11-18 17:02:30,569] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-hwh4v_77d2b07171a549fd9af73a8a86222c81' quit. Currently 8 clients connected.\r\n[2019-11-18 17:02:30,571] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-w6lhx_fa3a32665a814af8af8fca9657814d1f' quit. Currently 7 clients connected.\r\n[2019-11-18 17:02:30,580] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-nw5ln_97ac9424368546b1b947441ce2d11f3a' quit. Currently 6 clients connected.\r\n[2019-11-18 17:02:30,581] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-pljft_240da2aa2ada4a0993fad606fb5976e0' quit. Currently 5 clients connected.\r\n[2019-11-18 17:02:30,588] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-mm7dt_ee79eead69c84802a096a12f6e6ef1e5' quit. Currently 4 clients connected.\r\n[2019-11-18 17:02:30,599] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-cjkwb_594d3fd33f864c34aaabbb987cd79e65' quit. Currently 3 clients connected.\r\n[2019-11-18 17:02:30,599] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-d2kg5_d5ee1c3c3dcb4762b87872edcdcb0e28' quit. Currently 2 clients connected.\r\n[2019-11-18 17:02:30,604] locust-opa-master-787476b668-74txj/INFO/locust.runners: Client 'locust-opa-slave-86cf6df9fb-d95g2_a3a40cf055d749ea8b6c0e3246f22faa' quit. Currently 1 clients connected.\r\n```\r\n\r\nThe response from `/stats/requests` endpoint looks like this for very long time:\r\n\r\n\r\n```json\r\n{\r\n  \"current_response_time_percentile_50\": null, \r\n  \"current_response_time_percentile_95\": null, \r\n  \"errors\": [], \r\n  \"fail_ratio\": 0.0, \r\n  \"slaves\": [\r\n    {\r\n      \"id\": \"locust-opa-slave-86cf6df9fb-zckdc_b42adb57f2d34ef885b0bcc228068102\", \r\n      \"state\": \"missing\", \r\n      \"user_count\": 0\r\n    }, \r\n    {\r\n      \"id\": \"locust-opa-slave-86cf6df9fb-z2g29_7772633197e6471b9344951aba939c39\", \r\n      \"state\": \"missing\", \r\n      \"user_count\": 0\r\n    }, \r\n    {\r\n      \"id\": \"locust-opa-slave-86cf6df9fb-qr4tf_8ff013c045e7445494154d52f3a5dda7\", \r\n      \"state\": \"ready\", \r\n      \"user_count\": 0\r\n    }\r\n  ], \r\n  \"state\": \"ready\", \r\n...\r\n```\r\n\r\nI think the master is not removing the `missing` slaves?", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1158/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1158/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1157", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1157/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1157/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1157/events", "html_url": "https://github.com/locustio/locust/issues/1157", "id": 524422504, "node_id": "MDU6SXNzdWU1MjQ0MjI1MDQ=", "number": 1157, "title": "Response Times graph broken (drops to 0 after a while)", "user": {"login": "skivis", "id": 2919796, "node_id": "MDQ6VXNlcjI5MTk3OTY=", "avatar_url": "https://avatars.githubusercontent.com/u/2919796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/skivis", "html_url": "https://github.com/skivis", "followers_url": "https://api.github.com/users/skivis/followers", "following_url": "https://api.github.com/users/skivis/following{/other_user}", "gists_url": "https://api.github.com/users/skivis/gists{/gist_id}", "starred_url": "https://api.github.com/users/skivis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/skivis/subscriptions", "organizations_url": "https://api.github.com/users/skivis/orgs", "repos_url": "https://api.github.com/users/skivis/repos", "events_url": "https://api.github.com/users/skivis/events{/privacy}", "received_events_url": "https://api.github.com/users/skivis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-11-18T15:00:38Z", "updated_at": "2020-01-17T10:37:53Z", "closed_at": "2019-11-18T16:37:57Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Describe the bug\r\nSomething has broken in regards to the reporting (specifically the Response Times graph) in the web UI in distributed mode (with docker). Whenever I start a new test run with locust `0.13.1` the graph updates just fine for the first 10-20 seconds and the drops to 0 and doesn't recover from this weird behavior... The statistics tab updates just fine and is not affected but the graph just breaks for some reason.\r\n\r\n<img width=\"1440\" alt=\"ResponseTimesGraph\" src=\"https://user-images.githubusercontent.com/2919796/69062669-90536280-0a1b-11ea-9d6d-1b70588a96f4.png\">\r\n\r\nI haven't done much investigation at all into why this is happening since I'm at work atm but I'm putting this out there because maybe someone has an idea of what could be causing this. Lots of activity in the past week, maybe someone has an aha moment.\r\n\r\n### Expected behavior\r\nThe graph should update as usual\r\n\r\n\r\n### Actual behavior\r\nGraph drops to zero, haven't checked to response from the polls but I suspect something funny is going on there\r\n\r\n### Steps to reproduce\r\n```\r\n$ git clone https://github.com/locustio/locust.git\r\n$ cd locust/examples/docker-compose\r\n$ docker-compose up\r\n```\r\n\r\nOpen up localhost:8089 and run 20 users ramping up 1/sec. Defect should show itself within 10-20 seconds.\r\n\r\n### Environment settings\r\n\r\n- OS: Mac & Windows & Docker\r\n- Python version: 3.7\r\n- Locust version: 0.13.1\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1157/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1157/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1154", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1154/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1154/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1154/events", "html_url": "https://github.com/locustio/locust/issues/1154", "id": 523766797, "node_id": "MDU6SXNzdWU1MjM3NjY3OTc=", "number": 1154, "title": "Web UI doesn't start on Python 3.8.0", "user": {"login": "heyman", "id": 54217, "node_id": "MDQ6VXNlcjU0MjE3", "avatar_url": "https://avatars.githubusercontent.com/u/54217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/heyman", "html_url": "https://github.com/heyman", "followers_url": "https://api.github.com/users/heyman/followers", "following_url": "https://api.github.com/users/heyman/following{/other_user}", "gists_url": "https://api.github.com/users/heyman/gists{/gist_id}", "starred_url": "https://api.github.com/users/heyman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/heyman/subscriptions", "organizations_url": "https://api.github.com/users/heyman/orgs", "repos_url": "https://api.github.com/users/heyman/repos", "events_url": "https://api.github.com/users/heyman/events{/privacy}", "received_events_url": "https://api.github.com/users/heyman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-11-16T01:14:50Z", "updated_at": "2019-11-16T01:17:02Z", "closed_at": "2019-11-16T01:17:02Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Describe the bug\r\nLocust crashes with an exception when trying to start the Web UI on Python 3.8.0. \r\n\r\nThis is caused by a bug in Gevent which has been fixed in the latest pre-release version:\r\nhttps://github.com/gevent/gevent/pull/1429\r\n\r\n### Environment settings\r\n\r\n- Python version: 3.8.0\r\n- Locust version: 0.13.0 (and probably earlier versions as well)\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1154/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1154/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1153", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1153/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1153/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1153/events", "html_url": "https://github.com/locustio/locust/issues/1153", "id": 523727576, "node_id": "MDU6SXNzdWU1MjM3Mjc1NzY=", "number": 1153, "title": "UI shows STOPPED when it is running", "user": {"login": "rvernica", "id": 241185, "node_id": "MDQ6VXNlcjI0MTE4NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/241185?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rvernica", "html_url": "https://github.com/rvernica", "followers_url": "https://api.github.com/users/rvernica/followers", "following_url": "https://api.github.com/users/rvernica/following{/other_user}", "gists_url": "https://api.github.com/users/rvernica/gists{/gist_id}", "starred_url": "https://api.github.com/users/rvernica/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rvernica/subscriptions", "organizations_url": "https://api.github.com/users/rvernica/orgs", "repos_url": "https://api.github.com/users/rvernica/repos", "events_url": "https://api.github.com/users/rvernica/events{/privacy}", "received_events_url": "https://api.github.com/users/rvernica/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1003994742, "node_id": "MDU6TGFiZWwxMDAzOTk0NzQy", "url": "https://api.github.com/repos/locustio/locust/labels/waiting%20on%20contributor", "name": "waiting on contributor", "color": "5319e7", "default": false, "description": ""}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-11-15T22:43:37Z", "updated_at": "2020-01-19T20:37:43Z", "closed_at": "2020-01-19T20:37:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Describe the bug\r\n\r\nAfter starting a _New test_ the UI still shows that Locust is STOPPED, but Locust is running fine. See screenshot:\r\n![Locust-stopped](https://user-images.githubusercontent.com/241185/68980583-b5469c00-07b5-11ea-9640-ff4fac805294.png)\r\n\r\n### Steps to reproduce\r\n\r\nI've run into this bug a couple of times already but I am not able to construct a sequence of steps to reproduce it every time. It seem to be related to the fact that I stop a test and then I start a new one.\r\n\r\n### Environment settings\r\n\r\n- OS: CentOS Atomic 8 1905\r\n- Python version: python:3.7.5-slim-buster (Docker image)\r\n- Locust version: 0.12.2\r\n- UI OS: Fedora 30\r\n- UI Browser: Firefox 70.0\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1153/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1153/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1152", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1152/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1152/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1152/events", "html_url": "https://github.com/locustio/locust/issues/1152", "id": 523604715, "node_id": "MDU6SXNzdWU1MjM2MDQ3MTU=", "number": 1152, "title": "When locust exits the current RPS is outputted instead of the total RPS", "user": {"login": "heyman", "id": 54217, "node_id": "MDQ6VXNlcjU0MjE3", "avatar_url": "https://avatars.githubusercontent.com/u/54217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/heyman", "html_url": "https://github.com/heyman", "followers_url": "https://api.github.com/users/heyman/followers", "following_url": "https://api.github.com/users/heyman/following{/other_user}", "gists_url": "https://api.github.com/users/heyman/gists{/gist_id}", "starred_url": "https://api.github.com/users/heyman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/heyman/subscriptions", "organizations_url": "https://api.github.com/users/heyman/orgs", "repos_url": "https://api.github.com/users/heyman/repos", "events_url": "https://api.github.com/users/heyman/events{/privacy}", "received_events_url": "https://api.github.com/users/heyman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-11-15T17:46:42Z", "updated_at": "2019-11-15T17:50:33Z", "closed_at": "2019-11-15T17:50:33Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "When locust exits the current request/s (an average for the last 10 seconds) and failures/s is outputted instead of the *total* requests/s for the whole test run (or since the last stats reset). It makes more sense to output the total stats.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1152/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1152/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1151", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1151/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1151/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1151/events", "html_url": "https://github.com/locustio/locust/issues/1151", "id": 523541889, "node_id": "MDU6SXNzdWU1MjM1NDE4ODk=", "number": 1151, "title": "Missing headline columns in response time percentile stats printed to console", "user": {"login": "heyman", "id": 54217, "node_id": "MDQ6VXNlcjU0MjE3", "avatar_url": "https://avatars.githubusercontent.com/u/54217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/heyman", "html_url": "https://github.com/heyman", "followers_url": "https://api.github.com/users/heyman/followers", "following_url": "https://api.github.com/users/heyman/following{/other_user}", "gists_url": "https://api.github.com/users/heyman/gists{/gist_id}", "starred_url": "https://api.github.com/users/heyman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/heyman/subscriptions", "organizations_url": "https://api.github.com/users/heyman/orgs", "repos_url": "https://api.github.com/users/heyman/repos", "events_url": "https://api.github.com/users/heyman/events{/privacy}", "received_events_url": "https://api.github.com/users/heyman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-11-15T15:41:31Z", "updated_at": "2019-11-15T15:41:47Z", "closed_at": "2019-11-15T15:41:47Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Two columns are missing:\r\n\r\n```\r\nPercentage of the requests completed within given times\r\n Name                                                           # reqs    50%    66%    75%    80%    90%    95%    98%    99%   100%\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n GET /                                                           15919      8     10     11     13     18     25     35     44     68     84     86\r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n Aggregated                                                      15919      8     10     11     13     18     25     35     44     68     84     86\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1151/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1151/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1143", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1143/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1143/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1143/events", "html_url": "https://github.com/locustio/locust/issues/1143", "id": 522005422, "node_id": "MDU6SXNzdWU1MjIwMDU0MjI=", "number": 1143, "title": "autoscaling slaves resets users", "user": {"login": "matti", "id": 3893, "node_id": "MDQ6VXNlcjM4OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/3893?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matti", "html_url": "https://github.com/matti", "followers_url": "https://api.github.com/users/matti/followers", "following_url": "https://api.github.com/users/matti/following{/other_user}", "gists_url": "https://api.github.com/users/matti/gists{/gist_id}", "starred_url": "https://api.github.com/users/matti/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matti/subscriptions", "organizations_url": "https://api.github.com/users/matti/orgs", "repos_url": "https://api.github.com/users/matti/repos", "events_url": "https://api.github.com/users/matti/events{/privacy}", "received_events_url": "https://api.github.com/users/matti/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-11-13T07:12:33Z", "updated_at": "2019-11-20T16:55:09Z", "closed_at": "2019-11-13T11:20:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "autoscaling works great, but when a new slave is added, it slows down the RPS curve, because slaves are reset - wouldn't it be better if the slaves would not go all the day down to 0?\r\n\r\n<img width=\"1377\" alt=\"Locust\" src=\"https://user-images.githubusercontent.com/3893/68741171-9c8f8800-05f5-11ea-8ba9-5095b2696d99.png\">\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1143/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1143/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1138", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1138/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1138/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1138/events", "html_url": "https://github.com/locustio/locust/issues/1138", "id": 521029511, "node_id": "MDU6SXNzdWU1MjEwMjk1MTE=", "number": 1138, "title": "Repeated secure requests with FastHttpLocust crashes in cookie management", "user": {"login": "cyberw", "id": 1134328, "node_id": "MDQ6VXNlcjExMzQzMjg=", "avatar_url": "https://avatars.githubusercontent.com/u/1134328?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cyberw", "html_url": "https://github.com/cyberw", "followers_url": "https://api.github.com/users/cyberw/followers", "following_url": "https://api.github.com/users/cyberw/following{/other_user}", "gists_url": "https://api.github.com/users/cyberw/gists{/gist_id}", "starred_url": "https://api.github.com/users/cyberw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cyberw/subscriptions", "organizations_url": "https://api.github.com/users/cyberw/orgs", "repos_url": "https://api.github.com/users/cyberw/repos", "events_url": "https://api.github.com/users/cyberw/events{/privacy}", "received_events_url": "https://api.github.com/users/cyberw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-11-11T15:30:31Z", "updated_at": "2019-11-11T18:41:59Z", "closed_at": "2019-11-11T18:41:59Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "```\r\nfrom locust.contrib.fasthttp import FastHttpLocust\r\nfrom locust import task, TaskSet\r\n\r\n\r\nclass UserBehavior(TaskSet):\r\n    @task\r\n    def get_results(self):\r\n        print(\"about to run\")\r\n        self.client.get(\"/\")\r\n\r\n\r\nclass WebsiteUser(FastHttpLocust):\r\n    task_set = UserBehavior\r\n    min_wait = 0\r\n    max_wait = 0\r\n    _catch_exceptions = False\r\n    host = \"https://www.mysite.com\"\r\n\r\nif __name__ == \"__main__\":\r\n    WebsiteUser().run()\r\n```\r\n\r\n```\r\n~ python3 simple.py\r\nabout to run\r\nabout to run\r\nTraceback (most recent call last):\r\n  File \"./simple.py\", line 24, in <module>\r\n    WebsiteUser().run()\r\n  File \"/Users/lafp/git/locust/locust/core.py\", line 158, in run\r\n    task_set_instance.run()\r\n  File \"/Users/lafp/git/locust/locust/core.py\", line 367, in run\r\n    self.execute_next_task()\r\n  File \"/Users/lafp/git/locust/locust/core.py\", line 397, in execute_next_task\r\n    self.execute_task(task[\"callable\"], *task[\"args\"], **task[\"kwargs\"])\r\n  File \"/Users/lafp/git/locust/locust/core.py\", line 409, in execute_task\r\n    task(self, *args, **kwargs)\r\n  File \"./simple.py\", line 10, in get_results\r\n    self.client.get(\"/\")\r\n  File \"/Users/lafp/git/locust/locust/contrib/fasthttp.py\", line 210, in get\r\n    return self.request(\"GET\", path, **kwargs)\r\n  File \"/Users/lafp/git/locust/locust/contrib/fasthttp.py\", line 169, in request\r\n    response = self._send_request_safe_mode(method, url, payload=data, headers=headers, **kwargs)\r\n  File \"/Users/lafp/git/locust/locust/contrib/fasthttp.py\", line 116, in _send_request_safe_mode\r\n    return self.client.urlopen(url, method=method, **kwargs)\r\n  File \"/usr/local/lib/python3.7/site-packages/geventhttpclient/useragent.py\", line 340, in urlopen\r\n    self.cookiejar.add_cookie_header(req)\r\n  File \"/usr/local/Cellar/python/3.7.5/Frameworks/Python.framework/Versions/3.7/lib/python3.7/http/cookiejar.py\", line 1356, in add_cookie_header\r\n    cookies = self._cookies_for_request(request)\r\n  File \"/usr/local/Cellar/python/3.7.5/Frameworks/Python.framework/Versions/3.7/lib/python3.7/http/cookiejar.py\", line 1282, in _cookies_for_request\r\n    cookies.extend(self._cookies_for_domain(domain, request))\r\n  File \"/usr/local/Cellar/python/3.7.5/Frameworks/Python.framework/Versions/3.7/lib/python3.7/http/cookiejar.py\", line 1271, in _cookies_for_domain\r\n    if not self._policy.return_ok(cookie, request):\r\n  File \"/usr/local/Cellar/python/3.7.5/Frameworks/Python.framework/Versions/3.7/lib/python3.7/http/cookiejar.py\", line 1093, in return_ok\r\n    if not fn(cookie, request):\r\n  File \"/usr/local/Cellar/python/3.7.5/Frameworks/Python.framework/Versions/3.7/lib/python3.7/http/cookiejar.py\", line 1119, in return_ok_secure\r\n    if cookie.secure and request.type != \"https\":\r\nAttributeError: 'CompatRequest' object has no attribute 'type'\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1138/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1138/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1137", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1137/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1137/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1137/events", "html_url": "https://github.com/locustio/locust/issues/1137", "id": 520966024, "node_id": "MDU6SXNzdWU1MjA5NjYwMjQ=", "number": 1137, "title": "FastHttpLocust gives ssl error with let's encrypt certs", "user": {"login": "matti", "id": 3893, "node_id": "MDQ6VXNlcjM4OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/3893?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matti", "html_url": "https://github.com/matti", "followers_url": "https://api.github.com/users/matti/followers", "following_url": "https://api.github.com/users/matti/following{/other_user}", "gists_url": "https://api.github.com/users/matti/gists{/gist_id}", "starred_url": "https://api.github.com/users/matti/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matti/subscriptions", "organizations_url": "https://api.github.com/users/matti/orgs", "repos_url": "https://api.github.com/users/matti/repos", "events_url": "https://api.github.com/users/matti/events{/privacy}", "received_events_url": "https://api.github.com/users/matti/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2019-11-11T13:32:56Z", "updated_at": "2019-11-14T20:36:46Z", "closed_at": "2019-11-13T16:49:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\nSSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1076)')\r\n```\r\n\r\ndomains which have regular cert work okay. also the normal http client works okay.\r\n\r\nos: alpine linux (with `apk add ca-certificates`)\r\npython: 3.7\r\nlocust master branch\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1137/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1137/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1131", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1131/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1131/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1131/events", "html_url": "https://github.com/locustio/locust/issues/1131", "id": 518551552, "node_id": "MDU6SXNzdWU1MTg1NTE1NTI=", "number": 1131, "title": "Cannot install locust into conda env with python 3.8.0", "user": {"login": "ecc256", "id": 15874603, "node_id": "MDQ6VXNlcjE1ODc0NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/15874603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecc256", "html_url": "https://github.com/ecc256", "followers_url": "https://api.github.com/users/ecc256/followers", "following_url": "https://api.github.com/users/ecc256/following{/other_user}", "gists_url": "https://api.github.com/users/ecc256/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecc256/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecc256/subscriptions", "organizations_url": "https://api.github.com/users/ecc256/orgs", "repos_url": "https://api.github.com/users/ecc256/repos", "events_url": "https://api.github.com/users/ecc256/events{/privacy}", "received_events_url": "https://api.github.com/users/ecc256/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-11-06T15:37:29Z", "updated_at": "2019-11-08T18:52:27Z", "closed_at": "2019-11-07T13:36:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\nCannot install locust into conda env with python 3.8.0\r\n\r\n\r\n### Steps to reproduce\r\n```\r\nconda create --name locust8 -y\r\nconda activate locust8\r\nconda install pip\r\npip install locust\r\n\r\n```\r\nError log:\r\n```\r\n(locust8) C:\\>conda list\r\n# packages in environment at C:\\Users\\user\\.conda\\envs\\locust8:\r\n#\r\n# Name                    Version                   Build  Channel\r\nca-certificates           2019.10.16                    0\r\ncertifi                   2019.9.11                py38_0\r\nopenssl                   1.1.1d               he774522_3\r\npip                       19.3.1                   py38_0\r\npython                    3.8.0                hff0d562_1\r\nsetuptools                41.6.0                   py38_0\r\nsqlite                    3.30.1               he774522_0\r\nvc                        14.1                 h0510ff6_4\r\nvs2015_runtime            14.16.27012          hf0eaf9b_0\r\nwheel                     0.33.6                   py38_0\r\nwincertstore              0.2                      py38_0\r\n\r\n\r\n(locust8) C:\\>pip install locust\r\nCollecting locust\r\n  Using cached https://files.pythonhosted.org/packages/46/2e/18d4e363e76ec8f407ed018594f474d5669b3bca3977c4c664940fff95d5/locust-0.0.tar.gz\r\nCollecting locustio\r\n  Using cached https://files.pythonhosted.org/packages/56/a6/b63507b1366b2adcad807e154df3d18a4fb00eb0670c5cbcc086f8f235c9/locustio-0.12.2-py2.py3-none-any.whl\r\nCollecting geventhttpclient-wheels==1.3.1.dev2\r\n  Downloading https://files.pythonhosted.org/packages/bc/7f/42f8b4ac6c7ddf606fa69769cef2229a159d4af45a294053198f52586095/geventhttpclient-wheels-1.3.1.dev2.tar.gz (54kB)\r\n     |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 61kB ...\r\nCollecting gevent>=1.2.2\r\n  Using cached https://files.pythonhosted.org/packages/ed/27/6c49b70808f569b66ec7fac2e78f076e9b204db9cf5768740cff3d5a07ae/gevent-1.4.0.tar.gz\r\n    ERROR: Command errored out with exit status 1:\r\n     command: 'C:\\Users\\user\\.conda\\envs\\locust8\\python.exe' -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'C:\\\\Users\\\\user\\\\AppData\\\\Local\\\\Temp\\\\2\\\\pip-install-1y2lm8yx\\\\gevent\\\\setup.py'\"'\"'; __file__='\"'\"'C:\\\\Users\\\\user\\\\AppData\\\\Local\\\\Temp\\\\2\\\\pip-install-1y2lm8yx\\\\gevent\\\\setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' egg_info --egg-base 'C:\\Users\\user\\AppData\\Local\\Temp\\2\\pip-install-1y2lm8yx\\gevent\\pip-egg-info'\r\n         cwd: C:\\Users\\user\\AppData\\Local\\Temp\\2\\pip-install-1y2lm8yx\\gevent\\\r\n    Complete output (112 lines):\r\n    Traceback (most recent call last):\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\sandbox.py\", line 154, in save_modules\r\n        yield saved\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\sandbox.py\", line 195, in setup_context\r\n        yield\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\sandbox.py\", line 250, in run_setup\r\n        _execfile(setup_script, ns)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\sandbox.py\", line 45, in _execfile\r\n        exec(code, globals, locals)\r\n      File \"C:\\Users\\user\\AppData\\Local\\Temp\\2\\easy_install-cnm3v8gt\\cffi-1.13.2\\setup.py\", line 127, in <module>\r\n        HUB_PRIMITIVES = Extension(name=\"gevent.__hub_primitives\",\r\n      File \"C:\\Users\\user\\AppData\\Local\\Temp\\2\\easy_install-cnm3v8gt\\cffi-1.13.2\\setup.py\", line 105, in uses_msvc\r\n        include_dirs=include_dirs)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\distutils\\command\\config.py\", line 225, in try_compile\r\n        self._compile(body, headers, include_dirs, lang)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\distutils\\command\\config.py\", line 127, in _compile\r\n        src = self._gen_temp_sourcefile(body, headers, lang)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\distutils\\command\\config.py\", line 109, in _gen_temp_sourcefile\r\n        with open(filename, \"w\") as file:\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\sandbox.py\", line 418, in _open\r\n        self._violation(\"open\", path, mode, *args, **kw)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\sandbox.py\", line 407, in _violation\r\n        raise SandboxViolation(operation, args, kw)\r\n    setuptools.sandbox.SandboxViolation: SandboxViolation: open('_configtest.c', 'w') {}\r\n\r\n    The package setup script has attempted to modify files on your system\r\n    that are not within the EasyInstall build area, and has been aborted.\r\n\r\n    This package cannot be safely installed by EasyInstall, and may not\r\n    support alternate installation locations even if you run its setup\r\n    script by hand.  Please inform the package's author and the EasyInstall\r\n    maintainers to find out if a fix or workaround is available.\r\n\r\n\r\n    During handling of the above exception, another exception occurred:\r\n\r\n    Traceback (most recent call last):\r\n      File \"<string>\", line 1, in <module>\r\n      File \"C:\\Users\\user\\AppData\\Local\\Temp\\2\\pip-install-1y2lm8yx\\gevent\\setup.py\", line 427, in <module>\r\n        run_setup(EXT_MODULES, run_make=_BUILDING)\r\n      File \"C:\\Users\\user\\AppData\\Local\\Temp\\2\\pip-install-1y2lm8yx\\gevent\\setup.py\", line 328, in run_setup\r\n        setup(\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\__init__.py\", line 144, in setup\r\n        _install_setup_requires(attrs)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\__init__.py\", line 139, in _install_setup_requires\r\n        dist.fetch_build_eggs(dist.setup_requires)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\dist.py\", line 717, in fetch_build_eggs\r\n        resolved_dists = pkg_resources.working_set.resolve(\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\pkg_resources\\__init__.py\", line 780, in resolve\r\n        dist = best[req.key] = env.best_match(\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\pkg_resources\\__init__.py\", line 1065, in best_match\r\n        return self.obtain(req, installer)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\pkg_resources\\__init__.py\", line 1077, in obtain\r\n        return installer(requirement)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\dist.py\", line 787, in fetch_build_egg\r\n        return cmd.easy_install(req)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\command\\easy_install.py\", line 679, in easy_install\r\n        return self.install_item(spec, dist.location, tmpdir, deps)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\command\\easy_install.py\", line 705, in install_item\r\n        dists = self.install_eggs(spec, download, tmpdir)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\command\\easy_install.py\", line 890, in install_eggs\r\n        return self.build_and_install(setup_script, setup_base)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\command\\easy_install.py\", line 1158, in build_and_install\r\n        self.run_setup(setup_script, setup_base, args)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\command\\easy_install.py\", line 1144, in run_setup\r\n        run_setup(setup_script, args)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\sandbox.py\", line 253, in run_setup\r\n        raise\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\contextlib.py\", line 131, in __exit__\r\n        self.gen.throw(type, value, traceback)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\sandbox.py\", line 195, in setup_context\r\n        yield\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\contextlib.py\", line 131, in __exit__\r\n        self.gen.throw(type, value, traceback)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\sandbox.py\", line 166, in save_modules\r\n        saved_exc.resume()\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\sandbox.py\", line 141, in resume\r\n        six.reraise(type, exc, self._tb)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\_vendor\\six.py\", line 685, in reraise\r\n        raise value.with_traceback(tb)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\sandbox.py\", line 154, in save_modules\r\n        yield saved\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\sandbox.py\", line 195, in setup_context\r\n        yield\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\sandbox.py\", line 250, in run_setup\r\n        _execfile(setup_script, ns)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\sandbox.py\", line 45, in _execfile\r\n        exec(code, globals, locals)\r\n      File \"C:\\Users\\user\\AppData\\Local\\Temp\\2\\easy_install-cnm3v8gt\\cffi-1.13.2\\setup.py\", line 127, in <module>\r\n        HUB_PRIMITIVES = Extension(name=\"gevent.__hub_primitives\",\r\n      File \"C:\\Users\\user\\AppData\\Local\\Temp\\2\\easy_install-cnm3v8gt\\cffi-1.13.2\\setup.py\", line 105, in uses_msvc\r\n        include_dirs=include_dirs)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\distutils\\command\\config.py\", line 225, in try_compile\r\n        self._compile(body, headers, include_dirs, lang)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\distutils\\command\\config.py\", line 127, in _compile\r\n        src = self._gen_temp_sourcefile(body, headers, lang)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\distutils\\command\\config.py\", line 109, in _gen_temp_sourcefile\r\n        with open(filename, \"w\") as file:\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\sandbox.py\", line 418, in _open\r\n        self._violation(\"open\", path, mode, *args, **kw)\r\n      File \"C:\\Users\\user\\.conda\\envs\\locust8\\lib\\site-packages\\setuptools\\sandbox.py\", line 407, in _violation\r\n        raise SandboxViolation(operation, args, kw)\r\n    setuptools.sandbox.SandboxViolation: SandboxViolation: open('_configtest.c', 'w') {}\r\n\r\n    The package setup script has attempted to modify files on your system\r\n    that are not within the EasyInstall build area, and has been aborted.\r\n\r\n    This package cannot be safely installed by EasyInstall, and may not\r\n    support alternate installation locations even if you run its setup\r\n    script by hand.  Please inform the package's author and the EasyInstall\r\n    maintainers to find out if a fix or workaround is available.\r\n\r\n    ----------------------------------------\r\nERROR: Command errored out with exit status 1: python setup.py egg_info Check the logs for full command output.\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1131/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1131/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1122", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1122/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1122/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1122/events", "html_url": "https://github.com/locustio/locust/issues/1122", "id": 511941264, "node_id": "MDU6SXNzdWU1MTE5NDEyNjQ=", "number": 1122, "title": "Basic authentication ", "user": {"login": "rahmounimed", "id": 56963397, "node_id": "MDQ6VXNlcjU2OTYzMzk3", "avatar_url": "https://avatars.githubusercontent.com/u/56963397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rahmounimed", "html_url": "https://github.com/rahmounimed", "followers_url": "https://api.github.com/users/rahmounimed/followers", "following_url": "https://api.github.com/users/rahmounimed/following{/other_user}", "gists_url": "https://api.github.com/users/rahmounimed/gists{/gist_id}", "starred_url": "https://api.github.com/users/rahmounimed/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rahmounimed/subscriptions", "organizations_url": "https://api.github.com/users/rahmounimed/orgs", "repos_url": "https://api.github.com/users/rahmounimed/repos", "events_url": "https://api.github.com/users/rahmounimed/events{/privacy}", "received_events_url": "https://api.github.com/users/rahmounimed/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 538798664, "node_id": "MDU6TGFiZWw1Mzg3OTg2NjQ=", "url": "https://api.github.com/repos/locustio/locust/labels/needs%20reproducing", "name": "needs reproducing", "color": "f9d0c4", "default": false, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-10-24T13:21:42Z", "updated_at": "2019-11-18T09:33:55Z", "closed_at": "2019-11-18T09:33:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please note: For general questions about how to use Locust, use either the Slack link provided in the Readme or [ask a question on Stack Overflow](https://stackoverflow.com/questions/ask) tagged Locust.-->\r\n\r\n### Describe the bug\r\n<!-- A clear and concise description of what the bug is -->\r\nHi guys! Tried to find the answer for my question among the other issues but couldn't find. I have basic auth in my web application. Could someone send me the example of locustfile.py, how to correctly perform the auth in this case because i have an error all the time ?\r\n![Capture](https://user-images.githubusercontent.com/56963397/67488984-0c52c880-f671-11e9-99f4-2caf4b51f112.PNG)\r\nTried the following many code in internet  but it doesn't work.  I'm getting this error \r\n```\r\n[2019-10-24 13:15:52,414] ubuntu/INFO/locust.main: Starting web monitor at *:8089\r\n[2019-10-24 13:15:52,414] ubuntu/INFO/locust.main: Starting Locust 0.12.1\r\n[2019-10-24 13:15:56,312] ubuntu/INFO/locust.runners: Hatching and swarming 10 clients at the rate 1 clients/s...\r\n[2019-10-24 13:15:56,388] ubuntu/ERROR/stderr: Traceback (most recent call last):\r\n[2019-10-24 13:15:56,388] ubuntu/ERROR/stderr: File \"src/gevent/greenlet.py\", line 766, in gevent._greenlet.Greenlet.run\r\n[2019-10-24 13:15:56,388] ubuntu/ERROR/stderr: File \"/opt/odoo10/venv-odoo10/local/lib/python2.7/site-packages/locust/runners.py\", line 114, in start_locust\r\n[2019-10-24 13:15:56,388] ubuntu/ERROR/stderr: locust().run(runner=self)\r\n[2019-10-24 13:15:56,388] ubuntu/ERROR/stderr: File \"/opt/locust/locust/locustfile.py\", line 29, in __init__\r\n[2019-10-24 13:15:56,388] ubuntu/ERROR/stderr: super(AtoutConnectBehavior, self).__init__(*args, **kwargs)\r\n[2019-10-24 13:15:56,388] ubuntu/ERROR/stderr: File \"/opt/locust/locust/OdooLocust/OdooLocust.py\", line 72, in __init__\r\n[2019-10-24 13:15:56,388] ubuntu/ERROR/stderr: self._connect()\r\n[2019-10-24 13:15:56,389] ubuntu/ERROR/stderr: File \"/opt/locust/locust/OdooLocust/OdooLocust.py\", line 82, in _connect\r\n[2019-10-24 13:15:56,389] ubuntu/ERROR/stderr: self.rpc.check_login()\r\n[2019-10-24 13:15:56,389] ubuntu/ERROR/stderr: File \"/opt/odoo10/venv-odoo10/local/lib/python2.7/site-packages/openerplib/main.py\", line 243, in check_login\r\n[2019-10-24 13:15:56,389] ubuntu/ERROR/stderr: self.user_id = self.get_service(\"common\").login(self.database, self.login, self.password)\r\n[2019-10-24 13:15:56,389] ubuntu/ERROR/stderr: File \"/opt/odoo10/venv-odoo10/local/lib/python2.7/site-packages/openerplib/main.py\", line 180, in proxy\r\n[2019-10-24 13:15:56,389] ubuntu/ERROR/stderr: result = self.connector.send(self.service_name, method, *args)\r\n[2019-10-24 13:15:56,389] ubuntu/ERROR/stderr: File \"/opt/locust/locust/OdooLocust/OdooLocust.py\", line 51, in send\r\n[2019-10-24 13:15:56,389] ubuntu/ERROR/stderr: raise e\r\n[2019-10-24 13:15:56,389] ubuntu/ERROR/stderr: URLError: <urlopen error [Errno 111] Connection refused>\r\n[2019-10-24 13:15:56,389] ubuntu/ERROR/stderr: 2019-10-24T13:15:56Z\r\n```\r\n\r\n\r\nError report\r\n```\r\n # occurrences      Error                                                                                               \r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n 3                  Odoo JsonRPC common : login: \"URLError(error(111, 'Connection refused'),)\"                          \r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n```\r\n\r\nMy Code\r\n```\r\ndef base_auth(self):\r\n    self.client.request(method=\"GET\", url=\"/\", auth=HTTPDigestAuth(\"admin\", \"admin\"))\r\n```\r\n\r\non start i call base_auth(self)\r\n\r\n### Environment settings\r\n\r\n- OS: ubuntu 18.04\r\n- Python version: 3.6\r\n- Locust version:\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1122/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1122/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1117", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1117/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1117/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1117/events", "html_url": "https://github.com/locustio/locust/issues/1117", "id": 510540016, "node_id": "MDU6SXNzdWU1MTA1NDAwMTY=", "number": 1117, "title": "stop_timeout defined in Locust class takes precedence over --run-time option", "user": {"login": "kowalcj0", "id": 910451, "node_id": "MDQ6VXNlcjkxMDQ1MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/910451?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kowalcj0", "html_url": "https://github.com/kowalcj0", "followers_url": "https://api.github.com/users/kowalcj0/followers", "following_url": "https://api.github.com/users/kowalcj0/following{/other_user}", "gists_url": "https://api.github.com/users/kowalcj0/gists{/gist_id}", "starred_url": "https://api.github.com/users/kowalcj0/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kowalcj0/subscriptions", "organizations_url": "https://api.github.com/users/kowalcj0/orgs", "repos_url": "https://api.github.com/users/kowalcj0/repos", "events_url": "https://api.github.com/users/kowalcj0/events{/privacy}", "received_events_url": "https://api.github.com/users/kowalcj0/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-10-22T09:39:33Z", "updated_at": "2019-10-30T10:59:30Z", "closed_at": "2019-10-30T10:59:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n`stop_timeout` defined in Locust class takes precedence over `--run-time` option.\r\n\r\n### Expected behavior\r\nTo my mind `--run-time` should take precedence over `stop_timeout`.\r\n\r\n### Actual behavior\r\nditto\r\n\r\n### Steps to reproduce\r\n<!-- Please provide a minimal reproducible code example (https://stackoverflow.com/help/minimal-reproducible-example). Or even better - a pull request with a failing unit test --> \r\n\r\nCreate a simple Locust class with `stop_timeout` defined:\r\n\r\n`locustfile.py`:\r\n```python\r\nfrom locust import HttpLocust, TaskSet, task\r\n\r\nclass SUTTasks(TaskSet):\r\n\r\n    @task\r\n    def landing_page(self):\r\n        self.client.get(\"/\")\r\n\r\nclass SUT(HttpLocust):\r\n    stop_timeout = 10\r\n    task_set = SUTTasks\r\n    host = \"https://www.google.com/\"\r\n```\r\nRun the test with `--run-time` longer than `stop_timeout`, e.g. `20s`:\r\n`locust --only-summary --no-web --run-time=20s`\r\nThen the test will stop after `10s` not after `20s` as defined by `--run-time`:\r\nCheck the timestamps in the log below:\r\n```\r\n[2019-10-22 10:31:32,645] local/INFO/locust.runners: All locusts hatched: SUT: 1\r\n[2019-10-22 10:31:42,570] local/INFO/locust.runners: All locusts dead\r\n[2019-10-22 10:31:42,571] local/INFO/locust.main: Shutting down (exit code 0), bye\r\n```\r\n\r\n### Environment settings\r\n\r\n- OS: Linux 5.3.6\r\n- Python version: 3.7.4\r\n- Locust version: 0.11.0\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1117/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1117/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1116", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1116/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1116/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1116/events", "html_url": "https://github.com/locustio/locust/issues/1116", "id": 510416440, "node_id": "MDU6SXNzdWU1MTA0MTY0NDA=", "number": 1116, "title": "Installing 0.12.1 requires \"pipenv lock --pre\"", "user": {"login": "schinckel", "id": 23411, "node_id": "MDQ6VXNlcjIzNDEx", "avatar_url": "https://avatars.githubusercontent.com/u/23411?v=4", "gravatar_id": "", "url": "https://api.github.com/users/schinckel", "html_url": "https://github.com/schinckel", "followers_url": "https://api.github.com/users/schinckel/followers", "following_url": "https://api.github.com/users/schinckel/following{/other_user}", "gists_url": "https://api.github.com/users/schinckel/gists{/gist_id}", "starred_url": "https://api.github.com/users/schinckel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/schinckel/subscriptions", "organizations_url": "https://api.github.com/users/schinckel/orgs", "repos_url": "https://api.github.com/users/schinckel/repos", "events_url": "https://api.github.com/users/schinckel/events{/privacy}", "received_events_url": "https://api.github.com/users/schinckel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 17, "created_at": "2019-10-22T04:03:44Z", "updated_at": "2020-06-06T08:39:45Z", "closed_at": "2020-06-06T08:39:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "The latest release of `locustio` cannot really be managed using pipenv. It includes a dependency of `geventhttpclient-wheels`, which has only pre-release versions available.\r\n\r\nAs such, it is not possible to generate a `Pipfile.lock` file without using `pipenv lock --pre`.\r\n\r\nDoing this will install pre-release versions of other packages, which is problematic. (In my case, it installed a 5.0dev version of coverage, which uses a different coverage file format).", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1116/reactions", "total_count": 4, "+1": 4, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1116/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1081", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1081/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1081/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1081/events", "html_url": "https://github.com/locustio/locust/issues/1081", "id": 489569446, "node_id": "MDU6SXNzdWU0ODk1Njk0NDY=", "number": 1081, "title": "response time has too many decimal places in the web statistics page", "user": {"login": "solxnp", "id": 18416053, "node_id": "MDQ6VXNlcjE4NDE2MDUz", "avatar_url": "https://avatars.githubusercontent.com/u/18416053?v=4", "gravatar_id": "", "url": "https://api.github.com/users/solxnp", "html_url": "https://github.com/solxnp", "followers_url": "https://api.github.com/users/solxnp/followers", "following_url": "https://api.github.com/users/solxnp/following{/other_user}", "gists_url": "https://api.github.com/users/solxnp/gists{/gist_id}", "starred_url": "https://api.github.com/users/solxnp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/solxnp/subscriptions", "organizations_url": "https://api.github.com/users/solxnp/orgs", "repos_url": "https://api.github.com/users/solxnp/repos", "events_url": "https://api.github.com/users/solxnp/events{/privacy}", "received_events_url": "https://api.github.com/users/solxnp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-09-05T07:10:08Z", "updated_at": "2019-09-26T13:22:22Z", "closed_at": "2019-09-26T13:22:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n### Description of issue\r\n\r\nresponse time has too many decimal places in the web statistics page\r\n\r\n### Expected behavior\r\n\r\nTBD\r\n\r\n### Actual behavior\r\n\r\n![image](https://user-images.githubusercontent.com/18416053/64319375-c5404380-cfee-11e9-8aff-b06b7fc635ea.png)\r\n\r\n\r\n### Environment settings\r\n\r\n- OS: centos\r\n- Python version: 3.7.4\r\n- Locust version: 0.11.0\r\n\r\n### Steps to reproduce (for bug reports)\r\n\r\nTBD - [please provide example code](https://stackoverflow.com/help/mcve)\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1081/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1081/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/1023", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/1023/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/1023/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/1023/events", "html_url": "https://github.com/locustio/locust/issues/1023", "id": 451782650, "node_id": "MDU6SXNzdWU0NTE3ODI2NTA=", "number": 1023, "title": "AttributeError: 'module' object has no attribute 'sleep'", "user": {"login": "zhiyong-lv", "id": 19340980, "node_id": "MDQ6VXNlcjE5MzQwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/19340980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zhiyong-lv", "html_url": "https://github.com/zhiyong-lv", "followers_url": "https://api.github.com/users/zhiyong-lv/followers", "following_url": "https://api.github.com/users/zhiyong-lv/following{/other_user}", "gists_url": "https://api.github.com/users/zhiyong-lv/gists{/gist_id}", "starred_url": "https://api.github.com/users/zhiyong-lv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zhiyong-lv/subscriptions", "organizations_url": "https://api.github.com/users/zhiyong-lv/orgs", "repos_url": "https://api.github.com/users/zhiyong-lv/repos", "events_url": "https://api.github.com/users/zhiyong-lv/events{/privacy}", "received_events_url": "https://api.github.com/users/zhiyong-lv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-06-04T03:38:08Z", "updated_at": "2019-10-01T19:28:40Z", "closed_at": "2019-10-01T19:28:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- For general questions about how to use Locust, use either the Slack link provided in the Readme or [ask a question on Stack Overflow](https://stackoverflow.com/questions/ask) tagged Locust.-->\r\n\r\n\r\n### Description of issue\r\n\r\nutil/exception_handler.py file import time modle. However there are a python file in the same folder which name is time.py, that would cause an issue as title.\r\n\r\n### Expected behavior\r\n\r\nDon't print AttributeError: 'module' object has no attribute 'sleep'\r\n\r\n### Actual behavior\r\n\r\nprint \"AttributeError: 'module' object has no attribute 'sleep'\"\r\n\r\n### Environment settings\r\n\r\n- OS: Ubuntu 14.04.5 LTS\r\n- Python version: Python 2.7.6\r\n- Locust version: 0.11.0\r\n\r\n### Steps to reproduce (for bug reports)\r\n\r\n1. In my environment, it seems has the following issue:\r\nhttps://stackoverflow.com/questions/52345387/python-spacy-typeerror-unpackb-got-an-unexpected-keyword-argument-raw\r\nI could fix it by:\r\npip uninstall msgpack-python\r\npip install msgpack\r\n\r\n2. when the issue is still there, run the following command in the same machine:\r\nlocust --slave --master-host=xxxxx -f /home/james/bitstorm/test-script/locustfile.py -H https://xxxxxxx\r\nlocust --master --clients=1 --hatch-rate=1 --expect-slaves=1 --logfile=locustfile.log -f locustfile.py -H https://xxxxxxx\r\n\r\n3. check locustfile.log\r\n\r\nBy the way, if you do code review, you could find that issue either.\r\n\r\nThe following is how to fix it in my own environment, and it's very simple:\r\n1. rename util/time.py to util/time_util.py\r\n2. change the import file name to time_util in the following related python files:\r\n- main.py\r\n- test/test_util.py", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/1023/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/1023/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/991", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/991/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/991/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/991/events", "html_url": "https://github.com/locustio/locust/issues/991", "id": 430037988, "node_id": "MDU6SXNzdWU0MzAwMzc5ODg=", "number": 991, "title": "Fail ratio calculation for individual requests is incorrect", "user": {"login": "genericmoniker", "id": 2375404, "node_id": "MDQ6VXNlcjIzNzU0MDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2375404?v=4", "gravatar_id": "", "url": "https://api.github.com/users/genericmoniker", "html_url": "https://github.com/genericmoniker", "followers_url": "https://api.github.com/users/genericmoniker/followers", "following_url": "https://api.github.com/users/genericmoniker/following{/other_user}", "gists_url": "https://api.github.com/users/genericmoniker/gists{/gist_id}", "starred_url": "https://api.github.com/users/genericmoniker/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/genericmoniker/subscriptions", "organizations_url": "https://api.github.com/users/genericmoniker/orgs", "repos_url": "https://api.github.com/users/genericmoniker/repos", "events_url": "https://api.github.com/users/genericmoniker/events{/privacy}", "received_events_url": "https://api.github.com/users/genericmoniker/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-04-06T14:16:21Z", "updated_at": "2019-08-23T06:54:34Z", "closed_at": "2019-04-07T04:48:53Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Description of issue\r\n\r\nThe fail ratio for each individual request is incorrect, and doesn't match the total fail ratio.\r\n\r\n### Expected behavior\r\n\r\nThe fail ratio is correct.\r\n\r\n### Actual behavior\r\n\r\nThe fail ratio is incorrect. For example, if 10 out of 10 requests fail, I'd expect the ratio to be 100%, but instead it is 50%.\r\n```\r\n Name                                                          # reqs      # fails     Avg     Min     Max  |  Median   req/s               \r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n GET /                                                             10   10(50.00%)    2014    2009    2021  |    2000    0.75               \r\n--------------------------------------------------------------------------------------------------------------------------------------------\r\n Total                                                             10  10(100.00%)                                       0.75               \r\n```\r\n\r\n### Environment settings\r\n\r\n- OS: Windows/Linux\r\n- Python version: 3.6\r\n- Locust version: 0.11.0\r\n\r\n### Steps to reproduce (for bug reports)\r\n\r\nCreate a trivial locustfile.py:\r\n\r\n```python\r\n\r\nfrom locust import HttpLocust, TaskSet, task\r\n\r\nclass UserBehavior(TaskSet):\r\n    @task\r\n    def index(self):\r\n        self.client.get(\"/\")\r\n\r\n\r\nclass WebsiteUser(HttpLocust):\r\n    task_set = UserBehavior\r\n```\r\nRun it against a host that doesn't have a web server running at all:\r\n\r\n`locust --host http://localhost --no-web --clients=10 --hatch-rate=2 --run-time=30`\r\n\r\nAll of the \"GET /\" requests fail, but the stats (as shown above) have the failure rate at 50% rather than 100%.\r\n\r\nI think the problem is at [stats.py:279](https://github.com/locustio/locust/blob/8b17c286034178ba31c6d48b93f29202514f5659/locust/stats.py#L279):\r\n\r\n```python\r\n            return float(self.num_failures) / (self.num_requests + self.num_failures)\r\n```\r\nIt seems like it ought to be:\r\n\r\n```python\r\n            return float(self.num_failures) / (self.num_requests)\r\n```\r\n\r\nMaybe at some point `self.num_requests` was only the count of successful requests?", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/991/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/991/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/940", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/940/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/940/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/940/events", "html_url": "https://github.com/locustio/locust/issues/940", "id": 395862537, "node_id": "MDU6SXNzdWUzOTU4NjI1Mzc=", "number": 940, "title": "filenames with several dots fails", "user": {"login": "mdtrooper", "id": 1285451, "node_id": "MDQ6VXNlcjEyODU0NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1285451?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mdtrooper", "html_url": "https://github.com/mdtrooper", "followers_url": "https://api.github.com/users/mdtrooper/followers", "following_url": "https://api.github.com/users/mdtrooper/following{/other_user}", "gists_url": "https://api.github.com/users/mdtrooper/gists{/gist_id}", "starred_url": "https://api.github.com/users/mdtrooper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mdtrooper/subscriptions", "organizations_url": "https://api.github.com/users/mdtrooper/orgs", "repos_url": "https://api.github.com/users/mdtrooper/repos", "events_url": "https://api.github.com/users/mdtrooper/events{/privacy}", "received_events_url": "https://api.github.com/users/mdtrooper/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-01-04T09:37:31Z", "updated_at": "2019-01-19T04:32:07Z", "closed_at": "2019-01-19T04:32:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- For general questions about how to use Locust, use either the Slack link provided in the Readme or [ask a question on Stack Overflow](https://stackoverflow.com/questions/ask) tagged Locust.-->\r\n\r\n\r\n### Description of issue / feature request\r\n\r\nfilenames with several dots fails\r\n\r\n### Expected behavior\r\n\r\nRuns fine\r\n\r\n### Actual behavior\r\n\r\nFails\r\n\r\n### Environment settings (for bug reports)\r\n\r\n```\r\nunuser@miguel-pc:/$ uname -a\r\nLinux miguel-pc 4.15.0-43-generic #46~16.04.1-Ubuntu SMP Fri Dec 7 13:31:08 UTC 2018 x86_64 GNU/Linux\r\nunuser@miguel-pc:/$ python --version\r\nPython 3.5.6\r\nunuser@miguel-pc:/$ pip list | grep locustio\r\nlocustio     0.9.0     \r\nunuser@miguel-pc:/$ \r\n```\r\n\r\n### Steps to reproduce (for bug reports)\r\n\r\n```\r\nunuser@miguel-pc:/$ locust -f /tests/login_and_minimal_navigation.test.py -H http://127.0.0.1:10000 --no-web -c 10 -r 2 -t 30s --only-summary\r\n[2019-01-04 09:32:05,137] miguel-pc/ERROR/stderr: Traceback (most recent call last):\r\n[2019-01-04 09:32:05,137] miguel-pc/ERROR/stderr: File \"/usr/local/bin/locust\", line 11, in <module>\r\n[2019-01-04 09:32:05,137] miguel-pc/ERROR/stderr: \r\n[2019-01-04 09:32:05,137] miguel-pc/ERROR/stderr: sys.exit(main())\r\n[2019-01-04 09:32:05,137] miguel-pc/ERROR/stderr: \r\n[2019-01-04 09:32:05,137] miguel-pc/ERROR/stderr: File \"/usr/local/lib/python3.5/site-packages/locust/main.py\", line 391, in main\r\n[2019-01-04 09:32:05,138] miguel-pc/ERROR/stderr: \r\n[2019-01-04 09:32:05,138] miguel-pc/ERROR/stderr: docstring, locusts = load_locustfile(locustfile)\r\n[2019-01-04 09:32:05,138] miguel-pc/ERROR/stderr: \r\n[2019-01-04 09:32:05,138] miguel-pc/ERROR/stderr: File \"/usr/local/lib/python3.5/site-packages/locust/main.py\", line 358, in load_locustfile\r\n[2019-01-04 09:32:05,138] miguel-pc/ERROR/stderr: \r\n[2019-01-04 09:32:05,138] miguel-pc/ERROR/stderr: imported = __import__(os.path.splitext(locustfile)[0])\r\n[2019-01-04 09:32:05,138] miguel-pc/ERROR/stderr: \r\n[2019-01-04 09:32:05,138] miguel-pc/ERROR/stderr: ImportError\r\n[2019-01-04 09:32:05,138] miguel-pc/ERROR/stderr: :\r\n[2019-01-04 09:32:05,138] miguel-pc/ERROR/stderr: No module named 'login_and_minimal_navigation'\r\n[2019-01-04 09:32:05,138] miguel-pc/ERROR/stderr: \r\nunuser@miguel-pc:/$\r\n```", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/940/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/940/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/934", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/934/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/934/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/934/events", "html_url": "https://github.com/locustio/locust/issues/934", "id": 391915914, "node_id": "MDU6SXNzdWUzOTE5MTU5MTQ=", "number": 934, "title": " All locusts dead: runners.py has round error when percent is value that rounds to zero", "user": {"login": "markmen3599", "id": 25124412, "node_id": "MDQ6VXNlcjI1MTI0NDEy", "avatar_url": "https://avatars.githubusercontent.com/u/25124412?v=4", "gravatar_id": "", "url": "https://api.github.com/users/markmen3599", "html_url": "https://github.com/markmen3599", "followers_url": "https://api.github.com/users/markmen3599/followers", "following_url": "https://api.github.com/users/markmen3599/following{/other_user}", "gists_url": "https://api.github.com/users/markmen3599/gists{/gist_id}", "starred_url": "https://api.github.com/users/markmen3599/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/markmen3599/subscriptions", "organizations_url": "https://api.github.com/users/markmen3599/orgs", "repos_url": "https://api.github.com/users/markmen3599/repos", "events_url": "https://api.github.com/users/markmen3599/events{/privacy}", "received_events_url": "https://api.github.com/users/markmen3599/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635903137, "node_id": "MDU6TGFiZWwxNjM1OTAzMTM3", "url": "https://api.github.com/repos/locustio/locust/labels/duplicate", "name": "duplicate", "color": "9cea8c", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-12-17T22:26:36Z", "updated_at": "2019-10-24T11:57:53Z", "closed_at": "2019-10-22T00:57:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- For general questions about how to use Locust, use either the Slack link provided in the Readme or [ask a question on Stack Overflow](https://stackoverflow.com/questions/ask) tagged Locust.-->\r\n\r\n\r\n### Description of issue / feature request\r\n\r\nI am running two client classes inside of a locust file. When I run with --no-web -c 1 -r 1 for testing purposes, the runner was not starting and showing this in the logs:\r\n\r\n[2018-12-17 14:40:38,640] ubuntu/INFO/locust.runners: Hatching and swarming 0 clients at the rate 1 clients/s...\r\n[2018-12-17 14:40:38,640] ubuntu/INFO/locust.runners: All locusts hatched: ScenarioPOSTGET: 0, ScenarioPOSTPUTGET: 0\r\n[2018-12-17 17:11:35,855] ubuntu/INFO/locust.runners: All locusts dead\r\n\r\n\r\nThe problem is in runners.py.weight_locusts.py; lines 82 & 83 (see below) \r\n\r\n```python\r\n    def weight_locusts(self, amount, stop_timeout = None):\r\n        \"\"\"\r\n        Distributes the amount of locusts for each WebLocust-class according to it's weight\r\n        returns a list \"bucket\" with the weighted locusts\r\n        \"\"\"\r\n        bucket = []\r\n        weight_sum = sum((locust.weight for locust in self.locust_classes if locust.task_set))\r\n        for locust in self.locust_classes:\r\n            if not locust.task_set:\r\n                warnings.warn(\"Notice: Found Locust class (%s) got no task_set. Skipping...\" % locust.__name__)\r\n                continue\r\n\r\n            if self.host is not None:\r\n                locust.host = self.host\r\n            if stop_timeout is not None:\r\n                locust.stop_timeout = stop_timeout\r\n\r\n            # create locusts depending on weight\r\n            percent = locust.weight / float(weight_sum) # this is 0.5\r\n            num_locusts = int(round(amount * percent)) # round of 0.5 is -> '0'  :(\r\n            bucket.extend([locust for x in xrange(0, num_locusts)])\r\n        return bucket\r\n```\r\n\r\nRecommend using math.ceil if percent < 1\r\n\r\n### Expected behavior\r\n\r\nThe runner should execute my 2 scenarios in this situation.\r\n\r\n### Actual behavior\r\n\r\nIt does not and shows the locusts are dead.\r\n\r\n### Environment settings (for bug reports)\r\n\r\n- OS: ubuntu 18.04\r\n- Python version: 3.6.6\r\n- Locust version: 0.9.0\r\n\r\n### Steps to reproduce (for bug reports)\r\n\r\n1) Create a test with 2 client classes:\r\ne.g.\r\n```python\r\nclass ScenarioPOSTGET(HttpLocust):\r\n    print(\"inside ScenarioPOSTGET\")\r\n    task_set = PostAndGetTask\r\n    host = \"http://10.203.0.70:30112\"\r\n\r\nclass ScenarioPOSTPUTGET(HttpLocust):\r\n    print(\"inside PostPutAndGetTasks\")\r\n    task_set = PostPutAndGetTasks\r\n    host = \"http://10.203.0.70:30112\"\r\n```\r\nRun this way:\r\nlocust -f locust_test.py --no-web -c 1 -r 1 --run-time 8s", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/934/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/934/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/891", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/891/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/891/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/891/events", "html_url": "https://github.com/locustio/locust/issues/891", "id": 362599746, "node_id": "MDU6SXNzdWUzNjI1OTk3NDY=", "number": 891, "title": "TaskSet min_wait and max_wait are ignored", "user": {"login": "dblakemore", "id": 30432132, "node_id": "MDQ6VXNlcjMwNDMyMTMy", "avatar_url": "https://avatars.githubusercontent.com/u/30432132?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dblakemore", "html_url": "https://github.com/dblakemore", "followers_url": "https://api.github.com/users/dblakemore/followers", "following_url": "https://api.github.com/users/dblakemore/following{/other_user}", "gists_url": "https://api.github.com/users/dblakemore/gists{/gist_id}", "starred_url": "https://api.github.com/users/dblakemore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dblakemore/subscriptions", "organizations_url": "https://api.github.com/users/dblakemore/orgs", "repos_url": "https://api.github.com/users/dblakemore/repos", "events_url": "https://api.github.com/users/dblakemore/events{/privacy}", "received_events_url": "https://api.github.com/users/dblakemore/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-09-21T12:47:25Z", "updated_at": "2019-11-18T11:11:23Z", "closed_at": "2019-11-18T11:11:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Description of issue / feature request\r\n\r\n`min_wait` / `max_wait` overrides in `TaskSet` class not working correctly. When setting `min_wait` and `max_wait` values in a `TaskSet` class, the values seem to be ignored and the default values of 1000 (from the `Locust` class) are used instead.\r\n\r\nI've done some digging into this and I _think_ I know where the problem lies. The `TaskSet`'s `wait_function` is automatically set to the locust's `wait_function` if undefined, but the locust's `wait_function` was defined as a lambda using its own `min_wait` and `max_wait` values. As such, the `TaskSet`'s `min_wait` and `max_wait` value have no effect.\r\n\r\nYou can get around this by assigning a new lambda`wait_function` to the `TaskSet`, but this defeats the purpose of being able to override the `min_wait` and `max_wait` values.\r\n\r\n### Expected behavior\r\n\r\nWhen setting a min_wait and max_wait value of 10000 in a TaskSet class, tasks for each Locust should be spawned 10 seconds apart\r\n\r\n### Actual behavior\r\n\r\nWhen setting a min_wait and max_wait value of 10000 in a TaskSet class, tasks for each Locust are still spawned 1 second apart (which is the default value)\r\n\r\n### Environment settings (for bug reports)\r\n\r\n- OS: Alpine Linux (docker image)\r\n- Python version: 2.7\r\n- Locust version: 0.9.0\r\n\r\n### Steps to reproduce (for bug reports)\r\n\r\n* Create a TaskSet class which inherits from the base TaskSet, with a min_value and max_value of 10000\r\n* Create a single task on the TaskSet class\r\n* Create a Locust class which inherits from the base HttpLocust, with its task_set property set to the TaskSet class created in step one\r\n* Start swarming with 1 user. You would expect the task to spawn every 10 seconds, but it spawns every 1 second.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/891/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/891/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/889", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/889/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/889/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/889/events", "html_url": "https://github.com/locustio/locust/issues/889", "id": 361544615, "node_id": "MDU6SXNzdWUzNjE1NDQ2MTU=", "number": 889, "title": "Strange behavior of \"Total Requests per Second\" chart", "user": {"login": "hoangphucITJP", "id": 14938527, "node_id": "MDQ6VXNlcjE0OTM4NTI3", "avatar_url": "https://avatars.githubusercontent.com/u/14938527?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hoangphucITJP", "html_url": "https://github.com/hoangphucITJP", "followers_url": "https://api.github.com/users/hoangphucITJP/followers", "following_url": "https://api.github.com/users/hoangphucITJP/following{/other_user}", "gists_url": "https://api.github.com/users/hoangphucITJP/gists{/gist_id}", "starred_url": "https://api.github.com/users/hoangphucITJP/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hoangphucITJP/subscriptions", "organizations_url": "https://api.github.com/users/hoangphucITJP/orgs", "repos_url": "https://api.github.com/users/hoangphucITJP/repos", "events_url": "https://api.github.com/users/hoangphucITJP/events{/privacy}", "received_events_url": "https://api.github.com/users/hoangphucITJP/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1626596897, "node_id": "MDU6TGFiZWwxNjI2NTk2ODk3", "url": "https://api.github.com/repos/locustio/locust/labels/hacktoberfest", "name": "hacktoberfest", "color": "f4b7cf", "default": false, "description": "See https://hacktoberfest.digitalocean.com for more info"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2018-09-19T01:40:41Z", "updated_at": "2021-03-08T05:18:37Z", "closed_at": "2019-10-20T08:33:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- For general questions about how to use Locust, use either the Slack link provided in the Readme or [ask a question on Stack Overflow](https://stackoverflow.com/questions/ask) tagged Locust.-->\r\n\r\n\r\n### Description of issue\r\n\r\nTotal Requests per Second's RPS drop to below 1 after the test start a while despite the RPS number on top keep rising\r\n\r\n### Expected behavior\r\n\r\nThe RPS of Total Requests per Second chart  should keep updating according to the RPS number on top\r\n\r\n### Actual behavior\r\n\r\nThe RPS of Total Requests per Second chart value does not match the RPS number on top after the test start a while\r\n\r\n### Environment settings (for bug reports)\r\n\r\n- OS: Ubuntu 16.04.3 LTS (GNU/Linux 4.4.0-78-generic x86_64)\r\n- Python version: 2.7.12\r\n- Locust version: 0.9.0\r\n\r\n### Steps to reproduce (for bug reports)\r\n\r\nI don't know what to put here but feel free to ask for any extra information. I can't provide the code though\r\n\r\n### Screenshot\r\n\r\n![imgpsh_fullsize](https://user-images.githubusercontent.com/14938527/45725860-f873a200-bbe6-11e8-8fcf-3487d0afe8cc.png)\r\n\r\nP/s: Sorry for ignored the template.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/889/reactions", "total_count": 5, "+1": 5, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/889/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/883", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/883/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/883/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/883/events", "html_url": "https://github.com/locustio/locust/issues/883", "id": 360395789, "node_id": "MDU6SXNzdWUzNjAzOTU3ODk=", "number": 883, "title": "Test metrics are not preserved on Stop click in the UI", "user": {"login": "niconphantom", "id": 1226733, "node_id": "MDQ6VXNlcjEyMjY3MzM=", "avatar_url": "https://avatars.githubusercontent.com/u/1226733?v=4", "gravatar_id": "", "url": "https://api.github.com/users/niconphantom", "html_url": "https://github.com/niconphantom", "followers_url": "https://api.github.com/users/niconphantom/followers", "following_url": "https://api.github.com/users/niconphantom/following{/other_user}", "gists_url": "https://api.github.com/users/niconphantom/gists{/gist_id}", "starred_url": "https://api.github.com/users/niconphantom/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/niconphantom/subscriptions", "organizations_url": "https://api.github.com/users/niconphantom/orgs", "repos_url": "https://api.github.com/users/niconphantom/repos", "events_url": "https://api.github.com/users/niconphantom/events{/privacy}", "received_events_url": "https://api.github.com/users/niconphantom/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-09-14T17:45:25Z", "updated_at": "2019-11-06T12:56:30Z", "closed_at": "2019-11-06T12:56:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Description of issue / feature request\r\n\r\nIn Locust 0.8.1, when Stop button is clicked in the UI, RPS, latency and other test metrics are frozen and preserved until # of users is changed and another test is performed. \r\n\r\nIn 0.9.0 this is not the case and when Stop is clicked, RPS and other counters slowly go down from let's say X RPS to 0 RPS. This is super inconvenient when manual testing is performed and the test metrics should be documented. \r\n\r\nMore than that, if I export a CSV with request details right after I click stop and then download the same file after X seconds, I see totally different numbers. So it takes some time for counters to reach 0 and each file download shows inconsistent result.\r\n\r\n### Expected behavior\r\n\r\nTest metrics should be preserved in the UI and on CSV download once the Stop button was clicked.\r\n\r\n### Actual behavior\r\n\r\nTest metrics slowly change from X to 0 in both UI and on CSV download.\r\n\r\n### Steps to reproduce (for bug reports)\r\n\r\n1) Start any test with 1 master and X slaves on single machine with UI mode.\r\n2) Open UI and start the test. Let it run for some seconds until you see RPS value > than 0.\r\n3) Click Stop in the UI\r\n4) Wait some seconds and you should see RPS and other metrics slowly changing from X to 0.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/883/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/883/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/696", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/696/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/696/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/696/events", "html_url": "https://github.com/locustio/locust/issues/696", "id": 276542359, "node_id": "MDU6SXNzdWUyNzY1NDIzNTk=", "number": 696, "title": "About displays improperly", "user": {"login": "mbeacom", "id": 7315957, "node_id": "MDQ6VXNlcjczMTU5NTc=", "avatar_url": "https://avatars.githubusercontent.com/u/7315957?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mbeacom", "html_url": "https://github.com/mbeacom", "followers_url": "https://api.github.com/users/mbeacom/followers", "following_url": "https://api.github.com/users/mbeacom/following{/other_user}", "gists_url": "https://api.github.com/users/mbeacom/gists{/gist_id}", "starred_url": "https://api.github.com/users/mbeacom/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mbeacom/subscriptions", "organizations_url": "https://api.github.com/users/mbeacom/orgs", "repos_url": "https://api.github.com/users/mbeacom/repos", "events_url": "https://api.github.com/users/mbeacom/events{/privacy}", "received_events_url": "https://api.github.com/users/mbeacom/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149037, "node_id": "MDU6TGFiZWwxNDkwMzc=", "url": "https://api.github.com/repos/locustio/locust/labels/web%20interface", "name": "web interface", "color": "0e8a16", "default": false, "description": null}, {"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "mbeacom", "id": 7315957, "node_id": "MDQ6VXNlcjczMTU5NTc=", "avatar_url": "https://avatars.githubusercontent.com/u/7315957?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mbeacom", "html_url": "https://github.com/mbeacom", "followers_url": "https://api.github.com/users/mbeacom/followers", "following_url": "https://api.github.com/users/mbeacom/following{/other_user}", "gists_url": "https://api.github.com/users/mbeacom/gists{/gist_id}", "starred_url": "https://api.github.com/users/mbeacom/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mbeacom/subscriptions", "organizations_url": "https://api.github.com/users/mbeacom/orgs", "repos_url": "https://api.github.com/users/mbeacom/repos", "events_url": "https://api.github.com/users/mbeacom/events{/privacy}", "received_events_url": "https://api.github.com/users/mbeacom/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mbeacom", "id": 7315957, "node_id": "MDQ6VXNlcjczMTU5NTc=", "avatar_url": "https://avatars.githubusercontent.com/u/7315957?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mbeacom", "html_url": "https://github.com/mbeacom", "followers_url": "https://api.github.com/users/mbeacom/followers", "following_url": "https://api.github.com/users/mbeacom/following{/other_user}", "gists_url": "https://api.github.com/users/mbeacom/gists{/gist_id}", "starred_url": "https://api.github.com/users/mbeacom/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mbeacom/subscriptions", "organizations_url": "https://api.github.com/users/mbeacom/orgs", "repos_url": "https://api.github.com/users/mbeacom/repos", "events_url": "https://api.github.com/users/mbeacom/events{/privacy}", "received_events_url": "https://api.github.com/users/mbeacom/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2017-11-24T08:13:42Z", "updated_at": "2017-11-25T16:41:55Z", "closed_at": "2017-11-25T16:41:55Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Description of issue / feature request\r\n\r\n`About` currently displays improperly.  Additionally, there are a few typos in the style.css file that need addressed.  Namely: `whitespace:` should be `white-space` and `-webkit-border-radisu` should be `-webkit-border-radius`.\r\n\r\n### Expected behavior\r\n\r\nOpening `About` should display properly on top of the current view (`z-index: 1`).\r\n\r\n### Actual behavior\r\n\r\nDisplays jumbled.\r\n\r\n### Environment settings (for bug reports)\r\n\r\n- OS: `macOS High Sierra 10.13.2 Beta (17C79a)`\r\n- Python version: `3.6.3`\r\n- Locust version: `0.8`\r\n\r\n### Steps to reproduce (for bug reports)\r\n\r\nRun locust and view `About`", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/696/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/696/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/667", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/667/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/667/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/667/events", "html_url": "https://github.com/locustio/locust/issues/667", "id": 267851652, "node_id": "MDU6SXNzdWUyNjc4NTE2NTI=", "number": 667, "title": "Response time graph seems to be an average of all data", "user": {"login": "lyonzy", "id": 11625419, "node_id": "MDQ6VXNlcjExNjI1NDE5", "avatar_url": "https://avatars.githubusercontent.com/u/11625419?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lyonzy", "html_url": "https://github.com/lyonzy", "followers_url": "https://api.github.com/users/lyonzy/followers", "following_url": "https://api.github.com/users/lyonzy/following{/other_user}", "gists_url": "https://api.github.com/users/lyonzy/gists{/gist_id}", "starred_url": "https://api.github.com/users/lyonzy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lyonzy/subscriptions", "organizations_url": "https://api.github.com/users/lyonzy/orgs", "repos_url": "https://api.github.com/users/lyonzy/repos", "events_url": "https://api.github.com/users/lyonzy/events{/privacy}", "received_events_url": "https://api.github.com/users/lyonzy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2017-10-23T23:42:58Z", "updated_at": "2019-10-20T18:58:44Z", "closed_at": "2019-10-20T18:58:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Description of issue / feature request\r\n\r\nIn the web UI, the response time graph seems to show response time for the entire test run, which I feel is unsuitable for a graph format. At a given x-point on the graph, the current graph shows the average of all data up until then, whereas it would be more useful to see the average of data at that time.\r\n\r\n### Expected behavior\r\n\r\nResponse time might be better displayed as a moving average rather than a complete average.\r\n\r\n### Actual behavior\r\n\r\nResponse time is calculated as an absolute/complete average rather than moving average, which means spikes are significantly 'dampened'. This also doesn't seem to fit a graph format - an absolute average would be suitable for a single number (e.g. the Statistics tab) and a moving average would be better suited for a time-based view like a line graph.\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/667/reactions", "total_count": 6, "+1": 6, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/667/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/665", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/665/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/665/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/665/events", "html_url": "https://github.com/locustio/locust/pull/665", "id": 265706170, "node_id": "MDExOlB1bGxSZXF1ZXN0MTQ2NzM4MjUy", "number": 665, "title": "Exit with code 1 on greenlet exceptions", "user": {"login": "jnschulze", "id": 720469, "node_id": "MDQ6VXNlcjcyMDQ2OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/720469?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jnschulze", "html_url": "https://github.com/jnschulze", "followers_url": "https://api.github.com/users/jnschulze/followers", "following_url": "https://api.github.com/users/jnschulze/following{/other_user}", "gists_url": "https://api.github.com/users/jnschulze/gists{/gist_id}", "starred_url": "https://api.github.com/users/jnschulze/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jnschulze/subscriptions", "organizations_url": "https://api.github.com/users/jnschulze/orgs", "repos_url": "https://api.github.com/users/jnschulze/repos", "events_url": "https://api.github.com/users/jnschulze/events{/privacy}", "received_events_url": "https://api.github.com/users/jnschulze/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1635901340, "node_id": "MDU6TGFiZWwxNjM1OTAxMzQw", "url": "https://api.github.com/repos/locustio/locust/labels/invalid", "name": "invalid", "color": "ff9999", "default": true, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-10-16T09:38:49Z", "updated_at": "2019-10-26T19:59:17Z", "closed_at": "2019-10-21T00:54:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/locustio/locust/pulls/665", "html_url": "https://github.com/locustio/locust/pull/665", "diff_url": "https://github.com/locustio/locust/pull/665.diff", "patch_url": "https://github.com/locustio/locust/pull/665.patch", "merged_at": "2019-10-21T00:54:27Z"}, "body": "Locust exits with code 0 even if an exception in the greenlet occurs. This tiny fix makes it exit with 1 accordingly.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/665/reactions", "total_count": 5, "+1": 5, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/665/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/locustio/locust/issues/629", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/629/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/629/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/629/events", "html_url": "https://github.com/locustio/locust/issues/629", "id": 244759520, "node_id": "MDU6SXNzdWUyNDQ3NTk1MjA=", "number": 629, "title": "Totals Clarity in Web Results", "user": {"login": "blissend", "id": 1093212, "node_id": "MDQ6VXNlcjEwOTMyMTI=", "avatar_url": "https://avatars.githubusercontent.com/u/1093212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/blissend", "html_url": "https://github.com/blissend", "followers_url": "https://api.github.com/users/blissend/followers", "following_url": "https://api.github.com/users/blissend/following{/other_user}", "gists_url": "https://api.github.com/users/blissend/gists{/gist_id}", "starred_url": "https://api.github.com/users/blissend/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/blissend/subscriptions", "organizations_url": "https://api.github.com/users/blissend/orgs", "repos_url": "https://api.github.com/users/blissend/repos", "events_url": "https://api.github.com/users/blissend/events{/privacy}", "received_events_url": "https://api.github.com/users/blissend/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149037, "node_id": "MDU6TGFiZWwxNDkwMzc=", "url": "https://api.github.com/repos/locustio/locust/labels/web%20interface", "name": "web interface", "color": "0e8a16", "default": false, "description": null}, {"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-07-21T19:17:03Z", "updated_at": "2019-10-18T16:26:22Z", "closed_at": "2019-10-18T16:26:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "The front page of http://locust.io/ shows a web example of results where the totals row is a bit confusing. Some of the columns in the totals row is a sum of all numbers but not for others. For example the average column shows a total that is obviously not just a sum of all numbers. What is it a total of then? Perhaps it should be removed? This data isn't provided when you exit out of the process which gives text results without totals for that.\r\n\r\nI found this on v0.7.5 and 0.8a2 available via pypi.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/629/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/629/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/555", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/555/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/555/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/555/events", "html_url": "https://github.com/locustio/locust/issues/555", "id": 210482564, "node_id": "MDU6SXNzdWUyMTA0ODI1NjQ=", "number": 555, "title": "Web UI bug when url is very long", "user": {"login": "debugtalk", "id": 3657070, "node_id": "MDQ6VXNlcjM2NTcwNzA=", "avatar_url": "https://avatars.githubusercontent.com/u/3657070?v=4", "gravatar_id": "", "url": "https://api.github.com/users/debugtalk", "html_url": "https://github.com/debugtalk", "followers_url": "https://api.github.com/users/debugtalk/followers", "following_url": "https://api.github.com/users/debugtalk/following{/other_user}", "gists_url": "https://api.github.com/users/debugtalk/gists{/gist_id}", "starred_url": "https://api.github.com/users/debugtalk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/debugtalk/subscriptions", "organizations_url": "https://api.github.com/users/debugtalk/orgs", "repos_url": "https://api.github.com/users/debugtalk/repos", "events_url": "https://api.github.com/users/debugtalk/events{/privacy}", "received_events_url": "https://api.github.com/users/debugtalk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-02-27T13:24:34Z", "updated_at": "2017-03-03T11:50:20Z", "closed_at": "2017-03-03T11:49:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "![image](https://cloud.githubusercontent.com/assets/3657070/23362914/f284a6ba-fd32-11e6-917f-a09198c6e931.png)\r\n\r\nwhen the name(or url) is very long, the `reqs/sec` can not be seen.", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/555/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/555/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/546", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/546/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/546/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/546/events", "html_url": "https://github.com/locustio/locust/pull/546", "id": 208921265, "node_id": "MDExOlB1bGxSZXF1ZXN0MTA3MDM0OTIw", "number": 546, "title": "Prohibits the locustfile from being named 'locust.py'", "user": {"login": "cgoldberg", "id": 1113081, "node_id": "MDQ6VXNlcjExMTMwODE=", "avatar_url": "https://avatars.githubusercontent.com/u/1113081?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cgoldberg", "html_url": "https://github.com/cgoldberg", "followers_url": "https://api.github.com/users/cgoldberg/followers", "following_url": "https://api.github.com/users/cgoldberg/following{/other_user}", "gists_url": "https://api.github.com/users/cgoldberg/gists{/gist_id}", "starred_url": "https://api.github.com/users/cgoldberg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cgoldberg/subscriptions", "organizations_url": "https://api.github.com/users/cgoldberg/orgs", "repos_url": "https://api.github.com/users/cgoldberg/repos", "events_url": "https://api.github.com/users/cgoldberg/events{/privacy}", "received_events_url": "https://api.github.com/users/cgoldberg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/locustio/locust/milestones/3", "html_url": "https://github.com/locustio/locust/milestone/3", "labels_url": "https://api.github.com/repos/locustio/locust/milestones/3/labels", "id": 1822540, "node_id": "MDk6TWlsZXN0b25lMTgyMjU0MA==", "number": 3, "title": "0.8.0", "description": "Support Python 3", "creator": {"login": "justiniso", "id": 717862, "node_id": "MDQ6VXNlcjcxNzg2Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/717862?v=4", "gravatar_id": "", "url": "https://api.github.com/users/justiniso", "html_url": "https://github.com/justiniso", "followers_url": "https://api.github.com/users/justiniso/followers", "following_url": "https://api.github.com/users/justiniso/following{/other_user}", "gists_url": "https://api.github.com/users/justiniso/gists{/gist_id}", "starred_url": "https://api.github.com/users/justiniso/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/justiniso/subscriptions", "organizations_url": "https://api.github.com/users/justiniso/orgs", "repos_url": "https://api.github.com/users/justiniso/repos", "events_url": "https://api.github.com/users/justiniso/events{/privacy}", "received_events_url": "https://api.github.com/users/justiniso/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 23, "state": "closed", "created_at": "2016-06-13T02:22:00Z", "updated_at": "2019-10-20T19:48:07Z", "due_on": null, "closed_at": "2019-10-20T19:48:07Z"}, "comments": 0, "created_at": "2017-02-20T16:05:20Z", "updated_at": "2017-02-20T16:37:48Z", "closed_at": "2017-02-20T16:33:00Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/locustio/locust/pulls/546", "html_url": "https://github.com/locustio/locust/pull/546", "diff_url": "https://github.com/locustio/locust/pull/546.diff", "patch_url": "https://github.com/locustio/locust/pull/546.patch", "merged_at": "2017-02-20T16:32:59Z"}, "body": "Fixes #138\r\n\r\nThis PR prohibits naming your locustfile `locust.py`, which previously caused Locust to exit with a misleading message (\"No Locust class found\").\r\n\r\nThe new behavior is to exit with a more helpful error message explaining not to name the file `locust.py`. \r\n\r\nThe issue was occuring because the locustfile gets imported as a Python module (with the .py extension removed).  So naming it `locust.py` caused a namespace clash with the internal `locust` module, which would get re-imported instead of the locustfile.\r\n\r\n\r\nNote: This only fixes the common case where you have named it `locust.py`.  There are also other reserved names that can not be used as locustfile names.  We might want to add something to the docs to explain this.\r\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/546/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/546/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/locustio/locust/issues/532", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/532/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/532/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/532/events", "html_url": "https://github.com/locustio/locust/pull/532", "id": 207069365, "node_id": "MDExOlB1bGxSZXF1ZXN0MTA1ODAxMzQ1", "number": 532, "title": "Truncate number of errors displayed in the web UI", "user": {"login": "justiniso", "id": 717862, "node_id": "MDQ6VXNlcjcxNzg2Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/717862?v=4", "gravatar_id": "", "url": "https://api.github.com/users/justiniso", "html_url": "https://github.com/justiniso", "followers_url": "https://api.github.com/users/justiniso/followers", "following_url": "https://api.github.com/users/justiniso/following{/other_user}", "gists_url": "https://api.github.com/users/justiniso/gists{/gist_id}", "starred_url": "https://api.github.com/users/justiniso/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/justiniso/subscriptions", "organizations_url": "https://api.github.com/users/justiniso/orgs", "repos_url": "https://api.github.com/users/justiniso/repos", "events_url": "https://api.github.com/users/justiniso/events{/privacy}", "received_events_url": "https://api.github.com/users/justiniso/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/locustio/locust/milestones/3", "html_url": "https://github.com/locustio/locust/milestone/3", "labels_url": "https://api.github.com/repos/locustio/locust/milestones/3/labels", "id": 1822540, "node_id": "MDk6TWlsZXN0b25lMTgyMjU0MA==", "number": 3, "title": "0.8.0", "description": "Support Python 3", "creator": {"login": "justiniso", "id": 717862, "node_id": "MDQ6VXNlcjcxNzg2Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/717862?v=4", "gravatar_id": "", "url": "https://api.github.com/users/justiniso", "html_url": "https://github.com/justiniso", "followers_url": "https://api.github.com/users/justiniso/followers", "following_url": "https://api.github.com/users/justiniso/following{/other_user}", "gists_url": "https://api.github.com/users/justiniso/gists{/gist_id}", "starred_url": "https://api.github.com/users/justiniso/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/justiniso/subscriptions", "organizations_url": "https://api.github.com/users/justiniso/orgs", "repos_url": "https://api.github.com/users/justiniso/repos", "events_url": "https://api.github.com/users/justiniso/events{/privacy}", "received_events_url": "https://api.github.com/users/justiniso/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 23, "state": "closed", "created_at": "2016-06-13T02:22:00Z", "updated_at": "2019-10-20T19:48:07Z", "due_on": null, "closed_at": "2019-10-20T19:48:07Z"}, "comments": 0, "created_at": "2017-02-12T18:46:15Z", "updated_at": "2017-02-12T19:47:12Z", "closed_at": "2017-02-12T19:44:57Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/locustio/locust/pulls/532", "html_url": "https://github.com/locustio/locust/pull/532", "diff_url": "https://github.com/locustio/locust/pull/532.diff", "patch_url": "https://github.com/locustio/locust/pull/532.patch", "merged_at": "2017-02-12T19:44:57Z"}, "body": "This change limits the number of rows on the web UI to display at most **500** rows in the `stats` and `failures` tabs. A common scenario is the app failing under load, resulting in a large number of unique failures, bringing the rendering to a halt. \r\n\r\nA simple locustfile demonstrates the issue:\r\n\r\n```python\r\nimport random \r\n\r\nfrom locust import HttpLocust, TaskSet, task\r\n\r\nclass UserTasks(TaskSet):\r\n\r\n    @task\r\n    def error(self):\r\n        self.client.get(\"/404/{}\".format(random.randint(0,99999999999))\r\n\r\nclass WebsiteUser(HttpLocust):\r\n    min_wait = 0\r\n    max_wait = 0\r\n    task_set = UserTasks\r\n```\r\n\r\nThis will generate a large number of results and errors, eventually killing the page. I feel that 500 results is a reasonable number to display as it's more than anyone could consume manually through the web UI. But for automated processes, the _actual_ results will remain intact. ", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/532/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/532/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/locustio/locust/issues/399", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/399/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/399/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/399/events", "html_url": "https://github.com/locustio/locust/issues/399", "id": 145044698, "node_id": "MDU6SXNzdWUxNDUwNDQ2OTg=", "number": 399, "title": "on_request_xxx checks exiting condition against the wrong number", "user": {"login": "yalinhuang", "id": 3681205, "node_id": "MDQ6VXNlcjM2ODEyMDU=", "avatar_url": "https://avatars.githubusercontent.com/u/3681205?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yalinhuang", "html_url": "https://github.com/yalinhuang", "followers_url": "https://api.github.com/users/yalinhuang/followers", "following_url": "https://api.github.com/users/yalinhuang/following{/other_user}", "gists_url": "https://api.github.com/users/yalinhuang/gists{/gist_id}", "starred_url": "https://api.github.com/users/yalinhuang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yalinhuang/subscriptions", "organizations_url": "https://api.github.com/users/yalinhuang/orgs", "repos_url": "https://api.github.com/users/yalinhuang/repos", "events_url": "https://api.github.com/users/yalinhuang/events{/privacy}", "received_events_url": "https://api.github.com/users/yalinhuang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2016-03-31T23:27:55Z", "updated_at": "2019-10-18T15:30:36Z", "closed_at": "2019-10-18T15:30:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "`on_request_xxx()` checks exiting condition before incrementing the relevant variables; this should be done in the reverse order.\n\nA test run exits upon `StopLocust` exception is raised. The condition is checked every time a request is sent and responded (or failed). However the condition checking looks at the wrong number; for example, in `on_request_success()` in [stats.py](https://github.com/locustio/locust/blob/master/locust/stats.py#L415)\n\n```\ndef on_request_success(request_type, name, response_time, response_length):\n    if global_stats.max_requests is not None and (global_stats.num_requests + global_stats.num_failures) >= global_stats.max_requests:\n        raise StopLocust(\"Maximum number of requests reached\")\n    global_stats.get(name, request_type).log(response_time, response_length)\n```\n\n`global_stats.num_requests` is increased by one in [the `log()` function](https://github.com/locustio/locust/blob/master/locust/stats.py#L135) after the condition is checked. This leads to sending one more requests than being asked to.\n\nWas wondering if this design is intended? or?\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/399/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/399/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/397", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/397/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/397/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/397/events", "html_url": "https://github.com/locustio/locust/issues/397", "id": 142048923, "node_id": "MDU6SXNzdWUxNDIwNDg5MjM=", "number": 397, "title": "gevent.hub.LoopExit exeption, python threading and twisted reactor", "user": {"login": "NPeganov", "id": 5539308, "node_id": "MDQ6VXNlcjU1MzkzMDg=", "avatar_url": "https://avatars.githubusercontent.com/u/5539308?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NPeganov", "html_url": "https://github.com/NPeganov", "followers_url": "https://api.github.com/users/NPeganov/followers", "following_url": "https://api.github.com/users/NPeganov/following{/other_user}", "gists_url": "https://api.github.com/users/NPeganov/gists{/gist_id}", "starred_url": "https://api.github.com/users/NPeganov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NPeganov/subscriptions", "organizations_url": "https://api.github.com/users/NPeganov/orgs", "repos_url": "https://api.github.com/users/NPeganov/repos", "events_url": "https://api.github.com/users/NPeganov/events{/privacy}", "received_events_url": "https://api.github.com/users/NPeganov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-03-19T10:06:48Z", "updated_at": "2017-02-13T01:56:20Z", "closed_at": "2017-02-13T01:56:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\n\nThe short code snippet in the file attached\n[test1.txt](https://github.com/locustio/locust/files/180746/test1.txt)\n\n is hitting gevent.hub.LoopExit exeption immediately after running locust (even not spawn is started). Commenting out the line\n`Thread(target=reactor.run, args=(False,)).start()`\nresolves the issue. But I do need to use twisted and reactor.run must not block the code execution.\n\nOS: ubuntu\nThe output is flooded with the following messages:\n[2016-03-19 10:17:04,003] ip-172-20-38-27/INFO/locust.main: Starting web monitor at _:8089\n[2016-03-19 10:17:04,003] ip-172-20-38-27/INFO/locust.main: Starting Locust 0.7.3\n[2016-03-19 10:17:04,012] ip-172-20-38-27/ERROR/stderr: Unhandled Error\nTraceback (most recent call last):\n  File \"/usr/lib64/python2.7/threading.py\", line 784, in __bootstrap\n    self.__bootstrap_inner()\n  File \"/usr/lib64/python2.7/threading.py\", line 811, in __bootstrap_inner\n    self.run()\n  File \"/usr/lib64/python2.7/threading.py\", line 764, in run\n    self.__target(_self.__args, **self.__kwargs)\n  File \"/usr/lib64/python2.7/site-packages/twisted/internet/base.py\", line 1194, in run\n    self.mainLoop()\n--- <exception caught here> ---\n  File \"/usr/lib64/python2.7/site-packages/twisted/internet/base.py\", line 1206, in mainLoop\n    self.doIteration(t)\n  File \"/usr/lib64/python2.7/site-packages/twisted/internet/pollreactor.py\", line 155, in doPoll\n    l = self._poller.poll(timeout)\n  File \"/usr/lib64/python2.7/site-packages/gevent/select.py\", line 127, in poll\n    result.event.wait(timeout=timeout)\n  File \"/usr/lib64/python2.7/site-packages/gevent/event.py\", line 213, in wait\n    return self._wait(timeout)\n  File \"/usr/lib64/python2.7/site-packages/gevent/event.py\", line 123, in _wait\n    gotit = self._wait_core(timeout)\n  File \"/usr/lib64/python2.7/site-packages/gevent/event.py\", line 101, in _wait_core\n    result = self.hub.switch()\n  File \"/usr/lib64/python2.7/site-packages/gevent/hub.py\", line 606, in switch\n    return greenlet.switch(self)\ngevent.hub.LoopExit: ('This operation would block forever', <Hub at 0x277ed70 epoll pending=0 ref=0 fileno=5>)\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/397/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/397/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/396", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/396/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/396/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/396/events", "html_url": "https://github.com/locustio/locust/issues/396", "id": 142047927, "node_id": "MDU6SXNzdWUxNDIwNDc5Mjc=", "number": 396, "title": "OpenSSL handshake error", "user": {"login": "aschuch", "id": 1506193, "node_id": "MDQ6VXNlcjE1MDYxOTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1506193?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aschuch", "html_url": "https://github.com/aschuch", "followers_url": "https://api.github.com/users/aschuch/followers", "following_url": "https://api.github.com/users/aschuch/following{/other_user}", "gists_url": "https://api.github.com/users/aschuch/gists{/gist_id}", "starred_url": "https://api.github.com/users/aschuch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aschuch/subscriptions", "organizations_url": "https://api.github.com/users/aschuch/orgs", "repos_url": "https://api.github.com/users/aschuch/repos", "events_url": "https://api.github.com/users/aschuch/events{/privacy}", "received_events_url": "https://api.github.com/users/aschuch/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2016-03-19T09:57:31Z", "updated_at": "2017-08-18T16:23:15Z", "closed_at": "2017-08-18T16:23:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am testing locust with my [personal site](https://schuch.me).\nHowever, all tests fail with the following SSLError:\n\n```\nSSLError(SSLError(SSLError(1, u'[SSL: SSLV3_ALERT_HANDSHAKE_FAILURE] sslv3 alert handshake failure (_ssl.c:590)'),),)\n```\n\nI have tested the same configuration with google.com and it worked just fine. My site uses Cloudflare Free SSL Certificates, not sure if that's the root of the issue. However, passing `verify=False` should actually ignore any SSL certificate issues, right?\n#### locustfile.py\n\n``` python\nfrom locust import HttpLocust, TaskSet, task\n\nclass APITestTaskSet(TaskSet):\n\n    def on_start(self):\n        self.client.verify = False\n\n    @task\n    def index(self):\n        self.client.get(\"/\")\n\nclass APITestLocust(HttpLocust):\n    task_set = APITestTaskSet\n    min_wait=1000\n    max_wait=3000\n```\n#### Configuration\n\n``` bash\n\u279c openssl version -a \nOpenSSL 0.9.8zg 14 July 2015\nbuilt on: Jul 31 2015\nplatform: darwin64-x86_64-llvm\noptions:  bn(64,64) md2(int) rc4(ptr,char) des(idx,cisc,16,int) blowfish(idx) \ncompiler: -arch x86_64 -fmessage-length=0 -pipe -Wno-trigraphs -fpascal-strings -fasm-blocks -O3 -D_REENTRANT -DDSO_DLFCN -DHAVE_DLFCN_H -DL_ENDIAN -DMD32_REG_T=int -DOPENSSL_NO_IDEA -DOPENSSL_PIC -DOPENSSL_THREADS -DZLIB -mmacosx-version-min=10.6\nOPENSSLDIR: \"/System/Library/OpenSSL\"\n```\n\n``` bash\n\u279c python --version\nPython 2.7.10\n```\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/396/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/396/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/384", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/384/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/384/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/384/events", "html_url": "https://github.com/locustio/locust/issues/384", "id": 133947436, "node_id": "MDU6SXNzdWUxMzM5NDc0MzY=", "number": 384, "title": "[0.7.3] Total fails percentage calculated wrong on console", "user": {"login": "fpiesche", "id": 393620, "node_id": "MDQ6VXNlcjM5MzYyMA==", "avatar_url": "https://avatars.githubusercontent.com/u/393620?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fpiesche", "html_url": "https://github.com/fpiesche", "followers_url": "https://api.github.com/users/fpiesche/followers", "following_url": "https://api.github.com/users/fpiesche/following{/other_user}", "gists_url": "https://api.github.com/users/fpiesche/gists{/gist_id}", "starred_url": "https://api.github.com/users/fpiesche/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fpiesche/subscriptions", "organizations_url": "https://api.github.com/users/fpiesche/orgs", "repos_url": "https://api.github.com/users/fpiesche/repos", "events_url": "https://api.github.com/users/fpiesche/events{/privacy}", "received_events_url": "https://api.github.com/users/fpiesche/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-02-16T10:53:37Z", "updated_at": "2019-10-18T15:30:58Z", "closed_at": "2019-10-18T15:30:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "I've been using Locust for the past few days on small test batches (100 or 1000 requests total) and noticed that the #fails percentage looks to be calculated via fails / successes rather than fails / (successes + fails).\n\nThis means that 23 failures out of 100 requests are shown as 23 / 77 = 29.87% fails, rather than 23 / 100 = 23%.\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/384/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/384/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/374", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/374/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/374/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/374/events", "html_url": "https://github.com/locustio/locust/issues/374", "id": 126057091, "node_id": "MDU6SXNzdWUxMjYwNTcwOTE=", "number": 374, "title": "URL names in dashboard are not HTML escaped", "user": {"login": "kumar303", "id": 55398, "node_id": "MDQ6VXNlcjU1Mzk4", "avatar_url": "https://avatars.githubusercontent.com/u/55398?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kumar303", "html_url": "https://github.com/kumar303", "followers_url": "https://api.github.com/users/kumar303/followers", "following_url": "https://api.github.com/users/kumar303/following{/other_user}", "gists_url": "https://api.github.com/users/kumar303/gists{/gist_id}", "starred_url": "https://api.github.com/users/kumar303/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kumar303/subscriptions", "organizations_url": "https://api.github.com/users/kumar303/orgs", "repos_url": "https://api.github.com/users/kumar303/repos", "events_url": "https://api.github.com/users/kumar303/events{/privacy}", "received_events_url": "https://api.github.com/users/kumar303/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149037, "node_id": "MDU6TGFiZWwxNDkwMzc=", "url": "https://api.github.com/repos/locustio/locust/labels/web%20interface", "name": "web interface", "color": "0e8a16", "default": false, "description": null}, {"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 1626596897, "node_id": "MDU6TGFiZWwxNjI2NTk2ODk3", "url": "https://api.github.com/repos/locustio/locust/labels/hacktoberfest", "name": "hacktoberfest", "color": "f4b7cf", "default": false, "description": "See https://hacktoberfest.digitalocean.com for more info"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2016-01-11T22:56:01Z", "updated_at": "2019-10-24T14:46:13Z", "closed_at": "2019-10-24T14:46:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "URL names (for stats) are not HTML-escaped in the dashboard. This makes names with angle brackets disappear. For example:\n\n```\nself.client.get(url, name='/some-resource/upload/<uuid>')\n```\n\nwould show up as `/some-resource/upload/` instead of `/some-resource/upload/<uuid>` which is confusing. There could be some XSS security concerns here as well.\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/374/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/374/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/364", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/364/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/364/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/364/events", "html_url": "https://github.com/locustio/locust/issues/364", "id": 120699796, "node_id": "MDU6SXNzdWUxMjA2OTk3OTY=", "number": 364, "title": "sending POST image in client.post() never receives Request.FILES", "user": {"login": "anujacharya1", "id": 1526954, "node_id": "MDQ6VXNlcjE1MjY5NTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1526954?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anujacharya1", "html_url": "https://github.com/anujacharya1", "followers_url": "https://api.github.com/users/anujacharya1/followers", "following_url": "https://api.github.com/users/anujacharya1/following{/other_user}", "gists_url": "https://api.github.com/users/anujacharya1/gists{/gist_id}", "starred_url": "https://api.github.com/users/anujacharya1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anujacharya1/subscriptions", "organizations_url": "https://api.github.com/users/anujacharya1/orgs", "repos_url": "https://api.github.com/users/anujacharya1/repos", "events_url": "https://api.github.com/users/anujacharya1/events{/privacy}", "received_events_url": "https://api.github.com/users/anujacharya1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-12-07T05:00:47Z", "updated_at": "2017-02-13T01:27:16Z", "closed_at": "2017-02-13T01:27:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "I tried to use locust client to upload a file but I always get request.FILES.get('photo')=None on server side (If I use POSTMAN I am getting the file)\n\n```\n@task\ndef post_img(self):\n    with open('img.jpg', 'rb') as image:\n        payload = {'id': self.id, 'photo': image}\n        upload_result = self.client.post(\"/image/\", payload)\n```\n\nAlso tried the following:\n\n```\n@task\ndef post_img(self):\n    with open('img.jpg', 'rb') as image:\n        payload = {'id': self.id}\n        upload_result = self.client.post(\"/image/\", data=payload, files=image)\n```\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/364/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/364/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/358", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/358/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/358/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/358/events", "html_url": "https://github.com/locustio/locust/pull/358", "id": 114102799, "node_id": "MDExOlB1bGxSZXF1ZXN0NDkxNzIxNTY=", "number": 358, "title": "Fixed failures percentage calculation in Total", "user": {"login": "mlo0352", "id": 5342027, "node_id": "MDQ6VXNlcjUzNDIwMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/5342027?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mlo0352", "html_url": "https://github.com/mlo0352", "followers_url": "https://api.github.com/users/mlo0352/followers", "following_url": "https://api.github.com/users/mlo0352/following{/other_user}", "gists_url": "https://api.github.com/users/mlo0352/gists{/gist_id}", "starred_url": "https://api.github.com/users/mlo0352/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mlo0352/subscriptions", "organizations_url": "https://api.github.com/users/mlo0352/orgs", "repos_url": "https://api.github.com/users/mlo0352/repos", "events_url": "https://api.github.com/users/mlo0352/events{/privacy}", "received_events_url": "https://api.github.com/users/mlo0352/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 537941738, "node_id": "MDU6TGFiZWw1Mzc5NDE3Mzg=", "url": "https://api.github.com/repos/locustio/locust/labels/priority", "name": "priority", "color": "fef2c0", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2015-10-29T17:24:29Z", "updated_at": "2019-01-27T13:25:35Z", "closed_at": "2019-01-27T13:25:35Z", "author_association": "NONE", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/locustio/locust/pulls/358", "html_url": "https://github.com/locustio/locust/pull/358", "diff_url": "https://github.com/locustio/locust/pull/358.diff", "patch_url": "https://github.com/locustio/locust/pull/358.patch", "merged_at": null}, "body": "The percentage calculation was essentially comparing failures to the number of successes (confusingly referred to as reqs [requests]) - fixed the math to have it calculate percent failure as a percentage of all requests.\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/358/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/358/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/locustio/locust/issues/357", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/357/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/357/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/357/events", "html_url": "https://github.com/locustio/locust/issues/357", "id": 114094147, "node_id": "MDU6SXNzdWUxMTQwOTQxNDc=", "number": 357, "title": "Percentage of fails in Total line is greater than 100%", "user": {"login": "mlo0352", "id": 5342027, "node_id": "MDQ6VXNlcjUzNDIwMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/5342027?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mlo0352", "html_url": "https://github.com/mlo0352", "followers_url": "https://api.github.com/users/mlo0352/followers", "following_url": "https://api.github.com/users/mlo0352/following{/other_user}", "gists_url": "https://api.github.com/users/mlo0352/gists{/gist_id}", "starred_url": "https://api.github.com/users/mlo0352/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mlo0352/subscriptions", "organizations_url": "https://api.github.com/users/mlo0352/orgs", "repos_url": "https://api.github.com/users/mlo0352/repos", "events_url": "https://api.github.com/users/mlo0352/events{/privacy}", "received_events_url": "https://api.github.com/users/mlo0352/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-10-29T16:44:18Z", "updated_at": "2019-10-18T15:37:58Z", "closed_at": "2019-10-18T15:37:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "When the amount of failures is more than the number of passes, the percentage goes over 100. It looks like it comes from counting reqs as passes although that should probably be a separate field.\n\nAn example:\n\n``` bash\nName                                                          # reqs      # fails     Avg     Min     Max  |  Median   req/s\n--------------------------------------------------------------------------------------------------------------------------------------------\n GET /mycall                                                   330 1123(77.29%)     395     204    2090  |     310    9.40\n--------------------------------------------------------------------------------------------------------------------------------------------\n Total                                                            330 1123(340.30%)                                       9.40\n```\n\nIs this an issue? I can see it not being one if a relative description of fails compared to passes is the desired take-away from that field...in which case reqs may be better renamed success or something.\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/357/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/357/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/350", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/350/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/350/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/350/events", "html_url": "https://github.com/locustio/locust/issues/350", "id": 112813897, "node_id": "MDU6SXNzdWUxMTI4MTM4OTc=", "number": 350, "title": "Some of the requets total stats are missing when printing them to console", "user": {"login": "molsky", "id": 1943521, "node_id": "MDQ6VXNlcjE5NDM1MjE=", "avatar_url": "https://avatars.githubusercontent.com/u/1943521?v=4", "gravatar_id": "", "url": "https://api.github.com/users/molsky", "html_url": "https://github.com/molsky", "followers_url": "https://api.github.com/users/molsky/followers", "following_url": "https://api.github.com/users/molsky/following{/other_user}", "gists_url": "https://api.github.com/users/molsky/gists{/gist_id}", "starred_url": "https://api.github.com/users/molsky/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/molsky/subscriptions", "organizations_url": "https://api.github.com/users/molsky/orgs", "repos_url": "https://api.github.com/users/molsky/repos", "events_url": "https://api.github.com/users/molsky/events{/privacy}", "received_events_url": "https://api.github.com/users/molsky/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2015-10-22T14:22:48Z", "updated_at": "2017-02-15T04:04:16Z", "closed_at": "2017-02-15T04:04:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "Following total stats are missing when printing requests stats to console: Avg     Min     Max  |  Median\n\n![screen shot 2015-10-22 at 17 31 24 2](https://cloud.githubusercontent.com/assets/1943521/10667996/ca02daac-78e2-11e5-9332-66e9e74d1c62.png)\n\nOSX 10.10\nLocust 0.7.3\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/350/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/350/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/331", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/331/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/331/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/331/events", "html_url": "https://github.com/locustio/locust/issues/331", "id": 103508993, "node_id": "MDU6SXNzdWUxMDM1MDg5OTM=", "number": 331, "title": "Percentiles rounding error", "user": {"login": "pior", "id": 60219, "node_id": "MDQ6VXNlcjYwMjE5", "avatar_url": "https://avatars.githubusercontent.com/u/60219?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pior", "html_url": "https://github.com/pior", "followers_url": "https://api.github.com/users/pior/followers", "following_url": "https://api.github.com/users/pior/following{/other_user}", "gists_url": "https://api.github.com/users/pior/gists{/gist_id}", "starred_url": "https://api.github.com/users/pior/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pior/subscriptions", "organizations_url": "https://api.github.com/users/pior/orgs", "repos_url": "https://api.github.com/users/pior/repos", "events_url": "https://api.github.com/users/pior/events{/privacy}", "received_events_url": "https://api.github.com/users/pior/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2015-08-27T13:28:11Z", "updated_at": "2018-12-03T20:42:30Z", "closed_at": "2018-12-03T20:31:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\n Name                                                           # reqs    50%    66%    75%    80%    90%    95%    98%    99%   100%\n--------------------------------------------------------------------------------------------------------------------------------------------\n POST /projects/<>/devices                                          50    230    240    250    270    320    340    600    600    596\n```\n\nNote that all latencies are multiple of 10. And 99% is higher than 100%.\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/331/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/331/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/309", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/309/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/309/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/309/events", "html_url": "https://github.com/locustio/locust/issues/309", "id": 97506804, "node_id": "MDU6SXNzdWU5NzUwNjgwNA==", "number": 309, "title": "Web UI Freezing", "user": {"login": "lukerosenfeld", "id": 4560172, "node_id": "MDQ6VXNlcjQ1NjAxNzI=", "avatar_url": "https://avatars.githubusercontent.com/u/4560172?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lukerosenfeld", "html_url": "https://github.com/lukerosenfeld", "followers_url": "https://api.github.com/users/lukerosenfeld/followers", "following_url": "https://api.github.com/users/lukerosenfeld/following{/other_user}", "gists_url": "https://api.github.com/users/lukerosenfeld/gists{/gist_id}", "starred_url": "https://api.github.com/users/lukerosenfeld/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lukerosenfeld/subscriptions", "organizations_url": "https://api.github.com/users/lukerosenfeld/orgs", "repos_url": "https://api.github.com/users/lukerosenfeld/repos", "events_url": "https://api.github.com/users/lukerosenfeld/events{/privacy}", "received_events_url": "https://api.github.com/users/lukerosenfeld/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149037, "node_id": "MDU6TGFiZWwxNDkwMzc=", "url": "https://api.github.com/repos/locustio/locust/labels/web%20interface", "name": "web interface", "color": "0e8a16", "default": false, "description": null}, {"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2015-07-27T16:49:43Z", "updated_at": "2017-02-13T01:29:37Z", "closed_at": "2017-02-13T01:29:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "#307\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/309/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/309/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/303", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/303/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/303/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/303/events", "html_url": "https://github.com/locustio/locust/issues/303", "id": 94049014, "node_id": "MDU6SXNzdWU5NDA0OTAxNA==", "number": 303, "title": "Unclear how to interpret numbers", "user": {"login": "emiel", "id": 37766, "node_id": "MDQ6VXNlcjM3NzY2", "avatar_url": "https://avatars.githubusercontent.com/u/37766?v=4", "gravatar_id": "", "url": "https://api.github.com/users/emiel", "html_url": "https://github.com/emiel", "followers_url": "https://api.github.com/users/emiel/followers", "following_url": "https://api.github.com/users/emiel/following{/other_user}", "gists_url": "https://api.github.com/users/emiel/gists{/gist_id}", "starred_url": "https://api.github.com/users/emiel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/emiel/subscriptions", "organizations_url": "https://api.github.com/users/emiel/orgs", "repos_url": "https://api.github.com/users/emiel/repos", "events_url": "https://api.github.com/users/emiel/events{/privacy}", "received_events_url": "https://api.github.com/users/emiel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149037, "node_id": "MDU6TGFiZWwxNDkwMzc=", "url": "https://api.github.com/repos/locustio/locust/labels/web%20interface", "name": "web interface", "color": "0e8a16", "default": false, "description": null}, {"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 77651414, "node_id": "MDU6TGFiZWw3NzY1MTQxNA==", "url": "https://api.github.com/repos/locustio/locust/labels/documentation", "name": "documentation", "color": "207de5", "default": true, "description": null}, {"id": 537941738, "node_id": "MDU6TGFiZWw1Mzc5NDE3Mzg=", "url": "https://api.github.com/repos/locustio/locust/labels/priority", "name": "priority", "color": "fef2c0", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2015-07-09T13:32:37Z", "updated_at": "2020-06-17T10:26:08Z", "closed_at": "2018-04-08T14:24:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "The stats displayed in the UI and console do not indicate the numbers unit. For median, average, min, max I'm assuming is the response time... Is it milliseconds? How about content size. Is it in bytes?\n\nThese should be in the documentation and also displayed in the tooling.\n\nThanks! Great tooling so far.\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/303/reactions", "total_count": 7, "+1": 7, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/303/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/273", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/273/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/273/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/273/events", "html_url": "https://github.com/locustio/locust/issues/273", "id": 73127246, "node_id": "MDU6SXNzdWU3MzEyNzI0Ng==", "number": 273, "title": "requests.exceptions.ConnectionError: ('Connection aborted.', ResponseNotReady('Request-sent',))", "user": {"login": "giantryansaul", "id": 353566, "node_id": "MDQ6VXNlcjM1MzU2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/353566?v=4", "gravatar_id": "", "url": "https://api.github.com/users/giantryansaul", "html_url": "https://github.com/giantryansaul", "followers_url": "https://api.github.com/users/giantryansaul/followers", "following_url": "https://api.github.com/users/giantryansaul/following{/other_user}", "gists_url": "https://api.github.com/users/giantryansaul/gists{/gist_id}", "starred_url": "https://api.github.com/users/giantryansaul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/giantryansaul/subscriptions", "organizations_url": "https://api.github.com/users/giantryansaul/orgs", "repos_url": "https://api.github.com/users/giantryansaul/repos", "events_url": "https://api.github.com/users/giantryansaul/events{/privacy}", "received_events_url": "https://api.github.com/users/giantryansaul/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/locustio/locust/milestones/2", "html_url": "https://github.com/locustio/locust/milestone/2", "labels_url": "https://api.github.com/repos/locustio/locust/milestones/2/labels", "id": 1736327, "node_id": "MDk6TWlsZXN0b25lMTczNjMyNw==", "number": 2, "title": "0.7.4", "description": null, "creator": {"login": "justiniso", "id": 717862, "node_id": "MDQ6VXNlcjcxNzg2Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/717862?v=4", "gravatar_id": "", "url": "https://api.github.com/users/justiniso", "html_url": "https://github.com/justiniso", "followers_url": "https://api.github.com/users/justiniso/followers", "following_url": "https://api.github.com/users/justiniso/following{/other_user}", "gists_url": "https://api.github.com/users/justiniso/gists{/gist_id}", "starred_url": "https://api.github.com/users/justiniso/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/justiniso/subscriptions", "organizations_url": "https://api.github.com/users/justiniso/orgs", "repos_url": "https://api.github.com/users/justiniso/repos", "events_url": "https://api.github.com/users/justiniso/events{/privacy}", "received_events_url": "https://api.github.com/users/justiniso/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 3, "state": "closed", "created_at": "2016-04-28T13:40:43Z", "updated_at": "2019-10-20T19:48:04Z", "due_on": null, "closed_at": "2019-10-20T19:48:04Z"}, "comments": 3, "created_at": "2015-05-04T21:02:31Z", "updated_at": "2016-04-28T13:40:53Z", "closed_at": "2016-04-02T18:50:38Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I wanted to offer this up not as an issue, but as a solution to one that I found today.\n\nI had a test that when run on a specific server would always fail with this unhelpful message:\nrequests.exceptions.ConnectionError: ('Connection aborted.', ResponseNotReady('Request-sent',))\n\nThe test had multiple requests to the same client within a single task and a colleague suspected it was something to do with the connection from the first request not being properly closed.\n\nAfter a lot of playing around with timeouts and attempting to close out the first connection before the next one was sent (both of which did not solve the issue), I found a stackoverflow article with the same issue:\nhttp://stackoverflow.com/questions/30033516/single-session-multiple-post-get-in-python-requests\n\nThe quick and dirty solution was to update to requests 2.7.0. At the time of getting this error I was on 2.6.2. I also noticed that the default version for locust is on 2.4. If you are experiencing this issue, simply update to 2.7 and you should be good!\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/273/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/273/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/269", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/269/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/269/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/269/events", "html_url": "https://github.com/locustio/locust/issues/269", "id": 66585271, "node_id": "MDU6SXNzdWU2NjU4NTI3MQ==", "number": 269, "title": "Exceptions tab not working for on_start method", "user": {"login": "DataGreed", "id": 2033163, "node_id": "MDQ6VXNlcjIwMzMxNjM=", "avatar_url": "https://avatars.githubusercontent.com/u/2033163?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DataGreed", "html_url": "https://github.com/DataGreed", "followers_url": "https://api.github.com/users/DataGreed/followers", "following_url": "https://api.github.com/users/DataGreed/following{/other_user}", "gists_url": "https://api.github.com/users/DataGreed/gists{/gist_id}", "starred_url": "https://api.github.com/users/DataGreed/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DataGreed/subscriptions", "organizations_url": "https://api.github.com/users/DataGreed/orgs", "repos_url": "https://api.github.com/users/DataGreed/repos", "events_url": "https://api.github.com/users/DataGreed/events{/privacy}", "received_events_url": "https://api.github.com/users/DataGreed/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2015-04-06T11:27:05Z", "updated_at": "2019-10-18T15:27:10Z", "closed_at": "2019-10-18T15:27:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, \nwhenever I get an exceptions in some of the methods, I have it in the terminal output, but the exceptions tab in the web UI is empty. \n\nIf it's important, exceptions are thrown in `on_start` method.\n\nI'm using locust ver 0.7.2 (latest)\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/269/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/269/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/263", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/263/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/263/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/263/events", "html_url": "https://github.com/locustio/locust/issues/263", "id": 63219607, "node_id": "MDU6SXNzdWU2MzIxOTYwNw==", "number": 263, "title": "Template request name too long ", "user": {"login": "gillestasse", "id": 1451295, "node_id": "MDQ6VXNlcjE0NTEyOTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1451295?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gillestasse", "html_url": "https://github.com/gillestasse", "followers_url": "https://api.github.com/users/gillestasse/followers", "following_url": "https://api.github.com/users/gillestasse/following{/other_user}", "gists_url": "https://api.github.com/users/gillestasse/gists{/gist_id}", "starred_url": "https://api.github.com/users/gillestasse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gillestasse/subscriptions", "organizations_url": "https://api.github.com/users/gillestasse/orgs", "repos_url": "https://api.github.com/users/gillestasse/repos", "events_url": "https://api.github.com/users/gillestasse/events{/privacy}", "received_events_url": "https://api.github.com/users/gillestasse/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149037, "node_id": "MDU6TGFiZWwxNDkwMzc=", "url": "https://api.github.com/repos/locustio/locust/labels/web%20interface", "name": "web interface", "color": "0e8a16", "default": false, "description": null}, {"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-03-20T12:22:41Z", "updated_at": "2017-02-13T01:54:02Z", "closed_at": "2017-02-13T01:54:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "If it do :\n\n``` python\n_data={\"query\":'{\"animal\":{\"valnr\":\"\",\"nafn\":\"\",\"lambnum\":\"undefined\",\"birthyear\":\"\",\"kyn\":\"\",\"kynstada\":\"undefined\",\"afdrif\":\"\",\"status\":\"\",\"afdrif_lamb\":\"\",\"numlambs\":\"\",\"color\":\"\",\"color_char\":\"\",\"horn\":\"\",\"color_prop\":\"\",\"ram_type\":\"\",\"uppgjor\":\"\"},\"page\":\"1\",\"query\":\"normal\"}'}\nself.client.get(\"/search_animals_query\",params=_data)\n```\n\nI end up with a table:\n![image](https://cloud.githubusercontent.com/assets/1451295/6751469/580a47c4-cf04-11e4-85f7-635ed0fdf26b.png)\n\nBy adding : \n\n``` python\nstyle=\"white-space: nowrap; overflow: hidden;text-overflow: ellipsis; max-width: 200px;\"\n```\n\nIn index.html line 182 in the td tag. I got a better layout :\n![image](https://cloud.githubusercontent.com/assets/1451295/6751494/a7385e44-cf04-11e4-8bb2-c6de3fd82ab2.png)\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/263/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/263/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/254", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/254/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/254/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/254/events", "html_url": "https://github.com/locustio/locust/issues/254", "id": 61880430, "node_id": "MDU6SXNzdWU2MTg4MDQzMA==", "number": 254, "title": "Percentile response time anomalies at 100%", "user": {"login": "mblakele", "id": 101790, "node_id": "MDQ6VXNlcjEwMTc5MA==", "avatar_url": "https://avatars.githubusercontent.com/u/101790?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mblakele", "html_url": "https://github.com/mblakele", "followers_url": "https://api.github.com/users/mblakele/followers", "following_url": "https://api.github.com/users/mblakele/following{/other_user}", "gists_url": "https://api.github.com/users/mblakele/gists{/gist_id}", "starred_url": "https://api.github.com/users/mblakele/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mblakele/subscriptions", "organizations_url": "https://api.github.com/users/mblakele/orgs", "repos_url": "https://api.github.com/users/mblakele/repos", "events_url": "https://api.github.com/users/mblakele/events{/privacy}", "received_events_url": "https://api.github.com/users/mblakele/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-03-15T18:36:45Z", "updated_at": "2019-10-18T15:26:15Z", "closed_at": "2019-10-18T15:26:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "With locust 0.7.2 there seems to be a calculation problem with the `100%` column. It's often reported a few ms lower than the preceding columns, which should be impossible. In the example below it's especially glaring when there was only one request for a particular endpoint: `99%: 580; 100%: 575`. But I see a similar anomaly in the last line, which has 53 requests. In my data the anomalies seem to be common with less that 100 requests, but rare or at least invisible after that.\n\n```\nPercentage of the requests completed within given times\n Name                                                           # reqs    50%    66%    75%    80%    90%    95%    98%    99%   100%\n--------------------------------------------------------------------------------------------------------------------------------------------\n GET /                                                            5346     70     81     89     96    120    130    160    170    282\n GET /rankings/networks/search/1063/                                 1    660    660    660    660    660    660    660    660    661\n GET /rankings/networks/search/1067/                                 1    630    630    630    630    630    630    630    630    625\n GET /rankings/networks/search/1068/                                 1    580    580    580    580    580    580    580    580    575\n GET /terms_of_service/?next=/                                      53    430    580    760    830    890    940    960   1000    996\n```\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/254/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/254/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/237", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/237/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/237/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/237/events", "html_url": "https://github.com/locustio/locust/issues/237", "id": 55623938, "node_id": "MDU6SXNzdWU1NTYyMzkzOA==", "number": 237, "title": "ValueError when missing hatchrate", "user": {"login": "pawelmhm", "id": 2700942, "node_id": "MDQ6VXNlcjI3MDA5NDI=", "avatar_url": "https://avatars.githubusercontent.com/u/2700942?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pawelmhm", "html_url": "https://github.com/pawelmhm", "followers_url": "https://api.github.com/users/pawelmhm/followers", "following_url": "https://api.github.com/users/pawelmhm/following{/other_user}", "gists_url": "https://api.github.com/users/pawelmhm/gists{/gist_id}", "starred_url": "https://api.github.com/users/pawelmhm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pawelmhm/subscriptions", "organizations_url": "https://api.github.com/users/pawelmhm/orgs", "repos_url": "https://api.github.com/users/pawelmhm/repos", "events_url": "https://api.github.com/users/pawelmhm/events{/privacy}", "received_events_url": "https://api.github.com/users/pawelmhm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149037, "node_id": "MDU6TGFiZWwxNDkwMzc=", "url": "https://api.github.com/repos/locustio/locust/labels/web%20interface", "name": "web interface", "color": "0e8a16", "default": false, "description": null}, {"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}, {"id": 2115072627, "node_id": "MDU6TGFiZWwyMTE1MDcyNjI3", "url": "https://api.github.com/repos/locustio/locust/labels/non-critical", "name": "non-critical", "color": "c4e4c9", "default": false, "description": ""}, {"id": 2905306938, "node_id": "MDU6TGFiZWwyOTA1MzA2OTM4", "url": "https://api.github.com/repos/locustio/locust/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Issue had no activity. Might still be worth fixing, but dont expect someone else to fix it"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2015-01-27T14:27:51Z", "updated_at": "2021-06-21T01:55:28Z", "closed_at": "2021-06-21T01:55:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "Not a big deal, but if you forget to specify hatch_rate in web interface you'll get ugly exception in logs, flask app could check for blank values in form and return some friendly error message to client\n\n```\n[2015-01-27 15:16:56,474] pawel-All-Series/ERROR/stderr: Traceback (most recent call last):\n[2015-01-27 15:16:56,474] pawel-All-Series/ERROR/stderr: File \"/usr/local/lib/python2.7/dist-packages/gevent/pywsgi.py\", line 508, in handle_one_response\n[2015-01-27 15:16:56,474] pawel-All-Series/ERROR/stderr: self.run_application()\n[2015-01-27 15:16:56,474] pawel-All-Series/ERROR/stderr: File \"/usr/local/lib/python2.7/dist-packages/gevent/pywsgi.py\", line 494, in run_application\n[2015-01-27 15:16:56,474] pawel-All-Series/ERROR/stderr: self.result = self.application(self.environ, self.start_response)\n[2015-01-27 15:16:56,474] pawel-All-Series/ERROR/stderr: File \"/home/pawel/py/flask/flask/app.py\", line 1903, in __call__\n[2015-01-27 15:16:56,555] pawel-All-Series/ERROR/stderr: return self.wsgi_app(environ, start_response)\n[2015-01-27 15:16:56,555] pawel-All-Series/ERROR/stderr: File \"/home/pawel/py/flask/flask/app.py\", line 1887, in wsgi_app\n[2015-01-27 15:16:56,555] pawel-All-Series/ERROR/stderr: response = self.make_response(self.handle_exception(e))\n[2015-01-27 15:16:56,555] pawel-All-Series/ERROR/stderr: File \"/home/pawel/py/flask/flask/app.py\", line 1465, in handle_exception\n[2015-01-27 15:16:56,555] pawel-All-Series/ERROR/stderr: reraise(exc_type, exc_value, tb)\n[2015-01-27 15:16:56,555] pawel-All-Series/ERROR/stderr: File \"/home/pawel/py/flask/flask/app.py\", line 1884, in wsgi_app\n[2015-01-27 15:16:56,555] pawel-All-Series/ERROR/stderr: response = self.full_dispatch_request()\n[2015-01-27 15:16:56,555] pawel-All-Series/ERROR/stderr: File \"/home/pawel/py/flask/flask/app.py\", line 1539, in full_dispatch_request\n[2015-01-27 15:16:56,555] pawel-All-Series/ERROR/stderr: rv = self.handle_user_exception(e)\n[2015-01-27 15:16:56,555] pawel-All-Series/ERROR/stderr: File \"/home/pawel/py/flask/flask/app.py\", line 1443, in handle_user_exception\n[2015-01-27 15:16:56,555] pawel-All-Series/ERROR/stderr: reraise(exc_type, exc_value, tb)\n[2015-01-27 15:16:56,555] pawel-All-Series/ERROR/stderr: File \"/home/pawel/py/flask/flask/app.py\", line 1537, in full_dispatch_request\n[2015-01-27 15:16:56,555] pawel-All-Series/ERROR/stderr: rv = self.dispatch_request()\n[2015-01-27 15:16:56,555] pawel-All-Series/ERROR/stderr: File \"/home/pawel/py/flask/flask/app.py\", line 1523, in dispatch_request\n[2015-01-27 15:16:56,555] pawel-All-Series/ERROR/stderr: return self.view_functions[rule.endpoint](**req.view_args)\n[2015-01-27 15:16:56,555] pawel-All-Series/ERROR/stderr: File \"/usr/local/lib/python2.7/dist-packages/locust/web.py\", line 50, in swarm\n[2015-01-27 15:16:56,555] pawel-All-Series/ERROR/stderr: hatch_rate = float(request.form[\"hatch_rate\"])\n[2015-01-27 15:16:56,555] pawel-All-Series/ERROR/stderr: ValueError: could not convert string to float:\n[2015-01-27 15:16:56,559] pawel-All-Series/ERROR/stderr: {'CONTENT_LENGTH': '27',\n```\n\nOverall locust is great though.\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/237/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/237/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/163", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/163/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/163/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/163/events", "html_url": "https://github.com/locustio/locust/issues/163", "id": 34517541, "node_id": "MDU6SXNzdWUzNDUxNzU0MQ==", "number": 163, "title": "log.py's StdErrWrapper swallows fatal stacktraces", "user": {"login": "jpotter", "id": 532530, "node_id": "MDQ6VXNlcjUzMjUzMA==", "avatar_url": "https://avatars.githubusercontent.com/u/532530?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jpotter", "html_url": "https://github.com/jpotter", "followers_url": "https://api.github.com/users/jpotter/followers", "following_url": "https://api.github.com/users/jpotter/following{/other_user}", "gists_url": "https://api.github.com/users/jpotter/gists{/gist_id}", "starred_url": "https://api.github.com/users/jpotter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jpotter/subscriptions", "organizations_url": "https://api.github.com/users/jpotter/orgs", "repos_url": "https://api.github.com/users/jpotter/repos", "events_url": "https://api.github.com/users/jpotter/events{/privacy}", "received_events_url": "https://api.github.com/users/jpotter/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2014-05-28T23:47:45Z", "updated_at": "2019-10-20T22:04:10Z", "closed_at": "2019-10-20T22:04:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "In the condition where there's a python error in the locust file, the stack trace is swallowed by the StdErrWrapper.\n\nIn main.py, the code imports the locust file:\n    imported = **import**(os.path.splitext(locustfile)[0])\nwithout a try/catch block.\n\nOne possibility is to try/catch around this, and logging the stack trace there, but the try block would have to explicitly list things like IOError, KeyError, etc as Error exceptions are not caught by an unbounded \"except\" clause. The other possibility is to not wrap STDERR, and leave any prints to sys.stderr as something to be handled by the supervisor that's managing the process.\n\nThis is actually a really annoyance: anytime we have an issue in any library of ours, there's no way to see the stacktrace; locust just instantly exits 1 with no info as to the cause.\n\nWhat's the suggested way to fix this?\n\nThanks,\nJeff\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/163/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/163/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/146", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/146/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/146/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/146/events", "html_url": "https://github.com/locustio/locust/issues/146", "id": 32448570, "node_id": "MDU6SXNzdWUzMjQ0ODU3MA==", "number": 146, "title": "locust stuck in hatching state", "user": {"login": "sanga", "id": 2088, "node_id": "MDQ6VXNlcjIwODg=", "avatar_url": "https://avatars.githubusercontent.com/u/2088?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanga", "html_url": "https://github.com/sanga", "followers_url": "https://api.github.com/users/sanga/followers", "following_url": "https://api.github.com/users/sanga/following{/other_user}", "gists_url": "https://api.github.com/users/sanga/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanga/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanga/subscriptions", "organizations_url": "https://api.github.com/users/sanga/orgs", "repos_url": "https://api.github.com/users/sanga/repos", "events_url": "https://api.github.com/users/sanga/events{/privacy}", "received_events_url": "https://api.github.com/users/sanga/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2014-04-29T14:13:43Z", "updated_at": "2019-11-01T16:58:38Z", "closed_at": "2019-11-01T16:58:38Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "we're not quite sure how we got into this state but in any case, our locust is currently stuck in hatching state. I've clicked stop and it's still hatching (with statistics updating). Also starting a new test seems to not have any effect.\n\nI'll try to see if I can figure a minimal set of steps to repro this, but in the mean time any ideas on how to debug this? Wild stab in the dark, but perhaps it's something like:\n- hit stop\n- locust starts stopping\n- start a new run whilst locust is still telling it's slaves to shut down?\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/146/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/146/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/138", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/138/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/138/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/138/events", "html_url": "https://github.com/locustio/locust/issues/138", "id": 30877716, "node_id": "MDU6SXNzdWUzMDg3NzcxNg==", "number": 138, "title": "Test file can not be named locust.py (or any other name that is the same as an existing python package)", "user": {"login": "user1020", "id": 1478660, "node_id": "MDQ6VXNlcjE0Nzg2NjA=", "avatar_url": "https://avatars.githubusercontent.com/u/1478660?v=4", "gravatar_id": "", "url": "https://api.github.com/users/user1020", "html_url": "https://github.com/user1020", "followers_url": "https://api.github.com/users/user1020/followers", "following_url": "https://api.github.com/users/user1020/following{/other_user}", "gists_url": "https://api.github.com/users/user1020/gists{/gist_id}", "starred_url": "https://api.github.com/users/user1020/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/user1020/subscriptions", "organizations_url": "https://api.github.com/users/user1020/orgs", "repos_url": "https://api.github.com/users/user1020/repos", "events_url": "https://api.github.com/users/user1020/events{/privacy}", "received_events_url": "https://api.github.com/users/user1020/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2014-04-04T17:08:26Z", "updated_at": "2017-02-20T16:32:59Z", "closed_at": "2017-02-20T16:32:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "Thanks for writing the locust test tool. It's very interesting!\n\nI follow the instruction on http://locust.io/,  first I installed \n\n```\npip install locustio\npip install pyzmq\n```\n\nThen I copied and pasted the sample \"Simple example\" to  locust.py in my local directory and run it against a server listening on another PC (10.3.0.3) as the following but got error:\n\n```\n locust -f locust.py -H http://10.3.0.3\n[2014-04-04 12:03:28,901] john-HP/ERROR/locust.main: No Locust class found!\n```\n\nNot sure what have gone wrong. \n\nThanks. \n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/138/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/138/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/62", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/62/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/62/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/62/events", "html_url": "https://github.com/locustio/locust/issues/62", "id": 12571605, "node_id": "MDU6SXNzdWUxMjU3MTYwNQ==", "number": 62, "title": "Slave count doesn't get updated in the UI if no more slaves are alive", "user": {"login": "bogdangherca", "id": 1877030, "node_id": "MDQ6VXNlcjE4NzcwMzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1877030?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bogdangherca", "html_url": "https://github.com/bogdangherca", "followers_url": "https://api.github.com/users/bogdangherca/followers", "following_url": "https://api.github.com/users/bogdangherca/following{/other_user}", "gists_url": "https://api.github.com/users/bogdangherca/gists{/gist_id}", "starred_url": "https://api.github.com/users/bogdangherca/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bogdangherca/subscriptions", "organizations_url": "https://api.github.com/users/bogdangherca/orgs", "repos_url": "https://api.github.com/users/bogdangherca/repos", "events_url": "https://api.github.com/users/bogdangherca/events{/privacy}", "received_events_url": "https://api.github.com/users/bogdangherca/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2013-03-28T16:15:05Z", "updated_at": "2019-10-18T15:36:44Z", "closed_at": "2019-10-18T15:36:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\n\nI was running some simple tests with locust (which is so cool btw) and I noticed that if you end up with no slaves connected, the UI does not reflect this change. The slave count in the UI sticks to 1 in this case.\nAlso, it would be nice to get a warning message in the webUI if you start swarming with no slaves connected. Now, you get this warning only in the command line.\n\nI could provide a quick fix for this if you'd like.\n\nThanks!\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/62/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/62/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/49", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/49/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/49/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/49/events", "html_url": "https://github.com/locustio/locust/issues/49", "id": 9380394, "node_id": "MDU6SXNzdWU5MzgwMzk0", "number": 49, "title": "gc refcount related crash when loading web UI under Python 2.6.6", "user": {"login": "daubman", "id": 574823, "node_id": "MDQ6VXNlcjU3NDgyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/574823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daubman", "html_url": "https://github.com/daubman", "followers_url": "https://api.github.com/users/daubman/followers", "following_url": "https://api.github.com/users/daubman/following{/other_user}", "gists_url": "https://api.github.com/users/daubman/gists{/gist_id}", "starred_url": "https://api.github.com/users/daubman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daubman/subscriptions", "organizations_url": "https://api.github.com/users/daubman/orgs", "repos_url": "https://api.github.com/users/daubman/repos", "events_url": "https://api.github.com/users/daubman/events{/privacy}", "received_events_url": "https://api.github.com/users/daubman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2012-12-18T20:18:01Z", "updated_at": "2013-01-10T09:46:29Z", "closed_at": "2013-01-10T09:46:29Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Running under Python 2.6.6 (Centos 6.3) I get the following crash as soon as I try and load the web UI. This seems to work fine using Python 2.7.3 as an altinstall on the same host. I have seen this on two different Centos 6.3 hosts...\n\n--snip--\n$ /usr/bin/locust -f some_locust_script.py \n/usr/lib/python2.6/site-packages/locust/rpc/**init**.py:7: UserWarning: WARNING: Using pure Python socket RPC implementation instead of zmq. This will not affect you if your not running locust in distributed mode, but if you are, we recommend you to install the python packages: pyzmq and gevent-zeromq\n  warnings.warn(\"WARNING: Using pure Python socket RPC implementation instead of zmq. This will not affect you if your not running locust in distributed mode, but if you are, we recommend you to install the python packages: pyzmq and gevent-zeromq\")\n[2012-12-18 15:14:52,705] INFO/locust.main: Starting web monitor on port 8089\n[2012-12-18 15:14:52,705] INFO/locust.main: Starting Locust 0.6.1\nModules/gcmodule.c:348: visit_decref: Assertion \"gc->gc.gc_refs != 0\" failed.\nrefcount was too small\nobject  : <weakref at 0x15b1db8; to 'gevent.core.http_request' at 0x15b1d60>\ntype    : weakref\nrefcount: 1\naddress : 0x15b1db8\nAborted\n--snip--\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/49/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/49/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/15", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/15/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/15/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/15/events", "html_url": "https://github.com/locustio/locust/issues/15", "id": 2794880, "node_id": "MDU6SXNzdWUyNzk0ODgw", "number": 15, "title": "Master node fails to start if a slave node is still running", "user": {"login": "Jahaja", "id": 138786, "node_id": "MDQ6VXNlcjEzODc4Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/138786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jahaja", "html_url": "https://github.com/Jahaja", "followers_url": "https://api.github.com/users/Jahaja/followers", "following_url": "https://api.github.com/users/Jahaja/following{/other_user}", "gists_url": "https://api.github.com/users/Jahaja/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jahaja/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jahaja/subscriptions", "organizations_url": "https://api.github.com/users/Jahaja/orgs", "repos_url": "https://api.github.com/users/Jahaja/repos", "events_url": "https://api.github.com/users/Jahaja/events{/privacy}", "received_events_url": "https://api.github.com/users/Jahaja/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2012-01-10T18:35:10Z", "updated_at": "2012-11-27T11:59:12Z", "closed_at": "2012-11-27T11:59:12Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Well, as the title suggests it's pretty straight forward to reproduce the problem. The actual problem is perhaps more that the slave node doesn't exit when the master does so.\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/15/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/15/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/9", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/9/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/9/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/9/events", "html_url": "https://github.com/locustio/locust/issues/9", "id": 1577903, "node_id": "MDU6SXNzdWUxNTc3OTAz", "number": 9, "title": "Total RPS counter does not work", "user": {"login": "heyman", "id": 54217, "node_id": "MDQ6VXNlcjU0MjE3", "avatar_url": "https://avatars.githubusercontent.com/u/54217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/heyman", "html_url": "https://github.com/heyman", "followers_url": "https://api.github.com/users/heyman/followers", "following_url": "https://api.github.com/users/heyman/following{/other_user}", "gists_url": "https://api.github.com/users/heyman/gists{/gist_id}", "starred_url": "https://api.github.com/users/heyman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/heyman/subscriptions", "organizations_url": "https://api.github.com/users/heyman/orgs", "repos_url": "https://api.github.com/users/heyman/repos", "events_url": "https://api.github.com/users/heyman/events{/privacy}", "received_events_url": "https://api.github.com/users/heyman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2011-09-06T12:42:30Z", "updated_at": "2011-09-06T12:54:08Z", "closed_at": "2011-09-06T12:54:08Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/9/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/9/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/7", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/7/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/7/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/7/events", "html_url": "https://github.com/locustio/locust/issues/7", "id": 1573229, "node_id": "MDU6SXNzdWUxNTczMjI5", "number": 7, "title": "Total median value is zero in the web interface", "user": {"login": "heyman", "id": 54217, "node_id": "MDQ6VXNlcjU0MjE3", "avatar_url": "https://avatars.githubusercontent.com/u/54217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/heyman", "html_url": "https://github.com/heyman", "followers_url": "https://api.github.com/users/heyman/followers", "following_url": "https://api.github.com/users/heyman/following{/other_user}", "gists_url": "https://api.github.com/users/heyman/gists{/gist_id}", "starred_url": "https://api.github.com/users/heyman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/heyman/subscriptions", "organizations_url": "https://api.github.com/users/heyman/orgs", "repos_url": "https://api.github.com/users/heyman/repos", "events_url": "https://api.github.com/users/heyman/events{/privacy}", "received_events_url": "https://api.github.com/users/heyman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149037, "node_id": "MDU6TGFiZWwxNDkwMzc=", "url": "https://api.github.com/repos/locustio/locust/labels/web%20interface", "name": "web interface", "color": "0e8a16", "default": false, "description": null}, {"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2011-09-05T20:35:42Z", "updated_at": "2011-09-19T12:09:14Z", "closed_at": "2011-09-19T12:09:14Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This is an intentional temporary bug. It's still present in the request stats CSV.\n\nShould be fixed, perhaps by just taking the average of the already calculated median for each URL.\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/7/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/7/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/5", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/5/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/5/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/5/events", "html_url": "https://github.com/locustio/locust/issues/5", "id": 1572632, "node_id": "MDU6SXNzdWUxNTcyNjMy", "number": 5, "title": "Wrong failure percentage in statistics", "user": {"login": "heyman", "id": 54217, "node_id": "MDQ6VXNlcjU0MjE3", "avatar_url": "https://avatars.githubusercontent.com/u/54217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/heyman", "html_url": "https://github.com/heyman", "followers_url": "https://api.github.com/users/heyman/followers", "following_url": "https://api.github.com/users/heyman/following{/other_user}", "gists_url": "https://api.github.com/users/heyman/gists{/gist_id}", "starred_url": "https://api.github.com/users/heyman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/heyman/subscriptions", "organizations_url": "https://api.github.com/users/heyman/orgs", "repos_url": "https://api.github.com/users/heyman/repos", "events_url": "https://api.github.com/users/heyman/events{/privacy}", "received_events_url": "https://api.github.com/users/heyman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149037, "node_id": "MDU6TGFiZWwxNDkwMzc=", "url": "https://api.github.com/repos/locustio/locust/labels/web%20interface", "name": "web interface", "color": "0e8a16", "default": false, "description": null}, {"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2011-09-05T18:36:23Z", "updated_at": "2011-11-07T14:09:48Z", "closed_at": "2011-11-07T14:09:48Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/5/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/5/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/locustio/locust/issues/4", "repository_url": "https://api.github.com/repos/locustio/locust", "labels_url": "https://api.github.com/repos/locustio/locust/issues/4/labels{/name}", "comments_url": "https://api.github.com/repos/locustio/locust/issues/4/comments", "events_url": "https://api.github.com/repos/locustio/locust/issues/4/events", "html_url": "https://github.com/locustio/locust/issues/4", "id": 1569884, "node_id": "MDU6SXNzdWUxNTY5ODg0", "number": 4, "title": "Raising InterruptLocust within with statement + catch_response causes failure", "user": {"login": "heyman", "id": 54217, "node_id": "MDQ6VXNlcjU0MjE3", "avatar_url": "https://avatars.githubusercontent.com/u/54217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/heyman", "html_url": "https://github.com/heyman", "followers_url": "https://api.github.com/users/heyman/followers", "following_url": "https://api.github.com/users/heyman/following{/other_user}", "gists_url": "https://api.github.com/users/heyman/gists{/gist_id}", "starred_url": "https://api.github.com/users/heyman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/heyman/subscriptions", "organizations_url": "https://api.github.com/users/heyman/orgs", "repos_url": "https://api.github.com/users/heyman/repos", "events_url": "https://api.github.com/users/heyman/events{/privacy}", "received_events_url": "https://api.github.com/users/heyman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149062, "node_id": "MDU6TGFiZWwxNDkwNjI=", "url": "https://api.github.com/repos/locustio/locust/labels/bug", "name": "bug", "color": "e10c02", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "heyman", "id": 54217, "node_id": "MDQ6VXNlcjU0MjE3", "avatar_url": "https://avatars.githubusercontent.com/u/54217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/heyman", "html_url": "https://github.com/heyman", "followers_url": "https://api.github.com/users/heyman/followers", "following_url": "https://api.github.com/users/heyman/following{/other_user}", "gists_url": "https://api.github.com/users/heyman/gists{/gist_id}", "starred_url": "https://api.github.com/users/heyman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/heyman/subscriptions", "organizations_url": "https://api.github.com/users/heyman/orgs", "repos_url": "https://api.github.com/users/heyman/repos", "events_url": "https://api.github.com/users/heyman/events{/privacy}", "received_events_url": "https://api.github.com/users/heyman/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "heyman", "id": 54217, "node_id": "MDQ6VXNlcjU0MjE3", "avatar_url": "https://avatars.githubusercontent.com/u/54217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/heyman", "html_url": "https://github.com/heyman", "followers_url": "https://api.github.com/users/heyman/followers", "following_url": "https://api.github.com/users/heyman/following{/other_user}", "gists_url": "https://api.github.com/users/heyman/gists{/gist_id}", "starred_url": "https://api.github.com/users/heyman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/heyman/subscriptions", "organizations_url": "https://api.github.com/users/heyman/orgs", "repos_url": "https://api.github.com/users/heyman/repos", "events_url": "https://api.github.com/users/heyman/events{/privacy}", "received_events_url": "https://api.github.com/users/heyman/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2011-09-05T15:25:04Z", "updated_at": "2011-09-05T21:18:44Z", "closed_at": "2011-09-05T21:18:44Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Raising an InterruptLocust exception within a with statement when using catch_response=True will result in a request failure\n", "reactions": {"url": "https://api.github.com/repos/locustio/locust/issues/4/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/locustio/locust/issues/4/timeline", "performed_via_github_app": null, "state_reason": "completed"}]