[{"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2773", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2773/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2773/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2773/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/2773", "id": 1593756040, "node_id": "I_kwDOAQ3rIc5e_smI", "number": 2773, "title": "pre-commit can delete/revert unstaged files if error occurs during git diff-index", "user": {"login": "strubbly", "id": 48478338, "node_id": "MDQ6VXNlcjQ4NDc4MzM4", "avatar_url": "https://avatars.githubusercontent.com/u/48478338?v=4", "gravatar_id": "", "url": "https://api.github.com/users/strubbly", "html_url": "https://github.com/strubbly", "followers_url": "https://api.github.com/users/strubbly/followers", "following_url": "https://api.github.com/users/strubbly/following{/other_user}", "gists_url": "https://api.github.com/users/strubbly/gists{/gist_id}", "starred_url": "https://api.github.com/users/strubbly/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/strubbly/subscriptions", "organizations_url": "https://api.github.com/users/strubbly/orgs", "repos_url": "https://api.github.com/users/strubbly/repos", "events_url": "https://api.github.com/users/strubbly/events{/privacy}", "received_events_url": "https://api.github.com/users/strubbly/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-02-21T16:18:01Z", "updated_at": "2023-02-21T17:30:35Z", "closed_at": "2023-02-21T17:30:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "### search you tried in the issue tracker\n\ndiff-index\n\n### describe your issue\n\nI performed a git commit with some modifications unstaged.  After the commit, most of the modifications had been reverted and my work was lost.  The diff saved in the patch directory had only a few of the modifications in - the ones that survived. The rest were gone.\r\n\r\nTo reproduce:\r\n- Modify four files and stage one with `git add`\r\n- Use `git status` to determine the order of the three unstaged files.\r\n- Change the permission on the middle one so that git will not be able to read it\r\n- Now do `git commit`: the changes to the first unstaged file will be preserved but the other two will be lost.\r\n\r\nThe key point, I think, is that the code in `staged_files_only.py` checks that the return code when creating the diff is non-zero which it takes to mean that the code is `1` meaning that there were diffs.   However, in this case the return code is `128` which *is* non-zero but does _not_ mean success - it means error.  So the code assumes the diff is OK even though it is incomplete.\n\n### pre-commit --version\n\n2.17.0\n\n### .pre-commit-config.yaml\n\n```yaml\nrepos:\r\n- repo: https://github.com/pre-commit/pre-commit-hooks\r\n  rev: 56b4a7e506901ff86f8de5c2551bc41f8eacf717\r\n  hooks:\r\n     -   id: check-yaml\r\n#     -   id: end-of-file-fixer\r\n     -   id: trailing-whitespace\r\n- repo: https://github.com/psf/black\r\n  rev: 21.11b0\r\n  hooks:\r\n    -   id: black\r\n        language_version: python3.6\r\n- repo: https://github.com/PyCQA/isort\r\n  rev: 5.10.1\r\n  hooks:\r\n    -   id: isort\r\n        args: [\"--profile\", \"black\", \"--filter-files\"]\n```\n\n\n### ~/.cache/pre-commit/pre-commit.log (if present)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2773/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2773/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2742", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2742/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2742/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2742/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/2742", "id": 1567821863, "node_id": "I_kwDOAQ3rIc5dcxAn", "number": 2742, "title": "Binary file change by hook not detected due to Git textconv", "user": {"login": "adamchainz", "id": 857609, "node_id": "MDQ6VXNlcjg1NzYwOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/857609?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adamchainz", "html_url": "https://github.com/adamchainz", "followers_url": "https://api.github.com/users/adamchainz/followers", "following_url": "https://api.github.com/users/adamchainz/following{/other_user}", "gists_url": "https://api.github.com/users/adamchainz/gists{/gist_id}", "starred_url": "https://api.github.com/users/adamchainz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adamchainz/subscriptions", "organizations_url": "https://api.github.com/users/adamchainz/orgs", "repos_url": "https://api.github.com/users/adamchainz/repos", "events_url": "https://api.github.com/users/adamchainz/events{/privacy}", "received_events_url": "https://api.github.com/users/adamchainz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-02-02T11:00:55Z", "updated_at": "2023-02-14T00:57:46Z", "closed_at": "2023-02-03T17:05:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### search you tried in the issue tracker\n\ntextconv\n\n### describe your issue\n\nI\u2019ve set up Git to use `exiftool` as a text conversion filter for JPEGs, with this in `~/.config/git/config`:\r\n\r\n```ini\r\n[diff \"exiftool\"]\r\n    textconv = exiftool --composite -x 'Exiftool:*' -x 'File:*' -g0\r\n    cachetextconv = true\r\n    xfuncname = \"^-.*$\"\r\n```\r\n\r\n\u2026and this in `~/.config/git/attributes`:\r\n\r\n```\r\n*.jpeg diff=exiftool\r\n```\r\n\r\nIn my repo, I\u2019m using `jpegoptim` to optimize JPEG's with the below `.pre-commit-config.yaml`.\r\n\r\nTake an unoptimized JPEG:\r\n\r\n```console\r\n$ git status\r\nOn branch main\r\nChanges to be committed:\r\n        new file:   donut.jpeg\r\n```\r\n\r\nRunning pre-commit, the hook passes:\r\n\r\n```console\r\n$ pre-commit run jpegoptim\r\nOptimize JPEGs...........................................................Passed\r\n```\r\n\r\n(There\u2019s no option to make `jpegoptim` exit with a non-zero status code when it changes files.)\r\n\r\nHowever, the tool did actually modify the image:\r\n\r\n```console\r\n$ git status\r\nOn branch main\r\nChanges to be committed:\r\n        new file:   donut.jpeg\r\n\r\nChanges not staged for commit:\r\n        modified:   donut.jpeg\r\n```\r\n\r\nThis behaviour means commits don't include the optimized version of a flie, instead they\u2019re left around unstaged.\r\n\r\npre-commit doesn't detect the change because the text conversions of the binary file before/after are the same, leading to an empty diff:\r\n\r\n```\r\n$ git diff donut.jpeg\r\n```\r\n\r\nBut using [`--no-textconv`](https://git-scm.com/docs/git-diff#Documentation/git-diff.txt---no-textconv) shows the tool actually made a change:\r\n\r\n$ git diff --no-textconv donut.jpeg |cat\r\ndiff --git a/donut.jpeg b/donut.jpeg\r\nindex 3bd0743..d66a2f4 100644\r\nBinary files a/donut.jpeg and b/donut.jpeg differ\r\n```\r\n\r\nThe `git diff` call that pre-commit uses to check for changes, in [`_git_diff()`](https://github.com/pre-commit/pre-commit/blob/e846829992a84ce8066e6513a72a357709eec56c/pre_commit/commands/run.py#L273C6-L277) already uses `--no-ext-diff` to make diffs reproducible\r\nI think it should also use `--no-textconv`.\r\nThis would also make it a little faster.\n\n### pre-commit --version\n\n3.0.3 / main\n\n### .pre-commit-config.yaml\n\n```yaml\nrepos:\r\n-   repo: local\r\n    hooks:\r\n    -   id: jpegoptim\r\n        name: Optimize JPEGs\r\n        entry: jpegoptim\r\n        language: system\r\n        types: [jpeg]\n```\n\n\n### ~/.cache/pre-commit/pre-commit.log (if present)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2742/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2742/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2739", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2739/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2739/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2739/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/2739", "id": 1566937748, "node_id": "I_kwDOAQ3rIc5dZZKU", "number": 2739, "title": "/dev/null not found with pre-commit 3.0.2", "user": {"login": "Roguelazer", "id": 263424, "node_id": "MDQ6VXNlcjI2MzQyNA==", "avatar_url": "https://avatars.githubusercontent.com/u/263424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Roguelazer", "html_url": "https://github.com/Roguelazer", "followers_url": "https://api.github.com/users/Roguelazer/followers", "following_url": "https://api.github.com/users/Roguelazer/following{/other_user}", "gists_url": "https://api.github.com/users/Roguelazer/gists{/gist_id}", "starred_url": "https://api.github.com/users/Roguelazer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Roguelazer/subscriptions", "organizations_url": "https://api.github.com/users/Roguelazer/orgs", "repos_url": "https://api.github.com/users/Roguelazer/repos", "events_url": "https://api.github.com/users/Roguelazer/events{/privacy}", "received_events_url": "https://api.github.com/users/Roguelazer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 352542360, "node_id": "MDU6TGFiZWwzNTI1NDIzNjA=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/ruby", "name": "ruby", "color": "cc342d", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-02-01T22:25:42Z", "updated_at": "2023-02-01T23:22:33Z", "closed_at": "2023-02-01T23:19:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "### search you tried in the issue tracker\n\n/dev/null\n\n### describe your issue\n\nAfter upgrading to pre-commit 3.0.2, one of my users (on up-to-date macos) is reporting that invoking ruby actions fails with `/dev/null` not found.\r\n\r\nRelevant output:\r\n\r\n```\r\nrubocop..................................................................Failed\r\n- hook id: rubocop\r\n- exit code: 2\r\n\r\n/dev/null not found\r\n/Users/user/.rvm/rubies/ruby-3.1.3/lib/ruby/3.1.0/bundler/definition.rb:36:in `build'\r\n/Users/user/.rvm/rubies/ruby-3.1.3/lib/ruby/3.1.0/bundler.rb:207:in `definition'\r\n/Users/user/.rvm/rubies/ruby-3.1.3/lib/ruby/3.1.0/bundler.rb:190:in `load'\r\n/Users/user/.cache/pre-commit/repojquw8lys/rbenv-default/gems/gems/rubocop-1.42.0/lib/rubocop/config_loader_resolver.rb:270:in `gem_config_path'\r\n/Users/user/.cache/pre-commit/repojquw8lys/rbenv-default/gems/gems/rubocop-1.42.0/lib/rubocop/config_loader_resolver.rb:65:in `block (2 levels) in resolve_inheritance_from_gems'\r\n/Users/user/.cache/pre-commit/repojquw8lys/rbenv-default/gems/gems/rubocop-1.42.0/lib/rubocop/config_loader_resolver.rb:63:in `reverse_each'\r\n/Users/user/.cache/pre-commit/repojquw8lys/rbenv-default/gems/gems/rubocop-1.42.0/lib/rubocop/config_loader_resolver.rb:63:in `block in resolve_inheritance_from_gems'\r\n/Users/user/.cache/pre-commit/repojquw8lys/rbenv-default/gems/gems/rubocop-1.42.0/lib/rubocop/config_loader_resolver.rb:57:in `each_pair'\r\n/Users/user/.cache/pre-commit/repojquw8lys/rbenv-default/gems/gems/rubocop-1.42.0/lib/rubocop/config_loader_resolver.rb:57:in `resolve_inheritance_from_gems'\r\n/Users/user/.cache/pre-commit/repojquw8lys/rbenv-default/gems/gems/rubocop-1.42.0/lib/rubocop/config_loader.rb:49:in `load_file'\r\n/Users/user/.cache/pre-commit/repojquw8lys/rbenv-default/gems/gems/rubocop-1.42.0/lib/rubocop/config_loader.rb:104:in `configuration_from_file'\r\n/Users/user/.cache/pre-commit/repojquw8lys/rbenv-default/gems/gems/rubocop-1.42.0/lib/rubocop/config_store.rb:68:in `for_dir'\r\n/Users/user/.cache/pre-commit/repojquw8lys/rbenv-default/gems/gems/rubocop-1.42.0/lib/rubocop/config_store.rb:47:in `for_pwd'\r\n/Users/user/.cache/pre-commit/repojquw8lys/rbenv-default/gems/gems/rubocop-1.42.0/lib/rubocop/cli.rb:147:in `apply_default_formatter'\r\n/Users/user/.cache/pre-commit/repojquw8lys/rbenv-default/gems/gems/rubocop-1.42.0/lib/rubocop/cli.rb:47:in `run'\r\n/Users/user/.cache/pre-commit/repojquw8lys/rbenv-default/gems/gems/rubocop-1.42.0/exe/rubocop:19:in `block in <top (required)>'\r\n/Users/user/.rvm/rubies/ruby-3.1.3/lib/ruby/3.1.0/benchmark.rb:311:in `realtime'\r\n/Users/user/.cache/pre-commit/repojquw8lys/rbenv-default/gems/gems/rubocop-1.42.0/exe/rubocop:19:in `<top (required)>'\r\n/Users/user/.cache/pre-commit/repojquw8lys/rbenv-default/gems/bin/rubocop:25:in `load'\r\n/Users/user/.cache/pre-commit/repojquw8lys/rbenv-default/gems/bin/rubocop:25:in `<main>'\r\n/Users/user/.cache/pre-commit/repojquw8lys/rbenv-default/gems/bin/ruby_executable_hooks:22:in `eval'\r\n/Users/user/.cache/pre-commit/repojquw8lys/rbenv-default/gems/bin/ruby_executable_hooks:22:in `<main>'\r\n```\r\n\r\nThis looks closely related to #2727.\r\n\r\nFor what it's worth, I did confirm that the user actually has a working `/dev/null` on their system.\n\n### pre-commit --version\n\npre-commit 3.0.2\n\n### .pre-commit-config.yaml\n\n```yaml\nrepos:\r\n- repo: https://github.com/rubocop/rubocop.git\r\n  rev: '0f7416a0b3ea4a3d4edb1f2091ce8706ea3e6640'\r\n  hooks:\r\n    - id: rubocop\r\n      additional_dependencies: [\"standard:1.22.1\"]\n```\n\n\n### ~/.cache/pre-commit/pre-commit.log (if present)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2739/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2739/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2599", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2599/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2599/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2599/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/2599", "id": 1451833002, "node_id": "I_kwDOAQ3rIc5WiTaq", "number": 2599, "title": "Rscript not found in Windows", "user": {"login": "SInginc", "id": 49294745, "node_id": "MDQ6VXNlcjQ5Mjk0NzQ1", "avatar_url": "https://avatars.githubusercontent.com/u/49294745?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SInginc", "html_url": "https://github.com/SInginc", "followers_url": "https://api.github.com/users/SInginc/followers", "following_url": "https://api.github.com/users/SInginc/following{/other_user}", "gists_url": "https://api.github.com/users/SInginc/gists{/gist_id}", "starred_url": "https://api.github.com/users/SInginc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SInginc/subscriptions", "organizations_url": "https://api.github.com/users/SInginc/orgs", "repos_url": "https://api.github.com/users/SInginc/repos", "events_url": "https://api.github.com/users/SInginc/events{/privacy}", "received_events_url": "https://api.github.com/users/SInginc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 742693017, "node_id": "MDU6TGFiZWw3NDI2OTMwMTc=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/good-first-issue", "name": "good-first-issue", "color": "0e8a16", "default": false, "description": null}, {"id": 3958996521, "node_id": "LA_kwDOAQ3rIc7r-X4p", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/r", "name": "r", "color": "75aadb", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-11-16T15:43:21Z", "updated_at": "2022-12-12T19:28:55Z", "closed_at": "2022-12-12T19:28:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "### search you tried in the issue tracker\n\nRscript not found\n\n### describe your issue\n\nHi,\r\n\r\nI was adding hook for R language in pre-commit for the first time. And pre-commit throw me an error as\r\n\r\n```\r\nExecutable `C:\\path\\to\\R\\R-4.0.5\\bin\\Rscript` not found\r\n```\r\n\r\nBecause I was using hooks from [lorenzwalthert/precommit](https://github.com/lorenzwalthert/precommit), I found a similar issue was raised(https://github.com/lorenzwalthert/precommit/issues/441). But it looks like this issue is not related to the hooks and it is related to the R language support of pre-commit.\r\n\r\nThe error was raised in `cmd_output_b` of `pre_commit\\util.py`, which was called by `install_environment` of `pre_commit/languages/r.py` like.\r\n\r\n```\r\ncmd_output_b(\r\n    _rscript_exec(), *RSCRIPT_OPTS, '-e',\r\n    _inline_r_setup(r_code_inst_add),\r\n    *additional_dependencies,\r\n    cwd=env_dir,\r\n)\r\n```\r\nThe `_rscrip_exec()` will return  `C:\\path\\to\\R\\R-4.0.5\\bin\\Rscript` in my case because $R_HOME is well set.\r\n\r\n```\r\ndef _rscript_exec() -> str:\r\n    r_home = os.environ.get('R_HOME')\r\n    if r_home is None:\r\n        return 'Rscript'\r\n    else:\r\n        return os.path.join(r_home, 'bin', 'Rscript')\r\n```\r\n\r\nWhen `C:\\path\\to\\R\\R-4.0.5\\bin\\Rscript` was passed to `parse_shebang.normalize_cmd`, and this function uses `normexe` to examine whether `exe` is executable. \r\n\r\n```\r\ndef cmd_output_b(\r\n        *cmd: str,\r\n        retcode: int | None = 0,\r\n        **kwargs: Any,\r\n) -> tuple[int, bytes, bytes | None]:\r\n    _setdefault_kwargs(kwargs)\r\n\r\n    try:\r\n        cmd = parse_shebang.normalize_cmd(cmd)\r\n    except parse_shebang.ExecutableNotFoundError as e:\r\n        returncode, stdout_b, stderr_b = e.to_output()\r\n    else:\r\n        try:\r\n            proc = subprocess.Popen(cmd, **kwargs)\r\n        except OSError as e:\r\n            returncode, stdout_b, stderr_b = _oserror_to_output(e)\r\n        else:\r\n            stdout_b, stderr_b = proc.communicate()\r\n            returncode = proc.returncode\r\n\r\n    if retcode is not None and retcode != returncode:\r\n        raise CalledProcessError(returncode, cmd, retcode, stdout_b, stderr_b)\r\n\r\n    return returncode, stdout_b, stderr_b\r\n\r\ndef normalize_cmd(cmd: tuple[str, ...]) -> tuple[str, ...]:\r\n    \"\"\"Fixes for the following issues on windows\r\n    - https://bugs.python.org/issue8557\r\n    - windows does not parse shebangs\r\n\r\n    This function also makes deep-path shebangs work just fine\r\n    \"\"\"\r\n    # Use PATH to determine the executable\r\n    exe = normexe(cmd[0])\r\n\r\n    # Figure out the shebang from the resulting command\r\n    cmd = parse_filename(exe) + (exe,) + cmd[1:]\r\n\r\n    # This could have given us back another bare executable\r\n    exe = normexe(cmd[0])\r\n\r\n    return (exe,) + cmd[1:]\r\n```\r\n\r\nAnd it seems that `C:\\path\\to\\R\\R-4.0.5\\bin\\Rscript` didn't pass `normexe`'s test and the code flowed into:\r\n\r\n```\r\nexcept parse_shebang.ExecutableNotFoundError as e:\r\n    returncode, stdout_b, stderr_b = e.to_output()\r\n```\r\n\r\n`normexe` checks `exe`'s executability basing on two conditions:\r\n\r\n1. `os.sep not in orig and (not os.altsep or os.altsep not in orig)`\r\n2. `not os.path.isfile(orig)`\r\n\r\n```\r\ndef normexe(orig: str) -> str:\r\n    def _error(msg: str) -> NoReturn:\r\n        raise ExecutableNotFoundError(f'Executable `{orig}` {msg}')\r\n\r\n    if os.sep not in orig and (not os.altsep or os.altsep not in orig):\r\n        exe = find_executable(orig)\r\n        if exe is None:\r\n            _error('not found')\r\n        return exe\r\n    elif os.path.isdir(orig):\r\n        _error('is a directory')\r\n    elif not os.path.isfile(orig):\r\n        _error('not found')\r\n    elif not os.access(orig, os.X_OK):  # pragma: win32 no cover\r\n        _error('is not executable')\r\n    else:\r\n        return orig\r\n```\r\n\r\nSince `os.sep` is in `C:\\path\\to\\R\\R-4.0.5\\bin\\Rscript`, `orig` will flow into `not os.path.isfile(orig)`. And `os.path.isfile(orig)` is `False`, because in Windows, the actual file is like **`C:\\path\\to\\R\\R-4.0.5\\bin\\Rscript.exe`**.\r\n\r\nI am wondering, to fix this issue on Windows, can we do an OS check in `_rscrip_exec()` and return `/path/to/bin/Rscript.exe` when the User is using Windows?\r\n\r\nThank you!\r\n\n\n### pre-commit --version\n\npre-commit 2.20.0\n\n### .pre-commit-config.yaml\n\n```yaml\nrepos:\r\n-   repo: https://github.com/lorenzwalthert/precommit\r\n    rev: v0.3.2.9003\r\n    hooks:\r\n    -   id: parsable-R\r\n    -   id: lintr\r\n        args: [--warn-only, --key=value]\r\n    -   id: style-files\r\n        args: \r\n            - --scope=token\r\n    -   id: roxygenize\r\n    -   id: use-tidy-description\r\n-   repo: https://github.com/asottile/seed-isort-config\r\n    rev: v2.2.0\r\n    hooks:\r\n    -   id: seed-isort-config\r\n-   repo: https://github.com/pre-commit/mirrors-isort\r\n    rev: v5.10.1\r\n    hooks:\r\n    -   id: isort\r\n-   repo: https://github.com/psf/black\r\n    rev: 22.10.0\r\n    hooks:\r\n    -   id: black\r\n        args:\r\n            - --line-length=79\r\n        language_version: python3.9\r\n-   repo: https://github.com/pre-commit/pre-commit-hooks\r\n    rev: v2.3.0\r\n    hooks:\r\n    -   id: check-yaml\r\n    -   id: end-of-file-fixer\r\n    -   id: trailing-whitespace\r\n    -   id: flake8\r\n        args:\r\n            - --extend-ignore=F401, E501, W503\n```\n\n\n### ~/.cache/pre-commit/pre-commit.log (if present)\n\n### version information\r\n\r\n```\r\npre-commit version: 2.20.0\r\ngit --version: git version 2.37.3.windows.1\r\nsys.version:\r\n    3.9.0 (tags/v3.9.0:9cf6752, Oct  5 2020, 15:34:40) [MSC v.1927 64 bit (AMD64)]\r\nsys.executable: C:\\path\\to\\scripts\\python.exe\r\nos.name: nt\r\nsys.platform: win32\r\n```\r\n\r\n### error information\r\n\r\n```\r\nAn unexpected error has occurred: CalledProcessError: command: ('C:\\\\path\\\\to\\\\R\\\\R-4.0.5\\\\bin\\\\Rscript', '--vanilla', '-e', '    options(install.packages.compile.from.source = \"never\")\\n                prefix_dir <- \\'C:\\\\\\\\path\\\\\\\\to\\\\\\\\.cache\\\\\\\\pre-commit\\\\\\\\repoo8yj9t7d\\'\\n            options(\\n                repos = c(CRAN = \"https://cran.rstudio.com\"),\\n                renv.consent = TRUE\\n            )\\n            source(\"renv/activate.R\")\\n            renv::restore()\\n            activate_statement <- paste0(\\n              \\'suppressWarnings({\\',\\n              \\'old <- setwd(\"\\', getwd(), \\'\"); \\',\\n              \\'source(\"renv/activate.R\"); \\',\\n              \\'setwd(old); \\',\\n              \\'renv::load(\"\\', getwd(), \\'\");})\\'\\n            )\\n            writeLines(activate_statement, \\'activate.R\\')\\n            is_package <- tryCatch(\\n              {\\n                  path_desc <- file.path(prefix_dir, \\'DESCRIPTION\\')\\n                  suppressWarnings(desc <- read.dcf(path_desc))\\n                  \"Package\" %in% colnames(desc)\\n              },\\n              error = function(...) FALSE\\n            )\\n            if (is_package) {\\n                renv::install(prefix_dir)\\n            }\\n            \\n    ')\r\nreturn code: 1\r\nexpected return code: 0\r\nstdout:\r\n    Executable `C:\\path\\to\\R\\R-4.0.5\\bin\\Rscript` not found\r\nstderr: (none)\r\n```\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"C:\\path\\to\\lib\\site-packages\\pre_commit\\error_handler.py\", line 73, in error_handler\r\n    yield\r\n  File \"C:\\path\\to\\lib\\site-packages\\pre_commit\\main.py\", line 358, in main\r\n    return hook_impl(\r\n  File \"C:\\path\\to\\lib\\site-packages\\pre_commit\\commands\\hook_impl.py\", line 254, in hook_impl\r\n    return retv | run(config, store, ns)\r\n  File \"C:\\path\\to\\lib\\site-packages\\pre_commit\\commands\\run.py\", line 424, in run\r\n    install_hook_envs(to_install, store)\r\n  File \"C:\\path\\to\\lib\\site-packages\\pre_commit\\repository.py\", line 223, in install_hook_envs\r\n    _hook_install(hook)\r\n  File \"C:\\path\\to\\lib\\site-packages\\pre_commit\\repository.py\", line 79, in _hook_install\r\n    lang.install_environment(\r\n  File \"C:\\path\\to\\lib\\site-packages\\pre_commit\\languages\\r.py\", line 139, in install_environment\r\n    cmd_output_b(\r\n  File \"C:\\path\\to\\lib\\site-packages\\pre_commit\\util.py\", line 146, in cmd_output_b\r\n    raise CalledProcessError(returncode, cmd, retcode, stdout_b, stderr_b)\r\npre_commit.util.CalledProcessError: command: ('C:\\\\path\\\\to\\\\R\\\\R-4.0.5\\\\bin\\\\Rscript', '--vanilla', '-e', '    options(install.packages.compile.from.source = \"never\")\\n                prefix_dir <- \\'C:\\\\\\\\path\\\\\\\\to\\\\\\\\.cache\\\\\\\\pre-commit\\\\\\\\repoo8yj9t7d\\'\\n            options(\\n                repos = c(CRAN = \"https://cran.rstudio.com\"),\\n                renv.consent = TRUE\\n            )\\n            source(\"renv/activate.R\")\\n            renv::restore()\\n            activate_statement <- paste0(\\n              \\'suppressWarnings({\\',\\n              \\'old <- setwd(\"\\', getwd(), \\'\"); \\',\\n              \\'source(\"renv/activate.R\"); \\',\\n              \\'setwd(old); \\',\\n              \\'renv::load(\"\\', getwd(), \\'\");})\\'\\n            )\\n            writeLines(activate_statement, \\'activate.R\\')\\n            is_package <- tryCatch(\\n              {\\n                  path_desc <- file.path(prefix_dir, \\'DESCRIPTION\\')\\n                  suppressWarnings(desc <- read.dcf(path_desc))\\n                  \"Package\" %in% colnames(desc)\\n              },\\n              error = function(...) FALSE\\n            )\\n            if (is_package) {\\n                renv::install(prefix_dir)\\n            }\\n            \\n    ')\r\nreturn code: 1\r\nexpected return code: 0\r\nstdout:\r\n    Executable `C:\\path\\to\\R\\R-4.0.5\\bin\\Rscript` not found\r\nstderr: (none)\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2599/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2599/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2300", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2300/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2300/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2300/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/2300", "id": 1177480804, "node_id": "I_kwDOAQ3rIc5GLu5k", "number": 2300, "title": "RScript location not always correct", "user": {"login": "jeff-m-sullivan", "id": 7987295, "node_id": "MDQ6VXNlcjc5ODcyOTU=", "avatar_url": "https://avatars.githubusercontent.com/u/7987295?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jeff-m-sullivan", "html_url": "https://github.com/jeff-m-sullivan", "followers_url": "https://api.github.com/users/jeff-m-sullivan/followers", "following_url": "https://api.github.com/users/jeff-m-sullivan/following{/other_user}", "gists_url": "https://api.github.com/users/jeff-m-sullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jeff-m-sullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jeff-m-sullivan/subscriptions", "organizations_url": "https://api.github.com/users/jeff-m-sullivan/orgs", "repos_url": "https://api.github.com/users/jeff-m-sullivan/repos", "events_url": "https://api.github.com/users/jeff-m-sullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/jeff-m-sullivan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 3958996521, "node_id": "LA_kwDOAQ3rIc7r-X4p", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/r", "name": "r", "color": "75aadb", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-03-23T01:33:16Z", "updated_at": "2022-04-02T19:37:21Z", "closed_at": "2022-04-02T19:37:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This rarely comes up, because most people (in my experience) don't explicitly set R_HOME in regular terminals, but do have `RScript` in the path. If you use the RStudio-supplied Terminal, however, they do explicitly set R_HOME, which then causes the hook installs to break on some platforms (e.g., AWS Ubuntu is where I encountered the problem).\r\n\r\nWhile some distributions add symlinks, the default install location for `RScript` is `$R_HOME/bin/Rscript`:\r\nhttps://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Installation\r\n\r\nI believe it can be fixed in just one spot:\r\n\r\nhttps://github.com/pre-commit/pre-commit/blob/354b900f15e88a06ce8493e0316c288c44777017/pre_commit/languages/r.py#L62\r\n\r\nJust adding `bin` to that path join should solve the issue.", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2300/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2300/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2182", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2182/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2182/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2182/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/2182", "id": 1092018446, "node_id": "I_kwDOAQ3rIc5BFuEO", "number": 2182, "title": "doesn't work in visual studio 2019 on Windows", "user": {"login": "hushigome-visco", "id": 80367142, "node_id": "MDQ6VXNlcjgwMzY3MTQy", "avatar_url": "https://avatars.githubusercontent.com/u/80367142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hushigome-visco", "html_url": "https://github.com/hushigome-visco", "followers_url": "https://api.github.com/users/hushigome-visco/followers", "following_url": "https://api.github.com/users/hushigome-visco/following{/other_user}", "gists_url": "https://api.github.com/users/hushigome-visco/gists{/gist_id}", "starred_url": "https://api.github.com/users/hushigome-visco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hushigome-visco/subscriptions", "organizations_url": "https://api.github.com/users/hushigome-visco/orgs", "repos_url": "https://api.github.com/users/hushigome-visco/repos", "events_url": "https://api.github.com/users/hushigome-visco/events{/privacy}", "received_events_url": "https://api.github.com/users/hushigome-visco/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 181543993, "node_id": "MDU6TGFiZWwxODE1NDM5OTM=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/windows", "name": "windows", "color": "5319e7", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2022-01-02T13:15:13Z", "updated_at": "2022-01-06T14:05:47Z", "closed_at": "2022-01-06T14:05:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "### describe your issue\n\nWhen I try to commit from visual studio 2019, I get the following message:\r\n```\r\n/usr/bin/env: \u2018bash\u2019: No such file or directory\r\n```\r\n\r\nI have confirmed that it works from vscode and command prompt.\r\nI rewrote the `.git/hooks/pre-commit` to below and it worked.\r\n```\r\n#!/usr/bin/env sh\r\n```\r\n\r\nAs far as I can see, visual studio git hooks only support `sh`.\r\nAre you aware of this problem?\r\n\r\nthank you.\r\n\n\n### pre-commit --version\n\npre-commit 2.16.0\n\n### .pre-commit-config.yaml\n\n```yaml\nrepos:\r\n  - repo: https://github.com/pre-commit/mirrors-clang-format\r\n    rev: v13.0.0\r\n    hooks:\r\n      - id: clang-format\n```\n\n\n### ~/.cache/pre-commit/pre-commit.log (if present)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2182/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2182/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2063", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2063/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2063/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2063/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/2063", "id": 1007653371, "node_id": "I_kwDOAQ3rIc48D5H7", "number": 2063, "title": "Destructive operation on submodules with `submodule.recurse = true` git setting", "user": {"login": "a666", "id": 19142162, "node_id": "MDQ6VXNlcjE5MTQyMTYy", "avatar_url": "https://avatars.githubusercontent.com/u/19142162?v=4", "gravatar_id": "", "url": "https://api.github.com/users/a666", "html_url": "https://github.com/a666", "followers_url": "https://api.github.com/users/a666/followers", "following_url": "https://api.github.com/users/a666/following{/other_user}", "gists_url": "https://api.github.com/users/a666/gists{/gist_id}", "starred_url": "https://api.github.com/users/a666/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/a666/subscriptions", "organizations_url": "https://api.github.com/users/a666/orgs", "repos_url": "https://api.github.com/users/a666/repos", "events_url": "https://api.github.com/users/a666/events{/privacy}", "received_events_url": "https://api.github.com/users/a666/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2021-09-27T03:34:31Z", "updated_at": "2021-10-01T23:47:50Z", "closed_at": "2021-10-01T23:47:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "### describe your issue\n\nI added pre-commit to an ansible playbook repository that does extensive usage of git submodules for roles.\r\n\r\nI had two submodules with extensive changes:\r\n\r\n```shell\r\n$ gst\r\nOn branch master\r\nYour branch is ahead of 'origin/master' by 3 commits.\r\n  (use \"git push\" to publish your local commits)\r\n...\r\n        modified:   roles/dnscrypt-proxy (modified content) <-- submodule with extensive (non-commited) changes\r\n        modified:   roles/syncthing (modified content) <-- another submodule with extensive (non-commited) changes\r\n...\r\n```\r\n\r\nUpon doing a commit I received an error (check ~/.cache/pre-commit/pre-commit.log section) due to having some problems in my repo and its submodules.\r\nNotice that I cold not even run `git status` afterwards:\r\n```shell\r\n$ gst\r\nfatal: not a git repository: roles/matomo/../../.git/modules/roles/matomo\r\n```\r\nAfter fixing the problems:\r\n```shell\r\n$ rm -rf roles/matomo/ .git/modules/roles/matomo/\r\n$ git submodule update\r\nCloning into '/home/apoc/w/posg-ops/roles/matomo'...\r\nSubmodule path 'roles/matomo': checked out '######'\r\nfatal: could not get a repository handle for submodule 'roles/php'\r\n$ rm -rf roles/php/ .git/modules/roles/php\r\n$ git submodule update\r\nCloning into '/home/apoc/w/posg-ops/roles/php'...\r\nSubmodule path 'roles/php': checked out '######'\r\n```\r\nand running `git apply` to have my changes back:\r\n```shell\r\n$ git apply /home/a666/.cache/pre-commit/patch1632709290-1076629\r\n```\r\n\r\nI noticed that my two submodules now had no changes in them... \r\nAnd unfortunately I see nothing in pre-commit cache area to help me recover them.\n\n### pre-commit --version\n\npre-commit 2.15.0\n\n### .pre-commit-config.yaml\n\n```yaml\n---\r\nrepos:\r\n  - repo: https://github.com/pre-commit/pre-commit-hooks\r\n    rev: v4.0.1\r\n    hooks:\r\n      - id: trailing-whitespace\r\n      - id: end-of-file-fixer\r\n      - id: check-yaml\r\n      - id: check-toml\r\n      - id: check-added-large-files\r\n\r\n  - repo: https://github.com/editorconfig-checker/editorconfig-checker.python\r\n    rev: 2.3.54\r\n    hooks:\r\n      - id: editorconfig-checker\r\n\r\n  - repo: https://github.com/antonbabenko/pre-commit-terraform\r\n    rev: v1.51.0\r\n    hooks:\r\n      - id: terraform_validate\r\n      - id: terraform_fmt\r\n      - id: checkov\r\n      - id: terrascan\r\n      - id: terraform_tfsec\n```\n\n\n### ~/.cache/pre-commit/pre-commit.log (if present)\n\n### version information\r\n\r\n```\r\npre-commit version: 2.15.0\r\nsys.version:\r\n    3.9.7 (default, Aug 31 2021, 13:28:12)\r\n    [GCC 11.1.0]\r\nsys.executable: /home/a666/.local/pipx/venvs/pre-commit/bin/python\r\nos.name: posix\r\nsys.platform: linux\r\n```\r\n\r\n### error information\r\n\r\n```\r\nAn unexpected error has occurred: CalledProcessError: command: ('/usr/lib/git-core/git', 'checkout', '--', '.')\r\nreturn code: 255\r\nexpected return code: 0\r\nstdout: (none)\r\nstderr:\r\n    Migrating git directory of 'roles/fail2ban' from\r\n    '/home/a666/ops/roles/fail2ban/.git' to\r\n    '/home/a666/ops/.git/modules/roles/fail2ban'\r\n    fatal: not a git repository: ../../.git/modules/roles/matomo\r\n    error: Submodule 'roles/matomo' could not be updated.\r\n    Migrating git directory of 'roles/openproject' from\r\n    '/home/a666/ops/roles/openproject/.git' to\r\n    '/home/a666/ops/.git/modules/roles/openproject'\r\n    Migrating git directory of 'roles/oryhydra' from\r\n    '/home/a666/ops/roles/oryhydra/.git' to\r\n    '/home/a666/ops/.git/modules/roles/oryhydra'\r\n    fatal: not a git repository: ../../.git/modules/roles/php\r\n    error: Submodule 'roles/php' could not be updated.\r\n\r\n```\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/a666/.local/pipx/venvs/pre-commit/lib/python3.9/site-packages/pre_commit/error_handler.py\", line 65, in error_handler\r\n    yield\r\n  File \"/home/a666/.local/pipx/venvs/pre-commit/lib/python3.9/site-packages/pre_commit/main.py\", line 368, in main\r\n    return hook_impl(\r\n  File \"/home/a666/.local/pipx/venvs/pre-commit/lib/python3.9/site-packages/pre_commit/commands/hook_impl.py\", line 237, in hook_impl\r\n    return retv | run(config, store, ns)\r\n  File \"/home/a666/.local/pipx/venvs/pre-commit/lib/python3.9/site-packages/pre_commit/commands/run.py\", line 399, in run\r\n    exit_stack.enter_context(staged_files_only(store.directory))\r\n  File \"/usr/lib/python3.9/contextlib.py\", line 448, in enter_context\r\n    result = _cm_type.__enter__(cm)\r\n  File \"/usr/lib/python3.9/contextlib.py\", line 119, in __enter__\r\n    return next(self.gen)\r\n  File \"/home/a666/.local/pipx/venvs/pre-commit/lib/python3.9/site-packages/pre_commit/staged_files_only.py\", line 92, in staged_files_only\r\n    with _intent_to_add_cleared(), _unstaged_changes_cleared(patch_dir):\r\n  File \"/usr/lib/python3.9/contextlib.py\", line 119, in __enter__\r\n    return next(self.gen)\r\n  File \"/home/a666/.local/pipx/venvs/pre-commit/lib/python3.9/site-packages/pre_commit/staged_files_only.py\", line 61, in _unstaged_changes_cleared\r\n    cmd_output_b('git', 'checkout', '--', '.', env=no_checkout_env)\r\n  File \"/home/a666/.local/pipx/venvs/pre-commit/lib/python3.9/site-packages/pre_commit/util.py\", line 154, in cmd_output_b\r\n    raise CalledProcessError(returncode, cmd, retcode, stdout_b, stderr_b)\r\npre_commit.util.CalledProcessError: command: ('/usr/lib/git-core/git', 'checkout', '--', '.')\r\nreturn code: 255\r\nexpected return code: 0\r\nstdout: (none)\r\nstderr:\r\n    Migrating git directory of 'roles/fail2ban' from\r\n    '/home/a666/ops/roles/fail2ban/.git' to\r\n    '/home/a666/ops/.git/modules/roles/fail2ban'\r\n    fatal: not a git repository: ../../.git/modules/roles/matomo\r\n    error: Submodule 'roles/matomo' could not be updated.\r\n    Migrating git directory of 'roles/openproject' from\r\n    '/home/a666/ops/roles/openproject/.git' to\r\n    '/home/a666/ops/.git/modules/roles/openproject'\r\n    Migrating git directory of 'roles/oryhydra' from\r\n    '/home/a666/ops/roles/oryhydra/.git' to\r\n    '/home/a666/ops/.git/modules/roles/oryhydra'\r\n    fatal: not a git repository: ../../.git/modules/roles/php\r\n    error: Submodule 'roles/php' could not be updated.\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2063/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2063/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2019", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2019/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2019/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2019/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/2019", "id": 976504495, "node_id": "MDU6SXNzdWU5NzY1MDQ0OTU=", "number": 2019, "title": "`check-useless-excludes` meta hook doesn't seem to work well with broken symlinks", "user": {"login": "pkoch", "id": 9627, "node_id": "MDQ6VXNlcjk2Mjc=", "avatar_url": "https://avatars.githubusercontent.com/u/9627?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pkoch", "html_url": "https://github.com/pkoch", "followers_url": "https://api.github.com/users/pkoch/followers", "following_url": "https://api.github.com/users/pkoch/following{/other_user}", "gists_url": "https://api.github.com/users/pkoch/gists{/gist_id}", "starred_url": "https://api.github.com/users/pkoch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pkoch/subscriptions", "organizations_url": "https://api.github.com/users/pkoch/orgs", "repos_url": "https://api.github.com/users/pkoch/repos", "events_url": "https://api.github.com/users/pkoch/events{/privacy}", "received_events_url": "https://api.github.com/users/pkoch/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-08-23T00:06:22Z", "updated_at": "2021-08-31T14:34:25Z", "closed_at": "2021-08-31T01:48:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "Repro steps\r\n1. Add a submodule\r\n2. Add a symlink to somewhere inside this submodule\r\n3. Use `check-symlinks`\r\n4. Deinit submodule (to simulate the case when people clone without `--recursive`)\r\n4. Notice that it now complains about the symlink created on 2\r\n5. Add an exclude entry with the path to that symlink\r\n6. Use `check-useless-excludes`\r\n7. Notice that it complains that the added exclude entry doesn't apply.\r\n\r\nFor a working example, check out https://github.com/pkoch/test-check-useless-excludes (without `--recursive`, or run `git submodule deinit --all`) and run `pre-commit run --all`.", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2019/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/2019/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1942", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1942/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1942/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1942/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1942", "id": 921462345, "node_id": "MDU6SXNzdWU5MjE0NjIzNDU=", "number": 1942, "title": "Pre-commit install fails if existing hook is not utf-8", "user": {"login": "sbienkow-ninja", "id": 85104051, "node_id": "MDQ6VXNlcjg1MTA0MDUx", "avatar_url": "https://avatars.githubusercontent.com/u/85104051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sbienkow-ninja", "html_url": "https://github.com/sbienkow-ninja", "followers_url": "https://api.github.com/users/sbienkow-ninja/followers", "following_url": "https://api.github.com/users/sbienkow-ninja/following{/other_user}", "gists_url": "https://api.github.com/users/sbienkow-ninja/gists{/gist_id}", "starred_url": "https://api.github.com/users/sbienkow-ninja/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sbienkow-ninja/subscriptions", "organizations_url": "https://api.github.com/users/sbienkow-ninja/orgs", "repos_url": "https://api.github.com/users/sbienkow-ninja/repos", "events_url": "https://api.github.com/users/sbienkow-ninja/events{/privacy}", "received_events_url": "https://api.github.com/users/sbienkow-ninja/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-06-15T14:30:00Z", "updated_at": "2021-06-15T17:23:12Z", "closed_at": "2021-06-15T17:23:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "It looks like pre-commit tries to read the contents of an already installed hook blindly, without first checking if its a text file and not binary blob.\r\n\r\n### version information\r\n\r\n```\r\npre-commit version: 2.13.0\r\nsys.version:\r\n    3.8.5 (default, May 27 2021, 13:30:53) \r\n    [GCC 9.3.0]\r\nsys.executable: /usr/bin/python3\r\nos.name: posix\r\nsys.platform: linux\r\n```\r\n\r\n### error information\r\n\r\n```\r\nAn unexpected error has occurred: UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc8 in position 40: invalid continuation byte\r\n```\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/user/.local/lib/python3.8/site-packages/pre_commit/error_handler.py\", line 65, in error_handler\r\n    yield\r\n  File \"/home/user/.local/lib/python3.8/site-packages/pre_commit/main.py\", line 367, in main\r\n    return install(\r\n  File \"/home/user/.local/lib/python3.8/site-packages/pre_commit/commands/install_uninstall.py\", line 139, in install\r\n    _install_hook_script(\r\n  File \"/home/user/.local/lib/python3.8/site-packages/pre_commit/commands/install_uninstall.py\", line 88, in _install_hook_script\r\n    if os.path.lexists(hook_path) and not is_our_script(hook_path):\r\n  File \"/home/user/.local/lib/python3.8/site-packages/pre_commit/commands/install_uninstall.py\", line 52, in is_our_script\r\n    contents = f.read()\r\n  File \"/usr/lib/python3.8/codecs.py\", line 322, in decode\r\n    (result, consumed) = self._buffer_decode(data, self.errors, final)\r\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0xc8 in position 40: invalid continuation byte\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1942/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1942/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1880", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1880/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1880/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1880/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1880", "id": 859915060, "node_id": "MDU6SXNzdWU4NTk5MTUwNjA=", "number": 1880, "title": "Parallel execution ran into \"patch does not apply\"", "user": {"login": "adamchainz", "id": 857609, "node_id": "MDQ6VXNlcjg1NzYwOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/857609?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adamchainz", "html_url": "https://github.com/adamchainz", "followers_url": "https://api.github.com/users/adamchainz/followers", "following_url": "https://api.github.com/users/adamchainz/following{/other_user}", "gists_url": "https://api.github.com/users/adamchainz/gists{/gist_id}", "starred_url": "https://api.github.com/users/adamchainz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adamchainz/subscriptions", "organizations_url": "https://api.github.com/users/adamchainz/orgs", "repos_url": "https://api.github.com/users/adamchainz/repos", "events_url": "https://api.github.com/users/adamchainz/events{/privacy}", "received_events_url": "https://api.github.com/users/adamchainz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 742693017, "node_id": "MDU6TGFiZWw3NDI2OTMwMTc=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/good-first-issue", "name": "good-first-issue", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-04-16T15:23:52Z", "updated_at": "2021-04-16T21:12:38Z", "closed_at": "2021-04-16T21:12:38Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I modified a bunch of repos using `pre-commit` in parallel and ran `git commit` at the same time, with unstaged changes. The pre-commit processes did `[WARNING] Unstaged files detected.`, stashed the changes in a pach, ran, and then tried to reapply the patches.\r\n\r\nSome repos failed with:\r\n\r\n\r\n```\r\n[WARNING] Stashed changes conflicted with hook auto-fixes... Rolling back fixes...\r\nAn unexpected error has occurred: CalledProcessError: command: ('/usr/local/Cellar/git/2.31.1/libexec/git-core/git', '-c', 'core.autocrlf=false', 'apply', '--whitespace=nowarn', '/Users/chainz/.cache/pre-commit/patch1618586253')\r\nreturn code: 1\r\nexpected return code: 0\r\nstdout: (none)\r\nstderr:\r\n    error: patch failed: .github/workflows/main.yml:21\r\n    error: .github/workflows/main.yml: patch does not apply\r\n\r\nCheck the log at /Users/chainz/.cache/pre-commit/pre-commit.log\r\n```\r\n\r\nIt looks like this is due to use of the unix timestamp as the only differentiator in patch file paths, causing the parallely-created patches to clobber each other.\r\n\r\n`pre-commit.log` says:\r\n\r\n### version information\r\n\r\n```\r\npre-commit version: 2.12.0\r\nsys.version:\r\n    3.9.4 (default, Apr  5 2021, 01:49:30) \r\n    [Clang 12.0.0 (clang-1200.0.32.29)]\r\nsys.executable: /usr/local/Cellar/pre-commit/2.12.0/libexec/bin/python3\r\nos.name: posix\r\nsys.platform: darwin\r\n```\r\n\r\n### error information\r\n\r\n```\r\nAn unexpected error has occurred: CalledProcessError: command: ('/usr/local/Cellar/git/2.31.1/libexec/git-core/git', '-c', 'core.autocrlf=false', 'apply', '--whitespace=nowarn', '/Users/chainz/.cache/pre-commit/patch1618586253')\r\nreturn code: 1\r\nexpected return code: 0\r\nstdout: (none)\r\nstderr:\r\n    error: patch failed: .github/workflows/main.yml:21\r\n    error: .github/workflows/main.yml: patch does not apply\r\n    \r\n```\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/local/Cellar/pre-commit/2.12.0/libexec/lib/python3.9/site-packages/pre_commit/staged_files_only.py\", line 20, in _git_apply\r\n    cmd_output_b('git', *args)\r\n  File \"/usr/local/Cellar/pre-commit/2.12.0/libexec/lib/python3.9/site-packages/pre_commit/util.py\", line 154, in cmd_output_b\r\n    raise CalledProcessError(returncode, cmd, retcode, stdout_b, stderr_b)\r\npre_commit.util.CalledProcessError: command: ('/usr/local/Cellar/git/2.31.1/libexec/git-core/git', 'apply', '--whitespace=nowarn', '/Users/chainz/.cache/pre-commit/patch1618586253')\r\nreturn code: 1\r\nexpected return code: 0\r\nstdout: (none)\r\nstderr:\r\n    error: patch failed: .github/workflows/main.yml:21\r\n    error: .github/workflows/main.yml: patch does not apply\r\n    \r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/Cellar/pre-commit/2.12.0/libexec/lib/python3.9/site-packages/pre_commit/staged_files_only.py\", line 68, in _unstaged_changes_cleared\r\n    _git_apply(patch_filename)\r\n  File \"/usr/local/Cellar/pre-commit/2.12.0/libexec/lib/python3.9/site-packages/pre_commit/staged_files_only.py\", line 23, in _git_apply\r\n    cmd_output_b('git', '-c', 'core.autocrlf=false', *args)\r\n  File \"/usr/local/Cellar/pre-commit/2.12.0/libexec/lib/python3.9/site-packages/pre_commit/util.py\", line 154, in cmd_output_b\r\n    raise CalledProcessError(returncode, cmd, retcode, stdout_b, stderr_b)\r\npre_commit.util.CalledProcessError: command: ('/usr/local/Cellar/git/2.31.1/libexec/git-core/git', '-c', 'core.autocrlf=false', 'apply', '--whitespace=nowarn', '/Users/chainz/.cache/pre-commit/patch1618586253')\r\nreturn code: 1\r\nexpected return code: 0\r\nstdout: (none)\r\nstderr:\r\n    error: patch failed: .github/workflows/main.yml:21\r\n    error: .github/workflows/main.yml: patch does not apply\r\n    \r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/Cellar/pre-commit/2.12.0/libexec/lib/python3.9/site-packages/pre_commit/staged_files_only.py\", line 20, in _git_apply\r\n    cmd_output_b('git', *args)\r\n  File \"/usr/local/Cellar/pre-commit/2.12.0/libexec/lib/python3.9/site-packages/pre_commit/util.py\", line 154, in cmd_output_b\r\n    raise CalledProcessError(returncode, cmd, retcode, stdout_b, stderr_b)\r\npre_commit.util.CalledProcessError: command: ('/usr/local/Cellar/git/2.31.1/libexec/git-core/git', 'apply', '--whitespace=nowarn', '/Users/chainz/.cache/pre-commit/patch1618586253')\r\nreturn code: 1\r\nexpected return code: 0\r\nstdout: (none)\r\nstderr:\r\n    error: patch failed: .github/workflows/main.yml:21\r\n    error: .github/workflows/main.yml: patch does not apply\r\n    \r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/Cellar/pre-commit/2.12.0/libexec/lib/python3.9/site-packages/pre_commit/error_handler.py\", line 65, in error_handler\r\n    yield\r\n  File \"/usr/local/Cellar/pre-commit/2.12.0/libexec/lib/python3.9/site-packages/pre_commit/main.py\", line 357, in main\r\n    return hook_impl(\r\n  File \"/usr/local/Cellar/pre-commit/2.12.0/libexec/lib/python3.9/site-packages/pre_commit/commands/hook_impl.py\", line 227, in hook_impl\r\n    return retv | run(config, store, ns)\r\n  File \"/usr/local/Cellar/pre-commit/2.12.0/libexec/lib/python3.9/site-packages/pre_commit/commands/run.py\", line 408, in run\r\n    return _run_hooks(config, hooks, args, environ)\r\n  File \"/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/contextlib.py\", line 513, in __exit__\r\n    raise exc_details[1]\r\n  File \"/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/contextlib.py\", line 498, in __exit__\r\n    if cb(*exc_details):\r\n  File \"/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/contextlib.py\", line 124, in __exit__\r\n    next(self.gen)\r\n  File \"/usr/local/Cellar/pre-commit/2.12.0/libexec/lib/python3.9/site-packages/pre_commit/staged_files_only.py\", line 93, in staged_files_only\r\n    yield\r\n  File \"/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/contextlib.py\", line 124, in __exit__\r\n    next(self.gen)\r\n  File \"/usr/local/Cellar/pre-commit/2.12.0/libexec/lib/python3.9/site-packages/pre_commit/staged_files_only.py\", line 78, in _unstaged_changes_cleared\r\n    _git_apply(patch_filename)\r\n  File \"/usr/local/Cellar/pre-commit/2.12.0/libexec/lib/python3.9/site-packages/pre_commit/staged_files_only.py\", line 23, in _git_apply\r\n    cmd_output_b('git', '-c', 'core.autocrlf=false', *args)\r\n  File \"/usr/local/Cellar/pre-commit/2.12.0/libexec/lib/python3.9/site-packages/pre_commit/util.py\", line 154, in cmd_output_b\r\n    raise CalledProcessError(returncode, cmd, retcode, stdout_b, stderr_b)\r\npre_commit.util.CalledProcessError: command: ('/usr/local/Cellar/git/2.31.1/libexec/git-core/git', '-c', 'core.autocrlf=false', 'apply', '--whitespace=nowarn', '/Users/chainz/.cache/pre-commit/patch1618586253')\r\nreturn code: 1\r\nexpected return code: 0\r\nstdout: (none)\r\nstderr:\r\n    error: patch failed: .github/workflows/main.yml:21\r\n    error: .github/workflows/main.yml: patch does not apply\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1880/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1880/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1815", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1815/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1815/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1815/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1815", "id": 815604651, "node_id": "MDU6SXNzdWU4MTU2MDQ2NTE=", "number": 1815, "title": "Add support for Go 1.16", "user": {"login": "rafikdraoui", "id": 767223, "node_id": "MDQ6VXNlcjc2NzIyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/767223?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rafikdraoui", "html_url": "https://github.com/rafikdraoui", "followers_url": "https://api.github.com/users/rafikdraoui/followers", "following_url": "https://api.github.com/users/rafikdraoui/following{/other_user}", "gists_url": "https://api.github.com/users/rafikdraoui/gists{/gist_id}", "starred_url": "https://api.github.com/users/rafikdraoui/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rafikdraoui/subscriptions", "organizations_url": "https://api.github.com/users/rafikdraoui/orgs", "repos_url": "https://api.github.com/users/rafikdraoui/repos", "events_url": "https://api.github.com/users/rafikdraoui/events{/privacy}", "received_events_url": "https://api.github.com/users/rafikdraoui/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-02-24T15:49:35Z", "updated_at": "2021-02-27T02:38:45Z", "closed_at": "2021-02-27T02:38:45Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Go 1.16 now rejects empty `go.mod` files (c.f. https://github.com/golang/go/commit/d4986e0e1d6e03e1b92e905ca5e01b4c223fbeb3). This means that `golang` hooks cannot be installed anymore:\r\n\r\n```\r\n$ pre-commit install-hooks\r\n[INFO] Initializing environment for local.\r\n[INFO] Installing environment for local.\r\n[INFO] Once installed this environment will be reused.\r\n[INFO] This may take a few minutes...\r\nAn unexpected error has occurred: CalledProcessError: command: ('/usr/local/bin/go', 'get', './...')\r\nreturn code: 1\r\nexpected return code: 0\r\nstdout: (none)\r\nstderr:\r\n    go: no module declaration in go.mod. To specify the module path:\r\n    \tgo mod edit -module=example.com/mod\r\n    \r\nCheck the log at /Users/rdraoui/.cache/pre-commit/pre-commit.log\r\n```\r\n\r\n\r\nI could get it to work by changing `pre_commit/resources/empty_template_go.mod` from an empty file to:\r\n\r\n```\r\nmodule example/mod\r\n```\r\n\r\n\r\nBut I'm not all that familiar with how modules work in different Go versions, so maybe making that change has some other implications that I don't know about. This [Go Wiki entry](https://github.com/golang/go/wiki/Modules#can-an-additional-gomod-exclude-unnecessary-content-do-modules-have-the-equivalent-of-a-gitignore-file) seems to suggest that empty `go.mod` files are legal, but maybe it's outdated... (c.f: https://github.com/pre-commit/pre-commit/pull/1428#pullrequestreview-404547009)\r\n\r\nThe fix is compatible with Go 1.15.\r\n\r\nI tried validating the fix by running the test suite (`pytest tests -k golang`), but I can't get it to pass with Go 1.15 and current `master` branch either.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1815/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1815/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1788", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1788/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1788/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1788/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1788", "id": 802750692, "node_id": "MDU6SXNzdWU4MDI3NTA2OTI=", "number": 1788, "title": "recursive submodule support for `language: golang`", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-02-06T17:41:24Z", "updated_at": "2021-02-06T21:18:37Z", "closed_at": "2021-02-06T21:18:37Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I added this hook in `pre-commit-hooks.yaml` in `https://github.com/google/go-jsonnet`, and then when I try to use this hook as:\r\n```\r\nrepos:\r\n  - repo: https://github.com/google/go-jsonnet\r\n    rev: 4a3144a417b7eb9b1f7e56741a9e72f3155de3fa\r\n    hooks:\r\n      - id: jsonnet-format\r\n```\r\nthen I see following error.\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/local/Cellar/pre-commit/2.10.0/libexec/lib/python3.9/site-packages/pre_commit/error_handler.py\", line 65, in error_handler\r\n    yield\r\n  File \"/usr/local/Cellar/pre-commit/2.10.0/libexec/lib/python3.9/site-packages/pre_commit/main.py\", line 378, in main\r\n    return run(args.config, store, args)\r\n  File \"/usr/local/Cellar/pre-commit/2.10.0/libexec/lib/python3.9/site-packages/pre_commit/commands/run.py\", line 403, in run\r\n    install_hook_envs(hooks, store)\r\n  File \"/usr/local/Cellar/pre-commit/2.10.0/libexec/lib/python3.9/site-packages/pre_commit/repository.py\", line 224, in install_hook_envs\r\n    _hook_install(hook)\r\n  File \"/usr/local/Cellar/pre-commit/2.10.0/libexec/lib/python3.9/site-packages/pre_commit/repository.py\", line 82, in _hook_install\r\n    lang.install_environment(\r\n  File \"/usr/local/Cellar/pre-commit/2.10.0/libexec/lib/python3.9/site-packages/pre_commit/languages/golang.py\", line 81, in install_environment\r\n    cmd_output_b('go', 'get', './...', cwd=repo_src_dir, env=env)\r\n  File \"/usr/local/Cellar/pre-commit/2.10.0/libexec/lib/python3.9/site-packages/pre_commit/util.py\", line 154, in cmd_output_b\r\n    raise CalledProcessError(returncode, cmd, retcode, stdout_b, stderr_b)\r\npre_commit.util.CalledProcessError: command: ('/usr/local/bin/go', 'get', './...')\r\nreturn code: 2\r\nexpected return code: 0\r\nstdout: (none)\r\nstderr:\r\n    go: downloading github.com/sergi/go-diff v1.1.0\r\n    go: downloading github.com/fatih/color v1.9.0\r\n    go: downloading github.com/mattn/go-colorable v0.1.4\r\n    go: downloading github.com/mattn/go-isatty v0.0.11\r\n    go: downloading golang.org/x/sys v0.0.0-20191026070338-33540a1f6037\r\n    # github.com/google/go-jsonnet/c-bindings\r\n    libjsonnet.cpp:5:14: fatal error: 'libjsonnet.h' file not found\r\n\r\n```\r\nAny idea? Thanks.\r\n\r\n_Originally posted by @gaurav517 in https://github.com/pre-commit/pre-commit/issues/1785#issuecomment-774486062_", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1788/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1788/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1787", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1787/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1787/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1787/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1787", "id": 802703835, "node_id": "MDU6SXNzdWU4MDI3MDM4MzU=", "number": 1787, "title": "Stashed changes conflicted with hook auto-fixes... Rolling back fixes...", "user": {"login": "pantelis-karamolegkos", "id": 50835081, "node_id": "MDQ6VXNlcjUwODM1MDgx", "avatar_url": "https://avatars.githubusercontent.com/u/50835081?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pantelis-karamolegkos", "html_url": "https://github.com/pantelis-karamolegkos", "followers_url": "https://api.github.com/users/pantelis-karamolegkos/followers", "following_url": "https://api.github.com/users/pantelis-karamolegkos/following{/other_user}", "gists_url": "https://api.github.com/users/pantelis-karamolegkos/gists{/gist_id}", "starred_url": "https://api.github.com/users/pantelis-karamolegkos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pantelis-karamolegkos/subscriptions", "organizations_url": "https://api.github.com/users/pantelis-karamolegkos/orgs", "repos_url": "https://api.github.com/users/pantelis-karamolegkos/repos", "events_url": "https://api.github.com/users/pantelis-karamolegkos/events{/privacy}", "received_events_url": "https://api.github.com/users/pantelis-karamolegkos/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-02-06T13:33:01Z", "updated_at": "2021-03-23T14:06:48Z", "closed_at": "2021-02-06T18:38:18Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Using\r\n \r\n```\r\n\u25b6 pre-commit --version\r\npre-commit 2.10.0\r\n```\r\n\r\non MacOS Catalina.\r\n\r\nI have a directory full of (not only, but mostly) `terraform` files as also terragrunt hcl config.\r\n\r\nUsing this `pre-commit` config\r\n\r\n\r\n```\r\n\u25b6 cat .pre-commit-config.yaml\r\nrepos:\r\n  - repo: git://github.com/antonbabenko/pre-commit-terraform\r\n    rev: v1.45.0\r\n    hooks:\r\n      - id: terraform_fmt\r\n      - id: terraform_tflint\r\n      - id: terraform_docs\r\n      - id: terraform_tfsec\r\n      - id: terragrunt_fmt\r\n```\r\n\r\nThe following error comes up when running pre-commit\r\n\r\n```\r\n[WARNING] Stashed changes conflicted with hook auto-fixes... Rolling back fixes...\r\nAn unexpected error has occurred: CalledProcessError: command: ('/usr/bin/git', '-c', 'core.autocrlf=false', 'apply', '--whitespace=nowarn', '/Users/pantelis/.cache/pre-commit/patch1612618048')\r\nreturn code: 128\r\nexpected return code: 0\r\nstdout: (none)\r\nstderr:\r\n    error: unrecognized input\r\n\r\nCheck the log at /Users/pantelis/.cache/pre-commit/pre-commit.log\r\n```\r\n\r\nand the log\r\n\r\n\r\n```\r\n### version information\r\n\r\npre-commit version: 2.10.0\r\nsys.version:\r\n    3.9.0 (default, Dec  6 2020, 18:02:34)\r\n    [Clang 12.0.0 (clang-1200.0.32.27)]\r\nsys.executable: /usr/local/opt/python@3.9/bin/python3.9\r\nos.name: posix\r\nsys.platform: darwin\r\n\r\n### error information\r\n\r\nAn unexpected error has occurred: CalledProcessError: command: ('/usr/bin/git', '-c', 'core.autocrlf=false', 'apply', '--whitespace=nowarn', '/Users/pantelis/.cache/pre-commit/patch1612618267')\r\nreturn code: 128\r\nexpected return code: 0\r\nstdout: (none)\r\nstderr:\r\n    error: unrecognized input\r\n\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.9/site-packages/pre_commit/staged_files_only.py\", line 20, in _git_apply\r\n    cmd_output_b('git', *args)\r\n  File \"/usr/local/lib/python3.9/site-packages/pre_commit/util.py\", line 154, in cmd_output_b\r\n    raise CalledProcessError(returncode, cmd, retcode, stdout_b, stderr_b)\r\npre_commit.util.CalledProcessError: command: ('/usr/bin/git', 'apply', '--whitespace=nowarn', '/Users/pantelis/.cache/pre-commit/patch1612618267')\r\nreturn code: 128\r\nexpected return code: 0\r\nstdout: (none)\r\nstderr:\r\n    error: unrecognized input\r\n\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.9/site-packages/pre_commit/staged_files_only.py\", line 68, in _unstaged_changes_cleared\r\n    _git_apply(patch_filename)\r\n  File \"/usr/local/lib/python3.9/site-packages/pre_commit/staged_files_only.py\", line 23, in _git_apply\r\n    cmd_output_b('git', '-c', 'core.autocrlf=false', *args)\r\n  File \"/usr/local/lib/python3.9/site-packages/pre_commit/util.py\", line 154, in cmd_output_b\r\n    raise CalledProcessError(returncode, cmd, retcode, stdout_b, stderr_b)\r\npre_commit.util.CalledProcessError: command: ('/usr/bin/git', '-c', 'core.autocrlf=false', 'apply', '--whitespace=nowarn', '/Users/pantelis/.cache/pre-commit/patch1612618267')\r\nreturn code: 128\r\nexpected return code: 0\r\nstdout: (none)\r\nstderr:\r\n    error: unrecognized input\r\n\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.9/site-packages/pre_commit/staged_files_only.py\", line 20, in _git_apply\r\n    cmd_output_b('git', *args)\r\n  File \"/usr/local/lib/python3.9/site-packages/pre_commit/util.py\", line 154, in cmd_output_b\r\n    raise CalledProcessError(returncode, cmd, retcode, stdout_b, stderr_b)\r\npre_commit.util.CalledProcessError: command: ('/usr/bin/git', 'apply', '--whitespace=nowarn', '/Users/pantelis/.cache/pre-commit/patch1612618267')\r\nreturn code: 128\r\nexpected return code: 0\r\nstdout: (none)\r\nstderr:\r\n    error: unrecognized input\r\n\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.9/site-packages/pre_commit/error_handler.py\", line 65, in error_handler\r\n    yield\r\n  File \"/usr/local/lib/python3.9/site-packages/pre_commit/main.py\", line 378, in main\r\n    return run(args.config, store, args)\r\n  File \"/usr/local/lib/python3.9/site-packages/pre_commit/commands/run.py\", line 405, in run\r\n    return _run_hooks(config, hooks, args, environ)\r\n  File \"/usr/local/Cellar/python@3.9/3.9.0_5/Frameworks/Python.framework/Versions/3.9/lib/python3.9/contextlib.py\", line 513, in __exit__\r\n    raise exc_details[1]\r\n  File \"/usr/local/Cellar/python@3.9/3.9.0_5/Frameworks/Python.framework/Versions/3.9/lib/python3.9/contextlib.py\", line 498, in __exit__\r\n    if cb(*exc_details):\r\n  File \"/usr/local/Cellar/python@3.9/3.9.0_5/Frameworks/Python.framework/Versions/3.9/lib/python3.9/contextlib.py\", line 124, in __exit__\r\n    next(self.gen)\r\n  File \"/usr/local/lib/python3.9/site-packages/pre_commit/staged_files_only.py\", line 93, in staged_files_only\r\n    yield\r\n  File \"/usr/local/Cellar/python@3.9/3.9.0_5/Frameworks/Python.framework/Versions/3.9/lib/python3.9/contextlib.py\", line 124, in __exit__\r\n    next(self.gen)\r\n  File \"/usr/local/lib/python3.9/site-packages/pre_commit/staged_files_only.py\", line 78, in _unstaged_changes_cleared\r\n    _git_apply(patch_filename)\r\n  File \"/usr/local/lib/python3.9/site-packages/pre_commit/staged_files_only.py\", line 23, in _git_apply\r\n    cmd_output_b('git', '-c', 'core.autocrlf=false', *args)\r\n  File \"/usr/local/lib/python3.9/site-packages/pre_commit/util.py\", line 154, in cmd_output_b\r\n    raise CalledProcessError(returncode, cmd, retcode, stdout_b, stderr_b)\r\npre_commit.util.CalledProcessError: command: ('/usr/bin/git', '-c', 'core.autocrlf=false', 'apply', '--whitespace=nowarn', '/Users/pantelis/.cache/pre-commit/patch1612618267')\r\nreturn code: 128\r\nexpected return code: 0\r\nstdout: (none)\r\nstderr:\r\n    error: unrecognized input\r\n```\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1787/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1787/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1777", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1777/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1777/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1777/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1777", "id": 795268931, "node_id": "MDU6SXNzdWU3OTUyNjg5MzE=", "number": 1777, "title": "[Regression] Worktree support", "user": {"login": "s0undt3ch", "id": 300048, "node_id": "MDQ6VXNlcjMwMDA0OA==", "avatar_url": "https://avatars.githubusercontent.com/u/300048?v=4", "gravatar_id": "", "url": "https://api.github.com/users/s0undt3ch", "html_url": "https://github.com/s0undt3ch", "followers_url": "https://api.github.com/users/s0undt3ch/followers", "following_url": "https://api.github.com/users/s0undt3ch/following{/other_user}", "gists_url": "https://api.github.com/users/s0undt3ch/gists{/gist_id}", "starred_url": "https://api.github.com/users/s0undt3ch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/s0undt3ch/subscriptions", "organizations_url": "https://api.github.com/users/s0undt3ch/orgs", "repos_url": "https://api.github.com/users/s0undt3ch/repos", "events_url": "https://api.github.com/users/s0undt3ch/events{/privacy}", "received_events_url": "https://api.github.com/users/s0undt3ch/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2021-01-27T16:49:23Z", "updated_at": "2021-01-27T22:08:21Z", "closed_at": "2021-01-27T20:30:59Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Latest release 2.9.3 broke git worktrees support\r\n\r\n### version information\r\n\r\n```\r\npre-commit version: 2.9.3\r\nsys.version:\r\n    3.6.8 (default, Apr 15 2020, 09:32:35)\r\n    [GCC 9.3.0]\r\nsys.executable: /home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/bin/python3.6\r\nos.name: posix\r\nsys.platform: linux\r\n```\r\n\r\n### error information\r\n\r\n```\r\nAn error has occurred: FatalError: git toplevel unexpectedly empty! make sure you are not inside the `.git` directory of your repository.\r\n```\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/lib/python3.6/site-packages/pre_commit/error_handler.py\", line 65, in error_handler\r\n    yield\r\n  File \"/home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/lib/python3.6/site-packages/pre_commit/main.py\", line 330, in main\r\n    _adjust_args_and_chdir(args)\r\n  File \"/home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/lib/python3.6/site-packages/pre_commit/main.py\", line 147, in _adjust_args_and_chdir\r\n    toplevel = git.get_root()\r\n  File \"/home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/lib/python3.6/site-packages/pre_commit/git.py\", line 66, in get_root\r\n    'git toplevel unexpectedly empty! make sure you are not '\r\npre_commit.errors.FatalError: git toplevel unexpectedly empty! make sure you are not inside the `.git` directory of your repository.\r\n```\r\n\r\n```\r\n\u276f pre-commit run -av bandit-salt\r\nAn error has occurred: FatalError: git toplevel unexpectedly empty! make sure you are not inside the `.git` directory of your repository.\r\nCheck the log at /home/vampas/.cache/pre-commit/pre-commit.log\r\n```\r\nVersion 2.9.2 works fine:\r\n```\r\n\u276f pip install pre-commit==2.9.2\r\nCollecting pre-commit==2.9.2\r\n  Using cached pre_commit-2.9.2-py2.py3-none-any.whl (184 kB)\r\nRequirement already satisfied: importlib-metadata in /home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/lib/python3.6/site-packages (from pre-commit==2.9.2) (3.1.1)\r\nRequirement already satisfied: virtualenv>=20.0.8 in /home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/lib/python3.6/site-packages (from pre-commit==2.9.2) (20.2.2)\r\nRequirement already satisfied: pyyaml>=5.1 in /home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/lib/python3.6/site-packages (from pre-commit==2.9.2) (5.3.1)\r\nRequirement already satisfied: nodeenv>=0.11.1 in /home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/lib/python3.6/site-packages (from pre-commit==2.9.2) (1.5.0)\r\nRequirement already satisfied: cfgv>=2.0.0 in /home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/lib/python3.6/site-packages (from pre-commit==2.9.2) (3.2.0)\r\nRequirement already satisfied: identify>=1.0.0 in /home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/lib/python3.6/site-packages (from pre-commit==2.9.2) (1.5.10)\r\nRequirement already satisfied: toml in /home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/lib/python3.6/site-packages (from pre-commit==2.9.2) (0.10.2)\r\nRequirement already satisfied: importlib-resources in /home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/lib/python3.6/site-packages (from pre-commit==2.9.2) (3.3.0)\r\nRequirement already satisfied: zipp>=0.5 in /home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/lib/python3.6/site-packages (from importlib-metadata->pre-commit==2.9.2) (3.4.0)\r\nRequirement already satisfied: zipp>=0.5 in /home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/lib/python3.6/site-packages (from importlib-metadata->pre-commit==2.9.2) (3.4.0)\r\nRequirement already satisfied: importlib-resources in /home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/lib/python3.6/site-packages (from pre-commit==2.9.2) (3.3.0)\r\nRequirement already satisfied: six<2,>=1.9.0 in /home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/lib/python3.6/site-packages (from virtualenv>=20.0.8->pre-commit==2.9.2) (1.15.0)\r\nRequirement already satisfied: filelock<4,>=3.0.0 in /home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/lib/python3.6/site-packages (from virtualenv>=20.0.8->pre-commit==2.9.2) (3.0.12)\r\nRequirement already satisfied: distlib<1,>=0.3.1 in /home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/lib/python3.6/site-packages (from virtualenv>=20.0.8->pre-commit==2.9.2) (0.3.1)\r\nRequirement already satisfied: importlib-metadata in /home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/lib/python3.6/site-packages (from pre-commit==2.9.2) (3.1.1)\r\nRequirement already satisfied: appdirs<2,>=1.4.3 in /home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/lib/python3.6/site-packages (from virtualenv>=20.0.8->pre-commit==2.9.2) (1.4.4)\r\nInstalling collected packages: pre-commit\r\n  Attempting uninstall: pre-commit\r\n    Found existing installation: pre-commit 2.9.3\r\n    Uninstalling pre-commit-2.9.3:\r\n      Successfully uninstalled pre-commit-2.9.3\r\nSuccessfully installed pre-commit-2.9.2\r\nWARNING: You are using pip version 20.3.1; however, version 21.0 is available.\r\nYou should consider upgrading via the '/home/vampas/.dotfiles/.ext/pyenv/versions/3.6.8/envs/SaltPriv-3.6/bin/python3.6 -m pip install --upgrade pip' command.\r\n~/projects/SaltStack/CVEs/salt/salt-priv/features/bandit (features/bandit|\u2714) SaltPriv-3.6\r\n\u276f pre-commit run -av bandit-salt\r\nRun bandit against Salt..................................................^CInterrupted (^C): KeyboardInterrupt:\r\nCheck the log at /home/vampas/.cache/pre-commit/pre-commit.log\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1777/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1777/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1720", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1720/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1720/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1720/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1720", "id": 752786757, "node_id": "MDU6SXNzdWU3NTI3ODY3NTc=", "number": 1720, "title": "init-templatedir installing hooks to wrong directory", "user": {"login": "chronoB", "id": 11942682, "node_id": "MDQ6VXNlcjExOTQyNjgy", "avatar_url": "https://avatars.githubusercontent.com/u/11942682?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chronoB", "html_url": "https://github.com/chronoB", "followers_url": "https://api.github.com/users/chronoB/followers", "following_url": "https://api.github.com/users/chronoB/following{/other_user}", "gists_url": "https://api.github.com/users/chronoB/gists{/gist_id}", "starred_url": "https://api.github.com/users/chronoB/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chronoB/subscriptions", "organizations_url": "https://api.github.com/users/chronoB/orgs", "repos_url": "https://api.github.com/users/chronoB/repos", "events_url": "https://api.github.com/users/chronoB/events{/privacy}", "received_events_url": "https://api.github.com/users/chronoB/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 321107135, "node_id": "MDU6TGFiZWwzMjExMDcxMzU=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/question", "name": "question", "color": "999999", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-11-28T23:03:40Z", "updated_at": "2020-11-28T23:48:31Z", "closed_at": "2020-11-28T23:48:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "I was trying to use the init-templatedir functionality of pre-commit and ran into a weird problem:\r\n\r\nUsing Windows 10, pre-commit 2.9.2, git version 2.29.2.windows.1\r\n\r\nI followed the example on the pre-commit.com website and used:\r\n```\r\ngit config --global init.templateDir ~/.git-template\r\npre-commit init-templatedir ~/.git-template\r\n```\r\n![grafik](https://user-images.githubusercontent.com/11942682/100527714-36ac7900-31d5-11eb-8312-ab5dc966e7ea.png)\r\n\r\nIt wants me to be in a git repository (I thought you prevented this with da80cc6479154c0a0a6096d183f9d1d72aae556b).\r\nSo i switched to a git repository and rerun \r\n```\r\npre-commit init-templatedir ~/.git-template\r\n```\r\n![grafik](https://user-images.githubusercontent.com/11942682/100527744-a7ec2c00-31d5-11eb-8b45-4bcc4093dd12.png)\r\n\r\nthe hooks aren't installed in the stated directory.\r\nBased on the warnings it looks like pre-commit isn't resolving the ~ correctly, or did I miss sth.?\r\n\r\n```\r\ngit config --get init.templateDir \r\n```\r\nreturns ~/.git-template\r\n\r\n![grafik](https://user-images.githubusercontent.com/11942682/100527765-e41f8c80-31d5-11eb-95d6-9fc95aa96841.png)\r\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1720/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1720/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1718", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1718/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1718/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1718/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1718", "id": 752484181, "node_id": "MDU6SXNzdWU3NTI0ODQxODE=", "number": 1718, "title": "check-symlinks hook not working", "user": {"login": "CodeBleu", "id": 400979, "node_id": "MDQ6VXNlcjQwMDk3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/400979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CodeBleu", "html_url": "https://github.com/CodeBleu", "followers_url": "https://api.github.com/users/CodeBleu/followers", "following_url": "https://api.github.com/users/CodeBleu/following{/other_user}", "gists_url": "https://api.github.com/users/CodeBleu/gists{/gist_id}", "starred_url": "https://api.github.com/users/CodeBleu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CodeBleu/subscriptions", "organizations_url": "https://api.github.com/users/CodeBleu/orgs", "repos_url": "https://api.github.com/users/CodeBleu/repos", "events_url": "https://api.github.com/users/CodeBleu/events{/privacy}", "received_events_url": "https://api.github.com/users/CodeBleu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-11-27T21:56:11Z", "updated_at": "2020-11-28T00:59:00Z", "closed_at": "2020-11-28T00:58:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "**OS** :                            Gentoo\r\n**Python Version** :         Python 3.8.6\r\n**pre-commit Version** :  pre-commit 2.9.1\r\n\r\n$ cat .pre-commit-config.yaml\r\n```\r\nrepos:\r\n-   repo: https://github.com/pre-commit/pre-commit-hooks\r\n    rev: v3.3.0\r\n    hooks:\r\n    -   id: trailing-whitespace\r\n    -   id: end-of-file-fixer\r\n    -   id: check-yaml\r\n    -   id: check-added-large-files\r\n    -   id: check-json\r\n    -   id: check-merge-conflict\r\n    -   id: check-symlinks\r\n    -   id: detect-aws-credentials\r\n```\r\n\r\n$ ls -alh\r\n```\r\ntotal 24K\r\ndrwxr-xr-x 3 blah users 4.0K Nov 25 18:50 .\r\ndrwxr-xr-x 4 blah users 4.0K May 24  2020 ..\r\ndrwxr-xr-x 7 blah users 4.0K Nov 25 18:51 .git\r\n-rw-r--r-- 1 blah users  436 Nov 25 18:01 .pre-commit-config.yaml\r\nlrwxrwxrwx 1 blah users    8 Nov 25 18:26 blahblah -> asdfasdf\r\n-rw-r--r-- 1 blah users   14 Nov 25 17:35 greeting\r\n-rw-r--r-- 1 blah users  107 Nov 25 18:06 testingblah\r\n\r\n```\r\n\r\n$ file blahblah\r\n`blahblah: broken symbolic link to asdfasdf`\r\n\r\n$ identify-cli blahblah\r\n`[\"symlink\"]`\r\n\r\n$ pre-commit run check-symlinks --all-files\r\n`Check for broken symlinks............................(no files to check)Skipped`\r\n\r\n\r\n```\r\n>>> import os.path\r\n>>> os.path.exists(\"blahblah\")\r\nFalse\r\n>>> os.path.exists(\"test\")\r\nTrue\r\n>>>\r\n\r\n\r\n>>> import os.path\r\n>>> os.path.lexists(\"blahblah\")\r\nTrue\r\n>>>\r\n```\r\n\r\n\r\n**File is untracked**\r\n\r\n$ git status\r\n```\r\nOn branch master\r\nChanges to be committed:\r\n  (use \"git restore --staged <file>...\" to unstage)\r\n        modified:   testingblah\r\n\r\nChanges not staged for commit:\r\n  (use \"git add/rm <file>...\" to update what will be committed)\r\n  (use \"git restore <file>...\" to discard changes in working directory)\r\n        deleted:    test\r\n\r\nUntracked files:\r\n  (use \"git add <file>...\" to include in what will be committed)\r\n        .pre-commit-config.yaml\r\n        blahblah\r\n```\r\n\r\n$ pre-commit run check-symlinks --all-files\r\n`Check for broken symlinks............................(no files to check)Skipped`\r\n\r\n**File is being tracked**\r\n$ git status\r\n```\r\nOn branch master\r\nChanges to be committed:\r\n  (use \"git restore --staged <file>...\" to unstage)\r\n        new file:   blahblah\r\n        modified:   testingblah\r\n\r\nChanges not staged for commit:\r\n  (use \"git add/rm <file>...\" to update what will be committed)\r\n  (use \"git restore <file>...\" to discard changes in working directory)\r\n        deleted:    test\r\n\r\nUntracked files:\r\n  (use \"git add <file>...\" to include in what will be committed)\r\n        .pre-commit-config.yaml\r\n\r\n```\r\n_**Issue still exists even when tracked.**_\r\n\r\n$ pre-commit run check-symlinks --all-files\r\n`Check for broken symlinks............................(no files to check)Skipped`", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1718/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1718/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1699", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1699/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1699/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1699/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1699", "id": 744644330, "node_id": "MDU6SXNzdWU3NDQ2NDQzMzA=", "number": 1699, "title": "Rbenv default ruby issue on install", "user": {"login": "abuxton", "id": 1231167, "node_id": "MDQ6VXNlcjEyMzExNjc=", "avatar_url": "https://avatars.githubusercontent.com/u/1231167?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abuxton", "html_url": "https://github.com/abuxton", "followers_url": "https://api.github.com/users/abuxton/followers", "following_url": "https://api.github.com/users/abuxton/following{/other_user}", "gists_url": "https://api.github.com/users/abuxton/gists{/gist_id}", "starred_url": "https://api.github.com/users/abuxton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abuxton/subscriptions", "organizations_url": "https://api.github.com/users/abuxton/orgs", "repos_url": "https://api.github.com/users/abuxton/repos", "events_url": "https://api.github.com/users/abuxton/events{/privacy}", "received_events_url": "https://api.github.com/users/abuxton/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 352542360, "node_id": "MDU6TGFiZWwzNTI1NDIzNjA=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/ruby", "name": "ruby", "color": "cc342d", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-11-17T11:18:47Z", "updated_at": "2020-11-20T16:39:51Z", "closed_at": "2020-11-20T01:45:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am trying to install MDL v0.11.0\r\n\r\ni get the following error during install \r\n```\r\npre-commit\r\n[INFO] Installing environment for git://github.com/markdownlint/markdownlint.\r\n[INFO] Once installed this environment will be reused.\r\n[INFO] This may take a few minutes...\r\nAn unexpected error has occurred: CalledProcessError: command: ('/usr/local/bin/bash', '/Users/abuxton/.rbenv/shims/gem', 'build', 'mdl.gemspec')\r\nreturn code: 1\r\nexpected return code: 0\r\nstdout: (none)\r\nstderr:\r\n    rbenv: version `default' is not installed (set by RBENV_VERSION environment variable)\r\n```\r\n\r\nseems to be the same issue as https://github.com/pre-commit/pre-commit/issues/369 on a previous version of pre-commit\r\npre-commit.log https://gist.github.com/abuxton/d29e6265f3230f838a746d7a5defd5e3 \r\n\r\ni have tried, ensuring local rbenv, I have tried pre-commit clean/uninstall and reinstall to no success, mdl will `brew install mdl` successfully and works fine. \r\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1699/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1699/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1658", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1658/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1658/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1658/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1658", "id": 728605571, "node_id": "MDU6SXNzdWU3Mjg2MDU1NzE=", "number": 1658, "title": "rbenv FileNotFoundError when installing markdownlint hook", "user": {"login": "adithyabsk", "id": 4440808, "node_id": "MDQ6VXNlcjQ0NDA4MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/4440808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adithyabsk", "html_url": "https://github.com/adithyabsk", "followers_url": "https://api.github.com/users/adithyabsk/followers", "following_url": "https://api.github.com/users/adithyabsk/following{/other_user}", "gists_url": "https://api.github.com/users/adithyabsk/gists{/gist_id}", "starred_url": "https://api.github.com/users/adithyabsk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adithyabsk/subscriptions", "organizations_url": "https://api.github.com/users/adithyabsk/orgs", "repos_url": "https://api.github.com/users/adithyabsk/repos", "events_url": "https://api.github.com/users/adithyabsk/events{/privacy}", "received_events_url": "https://api.github.com/users/adithyabsk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-10-23T23:57:49Z", "updated_at": "2023-03-06T13:55:08Z", "closed_at": "2020-10-29T00:22:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am trying to use https://github.com/markdownlint/markdownlint to lint my markdown files. I checked the issue tracker and [don't seem to see any related issues](https://github.com/pre-commit/pre-commit/issues?q=FileNotFoundError+rbenv). \r\n\r\nI have `.rbenv` installed on my system and am wondering if that could be interfering with `pre-commit`?\r\n\r\n### .pre-commit-config.yaml\r\n```\r\nrepos:\r\n-   repo: https://github.com/markdownlint/markdownlint\r\n    rev: master\r\n    hooks:\r\n    -   id: markdownlint\r\n```\r\n\r\n### version information\r\n\r\n```\r\npre-commit version: 2.7.1\r\nsys.version:\r\n    3.9.0 (default, Oct  9 2020, 16:41:50) \r\n    [Clang 12.0.0 (clang-1200.0.32.2)]\r\nsys.executable: /usr/local/Cellar/pre-commit/2.7.1_1/libexec/bin/python\r\nos.name: posix\r\nsys.platform: darwin\r\n```\r\n\r\n### error information\r\n\r\n```\r\nAn unexpected error has occurred: FileNotFoundError: [Errno 2] No such file or directory: '/Users/adithyabalaji/.cache/pre-commit/repo09b5y8iv/rbenv-system/.install_state_v1staging'\r\n```\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/local/Cellar/pre-commit/2.7.1_1/libexec/lib/python3.9/site-packages/pre_commit/error_handler.py\", line 63, in error_handler\r\n    yield\r\n  File \"/usr/local/Cellar/pre-commit/2.7.1_1/libexec/lib/python3.9/site-packages/pre_commit/main.py\", line 390, in main\r\n    return run(args.config, store, args)\r\n  File \"/usr/local/Cellar/pre-commit/2.7.1_1/libexec/lib/python3.9/site-packages/pre_commit/commands/run.py\", line 388, in run\r\n    install_hook_envs(hooks, store)\r\n  File \"/usr/local/Cellar/pre-commit/2.7.1_1/libexec/lib/python3.9/site-packages/pre_commit/repository.py\", line 206, in install_hook_envs\r\n    _hook_install(hook)\r\n  File \"/usr/local/Cellar/pre-commit/2.7.1_1/libexec/lib/python3.9/site-packages/pre_commit/repository.py\", line 92, in _hook_install\r\n    _write_state(hook.prefix, venv, _state(hook.additional_dependencies))\r\n  File \"/usr/local/Cellar/pre-commit/2.7.1_1/libexec/lib/python3.9/site-packages/pre_commit/repository.py\", line 48, in _write_state\r\n    with open(staging, 'w') as state_file:\r\nFileNotFoundError: [Errno 2] No such file or directory: '/Users/adithyabalaji/.cache/pre-commit/repo09b5y8iv/rbenv-system/.install_state_v1staging'\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1658/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1658/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1610", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1610/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1610/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1610/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1610", "id": 706545694, "node_id": "MDU6SXNzdWU3MDY1NDU2OTQ=", "number": 1610, "title": "Pre-commit fails for git >=2.25 if repo is on a Windows subst drive", "user": {"login": "jcameron73", "id": 45177448, "node_id": "MDQ6VXNlcjQ1MTc3NDQ4", "avatar_url": "https://avatars.githubusercontent.com/u/45177448?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jcameron73", "html_url": "https://github.com/jcameron73", "followers_url": "https://api.github.com/users/jcameron73/followers", "following_url": "https://api.github.com/users/jcameron73/following{/other_user}", "gists_url": "https://api.github.com/users/jcameron73/gists{/gist_id}", "starred_url": "https://api.github.com/users/jcameron73/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jcameron73/subscriptions", "organizations_url": "https://api.github.com/users/jcameron73/orgs", "repos_url": "https://api.github.com/users/jcameron73/repos", "events_url": "https://api.github.com/users/jcameron73/events{/privacy}", "received_events_url": "https://api.github.com/users/jcameron73/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 181543993, "node_id": "MDU6TGFiZWwxODE1NDM5OTM=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/windows", "name": "windows", "color": "5319e7", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-09-22T16:56:17Z", "updated_at": "2020-12-12T10:05:46Z", "closed_at": "2020-12-07T22:50:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "Cross reference for another issue with same apparent root cause: https://github.com/microsoft/vscode/issues/100274#issuecomment-646499795\r\n\r\nIssue observed with pre-commit==2.7.1 and git 2.27.\r\nIssue resolved with downgrading git to 2.21 (I only have access to certain versions on my work machine).\r\n\r\nSteps to recreate for pre-commit (some taken from the above cross-reference):\r\n\r\n- Install git >= 2.25 on Windows\r\n\r\n- Create a subst drive (`mkdir C:\\subst_dir && subst Z: C:\\subst_dir`)\r\n\r\n- Create a git repo in there (`mkdir Z:\\repo && cd /d Z:\\repo && git init`)\r\n\r\n- Add some python code, configure pre-commit, and run pre-commit.\r\n\r\nFailure observed: `An unexpected error has occurred: ValueError: path is on mount 'Z:', start on mount 'C:'`\r\n\r\nDiagnosis - it appears that the use of `git rev-parse --show-toplevel` in `pre_commit.main.get_root()` is suffering the same issue as seen in cross-referenced ticket; git will \"see through\" the subst command and rather than return a path on the subst-defined Z: drive, it will return the path from the C: drive. With this, after `pre_commit.main._adjust_args_and_chdir()` calls `pre_commit.main.get_root()` and does a chdir to the returned location, the following call to `os.path.relpath(args.config)` then fails with the ValueError as above, because it sees the path to the config file being on `Z:` but the current location being on `C:`.\r\n\r\nAfraid I don't have a suggested resolution but wanted to flag this up. I'm not too familiar with Windows systems and I'm a long way from Admin access on my work machine so opportunities for testing are limited; this was discovered as my scratch space for repos is a subst drive.\r\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1610/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1610/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1575", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1575/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1575/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1575/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1575", "id": 684186108, "node_id": "MDU6SXNzdWU2ODQxODYxMDg=", "number": 1575, "title": "Flask style test failing health check in CI", "user": {"login": "jab", "id": 64992, "node_id": "MDQ6VXNlcjY0OTky", "avatar_url": "https://avatars.githubusercontent.com/u/64992?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jab", "html_url": "https://github.com/jab", "followers_url": "https://api.github.com/users/jab/followers", "following_url": "https://api.github.com/users/jab/following{/other_user}", "gists_url": "https://api.github.com/users/jab/gists{/gist_id}", "starred_url": "https://api.github.com/users/jab/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jab/subscriptions", "organizations_url": "https://api.github.com/users/jab/orgs", "repos_url": "https://api.github.com/users/jab/repos", "events_url": "https://api.github.com/users/jab/events{/privacy}", "received_events_url": "https://api.github.com/users/jab/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-08-23T13:43:41Z", "updated_at": "2020-08-23T19:10:07Z", "closed_at": "2020-08-23T17:49:07Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Flask's style test in GitHub actions runs `tox -e style`, which runs `pre-commit run --all-files --show-diff-on-failure`, which is failing with \"An unexpected error has occurred: AssertionError: BUG: expected environment for python to be healthy() immediately after install, please open an issue describing your environment\".\r\n\r\nNote, this does not reproduce locally.\r\n\r\nAFAIK, this first appeared in pallets/flask#3739.\r\n\r\nWe're trying to debug this over in pallets/flask#3740 where I've temporarily added a `cat .../pre-commit.log` command. Output here: https://github.com/pallets/flask/pull/3740/checks?check_run_id=1018335736#step:9:14\r\n\r\nNeither the error message nor the log actually say what specifically about the environment is unhealthy.\r\n \r\nAny ideas?\r\n\r\nThanks!", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1575/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1575/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1516", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1516/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1516/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1516/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1516", "id": 640622077, "node_id": "MDU6SXNzdWU2NDA2MjIwNzc=", "number": 1516, "title": "Executable `prettier` not found", "user": {"login": "rkm", "id": 5160559, "node_id": "MDQ6VXNlcjUxNjA1NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/5160559?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rkm", "html_url": "https://github.com/rkm", "followers_url": "https://api.github.com/users/rkm/followers", "following_url": "https://api.github.com/users/rkm/following{/other_user}", "gists_url": "https://api.github.com/users/rkm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rkm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rkm/subscriptions", "organizations_url": "https://api.github.com/users/rkm/orgs", "repos_url": "https://api.github.com/users/rkm/repos", "events_url": "https://api.github.com/users/rkm/events{/privacy}", "received_events_url": "https://api.github.com/users/rkm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 352543934, "node_id": "MDU6TGFiZWwzNTI1NDM5MzQ=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/javascript", "name": "javascript", "color": "f0db4f", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-06-17T17:34:27Z", "updated_at": "2020-06-19T21:15:33Z", "closed_at": "2020-06-19T21:15:33Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "hello hello!\r\n\r\nAs discussed on discord, I'm having an issue running prettier via pre-commit:\r\n\r\n```bash\r\n$ pre-commit --version\r\npre-commit 2.5.1\r\n\r\n$ cat .pre-commit-config.yaml\r\nrepos:\r\n  - repo: https://github.com/prettier/prettier\r\n    rev: 2.0.5\r\n    hooks:\r\n      - id: prettier\r\n\r\n$ pre-commit clean\r\nCleaned /home/rkm/.cache/pre-commit.\r\n\r\n> pre-commit run prettier --files README.md\r\n[INFO] Initializing environment for https://github.com/prettier/prettier.\r\n[INFO] Installing environment for https://github.com/prettier/prettier.\r\n[INFO] Once installed this environment will be reused.\r\n[INFO] This may take a few minutes...\r\nprettier.................................................................Failed\r\n- hook id: prettier\r\n- exit code: 1\r\n\r\nExecutable `prettier` not found\r\n```\r\n\r\nit seems like prettier is installed correctly, but the symlink to it is not created:\r\n\r\n```bash\r\n$ find ~/.cache/pre-commit/ -name prettier.js\r\n/home/rkm/.cache/pre-commit/repoes79dg4v/bin/prettier.js\r\n\r\n$ ls -l $(find ~/.cache/pre-commit/ -name node_env-default)/bin\r\ntotal 70376\r\n-rwxr-xr-x. 1 rkm rkm     3702 Jun 17 17:30 activate\r\n-rwxr-xr-x. 1 rkm rkm     3964 Jun 17 17:30 activate.fish\r\n-rwxr-xr-x. 1 rkm rkm 72052312 Jun  2 14:33 node\r\nlrwxrwxrwx. 1 rkm rkm        4 Jun 17 17:30 nodejs -> node\r\nlrwxrwxrwx. 1 rkm rkm       38 Jun 17 17:30 npm -> ../lib/node_modules/npm/bin/npm-cli.js\r\nlrwxrwxrwx. 1 rkm rkm       38 Jun 17 17:30 npx -> ../lib/node_modules/npm/bin/npx-cli.js\r\n-rwxr-xr-x. 1 rkm rkm      355 Jun 17 17:30 shim \r\n```\r\n\r\n(doing the same in a docker container results in a `prettier` symlink being created there).\r\n\r\nI suspect my VM may be borked somehow, but not sure how to debug this further. Any thoughts? Thanks!\r\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1516/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1516/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1496", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1496/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1496/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1496/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1496", "id": 635548955, "node_id": "MDU6SXNzdWU2MzU1NDg5NTU=", "number": 1496, "title": "Stalls on hooks checkout", "user": {"login": "admorgan", "id": 355894, "node_id": "MDQ6VXNlcjM1NTg5NA==", "avatar_url": "https://avatars.githubusercontent.com/u/355894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/admorgan", "html_url": "https://github.com/admorgan", "followers_url": "https://api.github.com/users/admorgan/followers", "following_url": "https://api.github.com/users/admorgan/following{/other_user}", "gists_url": "https://api.github.com/users/admorgan/gists{/gist_id}", "starred_url": "https://api.github.com/users/admorgan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/admorgan/subscriptions", "organizations_url": "https://api.github.com/users/admorgan/orgs", "repos_url": "https://api.github.com/users/admorgan/repos", "events_url": "https://api.github.com/users/admorgan/events{/privacy}", "received_events_url": "https://api.github.com/users/admorgan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 15, "created_at": "2020-06-09T15:44:07Z", "updated_at": "2020-06-09T21:15:36Z", "closed_at": "2020-06-09T21:15:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "When trying to use some hook repositories I am getting hangs while fetching hooks. Tried pre-commit clean and rm -rf ~/.cache/pre-commit, but nothing changed. This is happening on both Windows 10 and Ubuntu 18.04.4 LTS.\r\n\r\npre-commit.log\r\n\r\n> ### version information\r\n> \r\n> ```\r\n> pre-commit version: 2.4.0\r\n> sys.version:\r\n>     3.6.9 (default, Apr 18 2020, 01:56:04)\r\n>     [GCC 8.4.0]\r\n> sys.executable: /usr/bin/python3\r\n> os.name: posix\r\n> sys.platform: linux\r\n> ```\r\n> \r\n> ### error information\r\n> \r\n> ```\r\n> Interrupted (^C): KeyboardInterrupt:\r\n> ```\r\n> \r\n> ```\r\n> Traceback (most recent call last):\r\n>   File \"/home/morgana/.local/lib/python3.6/site-packages/pre_commit/error_handler.py\", line 56, in error_handler\r\n>     yield\r\n>   File \"/home/morgana/.local/lib/python3.6/site-packages/pre_commit/main.py\", line 388, in main\r\n>     return install_hooks(args.config, store)\r\n>   File \"/home/morgana/.local/lib/python3.6/site-packages/pre_commit/commands/install_uninstall.py\", line 153, in install_hooks\r\n>     install_hook_envs(all_hooks(load_config(config_file), store), store)\r\n>   File \"/home/morgana/.local/lib/python3.6/site-packages/pre_commit/repository.py\", line 206, in all_hooks\r\n>     for repo in root_config['repos']\r\n>   File \"/home/morgana/.local/lib/python3.6/site-packages/pre_commit/repository.py\", line 207, in <genexpr>\r\n>     for hook in _repository_hooks(repo, store, root_config)\r\n>   File \"/home/morgana/.local/lib/python3.6/site-packages/pre_commit/repository.py\", line 182, in _repository_hooks\r\n>     return _cloned_repository_hooks(repo_config, store, root_config)\r\n>   File \"/home/morgana/.local/lib/python3.6/site-packages/pre_commit/repository.py\", line 148, in _cloned_repository_hooks\r\n>     manifest_path = os.path.join(store.clone(repo, rev), C.MANIFEST_FILE)\r\n>   File \"/home/morgana/.local/lib/python3.6/site-packages/pre_commit/store.py\", line 183, in clone\r\n>     return self._new_repo(repo, ref, deps, clone_strategy)\r\n>   File \"/home/morgana/.local/lib/python3.6/site-packages/pre_commit/store.py\", line 140, in _new_repo\r\n>     make_strategy(directory)\r\n>   File \"/home/morgana/.local/lib/python3.6/site-packages/pre_commit/store.py\", line 179, in clone_strategy\r\n>     self._shallow_clone(ref, _git_cmd)\r\n>   File \"/home/morgana/.local/lib/python3.6/site-packages/pre_commit/store.py\", line 162, in _shallow_clone\r\n>     git_cmd('checkout', 'FETCH_HEAD')\r\n>   File \"/home/morgana/.local/lib/python3.6/site-packages/pre_commit/store.py\", line 176, in _git_cmd\r\n>     cmd_output_b('git', *args, cwd=directory, env=env)\r\n>   File \"/home/morgana/.local/lib/python3.6/site-packages/pre_commit/util.py\", line 155, in cmd_output_b\r\n>     stdout_b, stderr_b = proc.communicate()\r\n>   File \"/usr/lib/python3.6/subprocess.py\", line 863, in communicate\r\n>     stdout, stderr = self._communicate(input, endtime, timeout)\r\n>   File \"/usr/lib/python3.6/subprocess.py\", line 1534, in _communicate\r\n>     ready = selector.select(timeout)\r\n>   File \"/usr/lib/python3.6/selectors.py\", line 376, in select\r\n>     fd_event_list = self._poll.poll(timeout)\r\n> KeyboardInterrupt\r\n\r\nAdded to  ~/.local/lib/python3.6/site-packages/pre_commit/util.py line 143\r\n\r\n```python\r\nprint(cmd)\r\nprint(kwargs)\r\n```\r\n\r\n> $ pre-commit install-hooks\r\n> ('git', 'rev-parse', '--show-toplevel')\r\n> {'stdin': -1, 'stdout': -1, 'stderr': -1}\r\n> [INFO] Initializing environment for https://github.com/psf/black.\r\n> ('git', 'init', '/home/morgana/.cache/pre-commit/repohg1s5b7b')\r\n> {'env': {'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'SSH_CONNECTION': '10.30.48.92 50335 10.30.48.87 22', 'LESSCLOSE': '/usr/bin/lesspipe %s %s', 'LANG': 'en_US.UTF-8', 'PERL_MB_OPT': '--install_base \"/home/morgana/perl5\"', 'XDG_SESSION_ID': '10', 'USER': 'morgana', 'PWD': '/home/morgana/projects/git-hooks', 'HOME': '/home/morgana', 'SSH_CLIENT': '10.30.48.92 50335 22', 'XDG_DATA_DIRS': '/usr/local/share:/usr/share:/var/lib/snapd/desktop', 'PERL_MM_OPT': 'INSTALL_BASE=/home/morgana/perl5', 'PERL_LOCAL_LIB_ROOT': '/home/morgana/perl5', 'SSH_TTY': '/dev/pts/0', 'MAIL': '/var/mail/morgana', 'TERM': 'xterm', 'SHELL': '/bin/bash', 'PERL5LIB': '/home/morgana/perl5/lib/perl5', 'SHLVL': '1', 'LANGUAGE': 'en_US:', 'MANPATH': '/home/morgana/.git/subrepo/man:', 'LOGNAME': 'morgana', 'DBUS_SESSION_BUS_ADDRESS': 'unix:path=/run/user/17173/bus', 'XDG_RUNTIME_DIR': '/run/user/17173', 'PATH': '/home/morgana/.local/bin:/home/morgana/bin:/home/morgana/perl5/bin:/home/morgana/.git/subrepo/lib:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin', 'LESSOPEN': '| /usr/bin/lesspipe %s', 'OLDPWD': '/home/morgana', '_': '/home/morgana/.local/bin/pre-commit'}, 'stdin': -1, 'stdout': -1, 'stderr': -1}\r\n> ('git', 'remote', 'add', 'origin', 'https://github.com/psf/black')\r\n> {'cwd': '/home/morgana/.cache/pre-commit/repohg1s5b7b', 'env': {'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'SSH_CONNECTION': '10.30.48.92 50335 10.30.48.87 22', 'LESSCLOSE': '/usr/bin/lesspipe %s %s', 'LANG': 'en_US.UTF-8', 'PERL_MB_OPT': '--install_base \"/home/morgana/perl5\"', 'XDG_SESSION_ID': '10', 'USER': 'morgana', 'PWD': '/home/morgana/projects/git-hooks', 'HOME': '/home/morgana', 'SSH_CLIENT': '10.30.48.92 50335 22', 'XDG_DATA_DIRS': '/usr/local/share:/usr/share:/var/lib/snapd/desktop', 'PERL_MM_OPT': 'INSTALL_BASE=/home/morgana/perl5', 'PERL_LOCAL_LIB_ROOT': '/home/morgana/perl5', 'SSH_TTY': '/dev/pts/0', 'MAIL': '/var/mail/morgana', 'TERM': 'xterm', 'SHELL': '/bin/bash', 'PERL5LIB': '/home/morgana/perl5/lib/perl5', 'SHLVL': '1', 'LANGUAGE': 'en_US:', 'MANPATH': '/home/morgana/.git/subrepo/man:', 'LOGNAME': 'morgana', 'DBUS_SESSION_BUS_ADDRESS': 'unix:path=/run/user/17173/bus', 'XDG_RUNTIME_DIR': '/run/user/17173', 'PATH': '/home/morgana/.local/bin:/home/morgana/bin:/home/morgana/perl5/bin:/home/morgana/.git/subrepo/lib:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin', 'LESSOPEN': '| /usr/bin/lesspipe %s', 'OLDPWD': '/home/morgana', '_': '/home/morgana/.local/bin/pre-commit'}, 'stdin': -1, 'stdout': -1, 'stderr': -1}\r\n> ('git', '-c', 'protocol.version=2', 'fetch', 'origin', 'stable', '--depth=1')\r\n> {'cwd': '/home/morgana/.cache/pre-commit/repohg1s5b7b', 'env': {'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'SSH_CONNECTION': '10.30.48.92 50335 10.30.48.87 22', 'LESSCLOSE': '/usr/bin/lesspipe %s %s', 'LANG': 'en_US.UTF-8', 'PERL_MB_OPT': '--install_base \"/home/morgana/perl5\"', 'XDG_SESSION_ID': '10', 'USER': 'morgana', 'PWD': '/home/morgana/projects/git-hooks', 'HOME': '/home/morgana', 'SSH_CLIENT': '10.30.48.92 50335 22', 'XDG_DATA_DIRS': '/usr/local/share:/usr/share:/var/lib/snapd/desktop', 'PERL_MM_OPT': 'INSTALL_BASE=/home/morgana/perl5', 'PERL_LOCAL_LIB_ROOT': '/home/morgana/perl5', 'SSH_TTY': '/dev/pts/0', 'MAIL': '/var/mail/morgana', 'TERM': 'xterm', 'SHELL': '/bin/bash', 'PERL5LIB': '/home/morgana/perl5/lib/perl5', 'SHLVL': '1', 'LANGUAGE': 'en_US:', 'MANPATH': '/home/morgana/.git/subrepo/man:', 'LOGNAME': 'morgana', 'DBUS_SESSION_BUS_ADDRESS': 'unix:path=/run/user/17173/bus', 'XDG_RUNTIME_DIR': '/run/user/17173', 'PATH': '/home/morgana/.local/bin:/home/morgana/bin:/home/morgana/perl5/bin:/home/morgana/.git/subrepo/lib:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin', 'LESSOPEN': '| /usr/bin/lesspipe %s', 'OLDPWD': '/home/morgana', '_': '/home/morgana/.local/bin/pre-commit'}, 'stdin': -1, 'stdout': -1, 'stderr': -1}\r\n> ('git', 'checkout', 'FETCH_HEAD')\r\n> {'cwd': '/home/morgana/.cache/pre-commit/repohg1s5b7b', 'env': {'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'SSH_CONNECTION': '10.30.48.92 50335 10.30.48.87 22', 'LESSCLOSE': '/usr/bin/lesspipe %s %s', 'LANG': 'en_US.UTF-8', 'PERL_MB_OPT': '--install_base \"/home/morgana/perl5\"', 'XDG_SESSION_ID': '10', 'USER': 'morgana', 'PWD': '/home/morgana/projects/git-hooks', 'HOME': '/home/morgana', 'SSH_CLIENT': '10.30.48.92 50335 22', 'XDG_DATA_DIRS': '/usr/local/share:/usr/share:/var/lib/snapd/desktop', 'PERL_MM_OPT': 'INSTALL_BASE=/home/morgana/perl5', 'PERL_LOCAL_LIB_ROOT': '/home/morgana/perl5', 'SSH_TTY': '/dev/pts/0', 'MAIL': '/var/mail/morgana', 'TERM': 'xterm', 'SHELL': '/bin/bash', 'PERL5LIB': '/home/morgana/perl5/lib/perl5', 'SHLVL': '1', 'LANGUAGE': 'en_US:', 'MANPATH': '/home/morgana/.git/subrepo/man:', 'LOGNAME': 'morgana', 'DBUS_SESSION_BUS_ADDRESS': 'unix:path=/run/user/17173/bus', 'XDG_RUNTIME_DIR': '/run/user/17173', 'PATH': '/home/morgana/.local/bin:/home/morgana/bin:/home/morgana/perl5/bin:/home/morgana/.git/subrepo/lib:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin', 'LESSOPEN': '| /usr/bin/lesspipe %s', 'OLDPWD': '/home/morgana', '_': '/home/morgana/.local/bin/pre-commit'}, 'stdin': -1, 'stdout': -1, 'stderr': -1}\r\n\r\n.pre-commit-config.yaml\r\n\r\n```yaml\r\nrepos:\r\n  - repo: https://github.com/psf/black\r\n    rev: stable\r\n    hooks:\r\n      - id: black\r\n        language_version: python3.6\r\n        stages: [commit]\r\n  - repo: https://github.com/shellcheck-py/shellcheck-py\r\n    rev: v0.7.1.1\r\n    hooks:\r\n    -   id: shellcheck\r\n        stages: [commit]\r\n  - repo: local\r\n    hooks:\r\n      # Add a ChangeID tag to commit messages that don't have one\r\n      -   id: Change-Id\r\n          name: Add a ChangeID tag to commit messages that don't have one\r\n          entry: change-id\r\n          always_run: true\r\n          language: script\r\n          stages: [commit-msg]\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1496/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1496/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1476", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1476/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1476/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1476/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1476", "id": 627209850, "node_id": "MDU6SXNzdWU2MjcyMDk4NTA=", "number": 1476, "title": "Cannot run --files on Windows", "user": {"login": "harrybiddle", "id": 5887227, "node_id": "MDQ6VXNlcjU4ODcyMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/5887227?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harrybiddle", "html_url": "https://github.com/harrybiddle", "followers_url": "https://api.github.com/users/harrybiddle/followers", "following_url": "https://api.github.com/users/harrybiddle/following{/other_user}", "gists_url": "https://api.github.com/users/harrybiddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/harrybiddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harrybiddle/subscriptions", "organizations_url": "https://api.github.com/users/harrybiddle/orgs", "repos_url": "https://api.github.com/users/harrybiddle/repos", "events_url": "https://api.github.com/users/harrybiddle/events{/privacy}", "received_events_url": "https://api.github.com/users/harrybiddle/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-05-29T11:47:29Z", "updated_at": "2020-06-09T08:54:30Z", "closed_at": "2020-06-08T22:08:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "(pre-commit version 2.4.0) We're running in to an odd issue on Windows\r\n\r\n```\r\n$ pre-commit run --files my_file.py\r\nblack................................................(no files to check)Skipped\r\n```\r\n\r\nHowever, running `pre-commit run --all-files` _will_ correctly format the file. Equally, running `pre-commit run --files my_file.py` in the same repository on a Mac works fine.\r\n\r\nIt's like the file is somehow not being read in Windows... Has anybody else encountered this?", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1476/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1476/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1472", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1472/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1472/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1472/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1472", "id": 625633251, "node_id": "MDU6SXNzdWU2MjU2MzMyNTE=", "number": 1472, "title": "UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 9: invalid start byte", "user": {"login": "DrFobos", "id": 36341495, "node_id": "MDQ6VXNlcjM2MzQxNDk1", "avatar_url": "https://avatars.githubusercontent.com/u/36341495?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DrFobos", "html_url": "https://github.com/DrFobos", "followers_url": "https://api.github.com/users/DrFobos/followers", "following_url": "https://api.github.com/users/DrFobos/following{/other_user}", "gists_url": "https://api.github.com/users/DrFobos/gists{/gist_id}", "starred_url": "https://api.github.com/users/DrFobos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DrFobos/subscriptions", "organizations_url": "https://api.github.com/users/DrFobos/orgs", "repos_url": "https://api.github.com/users/DrFobos/repos", "events_url": "https://api.github.com/users/DrFobos/events{/privacy}", "received_events_url": "https://api.github.com/users/DrFobos/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-05-27T11:59:34Z", "updated_at": "2020-05-27T22:02:42Z", "closed_at": "2020-05-27T22:02:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, there! Get such error on commit.\r\n\r\nProbably, because of cyrillic symbols in user name: 'C:\\\\Users\\\\\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\\...'.\r\n\r\nIs there a way to avoid this problem exept renaming user?\r\n\r\nThanks for your cool product!\r\n\r\n### version information\r\n\r\n```\r\npre-commit version: 2.4.0\r\nsys.version:\r\n    3.6.8 (tags/v3.6.8:3c6b436a57, Dec 24 2018, 00:16:47) [MSC v.1916 64 bit (AMD64)]\r\nsys.executable: c:\\program files\\git\\dev\\core\\venv\\scripts\\python.exe\r\nos.name: nt\r\nsys.platform: win32\r\n```\r\n\r\n### error information\r\n\r\n```\r\nAn unexpected error has occurred: UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 9: invalid start byte\r\n```\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"c:\\program files\\git\\dev\\core\\venv\\lib\\site-packages\\pre_commit\\error_handler.py\", line 56, in error_handler\r\n    yield\r\n  File \"c:\\program files\\git\\dev\\core\\venv\\lib\\site-packages\\pre_commit\\main.py\", line 372, in main\r\n    args=args.rest[1:],\r\n  File \"c:\\program files\\git\\dev\\core\\venv\\lib\\site-packages\\pre_commit\\commands\\hook_impl.py\", line 217, in hook_impl\r\n    return retv | run(config, store, ns)\r\n  File \"c:\\program files\\git\\dev\\core\\venv\\lib\\site-packages\\pre_commit\\commands\\run.py\", line 357, in run\r\n    for hook in all_hooks(config, store)\r\n  File \"c:\\program files\\git\\dev\\core\\venv\\lib\\site-packages\\pre_commit\\repository.py\", line 206, in all_hooks\r\n    for repo in root_config['repos']\r\n  File \"c:\\program files\\git\\dev\\core\\venv\\lib\\site-packages\\pre_commit\\repository.py\", line 207, in <genexpr>\r\n    for hook in _repository_hooks(repo, store, root_config)\r\n  File \"c:\\program files\\git\\dev\\core\\venv\\lib\\site-packages\\pre_commit\\repository.py\", line 182, in _repository_hooks\r\n    return _cloned_repository_hooks(repo_config, store, root_config)\r\n  File \"c:\\program files\\git\\dev\\core\\venv\\lib\\site-packages\\pre_commit\\repository.py\", line 162, in _cloned_repository_hooks\r\n    for hook in repo_config['hooks']\r\n  File \"c:\\program files\\git\\dev\\core\\venv\\lib\\site-packages\\pre_commit\\repository.py\", line 162, in <listcomp>\r\n    for hook in repo_config['hooks']\r\n  File \"c:\\program files\\git\\dev\\core\\venv\\lib\\site-packages\\pre_commit\\repository.py\", line 110, in _hook\r\n    ret['language_version'] = languages[lang].get_default_version()\r\n  File \"c:\\program files\\git\\dev\\core\\venv\\lib\\site-packages\\pre_commit\\languages\\python.py\", line 113, in get_default_version\r\n    if _find_by_py_launcher(exe):\r\n  File \"c:\\program files\\git\\dev\\core\\venv\\lib\\site-packages\\pre_commit\\languages\\python.py\", line 72, in _find_by_py_launcher\r\n    return cmd_output(*cmd)[1].strip()\r\n  File \"c:\\program files\\git\\dev\\core\\venv\\lib\\site-packages\\pre_commit\\util.py\", line 164, in cmd_output\r\n    stdout = stdout_b.decode() if stdout_b is not None else None\r\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 9: invalid start byte\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1472/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1472/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1447", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1447/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1447/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1447/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1447", "id": 615504607, "node_id": "MDU6SXNzdWU2MTU1MDQ2MDc=", "number": 1447, "title": "Unhandled yaml.scanner.ScannerError when trying autoupdate with a malformed pre-commit config", "user": {"login": "rpdelaney", "id": 1139517, "node_id": "MDQ6VXNlcjExMzk1MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1139517?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rpdelaney", "html_url": "https://github.com/rpdelaney", "followers_url": "https://api.github.com/users/rpdelaney/followers", "following_url": "https://api.github.com/users/rpdelaney/following{/other_user}", "gists_url": "https://api.github.com/users/rpdelaney/gists{/gist_id}", "starred_url": "https://api.github.com/users/rpdelaney/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rpdelaney/subscriptions", "organizations_url": "https://api.github.com/users/rpdelaney/orgs", "repos_url": "https://api.github.com/users/rpdelaney/repos", "events_url": "https://api.github.com/users/rpdelaney/events{/privacy}", "received_events_url": "https://api.github.com/users/rpdelaney/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-05-10T23:55:06Z", "updated_at": "2020-05-11T19:36:25Z", "closed_at": "2020-05-11T02:48:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "In migrate_config.py we catch `yaml.YAMLError` on [lines 31-36](https://github.com/pre-commit/pre-commit/blob/master/pre_commit/commands/migrate_config.py#L31-L36) (of which `yaml.scanner.ScannerError` is a subclass), but when the exception is raised on line 28, it is unhandled.\r\n\r\n```console\r\n$ pre-commit autoupdate\r\nAn unexpected error has occurred: ScannerError: mapping values are not allowed in this context\r\n  in \"<unicode string>\", line 2, column 6\r\nCheck the log at /home/ryan/.cache/pre-commit/pre-commit.log\r\n```\r\n\r\n### version information\r\n\r\n```\r\npre-commit version: 2.3.0\r\nsys.version:\r\n    3.8.2 (default, Apr  8 2020, 14:31:25) \r\n    [GCC 9.3.0]\r\nsys.executable: /home/ryan/.local/pipx/venvs/pre-commit/bin/python\r\nos.name: posix\r\nsys.platform: linux\r\n```\r\n\r\n### error information\r\n\r\n```\r\nAn unexpected error has occurred: ScannerError: mapping values are not allowed in this context\r\n  in \"<unicode string>\", line 2, column 6\r\n```\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/ryan/.local/pipx/venvs/pre-commit/lib/python3.8/site-packages/pre_commit/error_handler.py\", line 56, in error_handler\r\n    yield\r\n  File \"/home/ryan/.local/pipx/venvs/pre-commit/lib/python3.8/site-packages/pre_commit/main.py\", line 354, in main\r\n    return autoupdate(\r\n  File \"/home/ryan/.local/pipx/venvs/pre-commit/lib/python3.8/site-packages/pre_commit/commands/autoupdate.py\", line 141, in autoupdate\r\n    migrate_config(config_file, quiet=True)\r\n  File \"/home/ryan/.local/pipx/venvs/pre-commit/lib/python3.8/site-packages/pre_commit/commands/migrate_config.py\", line 49, in migrate_config\r\n    contents = _migrate_map(contents)\r\n  File \"/home/ryan/.local/pipx/venvs/pre-commit/lib/python3.8/site-packages/pre_commit/commands/migrate_config.py\", line 28, in _migrate_map\r\n    if isinstance(yaml_load(contents), list):\r\n  File \"/home/ryan/.local/pipx/venvs/pre-commit/lib/python3.8/site-packages/yaml/__init__.py\", line 114, in load\r\n    return loader.get_single_data()\r\n  File \"/home/ryan/.local/pipx/venvs/pre-commit/lib/python3.8/site-packages/yaml/constructor.py\", line 49, in get_single_data\r\n    node = self.get_single_node()\r\n  File \"ext/_yaml.pyx\", line 707, in _yaml.CParser.get_single_node\r\n  File \"ext/_yaml.pyx\", line 726, in _yaml.CParser._compose_document\r\n  File \"ext/_yaml.pyx\", line 905, in _yaml.CParser._parse_next_event\r\nyaml.scanner.ScannerError: mapping values are not allowed in this context\r\n  in \"<unicode string>\", line 2, column 6\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1447/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1447/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1418", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1418/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1418/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1418/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1418", "id": 608442571, "node_id": "MDU6SXNzdWU2MDg0NDI1NzE=", "number": 1418, "title": "post-checkout hook prevents pre-commit hooks from working with unstaged files", "user": {"login": "domodwyer", "id": 9275968, "node_id": "MDQ6VXNlcjkyNzU5Njg=", "avatar_url": "https://avatars.githubusercontent.com/u/9275968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/domodwyer", "html_url": "https://github.com/domodwyer", "followers_url": "https://api.github.com/users/domodwyer/followers", "following_url": "https://api.github.com/users/domodwyer/following{/other_user}", "gists_url": "https://api.github.com/users/domodwyer/gists{/gist_id}", "starred_url": "https://api.github.com/users/domodwyer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/domodwyer/subscriptions", "organizations_url": "https://api.github.com/users/domodwyer/orgs", "repos_url": "https://api.github.com/users/domodwyer/repos", "events_url": "https://api.github.com/users/domodwyer/events{/privacy}", "received_events_url": "https://api.github.com/users/domodwyer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 742693017, "node_id": "MDU6TGFiZWw3NDI2OTMwMTc=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/good-first-issue", "name": "good-first-issue", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-04-28T16:14:43Z", "updated_at": "2020-05-02T21:47:39Z", "closed_at": "2020-05-02T21:47:39Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi there!\r\n\r\nMost important thing first: pre-commit is great, it makes managing git hooks trivial and when combined with static analysis hooks, helps our team immeasurably - **thanks for all the hard work**.\r\n\r\nWe have pre-commit hooks that run a bunch of checks, and thanks to #1339,  a post-checkout hook that does some workspace analysis and prints a few warnings if needed. \r\n\r\nUnfortunately this seems to have broken the \"stash unstaged changes\" behaviour when committing - the stash [runs a git checkout](https://github.com/pre-commit/pre-commit/blob/5a625013071877a5b5dc8eba5b25c791c9c9c6ec/pre_commit/staged_files_only.py#L60) to clear the working directory before running the hooks, and that fails because of the post-checkout hook. I'd expect that the working directory to be cleared as normal, commit OK and then the working directory to be restored as it does without the post-checkout hook, as the actual mechanism behind removing the unstaged changes and restoring them is hidden from the user.\r\n\r\nBelow is a quick test to reproduce it:\r\n\r\n```bash\r\n#!/usr/bin/env bash\r\n\r\nmkdir test\r\ncd test || exit\r\ngit init\r\n\r\n# Configure a pre-commit and post-checkout hook\r\ncat << EOF > .pre-commit-config.yaml\r\nrepos:\r\n  - repo: local\r\n    hooks:\r\n      - id: pre-commit-ok\r\n        name: Pre-commit hook that always passes\r\n        stages: [commit]\r\n        language: system\r\n        entry: sh -c 'exit 0'\r\n        always_run: true\r\n\r\n  - repo: local\r\n    hooks:\r\n      - id: post-checkout-fail\r\n        name: Post-checkout hook that fails\r\n        stages: [post-checkout]\r\n        language: system\r\n        entry: sh -c 'exit 1'\r\n        always_run: true\r\n\r\nEOF\r\n\r\necho \"bananas\" > great-things.txt\r\ngit add .\r\ngit commit -m \"init\"\r\n\r\n# Install the hooks\r\npre-commit install -t pre-commit\r\npre-commit install -t post-checkout\r\n\r\n# Do a checkout - this is expected to print an error from the lint\r\ngit checkout -b test\r\n\r\n# Change the original file\r\necho \"platanos\" >> great-things.txt\r\n\r\n# Add another file and stage it\r\necho \"42\" > answer.txt\r\ngit add answer.txt\r\n\r\n# Attempt to commit the new, staged file.\r\n#\r\n# Without the post-checkout hook, this causes the unstaged changes to be\r\n# stashed and the commit works as normal.\r\necho \"\"\r\necho \"\"\r\necho \"    Attempting to commit with unstaged changes\"\r\necho \"    This will fail when attempting to checkout as part of the commit hook:\"\r\necho \"\"\r\necho \"\"\r\ngit commit -m \"more info\"\r\n```\r\n\r\nUnfortunately there seems to be no easy way to skip the post-checkout hook when clearing the unstaged files with `git checkout`.\r\n\r\nHappy to open a PR to help fix this, just unsure what to do - I could swap the `git checkout` for a `git stash save --keep-index --include-untracked` but I assume it is using checkout for reason.", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1418/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1418/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1398", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1398/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1398/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1398/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1398", "id": 601792813, "node_id": "MDU6SXNzdWU2MDE3OTI4MTM=", "number": 1398, "title": "On a Windows system, in either win7 or win2012R2, performing a pre-commit reports an error", "user": {"login": "xiaohuazi123", "id": 45115671, "node_id": "MDQ6VXNlcjQ1MTE1Njcx", "avatar_url": "https://avatars.githubusercontent.com/u/45115671?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xiaohuazi123", "html_url": "https://github.com/xiaohuazi123", "followers_url": "https://api.github.com/users/xiaohuazi123/followers", "following_url": "https://api.github.com/users/xiaohuazi123/following{/other_user}", "gists_url": "https://api.github.com/users/xiaohuazi123/gists{/gist_id}", "starred_url": "https://api.github.com/users/xiaohuazi123/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xiaohuazi123/subscriptions", "organizations_url": "https://api.github.com/users/xiaohuazi123/orgs", "repos_url": "https://api.github.com/users/xiaohuazi123/repos", "events_url": "https://api.github.com/users/xiaohuazi123/events{/privacy}", "received_events_url": "https://api.github.com/users/xiaohuazi123/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-04-17T08:21:56Z", "updated_at": "2020-04-17T15:44:33Z", "closed_at": "2020-04-17T15:21:46Z", "author_association": "NONE", "active_lock_reason": null, "body": " All:\r\nIt looks like the pre-commit is using virtualenv\r\n\r\nI used pre-commit on a Python project.  \r\n\r\nIs there any way to solve this problem?\r\n\r\n\r\nThe following log is excerpted from pre-committee.log  \r\n**Log**\r\n```\r\nAn unexpected error has occurred: CalledProcessError: command: ('C:\\\\Users\\\\Administrator\\\\.cache\\\\pre-commit\\\\repop9_0qne0\\\\py_env-default\\\\Scripts\\\\pip.EXE', 'install', '.')\r\nreturn code: 1\r\nexpected return code: 0\r\nstdout:\r\n    Looking in indexes: http://pypi.douban.com/simple\r\n    Processing c:\\users\\administrator\\.cache\\pre-commit\\repop9_0qne0\r\n    Collecting six\r\n      Downloading http://pypi.doubanio.com/packages/65/eb/1f97cb97bfc2390a276969c6fae16075da282f5058082d4cb10c6c5c1dba/six-1.14.0-py2.py3-none-any.whl (10 kB)\r\n    Collecting pip-tools==3.6.1\r\n      Downloading http://pypi.doubanio.com/packages/06/96/89872db07ae70770fba97205b0737c17ef013d0d1c790899c16bb8bac419/pip_tools-3.6.1-py2.py3-none-any.whl (35 kB)\r\n    Collecting pip==19.1\r\n      Downloading http://pypi.doubanio.com/packages/f9/fb/863012b13912709c13cf5cfdbfb304fa6c727659d6290438e1a88df9d848/pip-19.1-py2.py3-none-any.whl (1.4 MB)\r\n    Collecting click>=6\r\n      Downloading http://pypi.doubanio.com/packages/dd/c0/4d8f43a9b16e289f36478422031b8a63b54b6ac3b1ba605d602f10dd54d6/click-7.1.1-py2.py3-none-any.whl (82 kB)\r\n    Building wheels for collected packages: pip-tools-compile\r\n      Building wheel for pip-tools-compile (setup.py): started\r\n      Building wheel for pip-tools-compile (setup.py): finished with status 'done'\r\n      Created wheel for pip-tools-compile: filename=pip_tools_compile-1.0-py3-none-any.whl size=17905 sha256=30321f831b5ac147be919304dee138139d055f2bdb52a5511317bc718b29b76d\r\n      Stored in directory: C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\pip-ephem-wheel-cache-b67alovp\\wheels\\f1\\34\\3c\\bed42474e4aeb415aa0bfd1e28124cde97604fa12005eed65b\r\n    Successfully built pip-tools-compile\r\n    Installing collected packages: six, click, pip-tools, pip, pip-tools-compile\r\n      Attempting uninstall: pip\r\n        Found existing installation: pip 20.0.2\r\n        Uninstalling pip-20.0.2:\r\n          Successfully uninstalled pip-20.0.2\r\n    \r\nstderr:\r\n    ERROR: Could not install packages due to an EnvironmentError: [WinError 5] \u62d2\u7edd\u8bbf\u95ee\u3002: 'C:\\\\Users\\\\ADMINI~1\\\\AppData\\\\Local\\\\Temp\\\\pip-uninstall-8wsztgaa\\\\pip.exe'\r\n    Consider using the `--user` option or check the permissions.\r\n    \r\n    \r\n```  \r\n  \r\n```\r\nTraceback (most recent call last):\r\n  File \"c:\\program files\\python37\\lib\\site-packages\\pre_commit\\error_handler.py\", line 56, in error_handler\r\n    yield\r\n  File \"c:\\program files\\python37\\lib\\site-packages\\pre_commit\\main.py\", line 372, in main\r\n    args=args.rest[1:],\r\n  File \"c:\\program files\\python37\\lib\\site-packages\\pre_commit\\commands\\hook_impl.py\", line 187, in hook_impl\r\n    return retv | run(config, store, ns)\r\n  File \"c:\\program files\\python37\\lib\\site-packages\\pre_commit\\commands\\run.py\", line 355, in run\r\n    install_hook_envs(hooks, store)\r\n  File \"c:\\program files\\python37\\lib\\site-packages\\pre_commit\\repository.py\", line 200, in install_hook_envs\r\n    _hook_install(hook)\r\n  File \"c:\\program files\\python37\\lib\\site-packages\\pre_commit\\repository.py\", line 83, in _hook_install\r\n    hook.prefix, hook.language_version, hook.additional_dependencies,\r\n  File \"c:\\program files\\python37\\lib\\site-packages\\pre_commit\\languages\\python.py\", line 197, in install_environment\r\n    prefix, ('pip', 'install', '.') + additional_dependencies,\r\n  File \"c:\\program files\\python37\\lib\\site-packages\\pre_commit\\languages\\helpers.py\", line 25, in run_setup_cmd\r\n    cmd_output_b(*cmd, cwd=prefix.prefix_dir)\r\n  File \"c:\\program files\\python37\\lib\\site-packages\\pre_commit\\util.py\", line 156, in cmd_output_b\r\n    raise CalledProcessError(returncode, cmd, retcode, stdout_b, stderr_b)\r\npre_commit.util.CalledProcessError: <unprintable CalledProcessError object>\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1398/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1398/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1358", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1358/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1358/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1358/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1358", "id": 578486143, "node_id": "MDU6SXNzdWU1Nzg0ODYxNDM=", "number": 1358, "title": "Running pre-commit with Python installed from Windows Store raises UnicodeDecodeError", "user": {"login": "Guts", "id": 1596222, "node_id": "MDQ6VXNlcjE1OTYyMjI=", "avatar_url": "https://avatars.githubusercontent.com/u/1596222?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Guts", "html_url": "https://github.com/Guts", "followers_url": "https://api.github.com/users/Guts/followers", "following_url": "https://api.github.com/users/Guts/following{/other_user}", "gists_url": "https://api.github.com/users/Guts/gists{/gist_id}", "starred_url": "https://api.github.com/users/Guts/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Guts/subscriptions", "organizations_url": "https://api.github.com/users/Guts/orgs", "repos_url": "https://api.github.com/users/Guts/repos", "events_url": "https://api.github.com/users/Guts/events{/privacy}", "received_events_url": "https://api.github.com/users/Guts/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 740044921, "node_id": "MDU6TGFiZWw3NDAwNDQ5MjE=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/upstream-bug", "name": "upstream-bug", "color": "fc2929", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-03-10T10:40:15Z", "updated_at": "2020-03-14T15:39:33Z", "closed_at": "2020-03-10T16:45:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "I think it's a special use case and maybe related to the [known issues of this kind of installation](https://docs.python.org/3.7/using/windows.html#known-issues), but still interesting to track it in issues isn't?\r\n\r\nAnd the kind of error surprised me: `UnicodeDecodeError`.\r\n\r\n**Reproduce**\r\n\r\n1. Install Python through Windows Store\r\n2. Create a virtualenv\r\n3. Install pre-commit and run the hooks\r\n\r\n**Environment**\r\n\r\n- Windows 10 64 bits\r\n- Python 3.7.6 installed from Windows Store (see: https://docs.python.org/3.7/using/windows.html#windows-store)\r\n\r\n**Trace**\r\n\r\n```python\r\n[WARNING] Unstaged files detected.\r\n[INFO] Stashing unstaged files to C:\\Users\\username/.cache\\pre-commit\\patch1583836330.\r\n[INFO] Initializing environment for https://github.com/pre-commit/pre-commit-hooks.\r\n[INFO] Initializing environment for https://github.com/python/black.\r\n[INFO] Installing environment for https://github.com/pre-commit/pre-commit-hooks.\r\n[INFO] Once installed this environment will be reused.\r\n[INFO] This may take a few minutes...\r\n[INFO] Restored changes from C:\\Users\\username/.cache\\pre-commit\\patch1583836330.\r\nTraceback (most recent call last):\r\n  File \"d:\\username\\doculents\\git\\test-project\\.venv\\lib\\site-packages\\pre_commit\\error_handler.py\", line 54, in error_handler\r\n    yield\r\n  File \"d:\\username\\doculents\\git\\test-project\\.venv\\lib\\site-packages\\pre_commit\\main.py\", line 371, in main\r\n    return run(args.config, store, args)\r\n  File \"d:\\username\\doculents\\git\\test-project\\.venv\\lib\\site-packages\\pre_commit\\commands\\run.py\", line 337, in run\r\n    install_hook_envs(hooks, store)\r\n  File \"d:\\username\\doculents\\git\\test-project\\.venv\\lib\\site-packages\\pre_commit\\repository.py\", line 200, in install_hook_envs\r\n    _hook_install(hook)\r\n  File \"d:\\username\\doculents\\git\\test-project\\.venv\\lib\\site-packages\\pre_commit\\repository.py\", line 83, in _hook_install\r\n    hook.prefix, hook.language_version, hook.additional_dependencies,\r\n  File \"d:\\username\\doculents\\git\\test-project\\.venv\\lib\\site-packages\\pre_commit\\languages\\python.py\", line 192, in install_environment\r\n    _make_venv(env_dir, python)\r\n  File \"d:\\username\\doculents\\git\\test-project\\.venv\\lib\\site-packages\\pre_commit\\languages\\python.py\", line 204, in make_venv\r\n    cmd_output_b(*cmd, env=env, cwd='/')\r\n  File \"d:\\username\\doculents\\git\\test-project\\.venv\\lib\\site-packages\\pre_commit\\util.py\", line 140, in cmd_output_b\r\n    raise CalledProcessError(returncode, cmd, retcode, stdout_b, stderr_b)\r\npre_commit.util.CalledProcessError: <exception str() failed>\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.7_3.7.1776.0_x64__qbz5n2kfra8p0\\lib\\runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.7_3.7.1776.0_x64__qbz5n2kfra8p0\\lib\\runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"D:\\username\\doculents\\git\\test-project\\.venv\\Scripts\\pre-commit.exe\\__main__.py\", line 7, in <module>\r\n  File \"d:\\username\\doculents\\git\\test-project\\.venv\\lib\\site-packages\\pre_commit\\main.py\", line 384, in main\r\n    f'Command {args.command} failed to exit with a returncode',\r\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.7_3.7.1776.0_x64__qbz5n2kfra8p0\\lib\\contextlib.py\", line 130, in __exit__\r\n    self.gen.throw(type, value, traceback)\r\n  File \"d:\\username\\doculents\\git\\test-project\\.venv\\lib\\site-packages\\pre_commit\\error_handler.py\", line 62, in error_handler\r\n    _log_and_exit(msg, e, traceback.format_exc())\r\n  File \"d:\\username\\doculents\\git\\test-project\\.venv\\lib\\site-packages\\pre_commit\\error_handler.py\", line 18, in _log_and_exit\r\n    error_msg = f'{msg}: {type(exc).__name__}: {exc}'\r\n  File \"d:\\username\\doculents\\git\\test-project\\.venv\\lib\\site-packages\\pre_commit\\util.py\", line 115, in __str__\r\n    return self.__bytes__().decode()\r\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 341: invalid continuation byte\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1358/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1358/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1350", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1350/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1350/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1350/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1350", "id": 574252539, "node_id": "MDU6SXNzdWU1NzQyNTI1Mzk=", "number": 1350, "title": "\"script\" language without a shebang causes unexpected OSError", "user": {"login": "chriselion", "id": 6877802, "node_id": "MDQ6VXNlcjY4Nzc4MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/6877802?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chriselion", "html_url": "https://github.com/chriselion", "followers_url": "https://api.github.com/users/chriselion/followers", "following_url": "https://api.github.com/users/chriselion/following{/other_user}", "gists_url": "https://api.github.com/users/chriselion/gists{/gist_id}", "starred_url": "https://api.github.com/users/chriselion/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chriselion/subscriptions", "organizations_url": "https://api.github.com/users/chriselion/orgs", "repos_url": "https://api.github.com/users/chriselion/repos", "events_url": "https://api.github.com/users/chriselion/events{/privacy}", "received_events_url": "https://api.github.com/users/chriselion/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-02T21:15:18Z", "updated_at": "2020-03-14T06:30:26Z", "closed_at": "2020-03-12T18:15:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "Repro steps:\r\nCreate a script hook.\r\n```\r\n-   repo: local\r\n    hooks:\r\n    -   id: foo\r\n        name: foo\r\n        language: script\r\n        entry: foo.py\r\n        types: [python]\r\n```\r\n`foo.py` can be empty.\r\n\r\nIf foo.py is not executable, `pre-commit run foo --all-files` produces a reasonable error message:\r\n```\r\nfoo......................................................................Failed\r\n- hook id: foo\r\n- exit code: 1\r\n\r\nExecutable `/[redacted]/foo.py` is not executable\r\n```\r\n\r\nHowever, if it is executable but doesn't not contain a shebang, you get\r\n```\r\n$ pre-commit run foo --all-files\r\nfoo......................................................................An unexpected error has occurred: OSError: [Errno 8] Exec format error: '/[redacted]/foo.py'\r\nCheck the log at /[redacted]/.cache/pre-commit/pre-commit.log\r\n```\r\n\r\nLog contents:\r\n### version information\r\n\r\n```\r\npre-commit version: 2.1.1\r\nsys.version:\r\n    3.7.6 (default, Dec 30 2019, 19:38:28) \r\n    [Clang 11.0.0 (clang-1100.0.33.16)]\r\nsys.executable: /[redacted]/venv/bin/python3\r\nos.name: posix\r\nsys.platform: darwin\r\n```\r\n\r\n### error information\r\n\r\n```\r\nAn unexpected error has occurred: OSError: [Errno 8] Exec format error: '/[redacted]/foo.py'\r\n```\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/[redacted]/venv/lib/python3.7/site-packages/pre_commit/error_handler.py\", line 54, in error_handler\r\n    yield\r\n  File \"/[redacted]/venv/lib/python3.7/site-packages/pre_commit/main.py\", line 371, in main\r\n    return run(args.config, store, args)\r\n  File \"/[redacted]/venv/lib/python3.7/site-packages/pre_commit/commands/run.py\", line 339, in run\r\n    return _run_hooks(config, hooks, args, environ)\r\n  File \"/[redacted]/venv/lib/python3.7/site-packages/pre_commit/commands/run.py\", line 249, in _run_hooks\r\n    verbose=args.verbose, use_color=args.color,\r\n  File \"/[redacted]/venv/lib/python3.7/site-packages/pre_commit/commands/run.py\", line 165, in _run_single_hook\r\n    retcode, out = language.run_hook(hook, filenames, use_color)\r\n  File \"/[redacted]/venv/lib/python3.7/site-packages/pre_commit/languages/script.py\", line 19, in run_hook\r\n    return helpers.run_xargs(hook, cmd, file_args, color=color)\r\n  File \"/[redacted]/venv/lib/python3.7/site-packages/pre_commit/languages/helpers.py\", line 109, in run_xargs\r\n    return xargs(cmd, file_args, **kwargs)\r\n  File \"/[redacted]/venv/lib/python3.7/site-packages/pre_commit/xargs.py\", line 153, in xargs\r\n    for proc_retcode, proc_out, _ in results:\r\n  File \"/usr/local/Cellar/python/3.7.6_1/Frameworks/Python.framework/Versions/3.7/lib/python3.7/concurrent/futures/_base.py\", line 598, in result_iterator\r\n    yield fs.pop().result()\r\n  File \"/usr/local/Cellar/python/3.7.6_1/Frameworks/Python.framework/Versions/3.7/lib/python3.7/concurrent/futures/_base.py\", line 428, in result\r\n    return self.__get_result()\r\n  File \"/usr/local/Cellar/python/3.7.6_1/Frameworks/Python.framework/Versions/3.7/lib/python3.7/concurrent/futures/_base.py\", line 384, in __get_result\r\n    raise self._exception\r\n  File \"/usr/local/Cellar/python/3.7.6_1/Frameworks/Python.framework/Versions/3.7/lib/python3.7/concurrent/futures/thread.py\", line 57, in run\r\n    result = self.fn(*self.args, **self.kwargs)\r\n  File \"/[redacted]/venv/lib/python3.7/site-packages/pre_commit/xargs.py\", line 146, in run_cmd_partition\r\n    *run_cmd, retcode=None, stderr=subprocess.STDOUT, **kwargs,\r\n  File \"/[redacted]/venv/lib/python3.7/site-packages/pre_commit/util.py\", line 208, in cmd_output_p\r\n    proc = subprocess.Popen(cmd, **kwargs)\r\n  File \"/usr/local/Cellar/python/3.7.6_1/Frameworks/Python.framework/Versions/3.7/lib/python3.7/subprocess.py\", line 800, in __init__\r\n    restore_signals, start_new_session)\r\n  File \"/usr/local/Cellar/python/3.7.6_1/Frameworks/Python.framework/Versions/3.7/lib/python3.7/subprocess.py\", line 1551, in _execute_child\r\n    raise child_exception_type(errno_num, err_msg, err_filename)\r\nOSError: [Errno 8] Exec format error: '/[redacted]/foo.py'\r\n\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1350/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1350/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1253", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1253/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1253/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1253/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1253", "id": 542380263, "node_id": "MDU6SXNzdWU1NDIzODAyNjM=", "number": 1253, "title": "Running `pre-commit` 1.20.0 on Guix gives server certificate verification failed. CAfile: none CRLfile: none", "user": {"login": "igankevich", "id": 9788554, "node_id": "MDQ6VXNlcjk3ODg1NTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/9788554?v=4", "gravatar_id": "", "url": "https://api.github.com/users/igankevich", "html_url": "https://github.com/igankevich", "followers_url": "https://api.github.com/users/igankevich/followers", "following_url": "https://api.github.com/users/igankevich/following{/other_user}", "gists_url": "https://api.github.com/users/igankevich/gists{/gist_id}", "starred_url": "https://api.github.com/users/igankevich/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/igankevich/subscriptions", "organizations_url": "https://api.github.com/users/igankevich/orgs", "repos_url": "https://api.github.com/users/igankevich/repos", "events_url": "https://api.github.com/users/igankevich/events{/privacy}", "received_events_url": "https://api.github.com/users/igankevich/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 742693017, "node_id": "MDU6TGFiZWw3NDI2OTMwMTc=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/good-first-issue", "name": "good-first-issue", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-12-25T19:59:35Z", "updated_at": "2020-01-03T17:38:18Z", "closed_at": "2019-12-26T18:22:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "Running `pre-commit` 1.20.0 on Guix gives\r\n\r\n```\r\nAn unexpected error has occurred: CalledProcessError: Command: ('/home/igankevich/.guix-profile/bin/git', 'fetch', 'origin', '--tags')\r\nReturn code: 128\r\nExpected return code: 0\r\nOutput: (none)\r\nErrors:\r\n    fatal: unable to access 'https://github.com/pre-commit/pre-commit-hooks/': server certificate verification failed. CAfile: none CRLfile: none\r\n\r\nTraceback (most recent call last):\r\n  File \"/gnu/store/35ppc0zpffbzc6zsw9xnks1hxmr7wh19-python-pre-commit-1.20.0/lib/python3.7/site-packages/pre_commit/store.py\", line 168, in clone_strategy\r\n    self._shallow_clone(ref, _git_cmd)\r\n  File \"/gnu/store/35ppc0zpffbzc6zsw9xnks1hxmr7wh19-python-pre-commit-1.20.0/lib/python3.7/site-packages/pre_commit/store.py\", line 150, in _shallow_clone\r\n    git_cmd('-c', git_config, 'fetch', 'origin', ref, '--depth=1')\r\n  File \"/gnu/store/35ppc0zpffbzc6zsw9xnks1hxmr7wh19-python-pre-commit-1.20.0/lib/python3.7/site-packages/pre_commit/store.py\", line 165, in _git_cmd\r\n    cmd_output_b('git', *args, cwd=directory, env=env)\r\n  File \"/gnu/store/35ppc0zpffbzc6zsw9xnks1hxmr7wh19-python-pre-commit-1.20.0/lib/python3.7/site-packages/pre_commit/util.py\", line 147, in cmd_output_b\r\n    returncode, cmd, retcode, output=(stdout_b, stderr_b),\r\npre_commit.util.CalledProcessError: Command: ('/home/igankevich/.guix-profile/bin/git', '-c', 'protocol.version=2', 'fetch', 'origin', 'v2.4.0', '--depth=1')\r\nReturn code: 128\r\nExpected return code: 0\r\nOutput: (none)\r\nErrors:\r\n    fatal: unable to access 'https://github.com/pre-commit/pre-commit-hooks/': server certificate verification failed. CAfile: none CRLfile: none\r\n```\r\n\r\nIt looks like pre-commit sanitises GIT_SSL_CAINFO environment variable. Guix uses this variable to specify the path to the certificates. I fixed this bug by _whitelisting_ GIT_SSL_CAINFO in `no_git_env` in `pre_commit/git.py`.", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1253/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1253/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1192", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1192/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1192/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1192/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1192", "id": 513286310, "node_id": "MDU6SXNzdWU1MTMyODYzMTA=", "number": 1192, "title": "pre-commit install yields FileExistsError: [Errno 17] File exists: '/Users/vsts/.cache/pre-commit'", "user": {"login": "raholler", "id": 44190900, "node_id": "MDQ6VXNlcjQ0MTkwOTAw", "avatar_url": "https://avatars.githubusercontent.com/u/44190900?v=4", "gravatar_id": "", "url": "https://api.github.com/users/raholler", "html_url": "https://github.com/raholler", "followers_url": "https://api.github.com/users/raholler/followers", "following_url": "https://api.github.com/users/raholler/following{/other_user}", "gists_url": "https://api.github.com/users/raholler/gists{/gist_id}", "starred_url": "https://api.github.com/users/raholler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/raholler/subscriptions", "organizations_url": "https://api.github.com/users/raholler/orgs", "repos_url": "https://api.github.com/users/raholler/repos", "events_url": "https://api.github.com/users/raholler/events{/privacy}", "received_events_url": "https://api.github.com/users/raholler/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-10-28T12:55:39Z", "updated_at": "2019-10-28T23:39:33Z", "closed_at": "2019-10-28T22:14:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Problem**: pre-commit install sometimes (not always) returns: FileExistsError: [Errno 17] File exists: \\'/Users/vsts/.cache/pre-commit\\'\r\n\r\n**OS**: Occurs on Ubuntu and Mac, not tested for Windows.\r\n\r\n**Setup**: For our cookiecutter project (https://github.com/hmgaudecker/econ-project-templates), we use pytests to test if the projected created fails our pre-commit hooks. We run the pytests on azure. The project is tested for multiple project configurations. \r\n\r\nThe tests are setup in the following way:\r\n```python \r\ndef _check_pre_commit(result):\r\n    subprocess.Popen(\r\n        \"pre-commit install\",\r\n        stdout=subprocess.PIPE,\r\n        stderr=subprocess.PIPE,\r\n        shell=True,\r\n        cwd=result.project,\r\n    )\r\n    c = subprocess.Popen(\r\n        \"pre-commit run --all-files\",\r\n        stdout=subprocess.PIPE,\r\n        stderr=subprocess.PIPE,\r\n        shell=True,\r\n        cwd=result.project,\r\n    )\r\n    output, error = c.communicate()\r\n\r\n    failure = re.search(r\"Failed\", str(output))\r\n    if failure is not None:\r\n        print(output)\r\n        raise AssertionError(\"Some pre-commit failed.\")\r\n    # Not trivial to check for empty string if it might be binary stream\r\n    assert len(error) == 0, \"{}\".format(str(error))\r\n    assert re.search(\r\n        r\"(Passed|Failed)\", str(output)\r\n    ), \"All files skipped by pre-commit.\"\r\n```\r\nwere result.project is a temporary directory created.\r\n\r\n**Expected Output**: Should fail if a pre-commit fails, and pass otherwise.\r\n\r\n**Output**: The first of the pre-commit tests fails on a non-systematic basis, sometimes only on Linux, sometimes only on Mac OS, with the ouput:\r\n\r\n```An unexpected error has occurred: FileExistsError: [Errno 17] File exists: \\'/Users/vsts/.cache/pre-commit\\'\\\\nCheck the log at /Users/vsts/.cache/pre-commit/pre-commit.log\\\\n```\r\n\r\nThe subsequent tests pass on each operating system.\r\n\r\nUPDATE: full log contents:\r\n```\r\n019-10-21T13:00:08.5581220Z ##[section]Starting: Run pytests.\r\n2019-10-21T13:00:08.5588010Z ==============================================================================\r\n2019-10-21T13:00:08.5588250Z Task         : Bash\r\n2019-10-21T13:00:08.5588370Z Description  : Run a Bash script on macOS, Linux, or Windows\r\n2019-10-21T13:00:08.5588560Z Version      : 3.151.3\r\n2019-10-21T13:00:08.5588680Z Author       : Microsoft Corporation\r\n2019-10-21T13:00:08.5588880Z Help         : https://docs.microsoft.com/azure/devops/pipelines/tasks/utility/bash\r\n2019-10-21T13:00:08.5589020Z ==============================================================================\r\n2019-10-21T13:00:08.7618090Z Generating script.\r\n2019-10-21T13:00:08.7670820Z ========================== Starting Command Output ===========================\r\n2019-10-21T13:00:08.7702280Z [command]/bin/bash --noprofile --norc /Users/vsts/agent/2.158.0/work/_temp/066caadb-d509-4ebf-b933-863eae05fa12.sh\r\n2019-10-21T13:00:23.3554080Z ============================= test session starts ==============================\r\n2019-10-21T13:00:23.3561040Z platform darwin -- Python 3.7.4, pytest-5.2.1, py-1.8.0, pluggy-0.13.0\r\n2019-10-21T13:00:23.3655960Z rootdir: /Users/vsts/agent/2.158.0/work/1/s\r\n2019-10-21T13:00:23.3657390Z plugins: cookies-0.4.0, pythonpath-0.7.3, cov-2.8.1\r\n2019-10-21T13:00:24.0809650Z collected 27 items\r\n2019-10-21T13:00:24.0849280Z \r\n2019-10-21T13:01:45.0038630Z tests/test_cookie.py ........                                            [ 29%]\r\n2019-10-21T13:03:21.6364550Z tests/test_pre_commit.py F.....                                          [ 51%]\r\n2019-10-21T13:06:45.6358110Z tests/test_waf.py .......xxxxxx                                          [100%]\r\n2019-10-21T13:06:45.6372100Z \r\n2019-10-21T13:06:45.6372800Z =================================== FAILURES ===================================\r\n2019-10-21T13:06:45.6373690Z ________________________ test_pre_commit_python_sphinx _________________________\r\n2019-10-21T13:06:45.6374290Z \r\n2019-10-21T13:06:45.6374770Z cookies = <pytest_cookies.plugin.Cookies object at 0x108e5d790>\r\n2019-10-21T13:06:45.6378350Z basic_project_dict = {'_copy_without_render': ['.mywaflib', '*.bib', 'src_matlab/library/matlab-json/*', 'src_stata/library/stata/ado_ext/*'], 'add_basic_pre_commit_hooks': 'y', 'add_intrusive_pre_commit': 'y', 'affiliation': 'Universit\u00e4t Hintertupfingen', ...}\r\n2019-10-21T13:06:45.6378610Z \r\n2019-10-21T13:06:45.6378960Z     def test_pre_commit_python_sphinx(cookies, basic_project_dict):\r\n2019-10-21T13:06:45.6379110Z         basic_project_dict[\"set_up_git\"] = \"y\"\r\n2019-10-21T13:06:45.6379360Z         basic_project_dict[\"make_initial_commit\"] = \"y\"\r\n2019-10-21T13:06:45.6379510Z         basic_project_dict[\"add_basic_pre_commit_hooks\"] = \"y\"\r\n2019-10-21T13:06:45.6382000Z         basic_project_dict[\"add_intrusive_pre_commit\"] = \"y\"\r\n2019-10-21T13:06:45.6382330Z         basic_project_dict[\"configure_running_sphinx_from_waf\"] = \"y\"\r\n2019-10-21T13:06:45.6397850Z         result = cookies.bake(extra_context=basic_project_dict)\r\n2019-10-21T13:06:45.6398120Z >       _check_pre_commit(result)\r\n2019-10-21T13:06:45.6398250Z \r\n2019-10-21T13:06:45.6398370Z tests/test_pre_commit.py:42: \r\n2019-10-21T13:06:45.6398600Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n2019-10-21T13:06:45.6398710Z \r\n2019-10-21T13:06:45.6399950Z result = <Result /private/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/pytest-of-vsts/pytest-0/test_pre_commit_python_sphinx0/cookies/bake00/research_project>\r\n2019-10-21T13:06:45.6400110Z \r\n2019-10-21T13:06:45.6400300Z     def _check_pre_commit(result):\r\n2019-10-21T13:06:45.6400430Z         subprocess.Popen(\r\n2019-10-21T13:06:45.6401160Z             \"pre-commit install\",\r\n2019-10-21T13:06:45.6401310Z             stdout=subprocess.PIPE,\r\n2019-10-21T13:06:45.6401430Z             stderr=subprocess.PIPE,\r\n2019-10-21T13:06:45.6401630Z             shell=True,\r\n2019-10-21T13:06:45.6401750Z             cwd=result.project,\r\n2019-10-21T13:06:45.6401980Z         )\r\n2019-10-21T13:06:45.6402090Z         c = subprocess.Popen(\r\n2019-10-21T13:06:45.6402890Z             \"pre-commit run --all-files\",\r\n2019-10-21T13:06:45.6417140Z             stdout=subprocess.PIPE,\r\n2019-10-21T13:06:45.6417290Z             stderr=subprocess.PIPE,\r\n2019-10-21T13:06:45.6417350Z             shell=True,\r\n2019-10-21T13:06:45.6417540Z             cwd=result.project,\r\n2019-10-21T13:06:45.6417600Z         )\r\n2019-10-21T13:06:45.6417770Z         output, error = c.communicate()\r\n2019-10-21T13:06:45.6417840Z     \r\n2019-10-21T13:06:45.6417980Z         failure = re.search(r\"Failed\", str(output))\r\n2019-10-21T13:06:45.6418060Z         if failure is not None:\r\n2019-10-21T13:06:45.6418160Z             print(output)\r\n2019-10-21T13:06:45.6418770Z             raise AssertionError(\"Some pre-commit failed.\")\r\n2019-10-21T13:06:45.6418920Z         # Not trivial to check for empty string if it might be binary stream\r\n2019-10-21T13:06:45.6419000Z         assert len(error) == 0, \"{}\".format(str(error))\r\n2019-10-21T13:06:45.6419130Z >       assert re.search(\r\n2019-10-21T13:06:45.6419190Z             r\"(Passed|Failed)\", str(output)\r\n2019-10-21T13:06:45.6419630Z         ), \"All files skipped by pre-commit.\"\r\n2019-10-21T13:06:45.6420040Z E       AssertionError: All files skipped by pre-commit.\r\n2019-10-21T13:06:45.6420330Z E       assert None\r\n2019-10-21T13:06:45.6421080Z E        +  where None = <function search at 0x10714eb00>('(Passed|Failed)', 'b\"An unexpected error has occurred: FileExistsError: [Errno 17] File exists: \\'/Users/vsts/.cache/pre-commit\\'\\\\nCheck the log at /Users/vsts/.cache/pre-commit/pre-commit.log\\\\n\"')\r\n2019-10-21T13:06:45.6421370Z E        +    where <function search at 0x10714eb00> = re.search\r\n2019-10-21T13:06:45.6422110Z E        +    and   'b\"An unexpected error has occurred: FileExistsError: [Errno 17] File exists: \\'/Users/vsts/.cache/pre-commit\\'\\\\nCheck the log at /Users/vsts/.cache/pre-commit/pre-commit.log\\\\n\"' = str(b\"An unexpected error has occurred: FileExistsError: [Errno 17] File exists: '/Users/vsts/.cache/pre-commit'\\nCheck the log at /Users/vsts/.cache/pre-commit/pre-commit.log\\n\")\r\n2019-10-21T13:06:45.6422330Z \r\n2019-10-21T13:06:45.6432870Z tests/test_pre_commit.py:30: AssertionError\r\n2019-10-21T13:06:45.6434240Z ----------------------------- Captured stdout call -----------------------------\r\n2019-10-21T13:06:45.6435300Z Initialized empty Git repository in /private/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/pytest-of-vsts/pytest-0/test_pre_commit_python_sphinx0/cookies/bake00/research_project/.git/\r\n2019-10-21T13:06:45.6436360Z [master (root-commit) 9f60b50] 'Initial commit with template from https://github.com/hmgaudecker/econ-project-templates'\r\n2019-10-21T13:06:45.6436670Z  224 files changed, 43497 insertions(+)\r\n2019-10-21T13:06:45.6436820Z  create mode 100755 .gitignore\r\n2019-10-21T13:06:45.6437020Z  create mode 100755 .mywaflib/waflib/Build.py\r\n2019-10-21T13:06:45.6437160Z  create mode 100755 .mywaflib/waflib/ConfigSet.py\r\n2019-10-21T13:06:45.6437290Z  create mode 100755 .mywaflib/waflib/Configure.py\r\n2019-10-21T13:06:45.6438000Z  create mode 100755 .mywaflib/waflib/Context.py\r\n2019-10-21T13:06:45.6438130Z  create mode 100755 .mywaflib/waflib/Errors.py\r\n2019-10-21T13:06:45.6438360Z  create mode 100755 .mywaflib/waflib/Logs.py\r\n2019-10-21T13:06:45.6438500Z  create mode 100755 .mywaflib/waflib/Node.py\r\n2019-10-21T13:06:45.6438690Z  create mode 100755 .mywaflib/waflib/Options.py\r\n2019-10-21T13:06:45.6439020Z  create mode 100755 .mywaflib/waflib/Runner.py\r\n2019-10-21T13:06:45.6439280Z  create mode 100755 .mywaflib/waflib/Scripting.py\r\n2019-10-21T13:06:45.6439400Z  create mode 100755 .mywaflib/waflib/Task.py\r\n2019-10-21T13:06:45.6439590Z  create mode 100755 .mywaflib/waflib/TaskGen.py\r\n2019-10-21T13:06:45.6439720Z  create mode 100755 .mywaflib/waflib/Tools/__init__.py\r\n2019-10-21T13:06:45.6439910Z  create mode 100755 .mywaflib/waflib/Tools/ar.py\r\n2019-10-21T13:06:45.6440030Z  create mode 100755 .mywaflib/waflib/Tools/asm.py\r\n2019-10-21T13:06:45.6440230Z  create mode 100755 .mywaflib/waflib/Tools/bison.py\r\n2019-10-21T13:06:45.6440370Z  create mode 100755 .mywaflib/waflib/Tools/c.py\r\n2019-10-21T13:06:45.6440570Z  create mode 100755 .mywaflib/waflib/Tools/c_aliases.py\r\n2019-10-21T13:06:45.6441220Z  create mode 100755 .mywaflib/waflib/Tools/c_config.py\r\n2019-10-21T13:06:45.6441440Z  create mode 100755 .mywaflib/waflib/Tools/c_osx.py\r\n2019-10-21T13:06:45.6441570Z  create mode 100755 .mywaflib/waflib/Tools/c_preproc.py\r\n2019-10-21T13:06:45.6441770Z  create mode 100755 .mywaflib/waflib/Tools/c_tests.py\r\n2019-10-21T13:06:45.6441900Z  create mode 100755 .mywaflib/waflib/Tools/ccroot.py\r\n2019-10-21T13:06:45.6442080Z  create mode 100755 .mywaflib/waflib/Tools/clang.py\r\n2019-10-21T13:06:45.6442220Z  create mode 100755 .mywaflib/waflib/Tools/clangxx.py\r\n2019-10-21T13:06:45.6442440Z  create mode 100755 .mywaflib/waflib/Tools/compiler_c.py\r\n2019-10-21T13:06:45.6442570Z  create mode 100755 .mywaflib/waflib/Tools/compiler_cxx.py\r\n2019-10-21T13:06:45.6442820Z  create mode 100755 .mywaflib/waflib/Tools/compiler_d.py\r\n2019-10-21T13:06:45.6442960Z  create mode 100755 .mywaflib/waflib/Tools/compiler_fc.py\r\n2019-10-21T13:06:45.6443180Z  create mode 100755 .mywaflib/waflib/Tools/cs.py\r\n2019-10-21T13:06:45.6443330Z  create mode 100755 .mywaflib/waflib/Tools/cxx.py\r\n2019-10-21T13:06:45.6443530Z  create mode 100755 .mywaflib/waflib/Tools/d.py\r\n2019-10-21T13:06:45.6443660Z  create mode 100755 .mywaflib/waflib/Tools/d_config.py\r\n2019-10-21T13:06:45.6443850Z  create mode 100755 .mywaflib/waflib/Tools/d_scan.py\r\n2019-10-21T13:06:45.6444000Z  create mode 100755 .mywaflib/waflib/Tools/dbus.py\r\n2019-10-21T13:06:45.6444200Z  create mode 100755 .mywaflib/waflib/Tools/dmd.py\r\n2019-10-21T13:06:45.6444340Z  create mode 100755 .mywaflib/waflib/Tools/errcheck.py\r\n2019-10-21T13:06:45.6444540Z  create mode 100755 .mywaflib/waflib/Tools/fc.py\r\n2019-10-21T13:06:45.6444680Z  create mode 100755 .mywaflib/waflib/Tools/fc_config.py\r\n2019-10-21T13:06:45.6444870Z  create mode 100755 .mywaflib/waflib/Tools/fc_scan.py\r\n2019-10-21T13:06:45.6445010Z  create mode 100755 .mywaflib/waflib/Tools/flex.py\r\n2019-10-21T13:06:45.6445210Z  create mode 100755 .mywaflib/waflib/Tools/g95.py\r\n2019-10-21T13:06:45.6445360Z  create mode 100755 .mywaflib/waflib/Tools/gas.py\r\n2019-10-21T13:06:45.6445860Z  create mode 100755 .mywaflib/waflib/Tools/gcc.py\r\n2019-10-21T13:06:45.6446020Z  create mode 100755 .mywaflib/waflib/Tools/gdc.py\r\n2019-10-21T13:06:45.6446200Z  create mode 100755 .mywaflib/waflib/Tools/gfortran.py\r\n2019-10-21T13:06:45.6446330Z  create mode 100755 .mywaflib/waflib/Tools/glib2.py\r\n2019-10-21T13:06:45.6446450Z  create mode 100755 .mywaflib/waflib/Tools/gnu_dirs.py\r\n2019-10-21T13:06:45.6494530Z  create mode 100755 .mywaflib/waflib/Tools/gxx.py\r\n2019-10-21T13:06:45.6495120Z  create mode 100755 .mywaflib/waflib/Tools/icc.py\r\n2019-10-21T13:06:45.6495340Z  create mode 100755 .mywaflib/waflib/Tools/icpc.py\r\n2019-10-21T13:06:45.6495490Z  create mode 100755 .mywaflib/waflib/Tools/ifort.py\r\n2019-10-21T13:06:45.6495680Z  create mode 100755 .mywaflib/waflib/Tools/intltool.py\r\n2019-10-21T13:06:45.6495820Z  create mode 100755 .mywaflib/waflib/Tools/irixcc.py\r\n2019-10-21T13:06:45.6496940Z  create mode 100755 .mywaflib/waflib/Tools/javaw.py\r\n2019-10-21T13:06:45.6497260Z  create mode 100755 .mywaflib/waflib/Tools/ldc2.py\r\n2019-10-21T13:06:45.6497590Z  create mode 100755 .mywaflib/waflib/Tools/lua.py\r\n2019-10-21T13:06:45.6497890Z  create mode 100755 .mywaflib/waflib/Tools/md5_tstamp.py\r\n2019-10-21T13:06:45.6498030Z  create mode 100755 .mywaflib/waflib/Tools/msvc.py\r\n2019-10-21T13:06:45.6498250Z  create mode 100755 .mywaflib/waflib/Tools/nasm.py\r\n2019-10-21T13:06:45.6498480Z  create mode 100755 .mywaflib/waflib/Tools/nobuild.py\r\n2019-10-21T13:06:45.6498610Z  create mode 100755 .mywaflib/waflib/Tools/perl.py\r\n2019-10-21T13:06:45.6498680Z  create mode 100755 .mywaflib/waflib/Tools/python.py\r\n2019-10-21T13:06:45.6498870Z  create mode 100755 .mywaflib/waflib/Tools/qt5.py\r\n2019-10-21T13:06:45.6498940Z  create mode 100755 .mywaflib/waflib/Tools/ruby.py\r\n2019-10-21T13:06:45.6499030Z  create mode 100755 .mywaflib/waflib/Tools/suncc.py\r\n2019-10-21T13:06:45.6499110Z  create mode 100755 .mywaflib/waflib/Tools/suncxx.py\r\n2019-10-21T13:06:45.6499210Z  create mode 100755 .mywaflib/waflib/Tools/tex.py\r\n2019-10-21T13:06:45.6501910Z  create mode 100755 .mywaflib/waflib/Tools/vala.py\r\n2019-10-21T13:06:45.6502020Z  create mode 100755 .mywaflib/waflib/Tools/waf_unit_test.py\r\n2019-10-21T13:06:45.6502100Z  create mode 100755 .mywaflib/waflib/Tools/winres.py\r\n2019-10-21T13:06:45.6502190Z  create mode 100755 .mywaflib/waflib/Tools/xlc.py\r\n2019-10-21T13:06:45.6502250Z  create mode 100755 .mywaflib/waflib/Tools/xlcxx.py\r\n2019-10-21T13:06:45.6502350Z  create mode 100755 .mywaflib/waflib/Utils.py\r\n2019-10-21T13:06:45.6502410Z  create mode 100755 .mywaflib/waflib/__init__.py\r\n2019-10-21T13:06:45.6502500Z  create mode 100755 .mywaflib/waflib/ansiterm.py\r\n2019-10-21T13:06:45.6502570Z  create mode 100755 .mywaflib/waflib/extras/__init__.py\r\n2019-10-21T13:06:45.6502670Z  create mode 100755 .mywaflib/waflib/extras/batched_cc.py\r\n2019-10-21T13:06:45.6502740Z  create mode 100755 .mywaflib/waflib/extras/biber.py\r\n2019-10-21T13:06:45.6502850Z  create mode 100755 .mywaflib/waflib/extras/bjam.py\r\n2019-10-21T13:06:45.6502920Z  create mode 100755 .mywaflib/waflib/extras/blender.py\r\n2019-10-21T13:06:45.6503020Z  create mode 100755 .mywaflib/waflib/extras/boo.py\r\n2019-10-21T13:06:45.6503090Z  create mode 100755 .mywaflib/waflib/extras/boost.py\r\n2019-10-21T13:06:45.6503190Z  create mode 100755 .mywaflib/waflib/extras/build_file_tracker.py\r\n2019-10-21T13:06:45.6503260Z  create mode 100755 .mywaflib/waflib/extras/build_logs.py\r\n2019-10-21T13:06:45.6503370Z  create mode 100755 .mywaflib/waflib/extras/buildcopy.py\r\n2019-10-21T13:06:45.6503440Z  create mode 100755 .mywaflib/waflib/extras/c_bgxlc.py\r\n2019-10-21T13:06:45.6503540Z  create mode 100755 .mywaflib/waflib/extras/c_dumbpreproc.py\r\n2019-10-21T13:06:45.6503620Z  create mode 100755 .mywaflib/waflib/extras/c_emscripten.py\r\n2019-10-21T13:06:45.6503720Z  create mode 100755 .mywaflib/waflib/extras/c_nec.py\r\n2019-10-21T13:06:45.6503790Z  create mode 100755 .mywaflib/waflib/extras/cabal.py\r\n2019-10-21T13:06:45.6503900Z  create mode 100755 .mywaflib/waflib/extras/cfg_altoptions.py\r\n2019-10-21T13:06:45.6503980Z  create mode 100755 .mywaflib/waflib/extras/clang_compilation_database.py\r\n2019-10-21T13:06:45.6504090Z  create mode 100755 .mywaflib/waflib/extras/codelite.py\r\n2019-10-21T13:06:45.6504160Z  create mode 100755 .mywaflib/waflib/extras/color_gcc.py\r\n2019-10-21T13:06:45.6504350Z  create mode 100755 .mywaflib/waflib/extras/color_rvct.py\r\n2019-10-21T13:06:45.6504440Z  create mode 100755 .mywaflib/waflib/extras/compat15.py\r\n2019-10-21T13:06:45.6504540Z  create mode 100755 .mywaflib/waflib/extras/cppcheck.py\r\n2019-10-21T13:06:45.6504610Z  create mode 100755 .mywaflib/waflib/extras/cpplint.py\r\n2019-10-21T13:06:45.6504710Z  create mode 100755 .mywaflib/waflib/extras/cross_gnu.py\r\n2019-10-21T13:06:45.6504780Z  create mode 100755 .mywaflib/waflib/extras/cython.py\r\n2019-10-21T13:06:45.6504890Z  create mode 100755 .mywaflib/waflib/extras/dcc.py\r\n2019-10-21T13:06:45.6504960Z  create mode 100755 .mywaflib/waflib/extras/distnet.py\r\n2019-10-21T13:06:45.6505310Z  create mode 100755 .mywaflib/waflib/extras/doxygen.py\r\n2019-10-21T13:06:45.6505390Z  create mode 100755 .mywaflib/waflib/extras/dpapi.py\r\n2019-10-21T13:06:45.6505500Z  create mode 100755 .mywaflib/waflib/extras/eclipse.py\r\n2019-10-21T13:06:45.6505570Z  create mode 100755 .mywaflib/waflib/extras/erlang.py\r\n2019-10-21T13:06:45.6505680Z  create mode 100755 .mywaflib/waflib/extras/fast_partial.py\r\n2019-10-21T13:06:45.6505750Z  create mode 100755 .mywaflib/waflib/extras/fc_bgxlf.py\r\n2019-10-21T13:06:45.6505850Z  create mode 100755 .mywaflib/waflib/extras/fc_cray.py\r\n2019-10-21T13:06:45.6505920Z  create mode 100755 .mywaflib/waflib/extras/fc_nag.py\r\n2019-10-21T13:06:45.6506030Z  create mode 100755 .mywaflib/waflib/extras/fc_nec.py\r\n2019-10-21T13:06:45.6506110Z  create mode 100755 .mywaflib/waflib/extras/fc_open64.py\r\n2019-10-21T13:06:45.6506170Z  create mode 100755 .mywaflib/waflib/extras/fc_pgfortran.py\r\n2019-10-21T13:06:45.6506280Z  create mode 100755 .mywaflib/waflib/extras/fc_solstudio.py\r\n2019-10-21T13:06:45.6507330Z  create mode 100755 .mywaflib/waflib/extras/fc_xlf.py\r\n2019-10-21T13:06:45.6508390Z  create mode 100755 .mywaflib/waflib/extras/file_to_object.py\r\n2019-10-21T13:06:45.6508480Z  create mode 100755 .mywaflib/waflib/extras/fluid.py\r\n2019-10-21T13:06:45.6508620Z  create mode 100755 .mywaflib/waflib/extras/freeimage.py\r\n2019-10-21T13:06:45.6508690Z  create mode 100755 .mywaflib/waflib/extras/fsb.py\r\n2019-10-21T13:06:45.6508800Z  create mode 100755 .mywaflib/waflib/extras/fsc.py\r\n2019-10-21T13:06:45.6508870Z  create mode 100755 .mywaflib/waflib/extras/gccdeps.py\r\n2019-10-21T13:06:45.6508970Z  create mode 100755 .mywaflib/waflib/extras/gdbus.py\r\n2019-10-21T13:06:45.6509040Z  create mode 100755 .mywaflib/waflib/extras/gob2.py\r\n2019-10-21T13:06:45.6509140Z  create mode 100755 .mywaflib/waflib/extras/halide.py\r\n2019-10-21T13:06:45.6509210Z  create mode 100755 .mywaflib/waflib/extras/javatest.py\r\n2019-10-21T13:06:45.6509310Z  create mode 100755 .mywaflib/waflib/extras/kde4.py\r\n2019-10-21T13:06:45.6509400Z  create mode 100755 .mywaflib/waflib/extras/local_rpath.py\r\n2019-10-21T13:06:45.6509510Z  create mode 100755 .mywaflib/waflib/extras/make.py\r\n2019-10-21T13:06:45.6509590Z  create mode 100755 .mywaflib/waflib/extras/midl.py\r\n2019-10-21T13:06:45.6509690Z  create mode 100755 .mywaflib/waflib/extras/msvcdeps.py\r\n2019-10-21T13:06:45.6509760Z  create mode 100755 .mywaflib/waflib/extras/msvs.py\r\n2019-10-21T13:06:45.6509870Z  create mode 100755 .mywaflib/waflib/extras/netcache_client.py\r\n2019-10-21T13:06:45.6509940Z  create mode 100755 .mywaflib/waflib/extras/objcopy.py\r\n2019-10-21T13:06:45.6510040Z  create mode 100755 .mywaflib/waflib/extras/ocaml.py\r\n2019-10-21T13:06:45.6510110Z  create mode 100755 .mywaflib/waflib/extras/package.py\r\n2019-10-21T13:06:45.6510220Z  create mode 100755 .mywaflib/waflib/extras/parallel_debug.py\r\n2019-10-21T13:06:45.6510290Z  create mode 100755 .mywaflib/waflib/extras/pch.py\r\n2019-10-21T13:06:45.6510390Z  create mode 100755 .mywaflib/waflib/extras/pep8.py\r\n2019-10-21T13:06:45.6510460Z  create mode 100755 .mywaflib/waflib/extras/pgicc.py\r\n2019-10-21T13:06:45.6510570Z  create mode 100755 .mywaflib/waflib/extras/pgicxx.py\r\n2019-10-21T13:06:45.6510640Z  create mode 100755 .mywaflib/waflib/extras/proc.py\r\n2019-10-21T13:06:45.6510750Z  create mode 100755 .mywaflib/waflib/extras/protoc.py\r\n2019-10-21T13:06:45.6510980Z  create mode 100755 .mywaflib/waflib/extras/pyqt5.py\r\n2019-10-21T13:06:45.6511060Z  create mode 100755 .mywaflib/waflib/extras/pytest.py\r\n2019-10-21T13:06:45.6511150Z  create mode 100755 .mywaflib/waflib/extras/qnxnto.py\r\n2019-10-21T13:06:45.6511230Z  create mode 100755 .mywaflib/waflib/extras/qt4.py\r\n2019-10-21T13:06:45.6511290Z  create mode 100755 .mywaflib/waflib/extras/relocation.py\r\n2019-10-21T13:06:45.6511400Z  create mode 100755 .mywaflib/waflib/extras/remote.py\r\n2019-10-21T13:06:45.6511470Z  create mode 100755 .mywaflib/waflib/extras/resx.py\r\n2019-10-21T13:06:45.6511570Z  create mode 100755 .mywaflib/waflib/extras/review.py\r\n2019-10-21T13:06:45.6511640Z  create mode 100755 .mywaflib/waflib/extras/rst.py\r\n2019-10-21T13:06:45.6511990Z  create mode 100755 .mywaflib/waflib/extras/run_do_script.py\r\n2019-10-21T13:06:45.6512070Z  create mode 100644 .mywaflib/waflib/extras/run_jl_script.py\r\n2019-10-21T13:06:45.6512200Z  create mode 100755 .mywaflib/waflib/extras/run_m_script.py\r\n2019-10-21T13:06:45.6512270Z  create mode 100755 .mywaflib/waflib/extras/run_pl_script.py\r\n2019-10-21T13:06:45.6512380Z  create mode 100755 .mywaflib/waflib/extras/run_py_script.py\r\n2019-10-21T13:06:45.6512450Z  create mode 100755 .mywaflib/waflib/extras/run_r_script.py\r\n2019-10-21T13:06:45.6512560Z  create mode 100755 .mywaflib/waflib/extras/sas.py\r\n2019-10-21T13:06:45.6512630Z  create mode 100755 .mywaflib/waflib/extras/satellite_assembly.py\r\n2019-10-21T13:06:45.6512750Z  create mode 100755 .mywaflib/waflib/extras/scala.py\r\n2019-10-21T13:06:45.6512820Z  create mode 100755 .mywaflib/waflib/extras/slow_qt4.py\r\n2019-10-21T13:06:45.6512930Z  create mode 100755 .mywaflib/waflib/extras/softlink_libs.py\r\n2019-10-21T13:06:45.6513010Z  create mode 100755 .mywaflib/waflib/extras/sphinx_build.py\r\n2019-10-21T13:06:45.6513110Z  create mode 100755 .mywaflib/waflib/extras/stale.py\r\n2019-10-21T13:06:45.6513480Z  create mode 100755 .mywaflib/waflib/extras/stracedeps.py\r\n2019-10-21T13:06:45.6513600Z  create mode 100755 .mywaflib/waflib/extras/swig.py\r\n2019-10-21T13:06:45.6513670Z  create mode 100755 .mywaflib/waflib/extras/syms.py\r\n2019-10-21T13:06:45.6513770Z  create mode 100755 .mywaflib/waflib/extras/ticgt.py\r\n2019-10-21T13:06:45.6513840Z  create mode 100755 .mywaflib/waflib/extras/unity.py\r\n2019-10-21T13:06:45.6513940Z  create mode 100755 .mywaflib/waflib/extras/use_config.py\r\n2019-10-21T13:06:45.6514010Z  create mode 100755 .mywaflib/waflib/extras/valadoc.py\r\n2019-10-21T13:06:45.6514110Z  create mode 100755 .mywaflib/waflib/extras/waf_xattr.py\r\n2019-10-21T13:06:45.6514180Z  create mode 100755 .mywaflib/waflib/extras/why.py\r\n2019-10-21T13:06:45.6514280Z  create mode 100755 .mywaflib/waflib/extras/win32_opts.py\r\n2019-10-21T13:06:45.6514350Z  create mode 100755 .mywaflib/waflib/extras/wix.py\r\n2019-10-21T13:06:45.6514480Z  create mode 100755 .mywaflib/waflib/extras/write_project_headers.py\r\n2019-10-21T13:06:45.6514560Z  create mode 100755 .mywaflib/waflib/extras/xcode6.py\r\n2019-10-21T13:06:45.6514660Z  create mode 100755 .mywaflib/waflib/fixpy2.py\r\n2019-10-21T13:06:45.6514730Z  create mode 100755 .mywaflib/waflib/processor.py\r\n2019-10-21T13:06:45.6515700Z  create mode 100644 .pre-commit-config.yaml\r\n2019-10-21T13:06:45.6515780Z  create mode 100755 LICENSE\r\n2019-10-21T13:06:45.6515890Z  create mode 100755 environment.yml\r\n2019-10-21T13:06:45.6515960Z  create mode 100755 src/__init__.py\r\n2019-10-21T13:06:45.6516370Z  create mode 100755 src/analysis/__init__.py\r\n2019-10-21T13:06:45.6516460Z  create mode 100755 src/analysis/schelling.py\r\n2019-10-21T13:06:45.6516550Z  create mode 100755 src/analysis/wscript\r\n2019-10-21T13:06:45.6516620Z  create mode 100755 src/data_management/__init__.py\r\n2019-10-21T13:06:45.6516720Z  create mode 100755 src/data_management/get_simulation_draws.py\r\n2019-10-21T13:06:45.6516810Z  create mode 100755 src/data_management/wscript\r\n2019-10-21T13:06:45.6516900Z  create mode 100755 src/documentation/analysis.rst\r\n2019-10-21T13:06:45.6516980Z  create mode 100755 src/documentation/conf.py\r\n2019-10-21T13:06:45.6517150Z  create mode 100755 src/documentation/data_management.rst\r\n2019-10-21T13:06:45.6517230Z  create mode 100755 src/documentation/final.rst\r\n2019-10-21T13:06:45.6517290Z  create mode 100755 src/documentation/index.rst\r\n2019-10-21T13:06:45.6517400Z  create mode 100755 src/documentation/introduction.rst\r\n2019-10-21T13:06:45.6517470Z  create mode 100755 src/documentation/library.rst\r\n2019-10-21T13:06:45.6517560Z  create mode 100755 src/documentation/model_code.rst\r\n2019-10-21T13:06:45.6517630Z  create mode 100755 src/documentation/model_specs.rst\r\n2019-10-21T13:06:45.6517740Z  create mode 100755 src/documentation/original_data.rst\r\n2019-10-21T13:06:45.6517810Z  create mode 100755 src/documentation/paper.rst\r\n2019-10-21T13:06:45.6517900Z  create mode 100755 src/documentation/references.rst\r\n2019-10-21T13:06:45.6518210Z  create mode 100755 src/documentation/wscript\r\n2019-10-21T13:06:45.6518340Z  create mode 100755 src/final/__init__.py\r\n2019-10-21T13:06:45.6518400Z  create mode 100755 src/final/plot_locations.py\r\n2019-10-21T13:06:45.6518510Z  create mode 100755 src/final/project_dependency_graph.py\r\n2019-10-21T13:06:45.6518570Z  create mode 100755 src/final/wscript\r\n2019-10-21T13:06:45.6518670Z  create mode 100755 src/library/__init__.py\r\n2019-10-21T13:06:45.6518740Z  create mode 100644 src/library/wscript\r\n2019-10-21T13:06:45.6518840Z  create mode 100755 src/model_code/__init__.py\r\n2019-10-21T13:06:45.6518910Z  create mode 100755 src/model_code/agent.py\r\n2019-10-21T13:06:45.6519010Z  create mode 100755 src/model_specs/baseline.json\r\n2019-10-21T13:06:45.6519080Z  create mode 100755 src/model_specs/max_moves_2.json\r\n2019-10-21T13:06:45.6519170Z  create mode 100644 src/original_data/dummy.txt\r\n2019-10-21T13:06:45.6519240Z  create mode 100755 src/paper/formulas/decision_rule.tex\r\n2019-10-21T13:06:45.6519350Z  create mode 100644 src/paper/refs.bib\r\n2019-10-21T13:06:45.6519410Z  create mode 100755 src/paper/research_paper.tex\r\n2019-10-21T13:06:45.6519810Z  create mode 100755 src/paper/research_pres_30min.tex\r\n2019-10-21T13:06:45.6519880Z  create mode 100755 src/paper/wscript\r\n2019-10-21T13:06:45.6519970Z  create mode 100755 src/sandbox/few_agents.ipynb\r\n2019-10-21T13:06:45.6520040Z  create mode 100755 src/wscript\r\n2019-10-21T13:06:45.6520130Z  create mode 100755 waf.py\r\n2019-10-21T13:06:45.6520190Z  create mode 100755 wscript\r\n2019-10-21T13:06:45.6520290Z =============================== warnings summary ===============================\r\n2019-10-21T13:06:45.6520370Z tests/test_pre_commit.py::test_pre_commit_python_sphinx\r\n2019-10-21T13:06:45.6520510Z   /Users/vsts/agent/2.158.0/work/1/s/tests/test_pre_commit.py:30: PytestAssertRewriteWarning: asserting the value None, please use \"assert is None\"\r\n2019-10-21T13:06:45.6520600Z     assert re.search(\r\n2019-10-21T13:06:45.6520640Z \r\n2019-10-21T13:06:45.6520740Z tests/test_waf.py::test_waf_configure_stata\r\n2019-10-21T13:06:45.6520810Z tests/test_waf.py::test_waf_configure_matlab\r\n2019-10-21T13:06:45.6520920Z tests/test_waf.py::test_waf_configure_julia\r\n2019-10-21T13:06:45.6521010Z   /Users/vsts/agent/2.158.0/work/1/s/tests/test_waf.py:26: PytestAssertRewriteWarning: asserting the value None, please use \"assert is None\"\r\n2019-10-21T13:06:45.6521580Z     assert re.search(r\"configure\\\\?[\\'\\\"] finished successfully\", str(log_configure))\r\n2019-10-21T13:06:45.6521660Z \r\n2019-10-21T13:06:45.6521770Z tests/test_waf.py::test_waf_build_stata\r\n2019-10-21T13:06:45.6521840Z tests/test_waf.py::test_waf_build_matlab\r\n2019-10-21T13:06:45.6521930Z tests/test_waf.py::test_waf_build_julia\r\n2019-10-21T13:06:45.6522020Z   /Users/vsts/agent/2.158.0/work/1/s/tests/test_waf.py:37: PytestAssertRewriteWarning: asserting the value None, please use \"assert is None\"\r\n2019-10-21T13:06:45.6522520Z     assert re.search(r\"build\\\\?[\\'\\\"] finished successfully\", str(log_build))\r\n2019-10-21T13:06:45.6522590Z \r\n2019-10-21T13:06:45.6523000Z -- Docs: https://docs.pytest.org/en/latest/warnings.html\r\n2019-10-21T13:06:45.6523140Z ======= 1 failed, 20 passed, 6 xfailed, 7 warnings in 382.29s (0:06:22) ========\r\n2019-10-21T13:06:45.7609880Z ##[error]Bash exited with code '1'.\r\n2019-10-21T13:06:45.7665740Z ##[section]Finishing: Run pytests.\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1192/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1192/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1123", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1123/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1123/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1123/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1123", "id": 485934078, "node_id": "MDU6SXNzdWU0ODU5MzQwNzg=", "number": 1123, "title": "Incorrect NODE_PATH on win32", "user": {"login": "henryykt", "id": 64755, "node_id": "MDQ6VXNlcjY0NzU1", "avatar_url": "https://avatars.githubusercontent.com/u/64755?v=4", "gravatar_id": "", "url": "https://api.github.com/users/henryykt", "html_url": "https://github.com/henryykt", "followers_url": "https://api.github.com/users/henryykt/followers", "following_url": "https://api.github.com/users/henryykt/following{/other_user}", "gists_url": "https://api.github.com/users/henryykt/gists{/gist_id}", "starred_url": "https://api.github.com/users/henryykt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/henryykt/subscriptions", "organizations_url": "https://api.github.com/users/henryykt/orgs", "repos_url": "https://api.github.com/users/henryykt/repos", "events_url": "https://api.github.com/users/henryykt/events{/privacy}", "received_events_url": "https://api.github.com/users/henryykt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 181543993, "node_id": "MDU6TGFiZWwxODE1NDM5OTM=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/windows", "name": "windows", "color": "5319e7", "default": false, "description": null}, {"id": 352543934, "node_id": "MDU6TGFiZWwzNTI1NDM5MzQ=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/javascript", "name": "javascript", "color": "f0db4f", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-08-27T17:19:30Z", "updated_at": "2019-08-27T17:39:44Z", "closed_at": "2019-08-27T17:37:22Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "On win32, running the eslint pre-commit hook with additional plugin fails. \r\n\r\nFor example using this test repository:\r\n```\r\nh@pc MINGW64 ~/workspace/github/node_path-pre-commit-test (master)\r\n$ git remote -v\r\norigin  https://github.com/henryykt/node_path-pre-commit-test.git (fetch)\r\norigin  https://github.com/henryykt/node_path-pre-commit-test.git (push)\r\n\r\nh@pc MINGW64 ~/workspace/github/node_path-pre-commit-test (master)\r\n$ pre-commit run -av\r\n[eslint] eslint..........................................................Failed\r\nhookid: eslint\r\n\r\nOops! Something went wrong! :(\r\n\r\nESLint: 6.2.2.\r\n\r\nESLint couldn't find the plugin \"eslint-plugin-prettier\".\r\n\r\n(The package \"eslint-plugin-prettier\" was not found when loaded as a Node module from the directory \"C:\\Users\\henryt\\workspace\\github\\node_path-pre-commit-test\".)\r\n\r\nIt's likely that the plugin isn't installed correctly. Try reinstalling by running the following:\r\n\r\n    npm install eslint-plugin-prettier@latest --save-dev\r\n\r\nThe plugin \"eslint-plugin-prettier\" was referenced from the config file in \".eslintrc.js\".\r\n\r\nIf you still can't figure out the problem, please stop by https://gitter.im/eslint/eslint to chat with the team.\r\n```\r\n\r\npython version:\r\n```\r\nh@pc MINGW64 ~/workspace/github/node_path-pre-commit-test (master)\r\n$ python -VV\r\nPython 3.7.3 (v3.7.3:ef4ec6ed12, Mar 25 2019, 22:22:05) [MSC v.1916 64 bit (AMD64)]\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1123/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1123/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1112", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1112/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1112/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1112/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1112", "id": 478392050, "node_id": "MDU6SXNzdWU0NzgzOTIwNTA=", "number": 1112, "title": "rust hook requires `--path` attribute", "user": {"login": "zimbatm", "id": 3248, "node_id": "MDQ6VXNlcjMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/3248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zimbatm", "html_url": "https://github.com/zimbatm", "followers_url": "https://api.github.com/users/zimbatm/followers", "following_url": "https://api.github.com/users/zimbatm/following{/other_user}", "gists_url": "https://api.github.com/users/zimbatm/gists{/gist_id}", "starred_url": "https://api.github.com/users/zimbatm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zimbatm/subscriptions", "organizations_url": "https://api.github.com/users/zimbatm/orgs", "repos_url": "https://api.github.com/users/zimbatm/repos", "events_url": "https://api.github.com/users/zimbatm/events{/privacy}", "received_events_url": "https://api.github.com/users/zimbatm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1490811899, "node_id": "MDU6TGFiZWwxNDkwODExODk5", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/rust", "name": "rust", "color": "000000", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-08-08T10:45:04Z", "updated_at": "2019-08-11T21:05:12Z", "closed_at": "2019-08-11T21:05:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Cargo has changed how packages get installed and requires an extra `--path <destination>` attribute.\r\n\r\nSymptom:\r\n```\r\n[INFO] Initializing environment for https://github.com/nix-community/nixpkgs-fmt.\r\n[INFO] Installing environment for https://github.com/nix-community/nixpkgs-fmt.\r\n[INFO] Once installed this environment will be reused.\r\n[INFO] This may take a few minutes...\r\nAn unexpected error has occurred: CalledProcessError: Command: ('/nix/store/fcc3x8zwq1c0667xjs7bkn6ay8j4fdpz-rust-1.38.0-nightly-2019-08-07-ad7c55e1f/bin/cargo', 'install', '--bins', '--root', '/home/zimbatm/.cache/pre-commit/repoeft6xm6t/rustenv-default')\r\nReturn code: 101\r\nExpected return code: 0\r\nOutput: (none)\r\nErrors: \r\n    error: Using `cargo install` to install the binaries for the package in current working directory is no longer supported, use `cargo install --path .` instead. Use `cargo build` if you want to simply build the package.\r\n```\r\n\r\nI guess the fix should be done where here: https://github.com/pre-commit/pre-commit/blob/9c6a1d80d6b94c86a1785a40a51389e83accac3e/pre_commit/languages/rust.py#L87\r\n\r\nDo we want to make pre-commit compatible with multiple versions of cargo or just the latest one?\r\n\r\n/cc @asottile @chriskuehl ", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1112/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1112/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1096", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1096/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1096/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1096/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1096", "id": 471747446, "node_id": "MDU6SXNzdWU0NzE3NDc0NDY=", "number": 1096, "title": "`pre-commit init-templatedir` should expanduser before checking value to warn on", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 742693017, "node_id": "MDU6TGFiZWw3NDI2OTMwMTc=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/good-first-issue", "name": "good-first-issue", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-07-23T14:56:16Z", "updated_at": "2019-08-03T20:55:02Z", "closed_at": "2019-08-03T20:55:02Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "https://github.com/pre-commit/pre-commit/issues/1084#issuecomment-513744333", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1096/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1096/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1076", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1076/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1076/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1076/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1076", "id": 465054703, "node_id": "MDU6SXNzdWU0NjUwNTQ3MDM=", "number": 1076, "title": "autoupdate: flip-flop between shallow-fetched tags", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-07-08T04:59:21Z", "updated_at": "2019-07-20T22:21:28Z", "closed_at": "2019-07-20T22:21:28Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```yaml\r\nrepos:\r\n  - repo: https://github.com/asottile/pyupgrade\r\n    rev: v1.20.1\r\n    hooks:\r\n      - id: pyupgrade\r\n```\r\n\r\n```console\r\n$ pre-commit autoupdate\r\nUpdating https://github.com/asottile/pyupgrade...updating v1.20.1 -> v1.20.0.\r\n$ pre-commit autoupdate\r\nUpdating https://github.com/asottile/pyupgrade...updating v1.20.0 -> v1.20.1.\r\n$ pre-commit autoupdate\r\nUpdating https://github.com/asottile/pyupgrade...updating v1.20.1 -> v1.20.0.\r\n$ pre-commit autoupdate\r\nUpdating https://github.com/asottile/pyupgrade...updating v1.20.0 -> v1.20.1.\r\n```\r\n\r\nSeems to be related to shallow clones as I can only reproduce there.\r\n\r\nCC @mxr", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1076/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1076/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1042", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1042/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1042/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1042/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1042", "id": 447093951, "node_id": "MDU6SXNzdWU0NDcwOTM5NTE=", "number": 1042, "title": "Permission denied when installed this environment", "user": {"login": "detailyang", "id": 3370345, "node_id": "MDQ6VXNlcjMzNzAzNDU=", "avatar_url": "https://avatars.githubusercontent.com/u/3370345?v=4", "gravatar_id": "", "url": "https://api.github.com/users/detailyang", "html_url": "https://github.com/detailyang", "followers_url": "https://api.github.com/users/detailyang/followers", "following_url": "https://api.github.com/users/detailyang/following{/other_user}", "gists_url": "https://api.github.com/users/detailyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/detailyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/detailyang/subscriptions", "organizations_url": "https://api.github.com/users/detailyang/orgs", "repos_url": "https://api.github.com/users/detailyang/repos", "events_url": "https://api.github.com/users/detailyang/events{/privacy}", "received_events_url": "https://api.github.com/users/detailyang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1372850431, "node_id": "MDU6TGFiZWwxMzcyODUwNDMx", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/go", "name": "go", "color": "29beb0", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2019-05-22T11:58:29Z", "updated_at": "2019-09-18T05:56:27Z", "closed_at": "2019-05-22T19:32:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello.\r\n\r\nI'm not sure the permission is about the pre-commit but it looks likes so.\r\n\r\nHere is my config\r\n\r\n````yaml\r\n- repo: git://github.com/dnephin/pre-commit-golang\r\n  rev: master\r\n  hooks:\r\n    - id: go-fmt\r\n\r\n- repo: git://github.com/golangci/golangci-lint\r\n  rev: master\r\n  hooks:\r\n    - id: golangci-lint\r\n      args:\r\n      - --config .golangci.yml\r\n\r\n- repo: git://github.com/detailyang/pre-commit-shell\r\n  rev: v1.0.6\r\n  hooks:\r\n  - id: shell-lint\r\n    args: [--color=always, \"--exclude=SC1090,SC1091,SC2206\"]\r\n````\r\n\r\nit looks like python3.7 shutil.rmtree raise the erorr as the following:\r\n````python\r\nAn unexpected error has occurred: PermissionError: [Errno 13] Permission denied: '/Users/detailyang/.cache/pre-commit/repo2ba1f3b5/golangenv-default/pkg/mod/github.com/!burnt!sushi/toml@v0.3.1/.gitignore'\r\nTraceback (most recent call last):\r\n  File \"/usr/local/Cellar/python/3.7.3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/shutil.py\", line 447, in _rmtree_safe_fd\r\n    os.unlink(entry.name, dir_fd=topfd)\r\nPermissionError: [Errno 13] Permission denied: '.gitignore'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.7/site-packages/pre_commit/error_handler.py\", line 46, in error_handler\r\n    yield\r\n  File \"/usr/local/lib/python3.7/site-packages/pre_commit/main.py\", line 294, in main\r\n    return run(args.config, store, args)\r\n  File \"/usr/local/lib/python3.7/site-packages/pre_commit/commands/run.py\", line 285, in run\r\n    install_hook_envs(hooks, store)\r\n  File \"/usr/local/lib/python3.7/site-packages/pre_commit/repository.py\", line 215, in install_hook_envs\r\n    hook.install()\r\n  File \"/usr/local/lib/python3.7/site-packages/pre_commit/repository.py\", line 90, in install\r\n    rmtree(self.prefix.path(venv))\r\n  File \"/usr/local/lib/python3.7/site-packages/pre_commit/util.py\", line 171, in rmtree\r\n    shutil.rmtree(path, ignore_errors=False, onerror=handle_remove_readonly)\r\n  File \"/usr/local/Cellar/python/3.7.3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/shutil.py\", line 491, in rmtree\r\n    _rmtree_safe_fd(fd, path, onerror)\r\n  File \"/usr/local/Cellar/python/3.7.3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/shutil.py\", line 429, in _rmtree_safe_fd\r\n    _rmtree_safe_fd(dirfd, fullname, onerror)\r\n  File \"/usr/local/Cellar/python/3.7.3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/shutil.py\", line 429, in _rmtree_safe_fd\r\n    _rmtree_safe_fd(dirfd, fullname, onerror)\r\n  File \"/usr/local/Cellar/python/3.7.3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/shutil.py\", line 429, in _rmtree_safe_fd\r\n    _rmtree_safe_fd(dirfd, fullname, onerror)\r\n  [Previous line repeated 2 more times]\r\n  File \"/usr/local/Cellar/python/3.7.3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/shutil.py\", line 449, in _rmtree_safe_fd\r\n    onerror(os.unlink, fullname, sys.exc_info())\r\n  File \"/usr/local/lib/python3.7/site-packages/pre_commit/util.py\", line 168, in handle_remove_readonly\r\n    func(path)\r\nPermissionError: [Errno 13] Permission denied: '/Users/detailyang/.cache/pre-commit/repo2ba1f3b5/golangenv-default/pkg/mod/github.com/!burnt!sushi/toml@v0.3.1/.gitignore'\r\n````", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1042/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1042/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1026", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1026/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1026/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1026/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1026", "id": 442833658, "node_id": "MDU6SXNzdWU0NDI4MzM2NTg=", "number": 1026, "title": "KeyboardInterrupt during git is not getting forwarded properly", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-05-10T18:02:14Z", "updated_at": "2019-05-13T20:17:49Z", "closed_at": "2019-05-13T20:17:49Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This causes (among other things) patches to not get re-applied\r\n\r\nFor instance:\r\n\r\n```console\r\n$ git commit\r\n[WARNING] Unstaged files detected.\r\n[INFO] Stashing unstaged files to /home/asottile/.cache/pre-commit/patch1557511217.\r\npython-modernize.........................................................Passed\r\npylint...................................................................^C\r\nTraceback (most recent call last):\r\n  File \".git/hooks/pre-commit\", line 185, in <module>\r\n    exit(main())\r\n  File \".git/hooks/pre-commit\", line 176, in main\r\n    return retv | subprocess.call(_exe() + _opts(stdin))\r\n  File \"/usr/lib/python3.6/subprocess.py\", line 269, in call\r\n    return p.wait(timeout=timeout)\r\n  File \"/usr/lib/python3.6/subprocess.py\", line 1457, in wait\r\n    (pid, sts) = self._try_wait(0)\r\n  File \"/usr/lib/python3.6/subprocess.py\", line 1404, in _try_wait\r\n    (pid, sts) = os.waitpid(self.pid, wait_flags)\r\nKeyboardInterrupt\r\n```\r\n\r\nThis causes the patch file to not get restored!\r\n\r\nHere's a potential solution:\r\n\r\n```diff\r\n--- .git/hooks/pre-commit\t2019-05-10 10:57:23.555676222 -0700\r\n+++ new\t2019-05-10 10:57:21.467754348 -0700\r\n@@ -169,11 +169,30 @@\r\n     return ('--config', CONFIG, '--hook-stage', stage) + fns[HOOK_TYPE](stdin)\r\n \r\n \r\n+def call2(cmd):\r\n+    import signal\r\n+\r\n+    proc = None\r\n+\r\n+    def handler(*_):\r\n+        if proc is None:\r\n+            raise KeyboardInterrupt\r\n+        else:\r\n+            proc.send_signal(signal.SIGINT)\r\n+\r\n+    signal.signal(signal.SIGINT, handler)\r\n+    try:\r\n+        proc = subprocess.Popen(cmd)\r\n+        return proc.wait()\r\n+    finally:\r\n+        signal.signal(signal.SIGINT, signal.SIG_DFL)\r\n+\r\n+\r\n def main():\r\n     retv, stdin = _run_legacy()\r\n     try:\r\n         _validate_config()\r\n-        return retv | subprocess.call(_exe() + _opts(stdin))\r\n+        return retv | call2(_exe() + _opts(stdin))\r\n     except EarlyExit:\r\n         return retv\r\n     except FatalError as e:\r\n```\r\n\r\nunclear if it works on windows, haven't had time to test yet (my guess is it doesn't because of signaling\r\n\r\nAt the same time, I should also improve the output during KeyboardInterrupt -- right now there's a large stacktrace -- can probably make that get caught by the `error_handler`", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1026/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1026/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1021", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1021/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1021/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1021/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1021", "id": 440974060, "node_id": "MDU6SXNzdWU0NDA5NzQwNjA=", "number": 1021, "title": "Good old 'utf-8' codec error on Windows", "user": {"login": "nicoddemus", "id": 1085180, "node_id": "MDQ6VXNlcjEwODUxODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1085180?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nicoddemus", "html_url": "https://github.com/nicoddemus", "followers_url": "https://api.github.com/users/nicoddemus/followers", "following_url": "https://api.github.com/users/nicoddemus/following{/other_user}", "gists_url": "https://api.github.com/users/nicoddemus/gists{/gist_id}", "starred_url": "https://api.github.com/users/nicoddemus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nicoddemus/subscriptions", "organizations_url": "https://api.github.com/users/nicoddemus/orgs", "repos_url": "https://api.github.com/users/nicoddemus/repos", "events_url": "https://api.github.com/users/nicoddemus/events{/privacy}", "received_events_url": "https://api.github.com/users/nicoddemus/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-05-07T00:41:53Z", "updated_at": "2019-05-08T15:34:54Z", "closed_at": "2019-05-07T23:23:15Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Howdy,\r\n\r\nI'm unable to run `tox -re linting` on pytest anymore. I'm getting this error:\r\n\r\n```\r\n\u03bb tox -re linting\r\nlinting recreate: c:\\pytest\\.tox\\linting\r\nlinting installdeps: pre-commit>=1.11.0\r\nlinting installed: aspy.yaml==1.2.0,cfgv==1.6.0,identify==1.4.2,importlib-metadata==0.9,nodeenv==1.3.3,pre-commit==1.16.0,pytest==3.6.0,PyYAML==5.1,six==1.12.0,toml==0.10.0,virtualenv==16.5.0,zipp==0.4.0\r\nlinting run-test-pre: PYTHONHASHSEED='335'\r\nlinting run-test: commands[0] | pre-commit run --all-files --show-diff-on-failure\r\nAn unexpected error has occurred: UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 282: invalid continuation byte\r\nCheck the log at C:\\Users\\Bruno/.cache\\pre-commit\\pre-commit.log\r\nERROR: InvocationError for command 'c:\\pytest\\.tox\\linting\\Scripts\\pre-commit.EXE' run --all-files --show-diff-on-failure (exited with code 1)\r\n```\r\n\r\nHere's the contents of the log file:\r\n\r\n```\r\nAn unexpected error has occurred: UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 282: invalid continuation byte\r\nTraceback (most recent call last):\r\n  File \"c:\\pytest\\.tox\\linting\\lib\\site-packages\\pre_commit\\error_handler.py\", line 46, in error_handler\r\n    yield\r\n  File \"c:\\pytest\\.tox\\linting\\lib\\site-packages\\pre_commit\\main.py\", line 294, in main\r\n    return run(args.config, store, args)\r\n  File \"c:\\pytest\\.tox\\linting\\lib\\site-packages\\pre_commit\\commands\\run.py\", line 285, in run\r\n    install_hook_envs(hooks, store)\r\n  File \"c:\\pytest\\.tox\\linting\\lib\\site-packages\\pre_commit\\repository.py\", line 210, in install_hook_envs\r\n    if not _need_installed():\r\n  File \"c:\\pytest\\.tox\\linting\\lib\\site-packages\\pre_commit\\repository.py\", line 205, in _need_installed\r\n    if hook.install_key not in seen and not hook.installed():\r\n  File \"c:\\pytest\\.tox\\linting\\lib\\site-packages\\pre_commit\\repository.py\", line 75, in installed\r\n    lang.healthy(self.prefix, self.language_version)\r\n  File \"c:\\pytest\\.tox\\linting\\lib\\site-packages\\pre_commit\\languages\\python.py\", line 139, in healthy\r\n    retcode, _, _ = cmd_output(\r\n  File \"c:\\pytest\\.tox\\linting\\lib\\site-packages\\pre_commit\\util.py\", line 149, in cmd_output\r\n    stderr = stderr.decode(encoding)\r\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 282: invalid continuation byte\r\n```\r\n\r\nI've seen #835, #330 and #245, so I've tried to cleanup the pre-commit cache and updating `pip` and `virtualenv`, both on my system and in the virtualenv I have for pytest:\r\n\r\n```\r\n(.env37) \u03bb pip install -U virtualenv\r\nRequirement already up-to-date: virtualenv in .\\.env37\\lib\\site-packages (16.5.0)\r\n\r\n(.env37) \u03bb py -3.7 -m pip install -U virtualenv\r\nRequirement already up-to-date: virtualenv in c:\\users\\bruno\\appdata\\local\\programs\\python\\python37\\lib\\site-packages (16.5.0)\r\n\r\n(.env37) \u03bb .tox\\linting\\Scripts\\pip install virtualenv -U\r\nRequirement already up-to-date: virtualenv in .\\.tox\\linting\\lib\\site-packages (16.5.0)\r\n```\r\n\r\nSame for `pre-commit`:\r\n\r\n```\r\n(.env37) \u03bb .tox\\linting\\Scripts\\pip list\r\nPackage            Version\r\n------------------ -------\r\naspy.yaml          1.2.0\r\ncfgv               1.6.0\r\nidentify           1.4.2\r\nimportlib-metadata 0.9\r\nnodeenv            1.3.3\r\npip                19.1.1\r\npre-commit         1.16.0\r\nPyYAML             5.1\r\nsetuptools         41.0.1\r\nsix                1.12.0\r\ntoml               0.10.0\r\nvirtualenv         16.5.0\r\nwheel              0.33.1\r\nzipp               0.4.0\r\n\r\n(.env37) \u03bb pip list\r\nPackage            Version                Location\r\n------------------ ---------------------- -------------\r\naspy.yaml          1.2.0\r\natomicwrites       1.3.0\r\nattrs              19.1.0\r\ncfgv               1.6.0\r\ncolorama           0.4.1\r\nfilelock           3.0.10\r\nidentify           1.4.2\r\nimportlib-metadata 0.9\r\nmore-itertools     7.0.0\r\nnodeenv            1.3.3\r\npip                19.1.1\r\npluggy             0.9.0\r\npre-commit         1.16.0\r\npy                 1.8.0\r\npytest             4.4.2.dev43+g8605ed2a1 c:\\pytest\\src\r\nPyYAML             5.1\r\nsetuptools         39.0.1\r\nsix                1.12.0\r\ntoml               0.10.0\r\ntox                3.9.0\r\nvirtualenv         16.5.0\r\nzipp               0.4.0\r\n```\r\n\r\nAny hints @asottile? \ud83e\udd14 ", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1021/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1021/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1010", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1010/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1010/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1010/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/1010", "id": 437498307, "node_id": "MDU6SXNzdWU0Mzc0OTgzMDc=", "number": 1010, "title": "FileExistsError : [WinError 183] Cannot create a file when that file already exists", "user": {"login": "AbhimanyuHK", "id": 32696360, "node_id": "MDQ6VXNlcjMyNjk2MzYw", "avatar_url": "https://avatars.githubusercontent.com/u/32696360?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AbhimanyuHK", "html_url": "https://github.com/AbhimanyuHK", "followers_url": "https://api.github.com/users/AbhimanyuHK/followers", "following_url": "https://api.github.com/users/AbhimanyuHK/following{/other_user}", "gists_url": "https://api.github.com/users/AbhimanyuHK/gists{/gist_id}", "starred_url": "https://api.github.com/users/AbhimanyuHK/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AbhimanyuHK/subscriptions", "organizations_url": "https://api.github.com/users/AbhimanyuHK/orgs", "repos_url": "https://api.github.com/users/AbhimanyuHK/repos", "events_url": "https://api.github.com/users/AbhimanyuHK/events{/privacy}", "received_events_url": "https://api.github.com/users/AbhimanyuHK/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 181543993, "node_id": "MDU6TGFiZWwxODE1NDM5OTM=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/windows", "name": "windows", "color": "5319e7", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-04-26T04:53:31Z", "updated_at": "2019-04-27T23:01:33Z", "closed_at": "2019-04-27T23:01:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "version : 1.15.2\r\nOS : Windows 10\r\n\r\n```console\r\n$ pre-commit install\r\n\r\nAn unexpected error has occurred: FileExistsError: [WinError 183] Cannot create a file when that file already exists: '.git\\\\hooks\\\\pre-commit' -> '.git\\\\hooks\\\\pre-commit.legacy'\r\n```\r\n\r\nwhen i tried second times this was the error.", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1010/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/1010/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/997", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/997/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/997/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/997/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/997", "id": 433882659, "node_id": "MDU6SXNzdWU0MzM4ODI2NTk=", "number": 997, "title": "Failure to check out revision pre-commit v1.15.1", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-04-16T16:45:13Z", "updated_at": "2019-04-16T18:30:58Z", "closed_at": "2019-04-16T18:30:58Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```console\r\n$ cat .pre-commit-config.yaml \r\nrepos:\r\n-   repo: https://github.com/asottile/pyupgrade\r\n    rev: v1.13.0\r\n    hooks:\r\n    -   id: pyupgrade\r\n$ pre-commit install-hooks\r\n[INFO] Initializing environment for https://github.com/asottile/pyupgrade.\r\nAn unexpected error has occurred: CalledProcessError: Command: ('/usr/bin/git', 'checkout', 'v1.13.0')\r\nReturn code: 1\r\nExpected return code: 0\r\nOutput: (none)\r\nErrors: \r\n    error: pathspec 'v1.13.0' did not match any file(s) known to git.\r\n    \r\n\r\nCheck the log at /code/.cache/pre-commit/pre-commit.log\r\nlyftsvc@b780c05acb2e:/code/places$ cat ~/.cacp^C\r\nlyftsvc@b780c05acb2e:/code/places$ cat /code/.cache/pre-commit/pre-commit.log \r\nAn unexpected error has occurred: CalledProcessError: Command: ('/usr/bin/git', 'checkout', 'v1.13.0')\r\nReturn code: 1\r\nExpected return code: 0\r\nOutput: (none)\r\nErrors: \r\n    error: pathspec 'v1.13.0' did not match any file(s) known to git.\r\n    \r\n\r\nTraceback (most recent call last):\r\n  File \"/venv/lib/python3.6/site-packages/pre_commit/store.py\", line 172, in clone_strategy\r\n    self._shallow_clone(ref, _git_cmd)\r\n  File \"/venv/lib/python3.6/site-packages/pre_commit/store.py\", line 149, in _shallow_clone\r\n    git_cmd('-c', git_config, 'fetch', 'origin', ref, '--depth=1')\r\n  File \"/venv/lib/python3.6/site-packages/pre_commit/store.py\", line 166, in _git_cmd\r\n    cmd_output('git', *args, cwd=directory, env=env)\r\n  File \"/venv/lib/python3.6/site-packages/pre_commit/util.py\", line 153, in cmd_output\r\n    returncode, cmd, retcode, output=(stdout, stderr),\r\npre_commit.util.CalledProcessError: Command: ('/usr/bin/git', '-c', 'protocol.version=2', 'fetch', 'origin', 'v1.13.0', '--depth=1')\r\nReturn code: 128\r\nExpected return code: 0\r\nOutput: (none)\r\nErrors: \r\n    fatal: unknown value for config 'protocol.version': 2\r\n    \r\n\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/venv/lib/python3.6/site-packages/pre_commit/error_handler.py\", line 46, in error_handler\r\n    yield\r\n  File \"/venv/lib/python3.6/site-packages/pre_commit/main.py\", line 274, in main\r\n    return install_hooks(args.config, store)\r\n  File \"/venv/lib/python3.6/site-packages/pre_commit/commands/install_uninstall.py\", line 129, in install_hooks\r\n    install_hook_envs(all_hooks(load_config(config_file), store), store)\r\n  File \"/venv/lib/python3.6/site-packages/pre_commit/repository.py\", line 221, in all_hooks\r\n    for repo in root_config['repos']\r\n  File \"/venv/lib/python3.6/site-packages/pre_commit/repository.py\", line 222, in <genexpr>\r\n    for hook in _repository_hooks(repo, store, root_config)\r\n  File \"/venv/lib/python3.6/site-packages/pre_commit/repository.py\", line 197, in _repository_hooks\r\n    return _cloned_repository_hooks(repo_config, store, root_config)\r\n  File \"/venv/lib/python3.6/site-packages/pre_commit/repository.py\", line 166, in _cloned_repository_hooks\r\n    manifest_path = os.path.join(store.clone(repo, rev), C.MANIFEST_FILE)\r\n  File \"/venv/lib/python3.6/site-packages/pre_commit/store.py\", line 176, in clone\r\n    return self._new_repo(repo, ref, deps, clone_strategy)\r\n  File \"/venv/lib/python3.6/site-packages/pre_commit/store.py\", line 128, in _new_repo\r\n    make_strategy(directory)\r\n  File \"/venv/lib/python3.6/site-packages/pre_commit/store.py\", line 174, in clone_strategy\r\n    self._complete_clone(ref, _git_cmd)\r\n  File \"/venv/lib/python3.6/site-packages/pre_commit/store.py\", line 142, in _complete_clone\r\n    git_cmd('checkout', ref)\r\n  File \"/venv/lib/python3.6/site-packages/pre_commit/store.py\", line 166, in _git_cmd\r\n    cmd_output('git', *args, cwd=directory, env=env)\r\n  File \"/venv/lib/python3.6/site-packages/pre_commit/util.py\", line 153, in cmd_output\r\n    returncode, cmd, retcode, output=(stdout, stderr),\r\npre_commit.util.CalledProcessError: Command: ('/usr/bin/git', 'checkout', 'v1.13.0')\r\nReturn code: 1\r\nExpected return code: 0\r\nOutput: (none)\r\nErrors: \r\n    error: pathspec 'v1.13.0' did not match any file(s) known to git.\r\n```\r\n\r\nPerhaps related to the new clone strategy", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/997/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/997/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/953", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/953/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/953/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/953/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/953", "id": 413755290, "node_id": "MDU6SXNzdWU0MTM3NTUyOTA=", "number": 953, "title": "try-repo with unstaged commits sometimes doesn't work", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-02-23T23:23:04Z", "updated_at": "2019-03-19T20:09:29Z", "closed_at": "2019-03-19T20:09:29Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\n$ git status\r\nOn branch pre_commit\r\nYour branch is up to date with 'origin/master'.\r\n\r\nChanges to be committed:\r\n  (use \"git reset HEAD <file>...\" to unstage)\r\n\r\n\tnew file:   .pre-commit-hooks.yaml\r\n\r\nUntracked files:\r\n  (use \"git add <file>...\" to include in what will be committed)\r\n\r\n\tbuild/\r\n\tdist/\r\n```\r\n\r\n```\r\n$ pre-commit try-repo ../setup-cfg-fmt/\r\n[WARNING] Creating temporary repo with uncommitted changes...\r\nAn unexpected error has occurred: CalledProcessError: Command: ('/usr/bin/git', 'commit', '--no-edit', '--no-gpg-sign', '-n', '-minit')\r\nReturn code: 1\r\nExpected return code: 0\r\nOutput: \r\n    On branch _pc_tmp\r\n    nothing to commit, working tree clean\r\n    \r\nErrors: (none)\r\n\r\nCheck the log at /home/asottile/.cache/pre-commit/pre-commit.log\r\n```\r\n\r\n```\r\n$ cat /home/asottile/.cache/pre-commit/pre-commit.log\r\nAn unexpected error has occurred: CalledProcessError: Command: ('/usr/bin/git', 'commit', '--no-edit', '--no-gpg-sign', '-n', '-minit')\r\nReturn code: 1\r\nExpected return code: 0\r\nOutput: \r\n    On branch _pc_tmp\r\n    nothing to commit, working tree clean\r\n    \r\nErrors: (none)\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/asottile/opt/venv/lib/python3.6/site-packages/pre_commit/error_handler.py\", line 46, in error_handler\r\n    yield\r\n  File \"/home/asottile/opt/venv/lib/python3.6/site-packages/pre_commit/main.py\", line 295, in main\r\n    return try_repo(args)\r\n  File \"/home/asottile/opt/venv/lib/python3.6/site-packages/pre_commit/commands/try_repo.py\", line 48, in try_repo\r\n    repo, ref = _repo_ref(tempdir, args.repo, args.ref)\r\n  File \"/home/asottile/opt/venv/lib/python3.6/site-packages/pre_commit/commands/try_repo.py\", line 39, in _repo_ref\r\n    git.commit(repo=shadow)\r\n  File \"/home/asottile/opt/venv/lib/python3.6/site-packages/pre_commit/git.py\", line 143, in commit\r\n    cmd_output(*cmd, cwd=repo, env=env)\r\n  File \"/home/asottile/opt/venv/lib/python3.6/site-packages/pre_commit/util.py\", line 153, in cmd_output\r\n    returncode, cmd, retcode, output=(stdout, stderr),\r\npre_commit.util.CalledProcessError: Command: ('/usr/bin/git', 'commit', '--no-edit', '--no-gpg-sign', '-n', '-minit')\r\nReturn code: 1\r\nExpected return code: 0\r\nOutput: \r\n    On branch _pc_tmp\r\n    nothing to commit, working tree clean\r\n    \r\nErrors: (none)\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/953/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/953/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/929", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/929/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/929/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/929/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/929", "id": 405042021, "node_id": "MDU6SXNzdWU0MDUwNDIwMjE=", "number": 929, "title": "pre-commit autoupdate fails when config is empty", "user": {"login": "ardakuyumcu", "id": 1355619, "node_id": "MDQ6VXNlcjEzNTU2MTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1355619?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ardakuyumcu", "html_url": "https://github.com/ardakuyumcu", "followers_url": "https://api.github.com/users/ardakuyumcu/followers", "following_url": "https://api.github.com/users/ardakuyumcu/following{/other_user}", "gists_url": "https://api.github.com/users/ardakuyumcu/gists{/gist_id}", "starred_url": "https://api.github.com/users/ardakuyumcu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ardakuyumcu/subscriptions", "organizations_url": "https://api.github.com/users/ardakuyumcu/orgs", "repos_url": "https://api.github.com/users/ardakuyumcu/repos", "events_url": "https://api.github.com/users/ardakuyumcu/events{/privacy}", "received_events_url": "https://api.github.com/users/ardakuyumcu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 742693017, "node_id": "MDU6TGFiZWw3NDI2OTMwMTc=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/good-first-issue", "name": "good-first-issue", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-01-31T01:36:56Z", "updated_at": "2019-02-02T01:31:39Z", "closed_at": "2019-02-02T01:31:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "Running `pre-commit autoupdate` with an empty `.pre-commit-config.yaml` results in the below error:\r\n```An unexpected error has occurred: IndexError: list index out of range\r\nTraceback (most recent call last):\r\n  File \"/usr/local/Cellar/pre-commit/1.14.2/libexec/lib/python3.7/site-packages/pre_commit/error_handler.py\", line 46, in error_handler\r\n    yield\r\n  File \"/usr/local/Cellar/pre-commit/1.14.2/libexec/lib/python3.7/site-packages/pre_commit/main.py\", line 286, in main\r\n    repos=args.repos,\r\n  File \"/usr/local/Cellar/pre-commit/1.14.2/libexec/lib/python3.7/site-packages/pre_commit/commands/autoupdate.py\", line 117, in autoupdate\r\n    migrate_config(config_file, quiet=True)\r\n  File \"/usr/local/Cellar/pre-commit/1.14.2/libexec/lib/python3.7/site-packages/pre_commit/commands/migrate_config.py\", line 52, in migrate_config\r\n    contents = _migrate_map(contents)\r\n  File \"/usr/local/Cellar/pre-commit/1.14.2/libexec/lib/python3.7/site-packages/pre_commit/commands/migrate_config.py\", line 24, in _migrate_map\r\n    while _is_header_line(lines[i]):\r\nIndexError: list index out of range\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/929/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/929/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/881", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/881/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/881/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/881/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/881", "id": 390478696, "node_id": "MDU6SXNzdWUzOTA0Nzg2OTY=", "number": 881, "title": "\"git add -N\" prevents restoring stashed changes.", "user": {"login": "henniss", "id": 17056237, "node_id": "MDQ6VXNlcjE3MDU2MjM3", "avatar_url": "https://avatars.githubusercontent.com/u/17056237?v=4", "gravatar_id": "", "url": "https://api.github.com/users/henniss", "html_url": "https://github.com/henniss", "followers_url": "https://api.github.com/users/henniss/followers", "following_url": "https://api.github.com/users/henniss/following{/other_user}", "gists_url": "https://api.github.com/users/henniss/gists{/gist_id}", "starred_url": "https://api.github.com/users/henniss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/henniss/subscriptions", "organizations_url": "https://api.github.com/users/henniss/orgs", "repos_url": "https://api.github.com/users/henniss/repos", "events_url": "https://api.github.com/users/henniss/events{/privacy}", "received_events_url": "https://api.github.com/users/henniss/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-12-13T01:22:27Z", "updated_at": "2019-01-08T19:03:42Z", "closed_at": "2019-01-08T18:36:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "To reproduce, start with this simple `pre-commit-config.yaml` in an otherwise empty repo:\r\n\r\n```yaml\r\nrepos:\r\n- repo: https://github.com/pre-commit/pre-commit-hooks\r\n  rev: master\r\n  hooks: \r\n    - id: end-of-file-fixer\r\n```\r\n\r\nThe hook used doesn't really matter. end-of-file-fixer is just an example. \r\n\r\nRun the following:\r\n```bash\r\necho \"new\" > newfile\r\necho \"\\n\\n\\n\" > needs-fixing\r\ngit add -N newfile\r\n# newfile is now staged as an empty file\r\ngit add needs-fixing\r\ngit commit -m \"fix\"\r\n```\r\n\r\nThe following output is generated: \r\n\r\n```\r\n[WARNING] Unstaged files detected.\r\n[INFO] Stashing unstaged files to /home/henniss/.cache/pre-commit/patch1544663784.\r\nFix End of Files.........................................................Failed\r\nhookid: end-of-file-fixer\r\n\r\nFiles were modified by this hook. Additional output:\r\n\r\nFixing needs-fixing\r\n\r\n[WARNING] Stashed changes conflicted with hook auto-fixes... Rolling back fixes...\r\nAn unexpected error has occurred: CalledProcessError: Command: ('/usr/lib/git-core/git', '-c', 'core.autocrlf=false', 'apply', '--whitespace=nowarn', '/home/henniss/.cache/pre-commit/patch1544663784')\r\nReturn code: 1\r\nExpected return code: 0\r\nOutput: (none)\r\nErrors:\r\n    error: newfile: already exists in working directory\r\n\r\n\r\nCheck the log at /home/henniss/.cache/pre-commit/pre-commit.log\r\n```\r\n\r\n`cat newfile` now shows that it is empty. The unstaged changes aren't restored.", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/881/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/881/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/856", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/856/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/856/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/856/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/856", "id": 375155922, "node_id": "MDU6SXNzdWUzNzUxNTU5MjI=", "number": 856, "title": "autoupdate from a revision to a repo with latest tag missing .pre-commit-hooks.yaml errors", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 85713407, "node_id": "MDU6TGFiZWw4NTcxMzQwNw==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/feature", "name": "feature", "color": "207de5", "default": false, "description": null}, {"id": 742693017, "node_id": "MDU6TGFiZWw3NDI2OTMwMTc=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/good-first-issue", "name": "good-first-issue", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-10-29T18:27:09Z", "updated_at": "2019-04-23T20:31:13Z", "closed_at": "2018-11-15T01:30:39Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "It should just skip updating these repositories.\r\n\r\n```yaml\r\nrepos:\r\n- repo: https://github.com/python-modernize/python-modernize\r\n  rev: a234ce4e1\r\n  hooks:\r\n  - id: python-modernize\r\n```\r\n\r\n```console\r\n$ pre-commit  autoupdate\r\nUpdating https://github.com/python-modernize/python-modernize...[INFO] Initializing environment for https://github.com/python-modernize/python-modernize.\r\n[INFO] Initializing environment for https://github.com/python-modernize/python-modernize.\r\nAn error has occurred: InvalidManifestError: \r\n=====> /home/asottile/.cache/pre-commit/repolsycg5yp/.pre-commit-hooks.yaml does not exist\r\nCheck the log at /home/asottile/.cache/pre-commit/pre-commit.log\r\n```\r\n\r\n```console\r\n$ cat ~/.cache/pre-commit/pre-commit.log \r\nAn error has occurred: InvalidManifestError: \r\n=====> /home/asottile/.cache/pre-commit/repolsycg5yp/.pre-commit-hooks.yaml does not exist\r\nTraceback (most recent call last):\r\n  File \"/home/asottile/opt/venv/lib/python3.6/site-packages/cfgv.py\", line 46, in reraise_as\r\n    yield\r\n  File \"/home/asottile/opt/venv/lib/python3.6/site-packages/cfgv.py\", line 344, in load_from_filename\r\n    raise ValidationError('{} does not exist'.format(filename))\r\ncfgv.ValidationError: \r\n=====> /home/asottile/.cache/pre-commit/repolsycg5yp/.pre-commit-hooks.yaml does not exist\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/asottile/opt/venv/lib/python3.6/site-packages/pre_commit/error_handler.py\", line 47, in error_handler\r\n    yield\r\n  File \"/home/asottile/opt/venv/lib/python3.6/site-packages/pre_commit/main.py\", line 256, in main\r\n    repos=args.repos,\r\n  File \"/home/asottile/opt/venv/lib/python3.6/site-packages/pre_commit/commands/autoupdate.py\", line 129, in autoupdate\r\n    new_repo_config = _update_repo(repo_config, store, tags_only)\r\n  File \"/home/asottile/opt/venv/lib/python3.6/site-packages/pre_commit/commands/autoupdate.py\", line 60, in _update_repo\r\n    hooks_missing = hooks - (hooks & set(new_repo.manifest_hooks))\r\n  File \"/home/asottile/opt/venv/lib/python3.6/site-packages/cached_property.py\", line 35, in __get__\r\n    value = obj.__dict__[self.func.__name__] = self.func(obj)\r\n  File \"/home/asottile/opt/venv/lib/python3.6/site-packages/pre_commit/repository.py\", line 157, in manifest_hooks\r\n    return {hook['id']: hook for hook in load_manifest(manifest_path)}\r\n  File \"/home/asottile/opt/venv/lib/python3.6/site-packages/cfgv.py\", line 356, in load_from_filename\r\n    return apply_defaults(data, schema)\r\n  File \"/usr/lib/python3.6/contextlib.py\", line 99, in __exit__\r\n    self.gen.throw(type, value, traceback)\r\n  File \"/home/asottile/opt/venv/lib/python3.6/site-packages/cfgv.py\", line 49, in reraise_as\r\n    six.reraise(tp, tp(e), tb)\r\n  File \"/home/asottile/opt/venv/lib/python3.6/site-packages/six.py\", line 692, in reraise\r\n    raise value.with_traceback(tb)\r\n  File \"/home/asottile/opt/venv/lib/python3.6/site-packages/cfgv.py\", line 46, in reraise_as\r\n    yield\r\n  File \"/home/asottile/opt/venv/lib/python3.6/site-packages/cfgv.py\", line 344, in load_from_filename\r\n    raise ValidationError('{} does not exist'.format(filename))\r\npre_commit.clientlib.InvalidManifestError: \r\n=====> /home/asottile/.cache/pre-commit/repolsycg5yp/.pre-commit-hooks.yaml does not exist\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/856/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/856/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/843", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/843/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/843/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/843/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/843", "id": 368928200, "node_id": "MDU6SXNzdWUzNjg5MjgyMDA=", "number": 843, "title": "Pre-push not getting all relevant files", "user": {"login": "prem-nuro", "id": 41026263, "node_id": "MDQ6VXNlcjQxMDI2MjYz", "avatar_url": "https://avatars.githubusercontent.com/u/41026263?v=4", "gravatar_id": "", "url": "https://api.github.com/users/prem-nuro", "html_url": "https://github.com/prem-nuro", "followers_url": "https://api.github.com/users/prem-nuro/followers", "following_url": "https://api.github.com/users/prem-nuro/following{/other_user}", "gists_url": "https://api.github.com/users/prem-nuro/gists{/gist_id}", "starred_url": "https://api.github.com/users/prem-nuro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/prem-nuro/subscriptions", "organizations_url": "https://api.github.com/users/prem-nuro/orgs", "repos_url": "https://api.github.com/users/prem-nuro/repos", "events_url": "https://api.github.com/users/prem-nuro/events{/privacy}", "received_events_url": "https://api.github.com/users/prem-nuro/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2018-10-11T02:36:51Z", "updated_at": "2018-10-11T03:46:03Z", "closed_at": "2018-10-11T03:41:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "I seem to experiencing the case where the list of files passed to my hooks pre-push are only from the most recent commit.", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/843/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/843/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/831", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/831/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/831/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/831/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/831", "id": 362865948, "node_id": "MDU6SXNzdWUzNjI4NjU5NDg=", "number": 831, "title": "git.get_git_dir() appears to break with older versions of git", "user": {"login": "mmacpherson", "id": 5566543, "node_id": "MDQ6VXNlcjU1NjY1NDM=", "avatar_url": "https://avatars.githubusercontent.com/u/5566543?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mmacpherson", "html_url": "https://github.com/mmacpherson", "followers_url": "https://api.github.com/users/mmacpherson/followers", "following_url": "https://api.github.com/users/mmacpherson/following{/other_user}", "gists_url": "https://api.github.com/users/mmacpherson/gists{/gist_id}", "starred_url": "https://api.github.com/users/mmacpherson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mmacpherson/subscriptions", "organizations_url": "https://api.github.com/users/mmacpherson/orgs", "repos_url": "https://api.github.com/users/mmacpherson/repos", "events_url": "https://api.github.com/users/mmacpherson/events{/privacy}", "received_events_url": "https://api.github.com/users/mmacpherson/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-09-22T15:29:14Z", "updated_at": "2018-09-22T19:06:55Z", "closed_at": "2018-09-22T18:59:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "When you install the current pre-commit (v1.11.0) on a system using an older git, eg 2.1.4, the `git rev-parse --git-common-dir` ultimately issued by `git.get_git_dir()` yields the result `--git-common-dir` instead of `.git` like you'd expect. This causes pre-commit to get installed in a directory literally named \"--git-common-dir\", and thus not work.\r\n\r\nHappened to encounter using a docker image for an older version of python, which used an older git. Examples to demo the issue:\r\n\r\n```\r\n$ docker run python:2.7.9 sh -c \"git init foo && cd foo && git rev-parse --git-common-dir && git --version\"\r\nInitialized empty Git repository in /foo/.git/\r\n--git-common-dir\r\ngit version 2.1.4\r\n$ docker run python:2.7.15 sh -c \"git init foo && cd foo && git rev-parse --git-common-dir && git --version\"\r\nInitialized empty Git repository in /foo/.git/\r\n.git\r\ngit version 2.11.0\r\n```\r\n\r\nIn git.get_git_dir() as it stands, it appears that the older-git behavior is anticipated. It looks like older gits are expected to throw a `CalledProcessError` when `git rev-parse --git-common-dir` is called, and fall back to `git rev-parse --git-dir`. But evidently that's not working as intended?", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/831/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/831/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/808", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/808/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/808/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/808/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/808", "id": 347870469, "node_id": "MDU6SXNzdWUzNDc4NzA0Njk=", "number": 808, "title": "Hooks not installed in the right hooks directory for worktrees", "user": {"login": "s0undt3ch", "id": 300048, "node_id": "MDQ6VXNlcjMwMDA0OA==", "avatar_url": "https://avatars.githubusercontent.com/u/300048?v=4", "gravatar_id": "", "url": "https://api.github.com/users/s0undt3ch", "html_url": "https://github.com/s0undt3ch", "followers_url": "https://api.github.com/users/s0undt3ch/followers", "following_url": "https://api.github.com/users/s0undt3ch/following{/other_user}", "gists_url": "https://api.github.com/users/s0undt3ch/gists{/gist_id}", "starred_url": "https://api.github.com/users/s0undt3ch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/s0undt3ch/subscriptions", "organizations_url": "https://api.github.com/users/s0undt3ch/orgs", "repos_url": "https://api.github.com/users/s0undt3ch/repos", "events_url": "https://api.github.com/users/s0undt3ch/events{/privacy}", "received_events_url": "https://api.github.com/users/s0undt3ch/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 85713407, "node_id": "MDU6TGFiZWw4NTcxMzQwNw==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/feature", "name": "feature", "color": "207de5", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2018-08-06T10:39:15Z", "updated_at": "2021-04-12T15:34:46Z", "closed_at": "2018-08-06T17:12:03Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When on a git worktree, the hooks are not installed on the right hook dir:\r\n```\r\n\u276f pre-commit install\r\npre-commit installed at /home/vampas/projects/SaltStack/console/raas/.git/worktrees/revan1/hooks/pre-commit\r\n```\r\nThe hook does not run.\r\n\r\nThe hook only runs when I moved the `pre-commit` script to `/home/vampas/projects/SaltStack/console/raas/.git/hooks/pre-commit`\r\n\r\n```\r\n\u276f pre-commit --version\r\npre-commit 1.10.4\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/808/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/808/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/782", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/782/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/782/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/782/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/782", "id": 338361077, "node_id": "MDU6SXNzdWUzMzgzNjEwNzc=", "number": 782, "title": "documention regarding adding new python based hooks needs improvement", "user": {"login": "ssbarnea", "id": 102495, "node_id": "MDQ6VXNlcjEwMjQ5NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/102495?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssbarnea", "html_url": "https://github.com/ssbarnea", "followers_url": "https://api.github.com/users/ssbarnea/followers", "following_url": "https://api.github.com/users/ssbarnea/following{/other_user}", "gists_url": "https://api.github.com/users/ssbarnea/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssbarnea/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssbarnea/subscriptions", "organizations_url": "https://api.github.com/users/ssbarnea/orgs", "repos_url": "https://api.github.com/users/ssbarnea/repos", "events_url": "https://api.github.com/users/ssbarnea/events{/privacy}", "received_events_url": "https://api.github.com/users/ssbarnea/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-07-04T19:23:45Z", "updated_at": "2018-07-04T22:51:49Z", "closed_at": "2018-07-04T22:51:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "Apparently we need some kind of how-to or mini tutorial on how to add a new hook to pre-commit as the basic documentation does not help someone without previous pre-commit knowledge.\r\n\r\nI wanted to add support for `bashate`, a shell script linter written in python, available on pypi and that installs a shell script with the same name that can be used just like other linters.\r\n\r\nInitially I went to https://pre-commit.com/#new-hooks which didn't give me enough info. So, i looked for other linters based on python and I found yamllint, which pointed me to https://github.com/adrienverge/yamllint/blob/master/.pre-commit-hooks.yaml\r\n\r\nSo the idea was to add the hook definition directly to the linter package. In this case I had to fork bashate in order to test the new, hook. So I ended up creating https://github.com/ssbarnea/bashate/blob/master/.pre-commit-hooks.yaml -- folowing the same model used in yamllint.\r\n\r\nNow, I wanted to add and test the hook on one of the repos I maintain so I did create https://github.com/pycontribs/jira/blob/feature/pre-commit/.pre-commit-config.yaml#L25\r\n\r\nWhen I tried to run it using `pre-commit run bashate --all`, it failed with this error:\r\n```\r\nBashate..................................................................An unexpected error has occurred: OSError: [Errno 2] No such file or directory\r\nCheck the log at /Users/ssbarnea/.cache/pre-commit/pre-commit.log\r\n\r\nAn unexpected error has occurred: OSError: [Errno 2] No such file or directory\r\nTraceback (most recent call last):\r\n  File \"/Users/ssbarnea/.pyenv/versions/2.7.14/lib/python2.7/site-packages/pre_commit/error_handler.py\", line 47, in error_handler\r\n    yield\r\n  File \"/Users/ssbarnea/.pyenv/versions/2.7.14/lib/python2.7/site-packages/pre_commit/main.py\", line 258, in main\r\n    return run(runner, args)\r\n  File \"/Users/ssbarnea/.pyenv/versions/2.7.14/lib/python2.7/site-packages/pre_commit/commands/run.py\", line 270, in run\r\n    return _run_hooks(runner.config, repo_hooks, args, environ)\r\n  File \"/Users/ssbarnea/.pyenv/versions/2.7.14/lib/python2.7/site-packages/pre_commit/commands/run.py\", line 199, in _run_hooks\r\n    retval |= _run_single_hook(filenames, hook, repo, args, skips, cols)\r\n  File \"/Users/ssbarnea/.pyenv/versions/2.7.14/lib/python2.7/site-packages/pre_commit/commands/run.py\", line 110, in _run_single_hook\r\n    hook, tuple(filenames) if hook['pass_filenames'] else (),\r\n  File \"/Users/ssbarnea/.pyenv/versions/2.7.14/lib/python2.7/site-packages/pre_commit/repository.py\", line 207, in run_hook\r\n    return languages[language_name].run_hook(prefix, hook, file_args)\r\n  File \"/Users/ssbarnea/.pyenv/versions/2.7.14/lib/python2.7/site-packages/pre_commit/languages/script.py\", line 16, in run_hook\r\n    return xargs(cmd, file_args)\r\n  File \"/Users/ssbarnea/.pyenv/versions/2.7.14/lib/python2.7/site-packages/pre_commit/xargs.py\", line 63, in xargs\r\n    *run_cmd, encoding=None, retcode=None\r\n  File \"/Users/ssbarnea/.pyenv/versions/2.7.14/lib/python2.7/site-packages/pre_commit/util.py\", line 167, in cmd_output\r\n    proc = subprocess.Popen(cmd, **popen_kwargs)\r\n  File \"/Users/ssbarnea/.pyenv/versions/2.7.14/lib/python2.7/subprocess.py\", line 390, in __init__\r\n    errread, errwrite)\r\n  File \"/Users/ssbarnea/.pyenv/versions/2.7.14/lib/python2.7/subprocess.py\", line 1025, in _execute_child\r\n    raise child_exception\r\nOSError: [Errno 2] No such file or directory\r\n```\r\n\r\nAt the moment I have no idea what I did wrong, probably something simple. Still, we need to make it easier to integrate new linters into pre-commit.", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/782/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/782/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/777", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/777/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/777/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/777/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/777", "id": 337555394, "node_id": "MDU6SXNzdWUzMzc1NTUzOTQ=", "number": 777, "title": "Invalid symmetric difference expression", "user": {"login": "domenkozar", "id": 126339, "node_id": "MDQ6VXNlcjEyNjMzOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/126339?v=4", "gravatar_id": "", "url": "https://api.github.com/users/domenkozar", "html_url": "https://github.com/domenkozar", "followers_url": "https://api.github.com/users/domenkozar/followers", "following_url": "https://api.github.com/users/domenkozar/following{/other_user}", "gists_url": "https://api.github.com/users/domenkozar/gists{/gist_id}", "starred_url": "https://api.github.com/users/domenkozar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/domenkozar/subscriptions", "organizations_url": "https://api.github.com/users/domenkozar/orgs", "repos_url": "https://api.github.com/users/domenkozar/repos", "events_url": "https://api.github.com/users/domenkozar/events{/privacy}", "received_events_url": "https://api.github.com/users/domenkozar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-07-02T15:01:54Z", "updated_at": "2018-07-02T18:05:27Z", "closed_at": "2018-07-02T17:50:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\n$ git push\r\nAn unexpected error has occurred: CalledProcessError: Command: ('/nix/store/4c12r17gwha2hh6gvc6y2i0s6ckjc09y-git-2.16.2/libexec/git-core/git', 'diff', '--name-only', '--no-ext-diff', '-z', '192a93890ea5100a22a42a73249f7c1e571ebb0b...857ce8997c4f431c06ec52ef0ba1a64983ae945f')\r\nReturn code: 128\r\nExpected return code: 0\r\nOutput: (none)\r\nErrors:\r\n    fatal: Invalid symmetric difference expression 192a93890ea5100a22a42a73249f7c1e571ebb0b...857ce8997c4f431c06ec52ef0ba1a64983ae945f\r\n\r\n\r\nCheck the log at /home/ielectric/.cache/pre-commit/pre-commit.log\r\n```\r\n\r\nI understand this happens if one rewrites git history, but pre-commit shouldn't fail in that case.", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/777/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/777/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/772", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/772/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/772/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/772/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/772", "id": 337184764, "node_id": "MDU6SXNzdWUzMzcxODQ3NjQ=", "number": 772, "title": "`stages: [commit]` hooks will run with `pre-commit run otherhookid`", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 742693017, "node_id": "MDU6TGFiZWw3NDI2OTMwMTc=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/good-first-issue", "name": "good-first-issue", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-06-30T04:10:27Z", "updated_at": "2018-07-20T04:13:24Z", "closed_at": "2018-07-20T04:13:24Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "minor logic bug, good new-contributor ticket\r\n\r\nEasy to reproduce on pre-commit itself:\r\n\r\n```diff\r\ndiff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml\r\nindex a146bd2..7bb382d 100644\r\n--- a/.pre-commit-config.yaml\r\n+++ b/.pre-commit-config.yaml\r\n@@ -3,6 +3,7 @@ repos:\r\n     rev: v1.2.3\r\n     hooks:\r\n     -   id: trailing-whitespace\r\n+        stages: [commit]\r\n     -   id: end-of-file-fixer\r\n     -   id: autopep8-wrapper\r\n     -   id: check-docstring-first\r\n```\r\n\r\n```console\r\n$ pre-commit run end-of-file-fixer --all-files\r\nTrim Trailing Whitespace.................................................Passed\r\nFix End of Files.........................................................Passed\r\n```\r\n\r\n(it should have only run `end-of-file-fixer` but also run `trailing-whitespace` due to a logic error).", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/772/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/772/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/755", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/755/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/755/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/755/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/755", "id": 327092683, "node_id": "MDU6SXNzdWUzMjcwOTI2ODM=", "number": 755, "title": "venv tests break virtualenv's `pip` when run from a `-mvirtualenv` virtualenv", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 352543100, "node_id": "MDU6TGFiZWwzNTI1NDMxMDA=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/python", "name": "python", "color": "3776ab", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-05-28T18:22:27Z", "updated_at": "2018-05-28T23:58:26Z", "closed_at": "2018-05-28T23:58:26Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Here's a reproduction, not exactly sure what's happening here:\r\n\r\n```\r\n$ tox -e py36 -r --notest\r\nGLOB sdist-make: /home/asottile/workspace/pre-commit/setup.py\r\npy36 create: /home/asottile/workspace/pre-commit/.tox/py36\r\npy36 installdeps: -rrequirements-dev.txt\r\npy36 inst: /home/asottile/workspace/pre-commit/.tox/dist/pre_commit-1.10.0.zip\r\npy36 installed: You are using pip version 9.0.1, however version 10.0.1 is available.,You should consider upgrading via the 'pip install --upgrade pip' command.,aspy.yaml==1.1.1,atomicwrites==1.1.5,attrs==18.1.0,cached-property==1.4.2,cfgv==1.0.0,coverage==4.5.1,flake8==3.5.0,identify==1.0.18,mccabe==0.6.1,mock==2.0.0,more-itertools==4.2.0,nodeenv==1.3.0,pbr==4.0.3,pluggy==0.6.0,-e git+git@github.com:pre-commit/pre-commit@97fb49a533de9a378d20f0a41e79df118362e534#egg=pre_commit,py==1.5.3,pycodestyle==2.3.1,pyflakes==1.6.0,pytest==3.6.0,pytest-env==0.6.2,PyYAML==3.12,six==1.11.0,toml==0.9.4,virtualenv==16.0.0\r\n___________________________________ summary ____________________________________\r\n  py36: skipped tests\r\n  congratulations :)\r\n\r\n$ head -1 .tox/py36/bin/pip\r\n#!/home/asottile/workspace/pre-commit/.tox/py36/bin/python3.6\r\n$ .tox/py36/bin/pytest tests -k venv\r\n============================= test session starts ==============================\r\nplatform linux -- Python 3.6.5, pytest-3.6.0, py-1.5.3, pluggy-0.6.0\r\nrootdir: /home/asottile/workspace/pre-commit, inifile: tox.ini\r\nplugins: env-0.6.2\r\ncollected 500 items / 492 deselected                                           \r\n\r\ntests/repository_test.py ..                                              [ 25%]\r\ntests/commands/install_uninstall_test.py .                               [ 37%]\r\ntests/languages/all_test.py .....                                        [100%]\r\n\r\n=================== 8 passed, 492 deselected in 4.12 seconds ===================\r\n$ head -1 .tox/py36/bin/pip\r\n#!/home/asottile/workspace/pre-commit/.tox/py36/bin/python3.6\r\n$ tox -e py36 -- tests -k venv\r\nGLOB sdist-make: /home/asottile/workspace/pre-commit/setup.py\r\npy36 inst-nodeps: /home/asottile/workspace/pre-commit/.tox/dist/pre_commit-1.10.0.zip\r\npy36 installed: You are using pip version 9.0.1, however version 10.0.1 is available.,You should consider upgrading via the 'pip install --upgrade pip' command.,aspy.yaml==1.1.1,atomicwrites==1.1.5,attrs==18.1.0,cached-property==1.4.2,cfgv==1.0.0,coverage==4.5.1,flake8==3.5.0,identify==1.0.18,mccabe==0.6.1,mock==2.0.0,more-itertools==4.2.0,nodeenv==1.3.0,pbr==4.0.3,pluggy==0.6.0,pre-commit==1.10.0,py==1.5.3,pycodestyle==2.3.1,pyflakes==1.6.0,pytest==3.6.0,pytest-env==0.6.2,PyYAML==3.12,six==1.11.0,toml==0.9.4,virtualenv==16.0.0\r\npy36 runtests: PYTHONHASHSEED='93802395'\r\npy36 runtests: commands[0] | coverage erase\r\npy36 runtests: commands[1] | coverage run -m pytest tests -k venv\r\n============================= test session starts ==============================\r\nplatform linux -- Python 3.6.5, pytest-3.6.0, py-1.5.3, pluggy-0.6.0\r\nrootdir: /home/asottile/workspace/pre-commit, inifile: tox.ini\r\nplugins: env-0.6.2\r\ncollected 500 items / 492 deselected                                           \r\n\r\ntests/repository_test.py ..                                              [ 25%]\r\ntests/commands/install_uninstall_test.py .                               [ 37%]\r\ntests/languages/all_test.py .....                                        [100%]\r\n\r\n=================== 8 passed, 492 deselected in 4.32 seconds ===================\r\npy36 runtests: commands[2] | coverage report --fail-under 99\r\nName                                              Stmts   Miss Branch BrPart  Cover   Missing\r\n---------------------------------------------------------------------------------------------\r\n...\r\n17 files skipped due to complete coverage.\r\nERROR: InvocationError: '/home/asottile/workspace/pre-commit/.tox/py36/bin/coverage report --fail-under 99'\r\n___________________________________ summary ____________________________________\r\nERROR:   py36: commands failed\r\n\r\n$ head -1 .tox/py36/bin/pip\r\n#!/tmp/pytest-of-asottile/pytest-3/test_python_venv0/0/.pre-commit/repo5xcuq11q/py_venv-python3.6/bin/python3.6\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/755/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/755/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/723", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/723/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/723/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/723/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/723", "id": 304509742, "node_id": "MDU6SXNzdWUzMDQ1MDk3NDI=", "number": 723, "title": "Older versions of git no longer supported", "user": {"login": "JohnLyman", "id": 5408286, "node_id": "MDQ6VXNlcjU0MDgyODY=", "avatar_url": "https://avatars.githubusercontent.com/u/5408286?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnLyman", "html_url": "https://github.com/JohnLyman", "followers_url": "https://api.github.com/users/JohnLyman/followers", "following_url": "https://api.github.com/users/JohnLyman/following{/other_user}", "gists_url": "https://api.github.com/users/JohnLyman/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnLyman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnLyman/subscriptions", "organizations_url": "https://api.github.com/users/JohnLyman/orgs", "repos_url": "https://api.github.com/users/JohnLyman/repos", "events_url": "https://api.github.com/users/JohnLyman/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnLyman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2018-03-12T19:30:54Z", "updated_at": "2018-03-13T11:25:06Z", "closed_at": "2018-03-12T21:55:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "Since #714 I am no longer able to run `pre-commit` on RHEL7 hosts.  The version of `git` provided by the OS vendor does not support the `-C` option.\r\n\r\nWas this intentional?  If not, would you consider re-adding support for older versions?\r\n\r\nMy environment:\r\n```\r\n$ cat /etc/redhat-release\r\nRed Hat Enterprise Linux Server release 7.3 (Maipo)\r\n\r\n$ git --version\r\ngit version 1.8.3.1\r\n```\r\nI understand that version of `git` is 5+ years old, but it is the latest version provided by RedHat.  If nothing else, the documentation should state which version of `git` is required.\r\n\r\nThanks", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/723/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/723/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/679", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/679/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/679/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/679/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/679", "id": 287162495, "node_id": "MDU6SXNzdWUyODcxNjI0OTU=", "number": 679, "title": "Crash on `local`-only `golang` repositories", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-01-09T17:07:18Z", "updated_at": "2018-01-09T18:23:38Z", "closed_at": "2018-01-09T18:23:38Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "While investigating: https://github.com/pre-commit/pre-commit-hooks/issues/255\r\n\r\nUsing this configuration:\r\n\r\n```yaml\r\nrepos:\r\n-   repo: local\r\n    hooks:\r\n    -   id: talisman\r\n        name: talisman\r\n        entry: talisman -githook pre-commit\r\n        pass_filenames: false\r\n        types: [text]\r\n        language: golang\r\n        additional_dependencies: [github.com/thoughtworks/talisman]\r\n```\r\n\r\n```\r\n$ pre-commit run --all-files\r\n[INFO] Initializing environment for local:github.com/thoughtworks/talisman.\r\n[INFO] Installing environment for local.\r\n[INFO] Once installed this environment will be reused.\r\n[INFO] This may take a few minutes...\r\nAn unexpected error has occurred: CalledProcessError: Command: ('/usr/bin/git', 'config', 'remote.origin.url')\r\nReturn code: 1\r\nExpected return code: 0\r\nOutput: (none)\r\nErrors: (none)\r\n\r\nCheck the log at /home/asottile/.cache/pre-commit/pre-commit.log\r\n```\r\n\r\n```\r\nAn unexpected error has occurred: CalledProcessError: Command: ('/usr/bin/git', 'config', 'remote.origin.url')\r\nReturn code: 1\r\nExpected return code: 0\r\nOutput: (none)\r\nErrors: (none)\r\n\r\nTraceback (most recent call last):\r\n  File \"/tmp/wat/venv/local/lib/python2.7/site-packages/pre_commit/error_handler.py\", line 47, in error_handler\r\n    yield\r\n  File \"/tmp/wat/venv/local/lib/python2.7/site-packages/pre_commit/main.py\", line 259, in main\r\n    return run(runner, args)\r\n  File \"/tmp/wat/venv/local/lib/python2.7/site-packages/pre_commit/commands/run.py\", line 256, in run\r\n    repo.require_installed()\r\n  File \"/tmp/wat/venv/local/lib/python2.7/site-packages/pre_commit/repository.py\", line 202, in require_installed\r\n    _install_all(self._venvs, self.repo_config['repo'], self.store)\r\n  File \"/tmp/wat/venv/local/lib/python2.7/site-packages/pre_commit/repository.py\", line 102, in _install_all\r\n    language.install_environment(cmd_runner, version, deps)\r\n  File \"/tmp/wat/venv/local/lib/python2.7/site-packages/pre_commit/languages/golang.py\", line 60, in install_environment\r\n    remote = git.get_remote_url(repo_cmd_runner.path())\r\n  File \"/tmp/wat/venv/local/lib/python2.7/site-packages/pre_commit/git.py\", line 41, in get_remote_url\r\n    ret = cmd_output('git', 'config', 'remote.origin.url', cwd=git_root)[1]\r\n  File \"/tmp/wat/venv/local/lib/python2.7/site-packages/pre_commit/util.py\", line 188, in cmd_output\r\n    returncode, cmd, retcode, output=(stdout, stderr),\r\nCalledProcessError: Command: ('/usr/bin/git', 'config', 'remote.origin.url')\r\nReturn code: 1\r\nExpected return code: 0\r\nOutput: (none)\r\nErrors: (none)\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/679/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/679/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/660", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/660/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/660/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/660/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/660", "id": 272386100, "node_id": "MDU6SXNzdWUyNzIzODYxMDA=", "number": 660, "title": "Uh oh, whoops, `pre-commit autoupdate --repo foo` only leaves foo", "user": {"login": "KevinHock", "id": 3076393, "node_id": "MDQ6VXNlcjMwNzYzOTM=", "avatar_url": "https://avatars.githubusercontent.com/u/3076393?v=4", "gravatar_id": "", "url": "https://api.github.com/users/KevinHock", "html_url": "https://github.com/KevinHock", "followers_url": "https://api.github.com/users/KevinHock/followers", "following_url": "https://api.github.com/users/KevinHock/following{/other_user}", "gists_url": "https://api.github.com/users/KevinHock/gists{/gist_id}", "starred_url": "https://api.github.com/users/KevinHock/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/KevinHock/subscriptions", "organizations_url": "https://api.github.com/users/KevinHock/orgs", "repos_url": "https://api.github.com/users/KevinHock/repos", "events_url": "https://api.github.com/users/KevinHock/events{/privacy}", "received_events_url": "https://api.github.com/users/KevinHock/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-11-08T23:23:29Z", "updated_at": "2017-11-09T02:43:09Z", "closed_at": "2017-11-09T02:43:09Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "My bad \ud83e\udd26\u200d\u2642\ufe0f  \r\n\r\nSo it's supposed to leave everything else 'as is' and just update repo foo.\r\n\r\nWhereas now it deletes all the other repos in the `.pre-commit-config.yaml`, and leaves the updated foo.", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/660/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/660/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/625", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/625/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/625/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/625/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/625", "id": 259509068, "node_id": "MDU6SXNzdWUyNTk1MDkwNjg=", "number": 625, "title": "Apostrophe in syspath causes error", "user": {"login": "seanon414", "id": 5140592, "node_id": "MDQ6VXNlcjUxNDA1OTI=", "avatar_url": "https://avatars.githubusercontent.com/u/5140592?v=4", "gravatar_id": "", "url": "https://api.github.com/users/seanon414", "html_url": "https://github.com/seanon414", "followers_url": "https://api.github.com/users/seanon414/followers", "following_url": "https://api.github.com/users/seanon414/following{/other_user}", "gists_url": "https://api.github.com/users/seanon414/gists{/gist_id}", "starred_url": "https://api.github.com/users/seanon414/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/seanon414/subscriptions", "organizations_url": "https://api.github.com/users/seanon414/orgs", "repos_url": "https://api.github.com/users/seanon414/repos", "events_url": "https://api.github.com/users/seanon414/events{/privacy}", "received_events_url": "https://api.github.com/users/seanon414/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-09-21T14:07:51Z", "updated_at": "2017-09-21T21:31:37Z", "closed_at": "2017-09-21T18:38:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "Runtime\r\n```\r\n$ pre-commit\r\nAn unexpected error has occurred: ValueError: No closing quotation\r\nCheck the log at /Users/sean.o'neill/.cache/pre-commit/pre-commit.log\r\n```\r\n\r\nStacktrace\r\n```\r\n  File \"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/shlex.py\", line 279, in split\r\n    return list(lex)\r\n  File \"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/shlex.py\", line 269, in next\r\n    token = self.get_token()\r\n  File \"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/shlex.py\", line 96, in get_token\r\n    raw = self.read_token()\r\n  File \"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/shlex.py\", line 172, in read_token\r\n    raise ValueError, \"No closing quotation\"\r\nValueError: No closing quotation\r\n```\r\n\r\nUsername in path has an apostrophe in it (not by choice) and causes pre-commit to bomb\r\n\r\nComputer info\r\n```\r\nOS: Mac El Caption 10.11.6\r\nVersion: pre-commit 1.1.2\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/625/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/625/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/623", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/623/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/623/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/623/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/623", "id": 259063199, "node_id": "MDU6SXNzdWUyNTkwNjMxOTk=", "number": 623, "title": "commit-msg stage does not work", "user": {"login": "sobolevn", "id": 4660275, "node_id": "MDQ6VXNlcjQ2NjAyNzU=", "avatar_url": "https://avatars.githubusercontent.com/u/4660275?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sobolevn", "html_url": "https://github.com/sobolevn", "followers_url": "https://api.github.com/users/sobolevn/followers", "following_url": "https://api.github.com/users/sobolevn/following{/other_user}", "gists_url": "https://api.github.com/users/sobolevn/gists{/gist_id}", "starred_url": "https://api.github.com/users/sobolevn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sobolevn/subscriptions", "organizations_url": "https://api.github.com/users/sobolevn/orgs", "repos_url": "https://api.github.com/users/sobolevn/repos", "events_url": "https://api.github.com/users/sobolevn/events{/privacy}", "received_events_url": "https://api.github.com/users/sobolevn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-09-20T07:16:52Z", "updated_at": "2017-09-20T12:58:54Z", "closed_at": "2017-09-20T12:43:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "Everything works as expected when running just `pre-commit install`, then hooks work.\r\nBut when running `pre-commit install -t commit-msg` `IOError` happens, since template could not be found.\r\n\r\nHere's the detailed information.\r\n\r\n## Env\r\n\r\n- `python2.7`\r\n- `pipenv 7.3.7`\r\n- `pre-commit 1.1.1`\r\n\r\nActually tested with both `python2` and `python3`.\r\n\r\n## Configuration\r\n\r\n```yaml\r\n- repo: local\r\n  hooks:\r\n    - id: gitlint\r\n      name: gitlint\r\n      entry: \"bash -c 'gitlint lint'\"\r\n      language: system\r\n      stages: [commit-msg]\r\n\r\n    - id: pytest\r\n      name: pytest\r\n      entry: \"bash -c 'python manage.py test'\"\r\n      language: system\r\n\r\n    - id: safety\r\n      name: safety\r\n      entry: \"bash -c 'safety check'\"\r\n      language: system\r\n```\r\n\r\n## Output\r\n\r\n```\r\n\u00bb pre-commit install -t commit-msg\r\nRunning in migration mode with existing hooks at /Users/sobolev/Desktop/test/.git/hooks/commit-msg.legacy\r\nUse -f to use only pre-commit.\r\nAn unexpected error has occurred: IOError: [Errno 2] No such file or directory: '/Users/sobolev/.virtualenvs/test-p4WySO70/lib/python2.7/site-packages/pre_commit/resources/commit-msg-tmpl'\r\nCheck the log at /Users/sobolev/.cache/pre-commit/pre-commit.log\r\n```\r\n\r\nWhen I do `ls /Users/sobolev/.virtualenvs/test-p4WySO70/lib/python2.7/site-packages/pre_commit/resources/commit-msg-tmpl`  that's what is see:\r\n\r\n```\r\n(test-p4WySO70) ~/Desktop/test  master \u2717                                  \u271a 2 \u26a1\r\n\u00bb ls /Users/sobolev/.virtualenvs/test-p4WySO70/lib/python2.7/site-packages/pre_commit/resources                \r\nempty_template  pre-push-tmpl  ruby-build.tar.gz\r\nhook-tmpl       rbenv.tar.gz   ruby-download.tar.gz\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/623/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/623/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/621", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/621/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/621/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/621/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/621", "id": 258339815, "node_id": "MDU6SXNzdWUyNTgzMzk4MTU=", "number": 621, "title": "Unstaged files + never ran pre-commit => \"No such file or directory: .../.cache/pre-commit/patch...\"", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-09-17T22:15:31Z", "updated_at": "2017-09-18T00:03:29Z", "closed_at": "2017-09-18T00:03:29Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\n$ pre-commit run\r\n[WARNING] Unstaged files detected.\r\n[INFO] Stashing unstaged files to /home/asottile/.cache/pre-commit/patch1505686307.\r\nAn unexpected error has occurred: IOError: [Errno 2] No such file or directory: '/home/asottile/.cache/pre-commit/patch1505686307'\r\nCheck the log at /home/asottile/.cache/pre-commit/pre-commit.log\r\n```\r\n\r\nStacktrace:\r\n\r\n```python\r\nTraceback (most recent call last):\r\n  File \"/home/asottile/workspace/pre-commit/pre_commit/error_handler.py\", line 44, in error_handler\r\n    yield\r\n  File \"/home/asottile/workspace/pre-commit/pre_commit/main.py\", line 231, in main\r\n    return run(runner, args)\r\n  File \"/home/asottile/workspace/pre-commit/pre_commit/commands/run.py\", line 249, in run\r\n    with ctx:\r\n  File \"/usr/lib/python2.7/contextlib.py\", line 17, in __enter__\r\n    return self.gen.next()\r\n  File \"/home/asottile/workspace/pre-commit/pre_commit/staged_files_only.py\", line 46, in staged_files_only\r\n    with io.open(patch_filename, 'wb') as patch_file:\r\nIOError: [Errno 2] No such file or directory: '/home/asottile/.cache/pre-commit/patch1505686307'\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/621/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/621/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/620", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/620/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/620/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/620/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/620", "id": 258338379, "node_id": "MDU6SXNzdWUyNTgzMzgzNzk=", "number": 620, "title": "Git For Windows support", "user": {"login": "Lucas-C", "id": 925560, "node_id": "MDQ6VXNlcjkyNTU2MA==", "avatar_url": "https://avatars.githubusercontent.com/u/925560?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lucas-C", "html_url": "https://github.com/Lucas-C", "followers_url": "https://api.github.com/users/Lucas-C/followers", "following_url": "https://api.github.com/users/Lucas-C/following{/other_user}", "gists_url": "https://api.github.com/users/Lucas-C/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lucas-C/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lucas-C/subscriptions", "organizations_url": "https://api.github.com/users/Lucas-C/orgs", "repos_url": "https://api.github.com/users/Lucas-C/repos", "events_url": "https://api.github.com/users/Lucas-C/events{/privacy}", "received_events_url": "https://api.github.com/users/Lucas-C/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 321107135, "node_id": "MDU6TGFiZWwzMjExMDcxMzU=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/question", "name": "question", "color": "999999", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2017-09-17T21:55:02Z", "updated_at": "2017-09-18T12:41:27Z", "closed_at": "2017-09-17T22:16:11Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi.\r\n\r\nIs [Git For Windows](https://git-for-windows.github.io) supported ?\r\n\r\nIn doubt, I'm reporting 2 issues I have with the latest version (2.14.1) and the latest Python For Windows version (3.6.2) :\r\n- when I try `install-local.py` :\r\n```\r\n$ curl http://pre-commit.com/install-local.py | python\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100  2590  100  2590    0     0   2590      0  0:00:01 --:--:--  0:00:01  8274\r\nUsing base prefix 'D:\\\\devhome\\\\tools\\\\Python36'\r\nNew python executable in C:\\Users\\lucas_cimon\\.pre-commit-venv\\Scripts\\python.exe\r\nInstalling setuptools, pip, wheel...done.\r\nDownloading https://pypi.python.org/packages/d4/0c/9840c08189e030873387a73b90ada981885010dd9aea134d6de30cd24cb8/virtualenv-15.1.0.tar.gz\r\nDone.\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 103, in <module>\r\n  File \"<stdin>\", line 80, in main\r\n  File \"D:\\devhome\\tools\\Python36\\lib\\subprocess.py\", line 286, in check_call\r\n    retcode = call(*popenargs, **kwargs)\r\n  File \"D:\\devhome\\tools\\Python36\\lib\\subprocess.py\", line 267, in call\r\n    with Popen(*popenargs, **kwargs) as p:\r\n  File \"D:\\devhome\\tools\\Python36\\lib\\subprocess.py\", line 707, in __init__\r\n    restore_signals, start_new_session)\r\n  File \"D:\\devhome\\tools\\Python36\\lib\\subprocess.py\", line 992, in _execute_child\r\n    startupinfo)\r\nFileNotFoundError: [WinError 2] Le fichier sp\u00e9cifi\u00e9 est introuvable\r\n```\r\n- when I install `pre-commit` through `pip`, and try to run it:\r\n```\r\n$ pre-commit run\r\n[WARNING] Unstaged files detected.\r\n[INFO] Stashing unstaged files to C:\\Users\\lucas_cimon/.cache\\pre-commit\\patch1505684784.\r\nAn unexpected error has occurred: FileNotFoundError: [Errno 2] No such file or directory: 'C:\\\\Users\\\\lucas_cimon/.cache\\\\pre-commit\\\\patch1505684784'\r\nCheck the log at C:\\Users\\lucas_cimon/.cache\\pre-commit\\pre-commit.log\r\n$ cat ~/.cache/pre-commit/pre-commit.log\r\nAn unexpected error has occurred: FileNotFoundError: [Errno 2] No such file or directory: 'C:\\\\Users\\\\lucas_cimon/.cache\\\\pre-commit\\\\patch1505684784'\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\lucas_cimon\\AppData\\Roaming\\Python\\Python36\\site-packages\\pre_commit\\error_handler.py\", line 44, in error_handler\r\n    yield\r\n  File \"C:\\Users\\lucas_cimon\\AppData\\Roaming\\Python\\Python36\\site-packages\\pre_commit\\main.py\", line 231, in main\r\n    return run(runner, args)\r\n  File \"C:\\Users\\lucas_cimon\\AppData\\Roaming\\Python\\Python36\\site-packages\\pre_commit\\commands\\run.py\", line 249, in run\r\n    with ctx:\r\n  File \"d:\\devhome\\tools\\python36\\lib\\contextlib.py\", line 81, in __enter__\r\n    return next(self.gen)\r\n  File \"C:\\Users\\lucas_cimon\\AppData\\Roaming\\Python\\Python36\\site-packages\\pre_commit\\staged_files_only.py\", line 46, in staged_files_only\r\n    with io.open(patch_filename, 'wb') as patch_file:\r\nFileNotFoundError: [Errno 2] No such file or directory: 'C:\\\\Users\\\\lucas_cimon/.cache\\\\pre-commit\\\\patch1505684784'\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/620/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/620/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/603", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/603/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/603/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/603/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/603", "id": 255188854, "node_id": "MDU6SXNzdWUyNTUxODg4NTQ=", "number": 603, "title": "Non-English directories are skipped", "user": {"login": "AlekSi", "id": 11512, "node_id": "MDQ6VXNlcjExNTEy", "avatar_url": "https://avatars.githubusercontent.com/u/11512?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AlekSi", "html_url": "https://github.com/AlekSi", "followers_url": "https://api.github.com/users/AlekSi/followers", "following_url": "https://api.github.com/users/AlekSi/following{/other_user}", "gists_url": "https://api.github.com/users/AlekSi/gists{/gist_id}", "starred_url": "https://api.github.com/users/AlekSi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AlekSi/subscriptions", "organizations_url": "https://api.github.com/users/AlekSi/orgs", "repos_url": "https://api.github.com/users/AlekSi/repos", "events_url": "https://api.github.com/users/AlekSi/events{/privacy}", "received_events_url": "https://api.github.com/users/AlekSi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2017-09-05T07:50:56Z", "updated_at": "2017-09-06T13:54:56Z", "closed_at": "2017-09-05T15:38:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "Looks like pre-commit skips non-English directories. Please take a look at those:\r\n\r\n* https://github.com/GolangShow/golangshow.com/commit/df0529b104739ba8d1de9182d37dfb80bbddf679\r\n* https://travis-ci.org/GolangShow/golangshow.com/builds/271948939\r\n\r\nA relevant bit from the full Travis build output:\r\n```\r\n$ pre-commit run --all-files\r\n[\u2026]\r\nTrim Trailing Whitespace.................................................Failed\r\nhookid: trailing-whitespace\r\nFiles were modified by this hook. Additional output:\r\nFixing public/episode/2017/04-14-096/index.html\r\nFixing public/episode/2016/03-31-050/index.html\r\n[\u2026]\r\nFixing public/episode/2016/09-01-072/index.html\r\nFixing public/episode/2015/12-29-036/index.html\r\nThe command \"pre-commit run --all-files\" exited with 1.\r\n\r\n$ git status\r\nHEAD detached at df0529b\r\nChanges not staged for commit:\r\n  (use \"git add <file>...\" to update what will be committed)\r\n  (use \"git checkout -- <file>...\" to discard changes in working directory)\r\n\tmodified:   \"public/categories/\\320\\263\\320\\276\\321\\201\\321\\202\\320\\270/index.html\"\r\n\tmodified:   \"public/categories/\\320\\263\\320\\276\\321\\201\\321\\202\\320\\270/index.xml\"\r\n\tmodified:   \"public/categories/\\320\\270\\320\\275\\321\\202\\320\\265\\321\\200\\320\\262\\321\\214\\321\\216/index.html\"\r\n\tmodified:   \"public/categories/\\320\\270\\320\\275\\321\\202\\320\\265\\321\\200\\320\\262\\321\\214\\321\\216/index.xml\"\r\n\tmodified:   \"public/categories/\\320\\270\\321\\202\\320\\276\\320\\263\\320\\270/index.html\"\r\n\tmodified:   \"public/categories/\\320\\270\\321\\202\\320\\276\\320\\263\\320\\270/index.xml\"\r\n\tmodified:   \"public/categories/\\320\\272\\320\\260\\320\\274\\320\\270\\320\\275/index.html\"\r\n\tmodified:   \"public/categories/\\320\\272\\320\\260\\320\\274\\320\\270\\320\\275/index.xml\"\r\n\tmodified:   \"public/categories/\\320\\275\\320\\276\\320\\262\\320\\276\\321\\201\\321\\202\\320\\270/index.html\"\r\n\tmodified:   \"public/categories/\\320\\275\\320\\276\\320\\262\\320\\276\\321\\201\\321\\202\\320\\270/index.xml\"\r\n\tmodified:   public/js/highlight.pack.js\r\n\tmodified:   public/page/1/index.html\r\nno changes added to commit (use \"git add\" and/or \"git commit -a\")\r\n```\r\n\r\nThose directories in `public/categories/` are `\u0433\u043e\u0441\u0442\u0438`, `\u0438\u0442\u043e\u0433\u0438`, `\u043a\u0430\u043c\u0438\u043d`, `\u043d\u043e\u0432\u043e\u0441\u0442\u0438`, and `\u0438\u043d\u0442\u0435\u0440\u0432\u044c\u044e`.", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/603/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/603/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/570", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/570/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/570/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/570/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/570", "id": 246662225, "node_id": "MDU6SXNzdWUyNDY2NjIyMjU=", "number": 570, "title": "git unadd changes lost if hook fails on windows", "user": {"login": "RunningToTheEdgeOfTheWorld", "id": 22519984, "node_id": "MDQ6VXNlcjIyNTE5OTg0", "avatar_url": "https://avatars.githubusercontent.com/u/22519984?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RunningToTheEdgeOfTheWorld", "html_url": "https://github.com/RunningToTheEdgeOfTheWorld", "followers_url": "https://api.github.com/users/RunningToTheEdgeOfTheWorld/followers", "following_url": "https://api.github.com/users/RunningToTheEdgeOfTheWorld/following{/other_user}", "gists_url": "https://api.github.com/users/RunningToTheEdgeOfTheWorld/gists{/gist_id}", "starred_url": "https://api.github.com/users/RunningToTheEdgeOfTheWorld/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RunningToTheEdgeOfTheWorld/subscriptions", "organizations_url": "https://api.github.com/users/RunningToTheEdgeOfTheWorld/orgs", "repos_url": "https://api.github.com/users/RunningToTheEdgeOfTheWorld/repos", "events_url": "https://api.github.com/users/RunningToTheEdgeOfTheWorld/events{/privacy}", "received_events_url": "https://api.github.com/users/RunningToTheEdgeOfTheWorld/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 181543993, "node_id": "MDU6TGFiZWwxODE1NDM5OTM=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/windows", "name": "windows", "color": "5319e7", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 19, "created_at": "2017-07-31T07:00:54Z", "updated_at": "2017-08-02T02:25:49Z", "closed_at": "2017-08-01T19:57:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\nD:\\CubeadProjects\\devops [test +0 ~2 -0 | +0 ~1 -0 !]> git cm \"asd\"\r\n[WARNING] Unstaged files detected.\r\n[INFO] Stashing unstaged files to C:\\Users\\56929\\.pre-commit\\patch1501482991.\r\nrun pylint...............................................................Failed\r\nhookid: python-pylint\r\n\r\n************* Module install\r\nC: 10, 0: Exactly one space required around assignment\r\na=1\r\n ^ (bad-whitespace)\r\nC: 46, 0: Line too long (108/100) (line-too-long)\r\nW: 39, 4: Unused variable 'stylelint_root' (unused-variable)\r\nW: 37, 4: Unused variable 'node_root' (unused-variable)\r\nW: 24, 8: Unused variable 'checks' (unused-variable)\r\n\r\n[WARNING] Stashed changes conflicted with hook auto-fixes... Rolling back fixes...\r\nAn unexpected error has occurred: CalledProcessError: Command: ('C:\\\\Program Files\\\\Git\\\\mingw64\\\\libexec\\\\git-core\\\\git.exe', 'apply', 'C:\\\\Users\\\\56929\\\\.pre-commit\\\\patch1501483011')\r\nReturn code: 1\r\nExpected return code: 0\r\nOutput: (none)\r\nErrors:\r\n    error: patch failed: svnchecker_stylelint_support/checks/Stylelint.py:20\r\n    error: svnchecker_stylelint_support/checks/Stylelint.py: patch does not apply\r\n\r\n\r\nCheck the log at ~/.pre-commit/pre-commit.log\r\n```\r\n\r\n### ~/.pre-commit/pre-commit.log\r\n```\r\nAn unexpected error has occurred: CalledProcessError: Command: ('C:\\\\Program Files\\\\Git\\\\mingw64\\\\libexec\\\\git-core\\\\git.exe', 'apply', 'C:\\\\Users\\\\56929\\\\.pre-commit\\\\patch1501483011')\r\nReturn code: 1\r\nExpected return code: 0\r\nOutput: (none)\r\nErrors: \r\n    error: patch failed: svnchecker_stylelint_support/checks/Stylelint.py:20\r\n    error: svnchecker_stylelint_support/checks/Stylelint.py: patch does not apply\r\n    \r\n\r\nTraceback (most recent call last):\r\n  File \"c:\\python27\\lib\\site-packages\\pre_commit\\error_handler.py\", line 48, in error_handler\r\n    yield\r\n  File \"c:\\python27\\lib\\site-packages\\pre_commit\\main.py\", line 231, in main\r\n    return run(runner, args)\r\n  File \"c:\\python27\\lib\\site-packages\\pre_commit\\commands\\run.py\", line 273, in run\r\n    return _run_hooks(repo_hooks, args, environ)\r\n  File \"c:\\python27\\lib\\contextlib.py\", line 24, in __exit__\r\n    self.gen.next()\r\n  File \"c:\\python27\\lib\\site-packages\\pre_commit\\staged_files_only.py\", line 58, in staged_files_only\r\n    cmd_runner.run(('git', 'apply', patch_filename), encoding=None)\r\n  File \"c:\\python27\\lib\\site-packages\\pre_commit\\prefixed_command_runner.py\", line 38, in run\r\n    return cmd_output(*replaced_cmd, __popen=self.__popen, **kwargs)\r\n  File \"c:\\python27\\lib\\site-packages\\pre_commit\\util.py\", line 189, in cmd_output\r\n    returncode, cmd, retcode, output=(stdout, stderr),\r\nCalledProcessError: Command: ('C:\\\\Program Files\\\\Git\\\\mingw64\\\\libexec\\\\git-core\\\\git.exe', 'apply', 'C:\\\\Users\\\\56929\\\\.pre-commit\\\\patch1501483011')\r\nReturn code: 1\r\nExpected return code: 0\r\nOutput: (none)\r\nErrors: \r\n    error: patch failed: svnchecker_stylelint_support/checks/Stylelint.py:20\r\n    error: svnchecker_stylelint_support/checks/Stylelint.py: patch does not apply\r\n```\r\nThen, I open the patch file. (C:\\\\Users\\\\56929\\\\.pre-commit\\\\patch1501483011),it looks like \r\n\r\n```diff\r\ndiff --git a/svnchecker_stylelint_support/checks/Stylelint.py b/svnchecker_stylelint_support/checks/Stylelint.py\r\nindex 4422b4d..f85ecb1 100644\r\n--- a/svnchecker_stylelint_support/checks/Stylelint.py\r\n+++ b/svnchecker_stylelint_support/checks/Stylelint.py\r\n@@ -20,3 +20,5 @@ def run(transaction, config):\r\n             return ('{}\\n{}'.format(stdoutdata, stderrdata), 1)^M\r\n^M\r\n     return (\"\", 0)^M\r\n^M\r\n^M\r\n^M\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/570/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/570/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/545", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/545/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/545/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/545/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/545", "id": 234780983, "node_id": "MDU6SXNzdWUyMzQ3ODA5ODM=", "number": 545, "title": "git diff enhancement to add --no-ext-diff", "user": {"login": "AlbanAndrieu", "id": 7859836, "node_id": "MDQ6VXNlcjc4NTk4MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/7859836?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AlbanAndrieu", "html_url": "https://github.com/AlbanAndrieu", "followers_url": "https://api.github.com/users/AlbanAndrieu/followers", "following_url": "https://api.github.com/users/AlbanAndrieu/following{/other_user}", "gists_url": "https://api.github.com/users/AlbanAndrieu/gists{/gist_id}", "starred_url": "https://api.github.com/users/AlbanAndrieu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AlbanAndrieu/subscriptions", "organizations_url": "https://api.github.com/users/AlbanAndrieu/orgs", "repos_url": "https://api.github.com/users/AlbanAndrieu/repos", "events_url": "https://api.github.com/users/AlbanAndrieu/events{/privacy}", "received_events_url": "https://api.github.com/users/AlbanAndrieu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-06-09T10:05:38Z", "updated_at": "2017-06-09T22:01:13Z", "closed_at": "2017-06-09T20:01:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nIs there a way when running command\r\n\r\n```\r\npre-commit run --all-files\r\n```\r\n\r\nTo use git diff --no-ext-diff instead of git diff\r\n\r\nMaybe using an environment variable to add this external  --no-ext-diff parameter in the script https://github.com/pre-commit/pre-commit/blob/master/pre_commit/git.py ?\r\n\r\nMy issue comes from the fact that I am using meld in my ~/.gitconfig\r\n\r\n```\r\n[diff]\r\n\texternal = /usr/local/bin/git-diff.sh\r\n[push]\r\n\tdefault = simple\r\n[merge]\r\n\ttool = meld\r\n\trenamelimit = 10000\r\n```\r\n\r\nless  /usr/local/bin/git-diff.sh\r\n\r\n```\r\n#!/bin/bash\r\nmeld \"$2\" \"$5\" > /dev/null 2>&1\r\n```\r\n\r\nSo every-time pre-commit run --all-files run I have a popup with meld that I must close.\r\nIt is annoying...\r\n\r\nFeel free to help me to find the right code and I might find some time to do a pull request...\r\n\r\nBest regards,\r\n\r\nAlban", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/545/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/545/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/536", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/536/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/536/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/536/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/536", "id": 227759374, "node_id": "MDU6SXNzdWUyMjc3NTkzNzQ=", "number": 536, "title": "Unicode error: python 2 + merge conflict + non-ascii commit message", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-05-10T17:47:35Z", "updated_at": "2017-05-16T19:52:33Z", "closed_at": "2017-05-10T22:06:20Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "The important part of the stack:\r\n\r\n```\r\n  File \"...python2.7/site-packages/pre_commit/commands/run.py\", line 52, in get_filenames\r\n    return getter(include_expr, exclude_expr)\r\n  File \"...python2.7/site-packages/pre_commit/util.py\", line 46, in wrapper\r\n    ret = wrapper._cache[key] = func(*args)\r\n  File \"...python2.7/site-packages/pre_commit/git.py\", line 98, in wrapper\r\n    for filename in all_file_list_strategy()\r\n  File \"...python2.7/site-packages/pre_commit/util.py\", line 46, in wrapper\r\n    ret = wrapper._cache[key] = func(*args)\r\n  File \"...python2.7/site-packages/pre_commit/git.py\", line 64, in get_conflicted_files\r\n    merge_conflict_filenames = parse_merge_msg_for_conflicts(merge_msg)\r\n  File \"...python2.7/site-packages/pre_commit/git.py\", line 54, in parse_merge_msg_for_conflicts\r\n    if line.startswith(('\\t', '#\\t'))\r\nUnicodeDecodeError: 'ascii' codec can't decode byte 0xe2 in position 37: ordinal not in range(128)\r\n```\r\n\r\nAn easy fix: https://github.com/pre-commit/pre-commit/blob/e3b14c35f782ed464e3f96b44e8509048187689f/pre_commit/git.py#L63", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/536/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/536/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/533", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/533/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/533/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/533/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/533", "id": 227072955, "node_id": "MDU6SXNzdWUyMjcwNzI5NTU=", "number": 533, "title": "always_run + no `files` still crashes on `KeyError: files`", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-05-08T14:56:04Z", "updated_at": "2017-05-31T02:26:47Z", "closed_at": "2017-05-31T02:26:47Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I was under the impression `files` was completely ignored for `always_run`, I guess not!\r\n\r\nHere's a small reproduction:\r\n\r\n```yaml\r\n-   repo: local\r\n    hooks:\r\n    -   id: foo\r\n        name: foo\r\n        always_run: true\r\n        entry: bash -c 'echo hello && exit 1'\r\n        language: system\r\n```\r\n\r\n```\r\n$ ./venv-pre_commit/bin/pre-commit run foo\r\nAn unexpected error has occurred: KeyError: u'files'\r\nCheck the log at ~/.pre-commit/pre-commit.log\r\n```\r\n\r\n```\r\n$ cat ~/.pre-commit/pre-commit.log \r\nAn unexpected error has occurred: KeyError: u'files'\r\nTraceback (most recent call last):\r\n  File \"/tmp/foo/pre-commit/pre_commit/error_handler.py\", line 48, in error_handler\r\n    yield\r\n  File \"/tmp/foo/pre-commit/pre_commit/main.py\", line 226, in main\r\n    return run(runner, args)\r\n  File \"/tmp/foo/pre-commit/pre_commit/commands/run.py\", line 235, in run\r\n    return _run_hooks(repo_hooks, args, environ)\r\n  File \"/tmp/foo/pre-commit/pre_commit/commands/run.py\", line 155, in _run_hooks\r\n    retval |= _run_single_hook(hook, repo, args, skips, cols)\r\n  File \"/tmp/foo/pre-commit/pre_commit/commands/run.py\", line 60, in _run_single_hook\r\n    filenames = get_filenames(args, hook['files'], hook['exclude'])\r\nKeyError: u'files'\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/533/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/533/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/502", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/502/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/502/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/502/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/502", "id": 211818891, "node_id": "MDU6SXNzdWUyMTE4MTg4OTE=", "number": 502, "title": "Validation of pre-commit breaks if 'files' property not present for `always_run` hooks", "user": {"login": "prat0318", "id": 1528697, "node_id": "MDQ6VXNlcjE1Mjg2OTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1528697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/prat0318", "html_url": "https://github.com/prat0318", "followers_url": "https://api.github.com/users/prat0318/followers", "following_url": "https://api.github.com/users/prat0318/following{/other_user}", "gists_url": "https://api.github.com/users/prat0318/gists{/gist_id}", "starred_url": "https://api.github.com/users/prat0318/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/prat0318/subscriptions", "organizations_url": "https://api.github.com/users/prat0318/orgs", "repos_url": "https://api.github.com/users/prat0318/repos", "events_url": "https://api.github.com/users/prat0318/events{/privacy}", "received_events_url": "https://api.github.com/users/prat0318/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-03-03T22:26:24Z", "updated_at": "2017-03-27T14:56:04Z", "closed_at": "2017-03-09T00:21:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "As per the docs, `files` is optional. But, looks like it is not.\r\n\r\n```python\r\nAn unexpected error has occurred: ValidationError: u'files' is a required property\r\n\r\nFailed validating u'required' in schema:\r\n    {u'properties': {u'additional_dependencies': {u'items': {u'type': u'string'},\r\n                                                  u'type': u'array'},\r\n                     u'always_run': {u'default': False,\r\n                                     u'type': u'boolean'},\r\n                     u'args': {u'default': [],\r\n                               u'items': {u'type': u'string'},\r\n                               u'type': u'array'},\r\n                     u'description': {u'default': u'',\r\n                                      u'type': u'string'},\r\n                     u'entry': {u'type': u'string'},\r\n                     u'exclude': {u'default': u'^$', u'type': u'string'},\r\n                     u'files': {u'type': u'string'},\r\n                     u'id': {u'type': u'string'},\r\n                     u'language': {u'type': u'string'},\r\n                     u'language_version': {u'default': u'default',\r\n                                           u'type': u'string'},\r\n                     u'minimum_pre_commit_version': {u'default': u'0.0.0',\r\n                                                     u'type': u'string'},\r\n                     u'name': {u'type': u'string'},\r\n                     u'stages': {u'default': [],\r\n                                 u'items': {u'type': u'string'},\r\n                                 u'type': u'array'}},\r\n     u'required': [u'id', u'name', u'entry', u'language', u'files'],\r\n     u'type': u'object'}\r\n\r\nOn instance:\r\n    {'always_run': True,\r\n     'entry': \"bash -c 'foo bar'\",\r\n     'id': 'swagger-validate',\r\n     'language': 'system',\r\n     'name': 'swagger-validate'}\r\nCheck the log at ~/.pre-commit/pre-commit.log\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/502/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/502/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/491", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/491/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/491/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/491/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/491", "id": 208212460, "node_id": "MDU6SXNzdWUyMDgyMTI0NjA=", "number": 491, "title": "Encode some sort of \"version\" for language-local repositories", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 85713407, "node_id": "MDU6TGFiZWw4NTcxMzQwNw==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/feature", "name": "feature", "color": "207de5", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-02-16T18:53:30Z", "updated_at": "2017-02-16T21:50:11Z", "closed_at": "2017-02-16T21:50:11Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Without this, they'll never get upgraded if fixes are made in the pre-commit empty template", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/491/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/491/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/477", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/477/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/477/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/477/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/477", "id": 203754798, "node_id": "MDU6SXNzdWUyMDM3NTQ3OTg=", "number": 477, "title": "`docker build` argument order is invalid on old versions of Docker", "user": {"login": "chriskuehl", "id": 665269, "node_id": "MDQ6VXNlcjY2NTI2OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/665269?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chriskuehl", "html_url": "https://github.com/chriskuehl", "followers_url": "https://api.github.com/users/chriskuehl/followers", "following_url": "https://api.github.com/users/chriskuehl/following{/other_user}", "gists_url": "https://api.github.com/users/chriskuehl/gists{/gist_id}", "starred_url": "https://api.github.com/users/chriskuehl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chriskuehl/subscriptions", "organizations_url": "https://api.github.com/users/chriskuehl/orgs", "repos_url": "https://api.github.com/users/chriskuehl/repos", "events_url": "https://api.github.com/users/chriskuehl/events{/privacy}", "received_events_url": "https://api.github.com/users/chriskuehl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-01-27T22:20:05Z", "updated_at": "2017-01-27T22:27:25Z", "closed_at": "2017-01-27T22:27:25Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "We do: `docker build . --tag thing --label thing`\r\n\r\nBut this produces an error on Docker 1.11.2:\r\n```\r\nckuehl@dev4-uswest1cdevc:~/proj/pre-commit$ docker build . --tag thing --label thing\r\ndocker: \"build\" requires 1 argument.\r\nSee 'docker build --help'.\r\n\r\nUsage:  docker build [OPTIONS] PATH | URL | -\r\n\r\nBuild an image from a Dockerfile\r\n```\r\n\r\nThe path needs to go at the end on 1.11.2, but it works on 1.13.0 as-is. We should probably just change the order of the arguments to make every version happy.", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/477/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/477/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/471", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/471/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/471/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/471/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/471", "id": 202720456, "node_id": "MDU6SXNzdWUyMDI3MjA0NTY=", "number": 471, "title": "Can't use ruby hooks with \"BUNDLE_DISABLE_SHARED_GEMS: true\" in .bundle/config", "user": {"login": "chriskuehl", "id": 665269, "node_id": "MDQ6VXNlcjY2NTI2OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/665269?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chriskuehl", "html_url": "https://github.com/chriskuehl", "followers_url": "https://api.github.com/users/chriskuehl/followers", "following_url": "https://api.github.com/users/chriskuehl/following{/other_user}", "gists_url": "https://api.github.com/users/chriskuehl/gists{/gist_id}", "starred_url": "https://api.github.com/users/chriskuehl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chriskuehl/subscriptions", "organizations_url": "https://api.github.com/users/chriskuehl/orgs", "repos_url": "https://api.github.com/users/chriskuehl/repos", "events_url": "https://api.github.com/users/chriskuehl/events{/privacy}", "received_events_url": "https://api.github.com/users/chriskuehl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 352542360, "node_id": "MDU6TGFiZWwzNTI1NDIzNjA=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/ruby", "name": "ruby", "color": "cc342d", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-01-24T04:12:24Z", "updated_at": "2017-01-24T14:22:44Z", "closed_at": "2017-01-24T14:22:44Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I have a repo with a `.bundle/config` file with these contents:\r\n```yaml\r\nBUNDLE_DISABLE_SHARED_GEMS: true\r\nBUNDLE_PATH: vendor/gem\r\n```\r\n\r\nAnd a `Gemfile` with these contents:\r\n```ruby\r\ngem 'lol_hai'\r\n```\r\n\r\nI can't use any Ruby hooks in this repo; I get an error like this:\r\n\r\n```\r\n/nail/home/ckuehl/.pre-commit/repobarlh9c4/rbenv-1.9.3-p551/versions/1.9.3-p551/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:315:in `to_specs': Could not find '__fake_gem' (>= 0) among 0 total gem(s) (Gem::LoadError)\r\nChecked in 'GEM_PATH=/nail/tmp/tmp.jPQDWVcTGz/pre-commit-bug/vendor/gem/ruby/1.9.1', execute `gem env` for more information\r\n        from /nail/home/ckuehl/.pre-commit/repobarlh9c4/rbenv-1.9.3-p551/versions/1.9.3-p551/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:324:in `to_spec'\r\n        from /nail/home/ckuehl/.pre-commit/repobarlh9c4/rbenv-1.9.3-p551/versions/1.9.3-p551/lib/ruby/site_ruby/1.9.1/rubygems/core_ext/kernel_gem.rb:58:in `gem'\r\n        from /nail/home/ckuehl/.pre-commit/repobarlh9c4/rbenv-1.9.3-p551/gems/bin/puppet-validate:22:in `<main>'\r\n        from /nail/home/ckuehl/.pre-commit/repobarlh9c4/rbenv-1.9.3-p551/gems/bin/ruby_executable_hooks:15:in `eval'\r\n        from /nail/home/ckuehl/.pre-commit/repobarlh9c4/rbenv-1.9.3-p551/gems/bin/ruby_executable_hooks:15:in `<main>'\r\n```\r\n\r\nInteresting bit is: `GEM_PATH=/nail/tmp/tmp.jPQDWVcTGz/pre-commit-bug/vendor/gem/ruby/1.9.1`\r\n\r\nThat doesn't look right (it's a path in my project).\r\n\r\n\r\nHere's a failing test:\r\n\r\n```patch\r\ncommit 260f981ae8cdf1c6b1f796dda5cf56811ed237d3 (HEAD -> gemfile-in-root, origin/gemfile-in-root)\r\nAuthor:     Chris Kuehl <ckuehl@ocf.berkeley.edu>\r\nAuthorDate: Mon Jan 23 19:39:47 2017 -0800\r\nCommit:     Chris Kuehl <ckuehl@yelp.com>\r\nCommitDate: Mon Jan 23 19:59:28 2017 -0800\r\n\r\n    Add failing test for BUNDLE_DISABLE_SHARED_GEMS\r\n\r\ndiff --git a/tests/repository_test.py b/tests/repository_test.py\r\nindex b7ce8dd..203852c 100644\r\n--- a/tests/repository_test.py\r\n+++ b/tests/repository_test.py\r\n@@ -207,6 +207,30 @@ def test_run_versioned_ruby_hook(tempdir_factory, store):\r\n     )\r\n \r\n \r\n+@skipif_slowtests_false\r\n+@xfailif_windows_no_ruby\r\n+@pytest.mark.integration\r\n+def test_run_ruby_hook_with_disable_shared_gems(\r\n+        tempdir_factory,\r\n+        store,\r\n+        tmpdir,\r\n+):\r\n+    \"\"\"Make sure a Gemfile in the project doesn't interfere.\"\"\"\r\n+    tmpdir.join('Gemfile').write('gem \"lol_hai\"')\r\n+    tmpdir.join('.bundle').mkdir()\r\n+    tmpdir.join('.bundle', 'config').write(\r\n+        'BUNDLE_DISABLE_SHARED_GEMS: true\\n'\r\n+        'BUNDLE_PATH: vendor/gem\\n'\r\n+    )\r\n+    with cwd(tmpdir.strpath):\r\n+        _test_hook_repo(\r\n+            tempdir_factory, store, 'ruby_versioned_hooks_repo',\r\n+            'ruby_hook',\r\n+            ['/dev/null'],\r\n+            b'2.1.5\\nHello world from a ruby hook\\n',\r\n+        )\r\n+\r\n+\r\n @pytest.mark.integration\r\n def test_system_hook_with_spaces(tempdir_factory, store):\r\n     _test_hook_repo(\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/471/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/471/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/455", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/455/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/455/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/455/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/455", "id": 196404493, "node_id": "MDU6SXNzdWUxOTY0MDQ0OTM=", "number": 455, "title": "nodeenv try to download non existing tar.gz prebuilt under Cygwin", "user": {"login": "Lucas-C", "id": 925560, "node_id": "MDQ6VXNlcjkyNTU2MA==", "avatar_url": "https://avatars.githubusercontent.com/u/925560?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lucas-C", "html_url": "https://github.com/Lucas-C", "followers_url": "https://api.github.com/users/Lucas-C/followers", "following_url": "https://api.github.com/users/Lucas-C/following{/other_user}", "gists_url": "https://api.github.com/users/Lucas-C/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lucas-C/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lucas-C/subscriptions", "organizations_url": "https://api.github.com/users/Lucas-C/orgs", "repos_url": "https://api.github.com/users/Lucas-C/repos", "events_url": "https://api.github.com/users/Lucas-C/events{/privacy}", "received_events_url": "https://api.github.com/users/Lucas-C/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 181543993, "node_id": "MDU6TGFiZWwxODE1NDM5OTM=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/windows", "name": "windows", "color": "5319e7", "default": false, "description": null}, {"id": 352543934, "node_id": "MDU6TGFiZWwzNTI1NDM5MzQ=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/javascript", "name": "javascript", "color": "f0db4f", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2016-12-19T12:39:43Z", "updated_at": "2017-09-06T14:32:59Z", "closed_at": "2017-08-04T16:01:19Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi,\r\n\r\nStrange issue: I suspect a recent change broke this as it used to work last week, on another Windows computer with Cygwin.\r\n\r\nBug reproduction: `pre-commit run` using e.g. https://github.com/Lucas-C/pre-commit-hooks-html v1.1.0\r\n\r\n`pre-commit` execute the following command under the hood, a command that also fails if I execute it manually:\r\n```\r\nnodeenv --prebuilt /cygdrive/c/Users/admin/.pre-commit/repoYHJ85q/node_env-default\r\n```\r\nThe error is the following:\r\n```\r\nurllib2.HTTPError: HTTP Error 404: Not Found\r\n```\r\nThe `tar.gz` it tries to install is https://nodejs.org/dist/v7.2.1/node-v7.2.1-cygwin_nt-6.1-x64.tar.gz, which does not exist. My guess is that `nodeenv` should use the Windows prebuilts instead: https://nodejs.org/dist/v7.2.1/node-v7.2.1-win-x64.zip This is because `platform.system()` is used: https://github.com/ekalinin/nodeenv/blob/master/nodeenv.py#L503\r\n\r\nI'm going to ask for help on the https://github.com/ekalinin/nodeenv project, but do you have any hint at what the root cause could be here ?", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/455/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/455/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/447", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/447/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/447/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/447/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/447", "id": 193360273, "node_id": "MDU6SXNzdWUxOTMzNjAyNzM=", "number": 447, "title": "PCRE passes even if ggrep is not installed on OS X", "user": {"login": "cmer", "id": 412, "node_id": "MDQ6VXNlcjQxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/412?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cmer", "html_url": "https://github.com/cmer", "followers_url": "https://api.github.com/users/cmer/followers", "following_url": "https://api.github.com/users/cmer/following{/other_user}", "gists_url": "https://api.github.com/users/cmer/gists{/gist_id}", "starred_url": "https://api.github.com/users/cmer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cmer/subscriptions", "organizations_url": "https://api.github.com/users/cmer/orgs", "repos_url": "https://api.github.com/users/cmer/repos", "events_url": "https://api.github.com/users/cmer/events{/privacy}", "received_events_url": "https://api.github.com/users/cmer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 181544375, "node_id": "MDU6TGFiZWwxODE1NDQzNzU=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/osx", "name": "osx", "color": "006b75", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2016-12-04T16:36:25Z", "updated_at": "2017-01-23T23:36:03Z", "closed_at": "2016-12-05T16:04:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "I was scratching my head because some hooks were passing even though they should clearly have failed.\r\n\r\nWhen running `run --all-files` with the `--verbose` flag, I noticed why this was happening:\r\n\r\n````\r\n[do_not_commit] Block if \"DO NOT COMMIT\" is found..................................................................Passed\r\nhookid: do_not_commit\r\n\r\nExecutable `ggrep` not found\r\n````\r\n\r\nIt seems like the correct behaviour would be to fail and warn user to install `ggrep`?\r\n\r\nFor the record, I installed `ggrep` as follow: `brew install homebrew/dupes/grep`, and the hooks now fail as expected.", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/447/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/447/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/437", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/437/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/437/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/437/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/437", "id": 191831830, "node_id": "MDU6SXNzdWUxOTE4MzE4MzA=", "number": 437, "title": "cygwin python checking should happen after setup code", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2016-11-26T23:10:32Z", "updated_at": "2016-11-26T23:30:13Z", "closed_at": "2016-11-26T23:30:13Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Regressed as part of #436\r\n\r\nBefore:\r\n\r\n```\r\n$ ./pre-commit/venv_cygwin_python/bin/pre-commit clean\r\nAn error has occurred: FatalError: git failed. Is it installed, and are you in a Git repository directory?\r\nCheck the log at ~/.pre-commit/pre-commit.log\r\n```\r\n\r\nCurrent master:\r\n\r\n```\r\n$ ./pre-commit/venv_cygwin_python/bin/pre-commit clean\r\nAn unexpected error has occurred: CalledProcessError: Command: ('/usr/bin/git', 'rev-parse', '--show-toplevel')\r\nReturn code: 128\r\nExpected return code: 0\r\nOutput: (none)\r\nErrors:\r\n    fatal: Not a git repository (or any of the parent directories): .git\r\n\r\n\r\nCheck the log at ~/.pre-commit/pre-commit.log\r\n```", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/437/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/437/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/425", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/425/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/425/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/425/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/425", "id": 187513945, "node_id": "MDU6SXNzdWUxODc1MTM5NDU=", "number": 425, "title": "setup.cfg prevent pre-commit to install", "user": {"login": "wilfriedroset", "id": 12611310, "node_id": "MDQ6VXNlcjEyNjExMzEw", "avatar_url": "https://avatars.githubusercontent.com/u/12611310?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wilfriedroset", "html_url": "https://github.com/wilfriedroset", "followers_url": "https://api.github.com/users/wilfriedroset/followers", "following_url": "https://api.github.com/users/wilfriedroset/following{/other_user}", "gists_url": "https://api.github.com/users/wilfriedroset/gists{/gist_id}", "starred_url": "https://api.github.com/users/wilfriedroset/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wilfriedroset/subscriptions", "organizations_url": "https://api.github.com/users/wilfriedroset/orgs", "repos_url": "https://api.github.com/users/wilfriedroset/repos", "events_url": "https://api.github.com/users/wilfriedroset/events{/privacy}", "received_events_url": "https://api.github.com/users/wilfriedroset/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-11-05T18:22:22Z", "updated_at": "2016-11-07T21:21:29Z", "closed_at": "2016-11-07T19:58:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "For some reason I have a setup.cfg file in the root directory of my repo for my app where the parameter **install_scripts** is set to **/usr/sbin**. This prevent pre-commit to set up and crash.\r\nHere is a repro in a fresh git repository containing only **setup.cfg** file and **.pre-commit-config.yaml** (for the [install guide](http://pre-commit.com/#install)\r\n\r\n<pre>\r\n$ mkdir repro; cd repro\r\n$ git init\r\nD\u00e9p\u00f4t Git vide initialis\u00e9 dans /home/wilfried/repro/.git/\r\n$ pre-commit clean\r\nCleaned /home/wilfried/.pre-commit.\r\n$ pre-commit install\r\npre-commit installed at /home/wilfried/repro/.git/hooks/pre-commit\r\n$ cat setup.cfg \r\n[install]\r\ninstall_scripts=/usr/sbin\r\n$ cat .pre-commit-config.yaml \r\n-   repo: git://github.com/pre-commit/pre-commit-hooks\r\n    sha: v0.4.2\r\n    hooks:\r\n    -   id: trailing-whitespace\r\n</pre>\r\n\r\nNow, with those two files setup, I try to run a simple pre-commit run which try to initiate the virtualenv.\r\n<pre>\r\n$ pre-commit run --all-files\r\n[INFO] Initializing environment for git://github.com/pre-commit/pre-commit-hooks.\r\n[INFO] Installing environment for git://github.com/pre-commit/pre-commit-hooks.\r\n[INFO] Once installed this environment will be reused.\r\n[INFO] This may take a few minutes...\r\nAn unexpected error has occurred: CalledProcessError: Command: ('/usr/bin/python', '-m', 'virtualenv', '/home/wilfried/.pre-commit/repoaXLSIv/py_env-default', '-p', '/usr/bin/python2.7')\r\nReturn code: 1\r\nExpected return code: 0\r\nOutput: \r\n    New python executable in /home/wilfried/.pre-commit/repoaXLSIv/py_env-default/bin/python2.7\r\n    Also creating executable in /home/wilfried/.pre-commit/repoaXLSIv/py_env-default/bin/python\r\n    Installing setuptools, pip, wheel...\r\n      Complete output from command /home/wilfried/.pre-...efault/bin/python2.7 - setuptools pip wheel:\r\n    ...Installing setuptools, pip, wheel...done.\r\n    Running virtualenv with interpreter /usr/bin/python2.7\r\n    \r\nErrors: \r\n    Traceback (most recent call last):\r\n      File \"/usr/local/lib/python2.7/dist-packages/virtualenv.py\", line 2327, in <module>\r\n        main()\r\n      File \"/usr/local/lib/python2.7/dist-packages/virtualenv.py\", line 711, in main\r\n        symlink=options.symlink)\r\n      File \"/usr/local/lib/python2.7/dist-packages/virtualenv.py\", line 944, in create_environment\r\n        download=download,\r\n      File \"/usr/local/lib/python2.7/dist-packages/virtualenv.py\", line 900, in install_wheel\r\n        call_subprocess(cmd, show_stdout=False, extra_env=env, stdin=SCRIPT)\r\n      File \"/usr/local/lib/python2.7/dist-packages/virtualenv.py\", line 792, in call_subprocess\r\n        logger.notify('\\n'.join(all_output) + '\\n----------------------------------------')\r\n      File \"/usr/local/lib/python2.7/dist-packages/virtualenv.py\", line 199, in notify\r\n        self.log(self.NOTIFY, msg, *args, **kw)\r\n      File \"/usr/local/lib/python2.7/dist-packages/virtualenv.py\", line 231, in log\r\n        consumer.write(rendered+'\\n')\r\n    UnicodeEncodeError: 'ascii' codec can't encode character u'\\xe9' in position 2254: ordinal not in range(128)\r\n    \r\n\r\nCheck the log at ~/.pre-commit/pre-commit.log\r\n</pre>\r\n\r\nYou'll find the content on pre-commit.log on [pastebin](http://pastebin.com/Ls61EQDj).\r\n\r\nNow the if I comment out the install_scripts parameter, everything works fine\r\n\r\n<pre>\r\n$ cat setup.cfg \r\n[install]\r\n#install_scripts=/usr/sbin\r\n$ pre-commit clean\r\nCleaned /home/wilfried/.pre-commit.\r\n$ pre-commit run --all-files\r\n[INFO] Initializing environment for git://github.com/pre-commit/pre-commit-hooks.\r\n[INFO] Installing environment for git://github.com/pre-commit/pre-commit-hooks.\r\n[INFO] Once installed this environment will be reused.\r\n[INFO] This may take a few minutes...\r\nTrim Trailing Whitespace.............................(no files to check)Skipped\r\n</pre>\r\n\r\nI'm running on a linux mint 18, with python 2.7.12 and pre-commit 0.9.2\r\n<pre>\r\n$ python --version\r\nPython 2.7.12\r\n$ pre-commit --version\r\npre-commit 0.9.2\r\n</pre>\r\n\r\nLet my know if you need anything else.", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/425/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/425/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/419", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/419/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/419/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/419/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/419", "id": 184667446, "node_id": "MDU6SXNzdWUxODQ2Njc0NDY=", "number": 419, "title": "Not working on macOS Sierra?", "user": {"login": "amcgregor", "id": 76750, "node_id": "MDQ6VXNlcjc2NzUw", "avatar_url": "https://avatars.githubusercontent.com/u/76750?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amcgregor", "html_url": "https://github.com/amcgregor", "followers_url": "https://api.github.com/users/amcgregor/followers", "following_url": "https://api.github.com/users/amcgregor/following{/other_user}", "gists_url": "https://api.github.com/users/amcgregor/gists{/gist_id}", "starred_url": "https://api.github.com/users/amcgregor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amcgregor/subscriptions", "organizations_url": "https://api.github.com/users/amcgregor/orgs", "repos_url": "https://api.github.com/users/amcgregor/repos", "events_url": "https://api.github.com/users/amcgregor/events{/privacy}", "received_events_url": "https://api.github.com/users/amcgregor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 181544375, "node_id": "MDU6TGFiZWwxODE1NDQzNzU=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/osx", "name": "osx", "color": "006b75", "default": false, "description": null}, {"id": 352543100, "node_id": "MDU6TGFiZWwzNTI1NDMxMDA=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/python", "name": "python", "color": "3776ab", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2016-10-23T02:34:34Z", "updated_at": "2016-10-25T20:54:08Z", "closed_at": "2016-10-24T00:00:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "Attempting to utilize a collection of hooks from the default repo, I get the following:\n\n```\nAn unexpected error has occurred: CalledProcessError: Command: ('/Users/amcgregor/Projects/marrow/.venv/bin/python3', '-m', 'virtualenv', '/Users/amcgregor/.pre-commit/repofu57ylaa/py_env-default')\nReturn code: 100\nExpected return code: 0\nOutput: \n    Using base prefix '/usr/local/bin/../../../Library/Frameworks/Python.framework/Versions/3.5'\n    New python executable in /Users/amcgregor/.pre-commit/repofu57ylaa/py_env-default/bin/python3\n    Also creating executable in /Users/amcgregor/.pre-commit/repofu57ylaa/py_env-default/bin/python\n    ERROR: The executable /Users/amcgregor/.pre-commit/repofu57ylaa/py_env-default/bin/python3 is not functioning\n    ERROR: It thinks sys.prefix is '/Library/Frameworks/Python.framework/Versions/3.5' (should be '/Users/amcgregor/.pre-commit/repofu57ylaa/py_env-default')\n    ERROR: virtualenv is not compatible with this system or executable\n\nErrors: (none)\n\nTraceback (most recent call last):\n  File \"/Users/amcgregor/Projects/marrow/.venv/lib/python3.5/site-packages/pre_commit/error_handler.py\", line 47, in error_handler\n    yield\n  File \"/Users/amcgregor/Projects/marrow/.venv/lib/python3.5/site-packages/pre_commit/main.py\", line 157, in main\n    return run(runner, args)\n  File \"/Users/amcgregor/Projects/marrow/.venv/lib/python3.5/site-packages/pre_commit/commands/run.py\", line 212, in run\n    return _run_hooks(repo_hooks, args, write, environ)\n  File \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/contextlib.py\", line 77, in __exit__\n    self.gen.throw(type, value, traceback)\n  File \"/Users/amcgregor/Projects/marrow/.venv/lib/python3.5/site-packages/pre_commit/staged_files_only.py\", line 63, in staged_files_only\n    yield\n  File \"/Users/amcgregor/Projects/marrow/.venv/lib/python3.5/site-packages/pre_commit/commands/run.py\", line 195, in run\n    repo_hooks = list(get_repo_hooks(runner))\n  File \"/Users/amcgregor/Projects/marrow/.venv/lib/python3.5/site-packages/pre_commit/commands/run.py\", line 141, in get_repo_hooks\n    for repo in runner.repositories:\n  File \"/Users/amcgregor/Projects/marrow/.venv/lib/python3.5/site-packages/cached_property.py\", line 26, in __get__\n    value = obj.__dict__[self.func.__name__] = self.func(obj)\n  File \"/Users/amcgregor/Projects/marrow/.venv/lib/python3.5/site-packages/pre_commit/runner.py\", line 47, in repositories\n    repository.require_installed()\n  File \"/Users/amcgregor/Projects/marrow/.venv/lib/python3.5/site-packages/pre_commit/repository.py\", line 117, in require_installed\n    self.install()\n  File \"/Users/amcgregor/Projects/marrow/.venv/lib/python3.5/site-packages/pre_commit/repository.py\", line 187, in install\n    self.additional_dependencies[language_name][language_version],\n  File \"/Users/amcgregor/Projects/marrow/.venv/lib/python3.5/site-packages/pre_commit/languages/python.py\", line 78, in install_environment\n    ('pip', 'install', '.') + additional_dependencies,\n  File \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/contextlib.py\", line 77, in __exit__\n    self.gen.throw(type, value, traceback)\n  File \"/Users/amcgregor/Projects/marrow/.venv/lib/python3.5/site-packages/pre_commit/util.py\", line 58, in clean_path_on_failure\n    yield\n  File \"/Users/amcgregor/Projects/marrow/.venv/lib/python3.5/site-packages/pre_commit/languages/python.py\", line 74, in install_environment\n    repo_cmd_runner.run(venv_cmd)\n  File \"/Users/amcgregor/Projects/marrow/.venv/lib/python3.5/site-packages/pre_commit/prefixed_command_runner.py\", line 39, in run\n    return cmd_output(*replaced_cmd, __popen=self.__popen, **kwargs)\n  File \"/Users/amcgregor/Projects/marrow/.venv/lib/python3.5/site-packages/pre_commit/util.py\", line 189, in cmd_output\n    returncode, cmd, retcode, output=(stdout, stderr),\npre_commit.util.CalledProcessError: Command: ('/Users/amcgregor/Projects/marrow/.venv/bin/python3', '-m', 'virtualenv', '/Users/amcgregor/.pre-commit/repofu57ylaa/py_env-default')\nReturn code: 100\nExpected return code: 0\nOutput: \n    Using base prefix '/usr/local/bin/../../../Library/Frameworks/Python.framework/Versions/3.5'\n    New python executable in /Users/amcgregor/.pre-commit/repofu57ylaa/py_env-default/bin/python3\n    Also creating executable in /Users/amcgregor/.pre-commit/repofu57ylaa/py_env-default/bin/python\n    ERROR: The executable /Users/amcgregor/.pre-commit/repofu57ylaa/py_env-default/bin/python3 is not functioning\n    ERROR: It thinks sys.prefix is '/Library/Frameworks/Python.framework/Versions/3.5' (should be '/Users/amcgregor/.pre-commit/repofu57ylaa/py_env-default')\n    ERROR: virtualenv is not compatible with this system or executable\n\nErrors: (none)\n```\n\nUsing the Python.org-provided Python 3.5 installer package.  I'm already within a virtual environment at the point of execution.\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/419/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/419/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/418", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/418/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/418/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/418/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/418", "id": 184367570, "node_id": "MDU6SXNzdWUxODQzNjc1NzA=", "number": 418, "title": "Could not find valid gem __fake_gem", "user": {"login": "rayward", "id": 1217111, "node_id": "MDQ6VXNlcjEyMTcxMTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1217111?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rayward", "html_url": "https://github.com/rayward", "followers_url": "https://api.github.com/users/rayward/followers", "following_url": "https://api.github.com/users/rayward/following{/other_user}", "gists_url": "https://api.github.com/users/rayward/gists{/gist_id}", "starred_url": "https://api.github.com/users/rayward/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rayward/subscriptions", "organizations_url": "https://api.github.com/users/rayward/orgs", "repos_url": "https://api.github.com/users/rayward/repos", "events_url": "https://api.github.com/users/rayward/events{/privacy}", "received_events_url": "https://api.github.com/users/rayward/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 352542360, "node_id": "MDU6TGFiZWwzNTI1NDIzNjA=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/ruby", "name": "ruby", "color": "cc342d", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 19, "created_at": "2016-10-20T23:44:47Z", "updated_at": "2016-11-08T00:53:10Z", "closed_at": "2016-11-08T00:31:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm having trouble getting the hooks installed on OSX:\n\n```\n[INFO] Installing environment for https://github.com/chriskuehl/puppet-pre-commit-hooks.git.\n[INFO] Once installed this environment will be reused.\n[INFO] This may take a few minutes...\nAn unexpected error has occurred: CalledProcessError: Command: (u'/bin/bash', u'/Users/ray.ward/.rbenv/shims/gem', 'install', '--no-ri', '--no-rdoc', '__fake_gem-0.gem')\nReturn code: 2\nExpected return code: 0\nOutput: (none)\nErrors:\n    ERROR:  Could not find a valid gem '__fake_gem-0.gem' (>= 0) in any repository\n    ERROR:  Possible alternatives: fake_gem, fake-gem, fake_gem_push\n\n\nCheck the log at ~/.pre-commit/pre-commit.log\n$ ruby -v\nruby 2.1.6p336 (2015-04-13 revision 50298) [x86_64-darwin14.0]\n$ gem -v\n2.2.3\n$ pre-commit -V\npre-commit 0.9.1\n$ uname -a\nDarwin SYD-MBP-WARD 15.6.0 Darwin Kernel Version 15.6.0: Mon Aug 29 20:21:34 PDT 2016; root:xnu-3248.60.11~1/RELEASE_X86_64 x86_64\n```\n\nany ideas?\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/418/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/418/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/397", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/397/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/397/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/397/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/397", "id": 171393155, "node_id": "MDU6SXNzdWUxNzEzOTMxNTU=", "number": 397, "title": "Stashed changes lost if hook fails with non-UTF-8 diff containing trailing whitespace", "user": {"login": "Lucas-C", "id": 925560, "node_id": "MDQ6VXNlcjkyNTU2MA==", "avatar_url": "https://avatars.githubusercontent.com/u/925560?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lucas-C", "html_url": "https://github.com/Lucas-C", "followers_url": "https://api.github.com/users/Lucas-C/followers", "following_url": "https://api.github.com/users/Lucas-C/following{/other_user}", "gists_url": "https://api.github.com/users/Lucas-C/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lucas-C/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lucas-C/subscriptions", "organizations_url": "https://api.github.com/users/Lucas-C/orgs", "repos_url": "https://api.github.com/users/Lucas-C/repos", "events_url": "https://api.github.com/users/Lucas-C/events{/privacy}", "received_events_url": "https://api.github.com/users/Lucas-C/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-08-16T12:14:59Z", "updated_at": "2016-08-18T15:29:16Z", "closed_at": "2016-08-18T15:29:16Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi,\n\nA colleague almost lost all the changes she was working on after launching a `git commit` (with zero file added) and `pre-commit` crashing without restoring its [patch](https://github.com/pre-commit/pre-commit/blob/master/pre_commit/staged_files_only.py#L15).\n\nHere is the terminal message she got:\n\n```\n[WARNING] Stashed changes conflicted with hook auto-fixes... Rolling back fixes...\nAn unexpected error has occurred: CalledProcessError: Command: ['git', 'apply', 'C:\\\\Users\\\\toto\\\\.pre-commit\\\\patch1471341002']\n```\n\nThis seems very similar to a past solved issue:\nhttps://github.com/pre-commit/pre-commit/issues/176\n\nI think it had to do with CRLF conversion.\nI'm going to try to reproduce this.\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/397/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/397/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/379", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/379/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/379/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/379/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/379", "id": 159909235, "node_id": "MDU6SXNzdWUxNTk5MDkyMzU=", "number": 379, "title": "pre-commit bug when invoking eslint via npm", "user": {"login": "Lucas-C", "id": 925560, "node_id": "MDQ6VXNlcjkyNTU2MA==", "avatar_url": "https://avatars.githubusercontent.com/u/925560?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lucas-C", "html_url": "https://github.com/Lucas-C", "followers_url": "https://api.github.com/users/Lucas-C/followers", "following_url": "https://api.github.com/users/Lucas-C/following{/other_user}", "gists_url": "https://api.github.com/users/Lucas-C/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lucas-C/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lucas-C/subscriptions", "organizations_url": "https://api.github.com/users/Lucas-C/orgs", "repos_url": "https://api.github.com/users/Lucas-C/repos", "events_url": "https://api.github.com/users/Lucas-C/events{/privacy}", "received_events_url": "https://api.github.com/users/Lucas-C/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 181543993, "node_id": "MDU6TGFiZWwxODE1NDM5OTM=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/windows", "name": "windows", "color": "5319e7", "default": false, "description": null}, {"id": 352543934, "node_id": "MDU6TGFiZWwzNTI1NDM5MzQ=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/javascript", "name": "javascript", "color": "f0db4f", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2016-06-13T09:36:24Z", "updated_at": "2016-06-27T13:53:25Z", "closed_at": "2016-06-27T10:35:04Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Bug reproduction:\n\n``` shell\nmkdir tmp && cd tmp\ngit init && pre-commit install\ncat <<EOF >.pre-commit-config.yaml\n-   repo: local\n    hooks:\n    -   id: validate-js\n        name: validate-js\n        language: system\n        entry: sh -c 'npm run validate-js'\n        files: .js$\nEOF\ncat <<EOF >package.json\n{\n  \"devDependencies\": {\n    \"eslint\": \"2.2.0\"\n  },\n  \"scripts\": {\n    \"validate-js\": \"eslint broken.js\"\n  }\n}\nEOF\necho 'foo {' >broken.js\ngit add .pre-commit-config.yaml package.json broken.js\nnpm install && pre-commit run\n```\n\nThe execution then hangs.\nThere is the stacktrace following a `CTRL+C` :\n\n```\nTraceback (most recent call last):\n  File \"/home/lucas_cimon/.local/share/virtualenvs/pre-commit-bug/bin/pre-commit\", line 11, in <module>\n    sys.exit(main())\n  File \"/home/lucas_cimon/.local/share/virtualenvs/pre-commit-bug/lib/python3.4/site-packages/pre_commit/main.py\", line 157, in main\n    return run(runner, args)\n  File \"/home/lucas_cimon/.local/share/virtualenvs/pre-commit-bug/lib/python3.4/site-packages/pre_commit/commands/run.py\", line 212, in run\n    return _run_hooks(repo_hooks, args, write, environ)\n  File \"/home/lucas_cimon/.local/share/virtualenvs/pre-commit-bug/lib/python3.4/site-packages/pre_commit/commands/run.py\", line 136, in _run_hooks\n    retval |= _run_single_hook(hook, repo, args, write, skips)\n  File \"/home/lucas_cimon/.local/share/virtualenvs/pre-commit-bug/lib/python3.4/site-packages/pre_commit/commands/run.py\", line 89, in _run_single_hook\n    retcode, stdout, stderr = repo.run_hook(hook, tuple(filenames))\n  File \"/home/lucas_cimon/.local/share/virtualenvs/pre-commit-bug/lib/python3.4/site-packages/pre_commit/repository.py\", line 199, in run_hook\n    self.cmd_runner, hook, file_args,\n  File \"/home/lucas_cimon/.local/share/virtualenvs/pre-commit-bug/lib/python3.4/site-packages/pre_commit/languages/system.py\", line 23, in run_hook\n    tuple(shlex.split(hook['entry'])) + tuple(hook['args']), file_args,\n  File \"/home/lucas_cimon/.local/share/virtualenvs/pre-commit-bug/lib/python3.4/site-packages/pre_commit/xargs.py\", line 58, in xargs\n    *run_cmd, encoding=None, retcode=None\n  File \"/home/lucas_cimon/.local/share/virtualenvs/pre-commit-bug/lib/python3.4/site-packages/pre_commit/util.py\", line 194, in cmd_output\n    stdout, stderr = proc.communicate()\n  File \"/usr/lib/python3.4/subprocess.py\", line 960, in communicate\n    stdout, stderr = self._communicate(input, endtime, timeout)\n  File \"/usr/lib/python3.4/subprocess.py\", line 1617, in _communicate\n    ready = selector.select(timeout)\n  File \"/usr/lib/python3.4/selectors.py\", line 367, in select\n    fd_event_list = self._poll.poll(timeout)\nKeyboardInterrupt\n```\n\nI'm using `pre-commit` version `0.8.2`.\n\nI found out a fix: adding `shell=True` to `popen_kwargs` in [`util.py:cmd_output`](https://github.com/pre-commit/pre-commit/blob/master/pre_commit/util.py#L190).\n\nNow I can submit a pull request, but the question is :\n- should we let the user configure \"manually\" a `system` hook with `shell=True` in `.pre-commit-config.yaml` (this is my preference, but this is a quite obscure setting option we should document clearly)\n- should `util.py:cmd_output` detect automagically that we are using a shell and set this flag itself (a bit dodgy maybe)\n- should we add a new type of \"shell\" hook, very similar to \"system\" with only this little difference (IMHO: probably overkill and a lotta more code to add)\n\nWhat do you think ?\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/379/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/379/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/374", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/374/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/374/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/374/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/374", "id": 156631943, "node_id": "MDU6SXNzdWUxNTY2MzE5NDM=", "number": 374, "title": "Newly gitignored (but file still exists) files are linted", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2016-05-24T23:29:01Z", "updated_at": "2016-05-25T16:32:03Z", "closed_at": "2016-05-25T16:32:03Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "(they should not be)\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/374/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/374/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/371", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/371/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/371/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/371/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/371", "id": 156039896, "node_id": "MDU6SXNzdWUxNTYwMzk4OTY=", "number": 371, "title": "Not-found executable crashes framework", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-05-20T19:58:18Z", "updated_at": "2016-05-20T22:03:53Z", "closed_at": "2016-05-20T22:03:53Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This was introduced with the new exe logic in 0.8.0\n\nHere's a simple reproduction:\n\n``` yaml\n- repo: local\n  hooks:\n  - id: test\n    name: test\n    language: system\n    entry: i-dont-exist-lol\n    files: '\\.py$'\n```\n\n```\n$ pre-commit run --all-files\ntest.....................................................................An unexpected error has occurred: OSError: Executable i-dont-exist-lol not found\nCheck the log at ~/.pre-commit/pre-commit.log\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/371/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/371/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/369", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/369/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/369/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/369/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/369", "id": 155118205, "node_id": "MDU6SXNzdWUxNTUxMTgyMDU=", "number": 369, "title": "Ruby hooks failing with rbenv installed", "user": {"login": "chriswgerber", "id": 5061057, "node_id": "MDQ6VXNlcjUwNjEwNTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5061057?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chriswgerber", "html_url": "https://github.com/chriswgerber", "followers_url": "https://api.github.com/users/chriswgerber/followers", "following_url": "https://api.github.com/users/chriswgerber/following{/other_user}", "gists_url": "https://api.github.com/users/chriswgerber/gists{/gist_id}", "starred_url": "https://api.github.com/users/chriswgerber/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chriswgerber/subscriptions", "organizations_url": "https://api.github.com/users/chriswgerber/orgs", "repos_url": "https://api.github.com/users/chriswgerber/repos", "events_url": "https://api.github.com/users/chriswgerber/events{/privacy}", "received_events_url": "https://api.github.com/users/chriswgerber/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 352542360, "node_id": "MDU6TGFiZWwzNTI1NDIzNjA=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/ruby", "name": "ruby", "color": "cc342d", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2016-05-16T20:47:25Z", "updated_at": "2016-05-17T16:19:30Z", "closed_at": "2016-05-17T16:15:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "Pre-commit has been failing for the past few weeks.\n\nhttps://gist.github.com/ThatGerber/d6533155848076b25e5e0d5cb02e20eb\n\nSeems to be an issue with the ruby (rbenv) environment.\n\nTried running `pre-commit clean && pre-commit` but it returns the same issue. Setting `rbenv global 2.2.4` and `rbenv shell 2.2.4` does help either.\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/369/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/369/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/363", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/363/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/363/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/363/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/363", "id": 148195442, "node_id": "MDU6SXNzdWUxNDgxOTU0NDI=", "number": 363, "title": "Creating repositories fails in parallel", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-04-13T22:00:39Z", "updated_at": "2017-08-24T04:38:04Z", "closed_at": "2017-08-24T04:38:04Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Each process races to set up its virtualenv in the same place.\n\nProbably needs more flock -- but how to make it work cross platform?\n\n@chriskuehl  hits this a lot.\n@ymilki just hit this as well\n\nWorkaround is to run once not-in-parallel and then it'll _just work_\n\nStacktraces vary, some complain of directories already existing `An unexpected error has occurred: OSError: [Errno 39] Directory not empty: '.../.pre-commit/repop35TZY/py_env-default'`\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/363/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/363/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/360", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/360/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/360/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/360/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/360", "id": 145361725, "node_id": "MDU6SXNzdWUxNDUzNjE3MjU=", "number": 360, "title": "Issues with running under another virtualenv + fish shell and a workaround", "user": {"login": "ustun", "id": 94374, "node_id": "MDQ6VXNlcjk0Mzc0", "avatar_url": "https://avatars.githubusercontent.com/u/94374?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ustun", "html_url": "https://github.com/ustun", "followers_url": "https://api.github.com/users/ustun/followers", "following_url": "https://api.github.com/users/ustun/following{/other_user}", "gists_url": "https://api.github.com/users/ustun/gists{/gist_id}", "starred_url": "https://api.github.com/users/ustun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ustun/subscriptions", "organizations_url": "https://api.github.com/users/ustun/orgs", "repos_url": "https://api.github.com/users/ustun/repos", "events_url": "https://api.github.com/users/ustun/events{/privacy}", "received_events_url": "https://api.github.com/users/ustun/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2016-04-02T10:52:38Z", "updated_at": "2016-04-12T04:57:35Z", "closed_at": "2016-04-11T21:04:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am using fish shell + project virtualenv.\n\nWhenever I activate my project's virtualenv, running pre-commit would fail, with strange errors like `basename: command not found'.\n\n`sh\n/Users/ustun/.pre-commit/repoUMoyOJ/py_env-default/bin/activate: line 61: basename: command not found\nbash: xargs: command not found\n`\n\nHowever, after deactivating the virtualenv, pre-commit would run properly.\n\nIt turns out one of the reasons is the usage of `bash -c`.\n\nfish sets path as space delimited values: /usr/bin /usr/local/bin as opposed to /usr/bin:/usr/local/bin.\n\nWhen we run bash -c 'echo $PATH' for example, it still receives the $PATH of fish, not $bash.\n\nI went ahead and replaced in my local pre-commit scripts everything that refers to bash with fish, and changes &&'s to ;\n\nThis fixed it for me. Just documenting in case it helps another person.\n\nI'm still not sure why deactivating the project virtualenv helped, I guess there's some incompatibility by running activate.fish (fish specific script for venv) and then activate (bash specific script for venv).\n\nI also tried bash -l -c to get a clean bash environment, but that didn't help.\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/360/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/360/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/357", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/357/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/357/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/357/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/357", "id": 142544799, "node_id": "MDU6SXNzdWUxNDI1NDQ3OTk=", "number": 357, "title": "nodeenvs currently flakey with `npm ERR! cb() never called!`", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-03-22T04:22:47Z", "updated_at": "2016-04-03T22:36:28Z", "closed_at": "2016-04-03T22:36:27Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\nCalledProcessError: Command: ['npm', 'install', '-g', '.', 'lodash']\nReturn code: 1\nExpected return code: 0\nOutput: (none)\nErrors: \n    npm ERR! cb() never called!\n```\n\nSeems to be related to these:\n- https://github.com/npm/npm/issues/11976\n- https://github.com/npm/npm/issues/11378\n\nRetrying seems to make it succeed (eventually) -- I imagine pinning an older version of nodejs will also fix this\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/357/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/357/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/353", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/353/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/353/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/353/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/353", "id": 142122593, "node_id": "MDU6SXNzdWUxNDIxMjI1OTM=", "number": 353, "title": "Support cygwin on windows", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 181543993, "node_id": "MDU6TGFiZWwxODE1NDM5OTM=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/windows", "name": "windows", "color": "5319e7", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-03-20T02:37:52Z", "updated_at": "2016-03-20T03:25:24Z", "closed_at": "2016-03-20T03:25:24Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Continuing from #352, here's an additional issue that I'm running into on my machine  (though I'm using a pretty old cygwin):\n\n```\n$ pre-commit run\nAn unexpected error has occurred: WindowsError: [Error 3] The system cannot find the path specified: u'/tmp/foo'\nCheck the log at ~/.pre-commit/pre-commit.log\n$ cat ~/.pre-commit/pre-commit.log\nAn unexpected error has occurred: WindowsError: [Error 3] The system cannot find the path specified: u'/tmp/foo'\nTraceback (most recent call last):\n  File \"d:\\tools\\cygwin64\\tmp\\venv\\lib\\site-packages\\pre_commit\\error_handler.py\", line 47, in error_handler\n    yield\n  File \"d:\\tools\\cygwin64\\tmp\\venv\\lib\\site-packages\\pre_commit\\main.py\", line 133, in main\n    runner = Runner.create()\n  File \"d:\\tools\\cygwin64\\tmp\\venv\\lib\\site-packages\\pre_commit\\runner.py\", line 30, in create\n    os.chdir(root)\nWindowsError: [Error 3] The system cannot find the path specified: u'/tmp/foo'\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/353/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/353/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/334", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/334/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/334/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/334/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/334", "id": 127587503, "node_id": "MDU6SXNzdWUxMjc1ODc1MDM=", "number": 334, "title": "Latest virtualenv breaks pre-commit", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-01-20T02:01:47Z", "updated_at": "2016-01-21T17:52:54Z", "closed_at": "2016-01-20T02:34:20Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "See also #299 \n\nFailure looks like:\n\n```\n17:00:19 hookid: sort-simple-yaml\n17:00:19 \n17:00:19 bash: /nail/home/push/.pre-commit/reposkzFrD//tmp/tmp.cEk6TCoZOS/srv-configs/py_env-default/bin/activate: No such file or directory\n```\n\n```\n$ pip install virtualenv --upgrade\nDownloading/unpacking virtualenv\n  Downloading virtualenv-14.0.0-py2.py3-none-any.whl (1.8MB): 1.8MB downloaded\nInstalling collected packages: virtualenv\nSuccessfully installed virtualenv\nCleaning up...\n$ python\nPython 2.6.7 (r267:88850, Dec  2 2011, 20:27:26) \n[GCC 4.4.3] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import virtualenv\n>>> virtualenv.path_locations('foo')\n('/nail/home/asottile/foo', '/nail/home/asottile/foo/lib/python2.6', '/nail/home/asottile/foo/include/python2.6', '/nail/home/asottile/foo/bin')\n>>> \n$ pip install virtualenv==1.11.5\nDownloading/unpacking virtualenv==1.11.5\n  Downloading virtualenv-1.11.5.tar.gz (1.8MB): 1.8MB downloaded\n  Running setup.py (path:/nail/home/asottile/venv/build/virtualenv/setup.py) egg_info for package virtualenv\n    warning: no previously-included files matching '*' found under directory 'docs/_templates'\n    warning: no previously-included files matching '*' found under directory 'docs/_build'\nInstalling collected packages: virtualenv\n  Found existing installation: virtualenv 14.0.0\n    Uninstalling virtualenv:\n      Successfully uninstalled virtualenv\n  Running setup.py install for virtualenv\n    warning: no previously-included files matching '*' found under directory 'docs/_templates'\n    warning: no previously-included files matching '*' found under directory 'docs/_build'\n    Installing virtualenv script to /nail/home/asottile/venv/bin\n    Installing virtualenv-2.6 script to /nail/home/asottile/venv/bin\nSuccessfully installed virtualenv\nCleaning up...\n$ python\nPython 2.6.7 (r267:88850, Dec  2 2011, 20:27:26) \n[GCC 4.4.3] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import virtualenv\n>>> virtualenv.path_locations('foo')\n('foo', 'foo/lib/python2.6', 'foo/include/python2.6', 'foo/bin')\n>>>\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/334/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/334/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/330", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/330/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/330/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/330/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/330", "id": 126153355, "node_id": "MDU6SXNzdWUxMjYxNTMzNTU=", "number": 330, "title": "Error with Git bash when installing Python environment: UnicodeDecodeError: 'utf8' codec can't decode byte 0x82 in position 928: invalid start byte", "user": {"login": "Lucas-C", "id": 925560, "node_id": "MDQ6VXNlcjkyNTU2MA==", "avatar_url": "https://avatars.githubusercontent.com/u/925560?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lucas-C", "html_url": "https://github.com/Lucas-C", "followers_url": "https://api.github.com/users/Lucas-C/followers", "following_url": "https://api.github.com/users/Lucas-C/following{/other_user}", "gists_url": "https://api.github.com/users/Lucas-C/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lucas-C/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lucas-C/subscriptions", "organizations_url": "https://api.github.com/users/Lucas-C/orgs", "repos_url": "https://api.github.com/users/Lucas-C/repos", "events_url": "https://api.github.com/users/Lucas-C/events{/privacy}", "received_events_url": "https://api.github.com/users/Lucas-C/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2016-01-12T10:58:20Z", "updated_at": "2016-01-13T07:16:55Z", "closed_at": "2016-01-13T00:06:32Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "```\n$ git commit -m \"Initial commit\"\n[INFO] Initializing environment for git://github.com/pre-commit/pre-commit-hooks.\n[INFO] Installing environment for git://github.com/pre-commit/pre-commit-hooks.\n[INFO] Once installed this environment will be reused.\n[INFO] This may take a few minutes...\n[INFO] Initializing environment for git://github.com/Lucas-C/pre-commit-hooks.\n[INFO] Installing environment for git://github.com/Lucas-C/pre-commit-hooks.\n[INFO] Once installed this environment will be reused.\n[INFO] This may take a few minutes...\nAn unexpected error has occurred: UnicodeDecodeError: 'utf8' codec can't decode byte 0x82 in position 928: invalid start byte\nCheck the log at ~/.pre-commit/pre-commit.log\n\n$ cat ~/.pre-commit/pre-commit.log\nAn unexpected error has occurred: UnicodeDecodeError: 'utf8' codec can't decode byte 0x82 in position 928: invalid start byte\nTraceback (most recent call last):\n  File \"c:\\devhome\\tools\\Python27\\lib\\site-packages\\pre_commit\\error_handler.py\", line 36, in error_handler\n    yield\n  File \"c:\\devhome\\tools\\Python27\\lib\\site-packages\\pre_commit\\main.py\", line 147, in main\n    return run(runner, args)\n  File \"c:\\devhome\\tools\\Python27\\lib\\site-packages\\pre_commit\\commands\\run.py\", line 195, in run\n    repo_hooks = list(get_repo_hooks(runner))\n  File \"c:\\devhome\\tools\\Python27\\lib\\site-packages\\pre_commit\\commands\\run.py\", line 141, in get_repo_hooks\n    for repo in runner.repositories:\n  File \"c:\\devhome\\tools\\Python27\\lib\\site-packages\\cached_property.py\", line 26, in __get__\n    value = obj.__dict__[self.func.__name__] = self.func(obj)\n  File \"c:\\devhome\\tools\\Python27\\lib\\site-packages\\pre_commit\\runner.py\", line 47, in repositories\n    repository.require_installed()\n  File \"c:\\devhome\\tools\\Python27\\lib\\site-packages\\pre_commit\\repository.py\", line 115, in require_installed\n    self.install()\n  File \"c:\\devhome\\tools\\Python27\\lib\\site-packages\\pre_commit\\repository.py\", line 185, in install\n    self.additional_dependencies[language_name][language_version],\n  File \"c:\\devhome\\tools\\Python27\\lib\\site-packages\\pre_commit\\languages\\python.py\", line 66, in install_environment\n    env.run(\"cd '{prefix}' && pip install .\")\n  File \"c:\\devhome\\tools\\Python27\\lib\\site-packages\\pre_commit\\languages\\helpers.py\", line 51, in run\n    ['bash', '-c', ' '.join([self.env_prefix, cmd])], **kwargs\n  File \"c:\\devhome\\tools\\Python27\\lib\\site-packages\\pre_commit\\prefixed_command_runner.py\", line 39, in run\n    return cmd_output(*replaced_cmd, __popen=self.__popen, **kwargs)\n  File \"c:\\devhome\\tools\\Python27\\lib\\site-packages\\pre_commit\\util.py\", line 175, in cmd_output\n    stdout = stdout.decode(encoding)\n  File \"c:\\devhome\\tools\\Python27\\lib\\encodings\\utf_8.py\", line 16, in decode\n    return codecs.utf_8_decode(input, errors, True)\nUnicodeDecodeError: 'utf8' codec can't decode byte 0x82 in position 928: invalid start byte\n```\n\nI reproduced the internal system calls mad by `pre-commit` here:\n\n```\n$ c:\\\\devhome\\\\tools\\\\Python27\\\\python.exe -m virtualenv d:/Users/lucas_cimon\\\\.pre-commit\\\\repozp6fda\\\\py_env-default\nNew python executable in d:/Users/lucas_cimon\\.pre-commit\\repozp6fda\\py_env-default\\Scripts\\python.exe\nInstalling setuptools, pip, wheel...done.\n\n$ bash -c \". 'd:/Users/lucas_cimon\\\\.pre-commit\\\\repozp6fda\\\\py_env-default\\\\Scripts\\\\activate' && cd 'd:/Users/lucas_cimon\\\\.pre-commit\\\\repozp6fda\\\\' && pip install .\"\nProcessing d:\\users\\lucas_cimon\\.pre-commit\\repozp6fda\nCollecting lxml (from pre-commit-hooks==0.0.1)\n  Using cached lxml-3.5.0.tar.gz\nCollecting tinycss2 (from pre-commit-hooks==0.0.1)\nCollecting webencodings>=0.4 (from tinycss2->pre-commit-hooks==0.0.1)\nBuilding wheels for collected packages: lxml\n  Running setup.py bdist_wheel for lxml\n  Complete output from command d:\\users\\lucas_cimon\\.pre-commit\\repozp6fda\\py_env-default\\scripts\\python.exe -c \"import setuptools;__file__='c:\\\\temp\\\\pip-build-vjp3v8\\\\lxml\\\\setup.py';exec(compile(open(__file__).read().replace('\\r\\n', '\\n'), __file__, 'exec'))\" bdist_wheel -d c:\\temp\\tmpnpxj1bpip-wheel-:\n  Building lxml version 3.5.0.\n  Building without Cython.\n  ERROR: 'xslt-config' n'est pas reconnu en tant que commande interne\n  ou externe, un programme ex\u00e9cutable ou un fichier de commandes.\n\n  ** make sure the development packages of libxml2 and libxslt are installed **\n\n  Using build configuration of libxslt\n  running bdist_wheel\n  running build\n  running build_py\n  creating build\n  creating build\\lib.win-amd64-2.7\n  creating build\\lib.win-amd64-2.7\\lxml\n  copying src\\lxml\\builder.py -> build\\lib.win-amd64-2.7\\lxml\n  copying src\\lxml\\cssselect.py -> build\\lib.win-amd64-2.7\\lxml\n  copying src\\lxml\\doctestcompare.py -> build\\lib.win-amd64-2.7\\lxml\n  copying src\\lxml\\ElementInclude.py -> build\\lib.win-amd64-2.7\\lxml\n  copying src\\lxml\\pyclasslookup.py -> build\\lib.win-amd64-2.7\\lxml\n  copying src\\lxml\\sax.py -> build\\lib.win-amd64-2.7\\lxml\n  copying src\\lxml\\usedoctest.py -> build\\lib.win-amd64-2.7\\lxml\n  copying src\\lxml\\_elementpath.py -> build\\lib.win-amd64-2.7\\lxml\n  copying src\\lxml\\__init__.py -> build\\lib.win-amd64-2.7\\lxml\n  creating build\\lib.win-amd64-2.7\\lxml\\includes\n  copying src\\lxml\\includes\\__init__.py -> build\\lib.win-amd64-2.7\\lxml\\includes\n\n  creating build\\lib.win-amd64-2.7\\lxml\\html\n  copying src\\lxml\\html\\builder.py -> build\\lib.win-amd64-2.7\\lxml\\html\n  copying src\\lxml\\html\\clean.py -> build\\lib.win-amd64-2.7\\lxml\\html\n  copying src\\lxml\\html\\defs.py -> build\\lib.win-amd64-2.7\\lxml\\html\n  copying src\\lxml\\html\\diff.py -> build\\lib.win-amd64-2.7\\lxml\\html\n  copying src\\lxml\\html\\ElementSoup.py -> build\\lib.win-amd64-2.7\\lxml\\html\n  copying src\\lxml\\html\\formfill.py -> build\\lib.win-amd64-2.7\\lxml\\html\n  copying src\\lxml\\html\\html5parser.py -> build\\lib.win-amd64-2.7\\lxml\\html\n  copying src\\lxml\\html\\soupparser.py -> build\\lib.win-amd64-2.7\\lxml\\html\n  copying src\\lxml\\html\\usedoctest.py -> build\\lib.win-amd64-2.7\\lxml\\html\n  copying src\\lxml\\html\\_diffcommand.py -> build\\lib.win-amd64-2.7\\lxml\\html\n  copying src\\lxml\\html\\_html5builder.py -> build\\lib.win-amd64-2.7\\lxml\\html\n  copying src\\lxml\\html\\_setmixin.py -> build\\lib.win-amd64-2.7\\lxml\\html\n  copying src\\lxml\\html\\__init__.py -> build\\lib.win-amd64-2.7\\lxml\\html\n  creating build\\lib.win-amd64-2.7\\lxml\\isoschematron\n  copying src\\lxml\\isoschematron\\__init__.py -> build\\lib.win-amd64-2.7\\lxml\\isoschematron\n  copying src\\lxml\\lxml.etree.h -> build\\lib.win-amd64-2.7\\lxml\n  copying src\\lxml\\lxml.etree_api.h -> build\\lib.win-amd64-2.7\\lxml\n  copying src\\lxml\\includes\\c14n.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n  copying src\\lxml\\includes\\config.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n  copying src\\lxml\\includes\\dtdvalid.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n  copying src\\lxml\\includes\\etreepublic.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n  copying src\\lxml\\includes\\htmlparser.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n  copying src\\lxml\\includes\\relaxng.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n\n  copying src\\lxml\\includes\\schematron.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n  copying src\\lxml\\includes\\tree.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n  copying src\\lxml\\includes\\uri.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n  copying src\\lxml\\includes\\xinclude.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n  copying src\\lxml\\includes\\xmlerror.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n  copying src\\lxml\\includes\\xmlparser.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n  copying src\\lxml\\includes\\xmlschema.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n  copying src\\lxml\\includes\\xpath.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n  copying src\\lxml\\includes\\xslt.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n  copying src\\lxml\\includes\\etree_defs.h -> build\\lib.win-amd64-2.7\\lxml\\includes\n  copying src\\lxml\\includes\\lxml-version.h -> build\\lib.win-amd64-2.7\\lxml\\includes\n  creating build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\n  creating build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\rng\n  copying src\\lxml\\isoschematron\\resources\\rng\\iso-schematron.rng -> build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\rng\n  creating build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\xsl\n  copying src\\lxml\\isoschematron\\resources\\xsl\\RNG2Schtrn.xsl -> build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\xsl\n  copying src\\lxml\\isoschematron\\resources\\xsl\\XSD2Schtrn.xsl -> build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\xsl\n  creating build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\n  copying src\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\\iso_abstract_expand.xsl -> build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\n  copying src\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\\iso_dsdl_include.xsl -> build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\n  copying src\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\\iso_schematron_message.xsl -> build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\n  copying src\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\\iso_schematron_skeleton_for_xslt1.xsl -> build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\n  copying src\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\\iso_svrl_for_xslt1.xsl -> build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\n  copying src\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\\readme.txt -> build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\n  running build_ext\n  building 'lxml.etree' extension\n  error: Microsoft Visual C++ 9.0 is required (Unable to find vcvarsall.bat). Get it from http://aka.ms/vcpython27\n\n  ----------------------------------------\n\u2190[31m  Failed building wheel for lxml\u2190[0m\nFailed to build lxml\nInstalling collected packages: lxml, webencodings, tinycss2, pre-commit-hooks\n  Running setup.py install for lxml\n    Complete output from command d:\\users\\lucas_cimon\\.pre-commit\\repozp6fda\\py_env-default\\scripts\\python.exe -c \"import setuptools, tokenize;__file__='c:\\\\temp\\\\pip-build-vjp3v8\\\\lxml\\\\setup.py';exec(compile(getattr(tokenize, 'open', open)(__file__).read().replace('\\r\\n', '\\n'), __file__, 'exec'))\" install --record c:\\temp\\pip-mkgjyg-record\\install-record.txt --single-version-externally-managed--compile --install-headers d:\\users\\lucas_cimon\\.pre-commit\\repozp6fda\\py_env-default\\include\\site\\python2.7\\lxml:\n    Building lxml version 3.5.0.\n    Building without Cython.\n    ERROR: 'xslt-config' n'est pas reconnu en tant que commande interne\n    ou externe, un programme ex\u00e9cutable ou un fichier de commandes.\n\n    ** make sure the development packages of libxml2 and libxslt are installed **\n\n    Using build configuration of libxslt\n    running install\n    running build\n    running build_py\n    copying src\\lxml\\builder.py -> build\\lib.win-amd64-2.7\\lxml\n    copying src\\lxml\\cssselect.py -> build\\lib.win-amd64-2.7\\lxml\n    copying src\\lxml\\doctestcompare.py -> build\\lib.win-amd64-2.7\\lxml\n    copying src\\lxml\\ElementInclude.py -> build\\lib.win-amd64-2.7\\lxml\n    copying src\\lxml\\pyclasslookup.py -> build\\lib.win-amd64-2.7\\lxml\n    copying src\\lxml\\sax.py -> build\\lib.win-amd64-2.7\\lxml\n    copying src\\lxml\\usedoctest.py -> build\\lib.win-amd64-2.7\\lxml\n    copying src\\lxml\\_elementpath.py -> build\\lib.win-amd64-2.7\\lxml\n    copying src\\lxml\\__init__.py -> build\\lib.win-amd64-2.7\\lxml\n    copying src\\lxml\\includes\\__init__.py -> build\\lib.win-amd64-2.7\\lxml\\includes\n    copying src\\lxml\\html\\builder.py -> build\\lib.win-amd64-2.7\\lxml\\html\n    copying src\\lxml\\html\\clean.py -> build\\lib.win-amd64-2.7\\lxml\\html\n    copying src\\lxml\\html\\defs.py -> build\\lib.win-amd64-2.7\\lxml\\html\n    copying src\\lxml\\html\\diff.py -> build\\lib.win-amd64-2.7\\lxml\\html\n    copying src\\lxml\\html\\ElementSoup.py -> build\\lib.win-amd64-2.7\\lxml\\html\n    copying src\\lxml\\html\\formfill.py -> build\\lib.win-amd64-2.7\\lxml\\html\n    copying src\\lxml\\html\\html5parser.py -> build\\lib.win-amd64-2.7\\lxml\\html\n    copying src\\lxml\\html\\soupparser.py -> build\\lib.win-amd64-2.7\\lxml\\html\n    copying src\\lxml\\html\\usedoctest.py -> build\\lib.win-amd64-2.7\\lxml\\html\n    copying src\\lxml\\html\\_diffcommand.py -> build\\lib.win-amd64-2.7\\lxml\\html\n    copying src\\lxml\\html\\_html5builder.py -> build\\lib.win-amd64-2.7\\lxml\\html\n    copying src\\lxml\\html\\_setmixin.py -> build\\lib.win-amd64-2.7\\lxml\\html\n    copying src\\lxml\\html\\__init__.py -> build\\lib.win-amd64-2.7\\lxml\\html\n    copying src\\lxml\\isoschematron\\__init__.py -> build\\lib.win-amd64-2.7\\lxml\\isoschematron\n    copying src\\lxml\\lxml.etree.h -> build\\lib.win-amd64-2.7\\lxml\n    copying src\\lxml\\lxml.etree_api.h -> build\\lib.win-amd64-2.7\\lxml\n    copying src\\lxml\\includes\\c14n.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n    copying src\\lxml\\includes\\config.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n    copying src\\lxml\\includes\\dtdvalid.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n    copying src\\lxml\\includes\\etreepublic.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n    copying src\\lxml\\includes\\htmlparser.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n    copying src\\lxml\\includes\\relaxng.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n    copying src\\lxml\\includes\\schematron.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n    copying src\\lxml\\includes\\tree.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n    copying src\\lxml\\includes\\uri.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n    copying src\\lxml\\includes\\xinclude.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n    copying src\\lxml\\includes\\xmlerror.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n    copying src\\lxml\\includes\\xmlparser.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n    copying src\\lxml\\includes\\xmlschema.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n    copying src\\lxml\\includes\\xpath.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n    copying src\\lxml\\includes\\xslt.pxd -> build\\lib.win-amd64-2.7\\lxml\\includes\n    copying src\\lxml\\includes\\etree_defs.h -> build\\lib.win-amd64-2.7\\lxml\\includes\n    copying src\\lxml\\includes\\lxml-version.h -> build\\lib.win-amd64-2.7\\lxml\\includes\n    copying src\\lxml\\isoschematron\\resources\\rng\\iso-schematron.rng -> build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\rng\n    copying src\\lxml\\isoschematron\\resources\\xsl\\RNG2Schtrn.xsl -> build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\xsl\n    copying src\\lxml\\isoschematron\\resources\\xsl\\XSD2Schtrn.xsl -> build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\xsl\n    copying src\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\\iso_abstract_expand.xsl -> build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\n    copying src\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\\iso_dsdl_include.xsl -> build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\n    copying src\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\\iso_schematron_message.xsl -> build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\n    copying src\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\\iso_schematron_skeleton_for_xslt1.xsl -> build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\n    copying src\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\\iso_svrl_for_xslt1.xsl -> build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\n    copying src\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\\readme.txt -> build\\lib.win-amd64-2.7\\lxml\\isoschematron\\resources\\xsl\\iso-schematron-xslt1\n    running build_ext\n    building 'lxml.etree' extension\n    error: Microsoft Visual C++ 9.0 is required (Unable to find vcvarsall.bat).\nGet it from http://aka.ms/vcpython27\n\n    ----------------------------------------\n\u2190[31mCommand \"d:\\users\\lucas_cimon\\.pre-commit\\repozp6fda\\py_env-default\\scripts\\python.exe -c \"import setuptools, tokenize;__file__='c:\\\\temp\\\\pip-build-vjp3v8\\\\lxml\\\\setup.py';exec(compile(getattr(tokenize, 'open', open)(__file__).read().replace('\\r\\n', '\\n'), __file__, 'exec'))\" install --record c:\\temp\\pip-mkgjyg-record\\install-record.txt --single-version-externally-managed --compile --install-headers d:\\users\\lucas_cimon\\.pre-commit\\repozp6fda\\py_env-default\\include\\site\\python2.7\\lxml\" failed with error code 1 in c:\\temp\\pip-build-vjp3v8\\lxml\u2190[0m\n```\n\nLeaving apart the fact that the last command fails, could it be possible to handle the encoding of this output under Git Bash (i.e. mysysgit) ?\n\nThere are the lines containing non ASCII characters:\n\n```\n18:  ou externe, un programme ex[m\u2592cutable ou un fichier de commandes.\n95:\u2190[31m  Failed building wheel for lxml[m\u2592\u2592[0m\n103:    ou externe, un programme ex[m\u2592cutable ou un fichier de commandes.\n169:\u2190[31mCommand \"d:\\users\\lucas_cimon\\.pre-commit\\repozp6fda\\py_env-default\\scripts\\python.exe -c \"import setuptools, tokenize;__file__='c:\\\\temp\\\\pip-build-vjp3v8\\\\lxml\\\\setup.py';exec(compile(getattr(tokenize, 'open', open)(__file__).read().replace('\\r\\n', '\\n'), __file__, 'exec'))\" install --record c:\\temp\\pip-mkgjyg-record\\install-record.txt --single-version-externally-managed --compile --install-headers d:\\users\\lucas_cimon\\.pre-commit\\repozp6fda\\py_env-default\\include\\site\\python2.7\\lxml\" failed with error code 1 in c:\\temp\\pip-build-vjp3v8\\lxml[m\u2592\u2592[0m\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/330/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/330/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/314", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/314/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/314/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/314/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/314", "id": 120677721, "node_id": "MDU6SXNzdWUxMjA2Nzc3MjE=", "number": 314, "title": ":args seems to break with {} in list.", "user": {"login": "marick", "id": 71909, "node_id": "MDQ6VXNlcjcxOTA5", "avatar_url": "https://avatars.githubusercontent.com/u/71909?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marick", "html_url": "https://github.com/marick", "followers_url": "https://api.github.com/users/marick/followers", "following_url": "https://api.github.com/users/marick/following{/other_user}", "gists_url": "https://api.github.com/users/marick/gists{/gist_id}", "starred_url": "https://api.github.com/users/marick/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marick/subscriptions", "organizations_url": "https://api.github.com/users/marick/orgs", "repos_url": "https://api.github.com/users/marick/repos", "events_url": "https://api.github.com/users/marick/events{/privacy}", "received_events_url": "https://api.github.com/users/marick/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2015-12-07T00:39:20Z", "updated_at": "2015-12-09T22:37:58Z", "closed_at": "2015-12-07T03:55:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am working on a repo with some hooks for my company: https://github.com/marick/pre-commit-hooks\n\nThere is a hook that works fine with this `.pre-commit-config.yaml`:\n\n``` yaml\n-   repo: /Users/marick/src/pre-commit-hooks\n    sha: d6dee96f56bf9290f7ebb852c4252c50b8f6215d\n    stages: [commit, push]\n    hooks:\n    -   id: prohibit-suspicious-patterns\n        args: [\"AKIA[[:alnum]]\", --]\n```\n\nHowever, it I change the first arg by adding `{1}`:\n\n``` yaml\n        args: [\"AKIA[[:alnum]]{1}\", --]\n```\n\n... I get this:\n\n```\nprohibit suspicious patterns..................................................................\nAn unexpected error has occurred: IndexError: tuple index out of range\nCheck the log at ~/.pre-commit/pre-commit.log\n```\n\nThe contents of `pre-commit.log`:\n\n```\nAn unexpected error has occurred: IndexError: tuple index out of range\nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/site-packages/pre_commit/error_handler.py\", line 36, in error_handler\n    yield\n  File \"/usr/local/lib/python2.7/site-packages/pre_commit/main.py\", line 150, in main\n    return run(runner, args)\n  File \"/usr/local/lib/python2.7/site-packages/pre_commit/commands/run.py\", line 212, in run\n    return _run_hooks(repo_hooks, args, write, environ)\n  File \"/usr/local/lib/python2.7/site-packages/pre_commit/commands/run.py\", line 136, in _run_hooks\n    retval |= _run_single_hook(hook, repo, args, write, skips)\n  File \"/usr/local/lib/python2.7/site-packages/pre_commit/commands/run.py\", line 89, in _run_single_hook\n    retcode, stdout, stderr = repo.run_hook(hook, filenames)\n  File \"/usr/local/lib/python2.7/site-packages/pre_commit/repository.py\", line 145, in run_hook\n    self.cmd_runner, hook, file_args,\n  File \"/usr/local/lib/python2.7/site-packages/pre_commit/languages/script.py\", line 23, in run_hook\n    encoding=None,\n  File \"/usr/local/lib/python2.7/site-packages/pre_commit/prefixed_command_runner.py\", line 40, in run\n    replaced_cmd = _replace_cmd(cmd, prefix=self.prefix_dir)\n  File \"/usr/local/lib/python2.7/site-packages/pre_commit/prefixed_command_runner.py\", line 11, in _replace_cmd\n    return [part.format(**kwargs) for part in cmd]\nIndexError: tuple index out of range\n\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/314/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/314/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/309", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/309/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/309/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/309/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/309", "id": 119744659, "node_id": "MDU6SXNzdWUxMTk3NDQ2NTk=", "number": 309, "title": "Non-ascii prints in error handler without tty cause stacktrace", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-12-01T15:47:54Z", "updated_at": "2015-12-01T22:16:53Z", "closed_at": "2015-12-01T22:16:53Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\n23:00:13 style runtests: commands[0] | pre-commit run --all-files\n23:00:13 [INFO] Installing environment for git@git.yelpcorp.com:mirrors/pre-commit/mirrors-jshint.\n23:00:13 [INFO] Once installed this environment will be reused.\n23:00:13 [INFO] This may take a few minutes...\n23:01:33 Traceback (most recent call last):\n23:01:33   File \".tox/style/bin/pre-commit\", line 11, in <module>\n23:01:33     sys.exit(main())\n23:01:33   File \".../.tox/style/local/lib/python2.7/site-packages/pre_commit/main.py\", line 157, in main\n23:01:33     'Command {0} failed to exit with a returncode'.format(args.command)\n23:01:33   File \"/usr/lib64/python2.7/contextlib.py\", line 35, in __exit__\n23:01:33     self.gen.throw(type, value, traceback)\n23:01:33   File \".../.tox/style/local/lib/python2.7/site-packages/pre_commit/error_handler.py\", line 41, in error_handler\n23:01:33     traceback.format_exc(),\n23:01:33   File \".../.tox/style/local/lib/python2.7/site-packages/pre_commit/error_handler.py\", line 21, in _log_and_exit\n23:01:33     print_fn(error_msg)\n23:01:33 UnicodeEncodeError: 'ascii' codec can't encode characters in position 735-737: ordinal not in range(128)\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/309/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/309/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/300", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/300/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/300/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/300/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/300", "id": 118505233, "node_id": "MDU6SXNzdWUxMTg1MDUyMzM=", "number": 300, "title": "Cloning repo inside pre-commit fails with latest git", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-11-24T00:27:11Z", "updated_at": "2015-11-24T00:40:59Z", "closed_at": "2015-11-24T00:40:59Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Seems to be a regression in git between 2.5 and 2.6 -- I can work around this however.\n\n```\n$ python -m pytest tests/commands/install_uninstall_test.py --maxfail 1 --pdb -k install_pre_commit_and_run --color=no\n============================= test session starts =============================\nplatform win32 -- Python 2.7.10, pytest-2.8.3, py-1.4.30, pluggy-0.3.1\nrootdir: C:\\Users\\IEUser\\Desktop\\pre-commit, inifile:\ncollected 27 items\n\ntests\\commands\\install_uninstall_test.py F\n>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> traceback >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\n\ntempdir_factory = <tests.conftest.TmpdirFactory object at 0x0266A590>\n\n    def test_install_pre_commit_and_run(tempdir_factory):\n        path = make_consuming_repo(tempdir_factory, 'script_hooks_repo')\n        with cwd(path):\n            assert install(Runner(path)) == 0\n\n            ret, output = _get_commit_output(tempdir_factory)\n>           assert ret == 0\nE           assert 1 == 0\n\ntests\\commands\\install_uninstall_test.py:163: AssertionError\n>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> entering PDB >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\n> c:\\users\\ieuser\\desktop\\pre-commit\\tests\\commands\\install_uninstall_test.py(163)test_install_pre_commit_and_run()\n-> assert ret == 0\n(Pdb) print(output)\n[INFO] Initializing environment for c:\\temp\\pytest-of-IEUser\\pytest-30\\test_install_pre_commit_and_ru0\\0.\nAn unexpected error has occurred: CalledProcessError: Command: ['git', 'clone', '--no-checkout', 'c:\\\\temp\\\\pytest-of-IEUser\\\\pytest-30\\\\test\n_install_pre_commit_and_ru0\\\\0', 'c:\\\\temp\\\\pytest-of-IEUser\\\\pytest-30\\\\test_install_pre_commit_and_ru0\\\\2\\\\repoe4kase']\nReturn code: 128\nExpected return code: 0\nOutput: (none)\nErrors:\n    fatal: working tree '.' already exists.\n\n\nCheck the log at ~/.pre-commit/pre-commit.log\n\n(Pdb) c\n\n\n!!!!!!!!!!!!!!!!!!! Interrupted: stopping after 1 failures !!!!!!!!!!!!!!!!!!!!\n============ 26 tests deselected by '-kinstall_pre_commit_and_run' ============\n=================== 1 failed, 26 deselected in 6.80 seconds ===================\n(venv-pre_commit)\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/300/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/300/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/299", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/299/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/299/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/299/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/299", "id": 118504972, "node_id": "MDU6SXNzdWUxMTg1MDQ5NzI=", "number": 299, "title": "Latest virtualenv writes virtualenv directory name to current working directory", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 181543993, "node_id": "MDU6TGFiZWwxODE1NDM5OTM=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/windows", "name": "windows", "color": "5319e7", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2015-11-24T00:25:01Z", "updated_at": "2016-01-20T02:34:20Z", "closed_at": "2016-01-20T02:34:20Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Seems to only happen on windows\n\nCan reproduce by running hooks.  The directories are empty (harmless?) but annoying.\n\nI'm considering just using\n\n``` python\ndirectory = 'Scripts' if os.name == 'nt' else 'bin'\n```\n\nto work around this\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/299/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/299/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/294", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/294/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/294/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/294/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/294", "id": 117649605, "node_id": "MDU6SXNzdWUxMTc2NDk2MDU=", "number": 294, "title": "Appveyor is broken :(", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-11-18T18:27:27Z", "updated_at": "2015-11-24T07:10:53Z", "closed_at": "2015-11-24T07:10:53Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Need to figure out what changed.  I don't really see anything sticking out :/\n\nPassing: https://ci.appveyor.com/project/asottile/pre-commit/build/1.0.267\n\nFailing: https://ci.appveyor.com/project/asottile/pre-commit/build/1.0.271\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/294/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/294/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/282", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/282/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/282/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/282/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/282", "id": 114690779, "node_id": "MDU6SXNzdWUxMTQ2OTA3Nzk=", "number": 282, "title": "Can't install node based hooks (jshint, jscs, eslint, etc.) with node 5.0.0", "user": {"login": "tdeo", "id": 6230277, "node_id": "MDQ6VXNlcjYyMzAyNzc=", "avatar_url": "https://avatars.githubusercontent.com/u/6230277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tdeo", "html_url": "https://github.com/tdeo", "followers_url": "https://api.github.com/users/tdeo/followers", "following_url": "https://api.github.com/users/tdeo/following{/other_user}", "gists_url": "https://api.github.com/users/tdeo/gists{/gist_id}", "starred_url": "https://api.github.com/users/tdeo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tdeo/subscriptions", "organizations_url": "https://api.github.com/users/tdeo/orgs", "repos_url": "https://api.github.com/users/tdeo/repos", "events_url": "https://api.github.com/users/tdeo/events{/privacy}", "received_events_url": "https://api.github.com/users/tdeo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2015-11-02T21:44:14Z", "updated_at": "2015-12-14T15:56:55Z", "closed_at": "2015-12-13T23:03:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi,\n\nI came across npm not managing to install jshint pre-commit. It worked well before commit e8a870dbbbf5a637caba4abd44b9600e549282b6. I ran manually the commands to generate nodeenv with `python -m nodeenv --prebuilt` and `python -m nodeenv -n system`. The latter works well but the first one (when simply running `pre-commit run --all-files` to generate environment) gives the following error:\n\n```\nErrors:\n    npm ERR! Linux 3.13.0-66-generic\n    npm ERR! argv \"/home/tdeo/.pre-commit/repopFVtES/node_env-default/bin/node\" \"/home/tdeo/.pre-commit/repopFVtES/node_env-default/bin/npm\" \"install\" \"-g\"\n    npm ERR! node v5.0.0\n    npm ERR! npm  v3.3.6\n    npm ERR! path /home/tdeo/.pre-commit/repopFVtES/node_env-default/lib/node_modules/.staging/__dummy_package-8df1665f65762053e4e7ca8e2f98517f\n    npm ERR! code ENOENT\n    npm ERR! errno -2\n    npm ERR! syscall rename\n\n    npm ERR! enoent ENOENT: no such file or directory, rename '/home/tdeo/.pre-commit/repopFVtES/node_env-default/lib/node_modules/.staging/__dummy_package-8df1665f65762053e4e7ca8e2f98517f' -> '/home/tdeo/.pre-commit/repopFVtES/node_env-default/lib/node_modules/__dummy_package'\n    npm ERR! enoent This is most likely not a problem with npm itself\n    npm ERR! enoent and is related to npm not being able to find a file.\n    npm ERR! enoent\n\n    npm ERR! Please include the following file with any support request:\n    npm ERR!     /home/tdeo/.pre-commit/repopFVtES/npm-debug.log\n```\n\nIf you want, I can regenerate the error and get the full log (I made the installation with system node after).\n\nMaybe this is related to https://github.com/npm/npm/issues/10166, I found few results on Google\n\nAlso, everything goes fine when I generate nodeenv with node 4.2.1 by `python -m nodeenv -v -n 4.2.1 --prebuilt`\n\nIs there any possibility to have some configuration for node version ?\n\nThanks\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/282/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/282/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/278", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/278/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/278/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/278/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/278", "id": 111437448, "node_id": "MDU6SXNzdWUxMTE0Mzc0NDg=", "number": 278, "title": "Cannot install ruby hooks on OS X", "user": {"login": "magicmark", "id": 1590756, "node_id": "MDQ6VXNlcjE1OTA3NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1590756?v=4", "gravatar_id": "", "url": "https://api.github.com/users/magicmark", "html_url": "https://github.com/magicmark", "followers_url": "https://api.github.com/users/magicmark/followers", "following_url": "https://api.github.com/users/magicmark/following{/other_user}", "gists_url": "https://api.github.com/users/magicmark/gists{/gist_id}", "starred_url": "https://api.github.com/users/magicmark/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/magicmark/subscriptions", "organizations_url": "https://api.github.com/users/magicmark/orgs", "repos_url": "https://api.github.com/users/magicmark/repos", "events_url": "https://api.github.com/users/magicmark/events{/privacy}", "received_events_url": "https://api.github.com/users/magicmark/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 181544375, "node_id": "MDU6TGFiZWwxODE1NDQzNzU=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/osx", "name": "osx", "color": "006b75", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2015-10-14T16:32:08Z", "updated_at": "2015-10-14T19:41:33Z", "closed_at": "2015-10-14T17:24:45Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I can install pre-commit fine, but when it comes to running it for the first time, I get this error:\n\n```\n[INFO] Installing environment for git@***/pre-commit/mirrors-scss-lint.\n[INFO] Once installed this environment will be reused.\n[INFO] This may take a few minutes...\nAn unexpected error has occurred: CalledProcessError: Command: ['bash', '-c', '. /Users/markl/.pre-commit/repoLPZw60/rbenv-1.9.3-p484/bin/activate && cd /Users/markl/.pre-commit/repoLPZw60/ && gem build *.gemspec && gem install --no-document *.gem']\nReturn code: 1\nExpected return code: 0\nOutput:\n      Successfully built RubyGem\n      Name: __fake_gem\n      Version: 0.0.0\n      File: __fake_gem-0.0.0.gem\n\nErrors:\n    WARNING:  no email specified\n    WARNING:  no homepage specified\n    WARNING:  description and summary are identical\n    ERROR:  While executing gem ... (OptionParser::InvalidOption)\n        invalid option: --no-document\n\n\nCheck the log at ~/.pre-commit/pre-commit.log\n```\n\nEnvironment details:\nOS X 10.10.5\n`gem --version`: 2.4.8\n`ruby --version`: ruby 2.0.0p481 (2014-05-08 revision 45883) [universal.x86_64-darwin14]\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/278/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/278/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/274", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/274/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/274/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/274/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/274", "id": 109815515, "node_id": "MDU6SXNzdWUxMDk4MTU1MTU=", "number": 274, "title": "Contributing: Add some information about running the tests to this repo", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2015-10-05T14:57:56Z", "updated_at": "2015-11-26T07:39:57Z", "closed_at": "2015-11-26T07:39:57Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/274/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/274/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/273", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/273/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/273/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/273/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/273", "id": 109727739, "node_id": "MDU6SXNzdWUxMDk3Mjc3Mzk=", "number": 273, "title": "Use coverage>=4 under test", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2015-10-05T04:04:13Z", "updated_at": "2015-11-24T20:42:20Z", "closed_at": "2015-11-24T20:42:20Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Blocked by https://bitbucket.org/ned/coveragepy/issues/420/coverage-40-hangs-indefinitely-on-python27\n\nSee https://github.com/pre-commit/pre-commit/commit/e3a22061c549c6d9cf43a8606617f2b1858d742a\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/273/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/273/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/269", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/269/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/269/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/269/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/269", "id": 109208272, "node_id": "MDU6SXNzdWUxMDkyMDgyNzI=", "number": 269, "title": "Make tests pass with pytest >= 2.8", "user": {"login": "struys", "id": 232692, "node_id": "MDQ6VXNlcjIzMjY5Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/232692?v=4", "gravatar_id": "", "url": "https://api.github.com/users/struys", "html_url": "https://github.com/struys", "followers_url": "https://api.github.com/users/struys/followers", "following_url": "https://api.github.com/users/struys/following{/other_user}", "gists_url": "https://api.github.com/users/struys/gists{/gist_id}", "starred_url": "https://api.github.com/users/struys/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/struys/subscriptions", "organizations_url": "https://api.github.com/users/struys/orgs", "repos_url": "https://api.github.com/users/struys/repos", "events_url": "https://api.github.com/users/struys/events{/privacy}", "received_events_url": "https://api.github.com/users/struys/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 85713407, "node_id": "MDU6TGFiZWw4NTcxMzQwNw==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/feature", "name": "feature", "color": "207de5", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2015-10-01T00:47:47Z", "updated_at": "2015-10-01T18:16:58Z", "closed_at": "2015-10-01T18:16:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "They're currently broken by https://github.com/pytest-dev/pytest/issues/1098\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/269/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/269/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/246", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/246/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/246/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/246/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/246", "id": 96152197, "node_id": "MDU6SXNzdWU5NjE1MjE5Nw==", "number": 246, "title": ".git/hooks/pre-commit points to a dead symlink in a non-writeable directory => IOError", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-07-20T20:27:19Z", "updated_at": "2015-07-23T19:59:06Z", "closed_at": "2015-07-23T19:59:06Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\n$ pre-commit install -f --install-hooks\nAn unexpected error has occurred: IOError: [Errno 13] Permission denied: '/home/.../.git/hooks/pre-commit'\n$ cat ~/.pre-commit/pre-commit.log\nAn unexpected error has occurred: IOError: [Errno 13] Permission denied: '/home.../.git/hooks/pre-commit'\nTraceback (most recent call last):\n  File \"/home/.../.tox/pre-commit/lib/python2.6/site-packages/pre_commit/error_handler.py\", line 34, in error_handler\n    yield\n  File \"/home/.../.tox/pre-commit/lib/python2.6/site-packages/pre_commit/main.py\", line 135, in main\n    hook_type=args.hook_type,\n  File \"/home/.../.tox/pre-commit/lib/python2.6/site-packages/pre_commit/commands/install_uninstall.py\", line 73, in install\n    with io.open(hook_path, 'w') as pre_commit_file_obj:\n  File \"/usr/lib64/python2.6/io.py\", line 231, in open\n    closefd)\n  File \"/usr/lib64/python2.6/io.py\", line 631, in __init__\n    _fileio._FileIO.__init__(self, name, mode, closefd)\nIOError: [Errno 13] Permission denied: '/home/.../.git/hooks/pre-commit'\n```\n\nThe fix is to use `lexists` here:\n\nhttps://github.com/pre-commit/pre-commit/blob/a97cb38b9a8bf72e55489d5ba3f038722491bd1d/pre_commit/commands/install_uninstall.py#L56\n\nA workaround is to manually rm the dead symlink\n\nCC @dkunitsk\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/246/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/246/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/245", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/245/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/245/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/245/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/245", "id": 95826978, "node_id": "MDU6SXNzdWU5NTgyNjk3OA==", "number": 245, "title": "Allow hooks to output arbitrary bytes: UnicodeDecodeError: 'utf8' codec can't decode byte", "user": {"login": "Lucas-C", "id": 925560, "node_id": "MDQ6VXNlcjkyNTU2MA==", "avatar_url": "https://avatars.githubusercontent.com/u/925560?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lucas-C", "html_url": "https://github.com/Lucas-C", "followers_url": "https://api.github.com/users/Lucas-C/followers", "following_url": "https://api.github.com/users/Lucas-C/following{/other_user}", "gists_url": "https://api.github.com/users/Lucas-C/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lucas-C/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lucas-C/subscriptions", "organizations_url": "https://api.github.com/users/Lucas-C/orgs", "repos_url": "https://api.github.com/users/Lucas-C/repos", "events_url": "https://api.github.com/users/Lucas-C/events{/privacy}", "received_events_url": "https://api.github.com/users/Lucas-C/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2015-07-18T13:50:49Z", "updated_at": "2015-07-24T13:38:49Z", "closed_at": "2015-07-24T13:38:49Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I initially mentioned this issue in #207, but only found an easy-to-reproduce test this week.\nI confirm this bug is still present in pre-commit v0.5.3 :\n\n```\ncat <<EOF >> .pre-commit-config.yaml\n- repo: local\n  hooks:\n  - id: utf8_error_test\n    name: UTF8 cmd output Error test\n    language: script\n    entry: echo_problematic_char.sh\n    files: ''\nEOF\n\ncat <<EOF >echo_problematic_char.sh\n#!/bin/bash\necho 'Problematic character: \ufffd'\nexit 1\nEOF\nchmod u+x echo_problematic_char.sh\n\ngit add .pre-commit-config.yaml\npre-commit run utf8_error_test\n```\n\nThe command output:\n\n```\nUTF8 cmd output Error test.........................................................................................................................................An unexpected error has occurred: UnicodeDecodeError: 'utf8' codec can't decode byte 0xbb in position 23: invalid start byte\nCheck the log at ~/.pre-commit/pre-commit.log\n```\n\nAnd the error log:\n\n```\nAn unexpected error has occurred: UnicodeDecodeError: 'utf8' codec can't decode byte 0xbb in position 23: invalid start byte\nTraceback (most recent call last):\n  File \"/home/lucas/.local/lib/python2.7/site-packages/pre_commit/error_handler.py\", line 34, in error_handler\n    yield\n  File \"/home/lucas/.local/lib/python2.7/site-packages/pre_commit/main.py\", line 144, in main\n    return run(runner, args)\n  File \"/home/lucas/.local/lib/python2.7/site-packages/pre_commit/commands/run.py\", line 185, in run\n    return _run_hooks(repo_hooks, args, write, environ)\n  File \"/home/lucas/.local/lib/python2.7/site-packages/pre_commit/commands/run.py\", line 117, in _run_hooks\n    retval |= _run_single_hook(hook, repo, args, write, skips)\n  File \"/home/lucas/.local/lib/python2.7/site-packages/pre_commit/commands/run.py\", line 88, in _run_single_hook\n    retcode, stdout, stderr = repo.run_hook(hook, filenames)\n  File \"/home/lucas/.local/lib/python2.7/site-packages/pre_commit/repository.py\", line 123, in run_hook\n    self.cmd_runner, hook, file_args,\n  File \"/home/lucas/.local/lib/python2.7/site-packages/pre_commit/languages/script.py\", line 19, in run_hook\n    retcode=None,\n  File \"/home/lucas/.local/lib/python2.7/site-packages/pre_commit/prefixed_command_runner.py\", line 41, in run\n    return cmd_output(*replaced_cmd, __popen=self.__popen, **kwargs)\n  File \"/home/lucas/.local/lib/python2.7/site-packages/pre_commit/util.py\", line 153, in cmd_output\n    stdout = stdout.decode(encoding)\n  File \"/usr/lib/python2.7/encodings/utf_8.py\", line 16, in decode\n    return codecs.utf_8_decode(input, errors, True)\nUnicodeDecodeError: 'utf8' codec can't decode byte 0xbb in position 23: invalid start byte\n```\n\nThe problematic UTF8 character is '\u00bb' (U+00BB), and it originally came from a maven command stderr output.\n\nI won't have time to try to solve this issue right now, but I'll try to get a look at it soon.\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/245/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/245/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/238", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/238/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/238/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/238/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/238", "id": 84137290, "node_id": "MDU6SXNzdWU4NDEzNzI5MA==", "number": 238, "title": "pre-commit autoupdate fails on `local` hooks repos", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2015-06-02T18:17:22Z", "updated_at": "2015-06-02T22:49:09Z", "closed_at": "2015-06-02T22:46:00Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\n$ pre-commit autoupdate\nUpdating git@github.com:pre-commit/pre-commit-hooks...updating 9ce45609a92f648c87b42207410386fd69a5d1e5 -> cf550fcab3f12015f8676b8278b30e1a5bc10e70.\nUpdating git@github.com:pre-commit/pre-commit...updating 4352d45451296934bc17494073b82bcacca3205c -> 1c46446427ab0dfa6293221426b855420533ef8d.\nUpdating git@github.com:asottile/reorder_python_imports...updating aeda21eb7df6af8c9f6cd990abb086375c71c953 -> 3d86483455ab5bd06cc1069fdd5ac57be5463f10.\nUpdating local...An unexpected error has occurred: AttributeError: 'NoneType' object has no attribute 'repo_path'\nCheck the log at ~/.pre-commit/pre-commit.log\n(venv-pre_commit)asottile@work:~/workspace/pre-commit$ cat ~/.pre-commit/pre-commit.log \nAn unexpected error has occurred: AttributeError: 'NoneType' object has no attribute 'repo_path'\nTraceback (most recent call last):\n  File \"/home/asottile/workspace/pre-commit/pre_commit/error_handler.py\", line 34, in error_handler\n    yield\n  File \"/home/asottile/workspace/pre-commit/pre_commit/main.py\", line 142, in main\n    return autoupdate(runner)\n  File \"/home/asottile/workspace/pre-commit/pre_commit/commands/autoupdate.py\", line 73, in autoupdate\n    new_repo_config = _update_repository(repo_config, runner)\n  File \"/home/asottile/workspace/pre-commit/pre_commit/commands/autoupdate.py\", line 33, in _update_repository\n    with cwd(repo.repo_path_getter.repo_path):\nAttributeError: 'NoneType' object has no attribute 'repo_path'\n\n(venv-pre_commit)asottile@work:~/workspace/pre-commit$ git diff\ndiff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml\nindex 397ee72..20393a7 100644\n--- a/.pre-commit-config.yaml\n+++ b/.pre-commit-config.yaml\n@@ -20,3 +20,10 @@\n     sha: aeda21eb7df6af8c9f6cd990abb086375c71c953\n     hooks:\n     -   id: reorder-python-imports\n+-   repo: local\n+    hooks:\n+    -   id: herp\n+        name: Herp\n+        entry: echo derp\n+        language: system\n+        files: ^$\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/238/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/238/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/234", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/234/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/234/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/234/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/234", "id": 80028955, "node_id": "MDU6SXNzdWU4MDAyODk1NQ==", "number": 234, "title": "Some versions of git don't create .git/hooks directory", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2015-05-24T02:54:53Z", "updated_at": "2015-05-24T03:33:30Z", "closed_at": "2015-05-24T03:33:30Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Noticed here: https://github.com/victorlin/bugbuzz-python/pull/1#issuecomment-104971132\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/234/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/234/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/232", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/232/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/232/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/232/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/232", "id": 78160386, "node_id": "MDU6SXNzdWU3ODE2MDM4Ng==", "number": 232, "title": "Remove / deprecate expected_return_code", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2015-05-19T16:34:22Z", "updated_at": "2015-11-12T22:24:18Z", "closed_at": "2015-11-12T22:24:18Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Since we rely heavily on xargs, this feature doesn't really work as expected.\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/232/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/232/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/227", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/227/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/227/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/227/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/227", "id": 75002165, "node_id": "MDU6SXNzdWU3NTAwMjE2NQ==", "number": 227, "title": "Bug: base manifest value for 'exclude' is always ignored", "user": {"login": "Lucas-C", "id": 925560, "node_id": "MDQ6VXNlcjkyNTU2MA==", "avatar_url": "https://avatars.githubusercontent.com/u/925560?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lucas-C", "html_url": "https://github.com/Lucas-C", "followers_url": "https://api.github.com/users/Lucas-C/followers", "following_url": "https://api.github.com/users/Lucas-C/following{/other_user}", "gists_url": "https://api.github.com/users/Lucas-C/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lucas-C/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lucas-C/subscriptions", "organizations_url": "https://api.github.com/users/Lucas-C/orgs", "repos_url": "https://api.github.com/users/Lucas-C/repos", "events_url": "https://api.github.com/users/Lucas-C/events{/privacy}", "received_events_url": "https://api.github.com/users/Lucas-C/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2015-05-10T21:07:53Z", "updated_at": "2015-05-18T22:14:29Z", "closed_at": "2015-05-18T22:14:29Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I stumbled upon this bug while working on #226: the culprit is [`Repository.hooks`](https://github.com/pre-commit/pre-commit/blob/master/pre_commit/repository.py#L48).\n\nA quick fix for this would be to simply remove the default value from `pre_commit/clientlib/validate_config.py`, but the root cause is that any default value defined for a field in this file will make the corresponding manifest field useless.\n\nBasically here is what happens in `Repository.hooks`:\n- all the hooks defined in the current repository are enumerated\n- at this stage, a `hook` is a dict closely matching the Yaml the config file content, **plus** default values for fields not defined in the Yaml but having a JSON schema 'default'\n- when doing the dict merge, **every** (key,value) pair in `hook` overrides the corresponding manifest entry. This includes default config value like `exclude: '$^'` overriding a base manifest value like `exclude: '.bak$'`\n\nHence I suggest either adding a test ensuring there will never be any 'default' defined in `CONFIG_JSON_SCHEMA`, or improving the merge logic.\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/227/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/227/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/217", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/217/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/217/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/217/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/217", "id": 66224339, "node_id": "MDU6SXNzdWU2NjIyNDMzOQ==", "number": 217, "title": "xargs error", "user": {"login": "matthayes", "id": 212331, "node_id": "MDQ6VXNlcjIxMjMzMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/212331?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthayes", "html_url": "https://github.com/matthayes", "followers_url": "https://api.github.com/users/matthayes/followers", "following_url": "https://api.github.com/users/matthayes/following{/other_user}", "gists_url": "https://api.github.com/users/matthayes/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthayes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthayes/subscriptions", "organizations_url": "https://api.github.com/users/matthayes/orgs", "repos_url": "https://api.github.com/users/matthayes/repos", "events_url": "https://api.github.com/users/matthayes/events{/privacy}", "received_events_url": "https://api.github.com/users/matthayes/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 181544375, "node_id": "MDU6TGFiZWwxODE1NDQzNzU=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/osx", "name": "osx", "color": "006b75", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 16, "created_at": "2015-04-03T20:44:52Z", "updated_at": "2015-04-23T22:18:55Z", "closed_at": "2015-04-23T22:18:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "I followed the main instructions on the website and I keep getting this error below when I commit.  If I separately run \"pyvenv . && source ./bin/activate\" though and then run \"pre-commit run --all-files\" they pass.  Sometimes though even this doesn't work and I have to run \"pre-commit cleanup\" then \"pre-commit install\" again.  Any advice?\n\n```\nCheck for added large files...............................................................................................Failed\nhookid: check-added-large-files\n\nxargs: check-added-large-files: No such file or directory\n\nTrim Trailing Whitespace..................................................................................................Failed\nhookid: trailing-whitespace\n\nxargs: trailing-whitespace-fixer: No such file or directory\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/217/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/217/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/213", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/213/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/213/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/213/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/213", "id": 63674772, "node_id": "MDU6SXNzdWU2MzY3NDc3Mg==", "number": 213, "title": "Does not work within submodules", "user": {"login": "quentindemetz", "id": 2451971, "node_id": "MDQ6VXNlcjI0NTE5NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/2451971?v=4", "gravatar_id": "", "url": "https://api.github.com/users/quentindemetz", "html_url": "https://github.com/quentindemetz", "followers_url": "https://api.github.com/users/quentindemetz/followers", "following_url": "https://api.github.com/users/quentindemetz/following{/other_user}", "gists_url": "https://api.github.com/users/quentindemetz/gists{/gist_id}", "starred_url": "https://api.github.com/users/quentindemetz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/quentindemetz/subscriptions", "organizations_url": "https://api.github.com/users/quentindemetz/orgs", "repos_url": "https://api.github.com/users/quentindemetz/repos", "events_url": "https://api.github.com/users/quentindemetz/events{/privacy}", "received_events_url": "https://api.github.com/users/quentindemetz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2015-03-23T09:23:08Z", "updated_at": "2015-12-19T06:45:16Z", "closed_at": "2015-12-19T06:45:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm getting: \n\n```\nAn unexpected error has occurred: NotADirectoryError: [Errno 20] Not a directory: '/home/quentin/chef-repo/cookbooks/ssmtp-cookbook/.git/hooks/pre-commit'\n```\n\nchef-repo is my primary repository and ssmtp-cookbook a git submodule of that. \n\n**ssmtp-cookbook/.git file contents:**\n\n```\ngitdir: ../../.git/modules/cookbooks/ssmtp-cookbook\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/213/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/213/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/207", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/207/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/207/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/207/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/207", "id": 59703359, "node_id": "MDU6SXNzdWU1OTcwMzM1OQ==", "number": 207, "title": "Failures when hook ids are non-ascii", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2015-03-03T20:50:33Z", "updated_at": "2015-05-23T17:52:35Z", "closed_at": "2015-05-23T17:52:35Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\n$ pre-commit run \u2603\nAn unexpected error has occurred: UnicodeDecodeError: 'ascii' codec can't decode byte 0xe2 in position 0: ordinal not in range(128)\nCheck the log at ~/.pre-commit/pre-commit.log\n$ cat ~/.pre-commit/pre-commit.log \nAn unexpected error has occurred: UnicodeDecodeError: 'ascii' codec can't decode byte 0xe2 in position 0: ordinal not in range(128)\nTraceback (most recent call last):\n  File \"/home/asottile/workspace/pre-commit/pre_commit/error_handler.py\", line 34, in error_handler\n    yield\n  File \"/home/asottile/workspace/pre-commit/pre_commit/main.py\", line 129, in main\n    return run(runner, args)\n  File \"/home/asottile/workspace/pre-commit/pre_commit/commands/run.py\", line 163, in run\n    return _run_hook(runner, args, write=write)\n  File \"/home/asottile/workspace/pre-commit/pre_commit/commands/run.py\", line 133, in _run_hook\n    write('No hook with id `{0}`\\n'.format(hook_id))\nUnicodeDecodeError: 'ascii' codec can't decode byte 0xe2 in position 0: ordinal not in range(128)\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/207/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/207/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/205", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/205/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/205/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/205/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/205", "id": 59299279, "node_id": "MDU6SXNzdWU1OTI5OTI3OQ==", "number": 205, "title": "Windows: Large number of files causes `xargs: ... Bad file number`", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 181543993, "node_id": "MDU6TGFiZWwxODE1NDM5OTM=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/windows", "name": "windows", "color": "5319e7", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2015-02-27T21:49:00Z", "updated_at": "2015-02-28T00:00:10Z", "closed_at": "2015-02-27T23:53:38Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Originally here: https://github.com/pre-commit/pre-commit-hooks/issues/41\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/205/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/205/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/191", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/191/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/191/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/191/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/191", "id": 56604048, "node_id": "MDU6SXNzdWU1NjYwNDA0OA==", "number": 191, "title": "pre-commit should probably ignore symlinks?", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2015-02-04T23:25:32Z", "updated_at": "2017-07-03T03:09:12Z", "closed_at": "2017-07-03T03:09:12Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Right now some hooks do the wrong thing with symlinks.  Maybe the hooks should be written such that they ignore symlinks?\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/191/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/191/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/165", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/165/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/165/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/165/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/165", "id": 41875514, "node_id": "MDU6SXNzdWU0MTg3NTUxNA==", "number": 165, "title": "npmrc causes npm to install to home directory instead of nodeenv", "user": {"login": "telaviv", "id": 192675, "node_id": "MDQ6VXNlcjE5MjY3NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/192675?v=4", "gravatar_id": "", "url": "https://api.github.com/users/telaviv", "html_url": "https://github.com/telaviv", "followers_url": "https://api.github.com/users/telaviv/followers", "following_url": "https://api.github.com/users/telaviv/following{/other_user}", "gists_url": "https://api.github.com/users/telaviv/gists{/gist_id}", "starred_url": "https://api.github.com/users/telaviv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/telaviv/subscriptions", "organizations_url": "https://api.github.com/users/telaviv/orgs", "repos_url": "https://api.github.com/users/telaviv/repos", "events_url": "https://api.github.com/users/telaviv/events{/privacy}", "received_events_url": "https://api.github.com/users/telaviv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-09-03T22:28:31Z", "updated_at": "2014-09-04T17:00:55Z", "closed_at": "2014-09-04T17:00:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "Here is what happened when I tried to get eslint installed: \n\n```\n$ pre-commit run --all-files\neslint..............................................................................................................................................................................................................................................................................................................Failed\nhookid: eslint\n\nxargs: eslint: No such file or directory\n```\n\nMoving .npmrc to nope.npmrc fixed the issue.\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/165/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/165/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/161", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/161/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/161/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/161/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/161", "id": 41738511, "node_id": "MDU6SXNzdWU0MTczODUxMQ==", "number": 161, "title": "UnicodeEncodeError when writing to stdout in python2.6 ", "user": {"login": "struys", "id": 232692, "node_id": "MDQ6VXNlcjIzMjY5Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/232692?v=4", "gravatar_id": "", "url": "https://api.github.com/users/struys", "html_url": "https://github.com/struys", "followers_url": "https://api.github.com/users/struys/followers", "following_url": "https://api.github.com/users/struys/following{/other_user}", "gists_url": "https://api.github.com/users/struys/gists{/gist_id}", "starred_url": "https://api.github.com/users/struys/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/struys/subscriptions", "organizations_url": "https://api.github.com/users/struys/orgs", "repos_url": "https://api.github.com/users/struys/repos", "events_url": "https://api.github.com/users/struys/events{/privacy}", "received_events_url": "https://api.github.com/users/struys/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-09-02T18:17:55Z", "updated_at": "2014-09-02T23:25:34Z", "closed_at": "2014-09-02T23:25:34Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "```\n$ pre-commit run fixmyjs\nfixmyjs............................................................................................................................................................................................Failed\nhookid: fixmyjs\n\nTraceback (most recent call last):\n  File \"virtualenv_run/bin/pre-commit\", line 14, in <module>\n    sys.exit(main())\n  File \"virtualenv_run/lib/python2.6/site-packages/pre_commit/util.py\", line 41, in wrapper\n    return func(argv)\n  File \"virtualenv_run/lib/python2.6/site-packages/pre_commit/main.py\", line 99, in main\n    return run(runner, args)\n  File \"virtualenv_run/lib/python2.6/site-packages/pre_commit/commands/run.py\", line 144, in run\n    return _run_hook(runner, args, write=write)\n  File \"virtualenv_run/lib/python2.6/site-packages/pre_commit/commands/run.py\", line 116, in _run_hook\n    return _run_single_hook(runner, repo, hook_id, args, write=write)\n  File \"virtualenv_run/lib/python2.6/site-packages/pre_commit/commands/run.py\", line 91, in _run_single_hook\n    write(output.strip() + '\\n')\nUnicodeEncodeError: 'ascii' codec can't encode character u'\\u2713' in position 0: ordinal not in range(128)\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/161/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/161/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/141", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/141/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/141/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/141/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/141", "id": 38136984, "node_id": "MDU6SXNzdWUzODEzNjk4NA==", "number": 141, "title": "Crash when not in a terminal", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-07-17T23:43:09Z", "updated_at": "2014-07-17T23:51:45Z", "closed_at": "2014-07-17T23:51:45Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\n    # SNIP!\n    venv/lib/python2.6/site-packages/pre_commit/output.py\", line 10, in <module>\n         subprocess.Popen(['tput', 'cols'], stdout=subprocess.PIPE).communicate()[0]\n     ValueError: invalid literal for int() with base 10: ''\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/141/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/141/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/140", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/140/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/140/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/140/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/140", "id": 37392220, "node_id": "MDU6SXNzdWUzNzM5MjIyMA==", "number": 140, "title": "Should use sys.executable instead of 'python'", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-07-08T17:13:27Z", "updated_at": "2014-07-22T13:59:46Z", "closed_at": "2014-07-22T13:59:46Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "In the case that `python` is not the same python that's running (in the case of a user install especially).\n\nThis will cause node to break I believe.  Similar to #138 but a different cause.\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/140/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/140/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/138", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/138/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/138/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/138/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/138", "id": 37299617, "node_id": "MDU6SXNzdWUzNzI5OTYxNw==", "number": 138, "title": "Don't assume `nodeenv` is executable, use `python -m ...` instead", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-07-07T19:05:09Z", "updated_at": "2014-07-08T17:13:27Z", "closed_at": "2014-07-08T17:11:47Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\n$ python -m pre_commit.main run jshint\njshint...................................................................................................................................................................................................................................................................Traceback (most recent call last):\n  File \"/usr/lib/python2.6/runpy.py\", line 122, in _run_module_as_main\n    \"__main__\", fname, loader, pkg_name)\n  File \"/usr/lib/python2.6/runpy.py\", line 34, in _run_code\n    exec code in run_globals\n  File \".../virtualenv_run/lib/python2.6/site-packages/pre_commit/main.py\", line 101, in <module>\n    exit(main())\n  File \".../virtualenv_run/lib/python2.6/site-packages/pre_commit/util.py\", line 41, in wrapper\n    return func(argv)\n  File \".../virtualenv_run/lib/python2.6/site-packages/pre_commit/main.py\", line 84, in main\n    return run(runner, args)\n  File \".../virtualenv_run/lib/python2.6/site-packages/pre_commit/commands/run.py\", line 143, in run\n    return _run_hook(runner, args, write=write)\n  File \".../virtualenv_run/lib/python2.6/site-packages/pre_commit/commands/run.py\", line 115, in _run_hook\n    return _run_single_hook(runner, repo, hook_id, args, write=write)\n  File \".../virtualenv_run/lib/python2.6/site-packages/pre_commit/commands/run.py\", line 73, in _run_single_hook\n    retcode, stdout, stderr = repository.run_hook(hook_id, filenames)\n  File \".../virtualenv_run/lib/python2.6/site-packages/pre_commit/repository.py\", line 81, in run_hook\n    self.require_installed()\n  File \".../virtualenv_run/lib/python2.6/site-packages/pre_commit/repository.py\", line 59, in require_installed\n    self.install()\n  File \".../virtualenv_run/lib/python2.6/site-packages/pre_commit/repository.py\", line 72, in install\n    language.install_environment(self.cmd_runner, language_version)\n  File \".../virtualenv_run/lib/python2.6/site-packages/pre_commit/languages/node.py\", line 36, in install_environment\n    '{{prefix}}{0}'.format(ENVIRONMENT_DIR),\n  File \".../virtualenv_run/lib/python2.6/site-packages/pre_commit/prefixed_command_runner.py\", line 71, in run\n    proc = self.__popen(replaced_cmd, **popen_kwargs)\n  File \"/usr/lib/python2.6/subprocess.py\", line 623, in __init__\n    errread, errwrite)\n  File \"/usr/lib/python2.6/subprocess.py\", line 1141, in _execute_child\n    raise child_exception\nOSError: [Errno 2] No such file or directory\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/138/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/138/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/133", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/133/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/133/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/133/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/133", "id": 36394935, "node_id": "MDU6SXNzdWUzNjM5NDkzNQ==", "number": 133, "title": "pcre hooks do not work on osx", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 181544375, "node_id": "MDU6TGFiZWwxODE1NDQzNzU=", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/osx", "name": "osx", "color": "006b75", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-06-24T15:26:28Z", "updated_at": "2015-09-03T15:09:52Z", "closed_at": "2015-09-03T15:09:52Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "No such thing as `grep -P`...\n\nOptions\n- Fall back to `prcregrep` (also not natively on osx)\n- Fall back to `grep -E` (not really correct)\n- Make some sort of perl script\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/133/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/133/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/129", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/129/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/129/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/129/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/129", "id": 36183484, "node_id": "MDU6SXNzdWUzNjE4MzQ4NA==", "number": 129, "title": "Failures on filenames with spaces", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-06-20T16:46:03Z", "updated_at": "2014-06-21T19:13:11Z", "closed_at": "2014-06-21T19:13:11Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\n$ touch 'foo bar.txt'\n$ git add 'foo bar.txt'\n$ pre-commit run\nFix End of Files.................................................................................................................................................................Failed\n\nTraceback (most recent call last):\n  File \"/home/asottile/.pre-commit/repoT8qw0K/py_env/bin/end-of-file-fixer\", line 9, in <module>\n    load_entry_point('pre-commit-hooks==0.1.1', 'console_scripts', 'end-of-file-fixer')()\n  File \"/home/asottile/.pre-commit/repoT8qw0K/py_env/lib/python2.6/site-packages/pre_commit_hooks/util.py\", line 14, in wrapper\n    return func(argv)\n  File \"/home/asottile/.pre-commit/repoT8qw0K/py_env/lib/python2.6/site-packages/pre_commit_hooks/end_of_file_fixer.py\", line 59, in end_of_file_fixer\n    with open(filename, 'rb+') as file_obj:\nIOError: [Errno 2] No such file or directory: 'foo'\n```\n\nI believe this needs more `xargs -0`\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/129/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/129/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/125", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/125/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/125/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/125/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/125", "id": 35950830, "node_id": "MDU6SXNzdWUzNTk1MDgzMA==", "number": 125, "title": "readlink derps on osx", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-06-18T02:58:21Z", "updated_at": "2014-06-18T14:25:22Z", "closed_at": "2014-06-18T14:25:22Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\nreadlink: illegal option -- f\nusage: readlink [-n] [file ...]\nusage: dirname path\n```\n\nwomp womp womp...\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/125/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/125/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/123", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/123/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/123/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/123/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/123", "id": 35917083, "node_id": "MDU6SXNzdWUzNTkxNzA4Mw==", "number": 123, "title": "installed hook should run python -m pre_commit.main", "user": {"login": "struys", "id": 232692, "node_id": "MDQ6VXNlcjIzMjY5Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/232692?v=4", "gravatar_id": "", "url": "https://api.github.com/users/struys", "html_url": "https://github.com/struys", "followers_url": "https://api.github.com/users/struys/followers", "following_url": "https://api.github.com/users/struys/following{/other_user}", "gists_url": "https://api.github.com/users/struys/gists{/gist_id}", "starred_url": "https://api.github.com/users/struys/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/struys/subscriptions", "organizations_url": "https://api.github.com/users/struys/orgs", "repos_url": "https://api.github.com/users/struys/repos", "events_url": "https://api.github.com/users/struys/events{/privacy}", "received_events_url": "https://api.github.com/users/struys/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2014-06-17T18:22:17Z", "updated_at": "2014-06-18T02:57:41Z", "closed_at": "2014-06-18T02:57:41Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Currently we use pre-commit assuming it's on the path. If it's just on the python path, running it fails.\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/123/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/123/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/112", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/112/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/112/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/112/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/112", "id": 35624057, "node_id": "MDU6SXNzdWUzNTYyNDA1Nw==", "number": 112, "title": "Merge conflict detection should look for MERGE_MSG and MERGE_HEAD...", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2014-06-12T21:14:17Z", "updated_at": "2014-06-13T15:07:29Z", "closed_at": "2014-06-13T15:07:15Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "...before assuming merge conflict\n\nI think cherry-pick merge conflicts cause the following:\n\n```\n$ git commit -m \"Make user install less awful.\"\n[INFO] Checking merge-conflict files only.\nTraceback (most recent call last):\n  File \"/home/asottile/bin/pre-commit\", line 9, in <module>\n    load_entry_point('pre-commit==0.1.1', 'console_scripts', 'pre-commit')()\n  File \"/home/asottile/.pre-commit-venv/local/lib/python2.7/site-packages/pre_commit/util.py\", line 35, in wrapper\n    return func(argv)\n  File \"/home/asottile/.pre-commit-venv/local/lib/python2.7/site-packages/pre_commit/run.py\", line 63, in run\n    return commands.run(runner, args)\n  File \"/home/asottile/.pre-commit-venv/local/lib/python2.7/site-packages/pre_commit/commands.py\", line 275, in run\n    return _run_hooks(runner, args, write=write, environ=environ)\n  File \"/home/asottile/.pre-commit-venv/local/lib/python2.7/site-packages/pre_commit/commands.py\", line 235, in _run_hooks\n    runner, repo, hook_id, args, write, skips=skips,\n  File \"/home/asottile/.pre-commit-venv/local/lib/python2.7/site-packages/pre_commit/commands.py\", line 190, in _run_single_hook\n    filenames = get_filenames(hook['files'], hook['exclude'])\n  File \"/home/asottile/.pre-commit-venv/local/lib/python2.7/site-packages/pre_commit/util.py\", line 18, in wrapper\n    ret = wrapper._cache[key] = func(*args)\n  File \"/home/asottile/.pre-commit-venv/local/lib/python2.7/site-packages/pre_commit/git.py\", line 74, in wrapper\n    for filename in all_file_list_strategy()\n  File \"/home/asottile/.pre-commit-venv/local/lib/python2.7/site-packages/pre_commit/util.py\", line 18, in wrapper\n    ret = wrapper._cache[key] = func(*args)\n  File \"/home/asottile/.pre-commit-venv/local/lib/python2.7/site-packages/pre_commit/git.py\", line 51, in get_conflicted_files\n    'diff', '-m', tree_hash, 'HEAD', 'MERGE_HEAD', '--name-only',\n  File \"/home/asottile/.pre-commit-venv/local/lib/python2.7/site-packages/plumbum/commands/base.py\", line 90, in __call__\n    return self.run(args, **kwargs)[1]\n  File \"/home/asottile/.pre-commit-venv/local/lib/python2.7/site-packages/plumbum/commands/base.py\", line 213, in run\n    return p.run()\n  File \"/home/asottile/.pre-commit-venv/local/lib/python2.7/site-packages/plumbum/commands/base.py\", line 176, in runner\n    return run_proc(p, retcode, timeout)\n  File \"/home/asottile/.pre-commit-venv/local/lib/python2.7/site-packages/plumbum/commands/processes.py\", line 207, in run_proc\n    stdout, stderr)\nplumbum.commands.processes.ProcessExecutionError: Command line: ['/usr/lib/git-core/git', 'diff', '-m', '0e003d386b713824181e580ae3a98771a420102b', 'HEAD', 'MERGE_HEAD', '--name-only']\nExit code: 128\nStderr:  | fatal: ambiguous argument 'MERGE_HEAD': unknown revision or path not in the working tree.\n         | Use '--' to separate paths from revisions\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/112/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/112/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/109", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/109/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/109/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/109/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/109", "id": 35519726, "node_id": "MDU6SXNzdWUzNTUxOTcyNg==", "number": 109, "title": "autoupdate is adding defaults to hooks it does not update", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-06-11T19:51:10Z", "updated_at": "2014-06-12T01:19:57Z", "closed_at": "2014-06-12T01:19:57Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\n$ git clone git@github.com:pre-commit/demo-repo\n$ cd demo-repo\n$ git checkout 682424ed525271f72ae26bc813652aef03708627\n$ virtualenv venv\n$ source venv/bin/activate\n$ pip install pre-commit==0.1.0\n$ pre-commit autoupdate\n```\n\n`git diff` after that:\n\n```\ndiff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml\nindex e576a5b..d34f94e 100644\n--- a/.pre-commit-config.yaml\n+++ b/.pre-commit-config.yaml\n@@ -1,5 +1,5 @@\n -   repo: git@github.com:pre-commit/pre-commit-hooks\n-    sha: 7c003425b35fff516c0ee88f4040c8c208d474bd\n+    sha: a751eb58f91d8fa70e8b87c9c95777c5a743a932\n     hooks:\n     -   id: flake8\n     -   id: trailing-whitespace\n@@ -8,15 +8,21 @@\n     sha: d7266131da322d6d76a18d6a3659f21025d9ea11\n     hooks:\n     -   id: scss-lint\n+        exclude: ^$\n+        args: []\n -   repo: git@github.com:pre-commit/pre-commit\n-    sha: 7edb438d76b7b977b7b8a6b16422af7b8d8c13cd\n+    sha: 76c463e3595c564413172e7c888c7e136021a136\n     hooks:\n     -   id: validate_config\n -   repo: git@github.com:pre-commit/mirrors-ruby-lint\n     sha: f4b537e0bf868fc6baefcb61288a12b35aac2157\n     hooks:\n     -   id: ruby-lint\n+        exclude: ^$\n+        args: []\n -   repo: git://github.com/pre-commit/mirrors-jshint\n     sha: 8e7fa9caad6f7b2aae8d2c7b64f457611416192b\n     hooks:\n     -   id: jshint\n+        exclude: ^$\n+        args: []\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/109/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/109/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/103", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/103/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/103/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/103/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/103", "id": 35027677, "node_id": "MDU6SXNzdWUzNTAyNzY3Nw==", "number": 103, "title": "autoupdate might revert your version", "user": {"login": "struys", "id": 232692, "node_id": "MDQ6VXNlcjIzMjY5Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/232692?v=4", "gravatar_id": "", "url": "https://api.github.com/users/struys", "html_url": "https://github.com/struys", "followers_url": "https://api.github.com/users/struys/followers", "following_url": "https://api.github.com/users/struys/following{/other_user}", "gists_url": "https://api.github.com/users/struys/gists{/gist_id}", "starred_url": "https://api.github.com/users/struys/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/struys/subscriptions", "organizations_url": "https://api.github.com/users/struys/orgs", "repos_url": "https://api.github.com/users/struys/repos", "events_url": "https://api.github.com/users/struys/events{/privacy}", "received_events_url": "https://api.github.com/users/struys/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2014-06-05T05:08:03Z", "updated_at": "2017-02-25T17:53:43Z", "closed_at": "2017-02-25T17:53:43Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I was wondering if this might break so I tried it out. I was working on a non master branch that's ahead of master. I ran pre-commit autoupdate to see what it would do. It reverted back to master.\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/103/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/103/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/102", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/102/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/102/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/102/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/102", "id": 35025366, "node_id": "MDU6SXNzdWUzNTAyNTM2Ng==", "number": 102, "title": "Crash on osx using scss-lint", "user": {"login": "struys", "id": 232692, "node_id": "MDQ6VXNlcjIzMjY5Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/232692?v=4", "gravatar_id": "", "url": "https://api.github.com/users/struys", "html_url": "https://github.com/struys", "followers_url": "https://api.github.com/users/struys/followers", "following_url": "https://api.github.com/users/struys/following{/other_user}", "gists_url": "https://api.github.com/users/struys/gists{/gist_id}", "starred_url": "https://api.github.com/users/struys/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/struys/subscriptions", "organizations_url": "https://api.github.com/users/struys/orgs", "repos_url": "https://api.github.com/users/struys/repos", "events_url": "https://api.github.com/users/struys/events{/privacy}", "received_events_url": "https://api.github.com/users/struys/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2014-06-05T03:50:14Z", "updated_at": "2014-06-05T04:36:01Z", "closed_at": "2014-06-05T04:23:01Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "No idea what's causing this:\n\n```\nSCSS Lint............................................................................................................................................................................................Failed\n\n/Users/kstruys/.pre-commit/repolO1ClB/rbenv/gems/gems/scss-lint-0.23.1/lib/scss_lint/constants.rb:3: undefined method `realpath' for File:Class (NoMethodError)\n    from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'\n    from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `require'\n    from /Users/kstruys/.pre-commit/repolO1ClB/rbenv/gems/gems/scss-lint-0.23.1/lib/scss_lint.rb:1\n    from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'\n    from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `require'\n    from /Users/kstruys/.pre-commit/repolO1ClB/rbenv/gems/gems/scss-lint-0.23.1/bin/scss-lint:3\n    from /Users/kstruys/.pre-commit/repolO1ClB/rbenv/gems/bin/scss-lint:19:in `load'\n    from /Users/kstruys/.pre-commit/repolO1ClB/rbenv/gems/bin/scss-lint:19\n    from /Users/kstruys/.pre-commit/repolO1ClB/rbenv/gems/bin/ruby_noexec_wrapper:14\n{code}\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/102/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/102/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/95", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/95/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/95/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/95/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/95", "id": 33525997, "node_id": "MDU6SXNzdWUzMzUyNTk5Nw==", "number": 95, "title": "System hooks with spaces in entry are not runnable", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2014-05-14T19:48:17Z", "updated_at": "2014-05-18T21:30:06Z", "closed_at": "2014-05-18T21:30:06Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "It's pretty reasonable to have a system hook that looks like this:\n\n```\n-   id: foo\n    name: foo\n    entry: python -m bar\n    language: system\n```\n\nCurrently this fails:\n\n```\n$ pre-commit run foo --all-files\nfoo...................................................Failed\n\nxargs: python -m bar: No such file or directory\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/95/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/95/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/90", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/90/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/90/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/90/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/90", "id": 31860005, "node_id": "MDU6SXNzdWUzMTg2MDAwNQ==", "number": 90, "title": "Virtualenvs fail with really long paths", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2014-04-20T04:16:31Z", "updated_at": "2014-05-03T00:34:40Z", "closed_at": "2014-05-03T00:34:40Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\n============================= test session starts ==============================\nplatform linux2 -- Python 2.7.3 -- py-1.4.20 -- pytest-2.5.2\ncollected 13 items \n\ntests/repository_test.py F\n\n=================================== FAILURES ===================================\n_________________________ test_really_long_file_paths __________________________\n\nconfig_for_python_hooks_repo = {'hooks': [{'args': [], 'exclude': '^$', 'files': '\\\\.py$', 'id': 'foo'}], 'repo': '/tmp/pytest-28/test_really_long_file_paths0', 'sha': '05aa3fdf8b123fce89969c945449406714e3d83d'}\n\n    @pytest.mark.herpderp\n    @pytest.mark.integration\n    def test_really_long_file_paths(config_for_python_hooks_repo):\n        path = 'really_long' * 10\n        local['git']['init', path]()\n        with local.cwd(path):\n            repo = Repository(config_for_python_hooks_repo)\n>           repo.require_installed(PrefixedCommandRunner(C.HOOKS_WORKSPACE))\n\n/home/asottile/workspace/pre-commit/tests/repository_test.py:180: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <pre_commit.repository.Repository object at 0x171a850>\ncmd_runner = <pre_commit.prefixed_command_runner.PrefixedCommandRunner object at 0x1a06410>\n\n    def require_installed(self, cmd_runner):\n        if self.__installed:\n            return\n\n>       self.install(cmd_runner)\n\n/home/asottile/workspace/pre-commit/pre_commit/repository.py:83: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <pre_commit.repository.Repository object at 0x171a850>\ncmd_runner = <pre_commit.prefixed_command_runner.PrefixedCommandRunner object at 0x1a06410>\n\n    def install(self, cmd_runner):\n        \"\"\"Install the hook repository.\n\n            Args:\n                cmd_runner - A `PrefixedCommandRunner` bound to the hooks workspace\n            \"\"\"\n        self.require_created()\n        repo_cmd_runner = self.get_cmd_runner(cmd_runner)\n        for language_name in self.languages:\n            language = languages[language_name]\n            if (\n                language.ENVIRONMENT_DIR is None or\n                repo_cmd_runner.exists(language.ENVIRONMENT_DIR)\n            ):\n                # The language is already installed\n                continue\n>           language.install_environment(repo_cmd_runner)\n\n/home/asottile/workspace/pre-commit/pre_commit/repository.py:102: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nrepo_cmd_runner = <pre_commit.prefixed_command_runner.PrefixedCommandRunner object at 0x1a06b50>\n\n    def install_environment(repo_cmd_runner):\n        assert repo_cmd_runner.exists('setup.py')\n\n        # Install a virtualenv\n        with clean_path_on_failure(repo_cmd_runner.path(ENVIRONMENT_DIR)):\n            repo_cmd_runner.run(['virtualenv', '{{prefix}}{0}'.format(ENVIRONMENT_DIR)])\n            with in_env(repo_cmd_runner) as env:\n>               env.run('cd {prefix} && pip install .')\n\n/home/asottile/workspace/pre-commit/pre_commit/languages/python.py:28: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <pre_commit.languages.python.PythonEnv object at 0x1a06fd0>\ncmd = 'cd {prefix} && pip install .', kwargs = {}\n\n    def run(self, cmd, **kwargs):\n        \"\"\"Returns (returncode, stdout, stderr).\"\"\"\n        return self.repo_cmd_runner.run(\n>           ['bash', '-c', ' '.join([self.env_prefix, cmd])], **kwargs\n        )\n\n/home/asottile/workspace/pre-commit/pre_commit/languages/helpers.py:32: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <pre_commit.prefixed_command_runner.PrefixedCommandRunner object at 0x1a06b50>\ncmd = ['bash', '-c', '. {prefix}py_env/bin/activate && cd {prefix} && pip install .']\nretcode = 0, stdin = None, kwargs = {}\npopen_kwargs = {'stderr': -1, 'stdin': -1, 'stdout': -1}\nreplaced_cmd = ['bash', '-c', '. .pre-commit-files/05aa3fdf8b123fce89969c945449406714e3d83d/py_env/bin/activate && cd .pre-commit-files/05aa3fdf8b123fce89969c945449406714e3d83d/ && pip install .']\nproc = <subprocess.Popen object at 0x1a062d0>, stdout = ''\nstderr = 'bash: /tmp/pytest-28/test_really_long_file_paths0/really_longreally_longreally_longreally_longreally_longreally_longr...pytest-28/test_really_long_file_paths0/really_longreally_longreally_longr: bad interpreter: No such file or directory\n'\nreturncode = 126\n\n    def run(self, cmd, retcode=0, stdin=None, **kwargs):\n        popen_kwargs = {\n            'stdin': subprocess.PIPE,\n            'stdout': subprocess.PIPE,\n            'stderr': subprocess.PIPE,\n        }\n        if stdin is not None:\n            stdin = stdin.encode('utf-8')\n\n        popen_kwargs.update(kwargs)\n        self._create_path_if_not_exists()\n        replaced_cmd = _replace_cmd(cmd, prefix=self.prefix_dir)\n        proc = self.__popen(replaced_cmd, **popen_kwargs)\n        stdout, stderr = proc.communicate(stdin)\n        # TODO: stdout, stderr = from_bytes(stdout), from_bytes(stderr)\n        if isinstance(stdout, bytes):\n            stdout = five.text(stdout, 'utf-8')\n        if isinstance(stderr, bytes):\n            stderr = five.text(stderr, 'utf-8')\n        returncode = proc.returncode\n\n        if retcode is not None and retcode != returncode:\n            raise CalledProcessError(\n>               returncode, replaced_cmd, retcode, output=(stdout, stderr),\n            )\nE           CalledProcessError: Command: ['bash', '-c', '. .pre-commit-files/05aa3fdf8b123fce89969c945449406714e3d83d/py_env/bin/activate && cd .pre-commit-files/05aa3fdf8b123fce89969c945449406714e3d83d/ && pip install .']\nE           Return code: 126\nE           Expected return code: 0\nE           Output: (u'', u'bash: /tmp/pytest-28/test_really_long_file_paths0/really_longreally_longreally_longreally_longreally_longreally_longreally_longreally_longreally_longreally_long/.pre-commit-files/05aa3fdf8b123fce89969c945449406714e3d83d/py_env/bin/pip: /tmp/pytest-28/test_really_long_file_paths0/really_longreally_longreally_longr: bad interpreter: No such file or directory\\n')\n\n/home/asottile/workspace/pre-commit/pre_commit/prefixed_command_runner.py:77: CalledProcessError\n```\n\nI'm committing a failing test for this.  Not really sure how I'm going to fix this, but I have a feeling if I fix this, implementing ruby becomes easier.\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/90/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/90/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/85", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/85/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/85/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/85/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/85", "id": 31823034, "node_id": "MDU6SXNzdWUzMTgyMzAzNA==", "number": 85, "title": "UnicodeDecodeError in staged_files_only", "user": {"login": "struys", "id": 232692, "node_id": "MDQ6VXNlcjIzMjY5Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/232692?v=4", "gravatar_id": "", "url": "https://api.github.com/users/struys", "html_url": "https://github.com/struys", "followers_url": "https://api.github.com/users/struys/followers", "following_url": "https://api.github.com/users/struys/following{/other_user}", "gists_url": "https://api.github.com/users/struys/gists{/gist_id}", "starred_url": "https://api.github.com/users/struys/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/struys/subscriptions", "organizations_url": "https://api.github.com/users/struys/orgs", "repos_url": "https://api.github.com/users/struys/repos", "events_url": "https://api.github.com/users/struys/events{/privacy}", "received_events_url": "https://api.github.com/users/struys/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2014-04-18T20:34:25Z", "updated_at": "2014-04-18T21:27:19Z", "closed_at": "2014-04-18T21:27:19Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "```\n$ pre-commit\n[WARNING] Unstaged files detected.\n[INFO] Stashing unstaged files to .../.pre-commit-files/patch1397853050.\nTraceback (most recent call last):\n  File \".../bin/pre-commit\", line 9, in <module>\n    load_entry_point('pre-commit==0.0.0', 'console_scripts', 'pre-commit')()\n  File \".../lib/python2.6/site-packages/pre_commit/util.py\", line 52, in wrapper\n    return func(argv)\n  File \".../lib/python2.6/site-packages/pre_commit/run.py\", line 59, in run\n    return commands.run(runner, args)\n  File \".../lib/python2.6/site-packages/pre_commit/commands.py\", line 254, in run\n    with ctx:\n  File \"/usr/lib64/python2.6/contextlib.py\", line 16, in __enter__\n    return self.gen.next()\n  File \".../lib/python2.6/site-packages/pre_commit/staged_files_only.py\", line 32, in staged_files_only\n    patch_file.write(diff_stdout)\nUnicodeEncodeError: 'ascii' codec can't encode character u'\\xfc' in position 3795: ordinal not in range(128)\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/85/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/85/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/82", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/82/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/82/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/82/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/82", "id": 31436513, "node_id": "MDU6SXNzdWUzMTQzNjUxMw==", "number": 82, "title": "pre-commit crashes when running during unresolved merge conflict", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2014-04-14T06:09:15Z", "updated_at": "2014-04-14T06:57:46Z", "closed_at": "2014-04-14T06:57:46Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I intentionally forced the following by making two branches conflict and then editing a file on that branch.  `pre-commit` should fail-fast in a merge conflict situation.\n\n```\n$ git diff --exit-code\ndiff --cc foo.txt\nindex 8ff26e7,c148433..0000000\n--- a/foo.txt\n+++ b/foo.txt\n@@@ -1,4 -1,5 +1,11 @@@\n  asdf\n++<<<<<<< HEAD\n +fdsa\n +yeah\n +yeah\n++=======\n+ asdf\n+ asdf\n+ asdf\n+ \n++>>>>>>> derp\ndiff --git a/git_code_debt/generate.py b/git_code_debt/generate.py\nindex 12ceec6..967506e 100644\n--- a/git_code_debt/generate.py\n+++ b/git_code_debt/generate.py\n@@ -12,6 +12,7 @@ from git_code_debt.logic import get_previous_sha\n from git_code_debt.logic import insert_metric_values\n from git_code_debt.repo_parser import RepoParser\n\n+\n def get_metrics(diff, metric_parsers):\n     def get_all_metrics(file_diff_stats):\n         for metric_parser_cls in metric_parsers:\n(py_env)[anthony@anthony-VirtualBox git-code-debt (herp|MERGING)]$ echo $?\n1\n(py_env)[anthony@anthony-VirtualBox git-code-debt (herp|MERGING)]$ pre-commit \n[WARNING] Unstaged files detected.\n[INFO] Stashing unstaged files to /tmp/git-code-debt/.pre-commit-files/patch1397455577.\nTraceback (most recent call last):\n  File \"/tmp/git-code-debt/py_env/bin/pre-commit\", line 9, in <module>\n    load_entry_point('pre-commit==0.0.0', 'console_scripts', 'pre-commit')()\n  File \"/tmp/git-code-debt/py_env/local/lib/python2.7/site-packages/pre_commit/util.py\", line 52, in wrapper\n    return func(argv)\n  File \"/tmp/git-code-debt/py_env/local/lib/python2.7/site-packages/pre_commit/run.py\", line 59, in run\n    return commands.run(runner, args)\n  File \"/tmp/git-code-debt/py_env/local/lib/python2.7/site-packages/pre_commit/commands.py\", line 242, in run\n    with ctx:\n  File \"/usr/lib/python2.7/contextlib.py\", line 17, in __enter__\n    return self.gen.next()\n  File \"/tmp/git-code-debt/py_env/local/lib/python2.7/site-packages/pre_commit/staged_files_only.py\", line 35, in staged_files_only\n    cmd_runner.run(['git', 'checkout', '--', '.'])\n  File \"/tmp/git-code-debt/py_env/local/lib/python2.7/site-packages/pre_commit/prefixed_command_runner.py\", line 77, in run\n    returncode, replaced_cmd, retcode, output=(stdout, stderr),\npre_commit.prefixed_command_runner.CalledProcessError: Command: ['git', 'checkout', '--', '.']\nReturn code: 1\nExpected return code: 0\nOutput: (u'', u\"error: path 'foo.txt' is unmerged\\n\")\n\n(py_env)[anthony@anthony-VirtualBox git-code-debt (herp|MERGING)]$ \n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/82/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/82/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/76", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/76/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/76/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/76/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/76", "id": 31398147, "node_id": "MDU6SXNzdWUzMTM5ODE0Nw==", "number": 76, "title": "Occasional flakiness of staged file stasher", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2014-04-13T06:25:09Z", "updated_at": "2014-04-14T04:27:42Z", "closed_at": "2014-04-14T04:27:42Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "It appears `git diff-files` is returning incorrectly in some case that I haven't been able to pinpoint.\n\nIt results in something like this (you can see however that all the files are staged):\n\n```\n$ pre-commit \n[WARNING] Unstaged files detected.\nStashing unstaged files to /home/anthony/workspace/pre-commit/.pre-commit-files/patch1397370090.\nTrim Trailing Whitespace............................................Passed\nFix End of Files....................................................Passed\nCheck Yaml..........................................................Passed\nDebug Statements (Python)...........................................Passed\nTests should end in _test.py........................................Passed\nPyflakes............................................................Passed\nValidate Pre-Commit Config..........................................Passed\nValidate Pre-Commit Manifest........................................Passed\n[WARNING] Stashed changes conflicted with hook auto-fixes... Rolling back fixes...\nTraceback (most recent call last):\n  File \"/home/anthony/workspace/pre-commit/venv-pre_commit/bin/pre-commit\", line 9, in <module>\n    load_entry_point('pre-commit==0.0.0', 'console_scripts', 'pre-commit')()\n  File \"/home/anthony/workspace/pre-commit/pre_commit/util.py\", line 52, in wrapper\n    return func(argv)\n  File \"/home/anthony/workspace/pre-commit/pre_commit/run.py\", line 143, in run\n    return _run(runner, args)\n  File \"/home/anthony/workspace/pre-commit/pre_commit/run.py\", line 95, in _run\n    return run_hooks(runner, args)\n  File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n    self.gen.next()\n  File \"/home/anthony/workspace/pre-commit/pre_commit/staged_files_only.py\", line 51, in staged_files_only\n    cmd_runner.run(['git', 'apply', patch_filename])\n  File \"/home/anthony/workspace/pre-commit/pre_commit/prefixed_command_runner.py\", line 67, in run\n    returncode, replaced_cmd, retcode, output=(stdout, stderr),\npre_commit.prefixed_command_runner.CalledProcessError: Command: ['git', 'apply', '/home/anthony/workspace/pre-commit/.pre-commit-files/patch1397370090']\nReturn code: 128\nExpected return code: 0\nOutput: ('', 'fatal: unrecognized input\\n')\n$ git status\n# On branch rebuild_venv\n# Changes to be committed:\n#   (use \"git reset HEAD <file>...\" to unstage)\n#\n#   modified:   .gitignore\n#   modified:   Makefile\n#\n```\n\nThe \"stashed diff\" is an empty file.  I think the \"fix\" is to check if the diff contains anything before printing the warning message and entering the branch that isn't a noop context manager.\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/76/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/76/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/66", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/66/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/66/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/66/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/66", "id": 31032346, "node_id": "MDU6SXNzdWUzMTAzMjM0Ng==", "number": 66, "title": "TypeError while instantiating LoggingHandler (2.6)", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2014-04-07T23:47:54Z", "updated_at": "2014-04-08T00:08:56Z", "closed_at": "2014-04-08T00:08:56Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I assume this is new-style vs old-style classes being grumpy?\n\n```\n>>> from pre_commit.logging_handler import LoggingHandler\n>>> LoggingHandler(True)\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \".../py_env/lib/python2.6/site-packages/pre_commit/logging_handler.py\", line 19, in __init__\n    super(LoggingHandler, self).__init__()\nTypeError: super() argument 1 must be type, not classobj\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/66/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/66/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/58", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/58/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/58/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/58/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/58", "id": 30833948, "node_id": "MDU6SXNzdWUzMDgzMzk0OA==", "number": 58, "title": "^C during hook repository install causes broken state", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-04-04T04:42:22Z", "updated_at": "2014-04-04T05:57:31Z", "closed_at": "2014-04-04T05:57:31Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Repo is in a half-installed state, meaning it won't update it because the directory exists.  Really this needs to wrap the install in a `try: except SystemExit: delete files; raise`\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/58/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/58/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/34", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/34/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/34/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/34/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/34", "id": 29784914, "node_id": "MDU6SXNzdWUyOTc4NDkxNA==", "number": 34, "title": "Fix lots of files problem", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2014-03-20T00:23:10Z", "updated_at": "2014-03-22T23:59:35Z", "closed_at": "2014-03-22T23:59:35Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "https://github.com/pre-commit/pre-commit/blob/master/pre_commit/languages/helpers.py#L4\n\nFix is prefix with xargs and push filenames into stdin\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/34/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/34/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/32", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/32/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/32/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/32/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/32", "id": 29706434, "node_id": "MDU6SXNzdWUyOTcwNjQzNA==", "number": 32, "title": "pre-commit -i does not install the file with +x", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2014-03-19T04:26:59Z", "updated_at": "2014-03-19T04:42:18Z", "closed_at": "2014-03-19T04:42:18Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "No executable = no run :'(\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/32/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/32/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/25", "repository_url": "https://api.github.com/repos/pre-commit/pre-commit", "labels_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/25/labels{/name}", "comments_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/25/comments", "events_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/25/events", "html_url": "https://github.com/pre-commit/pre-commit/issues/25", "id": 29390595, "node_id": "MDU6SXNzdWUyOTM5MDU5NQ==", "number": 25, "title": "Tests fail when running as  pre-commit step (but pass otherwise)", "user": {"login": "asottile", "id": 1810591, "node_id": "MDQ6VXNlcjE4MTA1OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1810591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asottile", "html_url": "https://github.com/asottile", "followers_url": "https://api.github.com/users/asottile/followers", "following_url": "https://api.github.com/users/asottile/following{/other_user}", "gists_url": "https://api.github.com/users/asottile/gists{/gist_id}", "starred_url": "https://api.github.com/users/asottile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asottile/subscriptions", "organizations_url": "https://api.github.com/users/asottile/orgs", "repos_url": "https://api.github.com/users/asottile/repos", "events_url": "https://api.github.com/users/asottile/events{/privacy}", "received_events_url": "https://api.github.com/users/asottile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 85713405, "node_id": "MDU6TGFiZWw4NTcxMzQwNQ==", "url": "https://api.github.com/repos/pre-commit/pre-commit/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2014-03-13T21:20:29Z", "updated_at": "2020-01-06T15:00:24Z", "closed_at": "2014-03-17T02:26:11Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\n(py_env)asottile@asottile-Parallels-Virtual-Platform:~/workspace/pre-commit$ git commit --allow-empty -m \"derp\"\nTrimming trailing whitespace...\nFixing line endings...\nPy    - Pyflakes........................................................................................................................................................Success\nPy    - ipdb............................................................................................................................................................Success\nPy    - Test files should end in _test.py...............................................................................................................................Success\nPy    - Use s.splitlines over s.split...................................................................................................................................Success\nAll   - No tabs.........................................................................................................................................................Success\nPy    - Tests........................................................................................................................................................Failure(2)\n\nrm -rf py_env\nvirtualenv py_env\nNew python executable in py_env/bin/python\nInstalling Setuptools..............................................................................................................................................................................................................................done.\nInstalling Pip.....................................................................................................................................................................................................................................................................................................................................done.\nbash -c 'source py_env/bin/activate && \\\n        pip install -e . && \\\n        pip install -r requirements.txt'\nObtaining file:///home/asottile/workspace/pre-commit\n  Running setup.py egg_info for package from file:///home/asottile/workspace/pre-commit\n    deleting pre_commit.egg-info/entry_points.txt\n\nRequirement already satisfied (use --upgrade to upgrade): argparse in /usr/lib/python2.7 (from pre-commit==0.0.0)\nDownloading/unpacking plumbum (from pre-commit==0.0.0)\n  Running setup.py egg_info for package plumbum\n\nDownloading/unpacking simplejson (from pre-commit==0.0.0)\n  Running setup.py egg_info for package simplejson\n\nInstalling collected packages: plumbum, simplejson, pre-commit\n  Running setup.py install for plumbum\n\n  Running setup.py install for simplejson\n    building 'simplejson._speedups' extension\n    gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -I/usr/include/python2.7 -c simplejson/_speedups.c -o build/temp.linux-x86_64-2.7/simplejson/_speedups.o\n    gcc -pthread -shared -Wl,-O1 -Wl,-Bsymbolic-functions -Wl,-Bsymbolic-functions -Wl,-z,relro build/temp.linux-x86_64-2.7/simplejson/_speedups.o -o build/lib.linux-x86_64-2.7/simplejson/_speedups.so\n\n  Running setup.py develop for pre-commit\n\n    Creating /home/asottile/workspace/pre-commit/py_env/lib/python2.7/site-packages/pre-commit.egg-link (link to .)\n    Adding pre-commit 0.0.0 to easy-install.pth file\n\n    Installed /home/asottile/workspace/pre-commit\nSuccessfully installed plumbum simplejson pre-commit\nCleaning up...\nRequirement already satisfied (use --upgrade to upgrade): argparse in /usr/lib/python2.7 (from -r requirements.txt (line 1))\nRequirement already satisfied (use --upgrade to upgrade): plumbum in ./py_env/lib/python2.7/site-packages (from -r requirements.txt (line 2))\nDownloading/unpacking pyyaml (from -r requirements.txt (line 3))\n  Running setup.py egg_info for package pyyaml\n\nRequirement already satisfied (use --upgrade to upgrade): simplejson in ./py_env/lib/python2.7/site-packages (from -r requirements.txt (line 4))\nDownloading/unpacking coverage (from -r requirements.txt (line 7))\n  Running setup.py egg_info for package coverage\n\n    warning: no previously-included files matching '*.pyc' found anywhere in distribution\nDownloading/unpacking ipdb (from -r requirements.txt (line 8))\n  Downloading ipdb-0.8.zip\n  Running setup.py egg_info for package ipdb\n\nDownloading/unpacking mock (from -r requirements.txt (line 9))\n  Running setup.py egg_info for package mock\n\n    warning: no files found matching '*.png' under directory 'docs'\n    warning: no files found matching '*.css' under directory 'docs'\n    warning: no files found matching '*.html' under directory 'docs'\n    warning: no files found matching '*.js' under directory 'docs'\nDownloading/unpacking pyflakes (from -r requirements.txt (line 10))\n  Downloading pyflakes-0.7.3.tar.gz\n  Running setup.py egg_info for package pyflakes\n\nDownloading/unpacking pytest (from -r requirements.txt (line 11))\n  Running setup.py egg_info for package pytest\n\nDownloading/unpacking ipython>=0.10 (from ipdb->-r requirements.txt (line 8))\n  Running setup.py egg_info for package ipython\n\nDownloading/unpacking py>=1.4.20 (from pytest->-r requirements.txt (line 11))\n  Running setup.py egg_info for package py\n\nInstalling collected packages: pyyaml, coverage, ipdb, mock, pyflakes, pytest, ipython, py\n  Running setup.py install for pyyaml\n    checking if libyaml is compilable\n    gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -I/usr/include/python2.7 -c build/temp.linux-x86_64-2.7/check_libyaml.c -o build/temp.linux-x86_64-2.7/check_libyaml.o\n    checking if libyaml is linkable\n    gcc -pthread build/temp.linux-x86_64-2.7/check_libyaml.o -lyaml -o build/temp.linux-x86_64-2.7/check_libyaml\n    building '_yaml' extension\n    gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -I/usr/include/python2.7 -c ext/_yaml.c -o build/temp.linux-x86_64-2.7/ext/_yaml.o\n    In file included from ext/_yaml.c:223:0:\n    ext/_yaml.h:6:0: warning: \"PyUnicode_FromString\" redefined [enabled by default]\n    /usr/include/python2.7/unicodeobject.h:281:0: note: this is the location of the previous definition\n    ext/_yaml.c: In function \u2018__pyx_pf_5_yaml_get_version_string\u2019:\n    ext/_yaml.c:1145:17: warning: assignment discards \u2018const\u2019 qualifier from pointer target type [enabled by default]\n    ext/_yaml.c: In function \u2018__pyx_pf_5_yaml_7CParser___init__\u2019:\n    ext/_yaml.c:2074:38: warning: passing argument 2 of \u2018yaml_parser_set_input\u2019 from incompatible pointer type [enabled by default]\n    /usr/include/yaml.h:1367:1: note: expected \u2018int (*)(void *, unsigned char *, size_t,  size_t *)\u2019 but argument is of type \u2018int (*)(void *, char *, int,  int *)\u2019\n    ext/_yaml.c:2272:45: warning: pointer targets in passing argument 2 of \u2018yaml_parser_set_input_string\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/yaml.h:1341:1: note: expected \u2018const unsigned char *\u2019 but argument is of type \u2018char *\u2019\n    ext/_yaml.c: In function \u2018__pyx_f_5_yaml_7CParser__token_to_object\u2019:\n    ext/_yaml.c:3705:5: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:3705:5: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:3718:5: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:3718:5: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:4285:5: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:4285:5: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:4339:5: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:4339:5: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:4393:5: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:4393:5: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:4406:5: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:4406:5: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:4493:5: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c: In function \u2018__pyx_f_5_yaml_7CParser__event_to_object\u2019:\n    ext/_yaml.c:5909:9: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:5909:9: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:5922:9: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:5922:9: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:6088:5: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:6088:5: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:6163:7: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:6163:7: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:6200:7: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:6200:7: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:6216:5: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:6520:7: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:6520:7: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:6557:7: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:6557:7: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:6747:7: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:6747:7: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:6784:7: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:6784:7: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c: In function \u2018__pyx_f_5_yaml_7CParser__compose_node\u2019:\n    ext/_yaml.c:8064:5: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:8064:5: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:8284:5: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:8284:5: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:8315:5: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:8315:5: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:8346:5: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:8346:5: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c: In function \u2018__pyx_f_5_yaml_7CParser__compose_scalar_node\u2019:\n    ext/_yaml.c:8861:3: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:9019:5: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:9019:5: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c: In function \u2018__pyx_f_5_yaml_7CParser__compose_sequence_node\u2019:\n    ext/_yaml.c:9461:5: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:9461:5: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c: In function \u2018__pyx_f_5_yaml_7CParser__compose_mapping_node\u2019:\n    ext/_yaml.c:9998:5: warning: pointer targets in passing argument 1 of \u2018strlen\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/string.h:399:15: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c:9998:5: warning: pointer targets in passing argument 1 of \u2018PyUnicodeUCS4_DecodeUTF8\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/python2.7/unicodeobject.h:750:23: note: expected \u2018const char *\u2019 but argument is of type \u2018yaml_char_t *\u2019\n    ext/_yaml.c: In function \u2018__pyx_pf_5_yaml_8CEmitter___init__\u2019:\n    ext/_yaml.c:11065:38: warning: passing argument 2 of \u2018yaml_emitter_set_output\u2019 from incompatible pointer type [enabled by default]\n    /usr/include/yaml.h:1829:1: note: expected \u2018int (*)(void *, unsigned char *, size_t)\u2019 but argument is of type \u2018int (*)(void *, char *, int)\u2019\n    ext/_yaml.c: In function \u2018__pyx_f_5_yaml_8CEmitter__object_to_event\u2019:\n    ext/_yaml.c:12199:44: warning: pointer targets in assignment differ in signedness [-Wpointer-sign]\n    ext/_yaml.c:12300:44: warning: pointer targets in assignment differ in signedness [-Wpointer-sign]\n    ext/_yaml.c:12563:5: warning: pointer targets in passing argument 2 of \u2018yaml_alias_event_initialize\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/yaml.h:553:1: note: expected \u2018yaml_char_t *\u2019 but argument is of type \u2018char *\u2019\n    ext/_yaml.c:13168:5: warning: pointer targets in passing argument 2 of \u2018yaml_scalar_event_initialize\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/yaml.h:578:1: note: expected \u2018yaml_char_t *\u2019 but argument is of type \u2018char *\u2019\n    ext/_yaml.c:13168:5: warning: pointer targets in passing argument 3 of \u2018yaml_scalar_event_initialize\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/yaml.h:578:1: note: expected \u2018yaml_char_t *\u2019 but argument is of type \u2018char *\u2019\n    ext/_yaml.c:13168:5: warning: pointer targets in passing argument 4 of \u2018yaml_scalar_event_initialize\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/yaml.h:578:1: note: expected \u2018yaml_char_t *\u2019 but argument is of type \u2018char *\u2019\n    ext/_yaml.c:13521:5: warning: pointer targets in passing argument 2 of \u2018yaml_sequence_start_event_initialize\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/yaml.h:601:1: note: expected \u2018yaml_char_t *\u2019 but argument is of type \u2018char *\u2019\n    ext/_yaml.c:13521:5: warning: pointer targets in passing argument 3 of \u2018yaml_sequence_start_event_initialize\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/yaml.h:601:1: note: expected \u2018yaml_char_t *\u2019 but argument is of type \u2018char *\u2019\n    ext/_yaml.c:13874:5: warning: pointer targets in passing argument 2 of \u2018yaml_mapping_start_event_initialize\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/yaml.h:633:1: note: expected \u2018yaml_char_t *\u2019 but argument is of type \u2018char *\u2019\n    ext/_yaml.c:13874:5: warning: pointer targets in passing argument 3 of \u2018yaml_mapping_start_event_initialize\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/yaml.h:633:1: note: expected \u2018yaml_char_t *\u2019 but argument is of type \u2018char *\u2019\n    ext/_yaml.c: In function \u2018__pyx_pf_5_yaml_8CEmitter_6serialize\u2019:\n    ext/_yaml.c:15082:42: warning: pointer targets in assignment differ in signedness [-Wpointer-sign]\n    ext/_yaml.c:15183:42: warning: pointer targets in assignment differ in signedness [-Wpointer-sign]\n    ext/_yaml.c: In function \u2018__pyx_f_5_yaml_8CEmitter__serialize_node\u2019:\n    ext/_yaml.c:15863:5: warning: pointer targets in passing argument 2 of \u2018yaml_alias_event_initialize\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/yaml.h:553:1: note: expected \u2018yaml_char_t *\u2019 but argument is of type \u2018char *\u2019\n    ext/_yaml.c:16500:7: warning: pointer targets in passing argument 2 of \u2018yaml_scalar_event_initialize\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/yaml.h:578:1: note: expected \u2018yaml_char_t *\u2019 but argument is of type \u2018char *\u2019\n    ext/_yaml.c:16500:7: warning: pointer targets in passing argument 3 of \u2018yaml_scalar_event_initialize\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/yaml.h:578:1: note: expected \u2018yaml_char_t *\u2019 but argument is of type \u2018char *\u2019\n    ext/_yaml.c:16500:7: warning: pointer targets in passing argument 4 of \u2018yaml_scalar_event_initialize\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/yaml.h:578:1: note: expected \u2018yaml_char_t *\u2019 but argument is of type \u2018char *\u2019\n    ext/_yaml.c:16790:7: warning: pointer targets in passing argument 2 of \u2018yaml_sequence_start_event_initialize\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/yaml.h:601:1: note: expected \u2018yaml_char_t *\u2019 but argument is of type \u2018char *\u2019\n    ext/_yaml.c:16790:7: warning: pointer targets in passing argument 3 of \u2018yaml_sequence_start_event_initialize\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/yaml.h:601:1: note: expected \u2018yaml_char_t *\u2019 but argument is of type \u2018char *\u2019\n    ext/_yaml.c:17193:7: warning: pointer targets in passing argument 2 of \u2018yaml_mapping_start_event_initialize\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/yaml.h:633:1: note: expected \u2018yaml_char_t *\u2019 but argument is of type \u2018char *\u2019\n    ext/_yaml.c:17193:7: warning: pointer targets in passing argument 3 of \u2018yaml_mapping_start_event_initialize\u2019 differ in signedness [-Wpointer-sign]\n    /usr/include/yaml.h:633:1: note: expected \u2018yaml_char_t *\u2019 but argument is of type \u2018char *\u2019\n    gcc -pthread -shared -Wl,-O1 -Wl,-Bsymbolic-functions -Wl,-Bsymbolic-functions -Wl,-z,relro build/temp.linux-x86_64-2.7/ext/_yaml.o -lyaml -o build/lib.linux-x86_64-2.7/_yaml.so\n\n  Running setup.py install for coverage\n    building 'coverage.tracer' extension\n    gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -I/usr/include/python2.7 -c coverage/tracer.c -o build/temp.linux-x86_64-2.7/coverage/tracer.o\n    gcc -pthread -shared -Wl,-O1 -Wl,-Bsymbolic-functions -Wl,-Bsymbolic-functions -Wl,-z,relro build/temp.linux-x86_64-2.7/coverage/tracer.o -o build/lib.linux-x86_64-2.7/coverage/tracer.so\n\n    warning: no previously-included files matching '*.pyc' found anywhere in distribution\n    Installing coverage2 script to /home/asottile/workspace/pre-commit/py_env/bin\n    Installing coverage-2.7 script to /home/asottile/workspace/pre-commit/py_env/bin\n    Installing coverage script to /home/asottile/workspace/pre-commit/py_env/bin\n  Running setup.py install for ipdb\n\n    Installing ipdb script to /home/asottile/workspace/pre-commit/py_env/bin\n  Running setup.py install for mock\n\n    warning: no files found matching '*.png' under directory 'docs'\n    warning: no files found matching '*.css' under directory 'docs'\n    warning: no files found matching '*.html' under directory 'docs'\n    warning: no files found matching '*.js' under directory 'docs'\n  Running setup.py install for pyflakes\n\n    Installing pyflakes script to /home/asottile/workspace/pre-commit/py_env/bin\n  Running setup.py install for pytest\n\n    Installing py.test script to /home/asottile/workspace/pre-commit/py_env/bin\n    Installing py.test-2.7 script to /home/asottile/workspace/pre-commit/py_env/bin\n  Running setup.py install for ipython\n\n    Installing ipcontroller script to /home/asottile/workspace/pre-commit/py_env/bin\n    Installing iptest script to /home/asottile/workspace/pre-commit/py_env/bin\n    Installing ipcluster script to /home/asottile/workspace/pre-commit/py_env/bin\n    Installing ipython script to /home/asottile/workspace/pre-commit/py_env/bin\n    Installing pycolor script to /home/asottile/workspace/pre-commit/py_env/bin\n    Installing iplogger script to /home/asottile/workspace/pre-commit/py_env/bin\n    Installing irunner script to /home/asottile/workspace/pre-commit/py_env/bin\n    Installing ipengine script to /home/asottile/workspace/pre-commit/py_env/bin\n  Running setup.py install for py\n\nSuccessfully installed pyyaml coverage ipdb mock pyflakes pytest ipython py\nCleaning up...\nbash -c 'source py_env/bin/activate && py.test tests -m \"not(integration)\"'\n============================= test session starts ==============================\nplatform linux2 -- Python 2.7.3 -- py-1.4.20 -- pytest-2.5.2\ncollected 4 items\n\ntests/git_test.py F...\n\n=================================== FAILURES ===================================\n________________________________ test_get_root _________________________________\n\nempty_git_dir = '/tmp/pytest-4/test_get_root0'\n\n    def test_get_root(empty_git_dir):\n        assert git.get_root() == empty_git_dir\n\n        foo = local.path('foo')\n        foo.mkdir()\n\n        with in_dir(foo):\n>           assert git.get_root() == empty_git_dir\n\n/home/asottile/workspace/pre-commit/tests/git_test.py:34: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n    def get_root():\n>       return local['git']['rev-parse', '--show-toplevel']().strip()\n\n/home/asottile/workspace/pre-commit/pre_commit/git.py:7: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = BoundCommand(LocalCommand(<LocalPath /usr/lib/git-core/git>), ['rev-parse', '--show-toplevel'])\nargs = (), kwargs = {}\n\n    def __call__(self, *args, **kwargs):\n        \"\"\"A shortcut for `run(args)`, returning only the process' stdout\"\"\"\n>       return self.run(args, **kwargs)[1]\n\n/home/asottile/workspace/pre-commit/py_env/local/lib/python2.7/site-packages/plumbum/commands/base.py:90: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = BoundCommand(LocalCommand(<LocalPath /usr/lib/git-core/git>), ['rev-parse', '--show-toplevel'])\nargs = (), kwargs = {}, p = <subprocess.Popen object at 0x2cf2f90>\n\n    def run(self, args = (), **kwargs):\n        \"\"\"Runs the given command (equivalent to popen() followed by\n            :func:`run_proc <plumbum.commands.run_proc>`). If the exit code of the process does\n            not match the expected one, :class:`ProcessExecutionError\n            <plumbum.commands.ProcessExecutionError>` is raised.\n\n            :param args: Any arguments to be passed to the process (a tuple)\n\n            :param retcode: The expected return code of this process (defaults to 0).\n                            In order to disable exit-code validation, pass ``None``. It may also\n                            be a tuple (or any iterable) of expected exit codes.\n\n                            .. note:: this argument must be passed as a keyword argument.\n\n            :param timeout: The maximal amount of time (in seconds) to allow the process to run.\n                            ``None`` means no timeout is imposed; otherwise, if the process hasn't\n                            terminated after that many seconds, the process will be forcefully\n                            terminated an exception will be raised\n\n                            .. note:: this argument must be passed as a keyword argument.\n\n            :param kwargs: Any keyword-arguments to be passed to the ``Popen`` constructor\n\n            :returns: A tuple of (return code, stdout, stderr)\n            \"\"\"\n        with self.bgrun(args, **kwargs) as p:\n>           return p.run()\n\n/home/asottile/workspace/pre-commit/py_env/local/lib/python2.7/site-packages/plumbum/commands/base.py:213: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n    def runner():\n        if was_run[0]:\n            return  # already done\n        was_run[0] = True\n        try:\n>           return run_proc(p, retcode, timeout)\n\n/home/asottile/workspace/pre-commit/py_env/local/lib/python2.7/site-packages/plumbum/commands/base.py:176: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nproc = <subprocess.Popen object at 0x2cf2f90>, retcode = 0, timeout = None\n\n    def run_proc(proc, retcode, timeout = None):\n        \"\"\"Waits for the given process to terminate, with the expected exit code\n\n        :param proc: a running Popen-like object\n\n        :param retcode: the expected return (exit) code of the process. It defaults to 0 (the\n                        convention for success). If ``None``, the return code is ignored.\n                        It may also be a tuple (or any object that supports ``__contains__``)\n                        of expected return codes.\n\n        :param timeout: the number of seconds (a ``float``) to allow the process to run, before\n                        forcefully terminating it. If ``None``, not timeout is imposed; otherwise\n                        the process is expected to terminate within that timeout value, or it will\n                        be killed and :class:`ProcessTimedOut <plumbum.cli.ProcessTimedOut>`\n                        will be raised\n\n        :returns: A tuple of (return code, stdout, stderr)\n        \"\"\"\n        if timeout is not None:\n            _timeout_queue.put((proc, time.time() + timeout))\n        stdout, stderr = proc.communicate()\n        proc._end_time = time.time()\n        if not stdout:\n            stdout = six.b(\"\")\n        if not stderr:\n            stderr = six.b(\"\")\n        if getattr(proc, \"encoding\", None):\n            stdout = stdout.decode(proc.encoding, \"ignore\")\n            stderr = stderr.decode(proc.encoding, \"ignore\")\n\n        if getattr(proc, \"_timed_out\", False):\n            raise ProcessTimedOut(\"Process did not terminate within %s seconds\" % (timeout,),\n                getattr(proc, \"argv\", None))\n\n        if retcode is not None:\n            if hasattr(retcode, \"__contains__\"):\n                if proc.returncode not in retcode:\n                    raise ProcessExecutionError(getattr(proc, \"argv\", None), proc.returncode,\n                        stdout, stderr)\n            elif proc.returncode != retcode:\n                raise ProcessExecutionError(getattr(proc, \"argv\", None), proc.returncode,\n>                   stdout, stderr)\nE               ProcessExecutionError: Command line: ['/usr/lib/git-core/git', 'rev-parse', '--show-toplevel']\nE               Exit code: 128\nE               Stderr:  | fatal: Not a git repository: '.git'\n\n/home/asottile/workspace/pre-commit/py_env/local/lib/python2.7/site-packages/plumbum/commands/processes.py:207: ProcessExecutionError\n====================== 1 failed, 3 passed in 0.09 seconds ======================\nmake: *** [_tests] Error 1\n\nFailures / Fixes detected.\nPlease fix and commit again.\nYou could also pass --no-verify, but you probably shouldn't.\n\nHere's git status for convenience: \n\n# On branch herp\nnothing to commit (working directory clean)\n```\n", "reactions": {"url": "https://api.github.com/repos/pre-commit/pre-commit/issues/25/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pre-commit/pre-commit/issues/25/timeline", "performed_via_github_app": null, "state_reason": "completed"}]