[{"url": "https://api.github.com/repos/psf/requests/issues/6104", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/6104/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/6104/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/6104/events", "html_url": "https://github.com/psf/requests/issues/6104", "id": 1194891723, "node_id": "I_kwDOABTKOs5HOJnL", "number": 6104, "title": "ValueError when calling requests.get on windows systems.", "user": {"login": "lsrzj", "id": 18689770, "node_id": "MDQ6VXNlcjE4Njg5Nzcw", "avatar_url": "https://avatars.githubusercontent.com/u/18689770?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lsrzj", "html_url": "https://github.com/lsrzj", "followers_url": "https://api.github.com/users/lsrzj/followers", "following_url": "https://api.github.com/users/lsrzj/following{/other_user}", "gists_url": "https://api.github.com/users/lsrzj/gists{/gist_id}", "starred_url": "https://api.github.com/users/lsrzj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lsrzj/subscriptions", "organizations_url": "https://api.github.com/users/lsrzj/orgs", "repos_url": "https://api.github.com/users/lsrzj/repos", "events_url": "https://api.github.com/users/lsrzj/events{/privacy}", "received_events_url": "https://api.github.com/users/lsrzj/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/psf/requests/milestones/30", "html_url": "https://github.com/psf/requests/milestone/30", "labels_url": "https://api.github.com/repos/psf/requests/milestones/30/labels", "id": 7852541, "node_id": "MI_kwDOABTKOs4Ad9H9", "number": 30, "title": "2.28.0", "description": "", "creator": {"login": "nateprewitt", "id": 5271761, "node_id": "MDQ6VXNlcjUyNzE3NjE=", "avatar_url": "https://avatars.githubusercontent.com/u/5271761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nateprewitt", "html_url": "https://github.com/nateprewitt", "followers_url": "https://api.github.com/users/nateprewitt/followers", "following_url": "https://api.github.com/users/nateprewitt/following{/other_user}", "gists_url": "https://api.github.com/users/nateprewitt/gists{/gist_id}", "starred_url": "https://api.github.com/users/nateprewitt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nateprewitt/subscriptions", "organizations_url": "https://api.github.com/users/nateprewitt/orgs", "repos_url": "https://api.github.com/users/nateprewitt/repos", "events_url": "https://api.github.com/users/nateprewitt/events{/privacy}", "received_events_url": "https://api.github.com/users/nateprewitt/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 8, "state": "closed", "created_at": "2022-04-07T05:17:41Z", "updated_at": "2022-06-09T17:44:05Z", "due_on": null, "closed_at": "2022-06-09T17:44:05Z"}, "comments": 14, "created_at": "2022-04-06T17:14:25Z", "updated_at": "2022-06-01T17:38:09Z", "closed_at": "2022-06-01T17:38:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Summary. -->\r\nUsing windows I'm getting a ValueError in utils.py file telling that it's failing to parse to int ''. It's because the registry query is returning empty string instead of '0' or '1'.\r\n## Expected Result\r\nThe request be successful\r\n\r\n## Actual Result\r\nFile ...\\site-packages\\requests\\utils.py, line 68, in proxy_bypass_registry proxyEnable = int(winreg.QueryValueEx(internetSettings,\r\nValueError: invalid literal for int() with base 10: ''\r\n\r\n## Reproduction Steps\r\n\r\n```python\r\nimport requests\r\nurl = 'https://api.github.com/events'\r\nr = requests.get(url)\r\n```\r\n\r\nHere is the StackOverflow question of more people complaining about this issue and my answer with a solution for the problem\r\n\r\nhttps://stackoverflow.com/a/71770718/2726538\r\n\r\n<!-- This command is only available on Requests v2.16.4 and greater. Otherwise,\r\nplease provide some basic information about your system (Python version,\r\noperating system, &c). -->\r\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/6104/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/6104/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/6027", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/6027/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/6027/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/6027/events", "html_url": "https://github.com/psf/requests/issues/6027", "id": 1092855823, "node_id": "I_kwDOABTKOs5BI6gP", "number": 6027, "title": "Proxy authentication bug", "user": {"login": "flameaway", "id": 8405067, "node_id": "MDQ6VXNlcjg0MDUwNjc=", "avatar_url": "https://avatars.githubusercontent.com/u/8405067?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flameaway", "html_url": "https://github.com/flameaway", "followers_url": "https://api.github.com/users/flameaway/followers", "following_url": "https://api.github.com/users/flameaway/following{/other_user}", "gists_url": "https://api.github.com/users/flameaway/gists{/gist_id}", "starred_url": "https://api.github.com/users/flameaway/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flameaway/subscriptions", "organizations_url": "https://api.github.com/users/flameaway/orgs", "repos_url": "https://api.github.com/users/flameaway/repos", "events_url": "https://api.github.com/users/flameaway/events{/privacy}", "received_events_url": "https://api.github.com/users/flameaway/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2022-01-03T22:12:00Z", "updated_at": "2022-04-04T17:04:26Z", "closed_at": "2022-01-04T16:04:25Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "<!-- Summary. -->\r\n\r\nWhen using proxies in python 3.8.12, I get an error 407. Using any other version of python works fine. I am assuming it could be to do with this https://docs.python.org/3/whatsnew/3.8.html#notable-changes-in-python-3-8-12.\r\n\r\n<!-- What you expected. -->\r\n\r\nI should get a status of 200.\r\n\r\n<!-- What happened instead. -->\r\n\r\nI get a status code of 407.\r\n\r\n```python\r\nimport requests\r\n\r\n\r\nr = requests.get('https://example.org/', proxies=proxies) # You will need a proxy to test with, I am using a paid service.\r\nprint(r.status_code)\r\n\r\n```\r\n\r\n## System Information\r\n\r\n```json\r\n{\r\n  \"chardet\": {\r\n    \"version\": null\r\n  },\r\n  \"charset_normalizer\": {\r\n    \"version\": \"2.0.9\"\r\n  },\r\n  \"cryptography\": {\r\n    \"version\": \"\"\r\n  },\r\n  \"idna\": {\r\n    \"version\": \"3.3\"\r\n  },\r\n  \"implementation\": {\r\n    \"name\": \"CPython\",\r\n    \"version\": \"3.8.12\"\r\n  },\r\n  \"platform\": {\r\n    \"release\": \"5.13.0-7620-generic\",\r\n    \"system\": \"Linux\"\r\n  },\r\n  \"pyOpenSSL\": {\r\n    \"openssl_version\": \"\",\r\n    \"version\": null\r\n  },\r\n  \"requests\": {\r\n    \"version\": \"2.27.0\"\r\n  },\r\n  \"system_ssl\": {\r\n    \"version\": \"101010cf\"\r\n  },\r\n  \"urllib3\": {\r\n    \"version\": \"1.26.7\"\r\n  },\r\n  \"using_charset_normalizer\": true,\r\n  \"using_pyopenssl\": false\r\n}\r\n```", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/6027/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/6027/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/5921", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/5921/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/5921/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/5921/events", "html_url": "https://github.com/psf/requests/issues/5921", "id": 985081901, "node_id": "MDU6SXNzdWU5ODUwODE5MDE=", "number": 5921, "title": "requests should ignore REQUESTS_CA_BUNDLE when session.verify is False", "user": {"login": "brmzkw", "id": 795841, "node_id": "MDQ6VXNlcjc5NTg0MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/795841?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brmzkw", "html_url": "https://github.com/brmzkw", "followers_url": "https://api.github.com/users/brmzkw/followers", "following_url": "https://api.github.com/users/brmzkw/following{/other_user}", "gists_url": "https://api.github.com/users/brmzkw/gists{/gist_id}", "starred_url": "https://api.github.com/users/brmzkw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brmzkw/subscriptions", "organizations_url": "https://api.github.com/users/brmzkw/orgs", "repos_url": "https://api.github.com/users/brmzkw/repos", "events_url": "https://api.github.com/users/brmzkw/events{/privacy}", "received_events_url": "https://api.github.com/users/brmzkw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 44501256, "node_id": "MDU6TGFiZWw0NDUwMTI1Ng==", "url": "https://api.github.com/repos/psf/requests/labels/Breaking%20API%20Change", "name": "Breaking API Change", "color": "eb6420", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-09-01T12:18:14Z", "updated_at": "2021-12-03T22:00:27Z", "closed_at": "2021-09-04T21:37:49Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "The argument `session.verify` set to False is ignored when the environment variable `REQUESTS_CA_BUNDLE` is set.\r\n\r\n## Reproduction Steps\r\n\r\n\u2705 empty `REQUESTS_CA_BUNDLE` and `session.verify = True` : exception is raised\r\n\r\n```bash\r\n$> REQUESTS_CA_BUNDLE=  python -c 'import requests; session = requests.Session(); session.verify = True; session.get(\"https://expired.badssl.com\")'\r\n...\r\nrequests.exceptions.SSLError: HTTPSConnectionPool(host='expired.badssl.com', port=443): Max retries exceeded with url: / (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: certificate has expired (_ssl.c:1131)')))\r\n```\r\n\r\n\u2705 empty `REQUESTS_CA_BUNDLE` and `session.verify = False`: no exception raised\r\n\r\n```bash\r\n$> REQUESTS_CA_BUNDLE=  python -c 'import requests; session = requests.Session(); session.verify = False; session.get(\"https://expired.badssl.com\")'\r\n```\r\n\r\n\u2705 `REQUESTS_CA_BUNDLE` is invalid, and no `verify` is given to `requests.get` (defaults to `True`): exception is raised because `REQUESTS_CA_BUNDLE` is invalid\r\n\r\n```bash\r\n$> REQUESTS_CA_BUNDLE=invalid  python -c 'import requests; requests.get(\"https://expired.badssl.com\")'\r\n...\r\nOSError: Could not find a suitable TLS CA certificate bundle, invalid path: invalid\r\n```\r\n\r\n\u2705 `REQUESTS_CA_BUNDLE` is invalid and `verify=False` is given to `requests.get`: no exception raised\r\n\r\n```bash\r\n$> REQUESTS_CA_BUNDLE=invalid  python -c 'import requests; requests.get(\"https://expired.badssl.com\", verify=False)'\r\n```\r\n\r\n\u2705 `REQUESTS_CA_BUNDLE` is invalid and `session.verify = True` : exception is raised\r\n\r\n```bash\r\n$> REQUESTS_CA_BUNDLE=invalid python -c 'import requests; session = requests.Session(); session.verify = True; session.get(\"https://expired.badssl.com\")'\r\n...\r\nOSError: Could not find a suitable TLS CA certificate bundle, invalid path: invalid\r\n```\r\n\r\n\u274c `REQUESTS_CA_BUNDLE` is invalid and `session.verify = False` : exception is raised\r\n\r\n```bash\r\n$> REQUESTS_CA_BUNDLE=invalid python -c 'import requests; session = requests.Session(); session.verify = False; session.get(\"https://expired.badssl.com\")'\r\n...\r\nOSError: Could not find a suitable TLS CA certificate bundle, invalid path: invalid\r\n```\r\n\r\n\r\nThe problem comes from https://github.com/psf/requests/blob/b0e025ade7ed30ed53ab61f542779af7e024932e/requests/sessions.py#L717 which ignores the value of `self.verify`.", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/5921/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/5921/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/5891", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/5891/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/5891/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/5891/events", "html_url": "https://github.com/psf/requests/issues/5891", "id": 955043574, "node_id": "MDU6SXNzdWU5NTUwNDM1NzQ=", "number": 5891, "title": "Session requests are ~70% slower in version 2.26.0", "user": {"login": "omermizr", "id": 36623475, "node_id": "MDQ6VXNlcjM2NjIzNDc1", "avatar_url": "https://avatars.githubusercontent.com/u/36623475?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omermizr", "html_url": "https://github.com/omermizr", "followers_url": "https://api.github.com/users/omermizr/followers", "following_url": "https://api.github.com/users/omermizr/following{/other_user}", "gists_url": "https://api.github.com/users/omermizr/gists{/gist_id}", "starred_url": "https://api.github.com/users/omermizr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omermizr/subscriptions", "organizations_url": "https://api.github.com/users/omermizr/orgs", "repos_url": "https://api.github.com/users/omermizr/repos", "events_url": "https://api.github.com/users/omermizr/events{/privacy}", "received_events_url": "https://api.github.com/users/omermizr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-07-28T16:43:39Z", "updated_at": "2022-03-30T22:00:46Z", "closed_at": "2021-12-30T21:40:46Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "When using a session, requests are slower than in previous versions.\r\nMy metrics indicate a performance degradation, and after some testing I suspect this is the root cause.\r\n\r\n## Expected Result\r\n\r\nSame performance as in version 2.25\r\n\r\n## Actual Result\r\n\r\nWhen I use a session, requests are about 70% slower than in previous versions.\r\nThis seems to be the PR that caused the regression: https://github.com/psf/requests/pull/5681\r\nI removed the `rebuild_proxies` call locally and performance shot back up.\r\nI ran a benchmark on 1000 requests making a real-world request with the same session. \r\nIn version 2.25.1 it took ~13s, in version 2.26.0 it takes ~23s.\r\n\r\n\r\n## System Information\r\n\r\n    $ python -m requests.help\r\n\r\n```\r\n{\r\n  \"chardet\": {\r\n    \"version\": \"3.0.4\"\r\n  },\r\n  \"charset_normalizer\": {\r\n    \"version\": \"2.0.3\"\r\n  },\r\n  \"cryptography\": {\r\n    \"version\": \"3.4.7\"\r\n  },\r\n  \"idna\": {\r\n    \"version\": \"2.10\"\r\n  },\r\n  \"implementation\": {\r\n    \"name\": \"CPython\",\r\n    \"version\": \"3.7.10\"\r\n  },\r\n  \"platform\": {\r\n    \"release\": \"5.4.0-1055-azure\",\r\n    \"system\": \"Linux\"\r\n  },\r\n  \"pyOpenSSL\": {\r\n    \"openssl_version\": \"101010bf\",\r\n    \"version\": \"19.1.0\"\r\n  },\r\n  \"requests\": {\r\n    \"version\": \"2.26.0\"\r\n  },\r\n  \"system_ssl\": {\r\n    \"version\": \"101000cf\"\r\n  },\r\n  \"urllib3\": {\r\n    \"version\": \"1.26.6\"\r\n  },\r\n  \"using_charset_normalizer\": false,\r\n  \"using_pyopenssl\": true\r\n}\r\n```\r\n\r\nThis command is only available on Requests v2.16.4 and greater. Otherwise,\r\nplease provide some basic information about your system (Python version,\r\noperating system, &c).\r\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/5891/reactions", "total_count": 6, "+1": 6, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/5891/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/5888", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/5888/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/5888/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/5888/events", "html_url": "https://github.com/psf/requests/issues/5888", "id": 953939981, "node_id": "MDU6SXNzdWU5NTM5Mzk5ODE=", "number": 5888, "title": "Manually set Proxy-Authorization header is always removed in 2.26", "user": {"login": "chris-sawarzynski", "id": 88030912, "node_id": "MDQ6VXNlcjg4MDMwOTEy", "avatar_url": "https://avatars.githubusercontent.com/u/88030912?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chris-sawarzynski", "html_url": "https://github.com/chris-sawarzynski", "followers_url": "https://api.github.com/users/chris-sawarzynski/followers", "following_url": "https://api.github.com/users/chris-sawarzynski/following{/other_user}", "gists_url": "https://api.github.com/users/chris-sawarzynski/gists{/gist_id}", "starred_url": "https://api.github.com/users/chris-sawarzynski/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chris-sawarzynski/subscriptions", "organizations_url": "https://api.github.com/users/chris-sawarzynski/orgs", "repos_url": "https://api.github.com/users/chris-sawarzynski/repos", "events_url": "https://api.github.com/users/chris-sawarzynski/events{/privacy}", "received_events_url": "https://api.github.com/users/chris-sawarzynski/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/psf/requests/milestones/29", "html_url": "https://github.com/psf/requests/milestone/29", "labels_url": "https://api.github.com/repos/psf/requests/milestones/29/labels", "id": 7115399, "node_id": "MI_kwDOABTKOs4AbJKH", "number": 29, "title": "2.27.0", "description": "", "creator": {"login": "nateprewitt", "id": 5271761, "node_id": "MDQ6VXNlcjUyNzE3NjE=", "avatar_url": "https://avatars.githubusercontent.com/u/5271761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nateprewitt", "html_url": "https://github.com/nateprewitt", "followers_url": "https://api.github.com/users/nateprewitt/followers", "following_url": "https://api.github.com/users/nateprewitt/following{/other_user}", "gists_url": "https://api.github.com/users/nateprewitt/gists{/gist_id}", "starred_url": "https://api.github.com/users/nateprewitt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nateprewitt/subscriptions", "organizations_url": "https://api.github.com/users/nateprewitt/orgs", "repos_url": "https://api.github.com/users/nateprewitt/repos", "events_url": "https://api.github.com/users/nateprewitt/events{/privacy}", "received_events_url": "https://api.github.com/users/nateprewitt/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 11, "state": "closed", "created_at": "2021-09-02T07:23:33Z", "updated_at": "2021-12-30T21:48:07Z", "due_on": null, "closed_at": "2021-12-30T21:48:07Z"}, "comments": 5, "created_at": "2021-07-27T14:24:46Z", "updated_at": "2022-02-22T20:00:23Z", "closed_at": "2021-11-24T19:28:59Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "In versions 2.25 it was possible to add Proxy-Authorization header manually.\r\nStarting from requests 2.26 this header is removed from request if set manually.\r\nWhen this could be a problem (real life example):\r\nIf you use requests library to programatically access service hidden behind Google Identity Aware Proxy that is protected with Basic Auth you have to provide token in Proxy-Authorization header:\r\nhttps://cloud.google.com/iap/docs/authentication-howto#authenticating_from_proxy-authorization_header\r\n\r\n## Expected Result\r\n\r\nManually provided Proxy-Authorization header should be kept intact, or there should be an obvious way to make this work without hackng library internals\r\n\r\n## Actual Result\r\n\r\nProxy-Authorization header is removed from request\r\n\r\n## Reproduction Steps\r\n\r\n```python\r\nimport requests\r\n\r\ns = requests.Session()\r\ns.headers.update({\"Accept\": \"application/json\", \"Proxy-Authorization\":\"Bearer XXX\"})\r\ns.auth = (\"login\", \"password\")\r\n\r\nresp = s.get('http://localhost:3000/answer')\r\nprint(resp.request.headers)\r\n```\r\n\r\n## System Information\r\n\r\n    $ python -m requests.help\r\n\r\n```\r\n{\r\n  \"chardet\": {\r\n    \"version\": null\r\n  },\r\n  \"charset_normalizer\": {\r\n    \"version\": \"2.0.3\"\r\n  },\r\n  \"cryptography\": {\r\n    \"version\": \"\"\r\n  },\r\n  \"idna\": {\r\n    \"version\": \"3.2\"\r\n  },\r\n  \"implementation\": {\r\n    \"name\": \"CPython\",\r\n    \"version\": \"3.6.8\"\r\n  },\r\n  \"platform\": {\r\n    \"release\": \"3.10.0-957.1.3.el7.x86_64\",\r\n    \"system\": \"Linux\"\r\n  },\r\n  \"pyOpenSSL\": {\r\n    \"openssl_version\": \"\",\r\n    \"version\": null\r\n  },\r\n  \"requests\": {\r\n    \"version\": \"2.26.0\"\r\n  },\r\n  \"system_ssl\": {\r\n    \"version\": \"100020bf\"\r\n  },\r\n  \"urllib3\": {\r\n    \"version\": \"1.26.6\"\r\n  },\r\n  \"using_charset_normalizer\": true,\r\n  \"using_pyopenssl\": false\r\n}\r\n\r\n```\r\n\r\nThis command is only available on Requests v2.16.4 and greater. Otherwise,\r\nplease provide some basic information about your system (Python version,\r\noperating system, &c).\r\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/5888/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/5888/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/5855", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/5855/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/5855/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/5855/events", "html_url": "https://github.com/psf/requests/issues/5855", "id": 935297900, "node_id": "MDU6SXNzdWU5MzUyOTc5MDA=", "number": 5855, "title": "proxy URLs without schemes break under Python 3.9", "user": {"login": "leifwalsh", "id": 46406, "node_id": "MDQ6VXNlcjQ2NDA2", "avatar_url": "https://avatars.githubusercontent.com/u/46406?v=4", "gravatar_id": "", "url": "https://api.github.com/users/leifwalsh", "html_url": "https://github.com/leifwalsh", "followers_url": "https://api.github.com/users/leifwalsh/followers", "following_url": "https://api.github.com/users/leifwalsh/following{/other_user}", "gists_url": "https://api.github.com/users/leifwalsh/gists{/gist_id}", "starred_url": "https://api.github.com/users/leifwalsh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/leifwalsh/subscriptions", "organizations_url": "https://api.github.com/users/leifwalsh/orgs", "repos_url": "https://api.github.com/users/leifwalsh/repos", "events_url": "https://api.github.com/users/leifwalsh/events{/privacy}", "received_events_url": "https://api.github.com/users/leifwalsh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/psf/requests/milestones/29", "html_url": "https://github.com/psf/requests/milestone/29", "labels_url": "https://api.github.com/repos/psf/requests/milestones/29/labels", "id": 7115399, "node_id": "MI_kwDOABTKOs4AbJKH", "number": 29, "title": "2.27.0", "description": "", "creator": {"login": "nateprewitt", "id": 5271761, "node_id": "MDQ6VXNlcjUyNzE3NjE=", "avatar_url": "https://avatars.githubusercontent.com/u/5271761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nateprewitt", "html_url": "https://github.com/nateprewitt", "followers_url": "https://api.github.com/users/nateprewitt/followers", "following_url": "https://api.github.com/users/nateprewitt/following{/other_user}", "gists_url": "https://api.github.com/users/nateprewitt/gists{/gist_id}", "starred_url": "https://api.github.com/users/nateprewitt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nateprewitt/subscriptions", "organizations_url": "https://api.github.com/users/nateprewitt/orgs", "repos_url": "https://api.github.com/users/nateprewitt/repos", "events_url": "https://api.github.com/users/nateprewitt/events{/privacy}", "received_events_url": "https://api.github.com/users/nateprewitt/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 11, "state": "closed", "created_at": "2021-09-02T07:23:33Z", "updated_at": "2021-12-30T21:48:07Z", "due_on": null, "closed_at": "2021-12-30T21:48:07Z"}, "comments": 6, "created_at": "2021-07-01T23:56:49Z", "updated_at": "2022-03-30T22:00:46Z", "closed_at": "2021-12-30T21:36:55Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "In https://bugs.python.org/issue27657 it was decided to reverse an earlier decision about how `urllib.parse.urlparse` handles URLs that don't specify a scheme (e.g. `example.org:80`). This behavior change is in Python 3.9. \r\n\r\nOne way this can present to a user is by confusing requests's attempt to add the scheme if it's missing: https://github.com/psf/requests/blob/1466ad713cf84738cd28f1224a7ab4a19e50e361/requests/utils.py#L904\r\n\r\nWith the old behavior, `urlparse` would return `ParseResult(scheme='', netloc='', path='example.org:80', params='', query='', fragment='')` and then `prepend_scheme_if_needed` would happily add the scheme, typically `http`. With the new behavior, you instead get `ParseResult(scheme='example.org', netloc='', path='80', params='', query='', fragment='')`, so `prepend_scheme_if_needed` thinks it has a scheme, and does nothing. Then later, if this is used as a proxy URL, `urllib3` will complain [here](https://github.com/urllib3/urllib3/blob/dc25db8e9f03ef2c506431e8a98f77c304ac2941/src/urllib3/poolmanager.py#L534), because it has [its own URL parser](https://github.com/urllib3/urllib3/blob/dc25db8e9f03ef2c506431e8a98f77c304ac2941/src/urllib3/util/url.py#L348) that is now I think out of sync with the stdlib.\r\n\r\n(I guess this means you could fix this by making requests use `urllib3.util.url.parse_url` instead of `urllib.parse.urlparse`, but that's maybe an antisocial fix)\r\n\r\n## Expected Result\r\n\r\nIf user code has given requests a proxy dict like `{'http': 'example.org:80'}`, the request is sent through that proxy.\r\n\r\n## Actual Result\r\n\r\n`urllib3` raises `ProxySchemeUnknown`\r\n\r\n## Reproduction Steps\r\n\r\n```python\r\nimport requests\r\nsession = requests.Session()\r\nsession.proxies = {'https': 'example.org:80'}\r\nsession.get('https://www.google.com/')\r\n```\r\n\r\n## System Information\r\n\r\n    $ python -m requests.help\r\n\r\n```\r\n{\r\n  \"implementation\": {\r\n    \"name\": \"CPython\",\r\n    \"version\": \"3.9.5\"\r\n  },\r\n  \"platform\": {\r\n    \"system\": \"Linux\"\r\n  },\r\n  \"requests\": {\r\n    \"version\": \"2.22.0\"\r\n  },\r\n  \"urllib3\": {\r\n    \"version\": \"1.25.3\"\r\n  },\r\n  \"using_pyopenssl\": false\r\n}\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/5855/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/5855/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/4986", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/4986/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/4986/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/4986/events", "html_url": "https://github.com/psf/requests/issues/4986", "id": 411217995, "node_id": "MDU6SXNzdWU0MTEyMTc5OTU=", "number": 4986, "title": "Doctest fails (7 out of 11)", "user": {"login": "aless10", "id": 19170381, "node_id": "MDQ6VXNlcjE5MTcwMzgx", "avatar_url": "https://avatars.githubusercontent.com/u/19170381?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aless10", "html_url": "https://github.com/aless10", "followers_url": "https://api.github.com/users/aless10/followers", "following_url": "https://api.github.com/users/aless10/following{/other_user}", "gists_url": "https://api.github.com/users/aless10/gists{/gist_id}", "starred_url": "https://api.github.com/users/aless10/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aless10/subscriptions", "organizations_url": "https://api.github.com/users/aless10/orgs", "repos_url": "https://api.github.com/users/aless10/repos", "events_url": "https://api.github.com/users/aless10/events{/privacy}", "received_events_url": "https://api.github.com/users/aless10/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 1237085166, "node_id": "MDU6TGFiZWwxMjM3MDg1MTY2", "url": "https://api.github.com/repos/psf/requests/labels/PR(s)%20available", "name": "PR(s) available", "color": "d4c5f9", "default": false, "description": ""}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-02-17T18:24:38Z", "updated_at": "2021-11-05T03:00:29Z", "closed_at": "2021-08-07T02:26:11Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "Hi,\r\nwhile I was working on doctests, I noticed some doctests were failing. \r\n\r\n## Expected Result\r\n\r\n````\r\n$ pytest --doctest-module .\r\n============================= test session starts ===============================\r\nplatform darwin -- Python 3.7.0, pytest-4.0.2, py-1.7.0, pluggy-0.8.1\r\nrootdir: requests/requests, inifile: pytest.ini\r\nplugins: xdist-1.26.1, mock-1.10.1, httpbin-1.0.0, forked-1.0.2, cov-2.6.1\r\ncollected 11 items                                                                                                                                        \r\n\r\n__init__.py .                [  9%]\r\nadapters.py .             [ 18%]\r\napi.py .                       [ 27%]\r\nmodels.py ..               [ 45%]\r\nsessions.py .              [ 54%]\r\nstatus_codes.py .      [ 63%]\r\nutils.py ....                  [100%]\r\n\r\n==========================11 passed in 2.92 seconds=============================\r\n````\r\n\r\n## Actual Result\r\n\r\n````\r\n============================= test session starts ==============================\r\nplatform darwin -- Python 3.7.0, pytest-4.0.2, py-1.7.0, pluggy-0.8.1\r\nrootdir: requests/requests, inifile: pytest.ini\r\nplugins: xdist-1.26.1, mock-1.10.1, httpbin-1.0.0, forked-1.0.2, cov-2.6.1\r\ncollected 11 items\r\n\r\n__init__.py F                                                            [  9%]\r\nadapters.py .                                                            [ 18%]\r\napi.py F                                                                 [ 27%]\r\nmodels.py F.                                                             [ 45%]\r\nsessions.py F                                                            [ 54%]\r\nstatus_codes.py F                                                        [ 63%]\r\nutils.py F..F                                                            [100%]\r\n\r\n=============================== FAILURES ===================================\r\n______________________________ [doctest] requests ______________________________\r\n010 ~~~~~~~~~~~~~~~~~~~~~\r\n011 \r\n012 Requests is an HTTP library, written in Python, for human beings. Basic GET\r\n013 usage:\r\n014 \r\n015    >>> import requests\r\n016    >>> r = requests.get('https://www.python.org')\r\n017    >>> r.status_code\r\n018    200\r\n019    >>> 'Python is a programming language' in r.content\r\nUNEXPECTED EXCEPTION: TypeError(\"a bytes-like object is required, not 'str'\")\r\nTraceback (most recent call last):\r\n\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/doctest.py\", line 1329, in __run\r\n    compileflags, 1), test.globs)\r\n\r\n  File \"<doctest requests[3]>\", line 1, in <module>\r\n\r\nTypeError: a bytes-like object is required, not 'str'\r\n\r\nrequests/requests/__init__.py:19: UnexpectedException\r\n________________________ [doctest] requests.api.request ________________________\r\n043             to a CA bundle to use. Defaults to ``True``.\r\n044     :param stream: (optional) if ``False``, the response content will be immediately downloaded.\r\n045     :param cert: (optional) if String, path to ssl client cert file (.pem). If Tuple, ('cert', 'key') pair.\r\n046     :return: :class:`Response <Response>` object\r\n047     :rtype: requests.Response\r\n048 \r\n049     Usage::\r\n050 \r\n051       >>> import requests\r\n052       >>> req = requests.request('GET', 'https://httpbin.org/get')\r\nExpected:\r\n    <Response [200]>\r\nGot nothing\r\n\r\nrequests/requests/api.py:52: DocTestFailure\r\n__________________ [doctest] requests.models.PreparedRequest ___________________\r\n273 The fully mutable :class:`PreparedRequest <PreparedRequest>` object,\r\n274     containing the exact bytes that will be sent to the server.\r\n275 \r\n276     Generated from either a :class:`Request <Request>` object or manually.\r\n277 \r\n278     Usage::\r\n279 \r\n280       >>> import requests\r\n281       >>> req = requests.Request('GET', 'https://httpbin.org/get')\r\n282       >>> r = req.prepare()\r\nExpected:\r\n    <PreparedRequest [GET]>\r\nGot nothing\r\n\r\nrequests/requests/models.py:282: DocTestFailure\r\n_____________________ [doctest] requests.sessions.Session ______________________\r\n345     Basic Usage::\r\n346 \r\n347       >>> import requests\r\n348       >>> s = requests.Session()\r\n349       >>> s.get('https://httpbin.org/get')\r\n350       <Response [200]>\r\n351 \r\n352     Or as a context manager::\r\n353 \r\n354       >>> with requests.Session() as s:\r\nUNEXPECTED EXCEPTION: SyntaxError('unexpected EOF while parsing', ('<doctest requests.sessions.Session[3]>', 1, 30, 'with requests.Session() as s:\\n'))\r\nTraceback (most recent call last):\r\n\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/doctest.py\", line 1329, in __run\r\n    compileflags, 1), test.globs)\r\n\r\n  File \"<doctest requests.sessions.Session[3]>\", line 1\r\n\r\n    with requests.Session() as s:\r\n\r\n                                ^\r\n\r\nSyntaxError: unexpected EOF while parsing\r\n\r\nrequests/requests/sessions.py:354: UnexpectedException\r\n_______________________ [doctest] requests.status_codes ________________________\r\n003 \r\n004 The ``codes`` object defines a mapping from common names for HTTP statuses\r\n005 to their numerical codes, accessible either as attributes or as dictionary\r\n006 items.\r\n007 \r\n008 >>> requests.codes['temporary_redirect']\r\nUNEXPECTED EXCEPTION: NameError(\"name 'requests' is not defined\")\r\nTraceback (most recent call last):\r\n\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/doctest.py\", line 1329, in __run\r\n    compileflags, 1), test.globs)\r\n\r\n  File \"<doctest requests.status_codes[0]>\", line 1, in <module>\r\n\r\nNameError: name 'requests' is not defined\r\n\r\nrequests/requests/status_codes.py:8: UnexpectedException\r\n__________________ [doctest] requests.utils.from_key_val_list __________________\r\n260 Take an object and test to see if it can be represented as a\r\n261     dictionary. Unless it can not be represented as such, return an\r\n262     OrderedDict, e.g.,\r\n263 \r\n264     ::\r\n265 \r\n266         >>> from_key_val_list([('key', 'val')])\r\n267         OrderedDict([('key', 'val')])\r\n268         >>> from_key_val_list('string')\r\nUNEXPECTED EXCEPTION: ValueError('cannot encode objects that are not 2-tuples')\r\nTraceback (most recent call last):\r\n\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/doctest.py\", line 1329, in __run\r\n    compileflags, 1), test.globs)\r\n\r\n  File \"<doctest requests.utils.from_key_val_list[1]>\", line 1, in <module>\r\n\r\n  File \"/Users/Ale/PycharmProjects/requests/requests/requests/utils.py\", line 279, in from_key_val_list\r\n    raise ValueError('cannot encode objects that are not 2-tuples')\r\n\r\nValueError: cannot encode objects that are not 2-tuples\r\n\r\nrequests/requests/utils.py:268: UnexpectedException\r\n___________________ [doctest] requests.utils.to_key_val_list ___________________\r\n285 Take an object and test to see if it can be represented as a\r\n286     dictionary. If it can be, return a list of tuples, e.g.,\r\n287 \r\n288     ::\r\n289 \r\n290         >>> to_key_val_list([('key', 'val')])\r\n291         [('key', 'val')]\r\n292         >>> to_key_val_list({'key': 'val'})\r\n293         [('key', 'val')]\r\n294         >>> to_key_val_list('string')\r\nUNEXPECTED EXCEPTION: ValueError('cannot encode objects that are not 2-tuples')\r\nTraceback (most recent call last):\r\n\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/doctest.py\", line 1329, in __run\r\n    compileflags, 1), test.globs)\r\n\r\n  File \"<doctest requests.utils.to_key_val_list[2]>\", line 1, in <module>\r\n\r\n  File \"/Users/Ale/PycharmProjects/requests/requests/requests/utils.py\", line 303, in to_key_val_list\r\n    raise ValueError('cannot encode objects that are not 2-tuples')\r\n\r\nValueError: cannot encode objects that are not 2-tuples\r\n\r\nrequests/requests/utils.py:294: UnexpectedException\r\n====================== 7 failed, 4 passed in 3.76 seconds ======================\r\n\r\n````\r\n\r\n## Reproduction Steps\r\n\r\n```bash\r\n $ py.test --doctest-module requests\r\n\r\n```\r\n\r\n## System Information\r\n\r\n    $ python -m requests.help\r\n\r\n```\r\n{\r\n  \"chardet\": {\r\n    \"version\": \"3.0.4\"\r\n  },\r\n  \"cryptography\": {\r\n    \"version\": \"\"\r\n  },\r\n  \"idna\": {\r\n    \"version\": \"2.8\"\r\n  },\r\n  \"implementation\": {\r\n    \"name\": \"CPython\",\r\n    \"version\": \"3.7.0\"\r\n  },\r\n  \"platform\": {\r\n    \"release\": \"18.0.0\",\r\n    \"system\": \"Darwin\"\r\n  },\r\n  \"pyOpenSSL\": {\r\n    \"openssl_version\": \"\",\r\n    \"version\": null\r\n  },\r\n  \"requests\": {\r\n    \"version\": \"2.21.0\"\r\n  },\r\n  \"system_ssl\": {\r\n    \"version\": \"1010008f\"\r\n  },\r\n  \"urllib3\": {\r\n    \"version\": \"1.24.1\"\r\n  },\r\n  \"using_pyopenssl\": false\r\n}\r\n```", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/4986/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/4986/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/4748", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/4748/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/4748/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/4748/events", "html_url": "https://github.com/psf/requests/issues/4748", "id": 344062986, "node_id": "MDU6SXNzdWUzNDQwNjI5ODY=", "number": 4748, "title": "case-insensitive charset handling", "user": {"login": "derlin", "id": 5463445, "node_id": "MDQ6VXNlcjU0NjM0NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/5463445?v=4", "gravatar_id": "", "url": "https://api.github.com/users/derlin", "html_url": "https://github.com/derlin", "followers_url": "https://api.github.com/users/derlin/followers", "following_url": "https://api.github.com/users/derlin/following{/other_user}", "gists_url": "https://api.github.com/users/derlin/gists{/gist_id}", "starred_url": "https://api.github.com/users/derlin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/derlin/subscriptions", "organizations_url": "https://api.github.com/users/derlin/orgs", "repos_url": "https://api.github.com/users/derlin/repos", "events_url": "https://api.github.com/users/derlin/events{/privacy}", "received_events_url": "https://api.github.com/users/derlin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-07-24T14:28:26Z", "updated_at": "2021-09-08T01:21:09Z", "closed_at": "2018-07-24T16:46:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "I get encoding issues when extracting text from some URLs, for example this [one](https://zuri.net/magazin/slang/33/thema_small-talk.htm). After some digging, it seems that although the `headers` dictionary is case-insensitive, the parsing of the content-type header entry is not. For example, if the server sends:\r\n\r\n    text/html; Charset=UTF-8\r\n\r\nBecause of the uppercase `C`, `response.encoding` returns the default `ISO-8859-1` instead of `UTF-8`.\r\n\r\n## Expected Result\r\n\r\n`r.encoding` should return `utf-8`, as it is stated in the `content-type` header.\r\n\r\n## Actual Result\r\n\r\n`r.encoding` returns the default`ISO-8859-1`.\r\n\r\n## Reproduction Steps\r\n\r\n```python\r\nimport requests\r\nresp = requests.get(\"https://zuri.net/magazin/slang/33/thema_small-talk.htm\")\r\nprint(resp.encoding)\r\n```\r\n\r\n## System Information\r\n\r\n    $ python -m requests.help\r\n\r\n```\r\n{\r\n  \"chardet\": {\r\n    \"version\": \"3.0.4\"\r\n  },\r\n  \"cryptography\": {\r\n    \"version\": \"\"\r\n  },\r\n  \"idna\": {\r\n    \"version\": \"2.7\"\r\n  },\r\n  \"implementation\": {\r\n    \"name\": \"CPython\",\r\n    \"version\": \"3.6.5\"\r\n  },\r\n  \"platform\": {\r\n    \"release\": \"17.6.0\",\r\n    \"system\": \"Darwin\"\r\n  },\r\n  \"pyOpenSSL\": {\r\n    \"openssl_version\": \"\",\r\n    \"version\": null\r\n  },\r\n  \"requests\": {\r\n    \"version\": \"2.19.1\"\r\n  },\r\n  \"system_ssl\": {\r\n    \"version\": \"100020ff\"\r\n  },\r\n  \"urllib3\": {\r\n    \"version\": \"1.23\"\r\n  },\r\n  \"using_pyopenssl\": false\r\n}\r\n```\r\n\r\n## Suggestion\r\n\r\nThe code responsible is in `utils.py`, method `_parse_content_type_header`. Here, either use a case-insensitive dictionary, or transform the keys to lowercase (`params_dict[key.lower()] = value`).", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/4748/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/4748/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/4746", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/4746/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/4746/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/4746/events", "html_url": "https://github.com/psf/requests/issues/4746", "id": 343560824, "node_id": "MDU6SXNzdWUzNDM1NjA4MjQ=", "number": 4746, "title": "urllib3 LocationParseError uncaught by requests", "user": {"login": "Arduous", "id": 115884, "node_id": "MDQ6VXNlcjExNTg4NA==", "avatar_url": "https://avatars.githubusercontent.com/u/115884?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Arduous", "html_url": "https://github.com/Arduous", "followers_url": "https://api.github.com/users/Arduous/followers", "following_url": "https://api.github.com/users/Arduous/following{/other_user}", "gists_url": "https://api.github.com/users/Arduous/gists{/gist_id}", "starred_url": "https://api.github.com/users/Arduous/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Arduous/subscriptions", "organizations_url": "https://api.github.com/users/Arduous/orgs", "repos_url": "https://api.github.com/users/Arduous/repos", "events_url": "https://api.github.com/users/Arduous/events{/privacy}", "received_events_url": "https://api.github.com/users/Arduous/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-07-23T09:43:33Z", "updated_at": "2021-09-07T00:06:16Z", "closed_at": "2018-10-01T02:25:44Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "When accessing a page that is not redirecting properly (in this case, port is \"-1\", urllib3 LocationParseError is returned without being caught by requests. \r\nThe URL _currently_ (Jul 23rd 2018) badly redirecting: https://www.fossil.com/us/en/account-dashboard/registered-products.html\r\n\r\n## Expected Result\r\n\r\nAn exception raised by requests, like InvalidURL\r\n\r\n## Actual Result\r\n\r\nException from urllib3 is not masked\r\n\r\n## Reproduction Steps\r\n\r\n```python\r\nimport requests\r\ntest = requests.get(\"https://www.fossil.com/us/en/account-dashboard/registered-products.html\")\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/usr/local/lib/python2.7/dist-packages/requests/api.py\", line 72, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/requests/api.py\", line 58, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/requests/sessions.py\", line 512, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/requests/sessions.py\", line 644, in send\r\n    history = [resp for resp in gen] if allow_redirects else []\r\n  File \"/usr/local/lib/python2.7/dist-packages/requests/sessions.py\", line 222, in resolve_redirects\r\n    **adapter_kwargs\r\n  File \"/usr/local/lib/python2.7/dist-packages/requests/sessions.py\", line 622, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/requests/adapters.py\", line 410, in send\r\n    conn = self.get_connection(request.url, proxies)\r\n  File \"/usr/local/lib/python2.7/dist-packages/requests/adapters.py\", line 314, in get_connection\r\n    conn = self.poolmanager.connection_from_url(url)\r\n  File \"/usr/local/lib/python2.7/dist-packages/urllib3/poolmanager.py\", line 277, in connection_from_url\r\n    u = parse_url(url)\r\n  File \"/usr/local/lib/python2.7/dist-packages/urllib3/util/url.py\", line 199, in parse_url\r\n    raise LocationParseError(url)\r\nurllib3.exceptions.LocationParseError: Failed to parse: www.fossil.com:-1\r\n\r\n\r\n```\r\n\r\n## System Information\r\n\r\n    $ python -m requests.help\r\n\r\n```\r\n{\r\n  \"chardet\": {\r\n    \"version\": \"3.0.4\"\r\n  }, \r\n  \"cryptography\": {\r\n    \"version\": \"2.2.2\"\r\n  }, \r\n  \"idna\": {\r\n    \"version\": \"2.7\"\r\n  }, \r\n  \"implementation\": {\r\n    \"name\": \"CPython\", \r\n    \"version\": \"2.7.9\"\r\n  }, \r\n  \"platform\": {\r\n    \"release\": \"4.9.35-v7+\", \r\n    \"system\": \"Linux\"\r\n  }, \r\n  \"pyOpenSSL\": {\r\n    \"openssl_version\": \"1000114f\", \r\n    \"version\": \"18.0.0\"\r\n  }, \r\n  \"requests\": {\r\n    \"version\": \"2.19.1\"\r\n  }, \r\n  \"system_ssl\": {\r\n    \"version\": \"1000114f\"\r\n  }, \r\n  \"urllib3\": {\r\n    \"version\": \"1.23\"\r\n  }, \r\n  \"using_pyopenssl\": true\r\n}\r\n\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/4746/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/4746/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/4716", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/4716/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/4716/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/4716/events", "html_url": "https://github.com/psf/requests/issues/4716", "id": 336140577, "node_id": "MDU6SXNzdWUzMzYxNDA1Nzc=", "number": 4716, "title": "Should Authorization header be cleared in https -> http redirect?", "user": {"login": "bmerry", "id": 1963944, "node_id": "MDQ6VXNlcjE5NjM5NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1963944?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bmerry", "html_url": "https://github.com/bmerry", "followers_url": "https://api.github.com/users/bmerry/followers", "following_url": "https://api.github.com/users/bmerry/following{/other_user}", "gists_url": "https://api.github.com/users/bmerry/gists{/gist_id}", "starred_url": "https://api.github.com/users/bmerry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bmerry/subscriptions", "organizations_url": "https://api.github.com/users/bmerry/orgs", "repos_url": "https://api.github.com/users/bmerry/repos", "events_url": "https://api.github.com/users/bmerry/events{/privacy}", "received_events_url": "https://api.github.com/users/bmerry/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-06-27T09:06:49Z", "updated_at": "2021-09-07T00:06:10Z", "closed_at": "2018-09-14T12:08:05Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "This may be considered intentional behaviour (in which case feel free to close this), but if a request is made to an https endpoint with authorization and it redirects to http on the same host, the Authorization header is not stripped and will be exposed on the wire.\r\n\r\n## Expected Result\r\n\r\nrebuild_auth would strip the Authorization header if the scheme is changed from https to http.\r\n\r\n## Actual Result\r\n\r\nThe credentials that were intended to be sent over TLS were transmitted in plaintext with the redirected request.\r\n\r\n## Reproduction Steps\r\n\r\nRun an HTTPS server on localhost:4443 that replies with a 302 redirect to `http://localhost:8000`, and a plain HTTP server (or netcat) on localhost:8000. Then run\r\n```python\r\nimport requests\r\nrequests.get('https://localhost:4443', auth=('hello', 'world'), verify=False)\r\n```\r\nThe basic auth credentials are sent in plaintext to `http://localhost:8000` (the `verify=False` is just because I had a self-signed cert).\r\n\r\nHere's the code I used for the SSL server:\r\n```python\r\nimport BaseHTTPServer\r\nimport ssl\r\n\r\nclass Handler(BaseHTTPServer.BaseHTTPRequestHandler):\r\n    def do_GET(self):\r\n        self.send_response(302)\r\n        self.send_header('Location', 'http://localhost:8000/')\r\n        self.end_headers()\r\n        self.wfile.write('')\r\n\r\nhttpd = BaseHTTPServer.HTTPServer(('localhost', 4443), Handler)\r\nhttpd.socket = ssl.wrap_socket (httpd.socket, server_side=True,\r\n                                certfile='yourpemfile.pem')\r\nhttpd.serve_forever()\r\n```\r\n\r\n## System Information\r\n\r\n```\r\n{\r\n  \"chardet\": {\r\n    \"version\": \"3.0.4\"\r\n  }, \r\n  \"cryptography\": {\r\n    \"version\": \"2.2.2\"\r\n  }, \r\n  \"idna\": {\r\n    \"version\": \"2.7\"\r\n  }, \r\n  \"implementation\": {\r\n    \"name\": \"CPython\", \r\n    \"version\": \"2.7.12\"\r\n  }, \r\n  \"platform\": {\r\n    \"release\": \"4.15.0-23-generic\", \r\n    \"system\": \"Linux\"\r\n  }, \r\n  \"pyOpenSSL\": {\r\n    \"openssl_version\": \"1010008f\", \r\n    \"version\": \"18.0.0\"\r\n  }, \r\n  \"requests\": {\r\n    \"version\": \"2.19.1\"\r\n  }, \r\n  \"system_ssl\": {\r\n    \"version\": \"1000207f\"\r\n  }, \r\n  \"urllib3\": {\r\n    \"version\": \"1.23\"\r\n  }, \r\n  \"using_pyopenssl\": true\r\n}\r\n```", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/4716/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/4716/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/4649", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/4649/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/4649/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/4649/events", "html_url": "https://github.com/psf/requests/issues/4649", "id": 323695232, "node_id": "MDU6SXNzdWUzMjM2OTUyMzI=", "number": 4649, "title": "utf-8 passwords in url don't work", "user": {"login": "emmnx", "id": 8750682, "node_id": "MDQ6VXNlcjg3NTA2ODI=", "avatar_url": "https://avatars.githubusercontent.com/u/8750682?v=4", "gravatar_id": "", "url": "https://api.github.com/users/emmnx", "html_url": "https://github.com/emmnx", "followers_url": "https://api.github.com/users/emmnx/followers", "following_url": "https://api.github.com/users/emmnx/following{/other_user}", "gists_url": "https://api.github.com/users/emmnx/gists{/gist_id}", "starred_url": "https://api.github.com/users/emmnx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/emmnx/subscriptions", "organizations_url": "https://api.github.com/users/emmnx/orgs", "repos_url": "https://api.github.com/users/emmnx/repos", "events_url": "https://api.github.com/users/emmnx/events{/privacy}", "received_events_url": "https://api.github.com/users/emmnx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-05-16T16:25:58Z", "updated_at": "2021-09-07T00:06:14Z", "closed_at": "2018-10-03T16:11:33Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "_Summary:_\r\n\r\n```curl -s --url http://user1:engana\u00e7\u00e3o@127.0.0.1:8080 --data '{\"method\": \"help\"}'```\r\nworks\r\n\r\n```\r\n#!/usr/bin/env python2\r\nimport requests\r\nimport json\r\npayload = {'method': 'help'}\r\nurl = 'http://user1:engana\u00e7\u00e3o@127.0.0.1:8080'\r\nrequests.post(url, headers={'Content-type': 'text/plain; charset=utf-8'}, data=json.dumps(payload))\r\n```\r\nalso works.\r\n\r\n\r\nBut... use `#!/usr/bin/env python3` instead, and it doesn't work anymore. \r\nrequests messes things up.\r\n\r\n\r\n\r\n\r\n\r\n## Expected Result\r\n\r\nWork as curl and requests in python2 do. \r\n\r\n## Actual Result\r\n\r\nrequests in python3 messes with encoding.\r\n\r\n## Reproduction Steps\r\n\r\n```python3\r\nimport requests\r\nimport json\r\npayload = {'method': 'help'}\r\nurl = 'http://user1:engana\u00e7\u00e3o@127.0.0.1:8080'\r\nrequests.post(url, headers={'Content-type': 'text/plain; charset=utf-8'}, data=json.dumps(payload))\r\n```\r\n\r\n## System Information\r\n\r\n```\r\nPython 3.5.2\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/4649/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/4649/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/4443", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/4443/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/4443/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/4443/events", "html_url": "https://github.com/psf/requests/issues/4443", "id": 285308691, "node_id": "MDU6SXNzdWUyODUzMDg2OTE=", "number": 4443, "title": "fragment not append on redirect", "user": {"login": "stcioc", "id": 30517876, "node_id": "MDQ6VXNlcjMwNTE3ODc2", "avatar_url": "https://avatars.githubusercontent.com/u/30517876?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stcioc", "html_url": "https://github.com/stcioc", "followers_url": "https://api.github.com/users/stcioc/followers", "following_url": "https://api.github.com/users/stcioc/following{/other_user}", "gists_url": "https://api.github.com/users/stcioc/gists{/gist_id}", "starred_url": "https://api.github.com/users/stcioc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stcioc/subscriptions", "organizations_url": "https://api.github.com/users/stcioc/orgs", "repos_url": "https://api.github.com/users/stcioc/repos", "events_url": "https://api.github.com/users/stcioc/events{/privacy}", "received_events_url": "https://api.github.com/users/stcioc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-01-01T13:57:19Z", "updated_at": "2021-09-08T04:00:47Z", "closed_at": "2018-01-21T18:53:24Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "In the following case (see detailed explanation and test case at http://www.webdbg.com/test/redir/fragment/):\r\n- try to open a link that contains a fragment (say http://foo/#SomeInfo)\r\n- the server sends a 302 Redir to http://bar\r\n\r\n## Expected Result\r\n\r\nThe expected result is that requests library follows the redirection and appends the original fragment from the link (e.g. it redirects to http://bar/#SomeInfo)\r\n\r\n## Actual Result\r\n\r\nThe redirect link is followed without the fragment (e.g. requests tries to open http://bar)\r\n\r\n## Reproduction Steps\r\n\r\n```python\r\nimport requests\r\nresponse = requests.get(\"https://www.bayden.com/test/redir/fragment/redir-1.asp#/HereIsSomeInfo\")\r\nhtml = response.text\r\nprint(response.url)\r\n```\r\noutput is \"http://www.enhanceie.com/test/redir/fragment/final.asp\"\r\noutput should be \"http://www.enhanceie.com/test/redir/fragment/final.asp#HereIsSomeInfo\"\r\n\r\n## System Information\r\n\r\n    $ python -m requests.help\r\n\r\n```\r\n{\r\n  \"chardet\": {\r\n    \"version\": \"3.0.4\"\r\n  },\r\n  \"cryptography\": {\r\n    \"version\": \"\"\r\n  },\r\n  \"idna\": {\r\n    \"version\": \"2.6\"\r\n  },\r\n  \"implementation\": {\r\n    \"name\": \"CPython\",\r\n    \"version\": \"3.6.2\"\r\n  },\r\n  \"platform\": {\r\n    \"release\": \"10\",\r\n    \"system\": \"Windows\"\r\n  },\r\n  \"pyOpenSSL\": {\r\n    \"openssl_version\": \"\",\r\n    \"version\": null\r\n  },\r\n  \"requests\": {\r\n    \"version\": \"2.18.4\"\r\n  },\r\n  \"system_ssl\": {\r\n    \"version\": \"100020bf\"\r\n  },\r\n  \"urllib3\": {\r\n    \"version\": \"1.22\"\r\n  },\r\n  \"using_pyopenssl\": false\r\n}\r\n```\r\n\r\nThis command is only available on Requests v2.16.4 and greater. Otherwise,\r\nplease provide some basic information about your system (Python version,\r\noperating system, &c).", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/4443/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/4443/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/4401", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/4401/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/4401/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/4401/events", "html_url": "https://github.com/psf/requests/issues/4401", "id": 276971584, "node_id": "MDU6SXNzdWUyNzY5NzE1ODQ=", "number": 4401, "title": "Find cause of status code 0", "user": {"login": "grillorafael", "id": 1812267, "node_id": "MDQ6VXNlcjE4MTIyNjc=", "avatar_url": "https://avatars.githubusercontent.com/u/1812267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/grillorafael", "html_url": "https://github.com/grillorafael", "followers_url": "https://api.github.com/users/grillorafael/followers", "following_url": "https://api.github.com/users/grillorafael/following{/other_user}", "gists_url": "https://api.github.com/users/grillorafael/gists{/gist_id}", "starred_url": "https://api.github.com/users/grillorafael/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/grillorafael/subscriptions", "organizations_url": "https://api.github.com/users/grillorafael/orgs", "repos_url": "https://api.github.com/users/grillorafael/repos", "events_url": "https://api.github.com/users/grillorafael/events{/privacy}", "received_events_url": "https://api.github.com/users/grillorafael/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 167537670, "node_id": "MDU6TGFiZWwxNjc1Mzc2NzA=", "url": "https://api.github.com/repos/psf/requests/labels/Propose%20Close", "name": "Propose Close", "color": "f7c6c7", "default": false, "description": null}, {"id": 298537994, "node_id": "MDU6TGFiZWwyOTg1Mzc5OTQ=", "url": "https://api.github.com/repos/psf/requests/labels/Needs%20More%20Information", "name": "Needs More Information", "color": "fef2c0", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2017-11-27T10:39:30Z", "updated_at": "2021-09-08T05:00:52Z", "closed_at": "2017-11-27T21:52:45Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Hi All,\r\n\r\nI'm trying to debug why sometimes my requests fail (Doing some perf test through `locust.io`) but I can't find the cause. My nginx logs have no error attached and what I see is requests giving status code 0.\r\n\r\nI thought it could be timeout but I timed the request and I see <1sec.\r\n\r\nIs there a way for me to find out why I'm getting this behavior? \r\n\r\nI'm basically getting `status_code==0` but I can't find a reason to that.\r\n\r\nI'm using python 2.7 and locust to run the perf test", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/4401/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/4401/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/4362", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/4362/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/4362/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/4362/events", "html_url": "https://github.com/psf/requests/issues/4362", "id": 269952391, "node_id": "MDU6SXNzdWUyNjk5NTIzOTE=", "number": 4362, "title": "Redirect resolved even though allow_redirects is set to False causing exception for unsupported connection adapter", "user": {"login": "fevertree", "id": 4640825, "node_id": "MDQ6VXNlcjQ2NDA4MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/4640825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fevertree", "html_url": "https://github.com/fevertree", "followers_url": "https://api.github.com/users/fevertree/followers", "following_url": "https://api.github.com/users/fevertree/following{/other_user}", "gists_url": "https://api.github.com/users/fevertree/gists{/gist_id}", "starred_url": "https://api.github.com/users/fevertree/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fevertree/subscriptions", "organizations_url": "https://api.github.com/users/fevertree/orgs", "repos_url": "https://api.github.com/users/fevertree/repos", "events_url": "https://api.github.com/users/fevertree/events{/privacy}", "received_events_url": "https://api.github.com/users/fevertree/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": {"login": "kennethreitz", "id": 119893, "node_id": "MDQ6VXNlcjExOTg5Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/119893?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennethreitz", "html_url": "https://github.com/kennethreitz", "followers_url": "https://api.github.com/users/kennethreitz/followers", "following_url": "https://api.github.com/users/kennethreitz/following{/other_user}", "gists_url": "https://api.github.com/users/kennethreitz/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennethreitz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennethreitz/subscriptions", "organizations_url": "https://api.github.com/users/kennethreitz/orgs", "repos_url": "https://api.github.com/users/kennethreitz/repos", "events_url": "https://api.github.com/users/kennethreitz/events{/privacy}", "received_events_url": "https://api.github.com/users/kennethreitz/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "kennethreitz", "id": 119893, "node_id": "MDQ6VXNlcjExOTg5Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/119893?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennethreitz", "html_url": "https://github.com/kennethreitz", "followers_url": "https://api.github.com/users/kennethreitz/followers", "following_url": "https://api.github.com/users/kennethreitz/following{/other_user}", "gists_url": "https://api.github.com/users/kennethreitz/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennethreitz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennethreitz/subscriptions", "organizations_url": "https://api.github.com/users/kennethreitz/orgs", "repos_url": "https://api.github.com/users/kennethreitz/repos", "events_url": "https://api.github.com/users/kennethreitz/events{/privacy}", "received_events_url": "https://api.github.com/users/kennethreitz/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2017-10-31T13:11:11Z", "updated_at": "2022-03-29T03:12:39Z", "closed_at": "2021-12-29T02:32:57Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "I'm currently mocking an API that is consumed by an Android application.\r\nOne of the API responses contains a redirect to a custom URL schema `app://` in the `Location` header\r\n\r\nSince I am not interested in my mocked API client in following the redirect (which would raise an InvalidSchema exception anyway), I have set `allow_redirects = False` on my session object. Although the redirect is not fired, it is still being resolved, causing an exception due to the missing url adapter.\r\n\r\n## Expected Result\r\nSince I'm not interested in the redirects being followed, it would make sense to not resolve the redirected request in the first place.\r\n\r\n## How to reproduce\r\n\r\n```python\r\nimport requests\r\n\r\nS = requests.session()\r\nS.allow_redirects = False\r\ndestination = https://somesite.example # URL with a redirect to a non-standard protocol\r\nS.get(url=destination)\r\n```\r\nResponse headers (example):\r\n```\r\nHTTP/1.1 302 Found\r\nServer: Apache-Coyote\r\nCache-Control: no-cache, no-store, max-age=0, must-revalidate\r\nPragma: no-cache\r\nExpires: 0\r\nStrict-Transport-Security: max-age=31536000 ; includeSubDomains\r\nLocation: app://api-test.somesite.example?q=example\r\nContent-Language: en\r\nContent-Length: 0\r\nDate: Tue, 31 Oct 2017 12:39:17 GMT\r\nConnection: close\r\n```\r\n\r\nException thrown by code:\r\n```\r\nTraceback (most recent call last):\r\n  File \"example.py\", line 6, in <module>\r\n    S.get(url=destination)\r\nin get\r\n    return self.request('GET', url, **kwargs)\r\n  File ~/.local/lib/python2.7/site-packages/requests/sessions.py\", line 518, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"~/.local/lib/python2.7/site-packages/requests/sessions.py\", line 661, in send\r\n    history = [resp for resp in gen] if allow_redirects else []\r\n  File \"~/.local/lib/python2.7/site-packages/requests/sessions.py\", line 214, in resolve_redirects\r\n    **adapter_kwargs\r\n  File \"~/.local/lib/python2.7/site-packages/requests/sessions.py\", line 633, in send\r\n    adapter = self.get_adapter(url=request.url)\r\n  File \"~/.local/lib/python2.7/site-packages/requests/sessions.py\", line 717, in get_adapter\r\n    raise InvalidSchema(\"No connection adapters were found for '%s'\" % url)\r\nrequests.exceptions.InvalidSchema: No connection adapters were found for 'app://api-test.somesite.com?q=example'\r\n\r\n```\r\n\r\n## Actual Result\r\nInvalidSchema exception", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/4362/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/4362/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/4275", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/4275/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/4275/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/4275/events", "html_url": "https://github.com/psf/requests/issues/4275", "id": 255227171, "node_id": "MDU6SXNzdWUyNTUyMjcxNzE=", "number": 4275, "title": "Requests tries to resolve `user:pass@host` on OS X", "user": {"login": "mattbennett", "id": 107611, "node_id": "MDQ6VXNlcjEwNzYxMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/107611?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mattbennett", "html_url": "https://github.com/mattbennett", "followers_url": "https://api.github.com/users/mattbennett/followers", "following_url": "https://api.github.com/users/mattbennett/following{/other_user}", "gists_url": "https://api.github.com/users/mattbennett/gists{/gist_id}", "starred_url": "https://api.github.com/users/mattbennett/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mattbennett/subscriptions", "organizations_url": "https://api.github.com/users/mattbennett/orgs", "repos_url": "https://api.github.com/users/mattbennett/repos", "events_url": "https://api.github.com/users/mattbennett/events{/privacy}", "received_events_url": "https://api.github.com/users/mattbennett/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 773540467, "node_id": "MDU6TGFiZWw3NzM1NDA0Njc=", "url": "https://api.github.com/repos/psf/requests/labels/PR(s)%20Wanted", "name": "PR(s) Wanted", "color": "69ccdb", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-09-05T10:13:27Z", "updated_at": "2021-09-08T04:00:51Z", "closed_at": "2018-01-16T14:07:27Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "If you have proxy bypass settings, requests tries to resolve the hostname before stripping credentials from the URL.\r\n\r\nIt looks like this happens because the [proxy bypass](https://github.com/requests/requests/blob/4bda7b66e7ece5be51b459edd046a70915b4792c/requests/utils.py#L78) logic is called before [urldefragauth](https://github.com/requests/requests/blob/b9638ec7be9134786e28684ca17f3d161297ac5e/requests/utils.py#L879) strips the credentials from the URL.\r\n\r\n## Expected Result\r\n\r\nShould not try to resolve an invalid hostname.\r\n\r\n## Actual Result\r\n\r\nDNS resolution for `user:pass@host` is made:\r\n\r\n![screenshot 2017-09-05 11 04 11](https://user-images.githubusercontent.com/107611/30056277-0279af7a-922a-11e7-9223-ef66b5bd2af6.png)\r\n\r\n## Reproduction Steps\r\n\r\nOn OS X with proxy bypass hosts configured:\r\n\r\n![screenshot 2017-09-04 18 08 46](https://user-images.githubusercontent.com/107611/30056416-864198b8-922a-11e7-9448-f2e702c95927.png)\r\n\r\n\r\n```python\r\nimport requests\r\nrequests.get('http://user:pass@localhost')\r\n```\r\n\r\n## System Information\r\n\r\n    $ python -m requests.help\r\n\r\n```\r\n{\r\n  \"chardet\": {\r\n    \"version\": \"3.0.4\"\r\n  },\r\n  \"cryptography\": {\r\n    \"version\": \"\"\r\n  },\r\n  \"idna\": {\r\n    \"version\": \"2.6\"\r\n  },\r\n  \"implementation\": {\r\n    \"name\": \"CPython\",\r\n    \"version\": \"2.7.10\"\r\n  },\r\n  \"platform\": {\r\n    \"release\": \"15.6.0\",\r\n    \"system\": \"Darwin\"\r\n  },\r\n  \"pyOpenSSL\": {\r\n    \"openssl_version\": \"\",\r\n    \"version\": null\r\n  },\r\n  \"requests\": {\r\n    \"version\": \"2.18.4\"\r\n  },\r\n  \"system_ssl\": {\r\n    \"version\": \"100020cf\"\r\n  },\r\n  \"urllib3\": {\r\n    \"version\": \"1.22\"\r\n  },\r\n  \"using_pyopenssl\": false\r\n}\r\n```", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/4275/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/4275/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/4030", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/4030/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/4030/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/4030/events", "html_url": "https://github.com/psf/requests/issues/4030", "id": 229375476, "node_id": "MDU6SXNzdWUyMjkzNzU0NzY=", "number": 4030, "title": "fix pypi page", "user": {"login": "kennethreitz", "id": 119893, "node_id": "MDQ6VXNlcjExOTg5Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/119893?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennethreitz", "html_url": "https://github.com/kennethreitz", "followers_url": "https://api.github.com/users/kennethreitz/followers", "following_url": "https://api.github.com/users/kennethreitz/following{/other_user}", "gists_url": "https://api.github.com/users/kennethreitz/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennethreitz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennethreitz/subscriptions", "organizations_url": "https://api.github.com/users/kennethreitz/orgs", "repos_url": "https://api.github.com/users/kennethreitz/repos", "events_url": "https://api.github.com/users/kennethreitz/events{/privacy}", "received_events_url": "https://api.github.com/users/kennethreitz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 117745, "node_id": "MDU6TGFiZWwxMTc3NDU=", "url": "https://api.github.com/repos/psf/requests/labels/Planned", "name": "Planned", "color": "e102d8", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}, {"id": 136616769, "node_id": "MDU6TGFiZWwxMzY2MTY3Njk=", "url": "https://api.github.com/repos/psf/requests/labels/Documentation", "name": "Documentation", "color": "fad8c7", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-05-17T14:38:38Z", "updated_at": "2021-09-08T10:00:47Z", "closed_at": "2017-05-18T01:41:01Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "markup is bad \r\n\r\nhttps://pypi.python.org/pypi/requests/", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/4030/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/4030/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/3696", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/3696/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/3696/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/3696/events", "html_url": "https://github.com/psf/requests/issues/3696", "id": 189751036, "node_id": "MDU6SXNzdWUxODk3NTEwMzY=", "number": 3696, "title": "A whitespace at the start of Url causes error on request", "user": {"login": "hussaintamboli", "id": 2324958, "node_id": "MDQ6VXNlcjIzMjQ5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/2324958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hussaintamboli", "html_url": "https://github.com/hussaintamboli", "followers_url": "https://api.github.com/users/hussaintamboli/followers", "following_url": "https://api.github.com/users/hussaintamboli/following{/other_user}", "gists_url": "https://api.github.com/users/hussaintamboli/gists{/gist_id}", "starred_url": "https://api.github.com/users/hussaintamboli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hussaintamboli/subscriptions", "organizations_url": "https://api.github.com/users/hussaintamboli/orgs", "repos_url": "https://api.github.com/users/hussaintamboli/repos", "events_url": "https://api.github.com/users/hussaintamboli/events{/privacy}", "received_events_url": "https://api.github.com/users/hussaintamboli/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2016-11-16T16:05:10Z", "updated_at": "2021-09-08T14:00:34Z", "closed_at": "2016-11-16T18:38:12Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "    In [1]: import requests\r\n\r\n    In [2]: requests.get(\"http://stackoverflow.com/\")\r\n    Out[2]: <Response [200]>\r\n\r\n    In [3]: requests.get(\" http://stackoverflow.com/\")\r\n    # ... stacktrace skipped ...\r\n    InvalidSchema: No connection adapters were found for ' http://stackoverflow.com/'\r\n\r\nUrl should have been stripped. But I may be missing something here.", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/3696/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/3696/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/3689", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/3689/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/3689/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/3689/events", "html_url": "https://github.com/psf/requests/issues/3689", "id": 189553499, "node_id": "MDU6SXNzdWUxODk1NTM0OTk=", "number": 3689, "title": "security extras need to be updated", "user": {"login": "bmw", "id": 6504915, "node_id": "MDQ6VXNlcjY1MDQ5MTU=", "avatar_url": "https://avatars.githubusercontent.com/u/6504915?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bmw", "html_url": "https://github.com/bmw", "followers_url": "https://api.github.com/users/bmw/followers", "following_url": "https://api.github.com/users/bmw/following{/other_user}", "gists_url": "https://api.github.com/users/bmw/gists{/gist_id}", "starred_url": "https://api.github.com/users/bmw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bmw/subscriptions", "organizations_url": "https://api.github.com/users/bmw/orgs", "repos_url": "https://api.github.com/users/bmw/repos", "events_url": "https://api.github.com/users/bmw/events{/privacy}", "received_events_url": "https://api.github.com/users/bmw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-11-16T01:03:01Z", "updated_at": "2021-09-08T14:00:35Z", "closed_at": "2016-11-16T10:33:47Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Starting with `urllib3` 1.17, `ndg-httpsclient` and `pyasn1` are no longer required to inject `pyopenssl` into `urllib3`. `cryptography` and `idna` are required instead. The result of this is if an older version of `pyopenssl` is installed and you run `pip install requests[security]`, you will see import errors when trying to inject `pyopenssl`.", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/3689/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/3689/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/3683", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/3683/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/3683/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/3683/events", "html_url": "https://github.com/psf/requests/issues/3683", "id": 189411935, "node_id": "MDU6SXNzdWUxODk0MTE5MzU=", "number": 3683, "title": "URL has an invalid label.", "user": {"login": "MikeVL", "id": 118285, "node_id": "MDQ6VXNlcjExODI4NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/118285?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MikeVL", "html_url": "https://github.com/MikeVL", "followers_url": "https://api.github.com/users/MikeVL/followers", "following_url": "https://api.github.com/users/MikeVL/following{/other_user}", "gists_url": "https://api.github.com/users/MikeVL/gists{/gist_id}", "starred_url": "https://api.github.com/users/MikeVL/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MikeVL/subscriptions", "organizations_url": "https://api.github.com/users/MikeVL/orgs", "repos_url": "https://api.github.com/users/MikeVL/repos", "events_url": "https://api.github.com/users/MikeVL/events{/privacy}", "received_events_url": "https://api.github.com/users/MikeVL/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 29, "created_at": "2016-11-15T14:50:57Z", "updated_at": "2016-11-30T15:07:22Z", "closed_at": "2016-11-30T15:07:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "requests v2.12.0\r\n```python\r\n>>> import requests\r\n>>> requests.get('http://vluki_develop_624_solr:8983/solr/vluki')\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/usr/local/lib/python2.7/dist-packages/requests/api.py\", line 70, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/requests/api.py\", line 56, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/requests/sessions.py\", line 474, in request\r\n    prep = self.prepare_request(req)\r\n  File \"/usr/local/lib/python2.7/dist-packages/requests/sessions.py\", line 407, in prepare_request\r\n    hooks=merge_hooks(request.hooks, self.hooks),\r\n  File \"/usr/local/lib/python2.7/dist-packages/requests/models.py\", line 302, in prepare\r\n    self.prepare_url(url, params)\r\n  File \"/usr/local/lib/python2.7/dist-packages/requests/models.py\", line 372, in prepare_url\r\n    raise InvalidURL('URL has an invalid label.')\r\nrequests.exceptions.InvalidURL: URL has an invalid label.\r\n```", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/3683/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/3683/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/3597", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/3597/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/3597/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/3597/events", "html_url": "https://github.com/psf/requests/issues/3597", "id": 179070635, "node_id": "MDU6SXNzdWUxNzkwNzA2MzU=", "number": 3597, "title": "TypeError in MockRequest when 'Host' header set to bytestring", "user": {"login": "bbamsch", "id": 5546456, "node_id": "MDQ6VXNlcjU1NDY0NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/5546456?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bbamsch", "html_url": "https://github.com/bbamsch", "followers_url": "https://api.github.com/users/bbamsch/followers", "following_url": "https://api.github.com/users/bbamsch/following{/other_user}", "gists_url": "https://api.github.com/users/bbamsch/gists{/gist_id}", "starred_url": "https://api.github.com/users/bbamsch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bbamsch/subscriptions", "organizations_url": "https://api.github.com/users/bbamsch/orgs", "repos_url": "https://api.github.com/users/bbamsch/repos", "events_url": "https://api.github.com/users/bbamsch/events{/privacy}", "received_events_url": "https://api.github.com/users/bbamsch/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-09-25T06:04:14Z", "updated_at": "2021-09-08T15:00:43Z", "closed_at": "2016-09-29T07:09:41Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "Issue is specific to Python3\n\nAn incorrect assumption is made in requests.cookies.MockRequest on Python3, [see here](https://github.com/kennethreitz/requests/blob/master/requests/cookies.py#L52):\n\n```\nclass MockRequest(object):\n    ...\n    def get_full_url(self):\n        # Only return the response's URL if the user hadn't set the Host\n        # header\n        if not self._r.headers.get('Host'):\n            return self._r.url\n        # If they did set it, retrieve it and reconstruct the expected domain\n        host = self._r.headers['Host']\n        parsed = urlparse(self._r.url)\n        # Reconstruct the URL as we expect it\n        return urlunparse([\n            parsed.scheme, host, parsed.path, parsed.params, parsed.query,\n            parsed.fragment\n        ])\n    ...\n```\n\nIn Python2 this works fine where str and unicode objects are allowed interchangeably in urlunparse.\n\nIn Python3 this is an issue because `host = self._r.headers['Host']` may return a bytestring and `parsed = urlparse(self._r.url)` returns a ParseResult with str objects. Combining these two causes urlunparse to throw a fit.\n\nSteps to reproduce:\n\n```\n>>> import requests\n>>> a = requests.Request('GET', 'http://www.google.com', headers={'Host': b'www.google.com'})\n>>> b = requests.cookies.MockRequest(a)\n>>> b.get_full_url()\n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/3597/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/3597/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/3578", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/3578/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/3578/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/3578/events", "html_url": "https://github.com/psf/requests/issues/3578", "id": 177534940, "node_id": "MDU6SXNzdWUxNzc1MzQ5NDA=", "number": 3578, "title": "\"LookupError: unknown encoding: idna\" in worker threads, under embedded Python 3.5", "user": {"login": "carsonyl", "id": 46059, "node_id": "MDQ6VXNlcjQ2MDU5", "avatar_url": "https://avatars.githubusercontent.com/u/46059?v=4", "gravatar_id": "", "url": "https://api.github.com/users/carsonyl", "html_url": "https://github.com/carsonyl", "followers_url": "https://api.github.com/users/carsonyl/followers", "following_url": "https://api.github.com/users/carsonyl/following{/other_user}", "gists_url": "https://api.github.com/users/carsonyl/gists{/gist_id}", "starred_url": "https://api.github.com/users/carsonyl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/carsonyl/subscriptions", "organizations_url": "https://api.github.com/users/carsonyl/orgs", "repos_url": "https://api.github.com/users/carsonyl/repos", "events_url": "https://api.github.com/users/carsonyl/events{/privacy}", "received_events_url": "https://api.github.com/users/carsonyl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2016-09-16T22:43:02Z", "updated_at": "2021-09-08T15:00:46Z", "closed_at": "2016-09-17T07:19:01Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "The following snippet raises an exception on Windows, using the [embedded distribution of Python 3.5.2 x64](https://www.python.org/downloads/release/python-352/):\n\n``` python\nfrom concurrent.futures import ThreadPoolExecutor\nimport requests\ndef task(_):\n    return requests.get(\"https://example.org\").reason\n\nexecutor = ThreadPoolExecutor(max_workers=2)\nfor x in executor.map(task, [(1,), (1,),]):\n    print(x)\n```\n\n```\nOK\nTraceback (most recent call last):\n  File \"repro.py\", line 7, in <module>\n    for x in executor.map(task, [(1,), (1,),]):\n  File \"concurrent\\futures\\_base.py\", line 556, in result_iterator\n  File \"concurrent\\futures\\_base.py\", line 398, in result\n  File \"concurrent\\futures\\_base.py\", line 357, in __get_result\n  File \"concurrent\\futures\\thread.py\", line 55, in run\n  File \"repro.py\", line 4, in task\n    return requests.get(\"https://example.org\").reason\n  File \"K:\\PR\\pybug\\requests\\api.py\", line 70, in get\n    return request('get', url, params=params, **kwargs)\n  File \"K:\\PR\\pybug\\requests\\api.py\", line 56, in request\n    return session.request(method=method, url=url, **kwargs)\n  File \"K:\\PR\\pybug\\requests\\sessions.py\", line 461, in request\n    prep = self.prepare_request(req)\n  File \"K:\\PR\\pybug\\requests\\sessions.py\", line 394, in prepare_request\n    hooks=merge_hooks(request.hooks, self.hooks),\n  File \"K:\\PR\\pybug\\requests\\models.py\", line 294, in prepare\n    self.prepare_url(url, params)\n  File \"K:\\PR\\pybug\\requests\\models.py\", line 361, in prepare_url\n    host = host.encode('idna').decode('utf-8')\nLookupError: unknown encoding: idna\n```\n\nThis problem seems specific to the standard library being inside a zip file in the embedded distribution, as I couldn't reproduce this in regular distributions, or when Python35.zip is extracted out to Lib.\n\n`import encodings.idna` succeeds. Doing this in the main thread prior to launching the workers will avoid this problem, as per http://stackoverflow.com/a/13057751. Though it looks like the `str.encode()` call is the culprit, changing my task function to be `'foo'.encode('idna')` doesn't trigger the exception.\n\nI've tested this using Requests 2.10.0 and 2.11.1. This is also reproducible using `multiprocessing.pool.ThreadPool`.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/3578/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/3578/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/3563", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/3563/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/3563/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/3563/events", "html_url": "https://github.com/psf/requests/pull/3563", "id": 175831728, "node_id": "MDExOlB1bGxSZXF1ZXN0ODQ1MzE3OTQ=", "number": 3563, "title": "use enforce_content_length in Requests", "user": {"login": "nateprewitt", "id": 5271761, "node_id": "MDQ6VXNlcjUyNzE3NjE=", "avatar_url": "https://avatars.githubusercontent.com/u/5271761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nateprewitt", "html_url": "https://github.com/nateprewitt", "followers_url": "https://api.github.com/users/nateprewitt/followers", "following_url": "https://api.github.com/users/nateprewitt/following{/other_user}", "gists_url": "https://api.github.com/users/nateprewitt/gists{/gist_id}", "starred_url": "https://api.github.com/users/nateprewitt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nateprewitt/subscriptions", "organizations_url": "https://api.github.com/users/nateprewitt/orgs", "repos_url": "https://api.github.com/users/nateprewitt/repos", "events_url": "https://api.github.com/users/nateprewitt/events{/privacy}", "received_events_url": "https://api.github.com/users/nateprewitt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2016-09-08T18:45:28Z", "updated_at": "2021-09-08T01:21:41Z", "closed_at": "2016-11-16T13:29:51Z", "author_association": "MEMBER", "active_lock_reason": "resolved", "draft": false, "pull_request": {"url": "https://api.github.com/repos/psf/requests/pulls/3563", "html_url": "https://github.com/psf/requests/pull/3563", "diff_url": "https://github.com/psf/requests/pull/3563.diff", "patch_url": "https://github.com/psf/requests/pull/3563.patch", "merged_at": "2016-11-16T13:29:51Z"}, "body": "This is a **DO NOT MERGE** until we bring urllib3 1.17 into the Requests `proposed/3.0.0` branch, which should likely happen before 3.0.0 gets out the door.\n\nThis is the final step for the work in shazow/urllib3#949 and addresses the issues originally raised in shazow/urllib3#723 and #2833.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/3563/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/3563/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/psf/requests/issues/3518", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/3518/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/3518/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/3518/events", "html_url": "https://github.com/psf/requests/issues/3518", "id": 171640949, "node_id": "MDU6SXNzdWUxNzE2NDA5NDk=", "number": 3518, "title": "ALL_PROXY is incorrectly preferred to HTTP(S)_PROXY", "user": {"login": "Lukasa", "id": 1382556, "node_id": "MDQ6VXNlcjEzODI1NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1382556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lukasa", "html_url": "https://github.com/Lukasa", "followers_url": "https://api.github.com/users/Lukasa/followers", "following_url": "https://api.github.com/users/Lukasa/following{/other_user}", "gists_url": "https://api.github.com/users/Lukasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lukasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lukasa/subscriptions", "organizations_url": "https://api.github.com/users/Lukasa/orgs", "repos_url": "https://api.github.com/users/Lukasa/repos", "events_url": "https://api.github.com/users/Lukasa/events{/privacy}", "received_events_url": "https://api.github.com/users/Lukasa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-08-17T12:04:32Z", "updated_at": "2021-09-08T16:00:25Z", "closed_at": "2016-08-25T12:45:16Z", "author_association": "MEMBER", "active_lock_reason": "resolved", "body": "Related to #3516.\n\nWe should aim to use HTTP(S)_PROXY in priority to ALL_PROXY. Generally speaking, more specific proxy settings should be preferred to less-specific ones.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/3518/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/3518/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/3490", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/3490/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/3490/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/3490/events", "html_url": "https://github.com/psf/requests/issues/3490", "id": 170236238, "node_id": "MDU6SXNzdWUxNzAyMzYyMzg=", "number": 3490, "title": "Remove header in middle of redirection", "user": {"login": "saveman71", "id": 1615426, "node_id": "MDQ6VXNlcjE2MTU0MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1615426?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saveman71", "html_url": "https://github.com/saveman71", "followers_url": "https://api.github.com/users/saveman71/followers", "following_url": "https://api.github.com/users/saveman71/following{/other_user}", "gists_url": "https://api.github.com/users/saveman71/gists{/gist_id}", "starred_url": "https://api.github.com/users/saveman71/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saveman71/subscriptions", "organizations_url": "https://api.github.com/users/saveman71/orgs", "repos_url": "https://api.github.com/users/saveman71/repos", "events_url": "https://api.github.com/users/saveman71/events{/privacy}", "received_events_url": "https://api.github.com/users/saveman71/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2016-08-09T18:24:05Z", "updated_at": "2021-09-08T16:00:30Z", "closed_at": "2016-08-12T19:57:40Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Hey there,\n\nI'm having a pretty specific issue while trying to reproduce the login sequence of a heavy professional website (lots of redirect / cookies involved).\nThe login sequence was tested working on Chrome.\n\nI spent some time debugging and finally tracked down the issue, that is that the server will not accept the `Content-Type` header that was required on the first request on the first redirect, thus making the second request crash with a `500`.\n\nFirst request shown in Chrome's dev inspector:\n![screenshot from 2016-08-09 20-03-26](https://cloud.githubusercontent.com/assets/1615426/17528006/dec4dfe6-5e6d-11e6-8e67-9af08aa62426.png)\n\nSecond request (first redirect) show in Chrome's dev inspector:\n![screenshot from 2016-08-09 20-15-02](https://cloud.githubusercontent.com/assets/1615426/17528125/5dee5aea-5e6e-11e6-8030-be6a37f4df0a.png)\n\nNotice of how on the second request, no `Content-Type` header. The presence of a `Content-Type` header would make the request fail.\n\nThe code (URLs are mangled):\n\n``` python\n#!/usr/bin/env python\n\nimport requests\nimport urllib.parse\n\nheaders = {\n    'Origin': 'https://www.example.com',\n    'Accept-Encoding': 'gzip, deflate, br',\n    'Accept-Language': 'en-US,en;q=0.8,fr-FR;q=0.6,fr;q=0.4',\n    'Upgrade-Insecure-Requests': '1',\n    'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.82 Safari/537.36',\n    'Content-Type': 'application/x-www-form-urlencoded',\n    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',\n    'Cache-Control': 'max-age=0',\n    'Referer': 'https://www.example.com/',\n    'Connection': 'keep-alive',\n}\n\ndata = 'some_data'\n\ns = requests.Session()\n\nr = s.post('https://www.exampleonanotherdomain.com/openam/UI/Login?realm=front_office&service=EEService&goto=https://www.exampleonanotherdomain.com/ice/rest/aiguillagemp/redirect?dest=',\n           headers=headers, data=data)\n```\n\nI worked it around by removing the `Content-Type` header at runtime on the 3rd send (first is the first request header, 2nd is the first request data) to confirm that it was the issue (it was!) \n\nPatch code added before the request.\n\n``` python\nimport http.client as http_client\n\ndef patch():\n    old_send = http_client.HTTPConnection.send\n    def new_send( self, data ):\n        print(data.decode('utf-8'))\n        if new_send.i == 2:\n            data = '\\n'.join([l for l in data.decode('utf-8').split('\\n') if not l.startswith('Content-Type:')]).encode('utf-8')\n        print(data.decode('utf-8'))\n        new_send.i += 1\n        return old_send(self, data)\n    new_send.i = 0\n    http_client.HTTPConnection.send = new_send\n    old_read = http_client.HTTPResponse.read\n    def new_read( self , amt):\n        data = old_read(self, amt)\n        print(data)\n        return data\n    http_client.HTTPResponse.read = new_read\n\npatch()\n```\n\nAny idea of how to solve this one?\n\nNote: I have no control at all of the remote server.\nNote: I intend to make a lot of requests while being logged in, so the I would like to stay with a session.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/3490/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/3490/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/3481", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/3481/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/3481/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/3481/events", "html_url": "https://github.com/psf/requests/issues/3481", "id": 170104204, "node_id": "MDU6SXNzdWUxNzAxMDQyMDQ=", "number": 3481, "title": "Error with decode_unicode=True on streamed response", "user": {"login": "jone", "id": 7469, "node_id": "MDQ6VXNlcjc0Njk=", "avatar_url": "https://avatars.githubusercontent.com/u/7469?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jone", "html_url": "https://github.com/jone", "followers_url": "https://api.github.com/users/jone/followers", "following_url": "https://api.github.com/users/jone/following{/other_user}", "gists_url": "https://api.github.com/users/jone/gists{/gist_id}", "starred_url": "https://api.github.com/users/jone/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jone/subscriptions", "organizations_url": "https://api.github.com/users/jone/orgs", "repos_url": "https://api.github.com/users/jone/repos", "events_url": "https://api.github.com/users/jone/events{/privacy}", "received_events_url": "https://api.github.com/users/jone/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2016-08-09T07:58:53Z", "updated_at": "2021-09-08T15:00:51Z", "closed_at": "2016-09-11T09:11:16Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "With `requests==2.11.0` I get `AttributeError: 'NoneType' object has no attribute 'readline'` when trying to use `iter_lines` with `decode_unicode=True` on a streamed response.\n\n``` sh\n$ ./bin/pip freeze\nrequests==2.11.0\nwsgiref==0.1.2\n```\n\n``` python\nfrom contextlib import closing\nimport requests\n\n\nwith closing(requests.get('http://httpbin.org/stream/20', stream=True)) as response:\n    for line in response.iter_lines(chunk_size=30, decode_unicode=True):\n        print line\n```\n\n``` python\n$ ./bin/python case.py\n\nTraceback (most recent call last):\n  File \"case.py\", line 6, in <module>\n    for line in response.iter_lines(chunk_size=30, decode_unicode=True):\n  File \"/Users/jone/temp/requests-stream/lib/python2.7/site-packages/requests/models.py\", line 720, in iter_lines\n    for chunk in self.iter_content(chunk_size=chunk_size, decode_unicode=decode_unicode):\n  File \"/Users/jone/temp/requests-stream/lib/python2.7/site-packages/requests/utils.py\", line 374, in stream_decode_response_unicode\n    for chunk in iterator:\n  File \"/Users/jone/temp/requests-stream/lib/python2.7/site-packages/requests/models.py\", line 676, in generate\n    for chunk in self.raw.stream(chunk_size, decode_content=True):\n  File \"/Users/jone/temp/requests-stream/lib/python2.7/site-packages/requests/packages/urllib3/response.py\", line 353, in stream\n    for line in self.read_chunked(amt, decode_content=decode_content):\n  File \"/Users/jone/temp/requests-stream/lib/python2.7/site-packages/requests/packages/urllib3/response.py\", line 521, in read_chunked\n    line = self._fp.fp.readline()\nAttributeError: 'NoneType' object has no attribute 'readline'\n```\n\nWhen removing either `stream=True` or `decode_unicode=True` the script works well.\n\nThis issue may be related to #3174.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/3481/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/3481/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/3359", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/3359/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/3359/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/3359/events", "html_url": "https://github.com/psf/requests/issues/3359", "id": 161568785, "node_id": "MDU6SXNzdWUxNjE1Njg3ODU=", "number": 3359, "title": "Uncertain about content/text vs iter_content(decode_unicode=True/False)", "user": {"login": "mikepelley", "id": 48527, "node_id": "MDQ6VXNlcjQ4NTI3", "avatar_url": "https://avatars.githubusercontent.com/u/48527?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mikepelley", "html_url": "https://github.com/mikepelley", "followers_url": "https://api.github.com/users/mikepelley/followers", "following_url": "https://api.github.com/users/mikepelley/following{/other_user}", "gists_url": "https://api.github.com/users/mikepelley/gists{/gist_id}", "starred_url": "https://api.github.com/users/mikepelley/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mikepelley/subscriptions", "organizations_url": "https://api.github.com/users/mikepelley/orgs", "repos_url": "https://api.github.com/users/mikepelley/repos", "events_url": "https://api.github.com/users/mikepelley/events{/privacy}", "received_events_url": "https://api.github.com/users/mikepelley/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 15, "created_at": "2016-06-22T00:19:56Z", "updated_at": "2021-09-08T14:00:38Z", "closed_at": "2016-09-24T17:01:11Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "When requesting an application/json document, I'm seeing `next(r.iter_content(16*1024, decode_unicode=True))` returning bytes, whereas `r.text` returns unicode. My understanding was that both should return a unicode object. In essence, I thought \"iter_content\" was equivalent to \"iter_text\" when decode_unicode was True. Have I misunderstood something? I can provide an example if needed.\n\nFor reference, I'm using python 3.5.1 and requests 2.10.0.\n\nThanks!\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/3359/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/3359/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/3090", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/3090/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/3090/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/3090/events", "html_url": "https://github.com/psf/requests/issues/3090", "id": 148079336, "node_id": "MDU6SXNzdWUxNDgwNzkzMzY=", "number": 3090, "title": "Session.close() doesn't work with proxies", "user": {"login": "bodgit", "id": 559268, "node_id": "MDQ6VXNlcjU1OTI2OA==", "avatar_url": "https://avatars.githubusercontent.com/u/559268?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bodgit", "html_url": "https://github.com/bodgit", "followers_url": "https://api.github.com/users/bodgit/followers", "following_url": "https://api.github.com/users/bodgit/following{/other_user}", "gists_url": "https://api.github.com/users/bodgit/gists{/gist_id}", "starred_url": "https://api.github.com/users/bodgit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bodgit/subscriptions", "organizations_url": "https://api.github.com/users/bodgit/orgs", "repos_url": "https://api.github.com/users/bodgit/repos", "events_url": "https://api.github.com/users/bodgit/events{/privacy}", "received_events_url": "https://api.github.com/users/bodgit/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2016-04-13T14:29:33Z", "updated_at": "2021-09-08T18:00:57Z", "closed_at": "2016-04-15T13:36:43Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "I have an upstream server that supports both basic authentication and SSL client certificates for authenticating a client.\n\nI have the following contrived requests client (with a session object) that hits the upstream server using basic auth and then switches to using SSL client certificates and repeats the request:\n\n``` python\n#!/usr/bin/env python\n\nimport requests\n\nsession = requests.Session()\nsession.verify = './cacert.pem'\nsession.auth = ('bob', 'password')\n\nresponse = session.get('https://1.2.3.4/')\n\nsession.auth = None\nsession.cert = ('./cert.pem', './key.pem')\nsession.close()\n\nresponse = session.get('https://1.2.3.4/')\n```\n\nBecause the client certificates need to be presented at the beginning of the connection I use `session.close()` to tear down any active connections before attempting the second request. If I don't do this, the session connection pooling kicks in and reuses the existing connection from the first request which won't have presented any certificates and so the second request is unauthorised.\n\nThis is all understood however I then had a need for the client to access the server through a proxy so the code is updated to just add the proxy configuration:\n\n``` python\n#!/usr/bin/env python\n\nimport requests\n\nsession = requests.Session()\nsession.verify = False\nsession.auth = ('bob', 'password')\n\nsession.proxies = {\n  'https': 'http://alice:secret@5.6.7.8:3128/',\n}\n\nresponse = session.get('https://1.2.3.4/')\n\nsession.auth = None\nsession.cert = ('./cert.pem', './key.pem')\nsession.close()\n\nresponse = session.get('https://1.2.3.4/')\n```\n\nNow the second request is unauthorised; `session.close()` seems to have no effect and doesn't tear down the connections through the proxy; there are no TCP FIN packets initiated from the client which I do see when no proxy is used.\n\nThe upstream server has keepalives enabled so if I add a sleep for longer than the idle timeout then the server terminates the connection between itself and the proxy, then the proxy terminates the connection to the client and then the second request is successful.\n\nI appreciate this is probably a corner case but any ideas here? I would expect `session.close()` to correctly tear down the connections to the proxy. I've reproduced this against version 2.9.1.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/3090/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/3090/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/3068", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/3068/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/3068/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/3068/events", "html_url": "https://github.com/psf/requests/issues/3068", "id": 143847469, "node_id": "MDU6SXNzdWUxNDM4NDc0Njk=", "number": 3068, "title": "Response read hangs", "user": {"login": "medecau", "id": 59870, "node_id": "MDQ6VXNlcjU5ODcw", "avatar_url": "https://avatars.githubusercontent.com/u/59870?v=4", "gravatar_id": "", "url": "https://api.github.com/users/medecau", "html_url": "https://github.com/medecau", "followers_url": "https://api.github.com/users/medecau/followers", "following_url": "https://api.github.com/users/medecau/following{/other_user}", "gists_url": "https://api.github.com/users/medecau/gists{/gist_id}", "starred_url": "https://api.github.com/users/medecau/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/medecau/subscriptions", "organizations_url": "https://api.github.com/users/medecau/orgs", "repos_url": "https://api.github.com/users/medecau/repos", "events_url": "https://api.github.com/users/medecau/events{/privacy}", "received_events_url": "https://api.github.com/users/medecau/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2016-03-27T20:57:08Z", "updated_at": "2021-09-08T19:00:26Z", "closed_at": "2016-03-28T15:35:07Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "python 2.7.11\nrequests installed from pip and up-to-date\n\nURL -> 'http://archive.mid.ru/bdomp/zu_r.nsf/strawebeng!OpenView'\n\nGET request hangs at read time.\nI tried to use `stream=True` and then read from `response.raw` and it works. But doesn't finish on normal usage.\n\nI looked at the headers and the `Content-Length` is duplicated.\nWhen I try to read it from `response.headers['Content-Length']` I find a single string: `'133172, 133172'`.\nThe length is correct otherwise.\n\nI am not entirely sure of what's causing this but my guess is that requests is getting confused by the duplicate header.\n\n_thanks for everything_\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/3068/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/3068/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/3066", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/3066/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/3066/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/3066/events", "html_url": "https://github.com/psf/requests/issues/3066", "id": 143481469, "node_id": "MDU6SXNzdWUxNDM0ODE0Njk=", "number": 3066, "title": "auth and data set results in invalid http header", "user": {"login": "julian-r", "id": 709223, "node_id": "MDQ6VXNlcjcwOTIyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/709223?v=4", "gravatar_id": "", "url": "https://api.github.com/users/julian-r", "html_url": "https://github.com/julian-r", "followers_url": "https://api.github.com/users/julian-r/followers", "following_url": "https://api.github.com/users/julian-r/following{/other_user}", "gists_url": "https://api.github.com/users/julian-r/gists{/gist_id}", "starred_url": "https://api.github.com/users/julian-r/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/julian-r/subscriptions", "organizations_url": "https://api.github.com/users/julian-r/orgs", "repos_url": "https://api.github.com/users/julian-r/repos", "events_url": "https://api.github.com/users/julian-r/events{/privacy}", "received_events_url": "https://api.github.com/users/julian-r/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2016-03-25T11:30:41Z", "updated_at": "2021-09-08T13:05:42Z", "closed_at": "2016-12-08T12:33:12Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "https://stackoverflow.com/questions/36216274/uploading-a-0-bytes-file-to-owncloud-with-python-requests-hangs/36217781#36217781\n\nWhen auth is set and a file object is passed to data, the header contains a content-length AND a Transfer-Encoding: chunked is set in the header and additionally the last chunk is not send.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/3066/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/3066/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/3028", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/3028/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/3028/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/3028/events", "html_url": "https://github.com/psf/requests/issues/3028", "id": 138167856, "node_id": "MDU6SXNzdWUxMzgxNjc4NTY=", "number": 3028, "title": "\"in\" operation on resp.cookies should not raise CookieConflictError", "user": {"login": "trilogysci", "id": 687131, "node_id": "MDQ6VXNlcjY4NzEzMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/687131?v=4", "gravatar_id": "", "url": "https://api.github.com/users/trilogysci", "html_url": "https://github.com/trilogysci", "followers_url": "https://api.github.com/users/trilogysci/followers", "following_url": "https://api.github.com/users/trilogysci/following{/other_user}", "gists_url": "https://api.github.com/users/trilogysci/gists{/gist_id}", "starred_url": "https://api.github.com/users/trilogysci/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/trilogysci/subscriptions", "organizations_url": "https://api.github.com/users/trilogysci/orgs", "repos_url": "https://api.github.com/users/trilogysci/repos", "events_url": "https://api.github.com/users/trilogysci/events{/privacy}", "received_events_url": "https://api.github.com/users/trilogysci/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-03-03T12:37:56Z", "updated_at": "2021-09-08T18:00:55Z", "closed_at": "2016-04-16T04:05:38Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Hosts which have the same cookie define for multiple domains should not raise \n\"CookieConflictError: There are multiple cookies with name,\"  when performing \"in\" \n It should short cut and return True immediately when found.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/3028/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/3028/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/3009", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/3009/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/3009/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/3009/events", "html_url": "https://github.com/psf/requests/issues/3009", "id": 133365559, "node_id": "MDU6SXNzdWUxMzMzNjU1NTk=", "number": 3009, "title": "Inspecting 'response.ok' with non-ascii HTTP status \"reason\" content causes UnicodeDecodeError", "user": {"login": "marmida", "id": 420896, "node_id": "MDQ6VXNlcjQyMDg5Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/420896?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marmida", "html_url": "https://github.com/marmida", "followers_url": "https://api.github.com/users/marmida/followers", "following_url": "https://api.github.com/users/marmida/following{/other_user}", "gists_url": "https://api.github.com/users/marmida/gists{/gist_id}", "starred_url": "https://api.github.com/users/marmida/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marmida/subscriptions", "organizations_url": "https://api.github.com/users/marmida/orgs", "repos_url": "https://api.github.com/users/marmida/repos", "events_url": "https://api.github.com/users/marmida/events{/privacy}", "received_events_url": "https://api.github.com/users/marmida/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2016-02-12T23:09:13Z", "updated_at": "2021-09-08T16:00:39Z", "closed_at": "2016-08-05T00:10:35Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Duplicate bug disclaimer: this is related to other Unicode + header issues, however, those all focus on errors raised while generating an outbound request. This applies only to inbound requests. (See also: #1082, #400, and to a lesser extent, #390, #409, #421, and #424; if this is already covered by another bug, sorry for bugging you guys. Thanks!)\n\nWhen inspecting responses with Unicode-encoded non-latin content trailing the HTTP status header in the response, requests raises UnicodeDecodeError.\n\n```\n(requests) marmida@loquat:~$ python\nPython 2.7.10 (default, Oct 14 2015, 16:09:02) \n[GCC 5.2.1 20151010] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import requests\n>>> resp = requests.get('http://jp.apps.gree.net/ja/1604')\n>>> resp.ok                                                                                                      \nTraceback (most recent call last):                                                                               \n  File \"<stdin>\", line 1, in <module>                                                                            \n  File \"/home/marmida/venvs/requests/local/lib/python2.7/site-packages/requests/models.py\", line 623, in ok      \n    self.raise_for_status()                                                                                      \n  File \"/home/marmida/venvs/requests/local/lib/python2.7/site-packages/requests/models.py\", line 837, in raise_for_status                                                                                                         \n    http_error_msg = '%s Server Error: %s for url: %s' % (self.status_code, self.reason, self.url)               \nUnicodeDecodeError: 'ascii' codec can't decode byte 0xe3 in position 23: ordinal not in range(128)\n```\n\nThe content causing the problem, fetched via curl:\n\n```\n$ curl -v 'http://jp.apps.gree.net/ja/1604' \n* Connected to jp.apps.gree.net (116.93.155.51) port 80 (#0)\n> GET /ja/1604 HTTP/1.1\n> Host: jp.apps.gree.net\n> User-Agent: curl/7.43.0\n> Accept: */*\n> \n< HTTP/1.1 503 AKB48\u30b9\u30c6\u30fc\u30b8\u30d5\u30a1\u30a4\u30bf\u30fc\n< Server: nginx\n```\n\nIn the stack trace above, formatting `http_error_msg` as a `string` won't work, because `self.reason` contains non-ascii `unicode`.\n\nRequests version: 2.9.1\nRun from a fresh virtualenv with only `requests` installed.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/3009/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/3009/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2998", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2998/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2998/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2998/events", "html_url": "https://github.com/psf/requests/issues/2998", "id": 131786503, "node_id": "MDU6SXNzdWUxMzE3ODY1MDM=", "number": 2998, "title": "Requests default to environment CA even when there's a session-set CA", "user": {"login": "jcmcken", "id": 1117819, "node_id": "MDQ6VXNlcjExMTc4MTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1117819?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jcmcken", "html_url": "https://github.com/jcmcken", "followers_url": "https://api.github.com/users/jcmcken/followers", "following_url": "https://api.github.com/users/jcmcken/following{/other_user}", "gists_url": "https://api.github.com/users/jcmcken/gists{/gist_id}", "starred_url": "https://api.github.com/users/jcmcken/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jcmcken/subscriptions", "organizations_url": "https://api.github.com/users/jcmcken/orgs", "repos_url": "https://api.github.com/users/jcmcken/repos", "events_url": "https://api.github.com/users/jcmcken/events{/privacy}", "received_events_url": "https://api.github.com/users/jcmcken/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2016-02-05T23:16:51Z", "updated_at": "2021-09-08T19:00:34Z", "closed_at": "2016-02-10T08:46:49Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "If I set a CA via an environment variable, such as:\n\n``` console\n$ export REQUESTS_CA_BUNDLE=/etc/pki/tls/certs/ca-bundle.crt\n```\n\n(Where the CA bundle actually does exist)\n\nAnd then I prepare a session like this:\n\n``` python\nimport requests\n\nsession = requests.Session()\nsession.verify = '/path/to/custom/ca.pem'\n```\n\n(Again, assume this 2nd CA path exists)\n\nExecuting a `session.get` against an HTTPS endpoint signed by the 2nd CA but not the first will result in an SSL verification error. This is because the request is defaulting to using the environment CA rather than the session CA. This sort of contradicts my expectations, where the session is much closer to the request in the stack than the process's environment.\n\nThe source of this issue is the merging happening here:\n\nhttps://github.com/kennethreitz/requests/blob/3a77b59df222920391359f052cab9319dda31ac7/requests/sessions.py#L625\n\n...where the conditional validates whether the verification is set at the request level (either `True` or `None`) before choosing to set the env CA, but doesn't look at the session (`self.verify`) (which likely has, and in my case does have, a more accurate CA setting).\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2998/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2998/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2997", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2997/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2997/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2997/events", "html_url": "https://github.com/psf/requests/issues/2997", "id": 131736140, "node_id": "MDU6SXNzdWUxMzE3MzYxNDA=", "number": 2997, "title": "allow_redirects=True for one get affects the next one", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2016-02-05T19:41:55Z", "updated_at": "2021-09-08T19:00:36Z", "closed_at": "2016-02-05T22:53:55Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Here is an example with 3 similar `get` calls with all allow_redirects=False:\n\n```\n$> PYTHONPATH=$PWD python -c \"import requests; url = 'http://127.0.0.1:45508/ds666'; sess = requests.Session(); print sess.get(url, allow_redirects=False); print sess.get(url, allow_redirects=False); print sess.get(url, allow_redirects=False)\"                                                                  \n<Response [301]>\n<Response [301]>\n<Response [301]>\n```\n\nall of them logically 301.  If 2nd one says to allow redirects, then 3rd would also succeed even if I disallow redirects for that invocation\n\n```\n$> PYTHONPATH=$PWD python -c \"import requests; url = 'http://127.0.0.1:45508/ds666'; sess = requests.Session(); print sess.get(url, allow_redirects=False); print sess.get(url, allow_redirects=True); print sess.get(url, allow_redirects=False)\"\n<Response [301]>\n<Response [200]>\n<Response [200]>\n```\n\nDemonstrated on\n\n```\nv2.9.1-63-g6143b7e\n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2997/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2997/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2949", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2949/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2949/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2949/events", "html_url": "https://github.com/psf/requests/issues/2949", "id": 124130987, "node_id": "MDU6SXNzdWUxMjQxMzA5ODc=", "number": 2949, "title": "Session's Authorization header isn't sent on redirect", "user": {"login": "jwineinger", "id": 287161, "node_id": "MDQ6VXNlcjI4NzE2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/287161?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwineinger", "html_url": "https://github.com/jwineinger", "followers_url": "https://api.github.com/users/jwineinger/followers", "following_url": "https://api.github.com/users/jwineinger/following{/other_user}", "gists_url": "https://api.github.com/users/jwineinger/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwineinger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwineinger/subscriptions", "organizations_url": "https://api.github.com/users/jwineinger/orgs", "repos_url": "https://api.github.com/users/jwineinger/repos", "events_url": "https://api.github.com/users/jwineinger/events{/privacy}", "received_events_url": "https://api.github.com/users/jwineinger/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 37, "created_at": "2015-12-28T21:44:14Z", "updated_at": "2021-12-07T23:00:27Z", "closed_at": "2021-09-08T22:43:04Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "I'm using requests to hit developer-api.nest.com and setting an Authorization header with a bearer token. On some requests, that API responds with an 307 redirect. When that happens, I still need the Authorization header to be sent on the subsequent request. I've tried using `requests.get()` as well as a session.\n\nI suppose I could work around this by not allowing redirects, detecting the 307 and then issuing the new request myself but I'm wondering if this is a bug. Should I expect that the Authorization header would be sent on all requests made within the context of a session? \n\n``` python\nIn [41]: s = requests.Session()\n\nIn [42]: s.headers\nOut[42]: {'Accept': '*/*', 'Accept-Encoding': 'gzip, deflate', 'Connection': 'keep-alive', 'User-Agent': 'python-requests/2.7.0 CPython/3.4.3 Darwin/15.2.0'}\n\nIn [43]: s.headers['Authorization'] = \"Bearer <snip>\"\n\nIn [45]: s.get(\"https://developer-api.nest.com/devices/thermostats/\")\nOut[45]: <Response [401]>\n\nIn [46]: s.get(\"https://developer-api.nest.com/devices/thermostats/\")\nOut[46]: <Response [200]>\n\nIn [49]: Out[45].history\nOut[49]: [<Response [307]>]\n\nIn [50]: Out[46].history\nOut[50]: []\n\nIn [51]: Out[45].request.headers\nOut[51]: {'Accept': '*/*', 'Accept-Encoding': 'gzip, deflate', 'Connection': 'keep-alive', 'User-Agent': 'python-requests/2.7.0 CPython/3.4.3 Darwin/15.2.0'}\n\nIn [52]: Out[46].request.headers\nOut[52]: {'Accept': '*/*', 'Accept-Encoding': 'gzip, deflate', 'Connection': 'keep-alive', 'User-Agent': 'python-requests/2.7.0 CPython/3.4.3 Darwin/15.2.0', 'Authorization': 'Bearer <snip>'}\n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2949/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2949/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2935", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2935/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2935/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2935/events", "html_url": "https://github.com/psf/requests/issues/2935", "id": 122853114, "node_id": "MDU6SXNzdWUxMjI4NTMxMTQ=", "number": 2935, "title": "KeyError in connectionpool?", "user": {"login": "Kronuz", "id": 56894, "node_id": "MDQ6VXNlcjU2ODk0", "avatar_url": "https://avatars.githubusercontent.com/u/56894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Kronuz", "html_url": "https://github.com/Kronuz", "followers_url": "https://api.github.com/users/Kronuz/followers", "following_url": "https://api.github.com/users/Kronuz/following{/other_user}", "gists_url": "https://api.github.com/users/Kronuz/gists{/gist_id}", "starred_url": "https://api.github.com/users/Kronuz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Kronuz/subscriptions", "organizations_url": "https://api.github.com/users/Kronuz/orgs", "repos_url": "https://api.github.com/users/Kronuz/repos", "events_url": "https://api.github.com/users/Kronuz/events{/privacy}", "received_events_url": "https://api.github.com/users/Kronuz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 298537994, "node_id": "MDU6TGFiZWwyOTg1Mzc5OTQ=", "url": "https://api.github.com/repos/psf/requests/labels/Needs%20More%20Information", "name": "Needs More Information", "color": "fef2c0", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 44, "created_at": "2015-12-18T00:38:06Z", "updated_at": "2021-09-08T19:00:30Z", "closed_at": "2016-03-09T08:17:03Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "I'm getting a weird error during this call `conn = old_pool.get(block=False)` in connectionpool.py:410.\nThe Error in Sentry is: `Queue in get, KeyError: (1, True)`\n\nAnd this is the  traceback, which doesn't make sense, as `requests/packages/urllib3/connectionpool.py` catches that Empty exception; plus I have no idea what that KeyError is coming from ... any ideas?:\n\n``` python\nStacktrace (most recent call last):\n\n  File \"pac/business/views.py\", line 49, in get_eticket\n    response = requests.get(url, timeout=timeout, verify=False)\n  File \"requests/api.py\", line 69, in get\n    return request('get', url, params=params, **kwargs)\n  File \"requests/api.py\", line 54, in request\n    session.close()\n  File \"requests/sessions.py\", line 649, in close\n    v.close()\n  File \"requests/adapters.py\", line 264, in close\n    self.poolmanager.clear()\n  File \"requests/packages/urllib3/poolmanager.py\", line 99, in clear\n    self.pools.clear()\n  File \"requests/packages/urllib3/_collections.py\", line 93, in clear\n    self.dispose_func(value)\n  File \"requests/packages/urllib3/poolmanager.py\", line 65, in <lambda>\n    dispose_func=lambda p: p.close())\n  File \"requests/packages/urllib3/connectionpool.py\", line 410, in close\n    conn = old_pool.get(block=False)\n  File \"python2.7/Queue.py\", line 165, in get\n    raise Empty\n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2935/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2935/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2844", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2844/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2844/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2844/events", "html_url": "https://github.com/psf/requests/issues/2844", "id": 113001924, "node_id": "MDU6SXNzdWUxMTMwMDE5MjQ=", "number": 2844, "title": "_encode_params return bytes that break urlencode", "user": {"login": "akhomchenko", "id": 1894766, "node_id": "MDQ6VXNlcjE4OTQ3NjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1894766?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akhomchenko", "html_url": "https://github.com/akhomchenko", "followers_url": "https://api.github.com/users/akhomchenko/followers", "following_url": "https://api.github.com/users/akhomchenko/following{/other_user}", "gists_url": "https://api.github.com/users/akhomchenko/gists{/gist_id}", "starred_url": "https://api.github.com/users/akhomchenko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akhomchenko/subscriptions", "organizations_url": "https://api.github.com/users/akhomchenko/orgs", "repos_url": "https://api.github.com/users/akhomchenko/repos", "events_url": "https://api.github.com/users/akhomchenko/events{/privacy}", "received_events_url": "https://api.github.com/users/akhomchenko/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/psf/requests/milestones/26", "html_url": "https://github.com/psf/requests/milestone/26", "labels_url": "https://api.github.com/repos/psf/requests/milestones/26/labels", "id": 1350559, "node_id": "MDk6TWlsZXN0b25lMTM1MDU1OQ==", "number": 26, "title": "2.9.0", "description": "", "creator": {"login": "Lukasa", "id": 1382556, "node_id": "MDQ6VXNlcjEzODI1NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1382556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lukasa", "html_url": "https://github.com/Lukasa", "followers_url": "https://api.github.com/users/Lukasa/followers", "following_url": "https://api.github.com/users/Lukasa/following{/other_user}", "gists_url": "https://api.github.com/users/Lukasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lukasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lukasa/subscriptions", "organizations_url": "https://api.github.com/users/Lukasa/orgs", "repos_url": "https://api.github.com/users/Lukasa/repos", "events_url": "https://api.github.com/users/Lukasa/events{/privacy}", "received_events_url": "https://api.github.com/users/Lukasa/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 2, "state": "closed", "created_at": "2015-10-12T10:32:11Z", "updated_at": "2016-01-05T17:14:26Z", "due_on": null, "closed_at": "2016-01-05T17:14:26Z"}, "comments": 8, "created_at": "2015-10-23T11:27:22Z", "updated_at": "2021-09-08T20:00:55Z", "closed_at": "2015-10-23T12:24:36Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "Simple example:\n\n```\nimport requests\n\n\nr = requests.get('http://python.org', params=b'test=foo')\n\n\nprint(r.status_code)\n```\n\nTrace:\n\n```\nTraceback (most recent call last):\n... skip ...\n    url = requote_uri(urlunparse([scheme, netloc, path, None, query, fragment]))\n  File \"C:\\Python35\\lib\\urllib\\parse.py\", line 383, in urlunparse\n    _coerce_args(*components))\n  File \"C:\\Python35\\lib\\urllib\\parse.py\", line 111, in _coerce_args\n    raise TypeError(\"Cannot mix str and non-str arguments\")\nTypeError: Cannot mix str and non-str arguments\n```\n\nI know, that this one is a bad use case, but API allows us to do so.\n\nShould we do something?\n\nP.S. Python 3.4/3.5 on win 8.1 x64\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2844/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2844/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2756", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2756/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2756/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2756/events", "html_url": "https://github.com/psf/requests/issues/2756", "id": 104987769, "node_id": "MDU6SXNzdWUxMDQ5ODc3Njk=", "number": 2756, "title": "Json supersedes data in prepare_body", "user": {"login": "xEtherealx", "id": 3417501, "node_id": "MDQ6VXNlcjM0MTc1MDE=", "avatar_url": "https://avatars.githubusercontent.com/u/3417501?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xEtherealx", "html_url": "https://github.com/xEtherealx", "followers_url": "https://api.github.com/users/xEtherealx/followers", "following_url": "https://api.github.com/users/xEtherealx/following{/other_user}", "gists_url": "https://api.github.com/users/xEtherealx/gists{/gist_id}", "starred_url": "https://api.github.com/users/xEtherealx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xEtherealx/subscriptions", "organizations_url": "https://api.github.com/users/xEtherealx/orgs", "repos_url": "https://api.github.com/users/xEtherealx/repos", "events_url": "https://api.github.com/users/xEtherealx/events{/privacy}", "received_events_url": "https://api.github.com/users/xEtherealx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2015-09-04T23:44:09Z", "updated_at": "2021-09-08T22:00:44Z", "closed_at": "2015-10-06T14:52:47Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "When not a stream, json supersedes data in prepare_body:\nhttps://github.com/kennethreitz/requests/blob/f5dacf84468ab7e0631cc61a3f1431a32e3e143c/requests/models.py#L446\n\nThis conflicts with the docstring, which indicates that json is only used when data is not specified:\nhttps://github.com/kennethreitz/requests/blob/f5dacf84468ab7e0631cc61a3f1431a32e3e143c/requests/models.py#L195\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2756/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2756/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2707", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2707/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2707/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2707/events", "html_url": "https://github.com/psf/requests/issues/2707", "id": 99147163, "node_id": "MDU6SXNzdWU5OTE0NzE2Mw==", "number": 2707, "title": "parse_header_links fails for momento link headers", "user": {"login": "jayvdb", "id": 15092, "node_id": "MDQ6VXNlcjE1MDky", "avatar_url": "https://avatars.githubusercontent.com/u/15092?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jayvdb", "html_url": "https://github.com/jayvdb", "followers_url": "https://api.github.com/users/jayvdb/followers", "following_url": "https://api.github.com/users/jayvdb/following{/other_user}", "gists_url": "https://api.github.com/users/jayvdb/gists{/gist_id}", "starred_url": "https://api.github.com/users/jayvdb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jayvdb/subscriptions", "organizations_url": "https://api.github.com/users/jayvdb/orgs", "repos_url": "https://api.github.com/users/jayvdb/repos", "events_url": "https://api.github.com/users/jayvdb/events{/privacy}", "received_events_url": "https://api.github.com/users/jayvdb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2015-08-05T08:05:52Z", "updated_at": "2021-09-08T15:00:45Z", "closed_at": "2016-09-23T06:43:09Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "The link header for http://ws-dl-05.cs.odu.edu/demo/index.php/Tyrion_Lannister is not being parsed correctly by `parse_header_links`, and that function doesnt look completely RFC 5988 compliant.\n\n```\n>>> r = requests.get('http://ws-dl-05.cs.odu.edu/demo/index.php/Tyrion_Lannister')\n>>> r.headers['link']\n'<http://ws-dl-05.cs.odu.edu/demo/index.php/Tyrion_Lannister>; rel=\"original latest-version\",<http://ws-dl-05.cs.odu.edu/demo/index.php/Special:TimeGate/Tyrion_Lannister>; rel=\"timegate\",<http://ws-dl-05.cs.odu.edu/demo/index.php/Special:TimeMap/Tyrion_Lannister>; rel=\"timemap\"; type=\"application/link-format\"; from=\"Mon, 23 Apr 2007 20:26:15 GMT\"; until=\"Fri, 06 Sep 2013 17:19:06 GMT\",<http://ws-dl-05.cs.odu.edu/demo/index.php?title=Tyrion_Lannister&oldid=1714>; rel=\"first memento\"; datetime=\"Mon, 23 Apr 2007 20:26:15 GMT\",<http://ws-dl-05.cs.odu.edu/demo/index.php?title=Tyrion_Lannister&oldid=107222>; rel=\"last memento\"; datetime=\"Fri, 06 Sep 2013 17:19:06 GMT\"'\n\n>>> pp = pprint.PrettyPrinter(indent=4)\n>>> pp.pprint(r.links)\n{   '06 Sep 2013 17:19:06 GMT': {   'url': '06 Sep 2013 17:19:06 GMT'},\n    '23 Apr 2007 20:26:15 GMT': {   'url': '23 Apr 2007 20:26:15 GMT'},\n    'first memento': {   'datetime': 'Mon',\n                         'rel': 'first memento',\n                         'url': 'http://ws-dl-05.cs.odu.edu/demo/index.php?title=Tyrion_Lannister&oldid=1714'},\n    'last memento': {   'datetime': 'Fri',\n                        'rel': 'last memento',\n                        'url': 'http://ws-dl-05.cs.odu.edu/demo/index.php?title=Tyrion_Lannister&oldid=107222'},\n    'original latest-version': {   'rel': 'original latest-version',\n                                   'url': 'http://ws-dl-05.cs.odu.edu/demo/index.php/Tyrion_Lannister'},\n    'timegate': {   'rel': 'timegate',\n                    'url': 'http://ws-dl-05.cs.odu.edu/demo/index.php/Special:TimeGate/Tyrion_Lannister'},\n    'timemap': {   'from': 'Mon',\n                   'rel': 'timemap',\n                   'type': 'application/link-format',\n                   'url': 'http://ws-dl-05.cs.odu.edu/demo/index.php/Special:TimeMap/Tyrion_Lannister'}}\n```\n\nOddly this was the subject of #2250, as it appears the comma's are still causing the problem, so it may be that some corner cases still need to be handled better, and some unit tests written to confirm the problem is actually solved.  Happy to help with either.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2707/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2707/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2620", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2620/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2620/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2620/events", "html_url": "https://github.com/psf/requests/issues/2620", "id": 83513544, "node_id": "MDU6SXNzdWU4MzUxMzU0NA==", "number": 2620, "title": "Connect Error or Timeout Error", "user": {"login": "jongiddy", "id": 3735327, "node_id": "MDQ6VXNlcjM3MzUzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/3735327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jongiddy", "html_url": "https://github.com/jongiddy", "followers_url": "https://api.github.com/users/jongiddy/followers", "following_url": "https://api.github.com/users/jongiddy/following{/other_user}", "gists_url": "https://api.github.com/users/jongiddy/gists{/gist_id}", "starred_url": "https://api.github.com/users/jongiddy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jongiddy/subscriptions", "organizations_url": "https://api.github.com/users/jongiddy/orgs", "repos_url": "https://api.github.com/users/jongiddy/repos", "events_url": "https://api.github.com/users/jongiddy/events{/privacy}", "received_events_url": "https://api.github.com/users/jongiddy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 117745, "node_id": "MDU6TGFiZWwxMTc3NDU=", "url": "https://api.github.com/repos/psf/requests/labels/Planned", "name": "Planned", "color": "e102d8", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/psf/requests/milestones/20", "html_url": "https://github.com/psf/requests/milestone/20", "labels_url": "https://api.github.com/repos/psf/requests/milestones/20/labels", "id": 487518, "node_id": "MDk6TWlsZXN0b25lNDg3NTE4", "number": 20, "title": "3.0.0", "description": null, "creator": {"login": "Lukasa", "id": 1382556, "node_id": "MDQ6VXNlcjEzODI1NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1382556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lukasa", "html_url": "https://github.com/Lukasa", "followers_url": "https://api.github.com/users/Lukasa/followers", "following_url": "https://api.github.com/users/Lukasa/following{/other_user}", "gists_url": "https://api.github.com/users/Lukasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lukasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lukasa/subscriptions", "organizations_url": "https://api.github.com/users/Lukasa/orgs", "repos_url": "https://api.github.com/users/Lukasa/repos", "events_url": "https://api.github.com/users/Lukasa/events{/privacy}", "received_events_url": "https://api.github.com/users/Lukasa/received_events", "type": "User", "site_admin": false}, "open_issues": 16, "closed_issues": 28, "state": "open", "created_at": "2013-11-17T11:29:34Z", "updated_at": "2018-11-13T12:55:46Z", "due_on": null, "closed_at": null}, "comments": 6, "created_at": "2015-06-01T14:00:42Z", "updated_at": "2021-09-08T23:04:42Z", "closed_at": "2015-06-02T20:53:50Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "At https://github.com/kennethreitz/requests/blob/8b5e457b756b2ab4c02473f7a42c2e0201ecc7e9/requests/models.py#L664 the urllib3 `ReadTimeoutError` gets mapped to a `requests.exceptions.ConnectionError`. It seems like the `requests.exceptions.ReadTimeout` would be a more obvious exception.\n\nIs this just an oversight, or is there a reason for keeping it as `ConnectionError`?\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2620/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2620/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2599", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2599/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2599/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2599/events", "html_url": "https://github.com/psf/requests/issues/2599", "id": 76019537, "node_id": "MDU6SXNzdWU3NjAxOTUzNw==", "number": 2599, "title": "Auth handler should be calling close, not release_conn", "user": {"login": "sigmavirus24", "id": 240830, "node_id": "MDQ6VXNlcjI0MDgzMA==", "avatar_url": "https://avatars.githubusercontent.com/u/240830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sigmavirus24", "html_url": "https://github.com/sigmavirus24", "followers_url": "https://api.github.com/users/sigmavirus24/followers", "following_url": "https://api.github.com/users/sigmavirus24/following{/other_user}", "gists_url": "https://api.github.com/users/sigmavirus24/gists{/gist_id}", "starred_url": "https://api.github.com/users/sigmavirus24/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sigmavirus24/subscriptions", "organizations_url": "https://api.github.com/users/sigmavirus24/orgs", "repos_url": "https://api.github.com/users/sigmavirus24/repos", "events_url": "https://api.github.com/users/sigmavirus24/events{/privacy}", "received_events_url": "https://api.github.com/users/sigmavirus24/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 117745, "node_id": "MDU6TGFiZWwxMTc3NDU=", "url": "https://api.github.com/repos/psf/requests/labels/Planned", "name": "Planned", "color": "e102d8", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2015-05-13T15:10:24Z", "updated_at": "2021-09-08T23:04:48Z", "closed_at": "2015-05-14T06:15:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "On [this line](https://github.com/kennethreitz/requests/blob/956ec8321a76f0b5a9f5bcb591cf6e77d773f819/requests/auth.py#L182) we should be using the response's \"close\" method. We shouldn't be explicitly calling a method on the \"raw\" attribute.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2599/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2599/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2540", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2540/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2540/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2540/events", "html_url": "https://github.com/psf/requests/issues/2540", "id": 67022847, "node_id": "MDU6SXNzdWU2NzAyMjg0Nw==", "number": 2540, "title": "MisssingSchema error message does not handle unicode input correctly", "user": {"login": "ma2rten", "id": 928271, "node_id": "MDQ6VXNlcjkyODI3MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/928271?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ma2rten", "html_url": "https://github.com/ma2rten", "followers_url": "https://api.github.com/users/ma2rten/followers", "following_url": "https://api.github.com/users/ma2rten/following{/other_user}", "gists_url": "https://api.github.com/users/ma2rten/gists{/gist_id}", "starred_url": "https://api.github.com/users/ma2rten/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ma2rten/subscriptions", "organizations_url": "https://api.github.com/users/ma2rten/orgs", "repos_url": "https://api.github.com/users/ma2rten/repos", "events_url": "https://api.github.com/users/ma2rten/events{/privacy}", "received_events_url": "https://api.github.com/users/ma2rten/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2015-04-08T00:56:52Z", "updated_at": "2021-09-08T23:05:43Z", "closed_at": "2015-04-11T19:11:01Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "using requests 2.6.0, Python 2.7.6\n\n```\nimport requests\nrequests.get(u\"h\u00e4llo world\")\n```\n\n```\n---------------------------------------------------------------------------\nUnicodeEncodeError                        Traceback (most recent call last)\n<ipython-input-3-bf1281984b3a> in <module>()\n----> 1 requests.get(url)\n\n/Library/Python/2.7/site-packages/requests-2.6.0-py2.7.egg/requests/api.pyc in get(url, **kwargs)\n     66 \n     67     kwargs.setdefault('allow_redirects', True)\n---> 68     return request('get', url, **kwargs)\n     69 \n     70 \n\n/Library/Python/2.7/site-packages/requests-2.6.0-py2.7.egg/requests/api.pyc in request(method, url, **kwargs)\n     48 \n     49     session = sessions.Session()\n---> 50     response = session.request(method=method, url=url, **kwargs)\n     51     # By explicitly closing the session, we avoid leaving sockets open which\n     52     # can trigger a ResourceWarning in some cases, and look like a memory leak\n\n/Library/Python/2.7/site-packages/requests-2.6.0-py2.7.egg/requests/sessions.pyc in request(self, method, url, params, data, headers, cookies, files, auth, timeout, allow_redirects, proxies, hooks, stream, verify, cert, json)\n    448             hooks = hooks,\n    449         )\n--> 450         prep = self.prepare_request(req)\n    451 \n    452         proxies = proxies or {}\n\n/Library/Python/2.7/site-packages/requests-2.6.0-py2.7.egg/requests/sessions.pyc in prepare_request(self, request)\n    379             auth=merge_setting(auth, self.auth),\n    380             cookies=merged_cookies,\n--> 381             hooks=merge_hooks(request.hooks, self.hooks),\n    382         )\n    383         return p\n\n/Library/Python/2.7/site-packages/requests-2.6.0-py2.7.egg/requests/models.pyc in prepare(self, method, url, headers, files, data, params, auth, cookies, hooks, json)\n    302 \n    303         self.prepare_method(method)\n--> 304         self.prepare_url(url, params)\n    305         self.prepare_headers(headers)\n    306         self.prepare_cookies(cookies)\n\n/Library/Python/2.7/site-packages/requests-2.6.0-py2.7.egg/requests/models.pyc in prepare_url(self, url, params)\n    359         if not scheme:\n    360             raise MissingSchema(\"Invalid URL {0!r}: No schema supplied. \"\n--> 361                                 \"Perhaps you meant http://{0}?\".format(url))\n    362 \n    363         if not host:\n\nUnicodeEncodeError: 'ascii' codec can't encode character u'\\xe4' in position 1: ordinal not in range(128)\n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2540/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2540/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2530", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2530/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2530/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2530/events", "html_url": "https://github.com/psf/requests/issues/2530", "id": 66483378, "node_id": "MDU6SXNzdWU2NjQ4MzM3OA==", "number": 2530, "title": "__build__ out of sync? Still at 0x020503, looks like 2.5.3 rather than 2.6.0", "user": {"login": "hartwork", "id": 1577132, "node_id": "MDQ6VXNlcjE1NzcxMzI=", "avatar_url": "https://avatars.githubusercontent.com/u/1577132?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hartwork", "html_url": "https://github.com/hartwork", "followers_url": "https://api.github.com/users/hartwork/followers", "following_url": "https://api.github.com/users/hartwork/following{/other_user}", "gists_url": "https://api.github.com/users/hartwork/gists{/gist_id}", "starred_url": "https://api.github.com/users/hartwork/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hartwork/subscriptions", "organizations_url": "https://api.github.com/users/hartwork/orgs", "repos_url": "https://api.github.com/users/hartwork/repos", "events_url": "https://api.github.com/users/hartwork/events{/privacy}", "received_events_url": "https://api.github.com/users/hartwork/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-04-05T21:21:27Z", "updated_at": "2021-09-08T23:05:47Z", "closed_at": "2015-04-06T21:54:22Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Could it be that\n\n```\n__build__ = 0x020503\n```\n\nat https://github.com/kennethreitz/requests/blob/master/requests/__init__.py#L46\nwent out of sync? It looks like 2.5.3 rather than 2.6.0.\n\nBest, Sebastian\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2530/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2530/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2503", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2503/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2503/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2503/events", "html_url": "https://github.com/psf/requests/issues/2503", "id": 62400729, "node_id": "MDU6SXNzdWU2MjQwMDcyOQ==", "number": 2503, "title": "Redirect doesn't pass all parameters", "user": {"login": "pvanderlinden", "id": 391586, "node_id": "MDQ6VXNlcjM5MTU4Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/391586?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pvanderlinden", "html_url": "https://github.com/pvanderlinden", "followers_url": "https://api.github.com/users/pvanderlinden/followers", "following_url": "https://api.github.com/users/pvanderlinden/following{/other_user}", "gists_url": "https://api.github.com/users/pvanderlinden/gists{/gist_id}", "starred_url": "https://api.github.com/users/pvanderlinden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pvanderlinden/subscriptions", "organizations_url": "https://api.github.com/users/pvanderlinden/orgs", "repos_url": "https://api.github.com/users/pvanderlinden/repos", "events_url": "https://api.github.com/users/pvanderlinden/events{/privacy}", "received_events_url": "https://api.github.com/users/pvanderlinden/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2015-03-17T13:41:37Z", "updated_at": "2021-09-08T23:04:52Z", "closed_at": "2015-05-03T15:06:00Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "When you write your own adapter which takes other parameters then the default adapter, resolve_redirects only pass in the parameters which the default adapter takes, this is different from the first request as it passes all parameters to the send function.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2503/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2503/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2466", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2466/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2466/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2466/events", "html_url": "https://github.com/psf/requests/pull/2466", "id": 59348333, "node_id": "MDExOlB1bGxSZXF1ZXN0MzAyMjY4NjI=", "number": 2466, "title": "Only add VendorAliases for vendored dependencies", "user": {"login": "sigmavirus24", "id": 240830, "node_id": "MDQ6VXNlcjI0MDgzMA==", "avatar_url": "https://avatars.githubusercontent.com/u/240830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sigmavirus24", "html_url": "https://github.com/sigmavirus24", "followers_url": "https://api.github.com/users/sigmavirus24/followers", "following_url": "https://api.github.com/users/sigmavirus24/following{/other_user}", "gists_url": "https://api.github.com/users/sigmavirus24/gists{/gist_id}", "starred_url": "https://api.github.com/users/sigmavirus24/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sigmavirus24/subscriptions", "organizations_url": "https://api.github.com/users/sigmavirus24/orgs", "repos_url": "https://api.github.com/users/sigmavirus24/repos", "events_url": "https://api.github.com/users/sigmavirus24/events{/privacy}", "received_events_url": "https://api.github.com/users/sigmavirus24/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2015-02-28T16:53:27Z", "updated_at": "2021-09-08T08:01:06Z", "closed_at": "2015-03-04T13:49:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "draft": false, "pull_request": {"url": "https://api.github.com/repos/psf/requests/pulls/2466", "html_url": "https://github.com/psf/requests/pull/2466", "diff_url": "https://github.com/psf/requests/pull/2466.diff", "patch_url": "https://github.com/psf/requests/pull/2466.patch", "merged_at": "2015-03-04T13:49:12Z"}, "body": "Closes #2465 \nCloses #2470 \n\n/cc @dstufft Let me know if I should send this to pip as well\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2466/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2466/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/psf/requests/issues/2458", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2458/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2458/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2458/events", "html_url": "https://github.com/psf/requests/pull/2458", "id": 58756824, "node_id": "MDExOlB1bGxSZXF1ZXN0Mjk5MDgwMTE=", "number": 2458, "title": "Revert \"Update certificate bundle.\"", "user": {"login": "sigmavirus24", "id": 240830, "node_id": "MDQ6VXNlcjI0MDgzMA==", "avatar_url": "https://avatars.githubusercontent.com/u/240830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sigmavirus24", "html_url": "https://github.com/sigmavirus24", "followers_url": "https://api.github.com/users/sigmavirus24/followers", "following_url": "https://api.github.com/users/sigmavirus24/following{/other_user}", "gists_url": "https://api.github.com/users/sigmavirus24/gists{/gist_id}", "starred_url": "https://api.github.com/users/sigmavirus24/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sigmavirus24/subscriptions", "organizations_url": "https://api.github.com/users/sigmavirus24/orgs", "repos_url": "https://api.github.com/users/sigmavirus24/repos", "events_url": "https://api.github.com/users/sigmavirus24/events{/privacy}", "received_events_url": "https://api.github.com/users/sigmavirus24/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": {"login": "Lukasa", "id": 1382556, "node_id": "MDQ6VXNlcjEzODI1NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1382556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lukasa", "html_url": "https://github.com/Lukasa", "followers_url": "https://api.github.com/users/Lukasa/followers", "following_url": "https://api.github.com/users/Lukasa/following{/other_user}", "gists_url": "https://api.github.com/users/Lukasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lukasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lukasa/subscriptions", "organizations_url": "https://api.github.com/users/Lukasa/orgs", "repos_url": "https://api.github.com/users/Lukasa/repos", "events_url": "https://api.github.com/users/Lukasa/events{/privacy}", "received_events_url": "https://api.github.com/users/Lukasa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "Lukasa", "id": 1382556, "node_id": "MDQ6VXNlcjEzODI1NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1382556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lukasa", "html_url": "https://github.com/Lukasa", "followers_url": "https://api.github.com/users/Lukasa/followers", "following_url": "https://api.github.com/users/Lukasa/following{/other_user}", "gists_url": "https://api.github.com/users/Lukasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lukasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lukasa/subscriptions", "organizations_url": "https://api.github.com/users/Lukasa/orgs", "repos_url": "https://api.github.com/users/Lukasa/repos", "events_url": "https://api.github.com/users/Lukasa/events{/privacy}", "received_events_url": "https://api.github.com/users/Lukasa/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2015-02-24T15:44:57Z", "updated_at": "2021-09-08T08:01:07Z", "closed_at": "2015-02-24T16:18:16Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "draft": false, "pull_request": {"url": "https://api.github.com/repos/psf/requests/pulls/2458", "html_url": "https://github.com/psf/requests/pull/2458", "diff_url": "https://github.com/psf/requests/pull/2458.diff", "patch_url": "https://github.com/psf/requests/pull/2458.patch", "merged_at": "2015-02-24T16:18:16Z"}, "body": "Reverts kennethreitz/requests#2442\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2458/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2458/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/psf/requests/issues/2455", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2455/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2455/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2455/events", "html_url": "https://github.com/psf/requests/issues/2455", "id": 58678665, "node_id": "MDU6SXNzdWU1ODY3ODY2NQ==", "number": 2455, "title": "CERTIFICATE_VERIFY_FAILED with 2.5.2, works with 2.5.1", "user": {"login": "rmcgibbo", "id": 641278, "node_id": "MDQ6VXNlcjY0MTI3OA==", "avatar_url": "https://avatars.githubusercontent.com/u/641278?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmcgibbo", "html_url": "https://github.com/rmcgibbo", "followers_url": "https://api.github.com/users/rmcgibbo/followers", "following_url": "https://api.github.com/users/rmcgibbo/following{/other_user}", "gists_url": "https://api.github.com/users/rmcgibbo/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmcgibbo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmcgibbo/subscriptions", "organizations_url": "https://api.github.com/users/rmcgibbo/orgs", "repos_url": "https://api.github.com/users/rmcgibbo/repos", "events_url": "https://api.github.com/users/rmcgibbo/events{/privacy}", "received_events_url": "https://api.github.com/users/rmcgibbo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 117745, "node_id": "MDU6TGFiZWwxMTc3NDU=", "url": "https://api.github.com/repos/psf/requests/labels/Planned", "name": "Planned", "color": "e102d8", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 111, "created_at": "2015-02-24T01:11:01Z", "updated_at": "2021-09-08T20:00:52Z", "closed_at": "2015-05-31T12:57:28Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "I'm having a somewhat odd issue. A get() request seems to work fine with requests-2.5.1, but after upgrading to requests 2.5.2, the same URL leads to `CERTIFICATE_VERIFY_FAILED`. cc @mpharrigan\n\n```\n$ pip install requests==2.5.1\n[ ... snip, installs just fine ...]\n\n$ python -c 'import requests; print(requests.get(\"http://conda.binstar.org/omnia/linux-64/fftw3f-3.3.3-1.tar.bz2\"))'\n<Response [200]>\n\n$ pip install requests==2.5.2\n[ ... snip, installs just fine ...]\n\n$ python -c 'import requests; print(requests.get(\"http://conda.binstar.org/omnia/linux-64/fftw3f-3.3.3-1.tar.bz2\"))'\nTraceback (most recent call last):\n  File \"/Users/rmcgibbo/miniconda/envs/3.4.2/lib/python3.4/site-packages/requests/packages/urllib3/connectionpool.py\", line 544, in urlopen\n    body=body, headers=headers)\n  File \"/Users/rmcgibbo/miniconda/envs/3.4.2/lib/python3.4/site-packages/requests/packages/urllib3/connectionpool.py\", line 341, in _make_request\n    self._validate_conn(conn)\n  File \"/Users/rmcgibbo/miniconda/envs/3.4.2/lib/python3.4/site-packages/requests/packages/urllib3/connectionpool.py\", line 762, in _validate_conn\n    conn.connect()\n  File \"/Users/rmcgibbo/miniconda/envs/3.4.2/lib/python3.4/site-packages/requests/packages/urllib3/connection.py\", line 238, in connect\n    ssl_version=resolved_ssl_version)\n  File \"/Users/rmcgibbo/miniconda/envs/3.4.2/lib/python3.4/site-packages/requests/packages/urllib3/util/ssl_.py\", line 256, in ssl_wrap_socket\n    return context.wrap_socket(sock, server_hostname=server_hostname)\n  File \"/Users/rmcgibbo/miniconda/envs/3.4.2/lib/python3.4/ssl.py\", line 364, in wrap_socket\n    _context=self)\n  File \"/Users/rmcgibbo/miniconda/envs/3.4.2/lib/python3.4/ssl.py\", line 578, in __init__\n    self.do_handshake()\n  File \"/Users/rmcgibbo/miniconda/envs/3.4.2/lib/python3.4/ssl.py\", line 805, in do_handshake\n    self._sslobj.do_handshake()\nssl.SSLError: [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:600)\n\nDuring handling of the above exception, another exception occurred:\n[... snip ...]\n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2455/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2455/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2375", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2375/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2375/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2375/events", "html_url": "https://github.com/psf/requests/pull/2375", "id": 51382319, "node_id": "MDExOlB1bGxSZXF1ZXN0MjU3MTYxMjc=", "number": 2375, "title": "Copy pip's import machinery wholesale", "user": {"login": "sigmavirus24", "id": 240830, "node_id": "MDQ6VXNlcjI0MDgzMA==", "avatar_url": "https://avatars.githubusercontent.com/u/240830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sigmavirus24", "html_url": "https://github.com/sigmavirus24", "followers_url": "https://api.github.com/users/sigmavirus24/followers", "following_url": "https://api.github.com/users/sigmavirus24/following{/other_user}", "gists_url": "https://api.github.com/users/sigmavirus24/gists{/gist_id}", "starred_url": "https://api.github.com/users/sigmavirus24/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sigmavirus24/subscriptions", "organizations_url": "https://api.github.com/users/sigmavirus24/orgs", "repos_url": "https://api.github.com/users/sigmavirus24/repos", "events_url": "https://api.github.com/users/sigmavirus24/events{/privacy}", "received_events_url": "https://api.github.com/users/sigmavirus24/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 39, "created_at": "2014-12-09T02:58:42Z", "updated_at": "2021-09-08T09:01:00Z", "closed_at": "2015-01-09T20:38:31Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "draft": false, "pull_request": {"url": "https://api.github.com/repos/psf/requests/pulls/2375", "html_url": "https://github.com/psf/requests/pull/2375", "diff_url": "https://github.com/psf/requests/pull/2375.diff", "patch_url": "https://github.com/psf/requests/pull/2375.patch", "merged_at": "2015-01-09T20:38:31Z"}, "body": "Fedora and Debian have both recently added symlinks to their distributions of requests so people can do `from requests.packages import urllib3` but they seem to still rewrite our import statements. So the following situation is possible:\n- User registers adapter for custom scheme\n- User does the following:\n  \n  ``` python\n  from requests.packages.urllib3 import poolmanager\n  \n  poolmanager.pool_classes_by_scheme['glance+https'] = HTTPSConectionPool\n  ```\n- When they do `s.get('glance+https://...')` they see a `KeyError` because the urllib3 we're using in requests is not the one they've imported (according to `sys.modules`).\n\nPip works around this with the copied machinery. The tests seem to work just fine for me. I still need to test this with our vendored packages removed and urllib3/chardet installed separately.\n\n/cc @dstufft @eriolv @ralphbean \n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2375/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2375/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/psf/requests/issues/2345", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2345/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2345/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2345/events", "html_url": "https://github.com/psf/requests/issues/2345", "id": 48994009, "node_id": "MDU6SXNzdWU0ODk5NDAwOQ==", "number": 2345, "title": "Using RecentlyUsedContainer for session cache breaks pickling", "user": {"login": "sigmavirus24", "id": 240830, "node_id": "MDQ6VXNlcjI0MDgzMA==", "avatar_url": "https://avatars.githubusercontent.com/u/240830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sigmavirus24", "html_url": "https://github.com/sigmavirus24", "followers_url": "https://api.github.com/users/sigmavirus24/followers", "following_url": "https://api.github.com/users/sigmavirus24/following{/other_user}", "gists_url": "https://api.github.com/users/sigmavirus24/gists{/gist_id}", "starred_url": "https://api.github.com/users/sigmavirus24/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sigmavirus24/subscriptions", "organizations_url": "https://api.github.com/users/sigmavirus24/orgs", "repos_url": "https://api.github.com/users/sigmavirus24/repos", "events_url": "https://api.github.com/users/sigmavirus24/events{/privacy}", "received_events_url": "https://api.github.com/users/sigmavirus24/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2014-11-16T15:52:15Z", "updated_at": "2021-09-08T23:06:55Z", "closed_at": "2014-11-30T19:12:43Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "The changes in 387c8f8 have broken the ability to pickle a Session object.\n\nPossible solutions:\n- Re-implement `RecentlyUsedContainer` to not use threading locks\n- Do not attempt to pickle the session redirect cache (personally, I prefer this one)\n\nReasons this wasn't caught earlier:\n- Jenkins has magically stopped working\n- No one has been running the suite locally before merging/approving changes\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2345/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2345/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2336", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2336/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2336/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2336/events", "html_url": "https://github.com/psf/requests/issues/2336", "id": 48629128, "node_id": "MDU6SXNzdWU0ODYyOTEyOA==", "number": 2336, "title": "Timeout for connecting to proxy", "user": {"login": "glaslos", "id": 716339, "node_id": "MDQ6VXNlcjcxNjMzOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/716339?v=4", "gravatar_id": "", "url": "https://api.github.com/users/glaslos", "html_url": "https://github.com/glaslos", "followers_url": "https://api.github.com/users/glaslos/followers", "following_url": "https://api.github.com/users/glaslos/following{/other_user}", "gists_url": "https://api.github.com/users/glaslos/gists{/gist_id}", "starred_url": "https://api.github.com/users/glaslos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/glaslos/subscriptions", "organizations_url": "https://api.github.com/users/glaslos/orgs", "repos_url": "https://api.github.com/users/glaslos/repos", "events_url": "https://api.github.com/users/glaslos/events{/privacy}", "received_events_url": "https://api.github.com/users/glaslos/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 38, "created_at": "2014-11-13T12:10:06Z", "updated_at": "2021-09-08T17:05:23Z", "closed_at": "2015-03-02T09:49:24Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "I provided a bogus proxy, set a very short timeout and expected requests to fail very fast. Unfortunately the opposite happened. Is this behavior intentional? As far as I can tell there is no way to set a timeout for the proxy connection.\n\n``` Python\ntime python -c \"import requests; print requests.__version__; requests.get('https://google.com', timeout=0.01, proxies={'https':'https://1.1.1.1'})\"\n2.4.3\nTraceback (most recent call last):\n  File \"<string>\", line 1, in <module>\n  File \"/usr/local/lib/python2.7/dist-packages/requests/api.py\", line 60, in get\n    return request('get', url, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/requests/api.py\", line 49, in request\n    return session.request(method=method, url=url, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/requests/sessions.py\", line 457, in request\n    resp = self.send(prep, **send_kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/requests/sessions.py\", line 569, in send\n    r = adapter.send(request, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/requests/adapters.py\", line 413, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPSConnectionPool(host='google.com', port=443): Max retries exceeded with url: / (Caused by ProxyError('Cannot connect to proxy.', error(110, 'Connection timed out')))\n\nreal    2m7.350s\nuser    0m0.090s\nsys 0m0.030s\n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2336/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2336/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2306", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2306/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2306/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2306/events", "html_url": "https://github.com/psf/requests/pull/2306", "id": 46814257, "node_id": "MDExOlB1bGxSZXF1ZXN0MjMzNDAwMjg=", "number": 2306, "title": "Fix failing test test_prepare_unicode_url", "user": {"login": "ssadler", "id": 125019, "node_id": "MDQ6VXNlcjEyNTAxOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/125019?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssadler", "html_url": "https://github.com/ssadler", "followers_url": "https://api.github.com/users/ssadler/followers", "following_url": "https://api.github.com/users/ssadler/following{/other_user}", "gists_url": "https://api.github.com/users/ssadler/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssadler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssadler/subscriptions", "organizations_url": "https://api.github.com/users/ssadler/orgs", "repos_url": "https://api.github.com/users/ssadler/repos", "events_url": "https://api.github.com/users/ssadler/events{/privacy}", "received_events_url": "https://api.github.com/users/ssadler/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 117745, "node_id": "MDU6TGFiZWwxMTc3NDU=", "url": "https://api.github.com/repos/psf/requests/labels/Planned", "name": "Planned", "color": "e102d8", "default": false, "description": null}, {"id": 44501305, "node_id": "MDU6TGFiZWw0NDUwMTMwNQ==", "url": "https://api.github.com/repos/psf/requests/labels/Not%20Ready%20To%20Merge", "name": "Not Ready To Merge", "color": "e11d21", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": {"login": "sigmavirus24", "id": 240830, "node_id": "MDQ6VXNlcjI0MDgzMA==", "avatar_url": "https://avatars.githubusercontent.com/u/240830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sigmavirus24", "html_url": "https://github.com/sigmavirus24", "followers_url": "https://api.github.com/users/sigmavirus24/followers", "following_url": "https://api.github.com/users/sigmavirus24/following{/other_user}", "gists_url": "https://api.github.com/users/sigmavirus24/gists{/gist_id}", "starred_url": "https://api.github.com/users/sigmavirus24/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sigmavirus24/subscriptions", "organizations_url": "https://api.github.com/users/sigmavirus24/orgs", "repos_url": "https://api.github.com/users/sigmavirus24/repos", "events_url": "https://api.github.com/users/sigmavirus24/events{/privacy}", "received_events_url": "https://api.github.com/users/sigmavirus24/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sigmavirus24", "id": 240830, "node_id": "MDQ6VXNlcjI0MDgzMA==", "avatar_url": "https://avatars.githubusercontent.com/u/240830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sigmavirus24", "html_url": "https://github.com/sigmavirus24", "followers_url": "https://api.github.com/users/sigmavirus24/followers", "following_url": "https://api.github.com/users/sigmavirus24/following{/other_user}", "gists_url": "https://api.github.com/users/sigmavirus24/gists{/gist_id}", "starred_url": "https://api.github.com/users/sigmavirus24/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sigmavirus24/subscriptions", "organizations_url": "https://api.github.com/users/sigmavirus24/orgs", "repos_url": "https://api.github.com/users/sigmavirus24/repos", "events_url": "https://api.github.com/users/sigmavirus24/events{/privacy}", "received_events_url": "https://api.github.com/users/sigmavirus24/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2014-10-25T15:06:09Z", "updated_at": "2021-09-08T10:01:00Z", "closed_at": "2014-10-27T00:32:46Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "draft": false, "pull_request": {"url": "https://api.github.com/repos/psf/requests/pulls/2306", "html_url": "https://github.com/psf/requests/pull/2306", "diff_url": "https://github.com/psf/requests/pull/2306.diff", "patch_url": "https://github.com/psf/requests/pull/2306.patch", "merged_at": "2014-10-27T00:32:46Z"}, "body": "Test was failing in case of undefined `hooks` in prepare_hooks()\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2306/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2306/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/psf/requests/issues/2255", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2255/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2255/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2255/events", "html_url": "https://github.com/psf/requests/issues/2255", "id": 44247749, "node_id": "MDU6SXNzdWU0NDI0Nzc0OQ==", "number": 2255, "title": "Session requests should respect verify=False", "user": {"login": "isaulv", "id": 585003, "node_id": "MDQ6VXNlcjU4NTAwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/585003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/isaulv", "html_url": "https://github.com/isaulv", "followers_url": "https://api.github.com/users/isaulv/followers", "following_url": "https://api.github.com/users/isaulv/following{/other_user}", "gists_url": "https://api.github.com/users/isaulv/gists{/gist_id}", "starred_url": "https://api.github.com/users/isaulv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/isaulv/subscriptions", "organizations_url": "https://api.github.com/users/isaulv/orgs", "repos_url": "https://api.github.com/users/isaulv/repos", "events_url": "https://api.github.com/users/isaulv/events{/privacy}", "received_events_url": "https://api.github.com/users/isaulv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 20, "created_at": "2014-09-29T01:06:48Z", "updated_at": "2021-09-08T22:00:52Z", "closed_at": "2015-08-31T09:45:01Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Using a website that has a self-signed cert, the following use of verify=False fails:\nimport requests\ns = requests.Session()\nr = s.get('https://selfsignedsite')\n_traceback_\nr = s.get('https://selfsidnedsite', verify=False)\n_traceback is the same about SSL3 not finding a valid cert_\nrequests.get('https://selfsignedsite', verify=False)\n_traceback as above_\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2255/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2255/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2250", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2250/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2250/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2250/events", "html_url": "https://github.com/psf/requests/issues/2250", "id": 43960734, "node_id": "MDU6SXNzdWU0Mzk2MDczNA==", "number": 2250, "title": "Link header parsing breaks if attribute value has commas", "user": {"login": "hariharshankar", "id": 1693859, "node_id": "MDQ6VXNlcjE2OTM4NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1693859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hariharshankar", "html_url": "https://github.com/hariharshankar", "followers_url": "https://api.github.com/users/hariharshankar/followers", "following_url": "https://api.github.com/users/hariharshankar/following{/other_user}", "gists_url": "https://api.github.com/users/hariharshankar/gists{/gist_id}", "starred_url": "https://api.github.com/users/hariharshankar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hariharshankar/subscriptions", "organizations_url": "https://api.github.com/users/hariharshankar/orgs", "repos_url": "https://api.github.com/users/hariharshankar/repos", "events_url": "https://api.github.com/users/hariharshankar/events{/privacy}", "received_events_url": "https://api.github.com/users/hariharshankar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2014-09-25T20:01:41Z", "updated_at": "2021-09-08T23:07:55Z", "closed_at": "2014-10-10T18:30:18Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "The function parse_header_links does not parse link headers correctly if the attribute value for a link has commas or semi-colons in them. \nhttps://github.com/kennethreitz/requests/blob/master/requests/utils.py#L562\n\nThe Memento protocol (RFC 7089) allows HTTP datetime in the link attributes and the link header parser cannot parse this reliably. \nFor example:\n\n``` python\n>>> r = requests.get('http://mementoweb.org/timegate/http://www.google.com', allow_redirects=False)\n>>> r.headers['link']\n\"\"\"<http://www.google.com>;rel=\"original\" ,\n<http://mementoweb.org/timemap/link/1/http://www.google.com>;rel=\"timemap\"; type=\"application/link-format\",\n<http://mementoweb.org/timegate/http://www.google.com>;rel=\"timegate\",\n<http://web.archive.org/web/20140911065756/http://www.google.com/>;rel=\"memento\"; datetime=\"Thu, 11 Sep 2014 06:57:56 GMT\",\n<http://web.archive.org/web/20131004112325/http://www.google.com/>;rel=\"memento first\"; datetime=\"Sat, 04 Oct 1997 22:20:27 GMT\",\n<http://web.archive.org/web/20121011204401/https://www.google.com/>;rel=\"memento last\"; datetime=\"Sat, 11 Oct 2014 10:05:51 GMT\"\"\"\"\n>>> r.links\n{'04 Oct 1997 22:20:27 GMT': {'url': '04 Oct 1997 22:20:27 GMT'},\n '11 Oct 2014 10:05:51 GMT': {'url': '11 Oct 2014 10:05:51 GMT'},\n '11 Sep 2014 06:57:56 GMT': {'url': '11 Sep 2014 06:57:56 GMT'},\n 'memento': {'datetime': 'Thu',\n  'rel': 'memento',\n  'url': 'http://web.archive.org/web/20140911065756/http://www.google.com/'},\n 'memento first': {'datetime': 'Sat',\n  'rel': 'memento first',\n  'url': 'http://web.archive.org/web/20131004112325/http://www.google.com/'},\n 'memento last': {'datetime': 'Sat',\n  'rel': 'memento last',\n  'url': 'http://web.archive.org/web/20121011204401/https://www.google.com/'},\n 'original': {'rel': 'original', 'url': 'http://www.google.com'},\n 'timegate': {'rel': 'timegate',\n  'url': 'http://mementoweb.org/timegate/http://www.google.com'},\n 'timemap': {'rel': 'timemap',\n  'type': 'application/link-format',\n  'url': 'http://mementoweb.org/timemap/link/1/http://www.google.com'}}\n```\n\nThere are third party link header parsers in the URLs below, but it would be very convenient if the requests' parse_header_links function could parse correctly.\n\nhttps://bitbucket.org/azaroth42/linkheaderparser/src/c2321bf3349b94a12a37ed8c41d4e4785006ada7/parse_link.py?at=default\nhttps://gist.github.com/mnot/210535\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2250/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2250/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2229", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2229/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2229/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2229/events", "html_url": "https://github.com/psf/requests/issues/2229", "id": 42945644, "node_id": "MDU6SXNzdWU0Mjk0NTY0NA==", "number": 2229, "title": "full URL sent instead of path when using https proxy", "user": {"login": "newsham", "id": 1994957, "node_id": "MDQ6VXNlcjE5OTQ5NTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1994957?v=4", "gravatar_id": "", "url": "https://api.github.com/users/newsham", "html_url": "https://github.com/newsham", "followers_url": "https://api.github.com/users/newsham/followers", "following_url": "https://api.github.com/users/newsham/following{/other_user}", "gists_url": "https://api.github.com/users/newsham/gists{/gist_id}", "starred_url": "https://api.github.com/users/newsham/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/newsham/subscriptions", "organizations_url": "https://api.github.com/users/newsham/orgs", "repos_url": "https://api.github.com/users/newsham/repos", "events_url": "https://api.github.com/users/newsham/events{/privacy}", "received_events_url": "https://api.github.com/users/newsham/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2014-09-16T23:23:44Z", "updated_at": "2021-09-08T23:04:49Z", "closed_at": "2015-05-03T15:12:33Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "When using the requests library through a web proxy, requests includes a full URL in the request line instead of just the path for all https requests.  Http requests send just the path, as expected. Https requests send the full URL in place of the path.  This can cause problems with certain proxies (for example, the BURP proxy (http://portswigger.net/burp/download.html) will not properly process these requests unless the special \"transparent\" proxy mode is enabled).\n\nThe following script demonstrates his problem:\n\n```\n#!/usr/bin/env python\n\"\"\"\nRequests library will send full URL as the request path\nwhen sending HTTPS requests to a proxy.. WHY?\n\nRun this script through a proxy listening on the local host,\nsuch as BURP, which records all traffic.  Look at the proxy\nlogs to see the request lines.  Notice that this will send\na full URL in the request line.\n\"\"\"\n\nimport requests\n\nproxies = { \n   'http': 'http://127.0.0.1:8080/',\n   'https': 'https://127.0.0.1:8080/' \n}\n\n# sends full URL in the request line:\nr = requests.get(\"https://www.yahoo.com/the/path/goes/here\", proxies=proxies, allow_redirects=False)\n\n# sends full just the path in the request line:\nr = requests.get(\"http://www.yahoo.com/the/path/goes/here\", proxies=proxies, allow_redirects=False)\n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2229/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2229/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2228", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2228/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2228/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2228/events", "html_url": "https://github.com/psf/requests/issues/2228", "id": 42893830, "node_id": "MDU6SXNzdWU0Mjg5MzgzMA==", "number": 2228, "title": "Documentation examples.", "user": {"login": "mountainpaul", "id": 72376, "node_id": "MDQ6VXNlcjcyMzc2", "avatar_url": "https://avatars.githubusercontent.com/u/72376?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mountainpaul", "html_url": "https://github.com/mountainpaul", "followers_url": "https://api.github.com/users/mountainpaul/followers", "following_url": "https://api.github.com/users/mountainpaul/following{/other_user}", "gists_url": "https://api.github.com/users/mountainpaul/gists{/gist_id}", "starred_url": "https://api.github.com/users/mountainpaul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mountainpaul/subscriptions", "organizations_url": "https://api.github.com/users/mountainpaul/orgs", "repos_url": "https://api.github.com/users/mountainpaul/repos", "events_url": "https://api.github.com/users/mountainpaul/events{/privacy}", "received_events_url": "https://api.github.com/users/mountainpaul/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}, {"id": 136616769, "node_id": "MDU6TGFiZWwxMzY2MTY3Njk=", "url": "https://api.github.com/repos/psf/requests/labels/Documentation", "name": "Documentation", "color": "fad8c7", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 15, "created_at": "2014-09-16T15:15:50Z", "updated_at": "2022-02-26T04:00:40Z", "closed_at": "2021-11-28T03:00:28Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Thanks for an excellent package. I believe the quick start examples should include a timeout value. This is the more common case, rather than the exception. \n\nIn the more advanced documentation it maybe wise to mention that sockets.getdefaulttimeout() is not used when a value is not specified. \n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2228/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2228/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2216", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2216/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2216/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2216/events", "html_url": "https://github.com/psf/requests/pull/2216", "id": 42430638, "node_id": "MDExOlB1bGxSZXF1ZXN0MjEwNDMzMTE=", "number": 2216, "title": "Retries logic", "user": {"login": "sigmavirus24", "id": 240830, "node_id": "MDQ6VXNlcjI0MDgzMA==", "avatar_url": "https://avatars.githubusercontent.com/u/240830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sigmavirus24", "html_url": "https://github.com/sigmavirus24", "followers_url": "https://api.github.com/users/sigmavirus24/followers", "following_url": "https://api.github.com/users/sigmavirus24/following{/other_user}", "gists_url": "https://api.github.com/users/sigmavirus24/gists{/gist_id}", "starred_url": "https://api.github.com/users/sigmavirus24/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sigmavirus24/subscriptions", "organizations_url": "https://api.github.com/users/sigmavirus24/orgs", "repos_url": "https://api.github.com/users/sigmavirus24/repos", "events_url": "https://api.github.com/users/sigmavirus24/events{/privacy}", "received_events_url": "https://api.github.com/users/sigmavirus24/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 76800, "node_id": "MDU6TGFiZWw3NjgwMA==", "url": "https://api.github.com/repos/psf/requests/labels/Feature%20Request", "name": "Feature Request", "color": "02e10c", "default": false, "description": null}, {"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 60669570, "node_id": "MDU6TGFiZWw2MDY2OTU3MA==", "url": "https://api.github.com/repos/psf/requests/labels/Please%20Review", "name": "Please Review", "color": "fef2c0", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": {"login": "kennethreitz", "id": 119893, "node_id": "MDQ6VXNlcjExOTg5Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/119893?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennethreitz", "html_url": "https://github.com/kennethreitz", "followers_url": "https://api.github.com/users/kennethreitz/followers", "following_url": "https://api.github.com/users/kennethreitz/following{/other_user}", "gists_url": "https://api.github.com/users/kennethreitz/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennethreitz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennethreitz/subscriptions", "organizations_url": "https://api.github.com/users/kennethreitz/orgs", "repos_url": "https://api.github.com/users/kennethreitz/repos", "events_url": "https://api.github.com/users/kennethreitz/events{/privacy}", "received_events_url": "https://api.github.com/users/kennethreitz/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "kennethreitz", "id": 119893, "node_id": "MDQ6VXNlcjExOTg5Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/119893?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennethreitz", "html_url": "https://github.com/kennethreitz", "followers_url": "https://api.github.com/users/kennethreitz/followers", "following_url": "https://api.github.com/users/kennethreitz/following{/other_user}", "gists_url": "https://api.github.com/users/kennethreitz/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennethreitz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennethreitz/subscriptions", "organizations_url": "https://api.github.com/users/kennethreitz/orgs", "repos_url": "https://api.github.com/users/kennethreitz/repos", "events_url": "https://api.github.com/users/kennethreitz/events{/privacy}", "received_events_url": "https://api.github.com/users/kennethreitz/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 30, "created_at": "2014-09-10T16:12:40Z", "updated_at": "2021-09-08T09:00:56Z", "closed_at": "2014-12-01T19:45:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "draft": false, "pull_request": {"url": "https://api.github.com/repos/psf/requests/pulls/2216", "html_url": "https://github.com/psf/requests/pull/2216", "diff_url": "https://github.com/psf/requests/pull/2216.diff", "patch_url": "https://github.com/psf/requests/pull/2216.patch", "merged_at": "2014-12-01T19:45:27Z"}, "body": "Currently our documentation tells user that by creating a custom `HTTPAdapter` they can pass `max_retries=n` and that will apply to connection and read retries. This is a lie at the moment (and has been probably since 2.4.0 was released with the new version of urllib3 that added the `Retry` class).\n\nIn order to preserve backwards compatibility (and have passing tests) I remember upgrading the logic [here](https://github.com/kennethreitz/requests/blob/master/requests/adapters.py#L361) to pass `read=False` because some where we expected a plain `ReadTimeout` exception we were now getting a `MaxRetryError`. This, however, means that we have broken what we promised in the documentation (and what was likely present in even 2.3.0).\n\nAt the moment we do not support passing a `Retry` instance from `urllib3`. I'd like to propose the following changes:\n- In `requests.adapters`, `DEFAULT_RETRIES` becomes a sentinel object, e.g., `DEFAULT_RETRIES = object()`.\n- In `HTTPAdatper.__init__`, we check for the sentinel object and if so set `self.max_retries` to `Retry(0, read=False)`. Otherwise, we do `self.max_retries = Retry.from_int(max_retries)`\n\nThis should fix preserve the default existing behaviour that specifying `read=False` preserved but also allow users to do one of two things:\n1. Import `Retry` from urllib3, construct their own `Retry` instance and then pass it as `max_retries`\n2. Specify a number for both connection and read retries.\n\nDoes this sound like a fair proposal?\n\n**Edit** I forgot to mention that @txtsd brought this to our attention in IRC. They get the credit for reporting this. Thank you @txtsd \n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2216/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2216/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/psf/requests/issues/2169", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2169/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2169/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2169/events", "html_url": "https://github.com/psf/requests/issues/2169", "id": 40489816, "node_id": "MDU6SXNzdWU0MDQ4OTgxNg==", "number": 2169, "title": "Connection keep alive issue", "user": {"login": "tychotatitscheff", "id": 407189, "node_id": "MDQ6VXNlcjQwNzE4OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/407189?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tychotatitscheff", "html_url": "https://github.com/tychotatitscheff", "followers_url": "https://api.github.com/users/tychotatitscheff/followers", "following_url": "https://api.github.com/users/tychotatitscheff/following{/other_user}", "gists_url": "https://api.github.com/users/tychotatitscheff/gists{/gist_id}", "starred_url": "https://api.github.com/users/tychotatitscheff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tychotatitscheff/subscriptions", "organizations_url": "https://api.github.com/users/tychotatitscheff/orgs", "repos_url": "https://api.github.com/users/tychotatitscheff/repos", "events_url": "https://api.github.com/users/tychotatitscheff/events{/privacy}", "received_events_url": "https://api.github.com/users/tychotatitscheff/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 60669570, "node_id": "MDU6TGFiZWw2MDY2OTU3MA==", "url": "https://api.github.com/repos/psf/requests/labels/Please%20Review", "name": "Please Review", "color": "fef2c0", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 26, "created_at": "2014-08-18T13:51:38Z", "updated_at": "2021-09-08T23:10:38Z", "closed_at": "2014-08-29T14:24:23Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "_Maybe it is not the right place to report this, its one of my first issue report_\n\nWinows 7\nPython 3.4\nRequest 2.3\n\nIn requests' main site it's said:\n\n> > connection keepalive should be 100% automatic.\n\nHowever in my case:\n- on a ssl connection\n- throught http proxy\n\nI had to add the `\"connection\" : \"keep-alive\"` header.\nBut it took me so much time to find it because the exceeption raised was a `requests.exceptions.ProxyError`\n\nSo i went into the code and find that:\n\n``` python\nhttplib_response = conn.getresponse()\n```\n\nin `_make_request()` function in `connection_pool.py` raise a `SocketError` wich is converted to a `ReadTimeoutError` : all correct for now since no connection then we come to a timeout.\n\nBut then this error is rewrap to something incorrect in `connectionpool.py`.\n\n``` python\n        except (TimeoutError, HTTPException, SocketError) as e:\n            if conn:\n                # Discard the connection for these exceptions. It will be\n                # be replaced during the next _get_conn() call.\n                conn.close()\n                conn = None\n\n            if not retries:\n                if isinstance(e, TimeoutError):\n                    # TimeoutError is exempt from MaxRetryError-wrapping.\n                    # FIXME: ... Not sure why. Add a reason here.\n                    raise\n\n                # Wrap unexpected exceptions with the most appropriate\n                # module-level exception and re-raise.\n                if isinstance(e, SocketError) and self.proxy:\n                    raise ProxyError('Cannot connect to proxy.', e)\n\n                if retries is False:\n                    raise ConnectionError('Connection failed.', e)\n\n                raise MaxRetryError(self, url, e)\n\n            # Keep track of the error for the retry warning.\n            err = e\n```\n\nand since there is a proxy. Boom. proxy error.\n\nSo **WRONG** advice in requests site and **bug** in urllib3.\nHope it can help.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2169/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2169/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2144", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2144/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2144/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2144/events", "html_url": "https://github.com/psf/requests/issues/2144", "id": 38386919, "node_id": "MDU6SXNzdWUzODM4NjkxOQ==", "number": 2144, "title": "socket.error exception not caught/wrapped in a requests exception (ConnectionError perhaps?)", "user": {"login": "rtdean", "id": 5319942, "node_id": "MDQ6VXNlcjUzMTk5NDI=", "avatar_url": "https://avatars.githubusercontent.com/u/5319942?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rtdean", "html_url": "https://github.com/rtdean", "followers_url": "https://api.github.com/users/rtdean/followers", "following_url": "https://api.github.com/users/rtdean/following{/other_user}", "gists_url": "https://api.github.com/users/rtdean/gists{/gist_id}", "starred_url": "https://api.github.com/users/rtdean/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rtdean/subscriptions", "organizations_url": "https://api.github.com/users/rtdean/orgs", "repos_url": "https://api.github.com/users/rtdean/repos", "events_url": "https://api.github.com/users/rtdean/events{/privacy}", "received_events_url": "https://api.github.com/users/rtdean/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-07-22T10:23:48Z", "updated_at": "2021-09-08T23:10:46Z", "closed_at": "2014-07-27T13:59:08Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "I just noticed a case where I had a socket reset on me, and was raised to me as a raw socket error as opposed to something like a requests.exceptions.ConnectionError:\n\n```\n  File \"/home/rtdean/***/***/***/***/***/***.py\", line 67, in dir_parse\n    root = ElementTree.fromstring(response.text)\n  File \"/home/rtdean/.pyenv/versions/2.7.6/lib/python2.7/site-packages/requests-2.3.0-py2.7.egg/requests/models.py\", line 721, in text\n    if not self.content:\n  File \"/home/rtdean/.pyenv/versions/2.7.6/lib/python2.7/site-packages/requests-2.3.0-py2.7.egg/requests/models.py\", line 694, in content\n    self._content = bytes().join(self.iter_content(CONTENT_CHUNK_SIZE)) or bytes()\n  File \"/home/rtdean/.pyenv/versions/2.7.6/lib/python2.7/site-packages/requests-2.3.0-py2.7.egg/requests/models.py\", line 627, in generate\n    for chunk in self.raw.stream(chunk_size, decode_content=True):\n  File \"/home/rtdean/.pyenv/versions/2.7.6/lib/python2.7/site-packages/requests-2.3.0-py2.7.egg/requests/packages/urllib3/response.py\", line 240, in stream\n    data = self.read(amt=amt, decode_content=decode_content)\n  File \"/home/rtdean/.pyenv/versions/2.7.6/lib/python2.7/site-packages/requests-2.3.0-py2.7.egg/requests/packages/urllib3/response.py\", line 187, in read\n    data = self._fp.read(amt)\n  File \"/home/rtdean/.pyenv/versions/2.7.6/lib/python2.7/httplib.py\", line 543, in read\n    return self._read_chunked(amt)\n  File \"/home/rtdean/.pyenv/versions/2.7.6/lib/python2.7/httplib.py\", line 612, in _read_chunked\n    value.append(self._safe_read(chunk_left))\n  File \"/home/rtdean/.pyenv/versions/2.7.6/lib/python2.7/httplib.py\", line 658, in _safe_read\n    chunk = self.fp.read(min(amt, MAXAMOUNT))\n  File \"/home/rtdean/.pyenv/versions/2.7.6/lib/python2.7/socket.py\", line 380, in read\n    data = self._sock.recv(left)\n  File \"/home/rtdean/.pyenv/versions/2.7.6/lib/python2.7/site-packages/gevent-1.0.1-py2.7-linux-x86_64.egg/gevent/socket.py\", line 385, in recv\n    return sock.recv(*args)\nsocket.error: [Errno 104] Connection reset by peer\n```\n\nNot sure if this is by accident or design... in general, I guess I'd expect a requests exception when using requests, but I can start looking for socket errors and the like as well.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2144/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2144/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2063", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2063/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2063/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2063/events", "html_url": "https://github.com/psf/requests/issues/2063", "id": 34271303, "node_id": "MDU6SXNzdWUzNDI3MTMwMw==", "number": 2063, "title": "Mutating Session.proxies does not work", "user": {"login": "asmeurer", "id": 71486, "node_id": "MDQ6VXNlcjcxNDg2", "avatar_url": "https://avatars.githubusercontent.com/u/71486?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asmeurer", "html_url": "https://github.com/asmeurer", "followers_url": "https://api.github.com/users/asmeurer/followers", "following_url": "https://api.github.com/users/asmeurer/following{/other_user}", "gists_url": "https://api.github.com/users/asmeurer/gists{/gist_id}", "starred_url": "https://api.github.com/users/asmeurer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asmeurer/subscriptions", "organizations_url": "https://api.github.com/users/asmeurer/orgs", "repos_url": "https://api.github.com/users/asmeurer/repos", "events_url": "https://api.github.com/users/asmeurer/events{/privacy}", "received_events_url": "https://api.github.com/users/asmeurer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 22, "created_at": "2014-05-25T19:42:09Z", "updated_at": "2021-09-09T00:00:55Z", "closed_at": "2014-05-28T08:06:33Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "This was originally brought up at https://github.com/kennethreitz/requests/issues/2061. If you change `session.proxies` after calling `session.get` and call `session.get` again, it does not use the updated value. You have to do `session.get(proxies=session.proxies)`. \n\nAssumedly this is not difficult to fix, since setting the keyword argument does work. I didn't read the code, though. \n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2063/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2063/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/2003", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/2003/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/2003/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/2003/events", "html_url": "https://github.com/psf/requests/issues/2003", "id": 31525291, "node_id": "MDU6SXNzdWUzMTUyNTI5MQ==", "number": 2003, "title": "auth kwarg cannot be used to authenticate an HTTPS request through a HTTP proxy", "user": {"login": "pjjw", "id": 638, "node_id": "MDQ6VXNlcjYzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/638?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pjjw", "html_url": "https://github.com/pjjw", "followers_url": "https://api.github.com/users/pjjw/followers", "following_url": "https://api.github.com/users/pjjw/following{/other_user}", "gists_url": "https://api.github.com/users/pjjw/gists{/gist_id}", "starred_url": "https://api.github.com/users/pjjw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pjjw/subscriptions", "organizations_url": "https://api.github.com/users/pjjw/orgs", "repos_url": "https://api.github.com/users/pjjw/repos", "events_url": "https://api.github.com/users/pjjw/events{/privacy}", "received_events_url": "https://api.github.com/users/pjjw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 117745, "node_id": "MDU6TGFiZWwxMTc3NDU=", "url": "https://api.github.com/repos/psf/requests/labels/Planned", "name": "Planned", "color": "e102d8", "default": false, "description": null}, {"id": 44501256, "node_id": "MDU6TGFiZWw0NDUwMTI1Ng==", "url": "https://api.github.com/repos/psf/requests/labels/Breaking%20API%20Change", "name": "Breaking API Change", "color": "eb6420", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/psf/requests/milestones/20", "html_url": "https://github.com/psf/requests/milestone/20", "labels_url": "https://api.github.com/repos/psf/requests/milestones/20/labels", "id": 487518, "node_id": "MDk6TWlsZXN0b25lNDg3NTE4", "number": 20, "title": "3.0.0", "description": null, "creator": {"login": "Lukasa", "id": 1382556, "node_id": "MDQ6VXNlcjEzODI1NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1382556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lukasa", "html_url": "https://github.com/Lukasa", "followers_url": "https://api.github.com/users/Lukasa/followers", "following_url": "https://api.github.com/users/Lukasa/following{/other_user}", "gists_url": "https://api.github.com/users/Lukasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lukasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lukasa/subscriptions", "organizations_url": "https://api.github.com/users/Lukasa/orgs", "repos_url": "https://api.github.com/users/Lukasa/repos", "events_url": "https://api.github.com/users/Lukasa/events{/privacy}", "received_events_url": "https://api.github.com/users/Lukasa/received_events", "type": "User", "site_admin": false}, "open_issues": 16, "closed_issues": 28, "state": "open", "created_at": "2013-11-17T11:29:34Z", "updated_at": "2018-11-13T12:55:46Z", "due_on": null, "closed_at": null}, "comments": 7, "created_at": "2014-04-15T04:18:58Z", "updated_at": "2021-09-08T13:05:39Z", "closed_at": "2016-12-17T17:00:48Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "i mean so this is probably more of a rant than an issue, but that was 3 hours i won't get back.\n\nwas trying to pipe requests through a squid proxy in a lights-out environment. credentials come from a data store separate from configuration, so seemed reasonable to use requests.auth.HTTPProxyAuth(l, p) as the auth kwarg as (what i thought) a supplement to the proxies dict fed to the proxies kwarg. this works fine for http requests, but this seems to be by accident- it falls apart when making an https request through a proxy, when urllib3 uses the CONNECT verb to encapsulate the request.\n\nbasically requests.auth.HTTPProxyAuth doesn't make it clear that it's not the correct (always working) way to authenticate to a proxy, but that you must put the credentials into the proxy url in the proxies dict. deprecation/removal of that class would probably make the interface cleaner- failing that, a note in the source would be nice.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/2003/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/2003/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1871", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1871/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1871/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1871/events", "html_url": "https://github.com/psf/requests/issues/1871", "id": 25912107, "node_id": "MDU6SXNzdWUyNTkxMjEwNw==", "number": 1871, "title": "Our use of urllib3's ConnectionPools is not threadsafe.", "user": {"login": "Lukasa", "id": 1382556, "node_id": "MDQ6VXNlcjEzODI1NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1382556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lukasa", "html_url": "https://github.com/Lukasa", "followers_url": "https://api.github.com/users/Lukasa/followers", "following_url": "https://api.github.com/users/Lukasa/following{/other_user}", "gists_url": "https://api.github.com/users/Lukasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lukasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lukasa/subscriptions", "organizations_url": "https://api.github.com/users/Lukasa/orgs", "repos_url": "https://api.github.com/users/Lukasa/repos", "events_url": "https://api.github.com/users/Lukasa/events{/privacy}", "received_events_url": "https://api.github.com/users/Lukasa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 117745, "node_id": "MDU6TGFiZWwxMTc3NDU=", "url": "https://api.github.com/repos/psf/requests/labels/Planned", "name": "Planned", "color": "e102d8", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/psf/requests/milestones/20", "html_url": "https://github.com/psf/requests/milestone/20", "labels_url": "https://api.github.com/repos/psf/requests/milestones/20/labels", "id": 487518, "node_id": "MDk6TWlsZXN0b25lNDg3NTE4", "number": 20, "title": "3.0.0", "description": null, "creator": {"login": "Lukasa", "id": 1382556, "node_id": "MDQ6VXNlcjEzODI1NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1382556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lukasa", "html_url": "https://github.com/Lukasa", "followers_url": "https://api.github.com/users/Lukasa/followers", "following_url": "https://api.github.com/users/Lukasa/following{/other_user}", "gists_url": "https://api.github.com/users/Lukasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lukasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lukasa/subscriptions", "organizations_url": "https://api.github.com/users/Lukasa/orgs", "repos_url": "https://api.github.com/users/Lukasa/repos", "events_url": "https://api.github.com/users/Lukasa/events{/privacy}", "received_events_url": "https://api.github.com/users/Lukasa/received_events", "type": "User", "site_admin": false}, "open_issues": 16, "closed_issues": 28, "state": "open", "created_at": "2013-11-17T11:29:34Z", "updated_at": "2018-11-13T12:55:46Z", "due_on": null, "closed_at": null}, "comments": 27, "created_at": "2014-01-20T11:09:18Z", "updated_at": "2021-08-30T00:06:12Z", "closed_at": "2018-02-24T14:55:18Z", "author_association": "MEMBER", "active_lock_reason": "resolved", "body": "We use a `PoolManager` to provide us with connection pools from urllib3. However, we don't actually run our requests through it: instead we get a suitable `ConnectionPool` and then use `urlopen` on that instead.\n\nThis _can_ lead to bugs when using threads and hitting a large number of hosts from one `Session` object. Each host creates a new `ConnectionPool` in the `PoolManager`: if too many are created, the least recently used one is evicted.\n\nIf that eviction happens in between us getting hold of the `ConnectionPool` and us actually trying to send a request, we can try to send on a closed connection pool. That's pretty lame. You can see the discussion on IRC that led to this issue [here](https://botbot.me/freenode/python-requests/msg/9980059/).\n\nWe can either try to make that section thread safe, or try to reconnect when we hit closed pool errors. Thoughts?\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1871/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1871/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1767", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1767/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1767/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1767/events", "html_url": "https://github.com/psf/requests/issues/1767", "id": 23533930, "node_id": "MDU6SXNzdWUyMzUzMzkzMA==", "number": 1767, "title": "HTTP Basic Auth credentials extracted from URL are %-encoded", "user": {"login": "lw", "id": 120810, "node_id": "MDQ6VXNlcjEyMDgxMA==", "avatar_url": "https://avatars.githubusercontent.com/u/120810?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lw", "html_url": "https://github.com/lw", "followers_url": "https://api.github.com/users/lw/followers", "following_url": "https://api.github.com/users/lw/following{/other_user}", "gists_url": "https://api.github.com/users/lw/gists{/gist_id}", "starred_url": "https://api.github.com/users/lw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lw/subscriptions", "organizations_url": "https://api.github.com/users/lw/orgs", "repos_url": "https://api.github.com/users/lw/repos", "events_url": "https://api.github.com/users/lw/events{/privacy}", "received_events_url": "https://api.github.com/users/lw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 67760318, "node_id": "MDU6TGFiZWw2Nzc2MDMxOA==", "url": "https://api.github.com/repos/psf/requests/labels/Fixed", "name": "Fixed", "color": "5319e7", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2013-12-01T09:22:15Z", "updated_at": "2021-09-09T00:34:14Z", "closed_at": "2013-12-04T01:36:00Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "I was relying on credential auto-extraction from the hostname [1] to perform HTTP Basic Auth but I was getting \"401 Unauthorized\": the spaces in the password were substituted by `%20`. Manually extracting them with `urlsplit` and passing them to the `auth` parameter as a tuple works.\n\n[1] http://docs.python-requests.org/en/latest/user/authentication/#netrc-authentication (second paragraph)\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1767/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1767/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1755", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1755/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1755/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1755/events", "html_url": "https://github.com/psf/requests/issues/1755", "id": 23204417, "node_id": "MDU6SXNzdWUyMzIwNDQxNw==", "number": 1755, "title": "Streaming uploads with HTTPBasicAuth causes stuck on resending the request", "user": {"login": "akitada", "id": 53781, "node_id": "MDQ6VXNlcjUzNzgx", "avatar_url": "https://avatars.githubusercontent.com/u/53781?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akitada", "html_url": "https://github.com/akitada", "followers_url": "https://api.github.com/users/akitada/followers", "following_url": "https://api.github.com/users/akitada/following{/other_user}", "gists_url": "https://api.github.com/users/akitada/gists{/gist_id}", "starred_url": "https://api.github.com/users/akitada/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akitada/subscriptions", "organizations_url": "https://api.github.com/users/akitada/orgs", "repos_url": "https://api.github.com/users/akitada/repos", "events_url": "https://api.github.com/users/akitada/events{/privacy}", "received_events_url": "https://api.github.com/users/akitada/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 67760318, "node_id": "MDU6TGFiZWw2Nzc2MDMxOA==", "url": "https://api.github.com/repos/psf/requests/labels/Fixed", "name": "Fixed", "color": "5319e7", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2013-11-24T12:30:06Z", "updated_at": "2021-09-09T00:28:34Z", "closed_at": "2013-12-05T23:04:56Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "`HTTPBasicAuth` seems to have the same issue described in requests/requests-kerberos#23.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1755/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1755/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1746", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1746/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1746/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1746/events", "html_url": "https://github.com/psf/requests/issues/1746", "id": 22895987, "node_id": "MDU6SXNzdWUyMjg5NTk4Nw==", "number": 1746, "title": "Don't lowercase the whole URL when opening a connection", "user": {"login": "Lukasa", "id": 1382556, "node_id": "MDQ6VXNlcjEzODI1NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1382556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lukasa", "html_url": "https://github.com/Lukasa", "followers_url": "https://api.github.com/users/Lukasa/followers", "following_url": "https://api.github.com/users/Lukasa/following{/other_user}", "gists_url": "https://api.github.com/users/Lukasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lukasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lukasa/subscriptions", "organizations_url": "https://api.github.com/users/Lukasa/orgs", "repos_url": "https://api.github.com/users/Lukasa/repos", "events_url": "https://api.github.com/users/Lukasa/events{/privacy}", "received_events_url": "https://api.github.com/users/Lukasa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 67760318, "node_id": "MDU6TGFiZWw2Nzc2MDMxOA==", "url": "https://api.github.com/repos/psf/requests/labels/Fixed", "name": "Fixed", "color": "5319e7", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2013-11-19T08:53:32Z", "updated_at": "2021-09-09T00:28:34Z", "closed_at": "2013-12-05T23:05:08Z", "author_association": "MEMBER", "active_lock_reason": "resolved", "body": "As mentioned [here](https://github.com/kennethreitz/requests/commit/01993d21dc7d6fa8f0acf657425d2fead9b2ddea).\n\nThe specific line of code in question is [here](https://github.com/kennethreitz/requests/blob/master/requests/adapters.py#L209). We're lowercasing the whole URL. This _should_ be fine, but in practice there are clearly servers that will expect the `Host` header to match a specific case (because they're stupid).\n\nWe should fix this, especially as fixing it is so easy (we only want to lowercase the scheme) and doesn't hurt us at all.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1746/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1746/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1732", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1732/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1732/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1732/events", "html_url": "https://github.com/psf/requests/issues/1732", "id": 22382764, "node_id": "MDU6SXNzdWUyMjM4Mjc2NA==", "number": 1732, "title": "SNI support broken on Python 2.X in 2.0.1.", "user": {"login": "Lukasa", "id": 1382556, "node_id": "MDQ6VXNlcjEzODI1NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1382556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lukasa", "html_url": "https://github.com/Lukasa", "followers_url": "https://api.github.com/users/Lukasa/followers", "following_url": "https://api.github.com/users/Lukasa/following{/other_user}", "gists_url": "https://api.github.com/users/Lukasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lukasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lukasa/subscriptions", "organizations_url": "https://api.github.com/users/Lukasa/orgs", "repos_url": "https://api.github.com/users/Lukasa/repos", "events_url": "https://api.github.com/users/Lukasa/events{/privacy}", "received_events_url": "https://api.github.com/users/Lukasa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 67760318, "node_id": "MDU6TGFiZWw2Nzc2MDMxOA==", "url": "https://api.github.com/repos/psf/requests/labels/Fixed", "name": "Fixed", "color": "5319e7", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/psf/requests/milestones/19", "html_url": "https://github.com/psf/requests/milestone/19", "labels_url": "https://api.github.com/repos/psf/requests/milestones/19/labels", "id": 479442, "node_id": "MDk6TWlsZXN0b25lNDc5NDQy", "number": 19, "title": "2.0.2", "description": null, "creator": {"login": "Lukasa", "id": 1382556, "node_id": "MDQ6VXNlcjEzODI1NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1382556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lukasa", "html_url": "https://github.com/Lukasa", "followers_url": "https://api.github.com/users/Lukasa/followers", "following_url": "https://api.github.com/users/Lukasa/following{/other_user}", "gists_url": "https://api.github.com/users/Lukasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lukasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lukasa/subscriptions", "organizations_url": "https://api.github.com/users/Lukasa/orgs", "repos_url": "https://api.github.com/users/Lukasa/repos", "events_url": "https://api.github.com/users/Lukasa/events{/privacy}", "received_events_url": "https://api.github.com/users/Lukasa/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 1, "state": "closed", "created_at": "2013-11-09T08:57:36Z", "updated_at": "2014-12-25T16:11:49Z", "due_on": null, "closed_at": "2014-12-25T16:11:49Z"}, "comments": 3, "created_at": "2013-11-09T08:57:36Z", "updated_at": "2021-09-08T23:08:00Z", "closed_at": "2013-12-05T23:05:18Z", "author_association": "MEMBER", "active_lock_reason": "resolved", "body": "`urllib3` had a bug, we accidentally pulled it in, we didn't catch it because we don't test with SNI support (should we have that as a separate build?). Happily the awesome @t-8ch has already provided us with a patch, which is already merged, so we don't necessarily have an action on this: it'll be quietly fixed in the next release. Just raising this issue so that people who look on the issue tracker see it.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1732/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1732/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1711", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1711/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1711/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1711/events", "html_url": "https://github.com/psf/requests/issues/1711", "id": 21753302, "node_id": "MDU6SXNzdWUyMTc1MzMwMg==", "number": 1711, "title": "Regression 2.0.1: Using MozillaCookieJar does not work", "user": {"login": "abn", "id": 165325, "node_id": "MDQ6VXNlcjE2NTMyNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/165325?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abn", "html_url": "https://github.com/abn", "followers_url": "https://api.github.com/users/abn/followers", "following_url": "https://api.github.com/users/abn/following{/other_user}", "gists_url": "https://api.github.com/users/abn/gists{/gist_id}", "starred_url": "https://api.github.com/users/abn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abn/subscriptions", "organizations_url": "https://api.github.com/users/abn/orgs", "repos_url": "https://api.github.com/users/abn/repos", "events_url": "https://api.github.com/users/abn/events{/privacy}", "received_events_url": "https://api.github.com/users/abn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 67760318, "node_id": "MDU6TGFiZWw2Nzc2MDMxOA==", "url": "https://api.github.com/repos/psf/requests/labels/Fixed", "name": "Fixed", "color": "5319e7", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2013-10-29T12:27:21Z", "updated_at": "2021-09-08T23:10:52Z", "closed_at": "2013-12-04T01:33:33Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Could not find an issue raised for this, not sure if this was an expected change either. This is reproducible on master.\n\nExisting code fails on update to `requests-2.0.1`. The cause seems to be triggered by the change at https://github.com/kennethreitz/requests/commit/012f0334ce43fe23044fc58e4246a804db88650d#diff-28e67177469c0d36b068d68d9f6043bfR326\n\nThe parameter `cookies` expects either `Dict` or `CookieJar`. Treating `MozillaCookieJar` as a dict triggers the error in this instance.\n\nThe following code highlights the issue:\n\n``` py\nimport sys\nimport requests\nfrom os.path import expanduser\n\nif sys.version_info.major >= 3:\n    from http.cookiejar import MozillaCookieJar\nelse:\n    from cookielib import MozillaCookieJar\n\nURL = 'https://bugzilla.redhat.com'\nCOOKIE_FILE = expanduser('~/.bugzillacookies')\n\ncookiejar = MozillaCookieJar(COOKIE_FILE)\ncookiejar.load()\n\nrequests.get(URL, cookies=cookiejar)\n```\n\nThe following `AttributeError` is thrown:\n\n```\nTraceback (most recent call last):\n  File \"rtest.py\", line 16, in <module>\n    requests.get(URL, cookies=cookiejar)\n  File \"/tmp/rtestenv/lib/python2.7/site-packages/requests/api.py\", line 55, in get\n    return request('get', url, **kwargs)\n  File \"/tmp/rtestenv/lib/python2.7/site-packages/requests/api.py\", line 44, in request\n    return session.request(method=method, url=url, **kwargs)\n  File \"/tmp/rtestenv/lib/python2.7/site-packages/requests/sessions.py\", line 327, in request\n    self.cookies = cookiejar_from_dict(cookies, cookiejar=self.cookies, overwrite=False)\n  File \"/tmp/rtestenv/lib/python2.7/site-packages/requests/cookies.py\", line 410, in cookiejar_from_dict\n    cookiejar.set_cookie(create_cookie(name, cookie_dict[name]))\nAttributeError: MozillaCookieJar instance has no attribute '__getitem__'\n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1711/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1711/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1703", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1703/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1703/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1703/events", "html_url": "https://github.com/psf/requests/issues/1703", "id": 21576662, "node_id": "MDU6SXNzdWUyMTU3NjY2Mg==", "number": 1703, "title": "proxy with authentication fails in requests 2.0", "user": {"login": "borisnieuwenhuis", "id": 314468, "node_id": "MDQ6VXNlcjMxNDQ2OA==", "avatar_url": "https://avatars.githubusercontent.com/u/314468?v=4", "gravatar_id": "", "url": "https://api.github.com/users/borisnieuwenhuis", "html_url": "https://github.com/borisnieuwenhuis", "followers_url": "https://api.github.com/users/borisnieuwenhuis/followers", "following_url": "https://api.github.com/users/borisnieuwenhuis/following{/other_user}", "gists_url": "https://api.github.com/users/borisnieuwenhuis/gists{/gist_id}", "starred_url": "https://api.github.com/users/borisnieuwenhuis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/borisnieuwenhuis/subscriptions", "organizations_url": "https://api.github.com/users/borisnieuwenhuis/orgs", "repos_url": "https://api.github.com/users/borisnieuwenhuis/repos", "events_url": "https://api.github.com/users/borisnieuwenhuis/events{/privacy}", "received_events_url": "https://api.github.com/users/borisnieuwenhuis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 67760318, "node_id": "MDU6TGFiZWw2Nzc2MDMxOA==", "url": "https://api.github.com/repos/psf/requests/labels/Fixed", "name": "Fixed", "color": "5319e7", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2013-10-25T08:30:03Z", "updated_at": "2021-09-09T00:28:33Z", "closed_at": "2013-12-05T23:05:28Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "It seems new version broke proxy with authentication when using proxy_url of the form http://username:password@proxy_url\n\ntest script output from version 1.2.3\n\nINFO:requests.packages.urllib3.connectionpool:Starting new HTTP connection (1): obproxy.telegraaf.net\nsend: 'GET http://nu.nl HTTP/1.1\\r\\nHost: www.cleafs.nl\\r\\nProxy-Authorization: Basic 34hdsfhkjhs95jfsdkljf\\r\\nAccept-Encoding: gzip, deflate, compress\\r\\nAccept: _/_\\r\\nUser-Agent: python-requests/1.2.3 CPython/2.7.3 \n\nwhile exactly same script in requests 2.0 doesnt send basic auth header and gets a request denied from proxy\n\nINFO:requests.packages.urllib3.connectionpool:Starting new HTTP connection (1): \n\nPROXY Url(scheme='http', auth='username:password', host='obproxy.telegraaf.net', port=3128, path=None, query=None, fragment=None)\nINFO:requests.packages.urllib3.connectionpool:Starting new HTTP connection (1): obproxy.telegraaf.net\nsend: 'GET http://www.nu.nl/ HTTP/1.1\\r\\nHost: www.nu.nl\\r\\nAccept-Encoding: gzip, deflate, compress\\r\\nAccept: _/_\\r\\nUser-Agent: python-requests/2.0.0 CPython/2.7.3 Linux/3.7.2-vs2.3.5.5-d64-i7\\r\\n\\r\\n'\nDEBUG:requests.packages.urllib3.connectionpool:Setting read timeout to <object object at 0x7feaa083b0e0>\nreply: 'HTTP/1.0 407 Proxy Authentication Required\\r\\n'\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1703/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1703/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1685", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1685/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1685/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1685/events", "html_url": "https://github.com/psf/requests/issues/1685", "id": 21168649, "node_id": "MDU6SXNzdWUyMTE2ODY0OQ==", "number": 1685, "title": "Possible Memory Leak", "user": {"login": "philip-goh", "id": 70234, "node_id": "MDQ6VXNlcjcwMjM0", "avatar_url": "https://avatars.githubusercontent.com/u/70234?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philip-goh", "html_url": "https://github.com/philip-goh", "followers_url": "https://api.github.com/users/philip-goh/followers", "following_url": "https://api.github.com/users/philip-goh/following{/other_user}", "gists_url": "https://api.github.com/users/philip-goh/gists{/gist_id}", "starred_url": "https://api.github.com/users/philip-goh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philip-goh/subscriptions", "organizations_url": "https://api.github.com/users/philip-goh/orgs", "repos_url": "https://api.github.com/users/philip-goh/repos", "events_url": "https://api.github.com/users/philip-goh/events{/privacy}", "received_events_url": "https://api.github.com/users/philip-goh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 54, "created_at": "2013-10-17T17:03:10Z", "updated_at": "2021-09-05T00:06:47Z", "closed_at": "2016-04-16T04:18:33Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "I have a very simple program that periodically retrieves an image from an IP camera. I've noticed that the working set of this program grows monotonically. I've written a small program that reproduces the issue.\n\n``` python\nimport requests\nfrom memory_profiler import profile\n\n\n@profile\ndef lol():\n    print \"sending request\"\n    r = requests.get('http://cachefly.cachefly.net/10mb.test')\n    print \"reading..\"\n    with open(\"test.dat\", \"wb\") as f:\n        f.write(r.content)\n    print \"Finished...\"\n\nif __name__==\"__main__\":\n    for i in xrange(100):\n        print \"Iteration\", i\n        lol()\n```\n\nThe memory usage is printed at the end of each iteration. This is the sample output.\n*\\* Iteration 0 **\n\n```\nIteration 0\nsending request\nreading..\nFinished...\nFilename: test.py\n\nLine #    Mem usage    Increment   Line Contents\n================================================\n     5     12.5 MiB      0.0 MiB   @profile\n     6                             def lol():\n     7     12.5 MiB      0.0 MiB       print \"sending request\"\n     8     35.6 MiB     23.1 MiB       r = requests.get('http://cachefly.cachefly.net/10mb.test')\n     9     35.6 MiB      0.0 MiB       print \"reading..\"\n    10     35.6 MiB      0.0 MiB       with open(\"test.dat\", \"wb\") as f:\n    11     35.6 MiB      0.0 MiB        f.write(r.content)\n    12     35.6 MiB      0.0 MiB       print \"Finished...\"\n```\n\n*\\* Iteration 1 **\n\n```\nIteration 1\nsending request\nreading..\nFinished...\nFilename: test.py\n\nLine #    Mem usage    Increment   Line Contents\n================================================\n     5     35.6 MiB      0.0 MiB   @profile\n     6                             def lol():\n     7     35.6 MiB      0.0 MiB       print \"sending request\"\n     8     36.3 MiB      0.7 MiB       r = requests.get('http://cachefly.cachefly.net/10mb.test')\n     9     36.3 MiB      0.0 MiB       print \"reading..\"\n    10     36.3 MiB      0.0 MiB       with open(\"test.dat\", \"wb\") as f:\n    11     36.3 MiB      0.0 MiB        f.write(r.content)\n    12     36.3 MiB      0.0 MiB       print \"Finished...\"\n```\n\nThe memory usage does not grow with every iteration, but it does continue to creep up with `requests.get` being the culprit that increases memory usage.\n\nBy *\\* Iteration 99 *\\* this is what the memory profile looks like.\n\n```\nIteration 99\nsending request\nreading..\nFinished...\nFilename: test.py\n\nLine #    Mem usage    Increment   Line Contents\n================================================\n     5     40.7 MiB      0.0 MiB   @profile\n     6                             def lol():\n     7     40.7 MiB      0.0 MiB       print \"sending request\"\n     8     40.7 MiB      0.0 MiB       r = requests.get('http://cachefly.cachefly.net/10mb.test')\n     9     40.7 MiB      0.0 MiB       print \"reading..\"\n    10     40.7 MiB      0.0 MiB       with open(\"test.dat\", \"wb\") as f:\n    11     40.7 MiB      0.0 MiB        f.write(r.content)\n    12     40.7 MiB      0.0 MiB       print \"Finished...\"\n```\n\nMemory usage doesn't drop unless the program is terminated.\n\nIs there a bug or is it user error? \n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1685/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1685/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1655", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1655/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1655/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1655/events", "html_url": "https://github.com/psf/requests/issues/1655", "id": 20603230, "node_id": "MDU6SXNzdWUyMDYwMzIzMA==", "number": 1655, "title": "Session hooks broken", "user": {"login": "mgax", "id": 27617, "node_id": "MDQ6VXNlcjI3NjE3", "avatar_url": "https://avatars.githubusercontent.com/u/27617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mgax", "html_url": "https://github.com/mgax", "followers_url": "https://api.github.com/users/mgax/followers", "following_url": "https://api.github.com/users/mgax/following{/other_user}", "gists_url": "https://api.github.com/users/mgax/gists{/gist_id}", "starred_url": "https://api.github.com/users/mgax/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mgax/subscriptions", "organizations_url": "https://api.github.com/users/mgax/orgs", "repos_url": "https://api.github.com/users/mgax/repos", "events_url": "https://api.github.com/users/mgax/events{/privacy}", "received_events_url": "https://api.github.com/users/mgax/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}, {"id": 67760318, "node_id": "MDU6TGFiZWw2Nzc2MDMxOA==", "url": "https://api.github.com/repos/psf/requests/labels/Fixed", "name": "Fixed", "color": "5319e7", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2013-10-07T10:24:32Z", "updated_at": "2021-09-09T00:28:35Z", "closed_at": "2013-12-04T01:33:42Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Request hooks are being [merged](https://github.com/kennethreitz/requests/blob/master/requests/sessions.py#L264) with session hooks; since both hook dicts have a list as the value, one simply overwrites the other.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1655/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1655/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1648", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1648/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1648/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1648/events", "html_url": "https://github.com/psf/requests/issues/1648", "id": 20491066, "node_id": "MDU6SXNzdWUyMDQ5MTA2Ng==", "number": 1648, "title": "Header \"Transfer-Encoding: chunked\" set even if Content-Length is provided which causes body to not actually get chunked", "user": {"login": "ysangkok", "id": 284023, "node_id": "MDQ6VXNlcjI4NDAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/284023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ysangkok", "html_url": "https://github.com/ysangkok", "followers_url": "https://api.github.com/users/ysangkok/followers", "following_url": "https://api.github.com/users/ysangkok/following{/other_user}", "gists_url": "https://api.github.com/users/ysangkok/gists{/gist_id}", "starred_url": "https://api.github.com/users/ysangkok/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ysangkok/subscriptions", "organizations_url": "https://api.github.com/users/ysangkok/orgs", "repos_url": "https://api.github.com/users/ysangkok/repos", "events_url": "https://api.github.com/users/ysangkok/events{/privacy}", "received_events_url": "https://api.github.com/users/ysangkok/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 44501256, "node_id": "MDU6TGFiZWw0NDUwMTI1Ng==", "url": "https://api.github.com/repos/psf/requests/labels/Breaking%20API%20Change", "name": "Breaking API Change", "color": "eb6420", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 52, "created_at": "2013-10-04T00:02:56Z", "updated_at": "2021-09-08T12:00:49Z", "closed_at": "2017-03-02T16:28:35Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "## Test script\n\n```\nimport requests\nimport time\n\ndef f():\n    yield b\"lol\"\n    time.sleep(2)\n    yield b\"man\"\n\nrequests.post('http://127.0.0.1:8801/', data=f(), headers={\"Content-Length\": 6})\n```\n## Actual result\n\nReceived on the server:\n\n```\n$ nc -p 8801 -l\nPOST / HTTP/1.1\nHost: 127.0.0.1:8801\nUser-Agent: python-requests/2.0.0 CPython/3.3.1 Linux/3.11.0-031100rc4-generic\nAccept: */*\nTransfer-Encoding: chunked\nContent-Length: 6\nAccept-Encoding: gzip, deflate, compress\n\nlolman\n```\n## Expected result\n\nDid not expect \"Transfer-Encoding: chunked\" since I provided the Content-Length. If requests insists on doing chunked transfer encoding, it should disregard the content length and actually chunk the content (as it does if there is not Content-Length header given).\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1648/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1648/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1642", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1642/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1642/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1642/events", "html_url": "https://github.com/psf/requests/issues/1642", "id": 20391006, "node_id": "MDU6SXNzdWUyMDM5MTAwNg==", "number": 1642, "title": "Requests doesn't clean up on failed streaming uploads.", "user": {"login": "Lukasa", "id": 1382556, "node_id": "MDQ6VXNlcjEzODI1NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1382556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lukasa", "html_url": "https://github.com/Lukasa", "followers_url": "https://api.github.com/users/Lukasa/followers", "following_url": "https://api.github.com/users/Lukasa/following{/other_user}", "gists_url": "https://api.github.com/users/Lukasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lukasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lukasa/subscriptions", "organizations_url": "https://api.github.com/users/Lukasa/orgs", "repos_url": "https://api.github.com/users/Lukasa/repos", "events_url": "https://api.github.com/users/Lukasa/events{/privacy}", "received_events_url": "https://api.github.com/users/Lukasa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2013-10-02T12:33:03Z", "updated_at": "2021-09-09T00:28:33Z", "closed_at": "2013-12-05T23:06:26Z", "author_association": "MEMBER", "active_lock_reason": "resolved", "body": "From [Reddit](http://www.reddit.com/r/Python/comments/1njuk5/python_for_network_engineers/ccjh56a):\n\n> For instance, if you use it in a generator to stream content from a request and the connection dies, it doesn't clean up properly. You have to call close on the underlying socket but that's not done and it's not exposed to you.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1642/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1642/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1630", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1630/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1630/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1630/events", "html_url": "https://github.com/psf/requests/issues/1630", "id": 20158932, "node_id": "MDU6SXNzdWUyMDE1ODkzMg==", "number": 1630, "title": "Cookies not persisted when set via functional API.", "user": {"login": "Lukasa", "id": 1382556, "node_id": "MDQ6VXNlcjEzODI1NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1382556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lukasa", "html_url": "https://github.com/Lukasa", "followers_url": "https://api.github.com/users/Lukasa/followers", "following_url": "https://api.github.com/users/Lukasa/following{/other_user}", "gists_url": "https://api.github.com/users/Lukasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lukasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lukasa/subscriptions", "organizations_url": "https://api.github.com/users/Lukasa/orgs", "repos_url": "https://api.github.com/users/Lukasa/repos", "events_url": "https://api.github.com/users/Lukasa/events{/privacy}", "received_events_url": "https://api.github.com/users/Lukasa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2013-09-27T08:50:44Z", "updated_at": "2021-09-09T00:34:24Z", "closed_at": "2013-10-07T23:22:49Z", "author_association": "MEMBER", "active_lock_reason": "resolved", "body": "Cookies set as part of a call to `Session.request()` (or any of the top level methods that call it) are _not_ persisted, including on redirects.\n\nExpected behaviour:\n\n``` python\n>>> s = requests.Session()\n>>> r = s.get('http://httpbin.org/redirect/1', cookies={'Hi': 'There'})\n>>> print r.request.headers['Cookie']\n'hi=there'\n```\n\nActual behaviour:\n\n``` python\n>>> s = requests.Session()\n>>> r = s.get('http://httpbin.org/redirect/1', cookies={'Hi': 'There'})\n>>> print r.request.headers['Cookie']\nKeyError: 'cookie'\n```\n\nAnd, a super extra bonus bug:\n\n``` python\n>>> r.history[0].request.headers['Cookie']\nKeyError: 'cookie'\n```\n\neven though we definitely sent the cookie on the first request.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1630/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1630/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1622", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1622/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1622/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1622/events", "html_url": "https://github.com/psf/requests/issues/1622", "id": 20020060, "node_id": "MDU6SXNzdWUyMDAyMDA2MA==", "number": 1622, "title": "Requests 2.0.0 breaks SSL proxying via https_port of Squid.", "user": {"login": "GrahamDumpleton", "id": 507637, "node_id": "MDQ6VXNlcjUwNzYzNw==", "avatar_url": "https://avatars.githubusercontent.com/u/507637?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GrahamDumpleton", "html_url": "https://github.com/GrahamDumpleton", "followers_url": "https://api.github.com/users/GrahamDumpleton/followers", "following_url": "https://api.github.com/users/GrahamDumpleton/following{/other_user}", "gists_url": "https://api.github.com/users/GrahamDumpleton/gists{/gist_id}", "starred_url": "https://api.github.com/users/GrahamDumpleton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GrahamDumpleton/subscriptions", "organizations_url": "https://api.github.com/users/GrahamDumpleton/orgs", "repos_url": "https://api.github.com/users/GrahamDumpleton/repos", "events_url": "https://api.github.com/users/GrahamDumpleton/events{/privacy}", "received_events_url": "https://api.github.com/users/GrahamDumpleton/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 167537670, "node_id": "MDU6TGFiZWwxNjc1Mzc2NzA=", "url": "https://api.github.com/repos/psf/requests/labels/Propose%20Close", "name": "Propose Close", "color": "f7c6c7", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 40, "created_at": "2013-09-25T03:16:36Z", "updated_at": "2021-09-08T23:06:05Z", "closed_at": "2015-01-19T09:25:49Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "For a Squid configuration of:\n\n```\nhttp_port 3128\nhttps_port 3129 cert=/usr/local/opt/squid/etc/ssl/squid.crt key=/usr/local/opt/squid/etc/ssl/squid.key\n```\n\nAnd test names where:\n\nThe 'http_port' annotation indicates whether Squid HTTP port was used.\n\nThe 'https_port' annotation indicates whether Squid HTTPS port was used.\n\nThe 'scheme' annotation in test names refers to whether the scheme was part of proxy definition in proxies dictionary passed to requests\n\n```\nno_scheme --> { 'https': 'localhost:3129' }\nhttp_scheme --> { 'https': 'http://localhost:3129' }\nhttps_scheme --> { 'https': 'https://localhost:3129' }\n```\n\nResults for different requests versions are:\n\n```\n                    requests        0.9.3   1.2.3   2.0.0\n\n                    no_proxy        PASS    PASS    PASS\n         http_port_no_scheme        PASS    FAIL    FAIL\n  http_port_with_http_scheme        PASS    PASS    PASS\n http_port_with_https_scheme        FAIL    FAIL    PASS\n        https_port_no_scheme        FAIL    PASS    FAIL\n https_port_with_http_scheme        FAIL    FAIL    FAIL\nhttps_port_with_https_scheme        PASS    PASS    FAIL\n```\n\nThe problem one I am concerned about is https_port_with_https_scheme as this no longer works any more.\n\nI fully realise that http_port_with_https_scheme now works and that this presumably would use CONNECT as is the safest option, but we would have to notify all customers relying on https_port_with_https_scheme that what they used before no longer works and they will need to change their configuration they have. If they don't heed that instruction, then we will start see failed connections and complaints.\n\nBTW, it would be really good if the documentation explained the differences between all the combinations, what mechanisms they use and what represents best practice for being the safest/best to use.\n\nTest used for https_port_with_https_scheme is:\n\n```\nimport unittest\nimport requests\n\nPROXY_HOST = 'localhost'\nPROXY_HTTP_PORT = 3128\nPROXY_HTTPS_PORT = 3129\n\nREMOTE_URL = 'https://pypi.python.org/pypi'\n\nclass TestProxyingOfSSLRequests(unittest.TestCase):\n\n    def test_proxy_via_squid_https_port_with_https_scheme(self):\n        proxies = { 'https': 'https://%s:%s' % (PROXY_HOST, PROXY_HTTPS_PORT) }\n\n        response = requests.get(REMOTE_URL, proxies=proxies)\n\n        self.assertTrue(len(response.content) != 0)\n\nif __name__ == '__main__':\n    unittest.main()\n```\n\nFor full set of tests and results see:\n- https://dl.dropboxusercontent.com/u/22571016/requests-ssl-proxy.tar\n\nCheat sheet for setting up Squid on MacOS X with SSL support from our own cheat sheet is:\n\nTo test proxying via SSL, the easiest thing to do is install 'squid' via 'brew' under MacOSX, but avoid the standard recipe and instead use:\n\n```\nbrew install https://raw.github.com/mxcl/homebrew/a7bf4c381f4e38c24fb23493a92851ea8339493e/Library/Formula/squid.rb\n```\n\nThis will install 'squid' with SSL support.\n\nYou can then generate a self signed certificate to use:\n\n```\ncd /usr/local/opt/squid/etc\nmkdir ssl\ncd ssl\n\nopenssl genrsa -des3 -out squid.key 1024\nopenssl req -new -key squid.key -out squid.csr\ncp squid.key squid.key.org\nopenssl rsa -in squid.key.org -out squid.key\nopenssl x509 -req -days 365 -in squid.csr -signkey squid.key -out squid.crt\n```\n\nThen edit the the squid configuration file at '/usr/local/opt/squid/etc/squid.conf', adding:\n\n```\nhttps_port 3129 cert=/usr/local/opt/squid/etc/ssl/squid.crt key=/usr/local/opt/squid/etc/ssl/squid.key\n```\n\nThen use configuration of:\n\n```\nproxy_host = localhost\nproxy_port = 3129\n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1622/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1622/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1572", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1572/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1572/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1572/events", "html_url": "https://github.com/psf/requests/issues/1572", "id": 18898078, "node_id": "MDU6SXNzdWUxODg5ODA3OA==", "number": 1572, "title": "urllib3 exceptions passing through requests API", "user": {"login": "sylvinus", "id": 410452, "node_id": "MDQ6VXNlcjQxMDQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/410452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sylvinus", "html_url": "https://github.com/sylvinus", "followers_url": "https://api.github.com/users/sylvinus/followers", "following_url": "https://api.github.com/users/sylvinus/following{/other_user}", "gists_url": "https://api.github.com/users/sylvinus/gists{/gist_id}", "starred_url": "https://api.github.com/users/sylvinus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sylvinus/subscriptions", "organizations_url": "https://api.github.com/users/sylvinus/orgs", "repos_url": "https://api.github.com/users/sylvinus/repos", "events_url": "https://api.github.com/users/sylvinus/events{/privacy}", "received_events_url": "https://api.github.com/users/sylvinus/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 117745, "node_id": "MDU6TGFiZWwxMTc3NDU=", "url": "https://api.github.com/repos/psf/requests/labels/Planned", "name": "Planned", "color": "e102d8", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": {"login": "Lukasa", "id": 1382556, "node_id": "MDQ6VXNlcjEzODI1NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1382556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lukasa", "html_url": "https://github.com/Lukasa", "followers_url": "https://api.github.com/users/Lukasa/followers", "following_url": "https://api.github.com/users/Lukasa/following{/other_user}", "gists_url": "https://api.github.com/users/Lukasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lukasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lukasa/subscriptions", "organizations_url": "https://api.github.com/users/Lukasa/orgs", "repos_url": "https://api.github.com/users/Lukasa/repos", "events_url": "https://api.github.com/users/Lukasa/events{/privacy}", "received_events_url": "https://api.github.com/users/Lukasa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "Lukasa", "id": 1382556, "node_id": "MDQ6VXNlcjEzODI1NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1382556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lukasa", "html_url": "https://github.com/Lukasa", "followers_url": "https://api.github.com/users/Lukasa/followers", "following_url": "https://api.github.com/users/Lukasa/following{/other_user}", "gists_url": "https://api.github.com/users/Lukasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lukasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lukasa/subscriptions", "organizations_url": "https://api.github.com/users/Lukasa/orgs", "repos_url": "https://api.github.com/users/Lukasa/repos", "events_url": "https://api.github.com/users/Lukasa/events{/privacy}", "received_events_url": "https://api.github.com/users/Lukasa/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/psf/requests/milestones/20", "html_url": "https://github.com/psf/requests/milestone/20", "labels_url": "https://api.github.com/repos/psf/requests/milestones/20/labels", "id": 487518, "node_id": "MDk6TWlsZXN0b25lNDg3NTE4", "number": 20, "title": "3.0.0", "description": null, "creator": {"login": "Lukasa", "id": 1382556, "node_id": "MDQ6VXNlcjEzODI1NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1382556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lukasa", "html_url": "https://github.com/Lukasa", "followers_url": "https://api.github.com/users/Lukasa/followers", "following_url": "https://api.github.com/users/Lukasa/following{/other_user}", "gists_url": "https://api.github.com/users/Lukasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lukasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lukasa/subscriptions", "organizations_url": "https://api.github.com/users/Lukasa/orgs", "repos_url": "https://api.github.com/users/Lukasa/repos", "events_url": "https://api.github.com/users/Lukasa/events{/privacy}", "received_events_url": "https://api.github.com/users/Lukasa/received_events", "type": "User", "site_admin": false}, "open_issues": 16, "closed_issues": 28, "state": "open", "created_at": "2013-11-17T11:29:34Z", "updated_at": "2018-11-13T12:55:46Z", "due_on": null, "closed_at": null}, "comments": 13, "created_at": "2013-09-03T09:36:19Z", "updated_at": "2021-09-08T22:00:45Z", "closed_at": "2015-10-05T14:09:46Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "I don't know if it's a design goal of requests to hide urllib3's exceptions and wrap them around requests.exceptions types.\n\n(If it's not IMHO it should be, but that's another discussion)\n\nIf it is, I have at least two of them passing through that I have to catch in addition to requests' exceptions. They are requests.packages.urllib3.exceptions.DecodeError and requests.packages.urllib3.exceptions.TimeoutError (this one I get when a proxy timeouts)\n\nThanks!\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1572/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1572/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1561", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1561/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1561/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1561/events", "html_url": "https://github.com/psf/requests/issues/1561", "id": 18791485, "node_id": "MDU6SXNzdWUxODc5MTQ4NQ==", "number": 1561, "title": "Header keys lose their case", "user": {"login": "magicjin", "id": 12653, "node_id": "MDQ6VXNlcjEyNjUz", "avatar_url": "https://avatars.githubusercontent.com/u/12653?v=4", "gravatar_id": "", "url": "https://api.github.com/users/magicjin", "html_url": "https://github.com/magicjin", "followers_url": "https://api.github.com/users/magicjin/followers", "following_url": "https://api.github.com/users/magicjin/following{/other_user}", "gists_url": "https://api.github.com/users/magicjin/gists{/gist_id}", "starred_url": "https://api.github.com/users/magicjin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/magicjin/subscriptions", "organizations_url": "https://api.github.com/users/magicjin/orgs", "repos_url": "https://api.github.com/users/magicjin/repos", "events_url": "https://api.github.com/users/magicjin/events{/privacy}", "received_events_url": "https://api.github.com/users/magicjin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 117745, "node_id": "MDU6TGFiZWwxMTc3NDU=", "url": "https://api.github.com/repos/psf/requests/labels/Planned", "name": "Planned", "color": "e102d8", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/psf/requests/milestones/20", "html_url": "https://github.com/psf/requests/milestone/20", "labels_url": "https://api.github.com/repos/psf/requests/milestones/20/labels", "id": 487518, "node_id": "MDk6TWlsZXN0b25lNDg3NTE4", "number": 20, "title": "3.0.0", "description": null, "creator": {"login": "Lukasa", "id": 1382556, "node_id": "MDQ6VXNlcjEzODI1NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1382556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lukasa", "html_url": "https://github.com/Lukasa", "followers_url": "https://api.github.com/users/Lukasa/followers", "following_url": "https://api.github.com/users/Lukasa/following{/other_user}", "gists_url": "https://api.github.com/users/Lukasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lukasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lukasa/subscriptions", "organizations_url": "https://api.github.com/users/Lukasa/orgs", "repos_url": "https://api.github.com/users/Lukasa/repos", "events_url": "https://api.github.com/users/Lukasa/events{/privacy}", "received_events_url": "https://api.github.com/users/Lukasa/received_events", "type": "User", "site_admin": false}, "open_issues": 16, "closed_issues": 28, "state": "open", "created_at": "2013-11-17T11:29:34Z", "updated_at": "2018-11-13T12:55:46Z", "due_on": null, "closed_at": null}, "comments": 11, "created_at": "2013-08-30T14:43:45Z", "updated_at": "2021-09-08T13:05:32Z", "closed_at": "2017-01-09T16:17:38Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "it seems that there is a bug in response.headers.\n\nfor example, code below:\n\n``` python\nimport requests\nr = requests.get('http://docs.python-requests.org/en/latest/')\nprint r.headers._store\n```\n\nit will display as:\n\n```\n{'connection': ('connection', 'keep-alive'),\n 'content-encoding': ('content-encoding', 'gzip'),\n 'content-type': ('content-type', 'text/html'),\n 'date': ('date', 'Fri, 30 Aug 2013 14:29:28 GMT'),\n 'last-modified': ('last-modified', 'Tue, 27 Aug 2013 15:01:13 GMT'),\n 'server': ('server', 'nginx/1.1.19'),\n 'transfer-encoding': ('transfer-encoding', 'chunked'),\n 'x-cname': ('x-cname', 'docs.python-requests.org'),\n 'x-deity': ('x-deity', 'Chimera'),\n 'x-loaded-deity': ('x-loaded-deity', 'Asgard'),\n 'x-served': ('x-served', 'Nginx')}\n```\n\nbut actually the headers should be:\n\n```\n{'connection': ('Connection', 'keep-alive'),\n 'content-encoding': ('Content-Encoding', 'gzip'),\n 'content-type': ('Content-Type', 'text/html'),\n 'date': ('Date', 'Fri, 30 Aug 2013 14:29:28 GMT'),\n 'last-modified': ('Last-Modified', 'Tue, 27 Aug 2013 15:01:13 GMT'),\n 'server': ('Server', 'nginx/1.1.19'),\n 'transfer-encoding': ('Transfer-Encoding', 'chunked'),\n 'x-cname': ('X-Cname', 'docs.python-requests.org'),\n 'x-deity': ('X-Deity', 'Chimera'),\n 'x-loaded-deity': ('X-Loaded-Deity', 'Asgard'),\n 'x-served': ('X-Served', 'Nginx')}\n```\n\nbecause the code comments said:\n\n```\nUse the lowercased key for lookups, but store the actual key alongside the value.\n```\n\nat file structures.py line 72.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1561/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1561/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1434", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1434/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1434/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1434/events", "html_url": "https://github.com/psf/requests/issues/1434", "id": 15983794, "node_id": "MDU6SXNzdWUxNTk4Mzc5NA==", "number": 1434, "title": "stream_decode_response_unicode fails in Python 3 at rv = decoder.decode('', final=True)", "user": {"login": "chinux23", "id": 387737, "node_id": "MDQ6VXNlcjM4NzczNw==", "avatar_url": "https://avatars.githubusercontent.com/u/387737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chinux23", "html_url": "https://github.com/chinux23", "followers_url": "https://api.github.com/users/chinux23/followers", "following_url": "https://api.github.com/users/chinux23/following{/other_user}", "gists_url": "https://api.github.com/users/chinux23/gists{/gist_id}", "starred_url": "https://api.github.com/users/chinux23/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chinux23/subscriptions", "organizations_url": "https://api.github.com/users/chinux23/orgs", "repos_url": "https://api.github.com/users/chinux23/repos", "events_url": "https://api.github.com/users/chinux23/events{/privacy}", "received_events_url": "https://api.github.com/users/chinux23/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2013-06-25T15:17:55Z", "updated_at": "2021-09-09T03:00:20Z", "closed_at": "2013-06-26T07:38:03Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "```\n rv = decoder.decode('', final=True) should be\n rv = decoder.decode(b'', final=True)\n```\n\notherwise, this fails:\n\n```\nimport codecs\ndecoder = codecs.getincrementaldecoder(\"utf-8\")(errors='replace')\nrv = decoder.decode('', final=True)\n```\n\nTraceback:\n\n```\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-21-86c335a3edfc> in <module>()\n----> 1 rv = decoder.decode('', final=True)\n\n/Users/chen/Virtualenvs/python3Env/lib/python3.3/codecs.py in decode(self, input, final)\n    297     def decode(self, input, final=False):\n    298         # decode input (taking the buffer into account)\n    --> 299         data = self.buffer + input\n    300         (result, consumed) = self._buffer_decode(data, self.errors, final)\n    301         # keep undecoded input until the next call\n\nTypeError: can't concat bytes to str\n```\n\nOriginal Code attached:\n\n```\ndef stream_decode_response_unicode(iterator, r):\n    \"\"\"Stream decodes a iterator.\"\"\"\n\n    if r.encoding is None:\n        for item in iterator:\n            yield item\n        return\n\n    decoder = codecs.getincrementaldecoder(r.encoding)(errors='replace')\n    for chunk in iterator:\n        rv = decoder.decode(chunk)\n        if rv:\n            yield rv\n    rv = decoder.decode('', final=True)\n    if rv:\n        yield rv\n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1434/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1434/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1397", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1397/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1397/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1397/events", "html_url": "https://github.com/psf/requests/issues/1397", "id": 14955351, "node_id": "MDU6SXNzdWUxNDk1NTM1MQ==", "number": 1397, "title": "bug report", "user": {"login": "kennethreitz", "id": 119893, "node_id": "MDQ6VXNlcjExOTg5Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/119893?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennethreitz", "html_url": "https://github.com/kennethreitz", "followers_url": "https://api.github.com/users/kennethreitz/followers", "following_url": "https://api.github.com/users/kennethreitz/following{/other_user}", "gists_url": "https://api.github.com/users/kennethreitz/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennethreitz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennethreitz/subscriptions", "organizations_url": "https://api.github.com/users/kennethreitz/orgs", "repos_url": "https://api.github.com/users/kennethreitz/repos", "events_url": "https://api.github.com/users/kennethreitz/events{/privacy}", "received_events_url": "https://api.github.com/users/kennethreitz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2013-05-30T18:41:17Z", "updated_at": "2021-09-09T02:11:37Z", "closed_at": "2013-08-17T06:35:52Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "Dear Kenneth Reitz,\n\nI use your Requests library which is quite cool. I ran into some issues like httplib uncaught exceptions\nwhich (i think) should be handled by Requests.\n## Consider the following code:\n\nimport requests\n## r = requests.get('http://www.bilhetos.com')\n\nIt raises 'httplib.IncompleteRead' exception which is not handled properly in Requests.\n\nPlease consider urls below for testing:\nhttp://www.tusseymountaintitans.com\nhttp://www.abbottpanthers.com\nhttp://www.spanishmoms.com\nhttp://www.long-island-storage.com\nhttp://www.cupertinohelpwanted.com\nhttp://www.hoffmanestateshawks.com\nhttp://www.brothermartincrusaders.com\nhttp://www.1-800-printer.com\nhttp://www.impiretickets.com\nhttp://www.gdickinson.com\nhttp://www.forensicsline.com\nhttp://www.gardeningtime.com\nhttp://www.ecollegetennis.com\nhttp://www.milacasaints.com\nhttp://www.bartoninsuranceagency.com\nhttp://www.djnatural.com\nhttp://www.containers2000.com\nhttp://www.indiancreektimberwolves.com\nhttp://www.athenswarriors.com\nhttp://www.logansportcats.com\nhttp://www.osani.com\nhttp://www.xn--sammler-brse-djb.com\nhttp://www.800usahealth.com\nhttp://www.wealth-wise.com\nhttp://www.foothillmustangs.com\nhttp://www.manasquanbigblue.com\nhttp://www.bilhetos.com\nhttp://www.atlantahomesteam.com\nhttp://www.foxcitiessatellite.com\nhttp://www.chargersmail.com\nhttp://www.fighterplace.com\n\nBest regards,\nVladimir Goncharov\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1397/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1397/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1336", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1336/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1336/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1336/events", "html_url": "https://github.com/psf/requests/issues/1336", "id": 13790863, "node_id": "MDU6SXNzdWUxMzc5MDg2Mw==", "number": 1336, "title": "Set cookie on 401", "user": {"login": "kervinpierre", "id": 350213, "node_id": "MDQ6VXNlcjM1MDIxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/350213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kervinpierre", "html_url": "https://github.com/kervinpierre", "followers_url": "https://api.github.com/users/kervinpierre/followers", "following_url": "https://api.github.com/users/kervinpierre/following{/other_user}", "gists_url": "https://api.github.com/users/kervinpierre/gists{/gist_id}", "starred_url": "https://api.github.com/users/kervinpierre/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kervinpierre/subscriptions", "organizations_url": "https://api.github.com/users/kervinpierre/orgs", "repos_url": "https://api.github.com/users/kervinpierre/repos", "events_url": "https://api.github.com/users/kervinpierre/events{/privacy}", "received_events_url": "https://api.github.com/users/kervinpierre/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 47, "created_at": "2013-04-30T03:19:58Z", "updated_at": "2021-09-08T23:10:56Z", "closed_at": "2013-08-15T07:59:47Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "If a 401 response contains a Set-Cookie header, that header is not returned on the subsequent AUTH.\n\nAn application requiring that cookie ( e.g. session id ) on the AUTH fails.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1336/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1336/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1335", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1335/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1335/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1335/events", "html_url": "https://github.com/psf/requests/issues/1335", "id": 13790505, "node_id": "MDU6SXNzdWUxMzc5MDUwNQ==", "number": 1335, "title": "Content-Length header is duplicated on Python3", "user": {"login": "valyagolev", "id": 150242, "node_id": "MDQ6VXNlcjE1MDI0Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/150242?v=4", "gravatar_id": "", "url": "https://api.github.com/users/valyagolev", "html_url": "https://github.com/valyagolev", "followers_url": "https://api.github.com/users/valyagolev/followers", "following_url": "https://api.github.com/users/valyagolev/following{/other_user}", "gists_url": "https://api.github.com/users/valyagolev/gists{/gist_id}", "starred_url": "https://api.github.com/users/valyagolev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/valyagolev/subscriptions", "organizations_url": "https://api.github.com/users/valyagolev/orgs", "repos_url": "https://api.github.com/users/valyagolev/repos", "events_url": "https://api.github.com/users/valyagolev/events{/privacy}", "received_events_url": "https://api.github.com/users/valyagolev/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2013-04-30T02:58:10Z", "updated_at": "2021-09-09T03:00:27Z", "closed_at": "2013-06-08T09:57:00Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Content-Length header is duplicated if specified on Python3, leading to 400 responses:\n\n```\nPython 3.3.0 (default, Apr 30 2013, 06:45:58)\n[GCC 4.2.1 Compatible Apple Clang 4.0 ((tags/Apple/clang-421.0.60))] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import requests\n>>> requests.post(\"http://httpbin.org/post\", headers={\"Content-Length\": 0})\n<Response [400]>\n```\n\nWe need to go deeper:\n\n```\n>>> import six\n>>> six.moves.http_client.HTTPConnection.debuglevel = 1\n>>> requests.post(\"http://httpbin.org/post\", headers={\"Content-Length\": 0})\nsend: b'POST /post HTTP/1.1\\r\\nHost: httpbin.org\\r\\nAccept-Encoding: identity\\r\\nContent-Length: 0\\r\\nUser-Agent: python-requests/1.2.0 CPython/3.3.0 Darwin/12.3.0\\r\\nContent-Length: 0\\r\\nAccept: */*\\r\\nAccept-Encoding: gzip, deflate, compress\\r\\n\\r\\n'\nreply: 'HTTP/1.1 400 BAD_REQUEST\\r\\n'\nheader: Content-Length header: Connection <Response [400]>\n```\n\nThat's what happens:\n\n``` http\nPOST /post HTTP/1.1\nHost: httpbin.org\nAccept-Encoding: identity\nContent-Length: 0\nUser-Agent: python-requests/1.2.0 CPython/3.3.0 Darwin/12.3.0\nContent-Length: 0\nAccept: */*\nAccept-Encoding: gzip, deflate, compress\n```\n\nTwo content-lengths, one 400 response :-(\nOn Python2 everything's OK.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1335/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1335/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1324", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1324/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1324/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1324/events", "html_url": "https://github.com/psf/requests/issues/1324", "id": 13619492, "node_id": "MDU6SXNzdWUxMzYxOTQ5Mg==", "number": 1324, "title": "Session with CookieJar/LWPCookieJar cause AttributeError", "user": {"login": "falsetru", "id": 29461, "node_id": "MDQ6VXNlcjI5NDYx", "avatar_url": "https://avatars.githubusercontent.com/u/29461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/falsetru", "html_url": "https://github.com/falsetru", "followers_url": "https://api.github.com/users/falsetru/followers", "following_url": "https://api.github.com/users/falsetru/following{/other_user}", "gists_url": "https://api.github.com/users/falsetru/gists{/gist_id}", "starred_url": "https://api.github.com/users/falsetru/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/falsetru/subscriptions", "organizations_url": "https://api.github.com/users/falsetru/orgs", "repos_url": "https://api.github.com/users/falsetru/repos", "events_url": "https://api.github.com/users/falsetru/events{/privacy}", "received_events_url": "https://api.github.com/users/falsetru/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2013-04-25T01:22:58Z", "updated_at": "2021-09-09T04:00:33Z", "closed_at": "2013-04-26T10:57:36Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "In 1.2.0 , \n\n```\n>>> import cookielib\n>>> import requests\n>>> jar = cookielib.LWPCookieJar()\n>>> s = requests.session()\n>>> s.cookies = jar\n>>> s.get('http://httpbin.org/')\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/local/lib/python2.7/dist-packages/requests/sessions.py\", line 369, in get\n    return self.request('GET', url, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/requests/sessions.py\", line 297, in request\n    merged_cookies = self.cookies.copy()\nAttributeError: LWPCookieJar instance has no attribute 'copy'\n```\n\nWorks in older version. (0.14.2, 1.0.0, 1.0.1, 1.0.2, 1.0.3, 1.1.0)\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1324/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1324/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1261", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1261/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1261/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1261/events", "html_url": "https://github.com/psf/requests/issues/1261", "id": 12347152, "node_id": "MDU6SXNzdWUxMjM0NzE1Mg==", "number": 1261, "title": "Issue arising from #1190", "user": {"login": "sigmavirus24", "id": 240830, "node_id": "MDQ6VXNlcjI0MDgzMA==", "avatar_url": "https://avatars.githubusercontent.com/u/240830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sigmavirus24", "html_url": "https://github.com/sigmavirus24", "followers_url": "https://api.github.com/users/sigmavirus24/followers", "following_url": "https://api.github.com/users/sigmavirus24/following{/other_user}", "gists_url": "https://api.github.com/users/sigmavirus24/gists{/gist_id}", "starred_url": "https://api.github.com/users/sigmavirus24/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sigmavirus24/subscriptions", "organizations_url": "https://api.github.com/users/sigmavirus24/orgs", "repos_url": "https://api.github.com/users/sigmavirus24/repos", "events_url": "https://api.github.com/users/sigmavirus24/events{/privacy}", "received_events_url": "https://api.github.com/users/sigmavirus24/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2013-03-23T01:21:55Z", "updated_at": "2021-09-09T04:00:46Z", "closed_at": "2013-03-27T18:31:37Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "The tests caught this purely by coincidence with #1259. \n\nThe issue is that we're now passing optional keyword arguments and typical hooks don't expect them causing exceptions to be raised.\n\nIn essence, this is a big breaking change and we will have to make it very clear to users that this is in the next version. requests/requests-kerberos depends on this but this is going to break a good amount of people's code.\n\nAdmittedly it only rears its head when we try and set the defaults via `kwargs` in `Session.send`. Again that's due to #1259/#1258 but @geoff-kruss is right in asserting that those defaults should be passed.\n\nAssuming we keep the addition that causes this, we need a plan how to announce it.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1261/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1261/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1189", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1189/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1189/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1189/events", "html_url": "https://github.com/psf/requests/issues/1189", "id": 10977015, "node_id": "MDU6SXNzdWUxMDk3NzAxNQ==", "number": 1189, "title": "Multiple Cookies on Redirect", "user": {"login": "Lukasa", "id": 1382556, "node_id": "MDQ6VXNlcjEzODI1NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1382556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lukasa", "html_url": "https://github.com/Lukasa", "followers_url": "https://api.github.com/users/Lukasa/followers", "following_url": "https://api.github.com/users/Lukasa/following{/other_user}", "gists_url": "https://api.github.com/users/Lukasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lukasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lukasa/subscriptions", "organizations_url": "https://api.github.com/users/Lukasa/orgs", "repos_url": "https://api.github.com/users/Lukasa/repos", "events_url": "https://api.github.com/users/Lukasa/events{/privacy}", "received_events_url": "https://api.github.com/users/Lukasa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2013-02-13T23:09:02Z", "updated_at": "2021-09-09T05:00:39Z", "closed_at": "2013-02-17T01:17:07Z", "author_association": "MEMBER", "active_lock_reason": "resolved", "body": "After updating `master` to f73bda06e9, I find that some requests raise a `CookieConflictError`. Specifically, any page that sets a cookie on a 302 and then redirects to a page that sets the same cookie raises a `CookieConflictError`.\n\nSteps To Reproduce:\n1. Update Requests to the version shown above.\n2. Make a request to http://www.google.com/ from anywhere outside the US.\n\nExpected Behaviour:\nRequests should return a 200 OK with the 302 in the history.\n\nActual Behaviour:\n\n``` python\n>>> import requests\n>>> r = requests.get('http://www.google.com/')\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"requests/api.py\", line 55, in get\n    return request('get', url, **kwargs)\n  File \"requests/api.py\", line 44, in request\n    return session.request(method=method, url=url, **kwargs)\n  File \"requests/sessions.py\", line 312, in request\n    resp = self.send(prep, **send_kwargs)\n  File \"requests/sessions.py\", line 426, in send\n    history = [resp for resp in gen] if allow_redirects else []\n  File \"requests/sessions.py\", line 163, in resolve_redirects\n    resp.cookies.update(cookiejar)\n  File \"venv/lib/python2.7/_abcoll.py\", line 494, in update\n    self[key] = other[key]\n  File \"requests/cookies.py\", line 246, in __getitem__\n    return self._find_no_duplicates(name)\n  File \"requests/cookies.py\", line 285, in _find_no_duplicates\n    raise CookieConflictError('There are multiple cookies with name, %r' % (name))\nrequests.cookies.CookieConflictError: There are multiple cookies with name, 'NID'\n```\n\nThis is very clearly related to the changes made in #1180.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1189/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1189/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1124", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1124/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1124/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1124/events", "html_url": "https://github.com/psf/requests/issues/1124", "id": 10179657, "node_id": "MDU6SXNzdWUxMDE3OTY1Nw==", "number": 1124, "title": "SSLError from imgur API, however proper cert appears via Chrome", "user": {"login": "maxcountryman", "id": 74351, "node_id": "MDQ6VXNlcjc0MzUx", "avatar_url": "https://avatars.githubusercontent.com/u/74351?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maxcountryman", "html_url": "https://github.com/maxcountryman", "followers_url": "https://api.github.com/users/maxcountryman/followers", "following_url": "https://api.github.com/users/maxcountryman/following{/other_user}", "gists_url": "https://api.github.com/users/maxcountryman/gists{/gist_id}", "starred_url": "https://api.github.com/users/maxcountryman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maxcountryman/subscriptions", "organizations_url": "https://api.github.com/users/maxcountryman/orgs", "repos_url": "https://api.github.com/users/maxcountryman/repos", "events_url": "https://api.github.com/users/maxcountryman/events{/privacy}", "received_events_url": "https://api.github.com/users/maxcountryman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2013-01-22T03:01:58Z", "updated_at": "2021-09-09T00:01:11Z", "closed_at": "2013-02-10T22:37:55Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "``` python\n>>> import requests; requests.get('https://api.imgur.com') \nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/Library/Python/2.7/site-packages/requests/api.py\", line 55, in get\n    return request('get', url, **kwargs)\n  File \"/Library/Python/2.7/site-packages/requests/api.py\", line 44, in request\n    return session.request(method=method, url=url, **kwargs)\n  File \"/Library/Python/2.7/site-packages/requests/sessions.py\", line 279, in request\n    resp = self.send(prep, stream=stream, timeout=timeout, verify=verify, cert=cert, proxies=proxies)\n  File \"/Library/Python/2.7/site-packages/requests/sessions.py\", line 374, in send\n    r = adapter.send(request, **kwargs)\n  File \"/Library/Python/2.7/site-packages/requests/adapters.py\", line 213, in send\n    raise SSLError(e)\nrequests.exceptions.SSLError: hostname 'api.imgur.com' doesn't match 'imgur.com'\n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1124/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1124/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1102", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1102/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1102/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1102/events", "html_url": "https://github.com/psf/requests/issues/1102", "id": 9975242, "node_id": "MDU6SXNzdWU5OTc1MjQy", "number": 1102, "title": "address compromised TURKTRUST certificates", "user": {"login": "slingamn", "id": 376448, "node_id": "MDQ6VXNlcjM3NjQ0OA==", "avatar_url": "https://avatars.githubusercontent.com/u/376448?v=4", "gravatar_id": "", "url": "https://api.github.com/users/slingamn", "html_url": "https://github.com/slingamn", "followers_url": "https://api.github.com/users/slingamn/followers", "following_url": "https://api.github.com/users/slingamn/following{/other_user}", "gists_url": "https://api.github.com/users/slingamn/gists{/gist_id}", "starred_url": "https://api.github.com/users/slingamn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/slingamn/subscriptions", "organizations_url": "https://api.github.com/users/slingamn/orgs", "repos_url": "https://api.github.com/users/slingamn/repos", "events_url": "https://api.github.com/users/slingamn/events{/privacy}", "received_events_url": "https://api.github.com/users/slingamn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2013-01-15T11:30:17Z", "updated_at": "2021-09-09T05:00:48Z", "closed_at": "2013-01-17T10:53:19Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "It seems likely that `requests/cacerts.pem` is affected by the recent compromise of TURKTRUST certificates. However, I'm not sure what exactly we need to do to fix this. Removing both of the root certs we currently have in there is probably wrong.\n\nMaybe @saschpe can advise?\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1102/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1102/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1096", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1096/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1096/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1096/events", "html_url": "https://github.com/psf/requests/issues/1096", "id": 9891947, "node_id": "MDU6SXNzdWU5ODkxOTQ3", "number": 1096, "title": "OAuth 1 requests with BODY signature_type send no body data and set Content-Length: 0 ", "user": {"login": "matthewlmcclure", "id": 470362, "node_id": "MDQ6VXNlcjQ3MDM2Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/470362?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthewlmcclure", "html_url": "https://github.com/matthewlmcclure", "followers_url": "https://api.github.com/users/matthewlmcclure/followers", "following_url": "https://api.github.com/users/matthewlmcclure/following{/other_user}", "gists_url": "https://api.github.com/users/matthewlmcclure/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthewlmcclure/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthewlmcclure/subscriptions", "organizations_url": "https://api.github.com/users/matthewlmcclure/orgs", "repos_url": "https://api.github.com/users/matthewlmcclure/repos", "events_url": "https://api.github.com/users/matthewlmcclure/events{/privacy}", "received_events_url": "https://api.github.com/users/matthewlmcclure/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2013-01-11T19:44:55Z", "updated_at": "2021-09-09T05:00:41Z", "closed_at": "2013-02-10T22:55:13Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "Expected: OAuth params in the body and corresponding non-zero Content-Length header.\n\nActual: No body in the request and Content-Length: 0.\n\nNotes:\n1. As of kennethreitz/requests@8f86ff633a2646442f2d8976046b5c0025e772c1 (2012-11-28) the Content-Length was computed after applying auth. In 34917618d80580fafec98641b213c453d7f3fb39 (2013-01-11), `prepare_body` computes Content-Length before `prepare_auth` computes the OAuth parameters.\n2. requests/requests-oauthlib@ba2ea5938dd4da30c963158a33f1a83c3e7d362c assigns the body data to a `data` attribute, but kennethreitz/requests@8f86ff633a2646442f2d8976046b5c0025e772c1 expects it in a `body` attribute.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1096/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1096/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1084", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1084/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1084/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1084/events", "html_url": "https://github.com/psf/requests/issues/1084", "id": 9687066, "node_id": "MDU6SXNzdWU5Njg3MDY2", "number": 1084, "title": "POST and PUT on 307 redirect will re-POST without body", "user": {"login": "jaraco", "id": 308610, "node_id": "MDQ6VXNlcjMwODYxMA==", "avatar_url": "https://avatars.githubusercontent.com/u/308610?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaraco", "html_url": "https://github.com/jaraco", "followers_url": "https://api.github.com/users/jaraco/followers", "following_url": "https://api.github.com/users/jaraco/following{/other_user}", "gists_url": "https://api.github.com/users/jaraco/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaraco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaraco/subscriptions", "organizations_url": "https://api.github.com/users/jaraco/orgs", "repos_url": "https://api.github.com/users/jaraco/repos", "events_url": "https://api.github.com/users/jaraco/events{/privacy}", "received_events_url": "https://api.github.com/users/jaraco/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2013-01-04T16:55:35Z", "updated_at": "2021-09-09T04:00:42Z", "closed_at": "2013-03-31T05:21:52Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "With requests 1.0.4, if one makes a POST or PUT request to a resource which returns a 307 temporary redirect (section 10.3.8 in the [RFC](http://www.faqs.org/rfcs/rfc2616.html)), requests will automatically submit the same request to the redirect target, but without any body.\n\nThe RFC states:\n\n```\n   If the 307 status code is received in response to a request other\n   than GET or HEAD, the user agent MUST NOT automatically redirect the\n   request unless it can be confirmed by the user, since this might\n   change the conditions under which the request was issued.\n```\n\nTherefore, I believe requests should raise an exception in these cases, or otherwise require that the request be configured to \"re-post on 307\".\n\nI suspect the author has already considered some of these issues, so I post this bug to raise awareness of the issue and document the intended behavior, or to alter the behavior to better suit expectations.\n\nPlease let us know if there's anything we can do to help (demonstrate behavior, write tests, supply patch).\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1084/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1084/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/1029", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/1029/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/1029/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/1029/events", "html_url": "https://github.com/psf/requests/issues/1029", "id": 9354159, "node_id": "MDU6SXNzdWU5MzU0MTU5", "number": 1029, "title": "Since 1.0, seeing a large amount of \"Cannot assign requested address\" socket.errors", "user": {"login": "gmr", "id": 49469, "node_id": "MDQ6VXNlcjQ5NDY5", "avatar_url": "https://avatars.githubusercontent.com/u/49469?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gmr", "html_url": "https://github.com/gmr", "followers_url": "https://api.github.com/users/gmr/followers", "following_url": "https://api.github.com/users/gmr/following{/other_user}", "gists_url": "https://api.github.com/users/gmr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gmr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gmr/subscriptions", "organizations_url": "https://api.github.com/users/gmr/orgs", "repos_url": "https://api.github.com/users/gmr/repos", "events_url": "https://api.github.com/users/gmr/events{/privacy}", "received_events_url": "https://api.github.com/users/gmr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2012-12-18T00:56:01Z", "updated_at": "2021-09-09T05:30:06Z", "closed_at": "2012-12-18T02:51:40Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": " (Caused by <class 'socket.error'>: [Errno 99] Cannot assign requested address)\n\nConnectionError(MaxRetryError(\"HTTPConnectionPool(host='foo', port=80): Max retries exceeded with url: /path (Caused by <class 'socket.error'>: [Errno 99] Cannot assign requested address)\",),)\n\nI do not have this behavior on boxes that have not upgraded and are making the same GET requests.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/1029/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/1029/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/910", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/910/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/910/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/910/events", "html_url": "https://github.com/psf/requests/issues/910", "id": 7868747, "node_id": "MDU6SXNzdWU3ODY4NzQ3", "number": 910, "title": "POST with json data and oauth auth_header signature_type not working", "user": {"login": "alex-ethier", "id": 677604, "node_id": "MDQ6VXNlcjY3NzYwNA==", "avatar_url": "https://avatars.githubusercontent.com/u/677604?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alex-ethier", "html_url": "https://github.com/alex-ethier", "followers_url": "https://api.github.com/users/alex-ethier/followers", "following_url": "https://api.github.com/users/alex-ethier/following{/other_user}", "gists_url": "https://api.github.com/users/alex-ethier/gists{/gist_id}", "starred_url": "https://api.github.com/users/alex-ethier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alex-ethier/subscriptions", "organizations_url": "https://api.github.com/users/alex-ethier/orgs", "repos_url": "https://api.github.com/users/alex-ethier/repos", "events_url": "https://api.github.com/users/alex-ethier/events{/privacy}", "received_events_url": "https://api.github.com/users/alex-ethier/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 32, "created_at": "2012-10-25T17:29:41Z", "updated_at": "2021-09-09T04:00:40Z", "closed_at": "2013-04-01T18:40:16Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "The following code does not generate an Authorization header.\n\n``` python\nimport requests\nfrom requests.auth import OAuth1\nimport json\n\n\nclient_key = u'mykey'\nclient_secret = u'mysecret'\n\nheaderoauth = OAuth1(\n    client_key,\n    client_secret,\n    None,\n    None,\n    signature_type='auth_header'\n)\n\npayload = {\n    \"type\": \"command_line\",\n    \"params\":  {\n        \"command\": \"sleep 0\"\n    }\n}\n\nurl = u'http://localhost:8003/test'\ndata = json.dumps(payload, sort_keys=True, indent=4)\n\nr = requests.post(url, auth=headeroauth, data=data )\n```\n\nIf I replace \n\n``` python\ndata=data\n```\n\nby\n\n``` python\ndata={'data':'payload'}\n```\n\nI get and Authorization header but that's not what I need...\n\nAm I missing anything?  This seem to be broken.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/910/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/910/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/875", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/875/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/875/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/875/events", "html_url": "https://github.com/psf/requests/issues/875", "id": 7268544, "node_id": "MDU6SXNzdWU3MjY4NTQ0", "number": 875, "title": "Keep-alive doesn't work over http proxy", "user": {"login": "vlaci", "id": 1771332, "node_id": "MDQ6VXNlcjE3NzEzMzI=", "avatar_url": "https://avatars.githubusercontent.com/u/1771332?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vlaci", "html_url": "https://github.com/vlaci", "followers_url": "https://api.github.com/users/vlaci/followers", "following_url": "https://api.github.com/users/vlaci/following{/other_user}", "gists_url": "https://api.github.com/users/vlaci/gists{/gist_id}", "starred_url": "https://api.github.com/users/vlaci/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vlaci/subscriptions", "organizations_url": "https://api.github.com/users/vlaci/orgs", "repos_url": "https://api.github.com/users/vlaci/repos", "events_url": "https://api.github.com/users/vlaci/events{/privacy}", "received_events_url": "https://api.github.com/users/vlaci/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2012-10-01T16:28:39Z", "updated_at": "2021-09-09T05:29:54Z", "closed_at": "2012-12-03T10:09:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "Although, requests sends a `Proxy-Connection: keep-alive` header, it forcibly closes the connection after each requests.\nI tracked down the issue's origin to models.py, how the connection is acquired:\n\n``` python\nif proxy and not any(map(_p.hostname.endswith, no_proxy)):\n    conn = poolmanager.proxy_from_url(proxy)\n```\n\nvs\n\n``` python\nif self.config.get('keep_alive'):\n    conn = self._poolmanager.connection_from_url(url)\nelse:\n    conn = connectionpool.connection_from_url(url)\n```\n\nIn the proxy case, a poolmanager is instantiated in every request, while without proxy the given `self._poolmanager` instance is reused.\nI have a workaround for the issue via using `poolmanager.ProxyManager(self._poolmanager.connection_from_url(proxy))` call instead of `poolmanager.proxy_from_url(proxy)` if keep_alive is configured.\n\nIf you find my solution adequate, I prepare a patch for the issue in the upcoming days.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/875/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/875/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/862", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/862/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/862/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/862/events", "html_url": "https://github.com/psf/requests/issues/862", "id": 7003071, "node_id": "MDU6SXNzdWU3MDAzMDcx", "number": 862, "title": "digest authentication fails because of wrongly nonce-count", "user": {"login": "koenvb", "id": 76891, "node_id": "MDQ6VXNlcjc2ODkx", "avatar_url": "https://avatars.githubusercontent.com/u/76891?v=4", "gravatar_id": "", "url": "https://api.github.com/users/koenvb", "html_url": "https://github.com/koenvb", "followers_url": "https://api.github.com/users/koenvb/followers", "following_url": "https://api.github.com/users/koenvb/following{/other_user}", "gists_url": "https://api.github.com/users/koenvb/gists{/gist_id}", "starred_url": "https://api.github.com/users/koenvb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/koenvb/subscriptions", "organizations_url": "https://api.github.com/users/koenvb/orgs", "repos_url": "https://api.github.com/users/koenvb/repos", "events_url": "https://api.github.com/users/koenvb/events{/privacy}", "received_events_url": "https://api.github.com/users/koenvb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2012-09-20T06:47:59Z", "updated_at": "2021-09-09T05:30:53Z", "closed_at": "2012-11-17T11:04:27Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "I was trying to use the httpie library which uses requests and I had a server implementation\nwhich strictly follows the RFC (http://www.ietf.org/rfc/rfc2617.txt)\n\nWhen using curl everything is fine, when using httpie, it did not work.\nafter some help it looks like the nonce-count (nc) is not correctly generated\n\nnonce-count\n     This MUST be specified if a qop directive is sent (see above), and\n     MUST NOT be specified if the server did not send a qop directive in\n     the WWW-Authenticate header field.  The nc-value is the hexadecimal\n     count of the number of requests (including the current request)\n     that the client has sent with the nonce value in this request.  For\n     example, in the first request sent in response to a given nonce\n     value, the client sends \"nc=00000001\".  The purpose of this\n     directive is to allow the server to detect request replays by\n     maintaining its own copy of this count - if the same nc-value is\n     seen twice, then the request is a replay.   See the description\n     below of the construction of the request-digest value.\n\nCurl request:\n\n```\nGET /manage/policy HTTP/1.1\nUser-Agent: curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\nHost: 192.168.12.229:8080\nAccept: text/plain\n\nHTTP/1.1 401 Unauthorized\nDAV: 1,3\nDate: Wed, 19 Sep 2012 15:14:31 GMT\nServer: test-test/3.0.0-7a5aba4d7a9771c7d03bde211aa37be56b670444\nContent-Length: 0\nWWW-Authenticate:  Digest realm=\"test\", qop=\"auth\", nonce=\"2471f4d8618db6787377250976d29df6\", opaque=\"6c375ad0468140c7b4404ba77b7464b9\"\n\nGET /manage/policy HTTP/1.1\nAuthorization: Digest username=\"admin\", realm=\"test\", nonce=\"2471f4d8618db6787377250976d29df6\", uri=\"/manage/policy\", cnonce=\"MDAwNjMx\", nc=00000001, qop=\"auth\", response=\"f38e88c6b3f63c423be7f38c9dc2a623\", opaque=\"6c375ad0468140c7b4404ba77b7464b9\"\nUser-Agent: curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\nHost: 192.168.12.229:8080\nAccept: text/plain\n\nHTTP/1.1 200 OK\nDAV: 1,3\nDate: Wed, 19 Sep 2012 15:14:31 GMT\nServer: test-test/3.0.0-7a5aba4d7a9771c7d03bde211aa37be56b670444\nContent-Type: text/plain;charset=UTF-8\nContent-Length: 70\nPragma: no-cache\nCache-Control: no-cache\nExpires: Thu, 01 Jan 1970 00:00:00 GMT\n\n\"4c94e07c5d44405889c11a0c71a091ac\"\n\"89d76185a2db4bdbb2a751b6e35003b0\"\n\n```\n\nhttpie request:\n\n```\nGET /manage/policy HTTP/1.1\nUser-Agent: HTTPie/0.2.7\nHost: 192.168.12.229:8080\nAccept-Encoding: identity, deflate, compress, gzip\nAccept: text/plain\n\nHTTP/1.1 401 Unauthorized\nDAV: 1,3\nDate: Wed, 19 Sep 2012 15:16:40 GMT\nServer: test-test/3.0.0-7a5aba4d7a9771c7d03bde211aa37be56b670444\nContent-Length: 0\nWWW-Authenticate:  Digest realm=\"test\", qop=\"auth\", nonce=\"1810bc988a671e239bb10567e80ca92b\", opaque=\"ec37b575badf48a2aec30bc9168cdcea\"\n\nGET /manage/policy HTTP/1.1\nAuthorization: Digest username=\"admin\", realm=\"test\", nonce=\"1810bc988a671e239bb10567e80ca92b\", uri=\"/manage/policy\", response=\"3c17eac558cba24a77f7bbf981e3cf75\", opaque=\"ec37b575badf48a2aec30bc9168cdcea\", qop=auth, nc=00000002, cnonce=\"9ab5326226636735\"\nAccept-Encoding: identity, deflate, compress, gzip\nUser-Agent: HTTPie/0.2.7\nHost: 192.168.12.229:8080\nAccept: text/plain\n\nHTTP/1.1 401 Unauthorized\nDAV: 1,3\nDate: Wed, 19 Sep 2012 15:16:40 GMT\nServer: test-test/3.0.0-7a5aba4d7a9771c7d03bde211aa37be56b670444\nContent-Length: 0\nWWW-Authenticate:  Digest realm=\"test\", qop=\"auth\", nonce=\"2925523a90abea51844ed1798a69874e\", opaque=\"8a092396a826475e9b00b07e05e3a77a\"\n\n```\n\nThe difference is in the nc=00000002 which should be nc=00000001 according to\nthe standard? So I guess somewhere a counter should only start from 1 in stead of 2\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/862/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/862/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/851", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/851/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/851/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/851/events", "html_url": "https://github.com/psf/requests/issues/851", "id": 6837189, "node_id": "MDU6SXNzdWU2ODM3MTg5", "number": 851, "title": "SSL \"unknown protocol\" is returned when it should be \"certificate verify failed\"", "user": {"login": "joeshaw", "id": 39916, "node_id": "MDQ6VXNlcjM5OTE2", "avatar_url": "https://avatars.githubusercontent.com/u/39916?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joeshaw", "html_url": "https://github.com/joeshaw", "followers_url": "https://api.github.com/users/joeshaw/followers", "following_url": "https://api.github.com/users/joeshaw/following{/other_user}", "gists_url": "https://api.github.com/users/joeshaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/joeshaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joeshaw/subscriptions", "organizations_url": "https://api.github.com/users/joeshaw/orgs", "repos_url": "https://api.github.com/users/joeshaw/repos", "events_url": "https://api.github.com/users/joeshaw/events{/privacy}", "received_events_url": "https://api.github.com/users/joeshaw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 18, "created_at": "2012-09-13T02:17:35Z", "updated_at": "2021-09-09T05:00:51Z", "closed_at": "2013-01-21T20:23:07Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "This may be related to issue #606 and is caused by pull request #799.\n\nWith requests 0.14.0, if you attempt to visit a site with a certificate whose CA is not trusted and who doesn't support SSLv2, you'll get an error like this:\n\n```\n_ssl.c:480: error:140770FC:SSL routines:SSL23_GET_SERVER_HELLO:unknown protocol\n```\n\nwhen you should instead be getting an error like this:\n\n```\n_ssl.c:480: error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed\n```\n\nThis is because `SSLError` is caught when calling `ssl.wrap_socket()` in `VerifiedHTTPSConnection` attempting only a SSLv3 connection and then tries SSLv23.  Since my server doesn't support SSLv2, the latter call throws the \"unknown protocol\" error.  From my interpretation of issue #606 it seems like that was an intentional OpenSSL policy decision (although reversed in later OpenSSL?)\n\nRequests 0.12.1 returns the right error.  This is testing on Ubuntu 10.04 LTS (Lucid) with Python 2.6.5 and OpenSSL 0.9.8k-7ubuntu8.13\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/851/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/851/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/844", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/844/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/844/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/844/events", "html_url": "https://github.com/psf/requests/issues/844", "id": 6705803, "node_id": "MDU6SXNzdWU2NzA1ODAz", "number": 844, "title": "umbrella ticket to resolve iteration / read size / chunked encoding questions", "user": {"login": "slingamn", "id": 376448, "node_id": "MDQ6VXNlcjM3NjQ0OA==", "avatar_url": "https://avatars.githubusercontent.com/u/376448?v=4", "gravatar_id": "", "url": "https://api.github.com/users/slingamn", "html_url": "https://github.com/slingamn", "followers_url": "https://api.github.com/users/slingamn/followers", "following_url": "https://api.github.com/users/slingamn/following{/other_user}", "gists_url": "https://api.github.com/users/slingamn/gists{/gist_id}", "starred_url": "https://api.github.com/users/slingamn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/slingamn/subscriptions", "organizations_url": "https://api.github.com/users/slingamn/orgs", "repos_url": "https://api.github.com/users/slingamn/repos", "events_url": "https://api.github.com/users/slingamn/events{/privacy}", "received_events_url": "https://api.github.com/users/slingamn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}, {"id": 167537670, "node_id": "MDU6TGFiZWwxNjc1Mzc2NzA=", "url": "https://api.github.com/repos/psf/requests/labels/Propose%20Close", "name": "Propose Close", "color": "f7c6c7", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 52, "created_at": "2012-09-07T03:54:10Z", "updated_at": "2021-09-08T23:06:04Z", "closed_at": "2015-01-19T09:29:14Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "This ticket is intended to aggregate previous discussion from #539, #589, and #597 about the default value of `chunk_size` used by `iter_content` and `iter_lines`.\n\ncc @mponton @gwrtheyrn @shazow\n\nIssues:\n1. The default read size of `iter_content` is 1 byte; this is probably inefficient\n2. Requests does not expose the ability to read chunked encoding streams in the \"correct\" way, i.e., using the provided octet counts to tell how much to read.\n3. However, this would not be suitable as the default implementation of `iter_content` anyway; not all websites are standards-compliant and when this was tried it caused more problems than it solved.\n4. The current default read size for `iter_lines` is 10kB. This is high enough that iteration over lines can be perceived as unresponsive --- no lines are returned until all 10kB have been read.\n5. There is no \"correct\" way to implement `iter_lines` using blocking I/O, we just have to bite the bullet and take a guess as to how much data we should read.\n6. There's apparently some nondeterminism in `iter_lines`, I think because of the edge case where a read ends between a `\\r` and a `\\n`.\n7. `iter_lines` is backed by `iter_content`, which operates on raw byte strings and splits at byte boundaries. I think there may be edge cases where we could split the body in the middle of a multi-byte encoding of a Unicode character.\n\nMy guess at a solution:\n1. Set the default `chunk_size` to 1024 bytes, for both `iter_content` and `iter_lines`.\n2. Provide a separate interface (possibly `iter_chunks`) for iterating over chunks of pages that are known to correctly implement chunked encoding, e.g., Twitter's firehose APIs\n3. We may need our own implementation of `splitlines` that is deterministic with respect to our chunking boundaries, i.e., remembers if the last-read character was `\\r` and suppresses a subsequent `\\n`. We may also need to build in Unicode awareness at this level, i.e., decode as much of the body as is valid, then save any leftover invalid bytes to be prepended to the next chunk.\n\nComments and thoughts are much appreciated. Thanks for your time!\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/844/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/844/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/771", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/771/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/771/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/771/events", "html_url": "https://github.com/psf/requests/issues/771", "id": 6149391, "node_id": "MDU6SXNzdWU2MTQ5Mzkx", "number": 771, "title": "socket leak (suspected due to redirection)", "user": {"login": "eranrund", "id": 1485066, "node_id": "MDQ6VXNlcjE0ODUwNjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1485066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eranrund", "html_url": "https://github.com/eranrund", "followers_url": "https://api.github.com/users/eranrund/followers", "following_url": "https://api.github.com/users/eranrund/following{/other_user}", "gists_url": "https://api.github.com/users/eranrund/gists{/gist_id}", "starred_url": "https://api.github.com/users/eranrund/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eranrund/subscriptions", "organizations_url": "https://api.github.com/users/eranrund/orgs", "repos_url": "https://api.github.com/users/eranrund/repos", "events_url": "https://api.github.com/users/eranrund/events{/privacy}", "received_events_url": "https://api.github.com/users/eranrund/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 47, "created_at": "2012-08-10T12:21:29Z", "updated_at": "2021-09-09T05:30:52Z", "closed_at": "2012-11-17T11:17:01Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "It seems requests forgets to properly close a socket when a redirection occurs.\nSee the following gist for the code that causes the issue (at least here..): \nhttps://gist.github.com/3313868\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/771/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/771/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/747", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/747/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/747/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/747/events", "html_url": "https://github.com/psf/requests/issues/747", "id": 5928424, "node_id": "MDU6SXNzdWU1OTI4NDI0", "number": 747, "title": "requests.{post,patch} set Content-Type to application/x-www-form-urlencoded even when ``data`` arg is a string", "user": {"login": "nisavid", "id": 576874, "node_id": "MDQ6VXNlcjU3Njg3NA==", "avatar_url": "https://avatars.githubusercontent.com/u/576874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nisavid", "html_url": "https://github.com/nisavid", "followers_url": "https://api.github.com/users/nisavid/followers", "following_url": "https://api.github.com/users/nisavid/following{/other_user}", "gists_url": "https://api.github.com/users/nisavid/gists{/gist_id}", "starred_url": "https://api.github.com/users/nisavid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nisavid/subscriptions", "organizations_url": "https://api.github.com/users/nisavid/orgs", "repos_url": "https://api.github.com/users/nisavid/repos", "events_url": "https://api.github.com/users/nisavid/events{/privacy}", "received_events_url": "https://api.github.com/users/nisavid/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2012-07-30T20:18:22Z", "updated_at": "2021-09-09T06:00:56Z", "closed_at": "2012-08-04T15:39:39Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "the Requests documentation [clearly states](http://docs.python-requests.org/en/latest/user/quickstart/#more-complicated-post-requests),\n\n> There are many times that you want to send data that is not form-encoded. If you pass in a `string` instead of a `dict`, that data will be posted directly.\n\ni presume that it's safe to interpret \"`string`\" here as meaning \"`str` or `unicode`\" (minor documentation error).  i'm not sure what the string being \"posted directly\" is supposed to mean.  i suppose it should mean that the request's `Content-Type` is `text/plain`, since that's a reasonable interpretation of a generic string.  in any case, i'm quite sure that it's _not_ supposed to mean that the string is passed in as form-encoded data.  that would defeat the stated purpose of passing in a string instead of a `dict`.\n\nunfortunately, passing a `str` as the `data` does in fact cause the request to have `Content-Type` `application/x-www-form-urlencoded`, just as in the `dict` case.\n\neither this behavior is incorrect or the documentation is incorrect.  i'd prefer it to be the former.  the automatic conversion of a `dict` of parameters as form-encoded data seems to be specific to the case where `data` is a mapping (in fact, i'd prefer this special case to likewise interpret any `collections.Mapping` objects rather than just `dict`s).  when `data` is a string, on the other hand, it seems natural to interpret it as a plain-text string (`text/plain`) unless otherwise specified.  in other words, the particular media type of the request entity is application-dependent; automatically applying `application/x-www-form-urlencoded` is an act of incorrectly imposing one application's assumptions on another.  the current behavior leads to confusing bugs when a user forgets to specify the proper media type, Requests (incorrectly) applies `application/x-www-form-urlencoded`, and the receiving server subsequently parses the entity (incorrectly) as such.  `text/plain` has no inherent syntax, so an unsuspecting web server will not mangle it if the user forgets to specify the correct media type.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/747/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/747/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/738", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/738/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/738/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/738/events", "html_url": "https://github.com/psf/requests/issues/738", "id": 5823472, "node_id": "MDU6SXNzdWU1ODIzNDcy", "number": 738, "title": "pip install error on py3k", "user": {"login": "clee704", "id": 220039, "node_id": "MDQ6VXNlcjIyMDAzOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/220039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/clee704", "html_url": "https://github.com/clee704", "followers_url": "https://api.github.com/users/clee704/followers", "following_url": "https://api.github.com/users/clee704/following{/other_user}", "gists_url": "https://api.github.com/users/clee704/gists{/gist_id}", "starred_url": "https://api.github.com/users/clee704/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/clee704/subscriptions", "organizations_url": "https://api.github.com/users/clee704/orgs", "repos_url": "https://api.github.com/users/clee704/repos", "events_url": "https://api.github.com/users/clee704/events{/privacy}", "received_events_url": "https://api.github.com/users/clee704/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2012-07-25T05:47:28Z", "updated_at": "2021-09-09T05:31:03Z", "closed_at": "2012-07-27T06:11:43Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "With Python 3.2.3 and pip 1.1, `pip install requests` installs Requests 0.13.3 printing scary words like SyntaxError although it seems to work fine after installation. The exact output is below. If further information is needed, please let me know.\n\n```\n$ pip-3.2 install requests\nDownloading/unpacking requests\n  Downloading requests-0.13.3.tar.gz (515Kb): 515Kb downloaded\n  Running setup.py egg_info for package requests\n\n    warning: no files found matching 'tests/*.'\nInstalling collected packages: requests\n  Running setup.py install for requests\n\n    warning: no files found matching 'tests/*.'\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/oauthlib/oauth2/draft25/__init__.py\", line 15\n        AUTH_HEADER = u'auth_header'\n                                   ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/oauthlib/oauth2/draft25/parameters.py\", line 50\n        params = [((u'response_type', response_type)),\n                                   ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/oauthlib/oauth2/draft25/tokens.py\", line 22\n        body=None, ext=u'', hash_algorithm=u'hmac-sha-1'):\n                         ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/oauthlib/oauth2/draft25/utils.py\", line 18\n        u'HTTP': u'80',\n              ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/oauthlib/oauth1/rfc5849/__init__.py\", line 20\n        SIGNATURE_HMAC = u\"HMAC-SHA1\"\n                                    ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/oauthlib/oauth1/rfc5849/parameters.py\", line 60\n        part = u'{0}=\"{1}\"'.format(escaped_name, escaped_value)\n                          ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/oauthlib/oauth1/rfc5849/signature.py\", line 76\n        base_string += u'&'\n                          ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/oauthlib/oauth1/rfc5849/utils.py\", line 36\n        is_oauth = lambda kv: kv[0].startswith(u\"oauth_\")\n                                                       ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/oauthlib/common.py\", line 22\n        always_safe = (u'ABCDEFGHIJKLMNOPQRSTUVWXYZ'\n                                                   ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/chardet/langgreekmodel.py\", line 215\n        'keepEnglishLetter': constants.False,\n                                           ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/chardet/constants.py\", line 46\n        False = __builtin__.False\n                                ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/chardet/universaldetector.py\", line 51\n        self.done = constants.False\n                                  ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/chardet/sbcsgroupprober.py\", line 59\n        logicalHebrewProber = SingleByteCharSetProber(Win1255HebrewModel, constants.False, hebrewProber)\n                                                                                        ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/chardet/langcyrillicmodel.py\", line 287\n        'keepEnglishLetter': constants.False,\n                                           ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/chardet/langthaimodel.py\", line 198\n        'keepEnglishLetter': constants.False,\n                                           ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/chardet/langbulgarianmodel.py\", line 218\n        'keepEnglishLetter': constants.False,\n                                           ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/chardet/chardistribution.py\", line 48\n        self._mDone = constants.False # If this flag is set to constants.True, detection is done and conclusion has been made\n                                    ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/chardet/langhebrewmodel.py\", line 199\n        'keepEnglishLetter': constants.False,\n                                           ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/chardet/charsetgroupprober.py\", line 44\n        prober.active = constants.True\n                                     ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/chardet/sbcharsetprober.py\", line 42\n        def __init__(self, model, reversed=constants.False, nameProber=None):\n                                                         ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/chardet/escprober.py\", line 48\n        codingSM.active = constants.True\n                                       ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/chardet/jpcntx.py\", line 132\n        self._mDone = constants.False # If this flag is set to constants.True, detection is done and conclusion has been made\n                                    ^\n    SyntaxError: invalid syntax\n\n      File \"/usr/local/lib/python3.2/dist-packages/requests/packages/chardet/langhungarianmodel.py\", line 215\n        'keepEnglishLetter': constants.True,\n                                          ^\n    SyntaxError: invalid syntax\n\nSuccessfully installed requests\nCleaning up...\n$ python3.2\n>>> import requests\n>>> r = requests.get('http://www.google.com')\n>>> r.ok\nTrue\n>>> \n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/738/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/738/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/697", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/697/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/697/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/697/events", "html_url": "https://github.com/psf/requests/issues/697", "id": 5280431, "node_id": "MDU6SXNzdWU1MjgwNDMx", "number": 697, "title": "Catch UnicodeError coming from encodings/idna.py", "user": {"login": "terrycojones", "id": 132978, "node_id": "MDQ6VXNlcjEzMjk3OA==", "avatar_url": "https://avatars.githubusercontent.com/u/132978?v=4", "gravatar_id": "", "url": "https://api.github.com/users/terrycojones", "html_url": "https://github.com/terrycojones", "followers_url": "https://api.github.com/users/terrycojones/followers", "following_url": "https://api.github.com/users/terrycojones/following{/other_user}", "gists_url": "https://api.github.com/users/terrycojones/gists{/gist_id}", "starred_url": "https://api.github.com/users/terrycojones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/terrycojones/subscriptions", "organizations_url": "https://api.github.com/users/terrycojones/orgs", "repos_url": "https://api.github.com/users/terrycojones/repos", "events_url": "https://api.github.com/users/terrycojones/events{/privacy}", "received_events_url": "https://api.github.com/users/terrycojones/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2012-06-26T18:31:32Z", "updated_at": "2021-09-09T06:00:52Z", "closed_at": "2012-08-13T21:14:51Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Here's a Python 2.6 Requests 0.13.1 traceback.  Looks like the call to `netloc.encode('idna').decode('utf-8')` needs a try/except.\n\n```\nFile \"/srv/import-service/lib/python2.6/site-packages/requests/api.py\", line 76, in head\n    return request('head', url, **kwargs)\n  File \"/srv/import-service/lib/python2.6/site-packages/requests/safe_mode.py\", line 37, in wrapped\n    return function(method, url, **kwargs)\n  File \"/srv/import-service/lib/python2.6/site-packages/requests/api.py\", line 42, in request\n    return s.request(method=method, url=url, **kwargs)\n  File \"/srv/import-service/lib/python2.6/site-packages/requests/sessions.py\", line 230, in request\n    r.send(prefetch=prefetch)\n  File \"/srv/import-service/lib/python2.6/site-packages/requests/models.py\", line 618, in send\n    self._build_response(r)\n  File \"/srv/import-service/lib/python2.6/site-packages/requests/models.py\", line 305, in _build_response\n    request.send()\n  File \"/srv/import-service/lib/python2.6/site-packages/requests/models.py\", line 474, in send\n    url = self.full_url\n  File \"/srv/import-service/lib/python2.6/site-packages/requests/models.py\", line 388, in full_url\n    netloc = netloc.encode('idna').decode('utf-8')\n  File \"/srv/import-service/lib/python2.6/encodings/idna.py\", line 164, in encode\n    result.append(ToASCII(label))\n  File \"/srv/import-service/lib/python2.6/encodings/idna.py\", line 73, in ToASCII\n    raise UnicodeError(\"label empty or too long\")\nUnicodeError: label empty or too long\n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/697/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/697/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/649", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/649/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/649/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/649/events", "html_url": "https://github.com/psf/requests/issues/649", "id": 4874272, "node_id": "MDU6SXNzdWU0ODc0Mjcy", "number": 649, "title": "CaseInsensitiveDict __setitem__ faulty for differing-case keys", "user": {"login": "cdunklau", "id": 882547, "node_id": "MDQ6VXNlcjg4MjU0Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/882547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cdunklau", "html_url": "https://github.com/cdunklau", "followers_url": "https://api.github.com/users/cdunklau/followers", "following_url": "https://api.github.com/users/cdunklau/following{/other_user}", "gists_url": "https://api.github.com/users/cdunklau/gists{/gist_id}", "starred_url": "https://api.github.com/users/cdunklau/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cdunklau/subscriptions", "organizations_url": "https://api.github.com/users/cdunklau/orgs", "repos_url": "https://api.github.com/users/cdunklau/repos", "events_url": "https://api.github.com/users/cdunklau/events{/privacy}", "received_events_url": "https://api.github.com/users/cdunklau/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2012-06-03T00:59:23Z", "updated_at": "2021-09-09T03:00:42Z", "closed_at": "2012-07-27T05:54:43Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "I think I figured out the cause of the issue described here: https://github.com/kennethreitz/requests/pull/59\n\nIt appears that if one isn't careful to use a common case convention when assigning a header after it has been assigned before, the header will fail to work. The request will use the old header value... I think I know why, too. Here's an example:\n\ntest.py\n\n``` python\n\nfrom requests.structures import CaseInsensitiveDict\n\nprint \"Initializing CID = CaseInsensitiveDict()\"\nCID = CaseInsensitiveDict()\n\nprint \"Setting 'spam': 'eggs'\"\nCID['spam'] = 'eggs'\nprint \"Setting 'Spam': 'Eggs'\"\nCID['Spam'] = 'Eggs'\nprint \"Setting 'sPAM': 'eGGS'\"\nCID['sPAM'] = 'eGGS'\n\nprint \"Contents of CID:\", CID\nprint \"CID['spam']: '%s'\" % CID['spam']\nprint \"CID['Spam']: '%s'\" % CID['Spam']\nprint \"CID['sPAM']: '%s'\" % CID['sPAM']\n\nprint \"\\n\\n\\n\"\n\nprint \"Initializing CID = CaseInsensitiveDict()\"\nCID = CaseInsensitiveDict()\n\nprint \"Setting 'sPAM': 'eGGS'\"\nCID['sPAM'] = 'eGGS'\nprint \"Setting 'Spam': 'Eggs'\"\nCID['Spam'] = 'Eggs'\nprint \"Setting 'spam': 'eggs'\"\nCID['spam'] = 'eggs'\n\nprint \"Contents of CID:\", CID\nprint \"CID['spam']: '%s'\" % CID['spam']\nprint \"CID['Spam']: '%s'\" % CID['Spam']\nprint \"CID['sPAM']: '%s'\" % CID['sPAM']\n```\n\nThe output:\n\n```\nInitializing CID = CaseInsensitiveDict()\nSetting 'spam': 'eggs'\nSetting 'Spam': 'Eggs'\nSetting 'sPAM': 'eGGS'\nContents of CID: {'sPAM': 'eGGS', 'Spam': 'Eggs', 'spam': 'eggs'}\nCID['spam']: 'eggs'\nCID['Spam']: 'eggs'\nCID['sPAM']: 'eggs'\n\nInitializing CID = CaseInsensitiveDict()\nSetting 'sPAM': 'eGGS'\nSetting 'Spam': 'Eggs'\nSetting 'spam': 'eggs'\nContents of CID: {'spam': 'eggs', 'Spam': 'Eggs', 'sPAM': 'eGGS'}\nCID['spam']: 'eGGS'\nCID['Spam']: 'eGGS'\nCID['sPAM']: 'eGGS'\n```\n\nNotice how in both passes, only the first assignment actually \"works\". It stores the data for all three assignments, but will only return the value set by the initial key.\n\nI believe the only change necessary would be to the **setitem** method on CaseInsensitiveDict:\n\nBroken:\n\n``` python\n    def __setitem__(self, key, value):\n        dict.__setitem__(self, key, value)\n        self._clear_lower_keys()\n```\n\nFixed:\n\n``` python\n    def __setitem__(self, key, value):\n        dict.__setitem__(self, key.lower(), value)\n        self._clear_lower_keys()\n```\n\nWhen I use the corrected module, the CaseInsensitiveDict behaves as I believe it should:\n\n```\nInitializing CID = CaseInsensitiveDict()\nSetting 'spam': 'eggs'\nSetting 'Spam': 'Eggs'\nSetting 'sPAM': 'eGGS'\nContents of CID: {'spam': 'eGGS'}\nCID['spam']: 'eGGS'\nCID['Spam']: 'eGGS'\nCID['sPAM']: 'eGGS'\n\nInitializing CID = CaseInsensitiveDict()\nSetting 'sPAM': 'eGGS'\nSetting 'Spam': 'Eggs'\nSetting 'spam': 'eggs'\nContents of CID: {'spam': 'eggs'}\nCID['spam']: 'eggs'\nCID['Spam']: 'eggs'\nCID['sPAM']: 'eggs'\n```\n\nNote that the value for that key is the last one assigned, instead of the first.\n\nIf needed, I can put together a pull request for this, but it might take some time since I've never done it before :)\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/649/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/649/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/639", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/639/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/639/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/639/events", "html_url": "https://github.com/psf/requests/issues/639", "id": 4778913, "node_id": "MDU6SXNzdWU0Nzc4OTEz", "number": 639, "title": "safe mode doesn't work when not returning response", "user": {"login": "piotr-dobrogost", "id": 92239, "node_id": "MDQ6VXNlcjkyMjM5", "avatar_url": "https://avatars.githubusercontent.com/u/92239?v=4", "gravatar_id": "", "url": "https://api.github.com/users/piotr-dobrogost", "html_url": "https://github.com/piotr-dobrogost", "followers_url": "https://api.github.com/users/piotr-dobrogost/followers", "following_url": "https://api.github.com/users/piotr-dobrogost/following{/other_user}", "gists_url": "https://api.github.com/users/piotr-dobrogost/gists{/gist_id}", "starred_url": "https://api.github.com/users/piotr-dobrogost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/piotr-dobrogost/subscriptions", "organizations_url": "https://api.github.com/users/piotr-dobrogost/orgs", "repos_url": "https://api.github.com/users/piotr-dobrogost/repos", "events_url": "https://api.github.com/users/piotr-dobrogost/events{/privacy}", "received_events_url": "https://api.github.com/users/piotr-dobrogost/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2012-05-28T11:28:42Z", "updated_at": "2021-09-09T05:30:06Z", "closed_at": "2012-12-18T20:15:20Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "``` python\nfrom requests import get\n\nif __name__ == '__main__':\n\n    invalid_url = 'http://_/'\n    req = get(invalid_url,\n              config=dict(safe_mode=True),\n              return_response=False)\n    res = req.send() # throws ConnectionError\n```\n\nThe reason is catch_exceptions_if_in_safe_mode() decorates request() which calls Session.request() which does not call Request.send() when send_request is False which is the case with async requests. I guess we should decorate Request.send() not request()\n\nSee issue #583\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/639/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/639/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/637", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/637/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/637/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/637/events", "html_url": "https://github.com/psf/requests/issues/637", "id": 4768761, "node_id": "MDU6SXNzdWU0NzY4NzYx", "number": 637, "title": "Dict data is not being properly urlencoded", "user": {"login": "ghost", "id": 10137, "node_id": "MDQ6VXNlcjEwMTM3", "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghost", "html_url": "https://github.com/ghost", "followers_url": "https://api.github.com/users/ghost/followers", "following_url": "https://api.github.com/users/ghost/following{/other_user}", "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghost/subscriptions", "organizations_url": "https://api.github.com/users/ghost/orgs", "repos_url": "https://api.github.com/users/ghost/repos", "events_url": "https://api.github.com/users/ghost/events{/privacy}", "received_events_url": "https://api.github.com/users/ghost/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2012-05-27T00:01:10Z", "updated_at": "2021-09-09T08:00:37Z", "closed_at": "2012-06-15T18:32:14Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "I was trying to use FB Graph API and notice a little problem.\n\nConsider the following example:\n\n``` python\ndestination = 'https://graph.facebook.com/me/feed/'\ninfo = {'access_token': '1234567890', 'message': 'TEST', 'privacy': {'friends': 'NO_FRIENDS', 'value': 'CUSTOM'}}\nrequests.post(destination, data=info)\n```\n\nThe above example will be rejected by FB Api (error400).\n\nAt first, I thought it was a content-type problem, because of the default application/x-www-form-urlencoded\nthat requests set as content-type when post data is not a string.\n\nSo, I just change the above example to force content-type header to be None: \n\n``` python\n...\nheaders = {'content-type':  None}\nrequests.post(destination, data=info, headers=headers)\n```\n\nBut, since I'm not making info a string, requests keep trying to send a content-type=application/x-www-form-urlencoded\n\nRecently, I've tried with success to mix urllib with requests and discover that\nalthough I can't force a content-type header to be None (is this another issue?),\nthe problem with FB rejecting my Post is related with a wrong urlencoding of post data.\n\nThis is the example version which actually is working (and I'm using in my code):\n\n```\nimport urllib\ninfo = urllib.urlencode(info) \n\nrequests.post(destination, data=info, headers=headers)  # profit\n```\n\nurllib.urlencode transform info into \n'access_token=1234567890&message=TEST&privacy=%7B%27friends%27%3A+%27NO_FRIENDS%27%2C+%27value%27%3A+%27CUSTOM%27%7D'\n\nand this string is correctly accepted as a post request by FB.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/637/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/637/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/627", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/627/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/627/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/627/events", "html_url": "https://github.com/psf/requests/issues/627", "id": 4690960, "node_id": "MDU6SXNzdWU0NjkwOTYw", "number": 627, "title": "Failure to get through digest page which redirects to temporary AWS url", "user": {"login": "vlcinsky", "id": 635911, "node_id": "MDQ6VXNlcjYzNTkxMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/635911?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vlcinsky", "html_url": "https://github.com/vlcinsky", "followers_url": "https://api.github.com/users/vlcinsky/followers", "following_url": "https://api.github.com/users/vlcinsky/following{/other_user}", "gists_url": "https://api.github.com/users/vlcinsky/gists{/gist_id}", "starred_url": "https://api.github.com/users/vlcinsky/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vlcinsky/subscriptions", "organizations_url": "https://api.github.com/users/vlcinsky/orgs", "repos_url": "https://api.github.com/users/vlcinsky/repos", "events_url": "https://api.github.com/users/vlcinsky/events{/privacy}", "received_events_url": "https://api.github.com/users/vlcinsky/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 31, "created_at": "2012-05-22T13:57:29Z", "updated_at": "2021-09-09T05:30:44Z", "closed_at": "2012-11-27T18:36:34Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "-- edit --\n\nThis relates to finding of @Lukas, who found, that **hooks are not passed to a new request on redirect**, which is not described elsewhere (yet?).\n\nAs soon as this hook related problem is resolved, there seem to be solution using hook, removing problem making header Authorization from final redirecting request (as sigmavirus24 has found).\n\n-- end of edit --\n\nI use web app, which first asks user to authenticate (usign digest auth) and then redirects him to temporarily valid url at AWS s3 storage.\n\nUsing requests fails to handle this correctly, it reports 401.\n\nAsking for easy pages does not make these problems.\n\nUsing the app over web browser works well.\n\nI created test utility::\n\n``` python\nimport requests\nfrom requests.auth import HTTPDigestAuth\n\ndef test_redirect_to_easypage():\n    url =  'http://localhost:8080/feed'\n    auth = HTTPDigestAuth(\"user\", \"password\")\n    params = {\"key\": \"easypage\"}\n    r = requests.get(url, auth = auth, params = params)\n    assert r.status_code == 200\n    assert len(r.history) == 2\n    assert r.history[1].status_code == 401\n    assert r.history[0].status_code == 302\n    return\n\ndef test_redirect_to_awspage():\n    url =  'http://localhost:8080/feed'\n    auth = HTTPDigestAuth(\"user\", \"password\")\n    params = {\"key\": \"awsredir\"}\n    r = requests.get(url, auth = auth, params = params)\n    assert r.status_code == 200\n    assert len(r.history) == 2\n    assert r.history[1].status_code == 401\n    assert r.history[0].status_code == 302\n    return \n```\n\ntest_redirect_to_awspage fails by 401.\n\nAnd here is simple web app, written in cherrypy::\n\n``` python\n\"\"\"Test cherrypy web server for \"requests\" test redirection to AWS S3 temporary url.\n\n2012-05-22 by jan.vlcinsky@gmail.com\n\"\"\"\nimport cherrypy\nfrom cherrypy.lib import auth_digest\n\nclass DigestForwarder(object):\n    \"\"\"Server, serving only authorized users (\"user\", \"password\") by redirecting to some secret destination url\n\n    Home page (gives you instructions and links to use)\n        http://localhost:8080/\n    Easy page redirection:\n        http://localhost:8080/feed?key=easypage\n    Redirection to tmp AWS page (valid till end 2012):\n        http://localhost:8080/feed?key=awsredir\n    \"\"\"\n\n    targets=dict(\n                easypage= \"http://docs.python-requests.org/en/latest/index.html\",\n                awsredir= \"http://janvlcinsky.s3.amazonaws.com/files.basex.org/xml/xmark.xml?AWSAccessKeyId=AKIAJBXTB3W6TPH7OEQA&Expires=1356908390&Signature=t6HE4oEdTVx4Mi9Q7TrDbe6%2FQxs%3D\"\n            )\n    @cherrypy.expose\n    def index(self):\n        login = cherrypy.request.login\n        lines = \"\"\n        for key, value in self.targets.items():\n            request_url = \"/feed?key=\" + key\n            lines += \"\"\"<li>Key: %(key)s: <a href=\"%(request_url)s\">%(request_url)s</a></li>\"\"\" % locals()\n\n        return \"\"\"\\\n        <html>\n            <body>\n                <h1>Digest based redirector</h1>\n                <p>Your user account <b>%(login)s</b> has access to following feeds:</p>\n                <ul>\n                    %(lines)s\n                </ul>\n            </body>\n        </html>\"\"\" % locals()\n\n    @cherrypy.expose\n    def feed(self, key):\n        if key in self.targets.keys():\n          url = self.targets[key]\n          raise cherrypy.HTTPRedirect(url, 302)\n        else:\n          raise cherrypy.HTTPError(400, \"Unexpected value of feed key: %s.\" % key)\n\n        return \"You asked for key %(key)s and are redirected to %(ulr)s\" % locals()\n\nconf =  {\"/\": {\n            \"log.error_file\":            \"digestforwarder.error.log\",\n            \"log.access_file\":           \"digestforwarder.logaccess.log\",\n            \"tools.auth_digest.on\":      True,\n            \"tools.auth_digest.realm\":   'localhost',\n            \"tools.auth_digest.get_ha1\": cherrypy.lib.auth_digest.get_ha1_dict_plain({'user': 'password'}),\n            \"tools.auth_digest.key\":     'abcd12345efgh',\n            \"tools.auth_digest.debug\":    True\n            }\n        }\ncontroller = DigestForwarder()\nprint controller.__doc__\ncherrypy.quickstart(controller, config = conf)\n```\n\nAssuming you have cherrypy installed, just run the script which will provide what is needed for testing locally.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/627/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/627/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/606", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/606/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/606/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/606/events", "html_url": "https://github.com/psf/requests/issues/606", "id": 4537873, "node_id": "MDU6SXNzdWU0NTM3ODcz", "number": 606, "title": "Allow specifying the ssl protocol version to use", "user": {"login": "mvantellingen", "id": 245297, "node_id": "MDQ6VXNlcjI0NTI5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/245297?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mvantellingen", "html_url": "https://github.com/mvantellingen", "followers_url": "https://api.github.com/users/mvantellingen/followers", "following_url": "https://api.github.com/users/mvantellingen/following{/other_user}", "gists_url": "https://api.github.com/users/mvantellingen/gists{/gist_id}", "starred_url": "https://api.github.com/users/mvantellingen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mvantellingen/subscriptions", "organizations_url": "https://api.github.com/users/mvantellingen/orgs", "repos_url": "https://api.github.com/users/mvantellingen/repos", "events_url": "https://api.github.com/users/mvantellingen/events{/privacy}", "received_events_url": "https://api.github.com/users/mvantellingen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 20, "created_at": "2012-05-11T17:32:54Z", "updated_at": "2018-11-04T13:36:35Z", "closed_at": "2012-07-27T06:10:49Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Allow specifying the ssh protocol version (sslv2 or sslv3). This should fix problems connecting to various https sites (e.g. *.sharepoint.com)\n\nSee http://bugs.python.org/issue11220 for more information\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/606/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/606/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/605", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/605/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/605/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/605/events", "html_url": "https://github.com/psf/requests/issues/605", "id": 4522903, "node_id": "MDU6SXNzdWU0NTIyOTAz", "number": 605, "title": "async broken on Windows", "user": {"login": "piotr-dobrogost", "id": 92239, "node_id": "MDQ6VXNlcjkyMjM5", "avatar_url": "https://avatars.githubusercontent.com/u/92239?v=4", "gravatar_id": "", "url": "https://api.github.com/users/piotr-dobrogost", "html_url": "https://github.com/piotr-dobrogost", "followers_url": "https://api.github.com/users/piotr-dobrogost/followers", "following_url": "https://api.github.com/users/piotr-dobrogost/following{/other_user}", "gists_url": "https://api.github.com/users/piotr-dobrogost/gists{/gist_id}", "starred_url": "https://api.github.com/users/piotr-dobrogost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/piotr-dobrogost/subscriptions", "organizations_url": "https://api.github.com/users/piotr-dobrogost/orgs", "repos_url": "https://api.github.com/users/piotr-dobrogost/repos", "events_url": "https://api.github.com/users/piotr-dobrogost/events{/privacy}", "received_events_url": "https://api.github.com/users/piotr-dobrogost/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2012-05-10T21:41:00Z", "updated_at": "2021-09-09T08:00:43Z", "closed_at": "2012-05-10T23:35:07Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Running below code\n\n``` python\nfrom requests import async\n\nif __name__ == '__main__':\n\n    req = async.get('http://httpbin.org/get')\n    res = async.map([req])[0]\n    print res.content\n```\n\nI get\n\n```\nTraceback (most recent call last):\n  File \"C:\\python\\virtualenv\\requests\\lib\\site-packages\\gevent-0.13.7-py2.7-win-amd64.egg\\gevent\\greenlet.py\", line 390, in run\n    result = self._run(*self.args, **self.kwargs)\n  File \"C:\\Users\\Piotr\\projects\\requests\\requests\\models.py\", line 606, in send\n    raise ConnectionError(e)\nConnectionError: HTTPConnectionPool(host='httpbin.org', port=80): Max retries exceeded with url: /get\n<Greenlet at 0x35e59c8L: <bound method Request.send of <Request [GET]>>(prefetch=True)> failed with ConnectionError\n\nNone\n```\n\nin about 90% cases.\n\nRequests 0.12.1\ngevent 0.13.7-py2.7-win-amd64\ngreenlet 0.3.4-py2.7-win-amd64\nPython 2.7.3 64bit\nWindows Vista 64bit\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/605/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/605/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/602", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/602/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/602/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/602/events", "html_url": "https://github.com/psf/requests/issues/602", "id": 4500221, "node_id": "MDU6SXNzdWU0NTAwMjIx", "number": 602, "title": "requests.head redirect timeout (on only linux environments?)", "user": {"login": "umbrae", "id": 285920, "node_id": "MDQ6VXNlcjI4NTkyMA==", "avatar_url": "https://avatars.githubusercontent.com/u/285920?v=4", "gravatar_id": "", "url": "https://api.github.com/users/umbrae", "html_url": "https://github.com/umbrae", "followers_url": "https://api.github.com/users/umbrae/followers", "following_url": "https://api.github.com/users/umbrae/following{/other_user}", "gists_url": "https://api.github.com/users/umbrae/gists{/gist_id}", "starred_url": "https://api.github.com/users/umbrae/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/umbrae/subscriptions", "organizations_url": "https://api.github.com/users/umbrae/orgs", "repos_url": "https://api.github.com/users/umbrae/repos", "events_url": "https://api.github.com/users/umbrae/events{/privacy}", "received_events_url": "https://api.github.com/users/umbrae/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 117745, "node_id": "MDU6TGFiZWwxMTc3NDU=", "url": "https://api.github.com/repos/psf/requests/labels/Planned", "name": "Planned", "color": "e102d8", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2012-05-09T19:55:44Z", "updated_at": "2021-09-09T07:05:20Z", "closed_at": "2012-07-27T06:14:15Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "On OSX I can run this fine:\n\n``` python\n# python2.6\nPython 2.6.7 (r267:88850, Jul 31 2011, 19:30:54) \n[GCC 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2335.15.00)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import requests\n>>> r = requests.head(\"http://feedproxy.google.com/~r/Techcrunch/~3/1P88-kHZWGs/\", allow_redirects=True, timeout=10)\n>>> r\n<Response [200]>\n>>> r.history\n[<Response [301]>]\n>>> requests.__version__\n'0.12.1'\n```\n\nHowever, the same request on an Ubuntu box times out - in multiple network environments:\n\n``` python\n# python\nPython 2.6.5 (r265:79063, Apr 16 2010, 13:57:41) \n[GCC 4.4.3] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import requests\n>>> r = requests.head(\"http://feedproxy.google.com/~r/Techcrunch/~3/1P88-kHZWGs/\", allow_redirects=True, timeout=10)\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/home/ubuntu/envs/rdb/lib/python2.6/site-packages/requests/api.py\", line 74, in head\n    return request('head', url, **kwargs)\n  File \"/home/ubuntu/envs/rdb/lib/python2.6/site-packages/requests/api.py\", line 40, in request\n    return s.request(method=method, url=url, **kwargs)\n  File \"/home/ubuntu/envs/rdb/lib/python2.6/site-packages/requests/sessions.py\", line 229, in request\n    r.send(prefetch=prefetch)\n  File \"/home/ubuntu/envs/rdb/lib/python2.6/site-packages/requests/models.py\", line 624, in send\n    self._build_response(r)\n  File \"/home/ubuntu/envs/rdb/lib/python2.6/site-packages/requests/models.py\", line 227, in _build_response\n    r.content  # Consume socket so it can be released\n  File \"/home/ubuntu/envs/rdb/lib/python2.6/site-packages/requests/models.py\", line 782, in content\n    self._content = bytes().join(self.iter_content(CONTENT_CHUNK_SIZE)) or bytes()\n  File \"/home/ubuntu/envs/rdb/lib/python2.6/site-packages/requests/models.py\", line 728, in generate\n    chunk = self.raw.read(chunk_size)\n  File \"/home/ubuntu/envs/rdb/lib/python2.6/site-packages/requests/packages/urllib3/response.py\", line 146, in read\n    return self._fp.read(amt)\n  File \"/usr/lib/python2.6/httplib.py\", line 518, in read\n    return self._read_chunked(amt)\n  File \"/usr/lib/python2.6/httplib.py\", line 551, in _read_chunked\n    line = self.fp.readline()\n  File \"/usr/lib/python2.6/socket.py\", line 397, in readline\n    data = recv(1)\nsocket.timeout: timed out\n>>> requests.__version__\n'0.12.1'\n```\n\nLooks like some sort of chunk reading issue?\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/602/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/602/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/539", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/539/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/539/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/539/events", "html_url": "https://github.com/psf/requests/issues/539", "id": 4005004, "node_id": "MDU6SXNzdWU0MDA1MDA0", "number": 539, "title": "iter_lines small chunks", "user": {"login": "dbrgn", "id": 105168, "node_id": "MDQ6VXNlcjEwNTE2OA==", "avatar_url": "https://avatars.githubusercontent.com/u/105168?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbrgn", "html_url": "https://github.com/dbrgn", "followers_url": "https://api.github.com/users/dbrgn/followers", "following_url": "https://api.github.com/users/dbrgn/following{/other_user}", "gists_url": "https://api.github.com/users/dbrgn/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbrgn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbrgn/subscriptions", "organizations_url": "https://api.github.com/users/dbrgn/orgs", "repos_url": "https://api.github.com/users/dbrgn/repos", "events_url": "https://api.github.com/users/dbrgn/events{/privacy}", "received_events_url": "https://api.github.com/users/dbrgn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 15, "created_at": "2012-04-06T15:04:40Z", "updated_at": "2021-09-09T08:00:46Z", "closed_at": "2012-05-08T05:09:24Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "I'm writing a script to track keywords in the twitter realtime api.\n\nAt first, I was using requests v0.10.8. Showing the tweets was almost instant, but the issue #515 occured frequently.\n\nThen I upgraded requests to v0.11.1. Now #515 is resolved, but apparently small chunks are not processed instantly, if they don't reach the `chunk_size`. By setting the chunk size to a value like 10, it works, but that can't be the solution :)\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/539/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/539/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/537", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/537/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/537/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/537/events", "html_url": "https://github.com/psf/requests/issues/537", "id": 3999105, "node_id": "MDU6SXNzdWUzOTk5MTA1", "number": 537, "title": "requests.get throws TooManyRedirects in safe_mode", "user": {"login": "spulec", "id": 292606, "node_id": "MDQ6VXNlcjI5MjYwNg==", "avatar_url": "https://avatars.githubusercontent.com/u/292606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spulec", "html_url": "https://github.com/spulec", "followers_url": "https://api.github.com/users/spulec/followers", "following_url": "https://api.github.com/users/spulec/following{/other_user}", "gists_url": "https://api.github.com/users/spulec/gists{/gist_id}", "starred_url": "https://api.github.com/users/spulec/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spulec/subscriptions", "organizations_url": "https://api.github.com/users/spulec/orgs", "repos_url": "https://api.github.com/users/spulec/repos", "events_url": "https://api.github.com/users/spulec/events{/privacy}", "received_events_url": "https://api.github.com/users/spulec/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2012-04-06T01:50:52Z", "updated_at": "2021-09-09T09:00:32Z", "closed_at": "2012-05-04T01:49:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "``` python\n>>> import requests\n>>> requests.__version__\n'0.11.1'\n>>> res = requests.get(\"http://httpbin.org/redirect/3\", config=dict(safe_mode=True, max_redirects=2))\nStarting new HTTP connection (1): httpbin.org\n\"GET /redirect/3 HTTP/1.1\" 302 229\n\"GET /redirect/2 HTTP/1.1\" 302 229\n\"GET /redirect/1 HTTP/1.1\" 302 215\nTraceback (most recent call last):\n  File \"<console>\", line 1, in <module>\n  File \"/Users/spulec/Development/yipit-env/lib/python2.7/site-packages/requests/api.py\", line 52, in get\n    return request('get', url, **kwargs)\n  File \"/Users/spulec/Development/yipit-env/lib/python2.7/site-packages/requests/api.py\", line 40, in request\n    return s.request(method=method, url=url, **kwargs)\n  File \"/Users/spulec/Development/yipit-env/lib/python2.7/site-packages/requests/sessions.py\", line 208, in request\n    r.send(prefetch=prefetch)\n  File \"/Users/spulec/Development/yipit-env/lib/python2.7/site-packages/requests/models.py\", line 597, in send\n    self._build_response(r)\n  File \"/Users/spulec/Development/yipit-env/lib/python2.7/site-packages/requests/models.py\", line 226, in _build_response\n    raise TooManyRedirects()\nTooManyRedirects\n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/537/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/537/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/520", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/520/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/520/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/520/events", "html_url": "https://github.com/psf/requests/issues/520", "id": 3871005, "node_id": "MDU6SXNzdWUzODcxMDA1", "number": 520, "title": "requests leaves a hanging connection for each request", "user": {"login": "Bluehorn", "id": 975735, "node_id": "MDQ6VXNlcjk3NTczNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/975735?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Bluehorn", "html_url": "https://github.com/Bluehorn", "followers_url": "https://api.github.com/users/Bluehorn/followers", "following_url": "https://api.github.com/users/Bluehorn/following{/other_user}", "gists_url": "https://api.github.com/users/Bluehorn/gists{/gist_id}", "starred_url": "https://api.github.com/users/Bluehorn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Bluehorn/subscriptions", "organizations_url": "https://api.github.com/users/Bluehorn/orgs", "repos_url": "https://api.github.com/users/Bluehorn/repos", "events_url": "https://api.github.com/users/Bluehorn/events{/privacy}", "received_events_url": "https://api.github.com/users/Bluehorn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 62, "created_at": "2012-03-29T07:19:00Z", "updated_at": "2021-09-03T00:10:52Z", "closed_at": "2012-08-06T04:38:28Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "This was already noted in #458, but deserves an extra ticket: When using the simple API (via requests.head/get/post etc.), the requests module leaves a connection open until it is garbage collected. This eats up resources on the server site and it really impolite.\n\nHow to reproduce:\n\nRun this script (can somebody please tell me how one can embed a gist in markdown? The help page shows only the result of embedding...):\n\nhttps://gist.github.com/2234274\n\nResult on my system:\n\n<pre>\ntorsten@sharokan:~/workspace/loco2-git$ python demo.py\nOpen sockets after 20 head requests:\nCOMMAND   PID    USER   FD   TYPE DEVICE SIZE/OFF NODE NAME\npython  13928 torsten    3u  IPv4 616968      0t0  TCP sharokan.fritz.box:50072->bk-in-f94.1e100.net:www (ESTABLISHED)\npython  13928 torsten    4u  IPv4 616972      0t0  TCP sharokan.fritz.box:50073->bk-in-f94.1e100.net:www (ESTABLISHED)\npython  13928 torsten    5u  IPv4 616976      0t0  TCP sharokan.fritz.box:50074->bk-in-f94.1e100.net:www (ESTABLISHED)\npython  13928 torsten    6u  IPv4 616980      0t0  TCP sharokan.fritz.box:50075->bk-in-f94.1e100.net:www (ESTABLISHED)\npython  13928 torsten    7u  IPv4 616984      0t0  TCP sharokan.fritz.box:50076->bk-in-f94.1e100.net:www (ESTABLISHED)\npython  13928 torsten    8u  IPv4 616988      0t0  TCP sharokan.fritz.box:50077->bk-in-f94.1e100.net:www (ESTABLISHED)\npython  13928 torsten    9u  IPv4 616992      0t0  TCP sharokan.fritz.box:50078->bk-in-f94.1e100.net:www (ESTABLISHED)\npython  13928 torsten   10u  IPv4 616996      0t0  TCP sharokan.fritz.box:50079->bk-in-f94.1e100.net:www (ESTABLISHED)\npython  13928 torsten   11u  IPv4 617000      0t0  TCP sharokan.fritz.box:50080->bk-in-f94.1e100.net:www (ESTABLISHED)\npython  13928 torsten   12u  IPv4 617004      0t0  TCP sharokan.fritz.box:50081->bk-in-f94.1e100.net:www (ESTABLISHED)\npython  13928 torsten   13u  IPv4 617008      0t0  TCP sharokan.fritz.box:50082->bk-in-f94.1e100.net:www (ESTABLISHED)\npython  13928 torsten   14u  IPv4 617012      0t0  TCP sharokan.fritz.box:50083->bk-in-f94.1e100.net:www (ESTABLISHED)\npython  13928 torsten   15u  IPv4 617016      0t0  TCP sharokan.fritz.box:50084->bk-in-f94.1e100.net:www (ESTABLISHED)\npython  13928 torsten   16u  IPv4 617020      0t0  TCP sharokan.fritz.box:50085->bk-in-f94.1e100.net:www (ESTABLISHED)\npython  13928 torsten   17u  IPv4 617024      0t0  TCP sharokan.fritz.box:50086->bk-in-f94.1e100.net:www (ESTABLISHED)\npython  13928 torsten   18u  IPv4 617028      0t0  TCP sharokan.fritz.box:50087->bk-in-f94.1e100.net:www (ESTABLISHED)\npython  13928 torsten   19u  IPv4 617032      0t0  TCP sharokan.fritz.box:50088->bk-in-f94.1e100.net:www (ESTABLISHED)\npython  13928 torsten   20u  IPv4 617036      0t0  TCP sharokan.fritz.box:50089->bk-in-f94.1e100.net:www (ESTABLISHED)\npython  13928 torsten   21u  IPv4 617040      0t0  TCP sharokan.fritz.box:50090->bk-in-f94.1e100.net:www (ESTABLISHED)\npython  13928 torsten   22u  IPv4 617044      0t0  TCP sharokan.fritz.box:50091->bk-in-f94.1e100.net:www (ESTABLISHED)\nGarbage collection result: 1700\nOpen sockets after garbage collection:\n</pre>\n\n\nI think the sockets should be closed immediately when the session is unrefed. FYI, I found this when testing a local webservice by running it in CherryPy which defaults to 10 threads - after 10 requests, the web server was blocked.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/520/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/520/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/500", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/500/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/500/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/500/events", "html_url": "https://github.com/psf/requests/issues/500", "id": 3722903, "node_id": "MDU6SXNzdWUzNzIyOTAz", "number": 500, "title": "Async requests don't honor timeout param", "user": {"login": "prior", "id": 843283, "node_id": "MDQ6VXNlcjg0MzI4Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/843283?v=4", "gravatar_id": "", "url": "https://api.github.com/users/prior", "html_url": "https://github.com/prior", "followers_url": "https://api.github.com/users/prior/followers", "following_url": "https://api.github.com/users/prior/following{/other_user}", "gists_url": "https://api.github.com/users/prior/gists{/gist_id}", "starred_url": "https://api.github.com/users/prior/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/prior/subscriptions", "organizations_url": "https://api.github.com/users/prior/orgs", "repos_url": "https://api.github.com/users/prior/repos", "events_url": "https://api.github.com/users/prior/events{/privacy}", "received_events_url": "https://api.github.com/users/prior/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2012-03-20T05:07:44Z", "updated_at": "2021-09-09T08:00:45Z", "closed_at": "2012-05-10T22:05:42Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Timeouts on the synchronous requests behave as expected, but the same exact calls with requests.async take twice as long to timeout (twice as long as the timeout specified).\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/500/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/500/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/498", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/498/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/498/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/498/events", "html_url": "https://github.com/psf/requests/issues/498", "id": 3704324, "node_id": "MDU6SXNzdWUzNzA0MzI0", "number": 498, "title": "App Engine Fixes", "user": {"login": "kennethreitz", "id": 119893, "node_id": "MDQ6VXNlcjExOTg5Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/119893?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennethreitz", "html_url": "https://github.com/kennethreitz", "followers_url": "https://api.github.com/users/kennethreitz/followers", "following_url": "https://api.github.com/users/kennethreitz/following{/other_user}", "gists_url": "https://api.github.com/users/kennethreitz/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennethreitz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennethreitz/subscriptions", "organizations_url": "https://api.github.com/users/kennethreitz/orgs", "repos_url": "https://api.github.com/users/kennethreitz/repos", "events_url": "https://api.github.com/users/kennethreitz/events{/privacy}", "received_events_url": "https://api.github.com/users/kennethreitz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}, {"id": 615414998, "node_id": "MDU6TGFiZWw2MTU0MTQ5OTg=", "url": "https://api.github.com/repos/psf/requests/labels/GAE%20Support", "name": "GAE Support", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 30, "created_at": "2012-03-19T02:03:45Z", "updated_at": "2021-09-08T09:00:49Z", "closed_at": "2012-07-27T05:29:28Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "http://stackoverflow.com/questions/9762685/using-the-requests-python-library-in-google-app-engine/9763217\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/498/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/498/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/496", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/496/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/496/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/496/events", "html_url": "https://github.com/psf/requests/issues/496", "id": 3703636, "node_id": "MDU6SXNzdWUzNzAzNjM2", "number": 496, "title": "Response.ok raises Timeout Exception in safe_mode", "user": {"login": "spulec", "id": 292606, "node_id": "MDQ6VXNlcjI5MjYwNg==", "avatar_url": "https://avatars.githubusercontent.com/u/292606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spulec", "html_url": "https://github.com/spulec", "followers_url": "https://api.github.com/users/spulec/followers", "following_url": "https://api.github.com/users/spulec/following{/other_user}", "gists_url": "https://api.github.com/users/spulec/gists{/gist_id}", "starred_url": "https://api.github.com/users/spulec/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spulec/subscriptions", "organizations_url": "https://api.github.com/users/spulec/orgs", "repos_url": "https://api.github.com/users/spulec/repos", "events_url": "https://api.github.com/users/spulec/events{/privacy}", "received_events_url": "https://api.github.com/users/spulec/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2012-03-19T00:21:18Z", "updated_at": "2021-09-09T09:00:38Z", "closed_at": "2012-04-06T01:45:25Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "``` python\n>>> import requests\n>>> requests.__version__\n'0.10.8'\n>>> res = requests.get(\"http://localhost:8000/\", timeout=1, config={'safe_mode': True})\n>>> res.ok\nTraceback (most recent call last):\n  File \"<console>\", line 1, in <module>\n  File \"../requests/models.py\", line 650, in ok\n    self.raise_for_status()\n  File \"../requests/models.py\", line 800, in raise_for_status\n    raise self.error\nTimeout: Request timed out.\n>>> \n```\n\nThis certainly feels unintuitive as a user. It should probably always return a boolean.\n\nA simple solution is to have raise_for_status catch RequestException instead of just HTTPError, but I'm not sure if that would have other implications.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/496/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/496/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/458", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/458/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/458/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/458/events", "html_url": "https://github.com/psf/requests/issues/458", "id": 3394145, "node_id": "MDU6SXNzdWUzMzk0MTQ1", "number": 458, "title": "requests should send \"Connection: close\" if keep-alive is disabled", "user": {"login": "craigholm", "id": 1476786, "node_id": "MDQ6VXNlcjE0NzY3ODY=", "avatar_url": "https://avatars.githubusercontent.com/u/1476786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/craigholm", "html_url": "https://github.com/craigholm", "followers_url": "https://api.github.com/users/craigholm/followers", "following_url": "https://api.github.com/users/craigholm/following{/other_user}", "gists_url": "https://api.github.com/users/craigholm/gists{/gist_id}", "starred_url": "https://api.github.com/users/craigholm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/craigholm/subscriptions", "organizations_url": "https://api.github.com/users/craigholm/orgs", "repos_url": "https://api.github.com/users/craigholm/repos", "events_url": "https://api.github.com/users/craigholm/events{/privacy}", "received_events_url": "https://api.github.com/users/craigholm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2012-02-26T23:17:29Z", "updated_at": "2021-09-09T00:34:26Z", "closed_at": "2012-06-15T18:41:19Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "From Section 14.10 of RFC2616:\n\n'HTTP/1.1 applications that do not support persistent connections MUST include the \"close\" connection option in every message.'\n\nIf keep-alive is disabled, a session object creates a new connection for each request, but each previous connection isn't closed until the connection times out or the garbage collector takes care of it.  This wastes resources on both sides of the connection.\n\n(As an aside, I've noticed that http://httpbin.org/headers returns \"Connection: keep-alive\" in the headers object even if the client sent \"Connection: close\").\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/458/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/458/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/424", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/424/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/424/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/424/events", "html_url": "https://github.com/psf/requests/issues/424", "id": 3209519, "node_id": "MDU6SXNzdWUzMjA5NTE5", "number": 424, "title": "Unicode header dict values cause unhandled exception", "user": {"login": "foxx", "id": 651797, "node_id": "MDQ6VXNlcjY1MTc5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/651797?v=4", "gravatar_id": "", "url": "https://api.github.com/users/foxx", "html_url": "https://github.com/foxx", "followers_url": "https://api.github.com/users/foxx/followers", "following_url": "https://api.github.com/users/foxx/following{/other_user}", "gists_url": "https://api.github.com/users/foxx/gists{/gist_id}", "starred_url": "https://api.github.com/users/foxx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/foxx/subscriptions", "organizations_url": "https://api.github.com/users/foxx/orgs", "repos_url": "https://api.github.com/users/foxx/repos", "events_url": "https://api.github.com/users/foxx/events{/privacy}", "received_events_url": "https://api.github.com/users/foxx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2012-02-13T21:27:39Z", "updated_at": "2021-09-09T00:01:00Z", "closed_at": "2012-07-27T06:00:53Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Hey,\n\nThe following problem happens when you use a unicode string for a header dict:\n\n```\n_headers = {\n    'test' : u'hello world'\n}\n\nrequests.get('http://example.com', headers = _headers)\n\n  File \"/home/foxx/dev/iz/webapp/../webapp/libs/_requests/utils.py\", line 152, in header_expand\n    for i, (value, params) in enumerate(headers):\nValueError: need more than 1 value to unpack\n```\n\nThis is due to the following code:\n\n```\n\ndef header_expand(headers):\n    \"\"\"Returns an HTTP Header value string from a dictionary.\n\n    Example expansion::\n\n        {'text/x-dvi': {'q': '.8', 'mxb': '100000', 'mxt': '5.0'}, 'text/x-c': {}}\n        # Accept: text/x-dvi; q=.8; mxb=100000; mxt=5.0, text/x-c\n\n        (('text/x-dvi', {'q': '.8', 'mxb': '100000', 'mxt': '5.0'}), ('text/x-c', {}))\n        # Accept: text/x-dvi; q=.8; mxb=100000; mxt=5.0, text/x-c\n    \"\"\"\n\n    collector = []\n\n    if isinstance(headers, dict):\n        headers = list(headers.items())\n\n    elif isinstance(headers, str):\n        return headers\n```\n\nWe have hotfix'd this by doing:\n\n```\n    elif isinstance(headers, str) or isinstance(headers, unicode):\n        return headers\n```\n\nHope this helps!\n\nCal\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/424/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/424/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/353", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/353/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/353/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/353/events", "html_url": "https://github.com/psf/requests/issues/353", "id": 2803099, "node_id": "MDU6SXNzdWUyODAzMDk5", "number": 353, "title": "'allow_redirects' cause a post request to hang", "user": {"login": "ksamuel", "id": 221886, "node_id": "MDQ6VXNlcjIyMTg4Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/221886?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ksamuel", "html_url": "https://github.com/ksamuel", "followers_url": "https://api.github.com/users/ksamuel/followers", "following_url": "https://api.github.com/users/ksamuel/following{/other_user}", "gists_url": "https://api.github.com/users/ksamuel/gists{/gist_id}", "starred_url": "https://api.github.com/users/ksamuel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ksamuel/subscriptions", "organizations_url": "https://api.github.com/users/ksamuel/orgs", "repos_url": "https://api.github.com/users/ksamuel/repos", "events_url": "https://api.github.com/users/ksamuel/events{/privacy}", "received_events_url": "https://api.github.com/users/ksamuel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2012-01-11T11:06:54Z", "updated_at": "2021-09-09T07:05:23Z", "closed_at": "2012-07-27T06:05:18Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "I tried the following code:\n\n```\nresponse = requests.post(url, data=request.message,\n                             headers=request.headers,\n                             allow_redirects=True)\n```\n\nBut it hangs forever (no error) while this works (I get redirected and got the finale response):\n\n```\nwhile status_code.startswith('3'):\n\n    response = requests.post(url, data=request.message,\n                             headers=request.headers)\n    status_code = str(response.status_code)\n    url = response.headers.get('location', '')\n```\n\nMore informations:\n- Initial Url is http, and it's redirected to https. The adresse remains the same.\n- The first request returns nothing but the redirection returns XLM.\n- This is tested in ipython only for now.\n\nI digged into the code, and it hangs here, in models.py:\n\n```\n# The inner try .. except re-raises certain exceptions as\n# internal exception types; the outer suppresses exceptions\n# when safe mode is set.\ntry:\n    # Send the request.\n    r = conn.urlopen(\n        method=self.method,\n        url=self.path_url,\n        body=body,\n        headers=self.headers,\n        redirect=False,\n        assert_same_host=False,\n        preload_content=False,\n        decode_content=True,\n        retries=self.config.get('max_retries', 0),\n        timeout=self.timeout,\n    )\n```\n\nSome more info:\n\n```\n# arguments\nipdb> dict( method=self.method, url=self.path_url, body=body, headers=self.headers, redirect=False, assert_same_host=False, preload_content=False, decode_content=True, retries=self.config.get('max_retries', 0), timeout=self.timeout)\n{'redirect': False,\n 'retries': 0,\n 'url': '/dir/doc.asmx', 'body': \nNone, \n'headers': {'Content-Length': '26337', \n                'Accept-Encoding': 'identity, deflate, compress, gzip', \n                'SOAPAction': u'\"http://tempuri.org/Method\"',\n                'Content-Type': 'text/xml; charset=utf-8',\n                 'Accept': '*/*',\n                 'User-Agent': 'python-requests/0.9.1'},\n'timeout': None, \n'preload_content': False,\n 'assert_same_host': False,\n 'method': 'POST',\n 'decode_content': True}\n\n# local variables\nipdb> locals()\n{'body': None, 'url': 'https://subdomain.domain.org/dir/doc.asmx',\n 'ipdb': <module 'ipdb' from '/home/me/.virtualenvs/project/local/lib/python2.7/site-packages/ipdb/__init__.pyc'>,\n 'self': <Request [POST]>, \n'anyway': False,\n '_p': ParseResult(scheme='https', \n                           netloc='subdomain.domain.org', path='/dir/doc.asmx', \n                           params='', \n                           query='', \n                           fragment=''),\n'cert_loc': '/home/me/.virtualenvs/project/local/lib/python2.7/site-packages/certifi/cacert.pem',\n 'proxy': None, \n'content_type': None, \n'conn': <requests.packages.urllib3.connectionpool.HTTPSConnectionPool object at 0x2bf9650>, \n'prefetch': False}\n\n\n# platform\nipdb> sys.version\n'2.7.2+ (default, Oct  4 2011, 20:06:09) \\n[GCC 4.6.1]'\n\nipdb> requests.__version__\n'0.9.1'\n```\n\nI'm on Ubuntu 11.10 64 bits.)\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/353/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/353/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/339", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/339/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/339/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/339/events", "html_url": "https://github.com/psf/requests/issues/339", "id": 2744384, "node_id": "MDU6SXNzdWUyNzQ0Mzg0", "number": 339, "title": "ConnectionError in requests, not urllib2", "user": {"login": "samuelclay", "id": 44229, "node_id": "MDQ6VXNlcjQ0MjI5", "avatar_url": "https://avatars.githubusercontent.com/u/44229?v=4", "gravatar_id": "", "url": "https://api.github.com/users/samuelclay", "html_url": "https://github.com/samuelclay", "followers_url": "https://api.github.com/users/samuelclay/followers", "following_url": "https://api.github.com/users/samuelclay/following{/other_user}", "gists_url": "https://api.github.com/users/samuelclay/gists{/gist_id}", "starred_url": "https://api.github.com/users/samuelclay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/samuelclay/subscriptions", "organizations_url": "https://api.github.com/users/samuelclay/orgs", "repos_url": "https://api.github.com/users/samuelclay/repos", "events_url": "https://api.github.com/users/samuelclay/events{/privacy}", "received_events_url": "https://api.github.com/users/samuelclay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2012-01-06T05:18:41Z", "updated_at": "2021-09-09T09:00:37Z", "closed_at": "2012-04-12T22:53:39Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "```\n>>> url = 'http://www.rpgwatch.com?rwsiteid=1'\n>>> len(urllib2.urlopen(url).read())\n112749\n>>> len(requests.get(url).content)\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"build/bdist.macosx-10.7-intel/egg/requests/api.py\", line 50, in get\n  File \"build/bdist.macosx-10.7-intel/egg/requests/api.py\", line 38, in request\n  File \"build/bdist.macosx-10.7-intel/egg/requests/sessions.py\", line 200, in request\n  File \"build/bdist.macosx-10.7-intel/egg/requests/models.py\", line 498, in send\nrequests.exceptions.ConnectionError: Max retries exceeded for url: /?rwsiteid=1\n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/339/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/339/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/338", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/338/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/338/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/338/events", "html_url": "https://github.com/psf/requests/issues/338", "id": 2744340, "node_id": "MDU6SXNzdWUyNzQ0MzQw", "number": 338, "title": "LookupError in requests, not in urllib2", "user": {"login": "samuelclay", "id": 44229, "node_id": "MDQ6VXNlcjQ0MjI5", "avatar_url": "https://avatars.githubusercontent.com/u/44229?v=4", "gravatar_id": "", "url": "https://api.github.com/users/samuelclay", "html_url": "https://github.com/samuelclay", "followers_url": "https://api.github.com/users/samuelclay/followers", "following_url": "https://api.github.com/users/samuelclay/following{/other_user}", "gists_url": "https://api.github.com/users/samuelclay/gists{/gist_id}", "starred_url": "https://api.github.com/users/samuelclay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/samuelclay/subscriptions", "organizations_url": "https://api.github.com/users/samuelclay/orgs", "repos_url": "https://api.github.com/users/samuelclay/repos", "events_url": "https://api.github.com/users/samuelclay/events{/privacy}", "received_events_url": "https://api.github.com/users/samuelclay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2012-01-06T05:07:45Z", "updated_at": "2021-09-09T09:00:43Z", "closed_at": "2012-03-16T01:15:28Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "```\n>>> url = 'http://dilbert.com'\n>>> len(urllib2.urlopen(url).read())\n30194\n>>> len(requests.get(url).content)\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"build/bdist.macosx-10.7-intel/egg/requests/models.py\", line 713, in content\nLookupError: unknown encoding: utf-8lias\n>>> \n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/338/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/338/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/337", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/337/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/337/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/337/events", "html_url": "https://github.com/psf/requests/issues/337", "id": 2744334, "node_id": "MDU6SXNzdWUyNzQ0MzM0", "number": 337, "title": "TooManyRedirects in requests, not in urllib2", "user": {"login": "samuelclay", "id": 44229, "node_id": "MDQ6VXNlcjQ0MjI5", "avatar_url": "https://avatars.githubusercontent.com/u/44229?v=4", "gravatar_id": "", "url": "https://api.github.com/users/samuelclay", "html_url": "https://github.com/samuelclay", "followers_url": "https://api.github.com/users/samuelclay/followers", "following_url": "https://api.github.com/users/samuelclay/following{/other_user}", "gists_url": "https://api.github.com/users/samuelclay/gists{/gist_id}", "starred_url": "https://api.github.com/users/samuelclay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/samuelclay/subscriptions", "organizations_url": "https://api.github.com/users/samuelclay/orgs", "repos_url": "https://api.github.com/users/samuelclay/repos", "events_url": "https://api.github.com/users/samuelclay/events{/privacy}", "received_events_url": "https://api.github.com/users/samuelclay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2012-01-06T05:06:43Z", "updated_at": "2021-08-31T00:06:55Z", "closed_at": "2012-08-25T15:09:13Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "```\n>>> url = 'http://fasel.soup.io/'\n>>> len(urllib2.urlopen(url).read())\n73331\n>>> len(requests.get(url).content)\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"build/bdist.macosx-10.7-intel/egg/requests/api.py\", line 50, in get\n  File \"build/bdist.macosx-10.7-intel/egg/requests/api.py\", line 38, in request\n  File \"build/bdist.macosx-10.7-intel/egg/requests/sessions.py\", line 200, in request\n  File \"build/bdist.macosx-10.7-intel/egg/requests/models.py\", line 515, in send\n  File \"build/bdist.macosx-10.7-intel/egg/requests/models.py\", line 209, in _build_response\nrequests.exceptions.TooManyRedirects\n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/337/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/337/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/335", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/335/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/335/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/335/events", "html_url": "https://github.com/psf/requests/issues/335", "id": 2744188, "node_id": "MDU6SXNzdWUyNzQ0MTg4", "number": 335, "title": "CookieError in requests and not in urllib2", "user": {"login": "samuelclay", "id": 44229, "node_id": "MDQ6VXNlcjQ0MjI5", "avatar_url": "https://avatars.githubusercontent.com/u/44229?v=4", "gravatar_id": "", "url": "https://api.github.com/users/samuelclay", "html_url": "https://github.com/samuelclay", "followers_url": "https://api.github.com/users/samuelclay/followers", "following_url": "https://api.github.com/users/samuelclay/following{/other_user}", "gists_url": "https://api.github.com/users/samuelclay/gists{/gist_id}", "starred_url": "https://api.github.com/users/samuelclay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/samuelclay/subscriptions", "organizations_url": "https://api.github.com/users/samuelclay/orgs", "repos_url": "https://api.github.com/users/samuelclay/repos", "events_url": "https://api.github.com/users/samuelclay/events{/privacy}", "received_events_url": "https://api.github.com/users/samuelclay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 29, "created_at": "2012-01-06T04:30:34Z", "updated_at": "2021-09-09T09:00:44Z", "closed_at": "2012-03-09T16:58:39Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "In `0.9.0`:\n\n```\n>>> import requests\n>>> import urllib2\n>>> url = 'http://www.miniclip.com/games/en/'\n>>> len(urllib2.urlopen(url).read())\n111106\n>>> requests.get(url)\nlen(urllTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"build/bdist.macosx-10.7-intel/egg/requests/api.py\", line 50, in get\n  File \"build/bdist.macosx-10.7-intel/egg/requests/api.py\", line 38, in request\n  File \"build/bdist.macosx-10.7-intel/egg/requests/sessions.py\", line 200, in request\n  File \"build/bdist.macosx-10.7-intel/egg/requests/models.py\", line 515, in send\n  File \"build/bdist.macosx-10.7-intel/egg/requests/models.py\", line 197, in _build_response\n  File \"build/bdist.macosx-10.7-intel/egg/requests/models.py\", line 177, in build\n  File \"build/bdist.macosx-10.7-intel/egg/requests/packages/oreos/core.py\", line 19, in dict_from_string\n  File \"build/bdist.macosx-10.7-intel/egg/requests/packages/oreos/monkeys.py\", line 641, in load\n  File \"build/bdist.macosx-10.7-intel/egg/requests/packages/oreos/monkeys.py\", line 674, in __ParseString\n  File \"build/bdist.macosx-10.7-intel/egg/requests/packages/oreos/monkeys.py\", line 594, in __set\n  File \"build/bdist.macosx-10.7-intel/egg/requests/packages/oreos/monkeys.py\", line 468, in set\nrequests.packages.oreos.monkeys.CookieError: Illegal key value: ad_is_enabled-position2:homepage\n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/335/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/335/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/296", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/296/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/296/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/296/events", "html_url": "https://github.com/psf/requests/issues/296", "id": 2384830, "node_id": "MDU6SXNzdWUyMzg0ODMw", "number": 296, "title": "ConnectionError with Python 2.5 and SSL site", "user": {"login": "davidwtbuxton", "id": 334087, "node_id": "MDQ6VXNlcjMzNDA4Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/334087?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidwtbuxton", "html_url": "https://github.com/davidwtbuxton", "followers_url": "https://api.github.com/users/davidwtbuxton/followers", "following_url": "https://api.github.com/users/davidwtbuxton/following{/other_user}", "gists_url": "https://api.github.com/users/davidwtbuxton/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidwtbuxton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidwtbuxton/subscriptions", "organizations_url": "https://api.github.com/users/davidwtbuxton/orgs", "repos_url": "https://api.github.com/users/davidwtbuxton/repos", "events_url": "https://api.github.com/users/davidwtbuxton/events{/privacy}", "received_events_url": "https://api.github.com/users/davidwtbuxton/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2011-11-29T14:20:07Z", "updated_at": "2021-09-09T10:00:42Z", "closed_at": "2012-01-23T08:06:13Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "I am using requests 0.8.5 to GET the front page of an SSL site. This works fine with Python 2.7.2, Python 2.6.7, but throws ConnectionError with Python 2.5.6. Other SSL sites work as expected with Python 2.5.6.\n\nQuick tests from the command-line:\n\n```\nveronica:test david$ python2.7 -c \"import requests; print requests.get('https://viewpoint.toyota-europe.com/');\"\n<Response [200]>\nveronica:test david$ python2.6 -c \"import requests; print requests.get('https://viewpoint.toyota-europe.com/');\"\n<Response [200]>\nveronica:test david$ python2.5 -c \"import requests; print requests.get('https://viewpoint.toyota-europe.com/');\"\nTraceback (most recent call last):\n  File \"<string>\", line 1, in <module>\n  File \"requests/api.py\", line 80, in get\n    return request('get', url, **kwargs)\n  File \"requests/api.py\", line 67, in request\n    prefetch=prefetch\n  File \"requests/sessions.py\", line 191, in request\n    r.send(prefetch=prefetch)\n  File \"requests/models.py\", line 453, in send\n    raise ConnectionError(e)\nrequests.exceptions.ConnectionError: Max retries exceeded for url: /\nveronica:test david$ \n```\n\nBut this works in Python 2.5:\n\n```\nveronica:test david$ python2.5 -c \"import requests; print requests.get('https://github.com/');\"\n<Response [200]>\n```\n\nThe problem web server is running IIS7. I will try and get more details soon. Platform is Mac OS X 10.7.2, all Python versions built from MacPorts.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/296/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/296/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/293", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/293/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/293/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/293/events", "html_url": "https://github.com/psf/requests/issues/293", "id": 2370543, "node_id": "MDU6SXNzdWUyMzcwNTQz", "number": 293, "title": "Proxy authentication broken with 0.76 -> 0.83 upgrade.", "user": {"login": "steinster", "id": 795033, "node_id": "MDQ6VXNlcjc5NTAzMw==", "avatar_url": "https://avatars.githubusercontent.com/u/795033?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steinster", "html_url": "https://github.com/steinster", "followers_url": "https://api.github.com/users/steinster/followers", "following_url": "https://api.github.com/users/steinster/following{/other_user}", "gists_url": "https://api.github.com/users/steinster/gists{/gist_id}", "starred_url": "https://api.github.com/users/steinster/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steinster/subscriptions", "organizations_url": "https://api.github.com/users/steinster/orgs", "repos_url": "https://api.github.com/users/steinster/repos", "events_url": "https://api.github.com/users/steinster/events{/privacy}", "received_events_url": "https://api.github.com/users/steinster/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2011-11-28T17:25:20Z", "updated_at": "2021-09-09T09:00:40Z", "closed_at": "2012-03-31T07:16:31Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Proxy authentication was possible in 0.76 using a string like \"user:password@ip:port\".  In 0.83 I am getting the following error:\n\nTraceback (most recent call last):\n  File \"req.py\", line 10, in <module>\n    print get('http://ipcheckit.com', proxies=p).content\n  File \"build\\bdist.win32\\egg\\requests\\api.py\", line 80, in get\n  File \"build\\bdist.win32\\egg\\requests\\api.py\", line 67, in request\n  File \"build\\bdist.win32\\egg\\requests\\sessions.py\", line 191, in request\n  File \"build\\bdist.win32\\egg\\requests\\models.py\", line 409, in send\n  File \"build\\bdist.win32\\egg\\requests\\packages\\urllib3\\poolmanager.py\", line 127, in proxy_from_url\n  File \"build\\bdist.win32\\egg\\requests\\packages\\urllib3\\connectionpool.py\", line 521, in connection_from_url\n  File \"build\\bdist.win32\\egg\\requests\\packages\\urllib3\\connectionpool.py\", line 497, in get_host\nValueError: invalid literal for int() with base 10: '(censored)@184.154.139.226:60099'\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/293/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/293/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/291", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/291/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/291/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/291/events", "html_url": "https://github.com/psf/requests/issues/291", "id": 2360630, "node_id": "MDU6SXNzdWUyMzYwNjMw", "number": 291, "title": "models.Request.sent never set to `True`?", "user": {"login": "mrtazz", "id": 68183, "node_id": "MDQ6VXNlcjY4MTgz", "avatar_url": "https://avatars.githubusercontent.com/u/68183?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrtazz", "html_url": "https://github.com/mrtazz", "followers_url": "https://api.github.com/users/mrtazz/followers", "following_url": "https://api.github.com/users/mrtazz/following{/other_user}", "gists_url": "https://api.github.com/users/mrtazz/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrtazz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrtazz/subscriptions", "organizations_url": "https://api.github.com/users/mrtazz/orgs", "repos_url": "https://api.github.com/users/mrtazz/repos", "events_url": "https://api.github.com/users/mrtazz/events{/privacy}", "received_events_url": "https://api.github.com/users/mrtazz/received_events", "type": "User", "site_admin": true}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": {"login": "kennethreitz", "id": 119893, "node_id": "MDQ6VXNlcjExOTg5Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/119893?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennethreitz", "html_url": "https://github.com/kennethreitz", "followers_url": "https://api.github.com/users/kennethreitz/followers", "following_url": "https://api.github.com/users/kennethreitz/following{/other_user}", "gists_url": "https://api.github.com/users/kennethreitz/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennethreitz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennethreitz/subscriptions", "organizations_url": "https://api.github.com/users/kennethreitz/orgs", "repos_url": "https://api.github.com/users/kennethreitz/repos", "events_url": "https://api.github.com/users/kennethreitz/events{/privacy}", "received_events_url": "https://api.github.com/users/kennethreitz/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "kennethreitz", "id": 119893, "node_id": "MDQ6VXNlcjExOTg5Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/119893?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennethreitz", "html_url": "https://github.com/kennethreitz", "followers_url": "https://api.github.com/users/kennethreitz/followers", "following_url": "https://api.github.com/users/kennethreitz/following{/other_user}", "gists_url": "https://api.github.com/users/kennethreitz/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennethreitz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennethreitz/subscriptions", "organizations_url": "https://api.github.com/users/kennethreitz/orgs", "repos_url": "https://api.github.com/users/kennethreitz/repos", "events_url": "https://api.github.com/users/kennethreitz/events{/privacy}", "received_events_url": "https://api.github.com/users/kennethreitz/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/psf/requests/milestones/11", "html_url": "https://github.com/psf/requests/milestone/11", "labels_url": "https://api.github.com/repos/psf/requests/milestones/11/labels", "id": 30486, "node_id": "MDk6TWlsZXN0b25lMzA0ODY=", "number": 11, "title": "v0.9.0", "description": "", "creator": {"login": "kennethreitz", "id": 119893, "node_id": "MDQ6VXNlcjExOTg5Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/119893?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennethreitz", "html_url": "https://github.com/kennethreitz", "followers_url": "https://api.github.com/users/kennethreitz/followers", "following_url": "https://api.github.com/users/kennethreitz/following{/other_user}", "gists_url": "https://api.github.com/users/kennethreitz/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennethreitz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennethreitz/subscriptions", "organizations_url": "https://api.github.com/users/kennethreitz/orgs", "repos_url": "https://api.github.com/users/kennethreitz/repos", "events_url": "https://api.github.com/users/kennethreitz/events{/privacy}", "received_events_url": "https://api.github.com/users/kennethreitz/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 4, "state": "closed", "created_at": "2011-08-23T15:07:10Z", "updated_at": "2011-12-28T10:04:17Z", "due_on": null, "closed_at": "2011-12-17T21:10:23Z"}, "comments": 1, "created_at": "2011-11-27T16:16:40Z", "updated_at": "2021-09-09T10:00:50Z", "closed_at": "2011-11-27T16:29:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "While dissecting the `models.Request.send()` method for unit testing I tried to find the path where `return self.sent` actually returns `True`. I `ack`-ed through the code but failed to find a path. Did I miss something or is it really never set?\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/291/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/291/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/286", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/286/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/286/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/286/events", "html_url": "https://github.com/psf/requests/issues/286", "id": 2332498, "node_id": "MDU6SXNzdWUyMzMyNDk4", "number": 286, "title": "Session Cookie doublequotes bug", "user": {"login": "benmao", "id": 173095, "node_id": "MDQ6VXNlcjE3MzA5NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/173095?v=4", "gravatar_id": "", "url": "https://api.github.com/users/benmao", "html_url": "https://github.com/benmao", "followers_url": "https://api.github.com/users/benmao/followers", "following_url": "https://api.github.com/users/benmao/following{/other_user}", "gists_url": "https://api.github.com/users/benmao/gists{/gist_id}", "starred_url": "https://api.github.com/users/benmao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/benmao/subscriptions", "organizations_url": "https://api.github.com/users/benmao/orgs", "repos_url": "https://api.github.com/users/benmao/repos", "events_url": "https://api.github.com/users/benmao/events{/privacy}", "received_events_url": "https://api.github.com/users/benmao/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2011-11-23T17:47:01Z", "updated_at": "2021-09-09T10:00:40Z", "closed_at": "2012-01-30T06:15:36Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "test code:\n\n``` Python\nfrom requests import session\n\nwith session() as c:\n    c.get('http://www.baidu.com')\n    #should have cookie headers\n    c.get('http://www.baidu.com')\n```\n\nServer:\n\n``` Python\nSet-Cookie: BAIDUID=DC1510722CF5A19A2A4C4E4DB720C5D4:FG=1; expires=Wed, 23-Nov-41 17:44:00 GMT; path=/; domain=.baidu.com\n```\n\nClient:\n\n``` Python\nCookie: BAIDUID=\"DC1510722CF5A19A2A4C4E4DB720C5D4:FG=1\"\n```\n\nThe correct result should be:\n\n``` Python\nCookie: BAIDUID=DC1510722CF5A19A2A4C4E4DB720C5D4:FG=1\n```\n\nquote function \n\n``` Python\ndef _quote(str, LegalChars=_LegalChars,\n           idmap=_idmap, translate=string.translate):\n    #\n    # If the string does not need to be double-quoted,\n    # then just return the string.  Otherwise, surround\n    # the string in doublequotes and precede quote (with a \\)\n    # special characters.\n    #\n    if \"\" == translate(str, idmap, LegalChars):\n        return str\n    else:\n        return '\"' + _nulljoin( map(_Translator.get, str, str) ) + '\"'\n# end _quote\n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/286/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/286/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/239", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/239/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/239/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/239/events", "html_url": "https://github.com/psf/requests/issues/239", "id": 2151723, "node_id": "MDU6SXNzdWUyMTUxNzIz", "number": 239, "title": "Too many open files", "user": {"login": "daleharvey", "id": 37787, "node_id": "MDQ6VXNlcjM3Nzg3", "avatar_url": "https://avatars.githubusercontent.com/u/37787?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daleharvey", "html_url": "https://github.com/daleharvey", "followers_url": "https://api.github.com/users/daleharvey/followers", "following_url": "https://api.github.com/users/daleharvey/following{/other_user}", "gists_url": "https://api.github.com/users/daleharvey/gists{/gist_id}", "starred_url": "https://api.github.com/users/daleharvey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daleharvey/subscriptions", "organizations_url": "https://api.github.com/users/daleharvey/orgs", "repos_url": "https://api.github.com/users/daleharvey/repos", "events_url": "https://api.github.com/users/daleharvey/events{/privacy}", "received_events_url": "https://api.github.com/users/daleharvey/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 191274, "node_id": "MDU6TGFiZWwxOTEyNzQ=", "url": "https://api.github.com/repos/psf/requests/labels/Contributor%20Friendly", "name": "Contributor Friendly", "color": "0b02e1", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 81, "created_at": "2011-11-05T12:37:30Z", "updated_at": "2021-09-08T01:21:03Z", "closed_at": "2012-07-27T06:07:41Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "I am building a basic load generator and started running into file descriptor limits, I havent seen any documentation pertaining to how to release resources, so either I am doing it wrong and the docs need updated, or requests is leaking file descriptors somewhere (without support for keepalive I am slightly confused at why any files would be left open at all)\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/239/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/239/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/223", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/223/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/223/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/223/events", "html_url": "https://github.com/psf/requests/issues/223", "id": 2035471, "node_id": "MDU6SXNzdWUyMDM1NDcx", "number": 223, "title": "Content-Length is missing", "user": {"login": "foxx", "id": 651797, "node_id": "MDQ6VXNlcjY1MTc5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/651797?v=4", "gravatar_id": "", "url": "https://api.github.com/users/foxx", "html_url": "https://github.com/foxx", "followers_url": "https://api.github.com/users/foxx/followers", "following_url": "https://api.github.com/users/foxx/following{/other_user}", "gists_url": "https://api.github.com/users/foxx/gists{/gist_id}", "starred_url": "https://api.github.com/users/foxx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/foxx/subscriptions", "organizations_url": "https://api.github.com/users/foxx/orgs", "repos_url": "https://api.github.com/users/foxx/repos", "events_url": "https://api.github.com/users/foxx/events{/privacy}", "received_events_url": "https://api.github.com/users/foxx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 63, "created_at": "2011-10-24T16:21:43Z", "updated_at": "2021-09-08T23:10:51Z", "closed_at": "2012-11-25T03:54:30Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "Please see the following example\n\n```\n\n_data = \"\"\"callCount=1 \npage=/internetsales/iSnapVehicle.xhtml?_gk=_c083894BB-4392-5290-8580-DE159D03B2B0_k9C5EF4F0-0269-3CC9-0994-633224433265\n\nhttpSessionId=\nscriptSessionId=DD51AC690A8BC3BEDB1AEDF1B2A7A9DD575\nc0-scriptName=PresentationRulesFacade\nc0-methodName=execute\nc0-id=0\nc0-param0=string:VehicleForm c0-param1=string:VehicleForm%3Amake\nc0-param2=string:%7B%22VehicleForm%3AdaysDriven%22%20%3A%20%221%22%2C%20%22VehicleForm%3AmilesDriven%22%20%3A%20%220%22%2C%20%22VehicleForm%3Ayear%22%20%3A%20%221998%22%2C%20%22VehicleForm%3AestimatedMileage%22%20%3A%20%22%22%2C%20%22VehicleForm%3AodometerReading%22%20%3A%20%22%22%2C%20%22VehicleForm%3Amake%22%20%3A%20%22AUDI%22%2C%20%22VehicleForm%3Ayear-txt%22%20%3A%20%22%22%2C%20%22VehicleForm%3Amake-txt%22%20%3A%20%22%22%2C%20%22VehicleForm%3Amodel-txt%22%20%3A%20%22%22%2C%20%22VehicleForm%3AmodelDesc%22%20%3A%20%22Other%22%2C%20%22VehicleForm%3Amodel%22%20%3A%20%22Other%22%2C%20%22VehicleForm%3Abodystyle%22%20%3A%20%22VAN%22%7D\nc0-param3=boolean:false\nbatchId=327\n\"\"\"\n\nprint len(_data)\n_headers = {\n    'referer' : 'https://sales2.geico.com/internetsales/iSnapVehicle.xhtml?_gk=_c083894BB-4392-5290-8580-DE159D03B2B0_k9C5EF4F0-0269-3CC9-0994-633224433265'\n}\nr = requests.post(\n    url = 'https://sales2.geico.com/internetsales/dwr/call/plaincall/PresentationRulesFacade.execute.dwr',\n    data = _data,\n    headers = _headers\n)\n\nprint r.request.headers\n{'referer': 'https://sales2.geico.com/internetsales/iSnapVehicle.xhtml?_gk=_c083894BB-4392-5290-8580-DE159D03B2B0_k9C5EF4F0-0269-3CC9-0994-633224433265', 'Accept-Encoding': 'identity, deflate, compress, gzip', 'User-Agent': 'python-requests/0.7.3'}\n```\n\nIn this example, the 'Content-Length' is missing.\n\nHaven't got any spare time to try and patch the bug - as this was only a quick test to explore new libs.\n\nCal\n\n[revised post 3 - multiple edits due to mistake on bug report]\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/223/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/223/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/78", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/78/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/78/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/78/events", "html_url": "https://github.com/psf/requests/issues/78", "id": 1109282, "node_id": "MDU6SXNzdWUxMTA5Mjgy", "number": 78, "title": "Request_gzip = True", "user": {"login": "jerem", "id": 36156, "node_id": "MDQ6VXNlcjM2MTU2", "avatar_url": "https://avatars.githubusercontent.com/u/36156?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jerem", "html_url": "https://github.com/jerem", "followers_url": "https://api.github.com/users/jerem/followers", "following_url": "https://api.github.com/users/jerem/following{/other_user}", "gists_url": "https://api.github.com/users/jerem/gists{/gist_id}", "starred_url": "https://api.github.com/users/jerem/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jerem/subscriptions", "organizations_url": "https://api.github.com/users/jerem/orgs", "repos_url": "https://api.github.com/users/jerem/repos", "events_url": "https://api.github.com/users/jerem/events{/privacy}", "received_events_url": "https://api.github.com/users/jerem/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 76800, "node_id": "MDU6TGFiZWw3NjgwMA==", "url": "https://api.github.com/repos/psf/requests/labels/Feature%20Request", "name": "Feature Request", "color": "02e10c", "default": false, "description": null}, {"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}, {"id": 117745, "node_id": "MDU6TGFiZWwxMTc3NDU=", "url": "https://api.github.com/repos/psf/requests/labels/Planned", "name": "Planned", "color": "e102d8", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2011-06-24T10:28:49Z", "updated_at": "2021-09-09T12:00:47Z", "closed_at": "2011-07-24T02:35:50Z", "author_association": "CONTRIBUTOR", "active_lock_reason": "resolved", "body": "In order to receive gzipped content, requests should send the header:\n\n```\n'Accept-Encoding': 'gzip'\n```\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/78/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/78/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/psf/requests/issues/59", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/59/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/59/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/59/events", "html_url": "https://github.com/psf/requests/pull/59", "id": 1034347, "node_id": "MDExOlB1bGxSZXF1ZXN0MTc3OTgy", "number": 59, "title": "Header capitalization", "user": {"login": "steder", "id": 5412, "node_id": "MDQ6VXNlcjU0MTI=", "avatar_url": "https://avatars.githubusercontent.com/u/5412?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steder", "html_url": "https://github.com/steder", "followers_url": "https://api.github.com/users/steder/followers", "following_url": "https://api.github.com/users/steder/following{/other_user}", "gists_url": "https://api.github.com/users/steder/gists{/gist_id}", "starred_url": "https://api.github.com/users/steder/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steder/subscriptions", "organizations_url": "https://api.github.com/users/steder/orgs", "repos_url": "https://api.github.com/users/steder/repos", "events_url": "https://api.github.com/users/steder/events{/privacy}", "received_events_url": "https://api.github.com/users/steder/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2011-06-10T03:56:02Z", "updated_at": "2021-09-08T11:01:04Z", "closed_at": "2011-07-24T01:45:01Z", "author_association": "NONE", "active_lock_reason": "resolved", "draft": false, "pull_request": {"url": "https://api.github.com/repos/psf/requests/pulls/59", "html_url": "https://github.com/psf/requests/pull/59", "diff_url": "https://github.com/psf/requests/pull/59.diff", "patch_url": "https://github.com/psf/requests/pull/59.patch", "merged_at": null}, "body": " Fixed bug where not capitalizing a header properly caused that header to not be set.\n\nI noticed when doing a post to a service that expected a json request body that my typo \"content-type\" rather than \"Content-type\" in my headers dictionary caused the Content-type to default to \"application/x-www-urlencoded\" rather than \"application/json\".  \n\nI added a pair of tests that illustrate the problem with posts to postbin.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/59/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/59/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/psf/requests/issues/56", "repository_url": "https://api.github.com/repos/psf/requests", "labels_url": "https://api.github.com/repos/psf/requests/issues/56/labels{/name}", "comments_url": "https://api.github.com/repos/psf/requests/issues/56/comments", "events_url": "https://api.github.com/repos/psf/requests/issues/56/events", "html_url": "https://github.com/psf/requests/issues/56", "id": 1002948, "node_id": "MDU6SXNzdWUxMDAyOTQ4", "number": 56, "title": "Auth fail for private github repo", "user": {"login": "mw44118", "id": 19956, "node_id": "MDQ6VXNlcjE5OTU2", "avatar_url": "https://avatars.githubusercontent.com/u/19956?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mw44118", "html_url": "https://github.com/mw44118", "followers_url": "https://api.github.com/users/mw44118/followers", "following_url": "https://api.github.com/users/mw44118/following{/other_user}", "gists_url": "https://api.github.com/users/mw44118/gists{/gist_id}", "starred_url": "https://api.github.com/users/mw44118/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mw44118/subscriptions", "organizations_url": "https://api.github.com/users/mw44118/orgs", "repos_url": "https://api.github.com/users/mw44118/repos", "events_url": "https://api.github.com/users/mw44118/events{/privacy}", "received_events_url": "https://api.github.com/users/mw44118/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 117744, "node_id": "MDU6TGFiZWwxMTc3NDQ=", "url": "https://api.github.com/repos/psf/requests/labels/Bug", "name": "Bug", "color": "e10c02", "default": false, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2011-06-04T16:23:34Z", "updated_at": "2021-09-09T12:00:46Z", "closed_at": "2011-07-24T02:55:20Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "I've got a private repo here on github.  I want to suck down all the issues.  This works in curl (password removed):\n\n```\n$ curl -u \"mw44118:XXXXXXXX\" https://api.github.com/repos/spothero/SpotHero-Splash-Page/issues\n{ \n... real data here\n}\n```\n\nAnd this is what happens when I don't include the -u authentication stuff:\n\n```\n$ curl https://api.github.com/repos/spothero/SpotHero-Splash-Page/issues\n{ \n  \"message\": \"Not Found\"\n}\n```\n\nThen I tried the same thing with requests (again XXXXXX ain't  really my password):\n\n```\n>>> requests.get('https://api.github.com/repos/spothero/SpotHero-Splash-Page/issues', auth=('mw44118', 'XXXXXXXX'))\n<Response [404]>\n```\n\nI wondered if maybe you don't actually send the auth stuff unless the server replies with a 403, and since github is replying with a 404, the requests code never knows to send the credentials.\n\nI tried reading through the requests code, but didn't see anything that supported that guess.\n", "reactions": {"url": "https://api.github.com/repos/psf/requests/issues/56/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/psf/requests/issues/56/timeline", "performed_via_github_app": null, "state_reason": "completed"}]