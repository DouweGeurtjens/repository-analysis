[{"url": "https://api.github.com/repos/redis/redis-py/issues/2718", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2718/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2718/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2718/events", "html_url": "https://github.com/redis/redis-py/pull/2718", "id": 1678666025, "node_id": "PR_kwDOAAWKjs5O3rRs", "number": 2718, "title": "Fix incorrect usage of once flag in async Sentinel", "user": {"login": "felipou", "id": 462154, "node_id": "MDQ6VXNlcjQ2MjE1NA==", "avatar_url": "https://avatars.githubusercontent.com/u/462154?v=4", "gravatar_id": "", "url": "https://api.github.com/users/felipou", "html_url": "https://github.com/felipou", "followers_url": "https://api.github.com/users/felipou/followers", "following_url": "https://api.github.com/users/felipou/following{/other_user}", "gists_url": "https://api.github.com/users/felipou/gists{/gist_id}", "starred_url": "https://api.github.com/users/felipou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/felipou/subscriptions", "organizations_url": "https://api.github.com/users/felipou/orgs", "repos_url": "https://api.github.com/users/felipou/repos", "events_url": "https://api.github.com/users/felipou/events{/privacy}", "received_events_url": "https://api.github.com/users/felipou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-04-21T15:01:51Z", "updated_at": "2023-04-28T14:09:51Z", "closed_at": "2023-04-27T14:17:17Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2718", "html_url": "https://github.com/redis/redis-py/pull/2718", "diff_url": "https://github.com/redis/redis-py/pull/2718.diff", "patch_url": "https://github.com/redis/redis-py/pull/2718.patch", "merged_at": "2023-04-27T14:17:17Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [x] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [x] Is there an example added to the examples folder (if applicable)?\r\n- [x] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nIn the execute_command of the async Sentinel, the once flag was being\r\nused incorrectly, with its meaning inverted (which could also be checked by comparing\r\nwith the non-async version), so I just inverted the if and else bodies.\r\n\r\nThis isn't being caught by the tests currently because the tests of commands\r\nthat use this flag do not check their results/effects (for example the \"test_ckquorum\"\r\ntest), but the code is covered. I'm not sure what could be done here, as I'm not yet an expert\r\nwith the Sentinel feature, and also I'm not used with the tests in this repo. If this is something that is really\r\nwanted, could you provide some pointers as to how you think we should test this?\r\n\r\nIn the checklist above, I've left the CI tests unmarked because I do not know how to enable them in my fork, I don't have any experience with Github Actions (I tried, but it seems I need to configure a self-hosted runner? Maybe I'm not looking at the right places).", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2718/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2718/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2700", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2700/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2700/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2700/events", "html_url": "https://github.com/redis/redis-py/issues/2700", "id": 1657813572, "node_id": "I_kwDOAAWKjs5i0DpE", "number": 2700, "title": "Redis is not usable with Python 3.11.3, which was recently released", "user": {"login": "mdnorman", "id": 451017, "node_id": "MDQ6VXNlcjQ1MTAxNw==", "avatar_url": "https://avatars.githubusercontent.com/u/451017?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mdnorman", "html_url": "https://github.com/mdnorman", "followers_url": "https://api.github.com/users/mdnorman/followers", "following_url": "https://api.github.com/users/mdnorman/following{/other_user}", "gists_url": "https://api.github.com/users/mdnorman/gists{/gist_id}", "starred_url": "https://api.github.com/users/mdnorman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mdnorman/subscriptions", "organizations_url": "https://api.github.com/users/mdnorman/orgs", "repos_url": "https://api.github.com/users/mdnorman/repos", "events_url": "https://api.github.com/users/mdnorman/events{/privacy}", "received_events_url": "https://api.github.com/users/mdnorman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-04-06T17:40:14Z", "updated_at": "2023-04-13T11:57:30Z", "closed_at": "2023-04-13T11:57:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "Thanks for wanting to report an issue you've found in redis-py. Please delete this text and fill in the template below.  \r\nIt is of course not always possible to reduce your code to a small test case, but it's highly appreciated to have as much data as possible. Thank you!\r\n\r\n**Version**: What redis-py and what redis version is the issue happening on?\r\n\r\n`redis==4.5.4`\r\n\r\n**Platform**: What platform / version? (For example Python 3.5.1 on Windows 7 / Ubuntu 15.10 / Azure)\r\n\r\nPython 3.11 on Linux\r\n\r\n**Description**: Description of your issue, stack traces from errors and code that reproduces the issue\r\n\r\nI attempted to upgrade my system to Python 3.11.3 since the Docker image was updated yesterday. However, `async-timeout` silently failed to install due to a requirement in the Redis [setup.py](https://github.com/redis/redis-py/blob/master/setup.py#L37) that made its way into my Pipfile.lock.\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2700/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2700/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2699", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2699/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2699/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2699/events", "html_url": "https://github.com/redis/redis-py/pull/2699", "id": 1657718204, "node_id": "PR_kwDOAAWKjs5NyLi5", "number": 2699, "title": "Really do not use asyncio's timeout lib before 3.11.2", "user": {"login": "mirekdlugosz", "id": 12373754, "node_id": "MDQ6VXNlcjEyMzczNzU0", "avatar_url": "https://avatars.githubusercontent.com/u/12373754?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mirekdlugosz", "html_url": "https://github.com/mirekdlugosz", "followers_url": "https://api.github.com/users/mirekdlugosz/followers", "following_url": "https://api.github.com/users/mirekdlugosz/following{/other_user}", "gists_url": "https://api.github.com/users/mirekdlugosz/gists{/gist_id}", "starred_url": "https://api.github.com/users/mirekdlugosz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mirekdlugosz/subscriptions", "organizations_url": "https://api.github.com/users/mirekdlugosz/orgs", "repos_url": "https://api.github.com/users/mirekdlugosz/repos", "events_url": "https://api.github.com/users/mirekdlugosz/events{/privacy}", "received_events_url": "https://api.github.com/users/mirekdlugosz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 4234596657, "node_id": "LA_kwDOAAWKjs78ZtEx", "url": "https://api.github.com/repos/redis/redis-py/labels/async", "name": "async", "color": "183C77", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-04-06T16:24:43Z", "updated_at": "2023-04-13T11:56:39Z", "closed_at": "2023-04-13T11:56:38Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2699", "html_url": "https://github.com/redis/redis-py/pull/2699", "diff_url": "https://github.com/redis/redis-py/pull/2699.diff", "patch_url": "https://github.com/redis/redis-py/pull/2699.patch", "merged_at": "2023-04-13T11:56:38Z"}, "body": "This is a follow-up to 480253037afe4c12e38a0f98cadd3019a3724254 / #2659 . There was an issue in asyncio timeout that was fixed in Python 3.11.3. The intent was to pull this package as dependency only on 3.11.2 and earlier.\r\n\r\nHowever, [dependency environment marker `python_version` only considers first two numbers from Python version tuple](https://peps.python.org/pep-0508/). So it compared \"3.11\" to \"3.11.2\", evaluated that to True and pulled in dependency even on Python 3.11.3.\r\n\r\nSince we want to compare against full version number, `python_full_version` marker should be used instead.\r\n\r\nTest case:\r\n\r\n```\r\n$ python --version\r\nPython 3.11.3\r\n$ pip install redis\r\nCollecting redis\r\n  Using cached redis-4.5.4-py3-none-any.whl (238 kB)\r\nCollecting async-timeout>=4.0.2\r\n  Using cached async_timeout-4.0.2-py3-none-any.whl (5.8 kB)\r\nInstalling collected packages: async-timeout, redis\r\nSuccessfully installed async-timeout-4.0.2 redis-4.5.4\r\n```\r\n\r\nExpected:\r\n\r\n```\r\n$ pip install redis\r\nCollecting redis\r\n  Using cached redis-4.5.4-py3-none-any.whl (238 kB)\r\nInstalling collected packages: redis\r\nSuccessfully installed redis-4.5.4\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2699/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2699/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2694", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2694/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2694/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2694/events", "html_url": "https://github.com/redis/redis-py/pull/2694", "id": 1654310495, "node_id": "PR_kwDOAAWKjs5Nm6Hu", "number": 2694, "title": "Fix memory leak caused by hiredis in asyncio case", "user": {"login": "oranav", "id": 252748, "node_id": "MDQ6VXNlcjI1Mjc0OA==", "avatar_url": "https://avatars.githubusercontent.com/u/252748?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oranav", "html_url": "https://github.com/oranav", "followers_url": "https://api.github.com/users/oranav/followers", "following_url": "https://api.github.com/users/oranav/following{/other_user}", "gists_url": "https://api.github.com/users/oranav/gists{/gist_id}", "starred_url": "https://api.github.com/users/oranav/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oranav/subscriptions", "organizations_url": "https://api.github.com/users/oranav/orgs", "repos_url": "https://api.github.com/users/oranav/repos", "events_url": "https://api.github.com/users/oranav/events{/privacy}", "received_events_url": "https://api.github.com/users/oranav/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 4234596657, "node_id": "LA_kwDOAAWKjs78ZtEx", "url": "https://api.github.com/repos/redis/redis-py/labels/async", "name": "async", "color": "183C77", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2023-04-04T17:48:07Z", "updated_at": "2023-04-13T11:57:52Z", "closed_at": "2023-04-13T11:57:50Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2694", "html_url": "https://github.com/redis/redis-py/pull/2694", "diff_url": "https://github.com/redis/redis-py/pull/2694.diff", "patch_url": "https://github.com/redis/redis-py/pull/2694.patch", "merged_at": "2023-04-13T11:57:50Z"}, "body": "### Pull Request check-list\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [X] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [X] Was the change added to CHANGES file?\r\n\r\n### Description of change\r\n\r\nChange `BaseParser.parse_error` to be a class method, so that no reference is being held from `hiredis.Reader` to the `HiredisParser` instance. This is a workaround until a proper fix in [hiredis-py ](https://github.com/redis/hiredis-py)is implemented (<https://github.com/redis/hiredis-py/pull/163>).", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2694/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2694/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2693", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2693/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2693/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2693/events", "html_url": "https://github.com/redis/redis-py/issues/2693", "id": 1654279174, "node_id": "I_kwDOAAWKjs5imkwG", "number": 2693, "title": "Usage of `hiredis.Reader` in asyncio leads to cyclic reference, causing a memory leak", "user": {"login": "oranav", "id": 252748, "node_id": "MDQ6VXNlcjI1Mjc0OA==", "avatar_url": "https://avatars.githubusercontent.com/u/252748?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oranav", "html_url": "https://github.com/oranav", "followers_url": "https://api.github.com/users/oranav/followers", "following_url": "https://api.github.com/users/oranav/following{/other_user}", "gists_url": "https://api.github.com/users/oranav/gists{/gist_id}", "starred_url": "https://api.github.com/users/oranav/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oranav/subscriptions", "organizations_url": "https://api.github.com/users/oranav/orgs", "repos_url": "https://api.github.com/users/oranav/repos", "events_url": "https://api.github.com/users/oranav/events{/privacy}", "received_events_url": "https://api.github.com/users/oranav/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 4234596657, "node_id": "LA_kwDOAAWKjs78ZtEx", "url": "https://api.github.com/repos/redis/redis-py/labels/async", "name": "async", "color": "183C77", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-04-04T17:23:18Z", "updated_at": "2023-04-13T11:58:11Z", "closed_at": "2023-04-13T11:58:11Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Version**: redis-py 4.5.4, Redis version irrelevant\r\n\r\n**Platform**: macOS 13.2.1\r\n\r\n**Description**: There's an inherent memory leak in `redis.asyncio.connection.HiredisParser`. This is actually `hiredis-py`'s fault, but I suggest that we implement stuff a bit different to workaround this issue until <https://github.com/redis/hiredis-py/pull/163> is merged and a new version of `hiredis-py` is released.\r\n\r\nThis is a result of #2557.\r\n\r\nInside `HiredisParser.on_connect`, an `hiredis.Reader` object is constructed with `replyError` set to `self.parse_error`:\r\n\r\n<https://github.com/redis/redis-py/blob/e1017fd77afd2f56dca90f986fc82e398e518a26/redis/asyncio/connection.py#L368-L376>\r\n\r\nAt this point, we have the `HiredisParser` object pointing to the `hiredis.Reader` object (through `_reader`).\r\n\r\n`hiredis.Reader.__init__` reads `replyError` and sets it within `self.replyErrorClass`:\r\n\r\n<https://github.com/redis/hiredis-py/blob/8adb1b3cb38b82cdc73fa2d72879712da1f74e70/src/reader.c#L288>\r\n\r\nNow we have a cyclic reference:\r\n\r\n`HiredisParser._reader` references to `hiredis.Reader`;\r\n`hiredis.Reader.replyErrorClass` references to `HiredisParser.parse_error` (which is a bound method, so its references to `self`).\r\n\r\nHowever, `hiredis.Reader` doesn't support garbage collection!\r\n\r\n<https://github.com/redis/hiredis-py/blob/8adb1b3cb38b82cdc73fa2d72879712da1f74e70/src/reader.c#L47>\r\n\r\nIt doesn't declare [`Py_TPFLAGS_HAVE_GC`](https://docs.python.org/3/c-api/typeobj.html#Py_TPFLAGS_HAVE_GC).\r\n\r\nYou can also see that it doesn't implement [`tp_traverse`](https://docs.python.org/3/c-api/typeobj.html#c.PyTypeObject.tp_traverse):\r\n<https://github.com/redis/hiredis-py/blob/8adb1b3cb38b82cdc73fa2d72879712da1f74e70/src/reader.c#L49>\r\n\r\nSo these objects are never garbage collected, leading to a memory leak.\r\n\r\nThe non-asyncio variant doesn't suffer from this problem, as its `HiredisParser.on_disconnect` deletes the reference to `hiredis.Reader`, breaking the cycle. #2557 removed this from the async variant, which has introduced the problem.\r\n\r\nThe correct solution is [to support GC in `hiredis-py`](https://github.com/redis/hiredis-py/pull/163), as it can hold references to non-primitive objects. Until a new version is released, I suggest to implement a temporary workaround.\r\n\r\nThe following is a simple reproduction script:\r\n\r\n```python3\r\nimport asyncio\r\nimport gc\r\n\r\nimport hiredis  # Make sure it's installed\r\nimport redis.asyncio\r\nimport redis.asyncio.connection\r\n\r\n\r\nasync def a():\r\n    r = redis.asyncio.Redis.from_url(\"redis://localhost:6379/0\")\r\n    await r.get(\"a\")\r\n    await r.close()\r\n\r\nasyncio.run(a())\r\ngc.collect()\r\n\r\nfor obj in gc.get_objects():\r\n    if isinstance(obj, redis.asyncio.connection.BaseParser):\r\n        print(obj)\r\n```", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2693/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2693/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2667", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2667/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2667/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2667/events", "html_url": "https://github.com/redis/redis-py/issues/2667", "id": 1642643339, "node_id": "I_kwDOAAWKjs5h6L-L", "number": 2667, "title": "Usage of \"once\" argument is incorrect (inverted) in async Sentinel client", "user": {"login": "felipou", "id": 462154, "node_id": "MDQ6VXNlcjQ2MjE1NA==", "avatar_url": "https://avatars.githubusercontent.com/u/462154?v=4", "gravatar_id": "", "url": "https://api.github.com/users/felipou", "html_url": "https://github.com/felipou", "followers_url": "https://api.github.com/users/felipou/followers", "following_url": "https://api.github.com/users/felipou/following{/other_user}", "gists_url": "https://api.github.com/users/felipou/gists{/gist_id}", "starred_url": "https://api.github.com/users/felipou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/felipou/subscriptions", "organizations_url": "https://api.github.com/users/felipou/orgs", "repos_url": "https://api.github.com/users/felipou/repos", "events_url": "https://api.github.com/users/felipou/events{/privacy}", "received_events_url": "https://api.github.com/users/felipou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 4234596657, "node_id": "LA_kwDOAAWKjs78ZtEx", "url": "https://api.github.com/repos/redis/redis-py/labels/async", "name": "async", "color": "183C77", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-03-27T18:57:53Z", "updated_at": "2023-04-28T14:10:15Z", "closed_at": "2023-04-28T14:10:15Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I was just taking a look at the source code and saw this, the condition seems inverted:\r\nhttps://github.com/redis/redis-py/blob/66a4d6b2a493dd3a20cc299ab5fef3c14baad965/redis/asyncio/sentinel.py#L222-L229\r\n\r\nIn the non-async Sentinel it seems correct:\r\nhttps://github.com/redis/redis-py/blob/master/redis/sentinel.py#L202-L206\r\n\r\nIf needed, I can help with a PR (I just need to look at the tests to see if we can create one that would catch this).", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2667/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2667/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2666", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2666/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2666/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2666/events", "html_url": "https://github.com/redis/redis-py/pull/2666", "id": 1640922616, "node_id": "PR_kwDOAAWKjs5M6UKI", "number": 2666, "title": "Fixing cancelled async futures", "user": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 4393919998, "node_id": "LA_kwDOAAWKjs8AAAABBeXl_g", "url": "https://api.github.com/repos/redis/redis-py/labels/experimental", "name": "experimental", "color": "bfdadc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2023-03-26T13:59:04Z", "updated_at": "2023-04-20T18:05:56Z", "closed_at": "2023-03-29T09:01:46Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2666", "html_url": "https://github.com/redis/redis-py/pull/2666", "diff_url": "https://github.com/redis/redis-py/pull/2666.diff", "patch_url": "https://github.com/redis/redis-py/pull/2666.patch", "merged_at": "2023-03-29T09:01:46Z"}, "body": "The following pull request contains changes to Async cancelling.  Specifically, all cases where a command is sent to redis, via execute_command (and friends), and now wrapped with a shield. This builds on the helpful proxy provided in #2665.\r\n\r\nThis change covers the following usage patterns.\r\n\r\n* Async\r\n* Async pipeline\r\n* Async pubsub\r\n* Async sentinel\r\n* Async cluster\r\n* Async cluster pipelines\r\n\r\nReproducible tests currently exist for async, async pipeline, and async cluster. But note - the async cluster pipeline seems at best incorrect.\r\n\r\nFeedback and changes are very much welcomed. Bonus points for assistance with testing,", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2666/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2666/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2659", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2659/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2659/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2659/events", "html_url": "https://github.com/redis/redis-py/pull/2659", "id": 1638051725, "node_id": "PR_kwDOAAWKjs5Mw0yX", "number": 2659, "title": "fix: do not use asyncio's timeout lib before 3.11.2", "user": {"login": "bellini666", "id": 134025, "node_id": "MDQ6VXNlcjEzNDAyNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/134025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bellini666", "html_url": "https://github.com/bellini666", "followers_url": "https://api.github.com/users/bellini666/followers", "following_url": "https://api.github.com/users/bellini666/following{/other_user}", "gists_url": "https://api.github.com/users/bellini666/gists{/gist_id}", "starred_url": "https://api.github.com/users/bellini666/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bellini666/subscriptions", "organizations_url": "https://api.github.com/users/bellini666/orgs", "repos_url": "https://api.github.com/users/bellini666/repos", "events_url": "https://api.github.com/users/bellini666/events{/privacy}", "received_events_url": "https://api.github.com/users/bellini666/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 4234596657, "node_id": "LA_kwDOAAWKjs78ZtEx", "url": "https://api.github.com/repos/redis/redis-py/labels/async", "name": "async", "color": "183C77", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2023-03-23T18:08:05Z", "updated_at": "2023-03-27T23:14:43Z", "closed_at": "2023-03-27T21:32:44Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2659", "html_url": "https://github.com/redis/redis-py/pull/2659", "diff_url": "https://github.com/redis/redis-py/pull/2659.diff", "patch_url": "https://github.com/redis/redis-py/pull/2659.patch", "merged_at": "2023-03-27T21:32:44Z"}, "body": "There's an issue in asyncio's timeout lib before 3.11.3 that causes async calls to raise `CancelledError`.\r\n\r\nThis is a cpython issue that was fixed in this commit [1] and cherry-picked to previous versions, meaning 3.11.3 will work correctly.\r\n\r\nCheck [2] for more info.\r\n\r\n[1] https://github.com/python/cpython/commit/04adf2df395ded81922c71360a5d66b597471e49\r\n[2] https://github.com/redis/redis-py/issues/2633", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2659/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 1, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2659/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2641", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2641/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2641/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2641/events", "html_url": "https://github.com/redis/redis-py/pull/2641", "id": 1635870913, "node_id": "PR_kwDOAAWKjs5MphBk", "number": 2641, "title": "AsyncIO Race Condition Fix", "user": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-03-22T14:25:28Z", "updated_at": "2023-03-26T09:33:00Z", "closed_at": "2023-03-22T16:03:50Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2641", "html_url": "https://github.com/redis/redis-py/pull/2641", "diff_url": "https://github.com/redis/redis-py/pull/2641.diff", "patch_url": "https://github.com/redis/redis-py/pull/2641.patch", "merged_at": "2023-03-22T16:03:50Z"}, "body": "closes #2624 \r\ncloses #2579 ", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2641/reactions", "total_count": 4, "+1": 0, "-1": 0, "laugh": 0, "hooray": 3, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2641/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2640", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2640/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2640/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2640/events", "html_url": "https://github.com/redis/redis-py/pull/2640", "id": 1635869648, "node_id": "PR_kwDOAAWKjs5Mpgwa", "number": 2640, "title": "AsyncIO Race Condition Fix", "user": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-03-22T14:24:45Z", "updated_at": "2023-03-22T16:07:27Z", "closed_at": "2023-03-22T16:04:01Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2640", "html_url": "https://github.com/redis/redis-py/pull/2640", "diff_url": "https://github.com/redis/redis-py/pull/2640.diff", "patch_url": "https://github.com/redis/redis-py/pull/2640.patch", "merged_at": "2023-03-22T16:04:01Z"}, "body": "closes #2624 \r\ncloses #2579 ", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2640/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2640/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2639", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2639/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2639/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2639/events", "html_url": "https://github.com/redis/redis-py/pull/2639", "id": 1635868529, "node_id": "PR_kwDOAAWKjs5MpghB", "number": 2639, "title": "AsyncIO Race Condition Fix", "user": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-03-22T14:24:07Z", "updated_at": "2023-03-22T16:07:21Z", "closed_at": "2023-03-22T16:04:42Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2639", "html_url": "https://github.com/redis/redis-py/pull/2639", "diff_url": "https://github.com/redis/redis-py/pull/2639.diff", "patch_url": "https://github.com/redis/redis-py/pull/2639.patch", "merged_at": "2023-03-22T16:04:42Z"}, "body": "closes #2624 \r\ncloses #2579", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2639/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2639/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2611", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2611/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2611/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2611/events", "html_url": "https://github.com/redis/redis-py/pull/2611", "id": 1622366889, "node_id": "PR_kwDOAAWKjs5L8KSP", "number": 2611, "title": "update json().arrindex() default values", "user": {"login": "davemcphee", "id": 6517921, "node_id": "MDQ6VXNlcjY1MTc5MjE=", "avatar_url": "https://avatars.githubusercontent.com/u/6517921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davemcphee", "html_url": "https://github.com/davemcphee", "followers_url": "https://api.github.com/users/davemcphee/followers", "following_url": "https://api.github.com/users/davemcphee/following{/other_user}", "gists_url": "https://api.github.com/users/davemcphee/gists{/gist_id}", "starred_url": "https://api.github.com/users/davemcphee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davemcphee/subscriptions", "organizations_url": "https://api.github.com/users/davemcphee/orgs", "repos_url": "https://api.github.com/users/davemcphee/repos", "events_url": "https://api.github.com/users/davemcphee/events{/privacy}", "received_events_url": "https://api.github.com/users/davemcphee/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 5129908417, "node_id": "LA_kwDOAAWKjs8AAAABMcQwwQ", "url": "https://api.github.com/repos/redis/redis-py/labels/RedisJSON", "name": "RedisJSON", "color": "FBCA04", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-03-13T22:23:24Z", "updated_at": "2023-03-15T19:40:53Z", "closed_at": "2023-03-15T09:33:38Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2611", "html_url": "https://github.com/redis/redis-py/pull/2611", "diff_url": "https://github.com/redis/redis-py/pull/2611.diff", "patch_url": "https://github.com/redis/redis-py/pull/2611.patch", "merged_at": "2023-03-15T09:33:38Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nRefactor default `start` / `stop` values in the `json().arrindex()` function. Previously, if `stop` was _unset_, the stop value would default to -1. If the value being searched was the last element in an array, and `stop` was set to -1, the server would reply with -1 instead of the element's index.\r\n\r\neg.: given a json object myarr: `{\"l\": [\"a\", \"b\", \"c\", \"d\"]}`:\r\n\r\n```\r\nlocalhost:36379> JSON.ARRINDEX myarr $.l '\"d\"'            # no start or stop set\r\n1) (integer) 3\r\nlocalhost:36379> JSON.ARRINDEX myarr $.l '\"d\"' 0 10000    # stop set to some huge value\r\n1) (integer) 3\r\nlocalhost:36379> JSON.ARRINDEX myarr $.l '\"d\"' 0 -1       # stop set to -1\r\n1) (integer) -1\r\nlocalhost:36379> JSON.ARRINDEX myarr $.l '\"d\"' 0          # start set to 0, but stop omitted\r\n1) (integer) 3\r\n```\r\n\r\nBy only appending `start` and `stop` values to the `JSON.ARRINDEX` command if they're set, the python client more closely mimics redis' behaviour. \r\n\r\nFixes #2481 ", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2611/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2611/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2602", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2602/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2602/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2602/events", "html_url": "https://github.com/redis/redis-py/pull/2602", "id": 1607447765, "node_id": "PR_kwDOAAWKjs5LKbZF", "number": 2602, "title": "fix: replace async_timeout by asyncio.timeout", "user": {"login": "sileht", "id": 200878, "node_id": "MDQ6VXNlcjIwMDg3OA==", "avatar_url": "https://avatars.githubusercontent.com/u/200878?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sileht", "html_url": "https://github.com/sileht", "followers_url": "https://api.github.com/users/sileht/followers", "following_url": "https://api.github.com/users/sileht/following{/other_user}", "gists_url": "https://api.github.com/users/sileht/gists{/gist_id}", "starred_url": "https://api.github.com/users/sileht/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sileht/subscriptions", "organizations_url": "https://api.github.com/users/sileht/orgs", "repos_url": "https://api.github.com/users/sileht/repos", "events_url": "https://api.github.com/users/sileht/events{/privacy}", "received_events_url": "https://api.github.com/users/sileht/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-03-02T20:35:06Z", "updated_at": "2023-03-16T11:51:20Z", "closed_at": "2023-03-16T11:51:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2602", "html_url": "https://github.com/redis/redis-py/pull/2602", "diff_url": "https://github.com/redis/redis-py/pull/2602.diff", "patch_url": "https://github.com/redis/redis-py/pull/2602.patch", "merged_at": "2023-03-16T11:51:20Z"}, "body": "### Pull Request check-list\n\n_Please make sure to review and check all of these items:_\n\n- [X] Does `$ tox` pass with this change (including linting)?\n- [X] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\n- [X] Is the new or changed code fully tested?\n- [X] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\n- [X] Is there an example added to the examples folder (if applicable)?\n- [X] Was the change added to CHANGES file?\n\n_NOTE: these things are not required to open a PR and can be done\nafterwards / while the PR is open._\n\n### Description of change\n#\nasync_timeout does not support python 3.11\nhttps://github.com/aio-libs/async-timeout/pull/295\n\nAnd have two years old annoying bugs:\nhttps://github.com/aio-libs/async-timeout/issues/229\nhttps://github.com/redis/redis-py/issues/2551\n\nSince asyncio.timeout has been shipped in python 3.11, we should start\nusing it.\n\nPartially fixes 2551", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2602/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2602/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2582", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2582/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2582/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2582/events", "html_url": "https://github.com/redis/redis-py/pull/2582", "id": 1575130630, "node_id": "PR_kwDOAAWKjs5JeUBv", "number": 2582, "title": "Fix behaviour of async PythonParser to match RedisParser as for issue #2349", "user": {"login": "kristjanvalur", "id": 6009543, "node_id": "MDQ6VXNlcjYwMDk1NDM=", "avatar_url": "https://avatars.githubusercontent.com/u/6009543?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kristjanvalur", "html_url": "https://github.com/kristjanvalur", "followers_url": "https://api.github.com/users/kristjanvalur/followers", "following_url": "https://api.github.com/users/kristjanvalur/following{/other_user}", "gists_url": "https://api.github.com/users/kristjanvalur/gists{/gist_id}", "starred_url": "https://api.github.com/users/kristjanvalur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kristjanvalur/subscriptions", "organizations_url": "https://api.github.com/users/kristjanvalur/orgs", "repos_url": "https://api.github.com/users/kristjanvalur/repos", "events_url": "https://api.github.com/users/kristjanvalur/events{/privacy}", "received_events_url": "https://api.github.com/users/kristjanvalur/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-02-07T22:39:27Z", "updated_at": "2023-03-16T14:24:25Z", "closed_at": "2023-03-16T14:23:41Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2582", "html_url": "https://github.com/redis/redis-py/pull/2582", "diff_url": "https://github.com/redis/redis-py/pull/2582.diff", "patch_url": "https://github.com/redis/redis-py/pull/2582.patch", "merged_at": "2023-03-16T14:23:41Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [x] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nPR #2557 we allowed the async `HiredisParser` to finish reading a response even while a concurrent `disconnect()` might be issued.  This PR enables the test, and duplicates the behaviour for the `PythonParser`.\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2582/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2582/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2573", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2573/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2573/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2573/events", "html_url": "https://github.com/redis/redis-py/pull/2573", "id": 1571580774, "node_id": "PR_kwDOAAWKjs5JScO3", "number": 2573, "title": "Fix: tuple function cannot be passed more than one argument", "user": {"login": "kosuke-zhang", "id": 30019034, "node_id": "MDQ6VXNlcjMwMDE5MDM0", "avatar_url": "https://avatars.githubusercontent.com/u/30019034?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kosuke-zhang", "html_url": "https://github.com/kosuke-zhang", "followers_url": "https://api.github.com/users/kosuke-zhang/followers", "following_url": "https://api.github.com/users/kosuke-zhang/following{/other_user}", "gists_url": "https://api.github.com/users/kosuke-zhang/gists{/gist_id}", "starred_url": "https://api.github.com/users/kosuke-zhang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kosuke-zhang/subscriptions", "organizations_url": "https://api.github.com/users/kosuke-zhang/orgs", "repos_url": "https://api.github.com/users/kosuke-zhang/repos", "events_url": "https://api.github.com/users/kosuke-zhang/events{/privacy}", "received_events_url": "https://api.github.com/users/kosuke-zhang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-02-05T19:28:04Z", "updated_at": "2023-02-06T11:20:08Z", "closed_at": "2023-02-06T11:20:08Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2573", "html_url": "https://github.com/redis/redis-py/pull/2573", "diff_url": "https://github.com/redis/redis-py/pull/2573.diff", "patch_url": "https://github.com/redis/redis-py/pull/2573.patch", "merged_at": "2023-02-06T11:20:08Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\n_Please provide a description of the change here._\r\n\r\n```\r\n  File \"/opt/redis/__init__.py\", line 59, in <module>\r\n\r\n    VERSION = tuple(99, 99, 99)\r\n\r\nTypeError: tuple expected at most 1 arguments, got 3\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2573/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2573/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2569", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2569/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2569/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2569/events", "html_url": "https://github.com/redis/redis-py/pull/2569", "id": 1563604324, "node_id": "PR_kwDOAAWKjs5I4H2s", "number": 2569, "title": "Fix issue 2567: NoneType check before raising exception", "user": {"login": "SoulPancake", "id": 70265851, "node_id": "MDQ6VXNlcjcwMjY1ODUx", "avatar_url": "https://avatars.githubusercontent.com/u/70265851?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SoulPancake", "html_url": "https://github.com/SoulPancake", "followers_url": "https://api.github.com/users/SoulPancake/followers", "following_url": "https://api.github.com/users/SoulPancake/following{/other_user}", "gists_url": "https://api.github.com/users/SoulPancake/gists{/gist_id}", "starred_url": "https://api.github.com/users/SoulPancake/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SoulPancake/subscriptions", "organizations_url": "https://api.github.com/users/SoulPancake/orgs", "repos_url": "https://api.github.com/users/SoulPancake/repos", "events_url": "https://api.github.com/users/SoulPancake/events{/privacy}", "received_events_url": "https://api.github.com/users/SoulPancake/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-01-31T03:56:15Z", "updated_at": "2023-02-06T12:39:44Z", "closed_at": "2023-02-06T12:39:44Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2569", "html_url": "https://github.com/redis/redis-py/pull/2569", "diff_url": "https://github.com/redis/redis-py/pull/2569.diff", "patch_url": "https://github.com/redis/redis-py/pull/2569.patch", "merged_at": "2023-02-06T12:39:44Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [x] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [x] Is there an example added to the examples folder (if applicable)?\r\n- [x] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nThe change made to the read_response function adds a check to ensure that self._buffer is not None before trying to call rewind on it. If self._buffer is None, the call to rewind is skipped and the exception is re-raised as normal.\r\n\r\nThis change is necessary to prevent the \"AttributeError: 'NoneType' object has no attribute 'rewind'\" error from being raised if an exception occurs during the call to self._read_response() and the connection to Redis has been closed. Without this check, the rewind call would raise an error because self._buffer would be None, and None does not have a rewind attribute.\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2569/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2569/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2568", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2568/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2568/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2568/events", "html_url": "https://github.com/redis/redis-py/pull/2568", "id": 1560677941, "node_id": "PR_kwDOAAWKjs5IucbQ", "number": 2568, "title": "Fix issue 2540: Synchronise concurrent command calls to single-client to single-client mode", "user": {"login": "Vivanov98", "id": 66319645, "node_id": "MDQ6VXNlcjY2MzE5NjQ1", "avatar_url": "https://avatars.githubusercontent.com/u/66319645?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Vivanov98", "html_url": "https://github.com/Vivanov98", "followers_url": "https://api.github.com/users/Vivanov98/followers", "following_url": "https://api.github.com/users/Vivanov98/following{/other_user}", "gists_url": "https://api.github.com/users/Vivanov98/gists{/gist_id}", "starred_url": "https://api.github.com/users/Vivanov98/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Vivanov98/subscriptions", "organizations_url": "https://api.github.com/users/Vivanov98/orgs", "repos_url": "https://api.github.com/users/Vivanov98/repos", "events_url": "https://api.github.com/users/Vivanov98/events{/privacy}", "received_events_url": "https://api.github.com/users/Vivanov98/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 4234596657, "node_id": "LA_kwDOAAWKjs78ZtEx", "url": "https://api.github.com/repos/redis/redis-py/labels/async", "name": "async", "color": "183C77", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-01-28T03:55:04Z", "updated_at": "2023-01-29T13:48:51Z", "closed_at": "2023-01-29T13:48:51Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2568", "html_url": "https://github.com/redis/redis-py/pull/2568", "diff_url": "https://github.com/redis/redis-py/pull/2568.diff", "patch_url": "https://github.com/redis/redis-py/pull/2568.patch", "merged_at": "2023-01-29T13:48:51Z"}, "body": "### Pull Request check-list\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n\r\n### Description of change\r\n\r\nFixing issue [#2540](https://github.com/redis/redis-py/issues/2540) (example script in issue tested and bug no longer occurs)\r\n\r\nThe underlying cause is that the connection in single-client mode isn't protected by a lock, resulting in multiple coroutines reading/writing to a connection stream when multiple commands are called in parallel (forexample with asyncio.gather)\r\n\r\nAdditionally, redundant connections can be made if the first time the client is used, it is used in parallel (forexample with asyncio.gather).\r\n\r\nA simple lock mechanism has been added to the `execute_command` function to ensure that single-client mode is always executing commands in sequence. This lock is also used each time the `initialize` method is called, ensuring that multiple connections aren't spun up if the first time the client is called happens to be with a parallel mechanism.\r\n\r\nWorth mentioning that the use cases for using parallel calling mechanisms in single-client mode are probably limited, though this still seems useful to have in terms of consistency.\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2568/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2568/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2557", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2557/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2557/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2557/events", "html_url": "https://github.com/redis/redis-py/pull/2557", "id": 1550886145, "node_id": "PR_kwDOAAWKjs5INyBP", "number": 2557, "title": "Fix issue 2349: Let async HiredisParser finish parsing after a Connection.disconnect()", "user": {"login": "kristjanvalur", "id": 6009543, "node_id": "MDQ6VXNlcjYwMDk1NDM=", "avatar_url": "https://avatars.githubusercontent.com/u/6009543?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kristjanvalur", "html_url": "https://github.com/kristjanvalur", "followers_url": "https://api.github.com/users/kristjanvalur/followers", "following_url": "https://api.github.com/users/kristjanvalur/following{/other_user}", "gists_url": "https://api.github.com/users/kristjanvalur/gists{/gist_id}", "starred_url": "https://api.github.com/users/kristjanvalur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kristjanvalur/subscriptions", "organizations_url": "https://api.github.com/users/kristjanvalur/orgs", "repos_url": "https://api.github.com/users/kristjanvalur/repos", "events_url": "https://api.github.com/users/kristjanvalur/events{/privacy}", "received_events_url": "https://api.github.com/users/kristjanvalur/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-01-20T13:55:27Z", "updated_at": "2023-02-07T08:37:57Z", "closed_at": "2023-02-06T19:25:11Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2557", "html_url": "https://github.com/redis/redis-py/pull/2557", "diff_url": "https://github.com/redis/redis-py/pull/2557.diff", "patch_url": "https://github.com/redis/redis-py/pull/2557.patch", "merged_at": "2023-02-06T19:25:11Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [x] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nThis change addresses an issue raised in issue #2349.\r\n\r\nIt ensures that an async `Connection.read_response()` call can succeed even if a simultaneous `Connection.disconnect()`\r\ncall is issued.  Socket disconnects are _graceful_ in that one closes the send direction and can then wait for any data\r\nin transit to arrive, until an EOF is delivered from the remote side.  In `asyncio` parlance this means that to gracefully close a socket, you close the `send` _stream_ and can then read from the `receive` stream until you reach an End Of File.\r\n\r\nThis change makes sure that the internal `BaseParser` state is maintained so that it can continue to request and parse chunks for as long as it can.   Previously, the HiredisParser would get its internal state cleared immediately, and this would cause the read, in progress, to fail with an unexpected error.  Now an ongoing `read_response()` will continue until it succeeds or encounters an error such as EOF.\r\n\r\nA new `read_response()` issued **after** a `disconnect()` call has been issued (but before it completes) will immediately fail, howerver.  This is to maintain previous semantics, even though we **could** simply allow it to go through and fail later when it attemts to read from a closed connection.\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2557/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2557/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2549", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2549/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2549/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2549/events", "html_url": "https://github.com/redis/redis-py/pull/2549", "id": 1526722594, "node_id": "PR_kwDOAAWKjs5HCTs-", "number": 2549, "title": "Allow replica to master promotion in nodes_cache", "user": {"login": "zakaf", "id": 3315213, "node_id": "MDQ6VXNlcjMzMTUyMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/3315213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zakaf", "html_url": "https://github.com/zakaf", "followers_url": "https://api.github.com/users/zakaf/followers", "following_url": "https://api.github.com/users/zakaf/following{/other_user}", "gists_url": "https://api.github.com/users/zakaf/gists{/gist_id}", "starred_url": "https://api.github.com/users/zakaf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zakaf/subscriptions", "organizations_url": "https://api.github.com/users/zakaf/orgs", "repos_url": "https://api.github.com/users/zakaf/repos", "events_url": "https://api.github.com/users/zakaf/events{/privacy}", "received_events_url": "https://api.github.com/users/zakaf/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-01-10T03:59:24Z", "updated_at": "2023-01-11T13:52:38Z", "closed_at": "2023-01-11T09:29:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2549", "html_url": "https://github.com/redis/redis-py/pull/2549", "diff_url": "https://github.com/redis/redis-py/pull/2549.diff", "patch_url": "https://github.com/redis/redis-py/pull/2549.patch", "merged_at": "2023-01-11T09:29:12Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [X] Does `$ tox` pass with this change (including linting)?\r\n- [X] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [X] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n_Please provide a description of the change here._\r\nfixes https://github.com/redis/redis-py/issues/2433\r\n\r\nWhen replica is promoted to master, ClusterNode's server_type must change accordingly, but the current implementation reuses the server_type, so no master is found in nodes_cache after initialization\r\n\r\nThis PR changes the server_type to a correct value, even if we reuse ClusterNode from nodes_cache\r\n\r\nI've personally experienced this scenario, when i changed instance type in AWS Elasticache\r\n  - changing instance type resulted in the addition of a new replica node and that node getting promoted to master\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2549/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2549/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2540", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2540/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2540/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2540/events", "html_url": "https://github.com/redis/redis-py/issues/2540", "id": 1519194582, "node_id": "I_kwDOAAWKjs5ajRHW", "number": 2540, "title": "RuntimeError: readuntil() called while another coroutine is already waiting for incoming data", "user": {"login": "Tiendil", "id": 871672, "node_id": "MDQ6VXNlcjg3MTY3Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/871672?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Tiendil", "html_url": "https://github.com/Tiendil", "followers_url": "https://api.github.com/users/Tiendil/followers", "following_url": "https://api.github.com/users/Tiendil/following{/other_user}", "gists_url": "https://api.github.com/users/Tiendil/gists{/gist_id}", "starred_url": "https://api.github.com/users/Tiendil/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Tiendil/subscriptions", "organizations_url": "https://api.github.com/users/Tiendil/orgs", "repos_url": "https://api.github.com/users/Tiendil/repos", "events_url": "https://api.github.com/users/Tiendil/events{/privacy}", "received_events_url": "https://api.github.com/users/Tiendil/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 4234596657, "node_id": "LA_kwDOAAWKjs78ZtEx", "url": "https://api.github.com/repos/redis/redis-py/labels/async", "name": "async", "color": "183C77", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-01-04T15:46:17Z", "updated_at": "2023-02-08T10:43:45Z", "closed_at": "2023-01-29T13:50:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Version**: `redis==4.4.0`, Redis: `redis:6.2-alpine`  (docker)\r\n\r\n**Platform**: Python 3.9.16, docker `python:3.9`\r\n\r\n**Description**: Redis client raises RuntimeError while doing multiple concurrency operations.\r\n\r\nReproduced on `4.4.0`, ok on `4.3.5`\r\n\r\nExample code:\r\n\r\n```\r\nimport asyncio\r\nimport uuid\r\n\r\nfrom redis.asyncio import Redis\r\n\r\n\r\nasync def main():\r\n\r\n    client = Redis(\r\n        host=\"redis\",\r\n        port=6379,\r\n        db=0,\r\n        username=None,\r\n        password=None,\r\n        retry_on_timeout=True,\r\n        single_connection_client=True,\r\n        client_name='test_client',\r\n    )\r\n\r\n    # At my PC stable reproduces with n=10, but let set n=100 for better guarantees\r\n    n = 100\r\n\r\n    async def problem():\r\n        await client.delete(uuid.uuid4().hex)\r\n        await client.delete(uuid.uuid4().hex)  # <- problem is at this line\r\n\r\n    operations = [problem() for i in range(n)]\r\n\r\n    await asyncio.gather(*operations)\r\n\r\n    print('success!')\r\n```\r\n\r\nStacktrace:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/app/x.py\", line 36, in <module>\r\n    asyncio.get_event_loop().run_until_complete(main())\r\n  File \"/usr/local/lib/python3.9/asyncio/base_events.py\", line 647, in run_until_complete\r\n    return future.result()\r\n  File \"/app/x.py\", line 33, in main\r\n    await asyncio.gather(*operations)\r\n  File \"/app/x.py\", line 29, in problem\r\n    await client.delete(uuid.uuid4().hex)  # <- problem is at this line\r\n  File \"/tmp/venv/lib/python3.9/site-packages/redis/asyncio/client.py\", line 505, in execute_command\r\n    return await conn.retry.call_with_retry(\r\n  File \"/tmp/venv/lib/python3.9/site-packages/redis/asyncio/retry.py\", line 59, in call_with_retry\r\n    return await do()\r\n  File \"/tmp/venv/lib/python3.9/site-packages/redis/asyncio/client.py\", line 481, in _send_command_parse_response\r\n    return await self.parse_response(conn, command_name, **options)\r\n  File \"/tmp/venv/lib/python3.9/site-packages/redis/asyncio/client.py\", line 524, in parse_response\r\n    response = await connection.read_response()\r\n  File \"/tmp/venv/lib/python3.9/site-packages/redis/asyncio/connection.py\", line 800, in read_response\r\n    response = await self._parser.read_response(\r\n  File \"/tmp/venv/lib/python3.9/site-packages/redis/asyncio/connection.py\", line 245, in read_response\r\n    raw = await self._readline()\r\n  File \"/tmp/venv/lib/python3.9/site-packages/redis/asyncio/connection.py\", line 311, in _readline\r\n    data = await self._stream.readline()\r\n  File \"/usr/local/lib/python3.9/asyncio/streams.py\", line 540, in readline\r\n    line = await self.readuntil(sep)\r\n  File \"/usr/local/lib/python3.9/asyncio/streams.py\", line 632, in readuntil\r\n    await self._wait_for_data('readuntil')\r\n  File \"/usr/local/lib/python3.9/asyncio/streams.py\", line 503, in _wait_for_data\r\n    raise RuntimeError(\r\nRuntimeError: readuntil() called while another coroutine is already waiting for incoming data\r\n```", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2540/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2540/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2531", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2531/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2531/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2531/events", "html_url": "https://github.com/redis/redis-py/pull/2531", "id": 1510718782, "node_id": "PR_kwDOAAWKjs5GMJsU", "number": 2531, "title": "Add type checking to `__eq__` in graph classes", "user": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-12-26T08:03:16Z", "updated_at": "2023-01-08T08:42:20Z", "closed_at": "2023-01-08T08:42:19Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2531", "html_url": "https://github.com/redis/redis-py/pull/2531", "diff_url": "https://github.com/redis/redis-py/pull/2531.diff", "patch_url": "https://github.com/redis/redis-py/pull/2531.patch", "merged_at": "2023-01-08T08:42:19Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nFixes #2524 ", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2531/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2531/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2529", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2529/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2529/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2529/events", "html_url": "https://github.com/redis/redis-py/pull/2529", "id": 1507859192, "node_id": "PR_kwDOAAWKjs5GClBg", "number": 2529, "title": "Accept str for ex Parameter in 'set' Command", "user": {"login": "shacharPash", "id": 93581407, "node_id": "U_kgDOBZPwXw", "avatar_url": "https://avatars.githubusercontent.com/u/93581407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shacharPash", "html_url": "https://github.com/shacharPash", "followers_url": "https://api.github.com/users/shacharPash/followers", "following_url": "https://api.github.com/users/shacharPash/following{/other_user}", "gists_url": "https://api.github.com/users/shacharPash/gists{/gist_id}", "starred_url": "https://api.github.com/users/shacharPash/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shacharPash/subscriptions", "organizations_url": "https://api.github.com/users/shacharPash/orgs", "repos_url": "https://api.github.com/users/shacharPash/repos", "events_url": "https://api.github.com/users/shacharPash/events{/privacy}", "received_events_url": "https://api.github.com/users/shacharPash/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-12-22T13:09:56Z", "updated_at": "2023-01-05T12:33:31Z", "closed_at": "2023-01-05T12:33:30Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2529", "html_url": "https://github.com/redis/redis-py/pull/2529", "diff_url": "https://github.com/redis/redis-py/pull/2529.diff", "patch_url": "https://github.com/redis/redis-py/pull/2529.patch", "merged_at": "2023-01-05T12:33:30Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\n_Please provide a description of the change here._\r\n\r\nFixes #2178 issue", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2529/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2529/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2524", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2524/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2524/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2524/events", "html_url": "https://github.com/redis/redis-py/issues/2524", "id": 1505014538, "node_id": "I_kwDOAAWKjs5ZtLMK", "number": 2524, "title": "no type checking with __eq__ in all the graph classes", "user": {"login": "RJ-Infinity", "id": 61078578, "node_id": "MDQ6VXNlcjYxMDc4NTc4", "avatar_url": "https://avatars.githubusercontent.com/u/61078578?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RJ-Infinity", "html_url": "https://github.com/RJ-Infinity", "followers_url": "https://api.github.com/users/RJ-Infinity/followers", "following_url": "https://api.github.com/users/RJ-Infinity/following{/other_user}", "gists_url": "https://api.github.com/users/RJ-Infinity/gists{/gist_id}", "starred_url": "https://api.github.com/users/RJ-Infinity/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RJ-Infinity/subscriptions", "organizations_url": "https://api.github.com/users/RJ-Infinity/orgs", "repos_url": "https://api.github.com/users/RJ-Infinity/repos", "events_url": "https://api.github.com/users/RJ-Infinity/events{/privacy}", "received_events_url": "https://api.github.com/users/RJ-Infinity/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-12-20T17:46:08Z", "updated_at": "2023-01-08T08:42:20Z", "closed_at": "2023-01-08T08:42:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Version**: redis-py version 4.4.0 (redis version shouldnt matter but i'm using redis-stack 6.2.4-v3)\r\n\r\n**Platform**: python version 3.10.9 (but should effect all versions) on wsl Ubuntu 20.04.5 LTS\r\n\r\n**Description**: none of the redis graph classes check the types when checking equality \r\n```python\r\nimport redis.commands.graph as redisGraph\r\nfoo = redisGraph.Node()\r\n\r\nfoo == None # this line causes the error\r\n```\r\n```python \r\nAttributeError: 'NoneType' object has no attribute 'label'\r\n```\r\nyou get the same error when checking against any type that is not a `Node`\r\n\r\nit also happens with the `Edge` class\r\n```python\r\nbar = redisGraph.Edge(foo,\"\",foo)\r\nbar == \"\"\r\n```\r\n```python\r\nAttributeError: 'str' object has no attribute 'src_node'\r\n```\r\nand also the `Path` class\r\n```python\r\nbaz = redisGraph.Path([],[])\r\nbaz == 4\r\n```\r\n```python\r\nAttributeError: 'int' object has no attribute 'nodes'\r\n```\r\ni suspect adding this sort of code in would fix it\r\n```python\r\n# Check that the rhs the correct type\r\nif not isinstance(rhs, type(self)):\r\n    return False\r\n```", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2524/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2524/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2520", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2520/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2520/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2520/events", "html_url": "https://github.com/redis/redis-py/pull/2520", "id": 1502027081, "node_id": "PR_kwDOAAWKjs5Fu-n7", "number": 2520, "title": "Fix for Unhandled exception related to self.host with unix socket", "user": {"login": "winmorre", "id": 78548837, "node_id": "MDQ6VXNlcjc4NTQ4ODM3", "avatar_url": "https://avatars.githubusercontent.com/u/78548837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/winmorre", "html_url": "https://github.com/winmorre", "followers_url": "https://api.github.com/users/winmorre/followers", "following_url": "https://api.github.com/users/winmorre/following{/other_user}", "gists_url": "https://api.github.com/users/winmorre/gists{/gist_id}", "starred_url": "https://api.github.com/users/winmorre/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/winmorre/subscriptions", "organizations_url": "https://api.github.com/users/winmorre/orgs", "repos_url": "https://api.github.com/users/winmorre/repos", "events_url": "https://api.github.com/users/winmorre/events{/privacy}", "received_events_url": "https://api.github.com/users/winmorre/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-12-18T20:50:34Z", "updated_at": "2022-12-31T19:10:06Z", "closed_at": "2022-12-25T13:28:53Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2520", "html_url": "https://github.com/redis/redis-py/pull/2520", "diff_url": "https://github.com/redis/redis-py/pull/2520.diff", "patch_url": "https://github.com/redis/redis-py/pull/2520.patch", "merged_at": "2022-12-25T13:28:53Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [x] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nAdded a fix for Issue #2496 .\r\nIncluded a try/except block to catch this error and set a default \"connection\" for the instance when host is not provided\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2520/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2520/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2513", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2513/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2513/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2513/events", "html_url": "https://github.com/redis/redis-py/issues/2513", "id": 1496367842, "node_id": "I_kwDOAAWKjs5ZMMLi", "number": 2513, "title": "Timeouts when parsing messages in redis/asyncio can corrupt connection", "user": {"login": "kristjanvalur", "id": 6009543, "node_id": "MDQ6VXNlcjYwMDk1NDM=", "avatar_url": "https://avatars.githubusercontent.com/u/6009543?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kristjanvalur", "html_url": "https://github.com/kristjanvalur", "followers_url": "https://api.github.com/users/kristjanvalur/followers", "following_url": "https://api.github.com/users/kristjanvalur/following{/other_user}", "gists_url": "https://api.github.com/users/kristjanvalur/gists{/gist_id}", "starred_url": "https://api.github.com/users/kristjanvalur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kristjanvalur/subscriptions", "organizations_url": "https://api.github.com/users/kristjanvalur/orgs", "repos_url": "https://api.github.com/users/kristjanvalur/repos", "events_url": "https://api.github.com/users/kristjanvalur/events{/privacy}", "received_events_url": "https://api.github.com/users/kristjanvalur/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-12-14T11:08:06Z", "updated_at": "2023-01-08T12:36:36Z", "closed_at": "2023-01-08T12:36:36Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "In pull requests #2295 and #2360 I made significant change on the way timeouts are handled in the async `Connection`, bringing it more in line with regular Python asyncio practices.  In particular, we got rid of the unfortunate `can_read()` function which was a holdover from the synchronous implementation.\r\n\r\nUnfortunately, a problem was introduced:\r\nIf an `asyncio.TimeoutError` was raised during the IO of a message, when using the `PythonParser`, the connection would be left in an unusable state.  This is in constrast to the `HiredisParser`, where IO and parsing are separate.\r\n\r\nThe fix is relatively simple.  `PythonParser` needs to be resumable, if it is interrupted in the middle of parsing a single message.  Two alternative PRs address this:  #2510 and #2512, which differ only in the architectural details of how to achieve this.", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2513/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2513/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2490", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2490/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2490/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2490/events", "html_url": "https://github.com/redis/redis-py/issues/2490", "id": 1480850472, "node_id": "I_kwDOAAWKjs5YQ_wo", "number": 2490, "title": "EVAL_RO, EVALSHA_RO doesn't get routed to replicas", "user": {"login": "zakaf", "id": 3315213, "node_id": "MDQ6VXNlcjMzMTUyMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/3315213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zakaf", "html_url": "https://github.com/zakaf", "followers_url": "https://api.github.com/users/zakaf/followers", "following_url": "https://api.github.com/users/zakaf/following{/other_user}", "gists_url": "https://api.github.com/users/zakaf/gists{/gist_id}", "starred_url": "https://api.github.com/users/zakaf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zakaf/subscriptions", "organizations_url": "https://api.github.com/users/zakaf/orgs", "repos_url": "https://api.github.com/users/zakaf/repos", "events_url": "https://api.github.com/users/zakaf/events{/privacy}", "received_events_url": "https://api.github.com/users/zakaf/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": {"login": "zakaf", "id": 3315213, "node_id": "MDQ6VXNlcjMzMTUyMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/3315213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zakaf", "html_url": "https://github.com/zakaf", "followers_url": "https://api.github.com/users/zakaf/followers", "following_url": "https://api.github.com/users/zakaf/following{/other_user}", "gists_url": "https://api.github.com/users/zakaf/gists{/gist_id}", "starred_url": "https://api.github.com/users/zakaf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zakaf/subscriptions", "organizations_url": "https://api.github.com/users/zakaf/orgs", "repos_url": "https://api.github.com/users/zakaf/repos", "events_url": "https://api.github.com/users/zakaf/events{/privacy}", "received_events_url": "https://api.github.com/users/zakaf/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "zakaf", "id": 3315213, "node_id": "MDQ6VXNlcjMzMTUyMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/3315213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zakaf", "html_url": "https://github.com/zakaf", "followers_url": "https://api.github.com/users/zakaf/followers", "following_url": "https://api.github.com/users/zakaf/following{/other_user}", "gists_url": "https://api.github.com/users/zakaf/gists{/gist_id}", "starred_url": "https://api.github.com/users/zakaf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zakaf/subscriptions", "organizations_url": "https://api.github.com/users/zakaf/orgs", "repos_url": "https://api.github.com/users/zakaf/repos", "events_url": "https://api.github.com/users/zakaf/events{/privacy}", "received_events_url": "https://api.github.com/users/zakaf/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2022-12-07T03:50:54Z", "updated_at": "2022-12-25T14:18:25Z", "closed_at": "2022-12-25T14:18:25Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Thanks for wanting to report an issue you've found in redis-py. Please delete this text and fill in the template below.  \r\nIt is of course not always possible to reduce your code to a small test case, but it's highly appreciated to have as much data as possible. Thank you!\r\n\r\n**Version**: What redis-py and what redis version is the issue happening on?\r\nredis-py 4.4.0, redis 7.0\r\n\r\n**Platform**: What platform / version? (For example Python 3.5.1 on Windows 7 / Ubuntu 15.10 / Azure)\r\npython 3.11.0 on Mac\r\n\r\n**Description**: Description of your issue, stack traces from errors and code that reproduces the issue\r\nCommands like `EVAL_RO` and `EVALSHA_RO` are always directed to the master, even though they can be routed to replicas as they are read-only commands\r\n\r\nI suspect the cause to be READ_COMMANDS missing few read only commands\r\n https://github.com/redis/redis-py/blob/6219574b042a6596b150ca8248441198f01f8c87/redis/commands/cluster.py#L49-L93\r\n\r\nCan i make a PR to add those commands or is there any other rationale that prevents adding EVAL_RO and EVALSHA_RO into READ_COMMANDS?", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2490/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2490/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2488", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2488/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2488/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2488/events", "html_url": "https://github.com/redis/redis-py/issues/2488", "id": 1476935855, "node_id": "I_kwDOAAWKjs5YCECv", "number": 2488, "title": "Unexpected keyword argument 'timeout' when subscribing via Sentinel", "user": {"login": "vivienm", "id": 2743798, "node_id": "MDQ6VXNlcjI3NDM3OTg=", "avatar_url": "https://avatars.githubusercontent.com/u/2743798?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vivienm", "html_url": "https://github.com/vivienm", "followers_url": "https://api.github.com/users/vivienm/followers", "following_url": "https://api.github.com/users/vivienm/following{/other_user}", "gists_url": "https://api.github.com/users/vivienm/gists{/gist_id}", "starred_url": "https://api.github.com/users/vivienm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vivienm/subscriptions", "organizations_url": "https://api.github.com/users/vivienm/orgs", "repos_url": "https://api.github.com/users/vivienm/repos", "events_url": "https://api.github.com/users/vivienm/events{/privacy}", "received_events_url": "https://api.github.com/users/vivienm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 3458819498, "node_id": "LA_kwDOAAWKjs7OKWWq", "url": "https://api.github.com/repos/redis/redis-py/labels/breakingchange", "name": "breakingchange", "color": "038AF9", "default": false, "description": "API or Breaking Change"}], "state": "closed", "locked": false, "assignee": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2022-12-05T16:28:25Z", "updated_at": "2023-01-08T12:39:09Z", "closed_at": "2023-01-08T12:39:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "> **Version**: What redis-py and what redis version is the issue happening on?\r\n\r\nRedis-py version 4.4.0\r\nRedis version 6.2.7\r\n\r\n> **Platform**: What platform / version? (For example Python 3.5.1 on Windows 7 / Ubuntu 15.10 / Azure)\r\n\r\nPython 3.10 on Archlinux\r\n\r\n> **Description**: Description of your issue, stack traces from errors and code that reproduces the issue*\r\n\r\nI have a Redis + Sentinel setup and I'm trying to listen for messages (*full code below*):\r\n\r\n```python\r\nchannel = redis.pubsub()\r\nawait channel.psubscribe(\"foo*\")\r\nasync for msg in channel.listen():\r\n    print(msg)\r\n```\r\n\r\nThis works with redis-py 4.3.5, but fails on version 4.4.0 with an unexpected argument `timeout`.\r\nAlso, this seems to work fine when instantiating a regular Redis client instead of getting one via Sentinel.\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"fail.py\", line 41, in <module>\r\n    main()\r\n  File \"fail.py\", line 37, in main\r\n    asyncio.run(foobar())\r\n  File \"/usr/lib/python3.10/asyncio/runners.py\", line 44, in run\r\n    return loop.run_until_complete(main)\r\n  File \"/usr/lib/python3.10/asyncio/base_events.py\", line 649, in run_until_complete\r\n    return future.result()\r\n  File \"fail.py\", line 32, in foobar\r\n    async for msg in channel.listen():\r\n  File \"virtualenvs/fail/lib/python3.10/site-packages/redis/asyncio/client.py\", line 891, in listen\r\n    response = await self.handle_message(await self.parse_response(block=True))\r\n  File \"virtualenvs/fail/lib/python3.10/site-packages/redis/asyncio/client.py\", line 784, in parse_response\r\n    response = await self._execute(conn, conn.read_response, timeout=read_timeout)\r\n  File \"virtualenvs/fail/lib/python3.10/site-packages/redis/asyncio/client.py\", line 764, in _execute\r\n    return await conn.retry.call_with_retry(\r\n  File \"virtualenvs/fail/lib/python3.10/site-packages/redis/asyncio/retry.py\", line 59, in call_with_retry\r\n    return await do()\r\n  File \"virtualenvs/fail/lib/python3.10/site-packages/redis/asyncio/client.py\", line 765, in <lambda>\r\n    lambda: command(*args, **kwargs),\r\nTypeError: SentinelManagedConnection.read_response() got an unexpected keyword argument 'timeout'\r\n```\r\n\r\n<details>\r\n<summary>Full code (MRE)</summary>\r\n\r\n```python\r\nimport asyncio\r\nimport os\r\n\r\nfrom redis.asyncio import Sentinel\r\n\r\nREDIS_PASSWORD = os.getenv(\"REDIS_PASSWORD\", \"\")\r\nREDIS_DB = int(os.getenv(\"REDIS_DB\", 0))\r\n\r\nSENTINEL_PASSWORD = os.getenv(\"SENTINEL_PASSWORD\", \"\")\r\nSENTINEL_URLS = [\r\n    s.strip() for s in os.getenv(\"SENTINEL_URLS\", \"127.0.0.1:26379\").split(\",\") if s.strip()\r\n]\r\n\r\n\r\nasync def foobar() -> None:\r\n    stnl = Sentinel(\r\n        [s.split(\":\") for s in SENTINEL_URLS],\r\n        sentinel_kwargs={\"password\": SENTINEL_PASSWORD},\r\n        password=REDIS_PASSWORD,\r\n        db=REDIS_DB,\r\n    )\r\n    redis = stnl.master_for(\"mymaster\")\r\n\r\n    # So far so good:\r\n    await redis.set(\"foo\", \"bar\")\r\n    await redis.expire(\"foo\", 10)\r\n    print(\"GET foo:\", await redis.get(\"foo\"))\r\n\r\n    # This is where it fails:\r\n    channel = redis.pubsub()\r\n    await channel.psubscribe(\"foo*\")\r\n    async for msg in channel.listen():\r\n        print(msg)\r\n\r\n\r\ndef main() -> None:\r\n    asyncio.run(foobar())\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    main()\r\n```\r\n</details>", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2488/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2488/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2464", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2464/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2464/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2464/events", "html_url": "https://github.com/redis/redis-py/pull/2464", "id": 1456920109, "node_id": "PR_kwDOAAWKjs5DTZZD", "number": 2464, "title": "Wrong number of arguments for `geosearch` command", "user": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-11-20T14:17:31Z", "updated_at": "2022-12-01T11:16:15Z", "closed_at": "2022-12-01T11:16:14Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2464", "html_url": "https://github.com/redis/redis-py/pull/2464", "diff_url": "https://github.com/redis/redis-py/pull/2464.diff", "patch_url": "https://github.com/redis/redis-py/pull/2464.patch", "merged_at": "2022-12-01T11:16:14Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\nIn the current implementation - if longitude or latitude are 0 `b\"FROMLONLAT\", kwargs[\"longitude\"], kwargs[\"latitude\"]]` will not be added and that will cause an error\r\n\r\nFixes #2462 ", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2464/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2464/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2463", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2463/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2463/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2463/events", "html_url": "https://github.com/redis/redis-py/pull/2463", "id": 1456809443, "node_id": "PR_kwDOAAWKjs5DTDsR", "number": 2463, "title": "Added a replacement for the default cluster node in the event of failure.", "user": {"login": "barshaul", "id": 88437685, "node_id": "MDQ6VXNlcjg4NDM3Njg1", "avatar_url": "https://avatars.githubusercontent.com/u/88437685?v=4", "gravatar_id": "", "url": "https://api.github.com/users/barshaul", "html_url": "https://github.com/barshaul", "followers_url": "https://api.github.com/users/barshaul/followers", "following_url": "https://api.github.com/users/barshaul/following{/other_user}", "gists_url": "https://api.github.com/users/barshaul/gists{/gist_id}", "starred_url": "https://api.github.com/users/barshaul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/barshaul/subscriptions", "organizations_url": "https://api.github.com/users/barshaul/orgs", "repos_url": "https://api.github.com/users/barshaul/repos", "events_url": "https://api.github.com/users/barshaul/events{/privacy}", "received_events_url": "https://api.github.com/users/barshaul/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-11-20T07:58:35Z", "updated_at": "2022-12-01T11:16:33Z", "closed_at": "2022-12-01T11:16:26Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2463", "html_url": "https://github.com/redis/redis-py/pull/2463", "diff_url": "https://github.com/redis/redis-py/pull/2463.diff", "patch_url": "https://github.com/redis/redis-py/pull/2463.patch", "merged_at": "2022-12-01T11:16:26Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [x] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nFor non-key based commands, we choose the default cluster node to execute the command on (for example, PING, CLUSTER NODES, CONFIG, etc..).\r\n\r\nWhen the default node fails, we'll replace it with a new node before retrying the command.\r\nImproves failover handling. \r\n\r\n- Separated AUTH cluster/non-cluster tests", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2463/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2463/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2462", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2462/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2462/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2462/events", "html_url": "https://github.com/redis/redis-py/issues/2462", "id": 1455874701, "node_id": "I_kwDOAAWKjs5WxuKN", "number": 2462, "title": "Wrong number of arguments for 'geosearch' command", "user": {"login": "petru-motrescu", "id": 57093713, "node_id": "MDQ6VXNlcjU3MDkzNzEz", "avatar_url": "https://avatars.githubusercontent.com/u/57093713?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petru-motrescu", "html_url": "https://github.com/petru-motrescu", "followers_url": "https://api.github.com/users/petru-motrescu/followers", "following_url": "https://api.github.com/users/petru-motrescu/following{/other_user}", "gists_url": "https://api.github.com/users/petru-motrescu/gists{/gist_id}", "starred_url": "https://api.github.com/users/petru-motrescu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petru-motrescu/subscriptions", "organizations_url": "https://api.github.com/users/petru-motrescu/orgs", "repos_url": "https://api.github.com/users/petru-motrescu/repos", "events_url": "https://api.github.com/users/petru-motrescu/events{/privacy}", "received_events_url": "https://api.github.com/users/petru-motrescu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": {"login": "shacharPash", "id": 93581407, "node_id": "U_kgDOBZPwXw", "avatar_url": "https://avatars.githubusercontent.com/u/93581407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shacharPash", "html_url": "https://github.com/shacharPash", "followers_url": "https://api.github.com/users/shacharPash/followers", "following_url": "https://api.github.com/users/shacharPash/following{/other_user}", "gists_url": "https://api.github.com/users/shacharPash/gists{/gist_id}", "starred_url": "https://api.github.com/users/shacharPash/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shacharPash/subscriptions", "organizations_url": "https://api.github.com/users/shacharPash/orgs", "repos_url": "https://api.github.com/users/shacharPash/repos", "events_url": "https://api.github.com/users/shacharPash/events{/privacy}", "received_events_url": "https://api.github.com/users/shacharPash/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "shacharPash", "id": 93581407, "node_id": "U_kgDOBZPwXw", "avatar_url": "https://avatars.githubusercontent.com/u/93581407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shacharPash", "html_url": "https://github.com/shacharPash", "followers_url": "https://api.github.com/users/shacharPash/followers", "following_url": "https://api.github.com/users/shacharPash/following{/other_user}", "gists_url": "https://api.github.com/users/shacharPash/gists{/gist_id}", "starred_url": "https://api.github.com/users/shacharPash/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shacharPash/subscriptions", "organizations_url": "https://api.github.com/users/shacharPash/orgs", "repos_url": "https://api.github.com/users/shacharPash/repos", "events_url": "https://api.github.com/users/shacharPash/events{/privacy}", "received_events_url": "https://api.github.com/users/shacharPash/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2022-11-18T21:57:55Z", "updated_at": "2022-12-01T11:16:15Z", "closed_at": "2022-12-01T11:16:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Version**: \r\nredis-py: 4.3.4\r\nRedis: 7.0.5\r\n\r\n**Platform**:\r\nPython 3.9.15 (main, Oct 11 2022, 21:39:54) \r\n[Clang 14.0.0 (clang-1400.0.29.102)] on darwin\r\nMacOS\r\n\r\n**Description**:\r\nPassing 0.0 longitude or latitude to geosearch results in:\r\n`redis.exceptions.ResponseError: wrong number of arguments for 'geosearch' command`\r\n\r\n```\r\ndef main():\r\n    redis = Redis.from_url(url=\"redis://localhost:6379\")\r\n    key = \"theindex\"\r\n    lon: float = 0.0\r\n    lat: float = 1.0\r\n    redis.geoadd(name=key, values=[lon, lat, \"foo\"])\r\n    results = redis.geosearch(name=key, longitude=lon, latitude=lat, radius=1, unit=\"km\")\r\n    print(results)\r\n```\r\n\r\n**Stack trace**:\r\n```\r\npoetry run python playground/bug/main.py\r\nTraceback (most recent call last):\r\n  File \"/Users/petru/PLAY/redis-playground/playground/bug/main.py\", line 22, in <module>\r\n    main()\r\n  File \"/Users/petru/PLAY/redis-playground/playground/bug/main.py\", line 18, in main\r\n    results = redis.geosearch(name=key, longitude=lon, latitude=lat, radius=1, unit=\"km\")\r\n  File \"/.../python3.9/site-packages/redis/commands/core.py\", line 5474, in geosearch\r\n    return self._geosearchgeneric(\r\n  File \"/.../python3.9/site-packages/redis/commands/core.py\", line 5605, in _geosearchgeneric\r\n    return self.execute_command(command, *pieces, **kwargs)\r\n  File \"/.../python3.9/site-packages/redis/client.py\", line 1238, in execute_command\r\n    return conn.retry.call_with_retry(\r\n  File \"/.../python3.9/site-packages/redis/retry.py\", line 46, in call_with_retry\r\n    return do()\r\n  File \"/.../python3.9/site-packages/redis/client.py\", line 1239, in <lambda>\r\n    lambda: self._send_command_parse_response(\r\n  File \"/.../python3.9/site-packages/redis/client.py\", line 1215, in _send_command_parse_response\r\n    return self.parse_response(conn, command_name, **options)\r\n  File \"/.../python3.9/site-packages/redis/client.py\", line 1254, in parse_response\r\n    response = connection.read_response()\r\n  File \"/.../python3.9/site-packages/redis/connection.py\", line 839, in read_response\r\n    raise response\r\nredis.exceptions.ResponseError: wrong number of arguments for 'geosearch' command\r\n```", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2462/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2462/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2459", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2459/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2459/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2459/events", "html_url": "https://github.com/redis/redis-py/pull/2459", "id": 1452915132, "node_id": "PR_kwDOAAWKjs5DF59N", "number": 2459, "title": "Fix Sentinel.execute_command to execute across the entire sentinel cluster ", "user": {"login": "SyedTahaA", "id": 62918944, "node_id": "MDQ6VXNlcjYyOTE4OTQ0", "avatar_url": "https://avatars.githubusercontent.com/u/62918944?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SyedTahaA", "html_url": "https://github.com/SyedTahaA", "followers_url": "https://api.github.com/users/SyedTahaA/followers", "following_url": "https://api.github.com/users/SyedTahaA/following{/other_user}", "gists_url": "https://api.github.com/users/SyedTahaA/gists{/gist_id}", "starred_url": "https://api.github.com/users/SyedTahaA/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SyedTahaA/subscriptions", "organizations_url": "https://api.github.com/users/SyedTahaA/orgs", "repos_url": "https://api.github.com/users/SyedTahaA/repos", "events_url": "https://api.github.com/users/SyedTahaA/events{/privacy}", "received_events_url": "https://api.github.com/users/SyedTahaA/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 3458819498, "node_id": "LA_kwDOAAWKjs7OKWWq", "url": "https://api.github.com/repos/redis/redis-py/labels/breakingchange", "name": "breakingchange", "color": "038AF9", "default": false, "description": "API or Breaking Change"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-11-17T08:22:02Z", "updated_at": "2022-11-21T10:57:30Z", "closed_at": "2022-11-21T10:57:30Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2459", "html_url": "https://github.com/redis/redis-py/pull/2459", "diff_url": "https://github.com/redis/redis-py/pull/2459.diff", "patch_url": "https://github.com/redis/redis-py/pull/2459.patch", "merged_at": "2022-11-21T10:57:30Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [x] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\ncloses: #2458 \r\n\r\nSentinel.execute_command fixed to execute across sentinel cluster when once argument is not given or set to false, or execute on one random sentinel from the cluster if the once argument is true (like the documentation suggests).\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2459/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2459/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2454", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2454/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2454/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2454/events", "html_url": "https://github.com/redis/redis-py/pull/2454", "id": 1445440033, "node_id": "PR_kwDOAAWKjs5Cs66P", "number": 2454, "title": "Async: added 'blocking' argument to call lock method", "user": {"login": "Sibuken", "id": 20418396, "node_id": "MDQ6VXNlcjIwNDE4Mzk2", "avatar_url": "https://avatars.githubusercontent.com/u/20418396?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Sibuken", "html_url": "https://github.com/Sibuken", "followers_url": "https://api.github.com/users/Sibuken/followers", "following_url": "https://api.github.com/users/Sibuken/following{/other_user}", "gists_url": "https://api.github.com/users/Sibuken/gists{/gist_id}", "starred_url": "https://api.github.com/users/Sibuken/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Sibuken/subscriptions", "organizations_url": "https://api.github.com/users/Sibuken/orgs", "repos_url": "https://api.github.com/users/Sibuken/repos", "events_url": "https://api.github.com/users/Sibuken/events{/privacy}", "received_events_url": "https://api.github.com/users/Sibuken/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-11-11T12:58:25Z", "updated_at": "2022-12-01T14:33:47Z", "closed_at": "2022-12-01T14:33:47Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2454", "html_url": "https://github.com/redis/redis-py/pull/2454", "diff_url": "https://github.com/redis/redis-py/pull/2454.diff", "patch_url": "https://github.com/redis/redis-py/pull/2454.patch", "merged_at": "2022-12-01T14:33:47Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\nThis PR fix this issue - https://github.com/redis/redis-py/issues/2453\r\n\r\n\r\n\r\nAdded \"**blocking**\" argument to method **lock** which initializes **Lock** in **RedisCluster** and **Redis**.\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2454/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2454/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2449", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2449/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2449/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2449/events", "html_url": "https://github.com/redis/redis-py/issues/2449", "id": 1441815826, "node_id": "I_kwDOAAWKjs5V8F0S", "number": 2449, "title": "AsyncScript not working in async RedisCluster", "user": {"login": "ttecles", "id": 14053903, "node_id": "MDQ6VXNlcjE0MDUzOTAz", "avatar_url": "https://avatars.githubusercontent.com/u/14053903?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ttecles", "html_url": "https://github.com/ttecles", "followers_url": "https://api.github.com/users/ttecles/followers", "following_url": "https://api.github.com/users/ttecles/following{/other_user}", "gists_url": "https://api.github.com/users/ttecles/gists{/gist_id}", "starred_url": "https://api.github.com/users/ttecles/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ttecles/subscriptions", "organizations_url": "https://api.github.com/users/ttecles/orgs", "repos_url": "https://api.github.com/users/ttecles/repos", "events_url": "https://api.github.com/users/ttecles/events{/privacy}", "received_events_url": "https://api.github.com/users/ttecles/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 4234596657, "node_id": "LA_kwDOAAWKjs78ZtEx", "url": "https://api.github.com/repos/redis/redis-py/labels/async", "name": "async", "color": "183C77", "default": false, "description": ""}, {"id": 4234599783, "node_id": "LA_kwDOAAWKjs78Zt1n", "url": "https://api.github.com/repos/redis/redis-py/labels/cluster", "name": "cluster", "color": "429F9C", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-11-09T10:16:45Z", "updated_at": "2023-02-08T08:18:43Z", "closed_at": "2023-02-08T08:18:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Version**: 4.3.4\r\n**Platform**: Ubuntu 22.04\r\n\r\n**Description**: AsyncScript not working in async RedisCluster but it does work on a synchronous version\r\n\r\n\r\n```python\r\n>>> from redis.asyncio.cluster import RedisCluster\r\n>>> cluster = RedisCluster(host='localhost', port=6379, decode_responses=True, protocol_version=2)\r\n>>> LUA_SCRIPT = '''\r\nif ARGV[2] == redis.call('GET', KEYS[1]) then\r\n    return redis.call('SET', KEYS[1], ARGV[1])\r\nelse\r\n    error(\"key has changed\")\r\nend\r\n'''\r\n>>> cluster.register_script(LUA_SCRIPT)\r\nTraceback (most recent call last):\r\n  File \"/home/joan/.pyenv/versions/3.10.5/lib/python3.10/code.py\", line 90, in runcode\r\n    exec(code, self.locals)\r\n  File \"<input>\", line 1, in <module>\r\n  File \"/home/joan/virtualenvs/product-images/lib/python3.10/site-packages/redis/commands/core.py\", line 5186, in register_script\r\n    return AsyncScript(self, script)\r\n  File \"/home/joan/virtualenvs/product-images/lib/python3.10/site-packages/redis/commands/core.py\", line 4960, in __init__\r\n    encoder = registered_client.connection_pool.get_encoder()\r\nAttributeError: 'RedisCluster' object has no attribute 'connection_pool'\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2449/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2449/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2439", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2439/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2439/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2439/events", "html_url": "https://github.com/redis/redis-py/pull/2439", "id": 1428550458, "node_id": "PR_kwDOAAWKjs5B0Ro_", "number": 2439, "title": "Fix KeyError in async cluster - initialize before execute multi key commands", "user": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 4234596657, "node_id": "LA_kwDOAAWKjs78ZtEx", "url": "https://api.github.com/repos/redis/redis-py/labels/async", "name": "async", "color": "183C77", "default": false, "description": ""}, {"id": 4234599783, "node_id": "LA_kwDOAAWKjs78Zt1n", "url": "https://api.github.com/repos/redis/redis-py/labels/cluster", "name": "cluster", "color": "429F9C", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-10-30T01:58:46Z", "updated_at": "2022-11-21T11:21:46Z", "closed_at": "2022-10-30T07:14:01Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2439", "html_url": "https://github.com/redis/redis-py/pull/2439", "diff_url": "https://github.com/redis/redis-py/pull/2439.diff", "patch_url": "https://github.com/redis/redis-py/pull/2439.patch", "merged_at": "2022-10-30T07:14:01Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nFixes #2437 ", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2439/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2439/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2438", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2438/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2438/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2438/events", "html_url": "https://github.com/redis/redis-py/pull/2438", "id": 1428513261, "node_id": "PR_kwDOAAWKjs5B0Jj0", "number": 2438, "title": "Remove default None value from LMPOP direction argument", "user": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-10-30T00:03:21Z", "updated_at": "2022-10-30T07:48:52Z", "closed_at": "2022-10-30T07:48:51Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2438", "html_url": "https://github.com/redis/redis-py/pull/2438", "diff_url": "https://github.com/redis/redis-py/pull/2438.diff", "patch_url": "https://github.com/redis/redis-py/pull/2438.patch", "merged_at": "2022-10-30T07:48:51Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nFixes #2414 ", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2438/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2438/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2437", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2437/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2437/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2437/events", "html_url": "https://github.com/redis/redis-py/issues/2437", "id": 1427945068, "node_id": "I_kwDOAAWKjs5VHLZs", "number": 2437, "title": "KeyError in asyncio cluster get_node_from_slot", "user": {"login": "sman591", "id": 1441807, "node_id": "MDQ6VXNlcjE0NDE4MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/1441807?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sman591", "html_url": "https://github.com/sman591", "followers_url": "https://api.github.com/users/sman591/followers", "following_url": "https://api.github.com/users/sman591/following{/other_user}", "gists_url": "https://api.github.com/users/sman591/gists{/gist_id}", "starred_url": "https://api.github.com/users/sman591/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sman591/subscriptions", "organizations_url": "https://api.github.com/users/sman591/orgs", "repos_url": "https://api.github.com/users/sman591/repos", "events_url": "https://api.github.com/users/sman591/events{/privacy}", "received_events_url": "https://api.github.com/users/sman591/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 4234596657, "node_id": "LA_kwDOAAWKjs78ZtEx", "url": "https://api.github.com/repos/redis/redis-py/labels/async", "name": "async", "color": "183C77", "default": false, "description": ""}, {"id": 4234599783, "node_id": "LA_kwDOAAWKjs78Zt1n", "url": "https://api.github.com/repos/redis/redis-py/labels/cluster", "name": "cluster", "color": "429F9C", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-10-28T23:13:38Z", "updated_at": "2022-10-30T07:14:02Z", "closed_at": "2022-10-30T07:14:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Version**: 4.3.4\r\n\r\n**Platform**: Python 3.8.10, AWS Elasticache, Redis 6\r\n\r\n**Description**:\r\n\r\nWhen calling `await cluster.delete(key)`, some of our machines will throw a `KeyError` (e.g. `KeyError: 14097`) from this line:\r\n\r\nhttps://github.com/redis/redis-py/blob/bea00b16c8043397c6bb6f3df45d48bceefa685f/redis/asyncio/cluster.py#L1041\r\n\r\nThis isn't consistent, though. We load balance across 3 servers, and only 2 out of the 3 serve this error when it happens.", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2437/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2437/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2416", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2416/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2416/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2416/events", "html_url": "https://github.com/redis/redis-py/pull/2416", "id": 1408157149, "node_id": "PR_kwDOAAWKjs5AwT-m", "number": 2416, "title": "Fix issue with `pack_commands` returning an empty byte sequence", "user": {"login": "jmcbailey", "id": 1998241, "node_id": "MDQ6VXNlcjE5OTgyNDE=", "avatar_url": "https://avatars.githubusercontent.com/u/1998241?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jmcbailey", "html_url": "https://github.com/jmcbailey", "followers_url": "https://api.github.com/users/jmcbailey/followers", "following_url": "https://api.github.com/users/jmcbailey/following{/other_user}", "gists_url": "https://api.github.com/users/jmcbailey/gists{/gist_id}", "starred_url": "https://api.github.com/users/jmcbailey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jmcbailey/subscriptions", "organizations_url": "https://api.github.com/users/jmcbailey/orgs", "repos_url": "https://api.github.com/users/jmcbailey/repos", "events_url": "https://api.github.com/users/jmcbailey/events{/privacy}", "received_events_url": "https://api.github.com/users/jmcbailey/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-10-13T17:10:59Z", "updated_at": "2023-02-07T10:43:37Z", "closed_at": "2023-02-07T10:43:36Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2416", "html_url": "https://github.com/redis/redis-py/pull/2416", "diff_url": "https://github.com/redis/redis-py/pull/2416.diff", "patch_url": "https://github.com/redis/redis-py/pull/2416.patch", "merged_at": "2023-02-07T10:43:36Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nUnder certain circumstances `pack_commands()` adds an empty byte sequence (`b\"\"`) to the returned list, which when connecting to a Redis server over SSL could cause an EOF error:\r\n\r\n```\r\nredis.exceptions.ConnectionError: Error while reading from socket: (8, 'EOF occurred in violation of protocol (_ssl.c:2483)')\r\n```\r\nIn our case we are running an async Falcon application using the `uvicorn` worker type; we ran into the problem when using a Redis pipeline to perform an `MSET` followed by one or more `EXPIRE` commands. The values in the `MSET` are images, generally around 5 to 6kb in size. From what I can see it was certain images within a very specific size range, where the length \r\n of the value was just under 6000, that caused the problem (6000 being the `buffer_cutoff` value used in `pack_commands`).\r\n\r\n(Note that in some/many cases the `b\"\"` doesn't seem to cause a problem; I wrote a simple script to reproduce the error, executing the code in the standard `asyncio` event loop, but couldn't reproduce it that way. It was only by creating a simple Falcon/uvicorn app and executing it within that that I could reproduce it; I guess it's to do with the fact that uvicorn uses `uvloop` instead of the asyncio event loop, and there must be some difference in the underlying SSL transport.)", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2416/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2416/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2412", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2412/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2412/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2412/events", "html_url": "https://github.com/redis/redis-py/pull/2412", "id": 1402137863, "node_id": "PR_kwDOAAWKjs5AcUOQ", "number": 2412, "title": "fix: catch OSError on asyncio", "user": {"login": "hyeongguen-song", "id": 87850472, "node_id": "MDQ6VXNlcjg3ODUwNDcy", "avatar_url": "https://avatars.githubusercontent.com/u/87850472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hyeongguen-song", "html_url": "https://github.com/hyeongguen-song", "followers_url": "https://api.github.com/users/hyeongguen-song/followers", "following_url": "https://api.github.com/users/hyeongguen-song/following{/other_user}", "gists_url": "https://api.github.com/users/hyeongguen-song/gists{/gist_id}", "starred_url": "https://api.github.com/users/hyeongguen-song/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hyeongguen-song/subscriptions", "organizations_url": "https://api.github.com/users/hyeongguen-song/orgs", "repos_url": "https://api.github.com/users/hyeongguen-song/repos", "events_url": "https://api.github.com/users/hyeongguen-song/events{/privacy}", "received_events_url": "https://api.github.com/users/hyeongguen-song/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-10-09T03:40:06Z", "updated_at": "2022-10-25T15:14:38Z", "closed_at": "2022-10-25T15:14:37Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2412", "html_url": "https://github.com/redis/redis-py/pull/2412", "diff_url": "https://github.com/redis/redis-py/pull/2412.diff", "patch_url": "https://github.com/redis/redis-py/pull/2412.patch", "merged_at": "2022-10-25T15:14:37Z"}, "body": "### Pull Request check-list\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n### Description of change\r\nBefore redis-py support asyncio, https://github.com/redis/redis-py/pull/1832 merged to master\r\nhttps://github.com/redis/redis-py/pull/1832#issuecomment-1271556337\r\nSo, asyncio to catch OSError too", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2412/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2412/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2407", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2407/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2407/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2407/events", "html_url": "https://github.com/redis/redis-py/issues/2407", "id": 1397647708, "node_id": "I_kwDOAAWKjs5TTmlc", "number": 2407, "title": "4.4.0rc2: read() called while another coroutine is already waiting for incoming data", "user": {"login": "JonasKs", "id": 5310116, "node_id": "MDQ6VXNlcjUzMTAxMTY=", "avatar_url": "https://avatars.githubusercontent.com/u/5310116?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JonasKs", "html_url": "https://github.com/JonasKs", "followers_url": "https://api.github.com/users/JonasKs/followers", "following_url": "https://api.github.com/users/JonasKs/following{/other_user}", "gists_url": "https://api.github.com/users/JonasKs/gists{/gist_id}", "starred_url": "https://api.github.com/users/JonasKs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JonasKs/subscriptions", "organizations_url": "https://api.github.com/users/JonasKs/orgs", "repos_url": "https://api.github.com/users/JonasKs/repos", "events_url": "https://api.github.com/users/JonasKs/events{/privacy}", "received_events_url": "https://api.github.com/users/JonasKs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 4234596657, "node_id": "LA_kwDOAAWKjs78ZtEx", "url": "https://api.github.com/repos/redis/redis-py/labels/async", "name": "async", "color": "183C77", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2022-10-05T11:32:35Z", "updated_at": "2023-04-23T02:18:15Z", "closed_at": "2022-12-01T09:50:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Version**: [4.4.0rc2](https://github.com/redis/redis-py/releases/tag/v4.4.0rc2)\r\n\r\n**Platform**: MacOS and Windows. Python 3.10.6.\r\n\r\n\r\n**Description**: We've noticed that we are no longer able to `enqueue_job()` with [`arq`](https://github.com/samuelcolvin/arq). All of this **works** in `4.4.0rc1`. \r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"<redacted>\", line <redacted>, in <redacted>\r\n    await redis.enqueue_job(\r\n  File \"<redacted>\", line 137, in enqueue_job\r\n    if any(await asyncio.gather(pipe.exists(job_key), pipe.exists(result_key_prefix + job_id))):\r\n  File \"<redacted>/lib/python3.10/site-packages/redis/asyncio/client.py\", line 1161, in immediate_execute_command\r\n    return await conn.retry.call_with_retry(\r\n  File \"<redacted>lib/python3.10/site-packages/redis/asyncio/retry.py\", line 59, in call_with_retry\r\n    return await do()\r\n  File \"<redacted>lib/python3.10/site-packages/redis/asyncio/client.py\", line 463, in _send_command_parse_response\r\n    return await self.parse_response(conn, command_name, **options)\r\n  File \"<redacted>lib/python3.10/site-packages/redis/asyncio/client.py\", line 1293, in parse_response\r\n    result = await super().parse_response(connection, command_name, **options)\r\n  File \"/<redacted>/lib/python3.10/site-packages/redis/asyncio/client.py\", line 505, in parse_response\r\n    response = await connection.read_response()\r\n  File \"<redacted>/lib/python3.10/site-packages/redis/asyncio/connection.py\", line 886, in read_response\r\n    response = await self._parser.read_response(\r\n  File \"<redacted>/lib/python3.10/site-packages/redis/asyncio/connection.py\", line 468, in read_response\r\n    await self.read_from_socket()\r\n  File \"<redacted>/lib/python3.10/site-packages/redis/asyncio/connection.py\", line 451, in read_from_socket\r\n    buffer = await self._stream.read(self._read_size)\r\n  File \"<redacted>/lib/python3.10/asyncio/streams.py\", line 669, in read\r\n    await self._wait_for_data('read')\r\n  File \"<redacted>lib/python3.10/asyncio/streams.py\", line 488, in _wait_for_data\r\n    raise RuntimeError(\r\nRuntimeError: read() called while another coroutine is already waiting for incoming data\r\n```\r\n\r\nI can try to provide a reproducible example later if you'd like, but that would require `arq` as a dependency. ", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2407/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2407/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2393", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2393/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2393/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2393/events", "html_url": "https://github.com/redis/redis-py/pull/2393", "id": 1380658266, "node_id": "PR_kwDOAAWKjs4_VmG_", "number": 2393, "title": "FT.SEARCH: Fixing aggregation request argument for LIMIT", "user": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-09-21T09:57:43Z", "updated_at": "2022-10-16T21:24:18Z", "closed_at": "2022-09-29T10:51:37Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2393", "html_url": "https://github.com/redis/redis-py/pull/2393", "diff_url": "https://github.com/redis/redis-py/pull/2393.diff", "patch_url": "https://github.com/redis/redis-py/pull/2393.patch", "merged_at": "2022-09-29T10:51:37Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nfixes #2383", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2393/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2393/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2383", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2383/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2383/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2383/events", "html_url": "https://github.com/redis/redis-py/issues/2383", "id": 1373225999, "node_id": "I_kwDOAAWKjs5R2cQP", "number": 2383, "title": "[Bug] Aggregation Request Generates Incorrect Command Arguments for LIMIT ", "user": {"login": "lgnashold", "id": 6507815, "node_id": "MDQ6VXNlcjY1MDc4MTU=", "avatar_url": "https://avatars.githubusercontent.com/u/6507815?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lgnashold", "html_url": "https://github.com/lgnashold", "followers_url": "https://api.github.com/users/lgnashold/followers", "following_url": "https://api.github.com/users/lgnashold/following{/other_user}", "gists_url": "https://api.github.com/users/lgnashold/gists{/gist_id}", "starred_url": "https://api.github.com/users/lgnashold/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lgnashold/subscriptions", "organizations_url": "https://api.github.com/users/lgnashold/orgs", "repos_url": "https://api.github.com/users/lgnashold/repos", "events_url": "https://api.github.com/users/lgnashold/events{/privacy}", "received_events_url": "https://api.github.com/users/lgnashold/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-09-14T15:52:26Z", "updated_at": "2022-09-29T10:51:38Z", "closed_at": "2022-09-29T10:51:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Version**: redis-py 4.3.4, Redis 7.0 \r\n\r\n**Platform**: Python 3.8 Ubuntu \r\n\r\n**Description**: \r\nOn the current master branch, it says in comments that if limit is applied before group by, it will apply the limit to the initial query. If it is applied after group by, it will be applied to the result of the aggregation. Based on the example, you can also specify a limit at multiple stages in the pipeline. However, in practice, the limit is only set on the last stage of the aggregation. \r\n\r\nFor example, given the following code on a very large database\r\n```\r\nAggregateRequest(\"*\").limit(0, 100).group_by('@my_field', reducers.count()).limit(0, 1000)\r\n```\r\nYou would expect at most 100 results to be returned, since the first limit should limit the amount of rows the aggregation request queries initially. However, 1000 results are returned, and based on runtime, the original query isn't limited at all. \r\n\r\n**Why it happens**:\r\nThis happens because `AggregateRequest` generates an incorrect list of arguments for LIMIT. Given the above query, you would expect the following arguments to be generated: \r\n```\r\n['LIMIT', '0', '100', 'GROUPBY', '1', '@future_type', 'REDUCE', 'COUNT', '0', 'LIMIT', '0, '1000']\r\n```\r\nI have checked that running FT Aggregate with the above command produces the expected result. However, the arguments that are actually generated are \r\n```\r\n['*', 'GROUPBY', '1', '@future_type', 'REDUCE', 'COUNT', '0', 'LIMIT', '0', '1000']\r\n```\r\nNote that there is only one limit in the arguments. The reason incorrect arguments are generated is because when we call `.limit()` on an AggregationRequest, it **overwrites** any limit previously set (at [this location](https://github.com/redis/redis-py/blob/master/redis/commands/search/aggregation.py#L214)). Furthermore, when we generate the arguments, we always append the `LIMIT` argument to the end of the query (line 326). The expected behavior would be to insert the command arguments for LIMIT in corresponding location in the aggregation request. \r\n\r\n**Fix Suggestion**:\r\nI'm no expert in redis-py, but after looking at the code, I believe we would want to replace line 214 in aggregations.py: \r\n```\r\n        self._limit = Limit(offset, num)\r\n```\r\nwith the following: \r\n```\r\n_limit = Limit(offset, num)\r\nself._aggregateplan.extend(_limit.build_args())\r\n```\r\nAnd remove lines 107 and 326. \r\n\r\n**I believe at minimum, the documentation should be updated so that it reflects the current incorrect behavior**", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2383/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2383/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2377", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2377/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2377/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2377/events", "html_url": "https://github.com/redis/redis-py/pull/2377", "id": 1368690500, "node_id": "PR_kwDOAAWKjs4-uNRK", "number": 2377, "title": "Failover handling improvements for RedisCluster and Async RedisCluster", "user": {"login": "barshaul", "id": 88437685, "node_id": "MDQ6VXNlcjg4NDM3Njg1", "avatar_url": "https://avatars.githubusercontent.com/u/88437685?v=4", "gravatar_id": "", "url": "https://api.github.com/users/barshaul", "html_url": "https://github.com/barshaul", "followers_url": "https://api.github.com/users/barshaul/followers", "following_url": "https://api.github.com/users/barshaul/following{/other_user}", "gists_url": "https://api.github.com/users/barshaul/gists{/gist_id}", "starred_url": "https://api.github.com/users/barshaul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/barshaul/subscriptions", "organizations_url": "https://api.github.com/users/barshaul/orgs", "repos_url": "https://api.github.com/users/barshaul/repos", "events_url": "https://api.github.com/users/barshaul/events{/privacy}", "received_events_url": "https://api.github.com/users/barshaul/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-09-10T17:54:58Z", "updated_at": "2022-11-10T11:16:50Z", "closed_at": "2022-11-10T11:16:49Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2377", "html_url": "https://github.com/redis/redis-py/pull/2377", "diff_url": "https://github.com/redis/redis-py/pull/2377.diff", "patch_url": "https://github.com/redis/redis-py/pull/2377.patch", "merged_at": "2022-11-10T11:16:49Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [x] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [x] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\n\r\n### Failover handling improvements for RedisCluster and Async RedisCluster\r\n1. **Handle cluster connection errors in the retry object** -Removed handling of timeouts/connection errors within the cluster loop to reduce retries duplication with Retry objects and enable backoff strategies. Each cluster node will share the cluster's Retry object for retry and backoff policy. \r\n2. **Fixed \"cannot pickle '_thread.lock' object\" bug**- When we use NodesManager's initialize function to refresh the cluster topology after a failover, if the chosen startup node was the failed node, we received the above exception when trying to copy the connection kwargs (traceback at the end), and this error was raised to the user since it was not expected. It caused the initialize loop to get stuck on the failed node and not continue. Removed the copy of kwargs as it no longer needed since we call str_if_bytes on the conncetion's responses. We now throw exceptions in the initialize() loop only if there are no more startup nodes available. Closing #2354 #2297 \r\n3. **Removing the failed target node from the seed nodes when connection/timeout errors occur:** the failed target node will return to the startup nodes if discovered on the cluster slots, but we'll skip it in this initialize iteration.\r\n4.  **Backwards comparability for connection_error_retry_attempts** - connection_error_retry_attempts can still be used to pass the number of retries to execute on connection/timeout error. If connection_error_retry_attempts = 0 and retry object isn't being passed, no retries will be done on connecton/timeout errors for the cluster.\r\n\r\n```\r\nTraceback (most recent call last):   File \"/home/ubuntu/redis-py/redis/cluster.py\", line 1424, in initialize\r\n\r\n    copy_kwargs = copy.deepcopy(kwargs)\r\n\r\n  File \"/usr/lib/python3.10/copy.py\", line 146, in deepcopy\r\n\r\n    y = copier(x, memo)\r\n\r\n...\r\n  File \"/usr/lib/python3.10/copy.py\", line 146, in deepcopy\r\n\r\n    y = copier(x, memo)\r\n\r\n  File \"/usr/lib/python3.10/copy.py\", line 231, in _deepcopy_dict\r\n\r\n    y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n\r\n  File \"/usr/lib/python3.10/copy.py\", line 161, in deepcopy\r\n\r\n    rv = reductor(4)\r\n\r\nTypeError: cannot pickle '_thread.lock' object\r\n```", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2377/reactions", "total_count": 6, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 3, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2377/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2364", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2364/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2364/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2364/events", "html_url": "https://github.com/redis/redis-py/pull/2364", "id": 1357156277, "node_id": "PR_kwDOAAWKjs4-Hzsf", "number": 2364, "title": "Change return type of parse_boolean from int to bool", "user": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-08-31T10:49:13Z", "updated_at": "2022-09-07T10:27:15Z", "closed_at": "2022-09-04T07:53:01Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2364", "html_url": "https://github.com/redis/redis-py/pull/2364", "diff_url": "https://github.com/redis/redis-py/pull/2364.diff", "patch_url": "https://github.com/redis/redis-py/pull/2364.patch", "merged_at": "2022-09-04T07:53:01Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nsee https://github.com/redis/redis-py/pull/2273/files#r959299575", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2364/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2364/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2349", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2349/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2349/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2349/events", "html_url": "https://github.com/redis/redis-py/issues/2349", "id": 1345433055, "node_id": "I_kwDOAAWKjs5QMa3f", "number": 2349, "title": "AttributeError: 'NoneType' object has no attribute 'feed' (possibly race condition on async disconnect)", "user": {"login": "bentheiii", "id": 13264001, "node_id": "MDQ6VXNlcjEzMjY0MDAx", "avatar_url": "https://avatars.githubusercontent.com/u/13264001?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bentheiii", "html_url": "https://github.com/bentheiii", "followers_url": "https://api.github.com/users/bentheiii/followers", "following_url": "https://api.github.com/users/bentheiii/following{/other_user}", "gists_url": "https://api.github.com/users/bentheiii/gists{/gist_id}", "starred_url": "https://api.github.com/users/bentheiii/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bentheiii/subscriptions", "organizations_url": "https://api.github.com/users/bentheiii/orgs", "repos_url": "https://api.github.com/users/bentheiii/repos", "events_url": "https://api.github.com/users/bentheiii/events{/privacy}", "received_events_url": "https://api.github.com/users/bentheiii/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2022-08-21T09:18:56Z", "updated_at": "2023-02-06T19:25:41Z", "closed_at": "2023-02-06T19:25:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Version**: 4.3.4\r\n**Platform**: python 3.8.13 on azure\r\n\r\n**Description**: unfortunately I have not been able to replicate this error locally, I'm guessing it's a bizarre race condition (possibly an async resurgence of #732)\r\n\r\n```\r\nAttributeError: 'NoneType' object has no attribute 'feed'\r\n  File \"***\", line **\r\n    await pipeline.execute()\r\n  File \"redis/asyncio/client.py\", line 1352, in execute\r\n    return await conn.retry.call_with_retry(\r\n  File \"redis/asyncio/retry.py\", line 59, in call_with_retry\r\n    return await do()\r\n  File \"redis/asyncio/client.py\", line 1266, in _execute_pipeline\r\n    await self.parse_response(connection, args[0], **options)\r\n  File \"redis/asyncio/client.py\", line 1291, in parse_response\r\n    result = await super().parse_response(connection, command_name, **options)\r\n  File \"redis/asyncio/client.py\", line 505, in parse_response\r\n    response = await connection.read_response()\r\n  File \"redis/asyncio/connection.py\", line 931, in read_response\r\n    response = await self._parser.read_response(\r\n  File \"redis/asyncio/connection.py\", line 526, in read_response\r\n    await self.read_from_socket()\r\n  File \"redis/asyncio/connection.py\", line 491, in read_from_socket\r\n    self._reader.feed(buffer)\r\n```", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2349/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2349/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2343", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2343/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2343/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2343/events", "html_url": "https://github.com/redis/redis-py/pull/2343", "id": 1344082970, "node_id": "PR_kwDOAAWKjs49cYs9", "number": 2343, "title": "Be more strict about url scheme parsing", "user": {"login": "vanschelven", "id": 223833, "node_id": "MDQ6VXNlcjIyMzgzMw==", "avatar_url": "https://avatars.githubusercontent.com/u/223833?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vanschelven", "html_url": "https://github.com/vanschelven", "followers_url": "https://api.github.com/users/vanschelven/followers", "following_url": "https://api.github.com/users/vanschelven/following{/other_user}", "gists_url": "https://api.github.com/users/vanschelven/gists{/gist_id}", "starred_url": "https://api.github.com/users/vanschelven/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vanschelven/subscriptions", "organizations_url": "https://api.github.com/users/vanschelven/orgs", "repos_url": "https://api.github.com/users/vanschelven/repos", "events_url": "https://api.github.com/users/vanschelven/events{/privacy}", "received_events_url": "https://api.github.com/users/vanschelven/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-08-19T07:53:51Z", "updated_at": "2022-09-29T13:29:05Z", "closed_at": "2022-08-21T10:46:32Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2343", "html_url": "https://github.com/redis/redis-py/pull/2343", "diff_url": "https://github.com/redis/redis-py/pull/2343.diff", "patch_url": "https://github.com/redis/redis-py/pull/2343.patch", "merged_at": "2022-08-21T10:46:32Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nThe error message implied that urls had to start with `scheme://`.\r\nHowever, if the double slash was left out, the url parsed just fine\r\nand the part that was ostensibly intended to be the hostname ended\r\nup as part of the path, whereas the default (localhost) would be\r\nused for the hostname. This commit makes the check as strict as the\r\nerror message implies by including a check for the double slash.", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2343/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2343/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2316", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2316/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2316/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2316/events", "html_url": "https://github.com/redis/redis-py/pull/2316", "id": 1325632458, "node_id": "PR_kwDOAAWKjs48fm3-", "number": 2316, "title": "Fix async SEARCH pipeline", "user": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 4234596657, "node_id": "LA_kwDOAAWKjs78ZtEx", "url": "https://api.github.com/repos/redis/redis-py/labels/async", "name": "async", "color": "183C77", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-08-02T10:18:53Z", "updated_at": "2022-08-02T14:45:08Z", "closed_at": "2022-08-02T14:45:07Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2316", "html_url": "https://github.com/redis/redis-py/pull/2316", "diff_url": "https://github.com/redis/redis-py/pull/2316.diff", "patch_url": "https://github.com/redis/redis-py/pull/2316.patch", "merged_at": "2022-08-02T14:45:07Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nFixes #2279", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2316/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2316/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2315", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2315/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2315/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2315/events", "html_url": "https://github.com/redis/redis-py/pull/2315", "id": 1325468504, "node_id": "PR_kwDOAAWKjs48fDVY", "number": 2315, "title": "Change `dropindex()` to use `FT.DROPINDEX` (instead `FT.DROP`)", "user": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 3458819498, "node_id": "LA_kwDOAAWKjs7OKWWq", "url": "https://api.github.com/repos/redis/redis-py/labels/breakingchange", "name": "breakingchange", "color": "038AF9", "default": false, "description": "API or Breaking Change"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-08-02T08:21:28Z", "updated_at": "2022-08-02T14:44:57Z", "closed_at": "2022-08-02T14:44:57Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2315", "html_url": "https://github.com/redis/redis-py/pull/2315", "diff_url": "https://github.com/redis/redis-py/pull/2315.diff", "patch_url": "https://github.com/redis/redis-py/pull/2315.patch", "merged_at": "2022-08-02T14:44:57Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nFixes #2265 ", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2315/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2315/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2302", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2302/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2302/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2302/events", "html_url": "https://github.com/redis/redis-py/pull/2302", "id": 1316768630, "node_id": "PR_kwDOAAWKjs48CWZ9", "number": 2302, "title": "Fix special response parsing options handling", "user": {"login": "fadida", "id": 7628418, "node_id": "MDQ6VXNlcjc2Mjg0MTg=", "avatar_url": "https://avatars.githubusercontent.com/u/7628418?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fadida", "html_url": "https://github.com/fadida", "followers_url": "https://api.github.com/users/fadida/followers", "following_url": "https://api.github.com/users/fadida/following{/other_user}", "gists_url": "https://api.github.com/users/fadida/gists{/gist_id}", "starred_url": "https://api.github.com/users/fadida/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fadida/subscriptions", "organizations_url": "https://api.github.com/users/fadida/orgs", "repos_url": "https://api.github.com/users/fadida/repos", "events_url": "https://api.github.com/users/fadida/events{/privacy}", "received_events_url": "https://api.github.com/users/fadida/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-07-25T12:30:06Z", "updated_at": "2022-11-09T12:22:27Z", "closed_at": "2022-11-09T12:22:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2302", "html_url": "https://github.com/redis/redis-py/pull/2302", "diff_url": "https://github.com/redis/redis-py/pull/2302.diff", "patch_url": "https://github.com/redis/redis-py/pull/2302.patch", "merged_at": "2022-11-09T12:22:27Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\nSuggested fix for #2113\r\n\r\nWhen using special response parsing options like `NEVER_DECODE` and\r\n`EMPTY_RESPONSE`, don't pass them to the response callbacks because some\r\nof them are not prepared for receiving named arguments.\r\n\r\nInstead, redis-py should use them before calling the callbacks and then discard them.\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2302/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2302/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2281", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2281/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2281/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2281/events", "html_url": "https://github.com/redis/redis-py/pull/2281", "id": 1307055311, "node_id": "PR_kwDOAAWKjs47hZvZ", "number": 2281, "title": "automatically reconnect pubsub when reading messages in blocking mode", "user": {"login": "kristjanvalur", "id": 6009543, "node_id": "MDQ6VXNlcjYwMDk1NDM=", "avatar_url": "https://avatars.githubusercontent.com/u/6009543?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kristjanvalur", "html_url": "https://github.com/kristjanvalur", "followers_url": "https://api.github.com/users/kristjanvalur/followers", "following_url": "https://api.github.com/users/kristjanvalur/following{/other_user}", "gists_url": "https://api.github.com/users/kristjanvalur/gists{/gist_id}", "starred_url": "https://api.github.com/users/kristjanvalur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kristjanvalur/subscriptions", "organizations_url": "https://api.github.com/users/kristjanvalur/orgs", "repos_url": "https://api.github.com/users/kristjanvalur/repos", "events_url": "https://api.github.com/users/kristjanvalur/events{/privacy}", "received_events_url": "https://api.github.com/users/kristjanvalur/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-07-17T10:26:21Z", "updated_at": "2022-08-29T09:13:15Z", "closed_at": "2022-07-27T16:21:26Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2281", "html_url": "https://github.com/redis/redis-py/pull/2281", "diff_url": "https://github.com/redis/redis-py/pull/2281.diff", "patch_url": "https://github.com/redis/redis-py/pull/2281.patch", "merged_at": "2022-07-27T16:21:26Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nIssue #2089 demonstrates how a pub-sub connection doesn't automatically reconnect.  Further investigation showed that this was due to the fact that the `connection` only performed a just-in-time connect in the `can_read()` method, which is only invoked if the operation to read a message has a _timeout_.  In particular, using `listen()` to get the message, instead of the `get_message()` with a timeout, the `can_read()` method isn't called, and so a `connect()` call is not made.\r\n\r\nThis issue is present in both non-async and async versions of the library as demonstrated with the unit-test code.\r\n\r\nThe PR fixes this by adding a just-in-time connect to the `read_response` call of both the `Connection` object.", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2281/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2281/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2280", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2280/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2280/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2280/events", "html_url": "https://github.com/redis/redis-py/pull/2280", "id": 1305974571, "node_id": "PR_kwDOAAWKjs47d8Eq", "number": 2280, "title": "async_cluster: fix concurrent pipeline", "user": {"login": "utkarshgupta137", "id": 5155100, "node_id": "MDQ6VXNlcjUxNTUxMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5155100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/utkarshgupta137", "html_url": "https://github.com/utkarshgupta137", "followers_url": "https://api.github.com/users/utkarshgupta137/followers", "following_url": "https://api.github.com/users/utkarshgupta137/following{/other_user}", "gists_url": "https://api.github.com/users/utkarshgupta137/gists{/gist_id}", "starred_url": "https://api.github.com/users/utkarshgupta137/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/utkarshgupta137/subscriptions", "organizations_url": "https://api.github.com/users/utkarshgupta137/orgs", "repos_url": "https://api.github.com/users/utkarshgupta137/repos", "events_url": "https://api.github.com/users/utkarshgupta137/events{/privacy}", "received_events_url": "https://api.github.com/users/utkarshgupta137/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 4234596657, "node_id": "LA_kwDOAAWKjs78ZtEx", "url": "https://api.github.com/repos/redis/redis-py/labels/async", "name": "async", "color": "183C77", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-07-15T12:24:09Z", "updated_at": "2022-12-01T08:35:08Z", "closed_at": "2022-07-24T12:35:02Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2280", "html_url": "https://github.com/redis/redis-py/pull/2280", "diff_url": "https://github.com/redis/redis-py/pull/2280.diff", "patch_url": "https://github.com/redis/redis-py/pull/2280.patch", "merged_at": "2022-07-24T12:35:02Z"}, "body": "### Pull Request check-list\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n### Description of change\r\n\r\n- each pipeline should create separate stacks for each node", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2280/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2280/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2278", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2278/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2278/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2278/events", "html_url": "https://github.com/redis/redis-py/pull/2278", "id": 1304894595, "node_id": "PR_kwDOAAWKjs47aYyt", "number": 2278, "title": "Fix async connection.is_connected to return a boolean value", "user": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-07-14T14:45:20Z", "updated_at": "2022-07-21T12:17:15Z", "closed_at": "2022-07-21T12:17:14Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2278", "html_url": "https://github.com/redis/redis-py/pull/2278", "diff_url": "https://github.com/redis/redis-py/pull/2278.diff", "patch_url": "https://github.com/redis/redis-py/pull/2278.patch", "merged_at": "2022-07-21T12:17:14Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nfixes #2276 ", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2278/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2278/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2270", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2270/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2270/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2270/events", "html_url": "https://github.com/redis/redis-py/pull/2270", "id": 1300334811, "node_id": "PR_kwDOAAWKjs47LIWP", "number": 2270, "title": "Fix crash: key expire while search", "user": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-07-11T07:45:37Z", "updated_at": "2022-07-24T12:33:43Z", "closed_at": "2022-07-24T12:33:43Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2270", "html_url": "https://github.com/redis/redis-py/pull/2270", "diff_url": "https://github.com/redis/redis-py/pull/2270.diff", "patch_url": "https://github.com/redis/redis-py/pull/2270.patch", "merged_at": "2022-07-24T12:33:43Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nSee the expected behaviour when hash expiry time is reached after the start of the query process here:\r\nhttps://redis.io/commands/ft.search/#return (in the current behaviour it crashes)", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2270/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2270/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2265", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2265/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2265/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2265/events", "html_url": "https://github.com/redis/redis-py/issues/2265", "id": 1295893647, "node_id": "I_kwDOAAWKjs5NPcSP", "number": 2265, "title": "ft.dropindex() crashes server", "user": {"login": "svaraborut", "id": 27013509, "node_id": "MDQ6VXNlcjI3MDEzNTA5", "avatar_url": "https://avatars.githubusercontent.com/u/27013509?v=4", "gravatar_id": "", "url": "https://api.github.com/users/svaraborut", "html_url": "https://github.com/svaraborut", "followers_url": "https://api.github.com/users/svaraborut/followers", "following_url": "https://api.github.com/users/svaraborut/following{/other_user}", "gists_url": "https://api.github.com/users/svaraborut/gists{/gist_id}", "starred_url": "https://api.github.com/users/svaraborut/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/svaraborut/subscriptions", "organizations_url": "https://api.github.com/users/svaraborut/orgs", "repos_url": "https://api.github.com/users/svaraborut/repos", "events_url": "https://api.github.com/users/svaraborut/events{/privacy}", "received_events_url": "https://api.github.com/users/svaraborut/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 3458819498, "node_id": "LA_kwDOAAWKjs7OKWWq", "url": "https://api.github.com/repos/redis/redis-py/labels/breakingchange", "name": "breakingchange", "color": "038AF9", "default": false, "description": "API or Breaking Change"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-07-06T14:04:15Z", "updated_at": "2022-08-02T14:44:58Z", "closed_at": "2022-08-02T14:44:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, I'm using version `4.3.4` and found out that `dropindex()` crashes the server when the index is not present. [Related to](https://github.com/RediSearch/RediSearch/issues/2152)\r\n\r\nWhat is more interesting is why is the library using an undocumented `FT.DROP`  command [see](https://github.com/redis/redis-py/blob/ae83d40384665e2533d2f181981f991a45f58555/redis/commands/search/commands.py#L22) rather than using `FT.DROPINDEX` which does not crash the server?", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2265/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2265/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2259", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2259/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2259/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2259/events", "html_url": "https://github.com/redis/redis-py/pull/2259", "id": 1287658555, "node_id": "PR_kwDOAAWKjs46g01R", "number": 2259, "title": "fix: workaround asyncio bug on connection reset by peer", "user": {"login": "sileht", "id": 200878, "node_id": "MDQ6VXNlcjIwMDg3OA==", "avatar_url": "https://avatars.githubusercontent.com/u/200878?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sileht", "html_url": "https://github.com/sileht", "followers_url": "https://api.github.com/users/sileht/followers", "following_url": "https://api.github.com/users/sileht/following{/other_user}", "gists_url": "https://api.github.com/users/sileht/gists{/gist_id}", "starred_url": "https://api.github.com/users/sileht/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sileht/subscriptions", "organizations_url": "https://api.github.com/users/sileht/orgs", "repos_url": "https://api.github.com/users/sileht/repos", "events_url": "https://api.github.com/users/sileht/events{/privacy}", "received_events_url": "https://api.github.com/users/sileht/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 4234596657, "node_id": "LA_kwDOAAWKjs78ZtEx", "url": "https://api.github.com/repos/redis/redis-py/labels/async", "name": "async", "color": "183C77", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2022-06-28T17:18:27Z", "updated_at": "2023-03-19T21:25:30Z", "closed_at": "2022-07-24T12:33:10Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2259", "html_url": "https://github.com/redis/redis-py/pull/2259", "diff_url": "https://github.com/redis/redis-py/pull/2259.diff", "patch_url": "https://github.com/redis/redis-py/pull/2259.patch", "merged_at": "2022-07-24T12:33:10Z"}, "body": "### Pull Request check-list\n\n_Please make sure to review and check all of these items:_\n\n- [X] Does `$ tox` pass with this change (including linting)?\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\n- [x] Is the new or changed code fully tested?\n- [x] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\n- [x] Is there an example added to the examples folder (if applicable)?\n- [x] Was the change added to CHANGES file?\n\n### Description of change\n\nfix: workaround asyncio bug on connection reset by peer\n\nFixes #2237", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2259/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2259/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2254", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2254/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2254/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2254/events", "html_url": "https://github.com/redis/redis-py/pull/2254", "id": 1285648838, "node_id": "PR_kwDOAAWKjs46aHZ6", "number": 2254, "title": "Fix backward compatibility from 4.3.2 in Lock.acquire()", "user": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 3458819498, "node_id": "LA_kwDOAAWKjs7OKWWq", "url": "https://api.github.com/repos/redis/redis-py/labels/breakingchange", "name": "breakingchange", "color": "038AF9", "default": false, "description": "API or Breaking Change"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-06-27T11:16:51Z", "updated_at": "2022-06-27T12:32:17Z", "closed_at": "2022-06-27T12:32:16Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2254", "html_url": "https://github.com/redis/redis-py/pull/2254", "diff_url": "https://github.com/redis/redis-py/pull/2254.diff", "patch_url": "https://github.com/redis/redis-py/pull/2254.patch", "merged_at": "2022-06-27T12:32:16Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\ncloses #2218\r\ncloses #2223", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2254/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2254/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2252", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2252/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2252/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2252/events", "html_url": "https://github.com/redis/redis-py/pull/2252", "id": 1285506110, "node_id": "PR_kwDOAAWKjs46Zo5W", "number": 2252, "title": "Fix `XAUTOCLAIM` to return the full response", "user": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 3458819498, "node_id": "LA_kwDOAAWKjs7OKWWq", "url": "https://api.github.com/repos/redis/redis-py/labels/breakingchange", "name": "breakingchange", "color": "038AF9", "default": false, "description": "API or Breaking Change"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-06-27T09:21:09Z", "updated_at": "2022-06-27T12:05:06Z", "closed_at": "2022-06-27T12:05:06Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2252", "html_url": "https://github.com/redis/redis-py/pull/2252", "diff_url": "https://github.com/redis/redis-py/pull/2252.diff", "patch_url": "https://github.com/redis/redis-py/pull/2252.patch", "merged_at": "2022-06-27T12:05:05Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nFixes #2226 ", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2252/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2252/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2236", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2236/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2236/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2236/events", "html_url": "https://github.com/redis/redis-py/pull/2236", "id": 1273478391, "node_id": "PR_kwDOAAWKjs45xZqO", "number": 2236, "title": "Uppercase commands in CommandsParser.get_keys", "user": {"login": "falk-h", "id": 14019046, "node_id": "MDQ6VXNlcjE0MDE5MDQ2", "avatar_url": "https://avatars.githubusercontent.com/u/14019046?v=4", "gravatar_id": "", "url": "https://api.github.com/users/falk-h", "html_url": "https://github.com/falk-h", "followers_url": "https://api.github.com/users/falk-h/followers", "following_url": "https://api.github.com/users/falk-h/following{/other_user}", "gists_url": "https://api.github.com/users/falk-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/falk-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/falk-h/subscriptions", "organizations_url": "https://api.github.com/users/falk-h/orgs", "repos_url": "https://api.github.com/users/falk-h/repos", "events_url": "https://api.github.com/users/falk-h/events{/privacy}", "received_events_url": "https://api.github.com/users/falk-h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 4234596657, "node_id": "LA_kwDOAAWKjs78ZtEx", "url": "https://api.github.com/repos/redis/redis-py/labels/async", "name": "async", "color": "183C77", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-06-16T12:11:26Z", "updated_at": "2022-06-19T01:37:12Z", "closed_at": "2022-06-19T01:37:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2236", "html_url": "https://github.com/redis/redis-py/pull/2236", "diff_url": "https://github.com/redis/redis-py/pull/2236.diff", "patch_url": "https://github.com/redis/redis-py/pull/2236.patch", "merged_at": "2022-06-19T01:37:12Z"}, "body": "### Pull Request check-list\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [x] Was the change added to CHANGES file?\r\n\r\nI haven't been able to get `tox` to pass locally. I'm unsure what the problem is, but it seems like it's related to `uvloop`. I'm sure it's just a problem with my dev environment as everything passes in CI.\r\n\r\n### Description of change\r\n\r\nI ran into issues when migrating from the blocking `RedisCluster` to `asyncio.RedisCluster` where `asyncio.CommandsParser.get_keys` would raise errors about commands not existing, even though everything worked with the blocking client. Passing the commands to `asyncio.RedisCluster.execute_command` as uppercase strings fixed the problem.\r\n\r\nThis change makes sure that commands passed to `asyncio.CommandsParser.get_keys` are always uppercased when used with the `self.commands` dict. This behavior is consistent with the blocking client. I thought that the commands maybe should be uppercased before being passed to `get_keys` but I haven't been able to find any code that looks like it does that. For reference, I was using commands from a proprietary Redis module.", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2236/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2236/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2231", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2231/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2231/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2231/events", "html_url": "https://github.com/redis/redis-py/pull/2231", "id": 1271133460, "node_id": "PR_kwDOAAWKjs45ppQY", "number": 2231, "title": "async_cluster: fix simultaneous initialize", "user": {"login": "utkarshgupta137", "id": 5155100, "node_id": "MDQ6VXNlcjUxNTUxMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5155100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/utkarshgupta137", "html_url": "https://github.com/utkarshgupta137", "followers_url": "https://api.github.com/users/utkarshgupta137/followers", "following_url": "https://api.github.com/users/utkarshgupta137/following{/other_user}", "gists_url": "https://api.github.com/users/utkarshgupta137/gists{/gist_id}", "starred_url": "https://api.github.com/users/utkarshgupta137/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/utkarshgupta137/subscriptions", "organizations_url": "https://api.github.com/users/utkarshgupta137/orgs", "repos_url": "https://api.github.com/users/utkarshgupta137/repos", "events_url": "https://api.github.com/users/utkarshgupta137/events{/privacy}", "received_events_url": "https://api.github.com/users/utkarshgupta137/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 4234596657, "node_id": "LA_kwDOAAWKjs78ZtEx", "url": "https://api.github.com/repos/redis/redis-py/labels/async", "name": "async", "color": "183C77", "default": false, "description": ""}, {"id": 4234599783, "node_id": "LA_kwDOAAWKjs78Zt1n", "url": "https://api.github.com/repos/redis/redis-py/labels/cluster", "name": "cluster", "color": "429F9C", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-06-14T17:35:36Z", "updated_at": "2022-12-01T08:35:07Z", "closed_at": "2022-06-19T01:46:02Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2231", "html_url": "https://github.com/redis/redis-py/pull/2231", "diff_url": "https://github.com/redis/redis-py/pull/2231.diff", "patch_url": "https://github.com/redis/redis-py/pull/2231.patch", "merged_at": "2022-06-19T01:46:02Z"}, "body": "### Pull Request check-list\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n### Description of change\r\n\r\n`_initialize` should be set to True only after the initialization is complete. Otherwise, it can cause a race condition if the client is executing multiple commands at a time, for eg. in `asyncio.gather`", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2231/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2231/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2226", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2226/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2226/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2226/events", "html_url": "https://github.com/redis/redis-py/issues/2226", "id": 1267668131, "node_id": "I_kwDOAAWKjs5LjxSj", "number": 2226, "title": "xautoclaim discards first reply part (id of last scanned stream item)", "user": {"login": "vvnekb", "id": 1425762, "node_id": "MDQ6VXNlcjE0MjU3NjI=", "avatar_url": "https://avatars.githubusercontent.com/u/1425762?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vvnekb", "html_url": "https://github.com/vvnekb", "followers_url": "https://api.github.com/users/vvnekb/followers", "following_url": "https://api.github.com/users/vvnekb/following{/other_user}", "gists_url": "https://api.github.com/users/vvnekb/gists{/gist_id}", "starred_url": "https://api.github.com/users/vvnekb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vvnekb/subscriptions", "organizations_url": "https://api.github.com/users/vvnekb/orgs", "repos_url": "https://api.github.com/users/vvnekb/repos", "events_url": "https://api.github.com/users/vvnekb/events{/privacy}", "received_events_url": "https://api.github.com/users/vvnekb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-06-10T14:57:57Z", "updated_at": "2022-06-27T12:05:06Z", "closed_at": "2022-06-27T12:05:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Version**: redis-py 4.3.3, redis 7.0.0\r\n\r\n**Platform**: python 3.9, ubuntu 20.04\r\n\r\n**Description**: I tried to implement the iterative XAUTOCLAIM as described in [Redis docs](https://redis.io/commands/xautoclaim/):\r\n\r\n> The command returns the claimed entries as an array. It also returns a stream ID intended for cursor-like use as the <start> argument for its subsequent call. When there are no remaining PEL entries, the command returns the special 0-0 ID to signal completion.\r\n> \r\n> ...\r\n> \r\n> Return\r\n>Array reply, specifically:\r\n>An array with three elements:\r\n> 1. A stream ID to be used as the <start> argument for the next call to XAUTOCLAIM.\r\n> 2. An array containing all the successfully claimed messages in the same format as [XRANGE](https://redis.io/commands/xrange).\r\n> 3. An array containing message IDs that no longer exist in the stream, and were deleted from the PEL in which they were found.\r\n\r\nUnfortunately, I found out that redis-py drops first element of array completely and returns just the second part (claimed messages), as can be seen in [parse_xautoclaim](https://github.com/redis/redis-py/blob/master/redis/client.py#L310). So it is not possible to figure out the start_id for the next call.\r\n\r\nWhat is the rationale behind that decision? It looks like there are cases when id of last scanned stream item is quite useful.\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2226/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2226/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2225", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2225/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2225/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2225/events", "html_url": "https://github.com/redis/redis-py/pull/2225", "id": 1266814168, "node_id": "PR_kwDOAAWKjs45bZdW", "number": 2225, "title": "ClusterPipeline Doesn't Handle ConnectionError for Dead Hosts", "user": {"login": "grippy", "id": 111677, "node_id": "MDQ6VXNlcjExMTY3Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/111677?v=4", "gravatar_id": "", "url": "https://api.github.com/users/grippy", "html_url": "https://github.com/grippy", "followers_url": "https://api.github.com/users/grippy/followers", "following_url": "https://api.github.com/users/grippy/following{/other_user}", "gists_url": "https://api.github.com/users/grippy/gists{/gist_id}", "starred_url": "https://api.github.com/users/grippy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/grippy/subscriptions", "organizations_url": "https://api.github.com/users/grippy/orgs", "repos_url": "https://api.github.com/users/grippy/repos", "events_url": "https://api.github.com/users/grippy/events{/privacy}", "received_events_url": "https://api.github.com/users/grippy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-06-10T00:41:56Z", "updated_at": "2022-10-31T10:44:02Z", "closed_at": "2022-08-02T08:08:40Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2225", "html_url": "https://github.com/redis/redis-py/pull/2225", "diff_url": "https://github.com/redis/redis-py/pull/2225.diff", "patch_url": "https://github.com/redis/redis-py/pull/2225.patch", "merged_at": "2022-08-02T08:08:40Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [x] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [x] Is there an example added to the examples folder (if applicable)? N/A\r\n- [x] Was the change added to CHANGES file?\r\n\r\n### Description of change\r\n\r\n`ClusterPipeline._send_cluster_commands` fails during the cmd-to-node bucketing step if a cached node is no longer reachable.\r\n \r\nhttps://github.com/redis/redis-py/issues/2224\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2225/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2225/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2217", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2217/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2217/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2217/events", "html_url": "https://github.com/redis/redis-py/pull/2217", "id": 1261164466, "node_id": "PR_kwDOAAWKjs45IaM5", "number": 2217, "title": "async_cluster: fix max_connections/ssl & improve args", "user": {"login": "utkarshgupta137", "id": 5155100, "node_id": "MDQ6VXNlcjUxNTUxMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5155100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/utkarshgupta137", "html_url": "https://github.com/utkarshgupta137", "followers_url": "https://api.github.com/users/utkarshgupta137/followers", "following_url": "https://api.github.com/users/utkarshgupta137/following{/other_user}", "gists_url": "https://api.github.com/users/utkarshgupta137/gists{/gist_id}", "starred_url": "https://api.github.com/users/utkarshgupta137/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/utkarshgupta137/subscriptions", "organizations_url": "https://api.github.com/users/utkarshgupta137/orgs", "repos_url": "https://api.github.com/users/utkarshgupta137/repos", "events_url": "https://api.github.com/users/utkarshgupta137/events{/privacy}", "received_events_url": "https://api.github.com/users/utkarshgupta137/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 3458819498, "node_id": "LA_kwDOAAWKjs7OKWWq", "url": "https://api.github.com/repos/redis/redis-py/labels/breakingchange", "name": "breakingchange", "color": "038AF9", "default": false, "description": "API or Breaking Change"}, {"id": 4234596657, "node_id": "LA_kwDOAAWKjs78ZtEx", "url": "https://api.github.com/repos/redis/redis-py/labels/async", "name": "async", "color": "183C77", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2022-06-05T21:27:23Z", "updated_at": "2022-12-01T08:35:31Z", "closed_at": "2022-07-27T11:05:36Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2217", "html_url": "https://github.com/redis/redis-py/pull/2217", "diff_url": "https://github.com/redis/redis-py/pull/2217.diff", "patch_url": "https://github.com/redis/redis-py/pull/2217.patch", "merged_at": "2022-07-27T11:05:36Z"}, "body": "### Pull Request check-list\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [x] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n### Description of change\r\n\r\n- set proper connection_class if ssl = True\r\n- pass max_connections/connection_class to ClusterNode\r\n- pass parser_class to Connection instead of changing it in on_connect\r\n- only pass redis_connect_func if read_from_replicas = True\r\n- add connection_error_retry_attempts parameter\r\n- skip is_connected check in acquire_connection as it is already checked in send_packed_command\r\n\r\nBREAKING:\r\n- RedisCluster args except host & port are kw-only now\r\n- RedisCluster will no longer accept unknown arguments\r\n- RedisCluster will no longer accept url as an argument. Use RedisCluster.from_url\r\n- RedisCluster.require_full_coverage defaults to True\r\n- ClusterNode args except host, port, & server_type are kw-only now", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2217/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2217/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2210", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2210/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2210/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2210/events", "html_url": "https://github.com/redis/redis-py/pull/2210", "id": 1258222333, "node_id": "PR_kwDOAAWKjs44-oa4", "number": 2210, "title": "Fix Lock crash, and versioning 4.3.3", "user": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-06-02T13:54:58Z", "updated_at": "2022-06-02T14:41:10Z", "closed_at": "2022-06-02T14:41:10Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2210", "html_url": "https://github.com/redis/redis-py/pull/2210", "diff_url": "https://github.com/redis/redis-py/pull/2210.diff", "patch_url": "https://github.com/redis/redis-py/pull/2210.patch", "merged_at": "2022-06-02T14:41:09Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nfixes #2209 ", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2210/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2210/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2180", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2180/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2180/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2180/events", "html_url": "https://github.com/redis/redis-py/pull/2180", "id": 1234017568, "node_id": "PR_kwDOAAWKjs43uOKr", "number": 2180, "title": "Fix retries in async mode", "user": {"login": "elemoine", "id": 76594, "node_id": "MDQ6VXNlcjc2NTk0", "avatar_url": "https://avatars.githubusercontent.com/u/76594?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elemoine", "html_url": "https://github.com/elemoine", "followers_url": "https://api.github.com/users/elemoine/followers", "following_url": "https://api.github.com/users/elemoine/following{/other_user}", "gists_url": "https://api.github.com/users/elemoine/gists{/gist_id}", "starred_url": "https://api.github.com/users/elemoine/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elemoine/subscriptions", "organizations_url": "https://api.github.com/users/elemoine/orgs", "repos_url": "https://api.github.com/users/elemoine/repos", "events_url": "https://api.github.com/users/elemoine/events{/privacy}", "received_events_url": "https://api.github.com/users/elemoine/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 4234596657, "node_id": "LA_kwDOAAWKjs78ZtEx", "url": "https://api.github.com/repos/redis/redis-py/labels/async", "name": "async", "color": "183C77", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-05-12T13:49:09Z", "updated_at": "2022-06-20T06:58:01Z", "closed_at": "2022-06-19T01:56:54Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2180", "html_url": "https://github.com/redis/redis-py/pull/2180", "diff_url": "https://github.com/redis/redis-py/pull/2180.diff", "patch_url": "https://github.com/redis/redis-py/pull/2180.patch", "merged_at": "2022-06-19T01:56:53Z"}, "body": "\r\n\r\n### Description of change\r\n\r\nThe main goal of this PR is to fix retries in asyncio mode. As described on #2179, in asyncio mode, there are currently no retries on other errors than `TimeoutError` errors.\r\n\r\nTo fix that bug the PR first makes the way retries are configured consistent in sync and async. It then modifies the `_disconnect_raise` function not to raise on any \"supported error\".\r\n\r\n**Note**: I think there are other problems with the retry configuration API, but for now I just wanted to fix the actual bug while making the retry configuration API consistent between sync and async.\r\n\r\nFixes #2179.\r\n\r\n### Pull Request check-list\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [x] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)? I have updated the async client's docstrings.\r\n- [ ] ~~Is there an example added to the examples folder (if applicable)?~~\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2180/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2180/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2175", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2175/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2175/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2175/events", "html_url": "https://github.com/redis/redis-py/pull/2175", "id": 1229568318, "node_id": "PR_kwDOAAWKjs43frX_", "number": 2175, "title": "Fix asyncio Search crash, and versioning 4.3.1", "user": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-05-09T11:30:30Z", "updated_at": "2022-05-09T12:55:47Z", "closed_at": "2022-05-09T12:55:47Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2175", "html_url": "https://github.com/redis/redis-py/pull/2175", "diff_url": "https://github.com/redis/redis-py/pull/2175.diff", "patch_url": "https://github.com/redis/redis-py/pull/2175.patch", "merged_at": "2022-05-09T12:55:47Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\n_Please provide a description of the change here._\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2175/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2175/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2144", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2144/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2144/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2144/events", "html_url": "https://github.com/redis/redis-py/pull/2144", "id": 1217118629, "node_id": "PR_kwDOAAWKjs423M1n", "number": 2144, "title": "Rename 'update_supported_erros' to 'update_supported_errors' in Retry module", "user": {"login": "Ankhas", "id": 38790380, "node_id": "MDQ6VXNlcjM4NzkwMzgw", "avatar_url": "https://avatars.githubusercontent.com/u/38790380?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ankhas", "html_url": "https://github.com/Ankhas", "followers_url": "https://api.github.com/users/Ankhas/followers", "following_url": "https://api.github.com/users/Ankhas/following{/other_user}", "gists_url": "https://api.github.com/users/Ankhas/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ankhas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ankhas/subscriptions", "organizations_url": "https://api.github.com/users/Ankhas/orgs", "repos_url": "https://api.github.com/users/Ankhas/repos", "events_url": "https://api.github.com/users/Ankhas/events{/privacy}", "received_events_url": "https://api.github.com/users/Ankhas/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-04-27T10:03:27Z", "updated_at": "2022-05-02T09:03:37Z", "closed_at": "2022-05-02T09:03:37Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2144", "html_url": "https://github.com/redis/redis-py/pull/2144", "diff_url": "https://github.com/redis/redis-py/pull/2144.diff", "patch_url": "https://github.com/redis/redis-py/pull/2144.patch", "merged_at": "2022-05-02T09:03:37Z"}, "body": "### Pull Request check-list\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n### Description of change\r\n\r\nIn the Retry module, a function was named `update_supported_erros`. I rename it to `update_supported_errors`", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2144/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2144/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2104", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2104/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2104/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2104/events", "html_url": "https://github.com/redis/redis-py/pull/2104", "id": 1203181633, "node_id": "PR_kwDOAAWKjs42K6Gq", "number": 2104, "title": "Catch `Exception` and not `BaseException` in the `Connection`", "user": {"login": "kristjanvalur", "id": 6009543, "node_id": "MDQ6VXNlcjYwMDk1NDM=", "avatar_url": "https://avatars.githubusercontent.com/u/6009543?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kristjanvalur", "html_url": "https://github.com/kristjanvalur", "followers_url": "https://api.github.com/users/kristjanvalur/followers", "following_url": "https://api.github.com/users/kristjanvalur/following{/other_user}", "gists_url": "https://api.github.com/users/kristjanvalur/gists{/gist_id}", "starred_url": "https://api.github.com/users/kristjanvalur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kristjanvalur/subscriptions", "organizations_url": "https://api.github.com/users/kristjanvalur/orgs", "repos_url": "https://api.github.com/users/kristjanvalur/repos", "events_url": "https://api.github.com/users/kristjanvalur/events{/privacy}", "received_events_url": "https://api.github.com/users/kristjanvalur/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 3458819498, "node_id": "LA_kwDOAAWKjs7OKWWq", "url": "https://api.github.com/repos/redis/redis-py/labels/breakingchange", "name": "breakingchange", "color": "038AF9", "default": false, "description": "API or Breaking Change"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2022-04-13T11:39:44Z", "updated_at": "2022-09-29T11:13:58Z", "closed_at": "2022-09-29T11:03:55Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2104", "html_url": "https://github.com/redis/redis-py/pull/2104", "diff_url": "https://github.com/redis/redis-py/pull/2104.diff", "patch_url": "https://github.com/redis/redis-py/pull/2104.patch", "merged_at": "2022-09-29T11:03:55Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [x] Was the change added to CHANGES file?\r\n\r\n### Description of change\r\n\r\nFixes Issue #2103:\r\nRaising a BaseException inside a `Connection`'s send or receive oprations causes a `disconnect`().  BaseExceptions are commonly used for _out of band_ messages in Python and normally not be expecially acted upon, only be handled at the top-level \r\n\r\nSee also:  #2356 which focuses on a different aspcect of error handling.", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2104/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2104/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2097", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2097/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2097/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2097/events", "html_url": "https://github.com/redis/redis-py/pull/2097", "id": 1196778245, "node_id": "PR_kwDOAAWKjs412ILJ", "number": 2097, "title": "fix execute_command() determine nodes error when no key command", "user": {"login": "suxb201", "id": 16659368, "node_id": "MDQ6VXNlcjE2NjU5MzY4", "avatar_url": "https://avatars.githubusercontent.com/u/16659368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suxb201", "html_url": "https://github.com/suxb201", "followers_url": "https://api.github.com/users/suxb201/followers", "following_url": "https://api.github.com/users/suxb201/following{/other_user}", "gists_url": "https://api.github.com/users/suxb201/gists{/gist_id}", "starred_url": "https://api.github.com/users/suxb201/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suxb201/subscriptions", "organizations_url": "https://api.github.com/users/suxb201/orgs", "repos_url": "https://api.github.com/users/suxb201/repos", "events_url": "https://api.github.com/users/suxb201/events{/privacy}", "received_events_url": "https://api.github.com/users/suxb201/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-04-08T03:15:40Z", "updated_at": "2022-04-28T06:17:32Z", "closed_at": "2022-04-28T06:17:32Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2097", "html_url": "https://github.com/redis/redis-py/pull/2097", "diff_url": "https://github.com/redis/redis-py/pull/2097.diff", "patch_url": "https://github.com/redis/redis-py/pull/2097.patch", "merged_at": "2022-04-28T06:17:31Z"}, "body": "see #2095 ", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2097/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2097/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2092", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2092/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2092/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2092/events", "html_url": "https://github.com/redis/redis-py/pull/2092", "id": 1195473500, "node_id": "PR_kwDOAAWKjs41x0P-", "number": 2092, "title": "Fix incorrect return statement in auth (#2086)", "user": {"login": "kamyabzad", "id": 29278819, "node_id": "MDQ6VXNlcjI5Mjc4ODE5", "avatar_url": "https://avatars.githubusercontent.com/u/29278819?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kamyabzad", "html_url": "https://github.com/kamyabzad", "followers_url": "https://api.github.com/users/kamyabzad/followers", "following_url": "https://api.github.com/users/kamyabzad/following{/other_user}", "gists_url": "https://api.github.com/users/kamyabzad/gists{/gist_id}", "starred_url": "https://api.github.com/users/kamyabzad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kamyabzad/subscriptions", "organizations_url": "https://api.github.com/users/kamyabzad/orgs", "repos_url": "https://api.github.com/users/kamyabzad/repos", "events_url": "https://api.github.com/users/kamyabzad/events{/privacy}", "received_events_url": "https://api.github.com/users/kamyabzad/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-04-07T03:30:30Z", "updated_at": "2022-04-27T23:36:05Z", "closed_at": "2022-04-27T23:36:05Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2092", "html_url": "https://github.com/redis/redis-py/pull/2092", "diff_url": "https://github.com/redis/redis-py/pull/2092.diff", "patch_url": "https://github.com/redis/redis-py/pull/2092.patch", "merged_at": "2022-04-27T23:36:05Z"}, "body": "### Pull Request check-list\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [x] Was the change added to CHANGES file?\r\n\r\n### Description of change\r\nFix a bug in commands.core.ManagementCommands.auth that returned a function handler when provided with a None username", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2092/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2092/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2079", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2079/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2079/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2079/events", "html_url": "https://github.com/redis/redis-py/pull/2079", "id": 1190819858, "node_id": "PR_kwDOAAWKjs41iYNQ", "number": 2079, "title": "fix asynic/client.py's import", "user": {"login": "wwqgtxx", "id": 582584, "node_id": "MDQ6VXNlcjU4MjU4NA==", "avatar_url": "https://avatars.githubusercontent.com/u/582584?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wwqgtxx", "html_url": "https://github.com/wwqgtxx", "followers_url": "https://api.github.com/users/wwqgtxx/followers", "following_url": "https://api.github.com/users/wwqgtxx/following{/other_user}", "gists_url": "https://api.github.com/users/wwqgtxx/gists{/gist_id}", "starred_url": "https://api.github.com/users/wwqgtxx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wwqgtxx/subscriptions", "organizations_url": "https://api.github.com/users/wwqgtxx/orgs", "repos_url": "https://api.github.com/users/wwqgtxx/repos", "events_url": "https://api.github.com/users/wwqgtxx/events{/privacy}", "received_events_url": "https://api.github.com/users/wwqgtxx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-04-03T05:00:36Z", "updated_at": "2022-04-04T10:21:43Z", "closed_at": "2022-04-04T10:21:43Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2079", "html_url": "https://github.com/redis/redis-py/pull/2079", "diff_url": "https://github.com/redis/redis-py/pull/2079.diff", "patch_url": "https://github.com/redis/redis-py/pull/2079.patch", "merged_at": "2022-04-04T10:21:43Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\n`redis.asyncio.Redis`'s `Lock` and `Retry` should be from `redis.asyncio`\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2079/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2079/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2077", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2077/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2077/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2077/events", "html_url": "https://github.com/redis/redis-py/pull/2077", "id": 1188371399, "node_id": "PR_kwDOAAWKjs41aeq-", "number": 2077, "title": "always clear reference to closed reader/writer", "user": {"login": "beasteers", "id": 6741720, "node_id": "MDQ6VXNlcjY3NDE3MjA=", "avatar_url": "https://avatars.githubusercontent.com/u/6741720?v=4", "gravatar_id": "", "url": "https://api.github.com/users/beasteers", "html_url": "https://github.com/beasteers", "followers_url": "https://api.github.com/users/beasteers/followers", "following_url": "https://api.github.com/users/beasteers/following{/other_user}", "gists_url": "https://api.github.com/users/beasteers/gists{/gist_id}", "starred_url": "https://api.github.com/users/beasteers/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/beasteers/subscriptions", "organizations_url": "https://api.github.com/users/beasteers/orgs", "repos_url": "https://api.github.com/users/beasteers/repos", "events_url": "https://api.github.com/users/beasteers/events{/privacy}", "received_events_url": "https://api.github.com/users/beasteers/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-03-31T16:53:36Z", "updated_at": "2022-04-04T10:18:33Z", "closed_at": "2022-04-04T10:18:33Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2077", "html_url": "https://github.com/redis/redis-py/pull/2077", "diff_url": "https://github.com/redis/redis-py/pull/2077.diff", "patch_url": "https://github.com/redis/redis-py/pull/2077.patch", "merged_at": "2022-04-04T10:18:33Z"}, "body": "### Description of change\r\n\r\nFixes #2065 - makes sure we always discard closed/closing writers\r\n\r\n\r\n### Pull Request check-list\r\n\r\n- [x] ~Does `$ tox` pass with this change (including linting)?~  (tox doesn't pass on master and this doesn't attempt to fix any of those issues)\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [x] ~Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?~\r\n- [x] ~Is there an example added to the examples folder (if applicable)?~\r\n- [x] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2077/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2077/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2070", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2070/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2070/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2070/events", "html_url": "https://github.com/redis/redis-py/pull/2070", "id": 1183852617, "node_id": "PR_kwDOAAWKjs41LWwY", "number": 2070, "title": "Fix disable decode for dump command on asyncio", "user": {"login": "nosammai", "id": 2600910, "node_id": "MDQ6VXNlcjI2MDA5MTA=", "avatar_url": "https://avatars.githubusercontent.com/u/2600910?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nosammai", "html_url": "https://github.com/nosammai", "followers_url": "https://api.github.com/users/nosammai/followers", "following_url": "https://api.github.com/users/nosammai/following{/other_user}", "gists_url": "https://api.github.com/users/nosammai/gists{/gist_id}", "starred_url": "https://api.github.com/users/nosammai/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nosammai/subscriptions", "organizations_url": "https://api.github.com/users/nosammai/orgs", "repos_url": "https://api.github.com/users/nosammai/repos", "events_url": "https://api.github.com/users/nosammai/events{/privacy}", "received_events_url": "https://api.github.com/users/nosammai/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-03-28T18:54:22Z", "updated_at": "2022-04-04T18:54:55Z", "closed_at": "2022-04-04T10:16:19Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2070", "html_url": "https://github.com/redis/redis-py/pull/2070", "diff_url": "https://github.com/redis/redis-py/pull/2070.diff", "patch_url": "https://github.com/redis/redis-py/pull/2070.patch", "merged_at": "2022-04-04T10:16:18Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nFix typo in argument that causes the `dump` command to fail with an exception using the asyncio client.\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2070/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2070/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2054", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2054/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2054/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2054/events", "html_url": "https://github.com/redis/redis-py/pull/2054", "id": 1172717801, "node_id": "PR_kwDOAAWKjs40nYVN", "number": 2054, "title": "[CLUSTER] Fix scan command cursors & Fix scan_iter", "user": {"login": "utkarshgupta137", "id": 5155100, "node_id": "MDQ6VXNlcjUxNTUxMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5155100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/utkarshgupta137", "html_url": "https://github.com/utkarshgupta137", "followers_url": "https://api.github.com/users/utkarshgupta137/followers", "following_url": "https://api.github.com/users/utkarshgupta137/following{/other_user}", "gists_url": "https://api.github.com/users/utkarshgupta137/gists{/gist_id}", "starred_url": "https://api.github.com/users/utkarshgupta137/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/utkarshgupta137/subscriptions", "organizations_url": "https://api.github.com/users/utkarshgupta137/orgs", "repos_url": "https://api.github.com/users/utkarshgupta137/repos", "events_url": "https://api.github.com/users/utkarshgupta137/events{/privacy}", "received_events_url": "https://api.github.com/users/utkarshgupta137/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-03-17T18:21:55Z", "updated_at": "2022-03-23T09:18:17Z", "closed_at": "2022-03-23T09:18:17Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2054", "html_url": "https://github.com/redis/redis-py/pull/2054", "diff_url": "https://github.com/redis/redis-py/pull/2054.diff", "patch_url": "https://github.com/redis/redis-py/pull/2054.patch", "merged_at": "2022-03-23T09:18:17Z"}, "body": "### Pull Request check-list\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [x] Was the change added to CHANGES file?\r\n\r\n### Description of change\r\n\r\nFixes #2003 ", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2054/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2054/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2050", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2050/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2050/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2050/events", "html_url": "https://github.com/redis/redis-py/pull/2050", "id": 1168251675, "node_id": "PR_kwDOAAWKjs40Y6aF", "number": 2050, "title": "Fix TypeError in graph commands", "user": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-03-14T11:37:48Z", "updated_at": "2022-03-14T13:43:06Z", "closed_at": "2022-03-14T13:43:02Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2050", "html_url": "https://github.com/redis/redis-py/pull/2050", "diff_url": "https://github.com/redis/redis-py/pull/2050.diff", "patch_url": "https://github.com/redis/redis-py/pull/2050.patch", "merged_at": "2022-03-14T13:43:02Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n- [ ] Was the change added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\ncloses #2033", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2050/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2050/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/2001", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/2001/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/2001/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/2001/events", "html_url": "https://github.com/redis/redis-py/pull/2001", "id": 1143279552, "node_id": "PR_kwDOAAWKjs4zGGLm", "number": 2001, "title": "Catch OSError in BlockingConnectionPool.get_connection", "user": {"login": "elemoine", "id": 76594, "node_id": "MDQ6VXNlcjc2NTk0", "avatar_url": "https://avatars.githubusercontent.com/u/76594?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elemoine", "html_url": "https://github.com/elemoine", "followers_url": "https://api.github.com/users/elemoine/followers", "following_url": "https://api.github.com/users/elemoine/following{/other_user}", "gists_url": "https://api.github.com/users/elemoine/gists{/gist_id}", "starred_url": "https://api.github.com/users/elemoine/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elemoine/subscriptions", "organizations_url": "https://api.github.com/users/elemoine/orgs", "repos_url": "https://api.github.com/users/elemoine/repos", "events_url": "https://api.github.com/users/elemoine/events{/privacy}", "received_events_url": "https://api.github.com/users/elemoine/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-02-18T15:39:26Z", "updated_at": "2022-02-28T08:03:37Z", "closed_at": "2022-02-22T11:32:14Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/2001", "html_url": "https://github.com/redis/redis-py/pull/2001", "diff_url": "https://github.com/redis/redis-py/pull/2001.diff", "patch_url": "https://github.com/redis/redis-py/pull/2001.patch", "merged_at": "2022-02-22T11:32:14Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] ~~Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?~~ doesn't apply\r\n- [ ] ~~Is there an example added to the examples folder (if applicable)?~~ doesn't apply\r\n- [ ] Is the changes added to CHANGES file?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nThis PR follows up on https://github.com/redis/redis-py/pull/1832. It applies the same fix to the `BlockingConnectionPool`.", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/2001/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/2001/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1985", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1985/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1985/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1985/events", "html_url": "https://github.com/redis/redis-py/pull/1985", "id": 1137940344, "node_id": "PR_kwDOAAWKjs4y0caA", "number": 1985, "title": "FixingElevated CPU utilization on one node when using RedisCluster pipeline", "user": {"login": "shchurov", "id": 5001455, "node_id": "MDQ6VXNlcjUwMDE0NTU=", "avatar_url": "https://avatars.githubusercontent.com/u/5001455?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shchurov", "html_url": "https://github.com/shchurov", "followers_url": "https://api.github.com/users/shchurov/followers", "following_url": "https://api.github.com/users/shchurov/following{/other_user}", "gists_url": "https://api.github.com/users/shchurov/gists{/gist_id}", "starred_url": "https://api.github.com/users/shchurov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shchurov/subscriptions", "organizations_url": "https://api.github.com/users/shchurov/orgs", "repos_url": "https://api.github.com/users/shchurov/repos", "events_url": "https://api.github.com/users/shchurov/events{/privacy}", "received_events_url": "https://api.github.com/users/shchurov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-02-14T22:49:21Z", "updated_at": "2022-02-22T10:46:46Z", "closed_at": "2022-02-22T10:46:46Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1985", "html_url": "https://github.com/redis/redis-py/pull/1985", "diff_url": "https://github.com/redis/redis-py/pull/1985.diff", "patch_url": "https://github.com/redis/redis-py/pull/1985.patch", "merged_at": "2022-02-22T10:46:45Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [x] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [x] Is there an example added to the examples folder (if applicable)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nThis PR addresses the issue https://github.com/redis/redis-py/issues/1932.  \r\nThe current implementation creates a new instance of `CommandsParser` for every `ClusterPipeline` instance. It may get expensive because `CommandsParser` executes `COMMAND` command during the initialization. I assume that pipelines can reuse the parser instance from `RedisCluster` instead.", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1985/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1985/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1926", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1926/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1926/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1926/events", "html_url": "https://github.com/redis/redis-py/pull/1926", "id": 1123119815, "node_id": "PR_kwDOAAWKjs4yByXo", "number": 1926, "title": "Fix flushdb and flushall", "user": {"login": "MeirShpilraien", "id": 28348822, "node_id": "MDQ6VXNlcjI4MzQ4ODIy", "avatar_url": "https://avatars.githubusercontent.com/u/28348822?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MeirShpilraien", "html_url": "https://github.com/MeirShpilraien", "followers_url": "https://api.github.com/users/MeirShpilraien/followers", "following_url": "https://api.github.com/users/MeirShpilraien/following{/other_user}", "gists_url": "https://api.github.com/users/MeirShpilraien/gists{/gist_id}", "starred_url": "https://api.github.com/users/MeirShpilraien/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MeirShpilraien/subscriptions", "organizations_url": "https://api.github.com/users/MeirShpilraien/orgs", "repos_url": "https://api.github.com/users/MeirShpilraien/repos", "events_url": "https://api.github.com/users/MeirShpilraien/events{/privacy}", "received_events_url": "https://api.github.com/users/MeirShpilraien/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-02-03T13:59:19Z", "updated_at": "2022-02-07T07:46:46Z", "closed_at": "2022-02-07T07:46:45Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1926", "html_url": "https://github.com/redis/redis-py/pull/1926", "diff_url": "https://github.com/redis/redis-py/pull/1926.diff", "patch_url": "https://github.com/redis/redis-py/pull/1926.patch", "merged_at": "2022-02-07T07:46:45Z"}, "body": "Both commands should be broadcasted to all the shards.\r\nIn addition, support `ssl_password` on cluster.\r\n\r\n### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\n_Please provide a description of the change here._\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1926/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1926/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1920", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1920/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1920/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1920/events", "html_url": "https://github.com/redis/redis-py/pull/1920", "id": 1120307697, "node_id": "PR_kwDOAAWKjs4x4hSl", "number": 1920, "title": "fix quantile test", "user": {"login": "ashtul", "id": 44112901, "node_id": "MDQ6VXNlcjQ0MTEyOTAx", "avatar_url": "https://avatars.githubusercontent.com/u/44112901?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ashtul", "html_url": "https://github.com/ashtul", "followers_url": "https://api.github.com/users/ashtul/followers", "following_url": "https://api.github.com/users/ashtul/following{/other_user}", "gists_url": "https://api.github.com/users/ashtul/gists{/gist_id}", "starred_url": "https://api.github.com/users/ashtul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ashtul/subscriptions", "organizations_url": "https://api.github.com/users/ashtul/orgs", "repos_url": "https://api.github.com/users/ashtul/repos", "events_url": "https://api.github.com/users/ashtul/events{/privacy}", "received_events_url": "https://api.github.com/users/ashtul/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-02-01T07:07:08Z", "updated_at": "2022-02-09T17:01:15Z", "closed_at": "2022-02-09T17:01:14Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1920", "html_url": "https://github.com/redis/redis-py/pull/1920", "diff_url": "https://github.com/redis/redis-py/pull/1920.diff", "patch_url": "https://github.com/redis/redis-py/pull/1920.patch", "merged_at": "2022-02-09T17:01:14Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\n_Please provide a description of the change here._\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1920/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1920/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1906", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1906/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1906/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1906/events", "html_url": "https://github.com/redis/redis-py/pull/1906", "id": 1115125794, "node_id": "PR_kwDOAAWKjs4xny44", "number": 1906, "title": "Fixing LMOVE, BLMOVE returning an incorrect response", "user": {"login": "varunchopra", "id": 360979, "node_id": "MDQ6VXNlcjM2MDk3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/360979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/varunchopra", "html_url": "https://github.com/varunchopra", "followers_url": "https://api.github.com/users/varunchopra/followers", "following_url": "https://api.github.com/users/varunchopra/following{/other_user}", "gists_url": "https://api.github.com/users/varunchopra/gists{/gist_id}", "starred_url": "https://api.github.com/users/varunchopra/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/varunchopra/subscriptions", "organizations_url": "https://api.github.com/users/varunchopra/orgs", "repos_url": "https://api.github.com/users/varunchopra/repos", "events_url": "https://api.github.com/users/varunchopra/events{/privacy}", "received_events_url": "https://api.github.com/users/varunchopra/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-01-26T15:06:49Z", "updated_at": "2022-01-27T07:19:25Z", "closed_at": "2022-01-27T07:19:24Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1906", "html_url": "https://github.com/redis/redis-py/pull/1906", "diff_url": "https://github.com/redis/redis-py/pull/1906.diff", "patch_url": "https://github.com/redis/redis-py/pull/1906.patch", "merged_at": "2022-01-27T07:19:24Z"}, "body": "### Pull Request check-list\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n\r\n\r\n### Description of change\r\n\r\nFixes https://github.com/redis/redis-py/issues/1776\r\n\r\nA bit late...I started running my own fork and forgot about this. \ud83d\ude1e \r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1906/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 1, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1906/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1905", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1905/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1905/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1905/events", "html_url": "https://github.com/redis/redis-py/pull/1905", "id": 1114945491, "node_id": "PR_kwDOAAWKjs4xnM0h", "number": 1905, "title": "Fixing AttributeError on some connection errors", "user": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-01-26T12:05:18Z", "updated_at": "2022-01-26T14:50:50Z", "closed_at": "2022-01-26T14:50:49Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1905", "html_url": "https://github.com/redis/redis-py/pull/1905", "diff_url": "https://github.com/redis/redis-py/pull/1905.diff", "patch_url": "https://github.com/redis/redis-py/pull/1905.patch", "merged_at": "2022-01-26T14:50:49Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1905/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1905/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1903", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1903/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1903/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1903/events", "html_url": "https://github.com/redis/redis-py/pull/1903", "id": 1114920780, "node_id": "PR_kwDOAAWKjs4xnHmn", "number": 1903, "title": "Fixing AttributeError in UnixDomainSocketConnection", "user": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-01-26T11:35:34Z", "updated_at": "2022-02-06T19:31:04Z", "closed_at": "2022-01-26T11:48:24Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1903", "html_url": "https://github.com/redis/redis-py/pull/1903", "diff_url": "https://github.com/redis/redis-py/pull/1903.diff", "patch_url": "https://github.com/redis/redis-py/pull/1903.patch", "merged_at": "2022-01-26T11:48:24Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\ncloses #1902", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1903/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1903/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1902", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1902/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1902/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1902/events", "html_url": "https://github.com/redis/redis-py/issues/1902", "id": 1114721190, "node_id": "I_kwDOAAWKjs5CcUum", "number": 1902, "title": "AttributeError in UnixDomainSocketConnection starting v4.1.0", "user": {"login": "levincarmel", "id": 85439063, "node_id": "MDQ6VXNlcjg1NDM5MDYz", "avatar_url": "https://avatars.githubusercontent.com/u/85439063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/levincarmel", "html_url": "https://github.com/levincarmel", "followers_url": "https://api.github.com/users/levincarmel/followers", "following_url": "https://api.github.com/users/levincarmel/following{/other_user}", "gists_url": "https://api.github.com/users/levincarmel/gists{/gist_id}", "starred_url": "https://api.github.com/users/levincarmel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/levincarmel/subscriptions", "organizations_url": "https://api.github.com/users/levincarmel/orgs", "repos_url": "https://api.github.com/users/levincarmel/repos", "events_url": "https://api.github.com/users/levincarmel/events{/privacy}", "received_events_url": "https://api.github.com/users/levincarmel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-01-26T07:48:03Z", "updated_at": "2022-01-26T11:48:24Z", "closed_at": "2022-01-26T11:48:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Version**: v4.1.0\r\n\r\n**Platform**: python 3.9\r\n\r\n**Description**: \r\nI have a `ConnectionPool` with `connection_class=UnixDomainSocketConnection`.\r\nIn order to verify the socket is unreachable, we send a `ping` command and expect to get a `ConnectionError`, but starting v4.1.0 we get an `AttributeError` instead.\r\n\r\n```\r\nconnection_pool = ConnectionPool(\r\n                connection_class=redis.connection.UnixDomainSocketConnection, \r\n                max_connections = None,\r\n                path=socket_path, \r\n                \"password\": password,\r\n                \"socket_timeout\": socket_timeout,\r\n                \"encoding\": \"utf-8\",\r\n                \"encoding_errors\": \"strict\",\r\n                \"decode_responses\": True,\r\n                \"retry_on_timeout\": False,\r\n)\r\nrc = redis.Redis(connection_pool=connection_pool)\r\n```\r\nThen I terminate the process that is responsible for the above socket, and do: `rc.ping()` in order to know the socket is unreachable, from which I expect to get a `ConnectionError` (this is what we got from the `ping` in earlier versions).\r\nBut instead, in v4.1.0 (and v4.1.1) I get: `AttributeError: 'UnixDomainSocketConnection' object has no attribute 'host'`.\r\n\r\nI investigated a little and seems like changing the `socket.error` to `OSError` in `connections.py` caused `ConnectionResetError` to get caught by an earlier `except` clause, where `self.host` is printed (and of course `UnixDomainSocketConnection` doesn't have one).\r\nThanks!", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1902/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1902/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1901", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1901/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1901/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1901/events", "html_url": "https://github.com/redis/redis-py/pull/1901", "id": 1113818061, "node_id": "PR_kwDOAAWKjs4xjh5e", "number": 1901, "title": "Fixing TypeError in GraphCommands.explain", "user": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-01-25T12:17:03Z", "updated_at": "2022-02-06T19:31:32Z", "closed_at": "2022-01-26T07:09:54Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1901", "html_url": "https://github.com/redis/redis-py/pull/1901", "diff_url": "https://github.com/redis/redis-py/pull/1901.diff", "patch_url": "https://github.com/redis/redis-py/pull/1901.patch", "merged_at": "2022-01-26T07:09:54Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\ncloses #1848 ", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1901/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1901/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1877", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1877/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1877/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1877/events", "html_url": "https://github.com/redis/redis-py/pull/1877", "id": 1099953908, "node_id": "PR_kwDOAAWKjs4w1pfm", "number": 1877, "title": "Timeseries docs fix", "user": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-01-12T07:03:35Z", "updated_at": "2022-01-12T07:11:31Z", "closed_at": "2022-01-12T07:11:29Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1877", "html_url": "https://github.com/redis/redis-py/pull/1877", "diff_url": "https://github.com/redis/redis-py/pull/1877.diff", "patch_url": "https://github.com/redis/redis-py/pull/1877.patch", "merged_at": "2022-01-12T07:11:29Z"}, "body": "fixes #1875", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1877/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1877/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1875", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1875/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1875/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1875/events", "html_url": "https://github.com/redis/redis-py/issues/1875", "id": 1099792971, "node_id": "I_kwDOAAWKjs5BjYJL", "number": 1875, "title": "[Docs] Docs for `timeseries` commands seem to be incorrect", "user": {"login": "dpipemazo", "id": 2764032, "node_id": "MDQ6VXNlcjI3NjQwMzI=", "avatar_url": "https://avatars.githubusercontent.com/u/2764032?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dpipemazo", "html_url": "https://github.com/dpipemazo", "followers_url": "https://api.github.com/users/dpipemazo/followers", "following_url": "https://api.github.com/users/dpipemazo/following{/other_user}", "gists_url": "https://api.github.com/users/dpipemazo/gists{/gist_id}", "starred_url": "https://api.github.com/users/dpipemazo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dpipemazo/subscriptions", "organizations_url": "https://api.github.com/users/dpipemazo/orgs", "repos_url": "https://api.github.com/users/dpipemazo/repos", "events_url": "https://api.github.com/users/dpipemazo/events{/privacy}", "received_events_url": "https://api.github.com/users/dpipemazo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-01-12T02:01:03Z", "updated_at": "2022-01-12T07:11:29Z", "closed_at": "2022-01-12T07:11:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "Thanks for wanting to report an issue you've found in redis-py. Please delete this text and fill in the template below.  \r\nIt is of course not always possible to reduce your code to a small test case, but it's highly appreciated to have as much data as possible. Thank you!\r\n\r\n**Version**: What redis-py and what redis version is the issue happening on?\r\n\r\n4.1.0\r\n\r\n**Platform**: What platform / version? (For example Python 3.5.1 on Windows 7 / Ubuntu 15.10 / Azure)\r\n\r\nDocs\r\n\r\n**Description**: Description of your issue, stack traces from errors and code that reproduces the issue\r\n\r\nThe [documentation](https://redis-py.readthedocs.io/en/stable/redismodules.html) for the `timeseries` module commands seems to be incorrect. If one tries to follow the example:\r\n\r\n```\r\nimport redis\r\nr = redis.Redis()\r\nr.timeseries().create(2, retension_msecs=5)\r\n```\r\n\r\nAn AttributeError is thrown saying `redis` does not have attribute `timeseries`.\r\n\r\nAfter looking at the source and testing a bit, it seems the below is the right way to do it\r\n\r\n```\r\nimport redis\r\nr = redis.Redis()\r\nr.ts().create(2, retension_msecs=5)\r\n```\r\n\r\nThe docs should likely be updated if this is correct. Thanks!\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1875/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1875/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1853", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1853/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1853/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1853/events", "html_url": "https://github.com/redis/redis-py/pull/1853", "id": 1093472209, "node_id": "PR_kwDOAAWKjs4whAV0", "number": 1853, "title": "Set keys var otherwise variable not created", "user": {"login": "Andrew-Chen-Wang", "id": 60190294, "node_id": "MDQ6VXNlcjYwMTkwMjk0", "avatar_url": "https://avatars.githubusercontent.com/u/60190294?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Andrew-Chen-Wang", "html_url": "https://github.com/Andrew-Chen-Wang", "followers_url": "https://api.github.com/users/Andrew-Chen-Wang/followers", "following_url": "https://api.github.com/users/Andrew-Chen-Wang/following{/other_user}", "gists_url": "https://api.github.com/users/Andrew-Chen-Wang/gists{/gist_id}", "starred_url": "https://api.github.com/users/Andrew-Chen-Wang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Andrew-Chen-Wang/subscriptions", "organizations_url": "https://api.github.com/users/Andrew-Chen-Wang/orgs", "repos_url": "https://api.github.com/users/Andrew-Chen-Wang/repos", "events_url": "https://api.github.com/users/Andrew-Chen-Wang/events{/privacy}", "received_events_url": "https://api.github.com/users/Andrew-Chen-Wang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-01-04T15:34:49Z", "updated_at": "2022-01-10T11:19:40Z", "closed_at": "2022-01-10T11:19:40Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1853", "html_url": "https://github.com/redis/redis-py/pull/1853", "diff_url": "https://github.com/redis/redis-py/pull/1853.diff", "patch_url": "https://github.com/redis/redis-py/pull/1853.patch", "merged_at": "2022-01-10T11:19:40Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nThere's a possibility keys may not be instantiated.\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1853/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1853/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1845", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1845/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1845/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1845/events", "html_url": "https://github.com/redis/redis-py/pull/1845", "id": 1092026817, "node_id": "PR_kwDOAAWKjs4wcWXp", "number": 1845, "title": "Clusters should optionally require full slot coverage", "user": {"login": "barshaul", "id": 88437685, "node_id": "MDQ6VXNlcjg4NDM3Njg1", "avatar_url": "https://avatars.githubusercontent.com/u/88437685?v=4", "gravatar_id": "", "url": "https://api.github.com/users/barshaul", "html_url": "https://github.com/barshaul", "followers_url": "https://api.github.com/users/barshaul/followers", "following_url": "https://api.github.com/users/barshaul/following{/other_user}", "gists_url": "https://api.github.com/users/barshaul/gists{/gist_id}", "starred_url": "https://api.github.com/users/barshaul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/barshaul/subscriptions", "organizations_url": "https://api.github.com/users/barshaul/orgs", "repos_url": "https://api.github.com/users/barshaul/repos", "events_url": "https://api.github.com/users/barshaul/events{/privacy}", "received_events_url": "https://api.github.com/users/barshaul/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-01-02T14:03:49Z", "updated_at": "2022-01-10T11:03:50Z", "closed_at": "2022-01-10T11:03:48Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1845", "html_url": "https://github.com/redis/redis-py/pull/1845", "diff_url": "https://github.com/redis/redis-py/pull/1845.diff", "patch_url": "https://github.com/redis/redis-py/pull/1845.patch", "merged_at": "2022-01-10T11:03:48Z"}, "body": "\u2026on, Changed  RedisClient's 'require_full_coverage' default value to false\r\n\r\n### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [x] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [x] Is there an example added to the examples folder (if applicable)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nIn order to avoid the client being a limiting factor for communicating with the server, we should not require full slots coverage by default in the client side.\r\n\r\nrequire_full_coverage parameter: \r\n            When set to False (default value): the client will not require a\r\n            full coverage of the slots. However, if not all slots are covered,\r\n            and at least one node has 'cluster-require-full-coverage' set to\r\n            'yes,' the server will throw a ClusterDownError for some key-based\r\n            commands. See -\r\n            https://redis.io/topics/cluster-tutorial#redis-cluster-configuration-parameters\r\n            When set to True: all slots must be covered to construct the\r\n            cluster client. If not all slots are covered, RedisClusterException\r\n            will be thrown. \r\n\r\nThe 'skip_full_coverage_check' parameter has been removed from RedisClient, and the client no longer checks for 'cluster-require-full-coverage' configuration on the cluster nodes (note - not backward compatible). This check doesn't need to be run since it's an overhead for the client and is already handled by the server's ClusterDown error. Additionally, some managed Redis clusters, such as ElastiCache, don't support the 'config' command, so the client will not work with the default configurations if we keep the node's configuration check. Other clients (e.g. Lettuce, Jedis) doesn't run this check as well.", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1845/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1845/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1841", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1841/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1841/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1841/events", "html_url": "https://github.com/redis/redis-py/pull/1841", "id": 1090953814, "node_id": "PR_kwDOAAWKjs4wY8tg", "number": 1841, "title": "Documentation cleanup", "user": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-12-30T08:32:05Z", "updated_at": "2021-12-30T10:52:13Z", "closed_at": "2021-12-30T10:52:12Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1841", "html_url": "https://github.com/redis/redis-py/pull/1841", "diff_url": "https://github.com/redis/redis-py/pull/1841.diff", "patch_url": "https://github.com/redis/redis-py/pull/1841.patch", "merged_at": "2021-12-30T10:52:11Z"}, "body": "Documentation fixes for warnings, to ensure we can link the various types of connections. Also fixes #1839", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1841/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1841/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1832", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1832/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1832/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1832/events", "html_url": "https://github.com/redis/redis-py/pull/1832", "id": 1088288042, "node_id": "PR_kwDOAAWKjs4wQj9F", "number": 1832, "title": "get_connection: catch OSError too", "user": {"login": "Enchufa2", "id": 4542928, "node_id": "MDQ6VXNlcjQ1NDI5Mjg=", "avatar_url": "https://avatars.githubusercontent.com/u/4542928?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Enchufa2", "html_url": "https://github.com/Enchufa2", "followers_url": "https://api.github.com/users/Enchufa2/followers", "following_url": "https://api.github.com/users/Enchufa2/following{/other_user}", "gists_url": "https://api.github.com/users/Enchufa2/gists{/gist_id}", "starred_url": "https://api.github.com/users/Enchufa2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Enchufa2/subscriptions", "organizations_url": "https://api.github.com/users/Enchufa2/orgs", "repos_url": "https://api.github.com/users/Enchufa2/repos", "events_url": "https://api.github.com/users/Enchufa2/events{/privacy}", "received_events_url": "https://api.github.com/users/Enchufa2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2021-12-24T10:03:50Z", "updated_at": "2022-10-07T13:23:31Z", "closed_at": "2022-01-10T11:20:21Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1832", "html_url": "https://github.com/redis/redis-py/pull/1832", "diff_url": "https://github.com/redis/redis-py/pull/1832.diff", "patch_url": "https://github.com/redis/redis-py/pull/1832.patch", "merged_at": "2022-01-10T11:20:20Z"}, "body": "which covers built-in ConnectionError, to recover from connection issues such as `ConnectionResetError` and `ConnectionAbortedError`. Closes #1772.\r\n\r\n### Pull Request check-list\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1832/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1832/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1823", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1823/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1823/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1823/events", "html_url": "https://github.com/redis/redis-py/pull/1823", "id": 1086589300, "node_id": "PR_kwDOAAWKjs4wLA1B", "number": 1823, "title": "Fixing exception in listen", "user": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-12-22T08:43:07Z", "updated_at": "2021-12-22T10:00:22Z", "closed_at": "2021-12-22T09:52:04Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1823", "html_url": "https://github.com/redis/redis-py/pull/1823", "diff_url": "https://github.com/redis/redis-py/pull/1823.diff", "patch_url": "https://github.com/redis/redis-py/pull/1823.patch", "merged_at": "2021-12-22T09:52:04Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ ] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\ncloses #1788 ", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1823/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1823/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1821", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1821/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1821/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1821/events", "html_url": "https://github.com/redis/redis-py/pull/1821", "id": 1085680227, "node_id": "PR_kwDOAAWKjs4wH_zf", "number": 1821, "title": "Retry on error exception and timeout fixes", "user": {"login": "barshaul", "id": 88437685, "node_id": "MDQ6VXNlcjg4NDM3Njg1", "avatar_url": "https://avatars.githubusercontent.com/u/88437685?v=4", "gravatar_id": "", "url": "https://api.github.com/users/barshaul", "html_url": "https://github.com/barshaul", "followers_url": "https://api.github.com/users/barshaul/followers", "following_url": "https://api.github.com/users/barshaul/following{/other_user}", "gists_url": "https://api.github.com/users/barshaul/gists{/gist_id}", "starred_url": "https://api.github.com/users/barshaul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/barshaul/subscriptions", "organizations_url": "https://api.github.com/users/barshaul/orgs", "repos_url": "https://api.github.com/users/barshaul/repos", "events_url": "https://api.github.com/users/barshaul/events{/privacy}", "received_events_url": "https://api.github.com/users/barshaul/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-12-21T10:30:28Z", "updated_at": "2021-12-23T10:18:04Z", "closed_at": "2021-12-23T10:18:02Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1821", "html_url": "https://github.com/redis/redis-py/pull/1821", "diff_url": "https://github.com/redis/redis-py/pull/1821.diff", "patch_url": "https://github.com/redis/redis-py/pull/1821.patch", "merged_at": "2021-12-23T10:18:02Z"}, "body": "\u2026onError import\r\n\r\n### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [X ] Does `$ tox` pass with this change (including linting)?\r\n- [ X] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [X ] Is the new or changed code fully tested?\r\n- [ X] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [X ] Is there an example added to the examples folder (if applicable)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\n1. Added timeout error to the list of errors to retry.\r\n2. Changed TimeoutError import from redis.exception to RedisTimeoutError so python's TimeoutError won't get override, as it can be also thrown when we try to establish a connection.\r\n3. A ConnectionError import was added from redis.exceptions, since it was mistakenly not imported and the default ConnectionError was being used.\r\n4. Increased sleep time to 0.25sec when ClusterDownError is thrown, so it will let more time for the cluster to get healed. ", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1821/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1821/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1819", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1819/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1819/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1819/events", "html_url": "https://github.com/redis/redis-py/pull/1819", "id": 1084766081, "node_id": "PR_kwDOAAWKjs4wFAvg", "number": 1819, "title": "Fixed MovedError, and stopped iterating through startup nodes when slots are fully covered", "user": {"login": "barshaul", "id": 88437685, "node_id": "MDQ6VXNlcjg4NDM3Njg1", "avatar_url": "https://avatars.githubusercontent.com/u/88437685?v=4", "gravatar_id": "", "url": "https://api.github.com/users/barshaul", "html_url": "https://github.com/barshaul", "followers_url": "https://api.github.com/users/barshaul/followers", "following_url": "https://api.github.com/users/barshaul/following{/other_user}", "gists_url": "https://api.github.com/users/barshaul/gists{/gist_id}", "starred_url": "https://api.github.com/users/barshaul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/barshaul/subscriptions", "organizations_url": "https://api.github.com/users/barshaul/orgs", "repos_url": "https://api.github.com/users/barshaul/repos", "events_url": "https://api.github.com/users/barshaul/events{/privacy}", "received_events_url": "https://api.github.com/users/barshaul/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-12-20T13:03:19Z", "updated_at": "2021-12-22T08:01:19Z", "closed_at": "2021-12-22T08:01:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1819", "html_url": "https://github.com/redis/redis-py/pull/1819", "diff_url": "https://github.com/redis/redis-py/pull/1819.diff", "patch_url": "https://github.com/redis/redis-py/pull/1819.patch", "merged_at": "2021-12-22T08:01:18Z"}, "body": "\u2026ion of the nodes manager to stop iterating through startup nodes when the coverage is full\r\n\r\n### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ X] Does `$ tox` pass with this change (including linting)?\r\n- [ X] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [X ] Is the new or changed code fully tested?\r\n- [ X] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ X] Is there an example added to the examples folder (if applicable)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\n1. Fixed 'MovedError' bug in RedisCluster: when we reinitialized the nodes topology and then continue to try to execute the command with the new caches we haven't refreshed the target_node and therefore we faced another MovedError.\r\n2. Changed the NodesManager initialize() function to stop iterating through startup nodes when the slots are fully covered \r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1819/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1819/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1797", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1797/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1797/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1797/events", "html_url": "https://github.com/redis/redis-py/pull/1797", "id": 1081736378, "node_id": "PR_kwDOAAWKjs4v7Np3", "number": 1797, "title": "Socket not closing after server disconnect", "user": {"login": "pawl", "id": 992533, "node_id": "MDQ6VXNlcjk5MjUzMw==", "avatar_url": "https://avatars.githubusercontent.com/u/992533?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pawl", "html_url": "https://github.com/pawl", "followers_url": "https://api.github.com/users/pawl/followers", "following_url": "https://api.github.com/users/pawl/following{/other_user}", "gists_url": "https://api.github.com/users/pawl/gists{/gist_id}", "starred_url": "https://api.github.com/users/pawl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pawl/subscriptions", "organizations_url": "https://api.github.com/users/pawl/orgs", "repos_url": "https://api.github.com/users/pawl/repos", "events_url": "https://api.github.com/users/pawl/events{/privacy}", "received_events_url": "https://api.github.com/users/pawl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-12-16T03:41:00Z", "updated_at": "2021-12-21T01:36:20Z", "closed_at": "2021-12-16T07:35:23Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1797", "html_url": "https://github.com/redis/redis-py/pull/1797", "diff_url": "https://github.com/redis/redis-py/pull/1797.diff", "patch_url": "https://github.com/redis/redis-py/pull/1797.patch", "merged_at": "2021-12-16T07:35:22Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [x] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [x] Is there an example added to the examples folder (if applicable)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nThis is based on @michael-lazar's recent work on fixing a Celery memory leak caused by py-amqp: https://github.com/celery/py-amqp/pull/374\r\n\r\nI recently learned that `socket.shutdown()` can throw an `OSError` when the server caused the disconnection. I also learned that `socket.shutdown` and `socket.close` have different purposes: https://stackoverflow.com/a/598759\r\n\r\nSo, you still need to run `socket.close` after `socket.shutdown` to allow garbage collection to deallocate the socket.\r\n\r\nCurrently, redis-py's `Connection.disconnect()` won't continue to close the socket if it encounters an `OSError` on shutdown. This prevents garbage collection from cleaning up the socket and will use more memory than necessary (maybe even causing a leak?).\r\n\r\nThis PR puts a separate try/except around `socket.close` and `socket.shutdown` to allow the socket to be closed after a failed shutdown.", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1797/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1797/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1794", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1794/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1794/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1794/events", "html_url": "https://github.com/redis/redis-py/pull/1794", "id": 1080936024, "node_id": "PR_kwDOAAWKjs4v4pIR", "number": 1794, "title": "Ensure redis_connect_func is set on uds connection", "user": {"login": "alisaifee", "id": 79842, "node_id": "MDQ6VXNlcjc5ODQy", "avatar_url": "https://avatars.githubusercontent.com/u/79842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alisaifee", "html_url": "https://github.com/alisaifee", "followers_url": "https://api.github.com/users/alisaifee/followers", "following_url": "https://api.github.com/users/alisaifee/following{/other_user}", "gists_url": "https://api.github.com/users/alisaifee/gists{/gist_id}", "starred_url": "https://api.github.com/users/alisaifee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alisaifee/subscriptions", "organizations_url": "https://api.github.com/users/alisaifee/orgs", "repos_url": "https://api.github.com/users/alisaifee/repos", "events_url": "https://api.github.com/users/alisaifee/events{/privacy}", "received_events_url": "https://api.github.com/users/alisaifee/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-12-15T11:40:36Z", "updated_at": "2021-12-15T13:00:07Z", "closed_at": "2021-12-15T13:00:06Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1794", "html_url": "https://github.com/redis/redis-py/pull/1794", "diff_url": "https://github.com/redis/redis-py/pull/1794.diff", "patch_url": "https://github.com/redis/redis-py/pull/1794.patch", "merged_at": "2021-12-15T13:00:06Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n- [ ] Is there an example added to the examples folder (if applicable)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\nFixes a regression introduced in #1660 when adding the `redis_connect_func` kwarg to the `Connection` base class which results in `UnixDomainSocketConnection` not being usable.\r\n\r\n#### Testing\r\nTo reproduce on master:\r\n```\r\n>>> import redis\r\n>>> redis.Redis.from_url(\"unix:///tmp/dirty.sock\").ping()\r\nTraceback (most recent call last):\r\n  File \"<input>\", line 1, in <module>\r\n    redis.Redis.from_url(\"unix:///tmp/dirty.sock\").ping()\r\n  File \"/var/tmp/redis-py/redis/commands/core.py\", line 805, in ping\r\n    return self.execute_command(\"PING\", **kwargs)\r\n  File \"/var/tmp/redis-py/redis/client.py\", line 1156, in execute_command\r\n    conn = self.connection or pool.get_connection(command_name, **options)\r\n  File \"/var/tmp/redis-py/redis/connection.py\", line 1245, in get_connection\r\n    connection.connect()\r\n  File \"/var/tmp/redis-py/redis/connection.py\", line 606, in connect\r\n    if self.redis_connect_func is None:\r\nAttributeError: 'UnixDomainSocketConnection' object has no attribute 'redis_connect_func'\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1794/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1794/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1791", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1791/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1791/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1791/events", "html_url": "https://github.com/redis/redis-py/pull/1791", "id": 1080757043, "node_id": "PR_kwDOAAWKjs4v4C_6", "number": 1791, "title": "Single sourcing the package version", "user": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-12-15T08:57:07Z", "updated_at": "2021-12-15T15:00:41Z", "closed_at": "2021-12-15T15:00:40Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1791", "html_url": "https://github.com/redis/redis-py/pull/1791", "diff_url": "https://github.com/redis/redis-py/pull/1791.diff", "patch_url": "https://github.com/redis/redis-py/pull/1791.patch", "merged_at": "2021-12-15T15:00:39Z"}, "body": "This PR single-sources the package version via setup.py's version, and for cases where the package is not installed (i.e local development), rely on 99.99.99.\r\n\r\ncloses #1784 ", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1791/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1791/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1788", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1788/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1788/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1788/events", "html_url": "https://github.com/redis/redis-py/issues/1788", "id": 1079365743, "node_id": "I_kwDOAAWKjs5AVdBv", "number": 1788, "title": "exception in listen", "user": {"login": "hzliu", "id": 1189916, "node_id": "MDQ6VXNlcjExODk5MTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1189916?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hzliu", "html_url": "https://github.com/hzliu", "followers_url": "https://api.github.com/users/hzliu/followers", "following_url": "https://api.github.com/users/hzliu/following{/other_user}", "gists_url": "https://api.github.com/users/hzliu/gists{/gist_id}", "starred_url": "https://api.github.com/users/hzliu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hzliu/subscriptions", "organizations_url": "https://api.github.com/users/hzliu/orgs", "repos_url": "https://api.github.com/users/hzliu/repos", "events_url": "https://api.github.com/users/hzliu/events{/privacy}", "received_events_url": "https://api.github.com/users/hzliu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-12-14T06:31:01Z", "updated_at": "2021-12-22T09:52:04Z", "closed_at": "2021-12-22T09:52:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "```python\r\nimport time\r\nimport redis\r\ndb = redis.from_url('redis://redis_server', health_check_interval=1.0)\r\nps = db.pubsub(ignore_subscribe_messages=True)\r\nps.subscribe('CHANNEL_NOT_EXISTS')\r\ntime.sleep(2)\r\nfor msg in ps.listen():\r\n    print(msg)\r\n```\r\nwill raise exception:\r\n\r\n```python\r\nTraceback (most recent call last):\r\n  File \"test_listen.py\", line 7, in <module>\r\n    for msg in ps.listen():\r\n  File \".../lib/python3.9/site-packages/redis/client.py\", line 3605, in listen\r\n    response = self.handle_message(self.parse_response(block=True))\r\n  File \".../lib/python3.9/site-packages/redis/client.py\", line 3635, in handle_message\r\n    message_type = nativestr(response[0])\r\nTypeError: 'NoneType' object is not subscriptable\r\n```\r\n\r\n`parse_response` returns None, since the first response is a health-check response.\r\n\r\nHappens on 3.5.2 and 4.0.2\r\n\r\nfix is straight forward:\r\n\r\n```python\r\n    def listen(self):\r\n        \"Listen for messages on channels this client has been subscribed to\"\r\n        while self.subscribed:\r\n            response = self.parse_response(block=True)\r\n            if response is None:\r\n                continue\r\n            response = self.handle_message(response)\r\n            if response is not None:\r\n                yield response\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1788/reactions", "total_count": 2, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 2}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1788/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1783", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1783/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1783/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1783/events", "html_url": "https://github.com/redis/redis-py/issues/1783", "id": 1077106472, "node_id": "I_kwDOAAWKjs5AM1co", "number": 1783, "title": "bool_ok() got an unexpected keyword argument 'once' with sentinel_ckquorum", "user": {"login": "kikijolicoeur", "id": 4021317, "node_id": "MDQ6VXNlcjQwMjEzMTc=", "avatar_url": "https://avatars.githubusercontent.com/u/4021317?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kikijolicoeur", "html_url": "https://github.com/kikijolicoeur", "followers_url": "https://api.github.com/users/kikijolicoeur/followers", "following_url": "https://api.github.com/users/kikijolicoeur/following{/other_user}", "gists_url": "https://api.github.com/users/kikijolicoeur/gists{/gist_id}", "starred_url": "https://api.github.com/users/kikijolicoeur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kikijolicoeur/subscriptions", "organizations_url": "https://api.github.com/users/kikijolicoeur/orgs", "repos_url": "https://api.github.com/users/kikijolicoeur/repos", "events_url": "https://api.github.com/users/kikijolicoeur/events{/privacy}", "received_events_url": "https://api.github.com/users/kikijolicoeur/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2021-12-10T18:11:05Z", "updated_at": "2021-12-26T09:03:30Z", "closed_at": "2021-12-26T09:00:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello.\r\n**Version**: redis-py: 4.0.2  redis version 6.2.5\r\n**Platform**: Python 3..7.3 Debian 10.10\r\n**Description**: \r\nWhen I run sentinel_ckquorum('mymaster') I have the following error message:\r\nbool_ok() got an unexpected keyword argument 'once'\r\n\r\nIn debug mode, I saw the good response from my sentinel server  (client.py line 1084 : response = connection.read_response()) \r\nb'OK 3 usable Sentinels. Quorum and failover authorization can be reached'\r\nThen the line 1090 is executed \"return self.response_callbacks[command_name](response, **options)\" and raises the exception about bool_ok()\r\nFollowing, the stack trace:\r\nException has occurred: TypeError       (note: full exception trace is shown but execution is paused at: _run_module_as_main)\r\nbool_ok() got an unexpected keyword argument 'once'\r\n  File \"/home/adm-croux/.virtualenvs/cgdm-paas-redis/lib/python3.7/site-packages/redis/client.py\", line 1090, in parse_response\r\n    return self.response_callbacks[command_name](response, **options)\r\n  File \"/home/adm-croux/.virtualenvs/cgdm-paas-redis/lib/python3.7/site-packages/redis/client.py\", line 1051, in _send_command_parse_response\r\n    return self.parse_response(conn, command_name, **options)\r\n  File \"/home/adm-croux/.virtualenvs/cgdm-paas-redis/lib/python3.7/site-packages/redis/client.py\", line 1075, in <lambda>\r\n    **options),\r\n  File \"/home/adm-croux/.virtualenvs/cgdm-paas-redis/lib/python3.7/site-packages/redis/retry.py\", line 32, in call_with_retry\r\n    return do()\r\n  File \"/home/adm-croux/.virtualenvs/cgdm-paas-redis/lib/python3.7/site-packages/redis/client.py\", line 1076, in execute_command\r\n    lambda error: self._disconnect_raise(conn, error))\r\n  File \"/home/adm-croux/.virtualenvs/cgdm-paas-redis/lib/python3.7/site-packages/redis/commands/sentinel.py\", line 79, in sentinel_ckquorum\r\n    once=True)\r\n\r\nThanks to have developed redis-py.\r\n\r\nBests regards \r\n\r\nChristian\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1783/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1783/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1772", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1772/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1772/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1772/events", "html_url": "https://github.com/redis/redis-py/issues/1772", "id": 1069976443, "node_id": "I_kwDOAAWKjs4_xot7", "number": 1772, "title": "Connection pool doesn't recover from aborts or resets", "user": {"login": "Enchufa2", "id": 4542928, "node_id": "MDQ6VXNlcjQ1NDI5Mjg=", "avatar_url": "https://avatars.githubusercontent.com/u/4542928?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Enchufa2", "html_url": "https://github.com/Enchufa2", "followers_url": "https://api.github.com/users/Enchufa2/followers", "following_url": "https://api.github.com/users/Enchufa2/following{/other_user}", "gists_url": "https://api.github.com/users/Enchufa2/gists{/gist_id}", "starred_url": "https://api.github.com/users/Enchufa2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Enchufa2/subscriptions", "organizations_url": "https://api.github.com/users/Enchufa2/orgs", "repos_url": "https://api.github.com/users/Enchufa2/repos", "events_url": "https://api.github.com/users/Enchufa2/events{/privacy}", "received_events_url": "https://api.github.com/users/Enchufa2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": {"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "dvora-h", "id": 67596500, "node_id": "MDQ6VXNlcjY3NTk2NTAw", "avatar_url": "https://avatars.githubusercontent.com/u/67596500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvora-h", "html_url": "https://github.com/dvora-h", "followers_url": "https://api.github.com/users/dvora-h/followers", "following_url": "https://api.github.com/users/dvora-h/following{/other_user}", "gists_url": "https://api.github.com/users/dvora-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvora-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvora-h/subscriptions", "organizations_url": "https://api.github.com/users/dvora-h/orgs", "repos_url": "https://api.github.com/users/dvora-h/repos", "events_url": "https://api.github.com/users/dvora-h/events{/privacy}", "received_events_url": "https://api.github.com/users/dvora-h/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2021-12-02T20:59:48Z", "updated_at": "2022-01-10T11:20:21Z", "closed_at": "2022-01-10T11:20:21Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Version**: 4.0.2\r\n\r\n**Platform**: Python 3.9.7 on Fedora 34\r\n\r\n**Description**: Steps to reproduce:\r\n\r\n1. Make redis establish a connection. For instance, in a local setting:\r\n\r\n```python\r\n>>> from redis import Redis()\r\n>>> redis = Redis()\r\n>>> redis.get(\"something\")\r\n```\r\n\r\n2. Now there's a connection in the pool. The connection gets killed somehow. For instance:\r\n\r\n```bash\r\n$ sudo ss -K dst [::1] dport = redis\r\n```\r\n\r\n3. Execute anything else:\r\n\r\n```python\r\n>>> redis.get(\"something\")\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/home/***/.local/lib/python3.9/site-packages/redis/commands/core.py\", line 1023, in get\r\n    return self.execute_command('GET', name)\r\n  File \"/home/***/.local/lib/python3.9/site-packages/redis/client.py\", line 1068, in execute_command\r\n    conn = self.connection or pool.get_connection(command_name, **options)\r\n  File \"/home/***/.local/lib/python3.9/site-packages/redis/connection.py\", line 1179, in get_connection\r\n    if connection.can_read():\r\n  File \"/home/***/.local/lib/python3.9/site-packages/redis/connection.py\", line 743, in can_read\r\n    return self._parser.can_read(timeout)\r\n  File \"/home/***/.local/lib/python3.9/site-packages/redis/connection.py\", line 315, in can_read\r\n    return self._buffer and self._buffer.can_read(timeout)\r\n  File \"/home/***/.local/lib/python3.9/site-packages/redis/connection.py\", line 224, in can_read\r\n    self._read_from_socket(timeout=timeout,\r\n  File \"/home/***/.local/lib/python3.9/site-packages/redis/connection.py\", line 192, in _read_from_socket\r\n    data = self._sock.recv(socket_read_size)\r\nConnectionAbortedError: [Errno 103] Software caused connection abort\r\n```\r\n\r\nThe same happens if there's a firewall that resets the connection, but then a `ConnectionResetError` is obtained instead. This doesn't happen with v3.5.3, which automatically detects the loss of connection and sets up a new one.", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1772/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1772/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1739", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1739/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1739/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1739/events", "html_url": "https://github.com/redis/redis-py/issues/1739", "id": 1060185242, "node_id": "I_kwDOAAWKjs4_MSSa", "number": 1739, "title": "Custom connection class overriden by redis uri ", "user": {"login": "m-novikov", "id": 5163640, "node_id": "MDQ6VXNlcjUxNjM2NDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5163640?v=4", "gravatar_id": "", "url": "https://api.github.com/users/m-novikov", "html_url": "https://github.com/m-novikov", "followers_url": "https://api.github.com/users/m-novikov/followers", "following_url": "https://api.github.com/users/m-novikov/following{/other_user}", "gists_url": "https://api.github.com/users/m-novikov/gists{/gist_id}", "starred_url": "https://api.github.com/users/m-novikov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/m-novikov/subscriptions", "organizations_url": "https://api.github.com/users/m-novikov/orgs", "repos_url": "https://api.github.com/users/m-novikov/repos", "events_url": "https://api.github.com/users/m-novikov/events{/privacy}", "received_events_url": "https://api.github.com/users/m-novikov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-11-22T13:54:51Z", "updated_at": "2021-12-02T14:02:44Z", "closed_at": "2021-12-02T14:02:44Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "It not possible to pass custom connection class via kwargs if redis uri starts with `rediss://` (secure connection) or `unix://`\r\n\r\n**Version**:  3.5.3\r\n**Platform**: pyton3.9, fedora\r\n\r\n**Description**: \r\n\r\nHere are tests to reproduce. Discussion in https://github.com/aio-libs/aioredis-py/issues/1209 implies that it's intentional, but I am not sure if this is expected behavior.\r\n\r\n```python\r\nimport pytest\r\nfrom redis import connection, from_url\r\n\r\n\r\n@pytest.mark.parametrize(\"proto,ConnBase\", [\r\n    (\"rediss\", connection.SSLConnection), \r\n    (\"unix\", connection.UnixDomainSocketConnection),\r\n])\r\ndef test_custom_connection_class_connection_pool(proto, ConnBase):\r\n    class MyConn(ConnBase):\r\n        pass\r\n\r\n    pool = connection.ConnectionPool.from_url(\r\n        url=f\"{proto}:///tmp/redis.sock\", connection_class=MyConn,\r\n    )\r\n    conn = pool.make_connection()\r\n    assert isinstance(conn, MyConn)\r\n\r\n\r\n@pytest.mark.parametrize(\"proto,ConnBase\", [\r\n    (\"rediss\", connection.SSLConnection), \r\n    (\"unix\", connection.UnixDomainSocketConnection),\r\n])\r\ndef test_from_url_custom_connection_class(proto, ConnBase):\r\n    class MyConn(ConnBase):\r\n        pass\r\n\r\n    redis = from_url(\r\n        url=f\"{proto}://127.0.0.1\", connection_class=MyConn,\r\n    )\r\n    conn = redis.connection_pool.make_connection()\r\n    assert isinstance(conn, MyConn)\r\n```\r\nRelated issue in aioredis-py https://github.com/aio-libs/aioredis-py/issues/1209", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1739/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1739/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1737", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1737/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1737/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1737/events", "html_url": "https://github.com/redis/redis-py/pull/1737", "id": 1059898296, "node_id": "PR_kwDOAAWKjs4u1sSd", "number": 1737, "title": "Fixing read race condition during pubsub", "user": {"login": "barshaul", "id": 88437685, "node_id": "MDQ6VXNlcjg4NDM3Njg1", "avatar_url": "https://avatars.githubusercontent.com/u/88437685?v=4", "gravatar_id": "", "url": "https://api.github.com/users/barshaul", "html_url": "https://github.com/barshaul", "followers_url": "https://api.github.com/users/barshaul/followers", "following_url": "https://api.github.com/users/barshaul/following{/other_user}", "gists_url": "https://api.github.com/users/barshaul/gists{/gist_id}", "starred_url": "https://api.github.com/users/barshaul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/barshaul/subscriptions", "organizations_url": "https://api.github.com/users/barshaul/orgs", "repos_url": "https://api.github.com/users/barshaul/repos", "events_url": "https://api.github.com/users/barshaul/events{/privacy}", "received_events_url": "https://api.github.com/users/barshaul/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2021-11-22T09:24:01Z", "updated_at": "2021-12-23T09:42:47Z", "closed_at": "2021-12-23T09:42:45Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1737", "html_url": "https://github.com/redis/redis-py/pull/1737", "diff_url": "https://github.com/redis/redis-py/pull/1737.diff", "patch_url": "https://github.com/redis/redis-py/pull/1737.patch", "merged_at": "2021-12-23T09:42:44Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [X ] Does `$ tox` pass with this change (including linting)?\r\n- [ X] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [X ] Is the new or changed code fully tested?\r\n- [ X] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\ncloses #1720 \r\ncloses #1740 \r\ncloses #1733 \r\n\r\nAnother implementation to #1720 (first impl: #1733)\r\nIn this PR i'm adding an option to call pubsub's method get_message() without subscribing first.\r\nIf get_message is called and no channel/pattern is subscribed, the method will return None without trying to read from the connection.\r\nWhen timeout is passed and no channels are yet subscribed, the get_message() function will wait for the first to arrive - either a subscription has been made or the time has expired.", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1737/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1737/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1733", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1733/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1733/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1733/events", "html_url": "https://github.com/redis/redis-py/pull/1733", "id": 1059392016, "node_id": "PR_kwDOAAWKjs4u0EmW", "number": 1733, "title": "Changed the PubSub's health check command to be performed only on the\u2026", "user": {"login": "barshaul", "id": 88437685, "node_id": "MDQ6VXNlcjg4NDM3Njg1", "avatar_url": "https://avatars.githubusercontent.com/u/88437685?v=4", "gravatar_id": "", "url": "https://api.github.com/users/barshaul", "html_url": "https://github.com/barshaul", "followers_url": "https://api.github.com/users/barshaul/followers", "following_url": "https://api.github.com/users/barshaul/following{/other_user}", "gists_url": "https://api.github.com/users/barshaul/gists{/gist_id}", "starred_url": "https://api.github.com/users/barshaul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/barshaul/subscriptions", "organizations_url": "https://api.github.com/users/barshaul/orgs", "repos_url": "https://api.github.com/users/barshaul/repos", "events_url": "https://api.github.com/users/barshaul/events{/privacy}", "received_events_url": "https://api.github.com/users/barshaul/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-11-21T14:18:59Z", "updated_at": "2021-12-22T14:52:19Z", "closed_at": "2021-12-22T14:52:19Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1733", "html_url": "https://github.com/redis/redis-py/pull/1733", "diff_url": "https://github.com/redis/redis-py/pull/1733.diff", "patch_url": "https://github.com/redis/redis-py/pull/1733.patch", "merged_at": null}, "body": "\u2026 first command execution.\r\n\r\n### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [V ] Does `$ tox` pass with this change (including linting)?\r\n- [V ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ V] Is the new or changed code fully tested?\r\n- [ V] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nClosing #1720:\r\n\r\nI reproduced the PubSub bug described in #1720 and was able to find the RC.\r\nWhen the PubSub's 'execute_command' method is being called it passes a 'health_check' bool to determine if it needs to run a health check. The 'health_check' value is set to **not self.subscribed**, which checks if the pubsub instance has any items in the channels/patterns lists. That means, that we perform a health check within the execute_command function only if we are not yet subscribed. All subsequent commands, after the first subscription, should be executed without performing a health check, since the channels/patterns list is no longer empty.\r\nThe pubsub's 'get_messages()' method can be used to poll published messages after a pubsub instance has been created. If a poller thread is created (thread that waits on get_message()) it will listen on the same socket as the pubsub execute_command is listening to when it performs a health check. Hence, we should not send a healthcheck using the pubsub execute_command function after the poller thread is initiated, since then it will be racing the poller thread to read the response from the socket.\r\n\r\nIn the example in #1720 we see the following flow:\r\n\r\n1. PubSub instance is being created\r\n2. Channel 'foo' is being subscribed - health check is performed since self.channels is empty\r\n3. 'PONG' is received \r\n4. A poller thread is being started, looping on 'get_messages()'\r\n5. The poller thread polls the 'subscribe' response\r\n6. Channel 'foo' is being unsubscribed, health check is not being performed since self.channels still contains 'foo'. 'foo' is removed from self.channels\r\n7. The poller thread polls the 'unsubscribe' response\r\n8. Channel 'baz' is being subscribed - health check is performed since self.channels is empty again\r\n9. The poller thread tries to poll the 'subscribe' response and gets the 'PONG' response instead\r\n10. The health check waits for a PONG response that has already been received by the poller thread, and is therefore timed out\r\n\r\nTherefore, we shouldn't use self.channels and self.patterns to determine whether a health check needs to be executed, but we should have another variable to indicate whether this is the first command execution, and if so, to run a health check. \r\n\r\nHowever, a poller thread may be started before subscribing to a channel, e.g. :\r\n\r\n1. ps = r.pubsub()\r\n2. poller = threading.Thread(target=poll, args=(ps,))\r\n3. ps.subscribe('foo')\r\n\r\nIn this case, the health check will be performed and we will still get a race reading from the socket with the poller thread. \r\nSo, my suggestion is to add a new 'cmd_execution_health_check' variable initiated with 'True' to the pubsub class and to set it to False on:\u00a0\r\n1. The end of execute_command method, so the health check will be performed only on the first execution), or\r\n2. get_message() function, so the health check will not be performed from the execute_command function at all.\r\nhealth checks are being done by the get_message() method, so no need to execute it also from the main command execution.  \r\n\r\nThis change fixes the reported bug.", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1733/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 1, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1733/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1730", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1730/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1730/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1730/events", "html_url": "https://github.com/redis/redis-py/pull/1730", "id": 1059316543, "node_id": "PR_kwDOAAWKjs4uz2Mo", "number": 1730, "title": "Fixing deprecating distutils (PEP 632) ", "user": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-11-21T08:00:42Z", "updated_at": "2021-11-25T14:32:29Z", "closed_at": "2021-11-25T14:32:29Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1730", "html_url": "https://github.com/redis/redis-py/pull/1730", "diff_url": "https://github.com/redis/redis-py/pull/1730.diff", "patch_url": "https://github.com/redis/redis-py/pull/1730.patch", "merged_at": "2021-11-25T14:32:28Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nfixes #1729 \r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1730/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1730/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1726", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1726/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1726/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1726/events", "html_url": "https://github.com/redis/redis-py/pull/1726", "id": 1056846754, "node_id": "PR_kwDOAAWKjs4usDy4", "number": 1726, "title": "Better removal of hiredis warning", "user": {"login": "wuisawesome", "id": 3980609, "node_id": "MDQ6VXNlcjM5ODA2MDk=", "avatar_url": "https://avatars.githubusercontent.com/u/3980609?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wuisawesome", "html_url": "https://github.com/wuisawesome", "followers_url": "https://api.github.com/users/wuisawesome/followers", "following_url": "https://api.github.com/users/wuisawesome/following{/other_user}", "gists_url": "https://api.github.com/users/wuisawesome/gists{/gist_id}", "starred_url": "https://api.github.com/users/wuisawesome/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wuisawesome/subscriptions", "organizations_url": "https://api.github.com/users/wuisawesome/orgs", "repos_url": "https://api.github.com/users/wuisawesome/repos", "events_url": "https://api.github.com/users/wuisawesome/events{/privacy}", "received_events_url": "https://api.github.com/users/wuisawesome/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-11-18T02:14:34Z", "updated_at": "2021-11-21T07:47:44Z", "closed_at": "2021-11-21T07:47:44Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1726", "html_url": "https://github.com/redis/redis-py/pull/1726", "diff_url": "https://github.com/redis/redis-py/pull/1726.diff", "patch_url": "https://github.com/redis/redis-py/pull/1726.patch", "merged_at": "2021-11-21T07:47:44Z"}, "body": "### Pull Request check-list\r\n\r\nIt looks like #1721 intended to remove the hiredis warning, but didn't fully remove it when byte buffers aren't available. \r\n\r\nThis PR tries to do the same thing, but remove the error message in the other case. \r\n\r\nCloses #1725\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\n_Please provide a description of the change here._\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1726/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1726/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1723", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1723/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1723/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1723/events", "html_url": "https://github.com/redis/redis-py/pull/1723", "id": 1056002382, "node_id": "PR_kwDOAAWKjs4upb9U", "number": 1723, "title": "fix: adding sentinelcommands to redis client", "user": {"login": "sculley", "id": 3237705, "node_id": "MDQ6VXNlcjMyMzc3MDU=", "avatar_url": "https://avatars.githubusercontent.com/u/3237705?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sculley", "html_url": "https://github.com/sculley", "followers_url": "https://api.github.com/users/sculley/followers", "following_url": "https://api.github.com/users/sculley/following{/other_user}", "gists_url": "https://api.github.com/users/sculley/gists{/gist_id}", "starred_url": "https://api.github.com/users/sculley/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sculley/subscriptions", "organizations_url": "https://api.github.com/users/sculley/orgs", "repos_url": "https://api.github.com/users/sculley/repos", "events_url": "https://api.github.com/users/sculley/events{/privacy}", "received_events_url": "https://api.github.com/users/sculley/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-11-17T11:12:34Z", "updated_at": "2021-11-21T07:47:59Z", "closed_at": "2021-11-21T07:47:59Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1723", "html_url": "https://github.com/redis/redis-py/pull/1723", "diff_url": "https://github.com/redis/redis-py/pull/1723.diff", "patch_url": "https://github.com/redis/redis-py/pull/1723.patch", "merged_at": "2021-11-21T07:47:59Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [ x ] Does `$ tox` pass with this change (including linting)?\r\n- [ x ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ x ] Is the new or changed code fully tested?\r\n- [ n/a ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n\r\n### Description of change\r\n\r\nSentinalCommands have not been available to the Redis client since v3.5.3, this change re-adds the functionality to run SentinelCommands using the Redis client returned when setting up the Sentinel class.\r\n\r\ncloses #1714 \r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1723/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1723/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1722", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1722/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1722/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1722/events", "html_url": "https://github.com/redis/redis-py/pull/1722", "id": 1055886941, "node_id": "PR_kwDOAAWKjs4upDxv", "number": 1722, "title": "Removing command on initial connections", "user": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-11-17T09:14:49Z", "updated_at": "2021-11-17T09:55:35Z", "closed_at": "2021-11-17T09:55:03Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1722", "html_url": "https://github.com/redis/redis-py/pull/1722", "diff_url": "https://github.com/redis/redis-py/pull/1722.diff", "patch_url": "https://github.com/redis/redis-py/pull/1722.patch", "merged_at": "2021-11-17T09:55:03Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1722/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1722/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1721", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1721/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1721/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1721/events", "html_url": "https://github.com/redis/redis-py/pull/1721", "id": 1055833085, "node_id": "PR_kwDOAAWKjs4uo4jn", "number": 1721, "title": "removing hiredis warning", "user": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-11-17T08:12:31Z", "updated_at": "2021-11-18T02:11:10Z", "closed_at": "2021-11-17T09:54:46Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1721", "html_url": "https://github.com/redis/redis-py/pull/1721", "diff_url": "https://github.com/redis/redis-py/pull/1721.diff", "patch_url": "https://github.com/redis/redis-py/pull/1721.patch", "merged_at": "2021-11-17T09:54:45Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1721/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1721/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1714", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1714/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1714/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1714/events", "html_url": "https://github.com/redis/redis-py/issues/1714", "id": 1053861312, "node_id": "I_kwDOAAWKjs4-0KXA", "number": 1714, "title": "AttributeError: 'Redis' object has no attribute 'sentinel_masters'", "user": {"login": "sculley", "id": 3237705, "node_id": "MDQ6VXNlcjMyMzc3MDU=", "avatar_url": "https://avatars.githubusercontent.com/u/3237705?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sculley", "html_url": "https://github.com/sculley", "followers_url": "https://api.github.com/users/sculley/followers", "following_url": "https://api.github.com/users/sculley/following{/other_user}", "gists_url": "https://api.github.com/users/sculley/gists{/gist_id}", "starred_url": "https://api.github.com/users/sculley/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sculley/subscriptions", "organizations_url": "https://api.github.com/users/sculley/orgs", "repos_url": "https://api.github.com/users/sculley/repos", "events_url": "https://api.github.com/users/sculley/events{/privacy}", "received_events_url": "https://api.github.com/users/sculley/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2021-11-15T16:28:34Z", "updated_at": "2022-01-03T15:09:59Z", "closed_at": "2021-11-21T07:47:59Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Version**: 4.0.0\r\n\r\n**Platform**: Python 3.7.12 / alpine / Kubernetes 1.20 / AWS / Redis server v=6.0.16 sha=00000000:0 malloc=jemalloc-5.1.0 bits=64 build=cb8b7c1889d3b7df\r\n\r\n**Description**: Unable to call sentinel.discover_master()\r\n\r\nWhen attempting to return the redis master from the sentinel hosts using `py-redis 4.0.0` using the discover_master SentinelCommand I receive the following Attribute error. \r\n\r\n```AttributeError: 'Redis' object has no attribute 'sentinel_masters'```\r\n\r\nI would expect to see a list of tuples containing the list of redis master ip/port\r\n\r\n```\r\n[('10.10.10.10', 6379)]\r\n```\r\n\r\nIt looks like the `Redis` client object returned when setting up the Sentinel class doesn't have access to the `sentinel_master` command found here https://github.com/redis/redis-py/blob/master/redis/commands/sentinel.py#L20 or any of the commands in that class.\r\n\r\nI have taken a look at the Redis class and can't find where `sentinel.py` is passing through the sentinel commands or where the `Redis` class in `client.py` is loading them.\r\n\r\n**Example**:\r\n\r\n```python\r\nPython 3.7.12 (default, Nov 13 2021, 04:28:59)\r\n[GCC 10.3.1 20210424] on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> from redis.sentinel import Sentinel\r\n/usr/local/lib/python3.7/site-packages/redis/connection.py:77: UserWarning: redis-py works best with hiredis. Please consider installing\r\n  warnings.warn(msg)\r\n>>> sentinel = Sentinel([('localhost', 5000)], socket_timeout=0.1)\r\n>>> master = sentinel.discover_master('mymaster')\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/usr/local/lib/python3.7/site-packages/redis/sentinel.py\", line 234, in discover_master\r\n    masters = sentinel.sentinel_masters()\r\nAttributeError: 'Redis' object has no attribute 'sentinel_masters'\r\n```\r\n\r\nI tried using version 3.5.3 and I don't get the error and the master host/port is returned in a tuple, so it would seem the problem is specific to version 4.0.0. I have tried with some of the RC releases and they have the problem. The only strange thing is that I was using the same code last week (and presumebly py-redis 4.0.0) and the code worked.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1714/reactions", "total_count": 16, "+1": 16, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1714/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1697", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1697/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1697/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1697/events", "html_url": "https://github.com/redis/redis-py/pull/1697", "id": 1050729903, "node_id": "PR_kwDOAAWKjs4uZNvW", "number": 1697, "title": "Restoring ZRANGE desc for Redis < 6.2.0", "user": {"login": "AvitalFineRedis", "id": 79420960, "node_id": "MDQ6VXNlcjc5NDIwOTYw", "avatar_url": "https://avatars.githubusercontent.com/u/79420960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AvitalFineRedis", "html_url": "https://github.com/AvitalFineRedis", "followers_url": "https://api.github.com/users/AvitalFineRedis/followers", "following_url": "https://api.github.com/users/AvitalFineRedis/following{/other_user}", "gists_url": "https://api.github.com/users/AvitalFineRedis/gists{/gist_id}", "starred_url": "https://api.github.com/users/AvitalFineRedis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AvitalFineRedis/subscriptions", "organizations_url": "https://api.github.com/users/AvitalFineRedis/orgs", "repos_url": "https://api.github.com/users/AvitalFineRedis/repos", "events_url": "https://api.github.com/users/AvitalFineRedis/events{/privacy}", "received_events_url": "https://api.github.com/users/AvitalFineRedis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-11-11T08:52:49Z", "updated_at": "2021-11-11T10:31:20Z", "closed_at": "2021-11-11T10:31:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1697", "html_url": "https://github.com/redis/redis-py/pull/1697", "diff_url": "https://github.com/redis/redis-py/pull/1697.diff", "patch_url": "https://github.com/redis/redis-py/pull/1697.patch", "merged_at": "2021-11-11T10:31:19Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [X] Does `$ tox` pass with this change (including linting)?\r\n- [X] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [X] Is the new or changed code fully tested?\r\n- [X] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\ncloses #1669\r\n\r\nIn the previous implementation of **zrange**, the user could use ``desc`` by calling to **zrevrange** behind the scene. Since redis 6.2.0, **zrange** supports ``REV`` label (and other new labels e.g LIMIT).\r\nWe want to be able to use desc without any other params (that will execute **zrevrange**), or to use ``desc`` with other new params, and then **zrange** will be called, but that can be done only when using redis > 6.2.0.\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1697/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1697/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1692", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1692/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1692/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1692/events", "html_url": "https://github.com/redis/redis-py/pull/1692", "id": 1049604865, "node_id": "PR_kwDOAAWKjs4uVjeS", "number": 1692, "title": "Response parsing occasionally fails to parse floats", "user": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-11-10T09:43:16Z", "updated_at": "2021-11-10T13:09:14Z", "closed_at": "2021-11-10T13:09:09Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1692", "html_url": "https://github.com/redis/redis-py/pull/1692", "diff_url": "https://github.com/redis/redis-py/pull/1692.diff", "patch_url": "https://github.com/redis/redis-py/pull/1692.patch", "merged_at": "2021-11-10T13:09:09Z"}, "body": "- filtering out codecov paths\n- parse_to_list fails to parse float values\n\n### Pull Request check-list\n\n_Please make sure to review and check all of these items:_\n\n- [ ] Does `$ tox` pass with this change (including linting)?\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\n- [ ] Is the new or changed code fully tested?\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\n\n_NOTE: these things are not required to open a PR and can be done\nafterwards / while the PR is open._\n\n### Description of change\n\n_Please provide a description of the change here._\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1692/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1692/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1676", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1676/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1676/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1676/events", "html_url": "https://github.com/redis/redis-py/pull/1676", "id": 1048410573, "node_id": "PR_kwDOAAWKjs4uRoS5", "number": 1676, "title": "Removing dependency on six", "user": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-11-09T10:02:36Z", "updated_at": "2021-11-09T10:17:10Z", "closed_at": "2021-11-09T10:17:09Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1676", "html_url": "https://github.com/redis/redis-py/pull/1676", "diff_url": "https://github.com/redis/redis-py/pull/1676.diff", "patch_url": "https://github.com/redis/redis-py/pull/1676.patch", "merged_at": "2021-11-09T10:17:09Z"}, "body": "In stanadalone installs, redis-py, starting in 4.0.0beta3 relied on six, this cleans that", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1676/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1676/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1674", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1674/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1674/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1674/events", "html_url": "https://github.com/redis/redis-py/pull/1674", "id": 1048347320, "node_id": "PR_kwDOAAWKjs4uRbIw", "number": 1674, "title": "Re-enable pipeline support for JSON and TimeSeries", "user": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-11-09T08:57:41Z", "updated_at": "2021-11-09T09:24:49Z", "closed_at": "2021-11-09T09:24:49Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1674", "html_url": "https://github.com/redis/redis-py/pull/1674", "diff_url": "https://github.com/redis/redis-py/pull/1674.diff", "patch_url": "https://github.com/redis/redis-py/pull/1674.patch", "merged_at": "2021-11-09T09:24:49Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1674/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1674/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1671", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1671/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1671/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1671/events", "html_url": "https://github.com/redis/redis-py/pull/1671", "id": 1047334838, "node_id": "PR_kwDOAAWKjs4uOImg", "number": 1671, "title": "Export Sentinel, and SSL like other classes", "user": {"login": "terencehonles", "id": 438813, "node_id": "MDQ6VXNlcjQzODgxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/438813?v=4", "gravatar_id": "", "url": "https://api.github.com/users/terencehonles", "html_url": "https://github.com/terencehonles", "followers_url": "https://api.github.com/users/terencehonles/followers", "following_url": "https://api.github.com/users/terencehonles/following{/other_user}", "gists_url": "https://api.github.com/users/terencehonles/gists{/gist_id}", "starred_url": "https://api.github.com/users/terencehonles/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/terencehonles/subscriptions", "organizations_url": "https://api.github.com/users/terencehonles/orgs", "repos_url": "https://api.github.com/users/terencehonles/repos", "events_url": "https://api.github.com/users/terencehonles/events{/privacy}", "received_events_url": "https://api.github.com/users/terencehonles/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-11-08T11:28:15Z", "updated_at": "2021-11-09T12:15:50Z", "closed_at": "2021-11-08T15:54:24Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1671", "html_url": "https://github.com/redis/redis-py/pull/1671", "diff_url": "https://github.com/redis/redis-py/pull/1671.diff", "patch_url": "https://github.com/redis/redis-py/pull/1671.patch", "merged_at": "2021-11-08T15:54:24Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [ ] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nNow that `Sentinel` needs to be used specifically instead of via `Redis`, this change exports the class at the top level like the `Redis` client is, and also allows the shorthand of `ssl=True` to set the connection class to the `SentinelManagedSSLConnection`.", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1671/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1671/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1670", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1670/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1670/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1670/events", "html_url": "https://github.com/redis/redis-py/pull/1670", "id": 1047124844, "node_id": "PR_kwDOAAWKjs4uNc1n", "number": 1670, "title": "Restore zrange functionality for older versions of Redis", "user": {"login": "AvitalFineRedis", "id": 79420960, "node_id": "MDQ6VXNlcjc5NDIwOTYw", "avatar_url": "https://avatars.githubusercontent.com/u/79420960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AvitalFineRedis", "html_url": "https://github.com/AvitalFineRedis", "followers_url": "https://api.github.com/users/AvitalFineRedis/followers", "following_url": "https://api.github.com/users/AvitalFineRedis/following{/other_user}", "gists_url": "https://api.github.com/users/AvitalFineRedis/gists{/gist_id}", "starred_url": "https://api.github.com/users/AvitalFineRedis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AvitalFineRedis/subscriptions", "organizations_url": "https://api.github.com/users/AvitalFineRedis/orgs", "repos_url": "https://api.github.com/users/AvitalFineRedis/repos", "events_url": "https://api.github.com/users/AvitalFineRedis/events{/privacy}", "received_events_url": "https://api.github.com/users/AvitalFineRedis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-11-08T07:52:42Z", "updated_at": "2021-11-08T15:52:06Z", "closed_at": "2021-11-08T15:51:55Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1670", "html_url": "https://github.com/redis/redis-py/pull/1670", "diff_url": "https://github.com/redis/redis-py/pull/1670.diff", "patch_url": "https://github.com/redis/redis-py/pull/1670.patch", "merged_at": "2021-11-08T15:51:54Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [x] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\ncloses #1669\r\nrevert zrange commands implementation to work with older redis versions (after the change in #1603)\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1670/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1670/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1669", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1669/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1669/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1669/events", "html_url": "https://github.com/redis/redis-py/issues/1669", "id": 1046772185, "node_id": "I_kwDOAAWKjs4-ZHnZ", "number": 1669, "title": "4.0.0rc1 breaks various zrange commands on older servers", "user": {"login": "bmerry", "id": 1963944, "node_id": "MDQ6VXNlcjE5NjM5NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1963944?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bmerry", "html_url": "https://github.com/bmerry", "followers_url": "https://api.github.com/users/bmerry/followers", "following_url": "https://api.github.com/users/bmerry/following{/other_user}", "gists_url": "https://api.github.com/users/bmerry/gists{/gist_id}", "starred_url": "https://api.github.com/users/bmerry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bmerry/subscriptions", "organizations_url": "https://api.github.com/users/bmerry/orgs", "repos_url": "https://api.github.com/users/bmerry/repos", "events_url": "https://api.github.com/users/bmerry/events{/privacy}", "received_events_url": "https://api.github.com/users/bmerry/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": {"login": "AvitalFineRedis", "id": 79420960, "node_id": "MDQ6VXNlcjc5NDIwOTYw", "avatar_url": "https://avatars.githubusercontent.com/u/79420960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AvitalFineRedis", "html_url": "https://github.com/AvitalFineRedis", "followers_url": "https://api.github.com/users/AvitalFineRedis/followers", "following_url": "https://api.github.com/users/AvitalFineRedis/following{/other_user}", "gists_url": "https://api.github.com/users/AvitalFineRedis/gists{/gist_id}", "starred_url": "https://api.github.com/users/AvitalFineRedis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AvitalFineRedis/subscriptions", "organizations_url": "https://api.github.com/users/AvitalFineRedis/orgs", "repos_url": "https://api.github.com/users/AvitalFineRedis/repos", "events_url": "https://api.github.com/users/AvitalFineRedis/events{/privacy}", "received_events_url": "https://api.github.com/users/AvitalFineRedis/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "AvitalFineRedis", "id": 79420960, "node_id": "MDQ6VXNlcjc5NDIwOTYw", "avatar_url": "https://avatars.githubusercontent.com/u/79420960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AvitalFineRedis", "html_url": "https://github.com/AvitalFineRedis", "followers_url": "https://api.github.com/users/AvitalFineRedis/followers", "following_url": "https://api.github.com/users/AvitalFineRedis/following{/other_user}", "gists_url": "https://api.github.com/users/AvitalFineRedis/gists{/gist_id}", "starred_url": "https://api.github.com/users/AvitalFineRedis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AvitalFineRedis/subscriptions", "organizations_url": "https://api.github.com/users/AvitalFineRedis/orgs", "repos_url": "https://api.github.com/users/AvitalFineRedis/repos", "events_url": "https://api.github.com/users/AvitalFineRedis/events{/privacy}", "received_events_url": "https://api.github.com/users/AvitalFineRedis/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2021-11-07T15:13:51Z", "updated_at": "2021-11-11T10:31:19Z", "closed_at": "2021-11-11T10:31:19Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Version**: redis-py 4.0.0rc1, redis 6.0.16 (or any less than 6.2).\r\n\r\n**Platform**: Python 3.8, Ubuntu 20.04\r\n\r\n**Description**:\r\n\r\nPreviously calling `zrevrange` or `zrange(..., desc=True)` would use ZREVRANGE on the wire. Somewhere between 4.0.0b1 and 4.0.0rc1 this changed to use `ZRANGE ... REV`, which is new syntax in Redis 6.2. When using an older server this causes a syntax error.\r\n\r\nTo reproduce:\r\n```python\r\nimport redis\r\nr = redis.Redis('localhost')\r\nr.zrevrange('foo', 0, -1)\r\n```\r\n\r\nOther commands are also affected e.g. zrangebyscore and zrangebylex are also using ZRANGE with options on the wire which is not supported pre-6.2.", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1669/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1669/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1665", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1665/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1665/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1665/events", "html_url": "https://github.com/redis/redis-py/pull/1665", "id": 1041380760, "node_id": "PR_kwDOAAWKjs4t7_2M", "number": 1665, "title": "Added boolean parsing to PEXPIRE and PEXPIREAT", "user": {"login": "WisdomPill", "id": 5825811, "node_id": "MDQ6VXNlcjU4MjU4MTE=", "avatar_url": "https://avatars.githubusercontent.com/u/5825811?v=4", "gravatar_id": "", "url": "https://api.github.com/users/WisdomPill", "html_url": "https://github.com/WisdomPill", "followers_url": "https://api.github.com/users/WisdomPill/followers", "following_url": "https://api.github.com/users/WisdomPill/following{/other_user}", "gists_url": "https://api.github.com/users/WisdomPill/gists{/gist_id}", "starred_url": "https://api.github.com/users/WisdomPill/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/WisdomPill/subscriptions", "organizations_url": "https://api.github.com/users/WisdomPill/orgs", "repos_url": "https://api.github.com/users/WisdomPill/repos", "events_url": "https://api.github.com/users/WisdomPill/events{/privacy}", "received_events_url": "https://api.github.com/users/WisdomPill/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 3458819498, "node_id": "LA_kwDOAAWKjs7OKWWq", "url": "https://api.github.com/repos/redis/redis-py/labels/breakingchange", "name": "breakingchange", "color": "038AF9", "default": false, "description": "API or Breaking Change"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-11-01T16:53:17Z", "updated_at": "2021-11-02T09:40:56Z", "closed_at": "2021-11-02T08:13:04Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1665", "html_url": "https://github.com/redis/redis-py/pull/1665", "diff_url": "https://github.com/redis/redis-py/pull/1665.diff", "patch_url": "https://github.com/redis/redis-py/pull/1665.patch", "merged_at": "2021-11-02T08:13:04Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [ ] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\n_Please provide a description of the change here._\r\nFixes: #1664 \r\n\r\n`pexpire` and `pexpire_at` will behave like their non p* counterpart parsing the return value into a boolean\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1665/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1665/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1656", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1656/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1656/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1656/events", "html_url": "https://github.com/redis/redis-py/pull/1656", "id": 1037077275, "node_id": "PR_kwDOAAWKjs4tuXKh", "number": 1656, "title": "Add python_requires setuptools check for python > 3.6", "user": {"login": "Nicusor97", "id": 33037485, "node_id": "MDQ6VXNlcjMzMDM3NDg1", "avatar_url": "https://avatars.githubusercontent.com/u/33037485?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nicusor97", "html_url": "https://github.com/Nicusor97", "followers_url": "https://api.github.com/users/Nicusor97/followers", "following_url": "https://api.github.com/users/Nicusor97/following{/other_user}", "gists_url": "https://api.github.com/users/Nicusor97/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nicusor97/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nicusor97/subscriptions", "organizations_url": "https://api.github.com/users/Nicusor97/orgs", "repos_url": "https://api.github.com/users/Nicusor97/repos", "events_url": "https://api.github.com/users/Nicusor97/events{/privacy}", "received_events_url": "https://api.github.com/users/Nicusor97/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}, {"id": 3458819498, "node_id": "LA_kwDOAAWKjs7OKWWq", "url": "https://api.github.com/repos/redis/redis-py/labels/breakingchange", "name": "breakingchange", "color": "038AF9", "default": false, "description": "API or Breaking Change"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-10-27T07:36:39Z", "updated_at": "2021-10-27T12:10:31Z", "closed_at": "2021-10-27T12:10:31Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1656", "html_url": "https://github.com/redis/redis-py/pull/1656", "diff_url": "https://github.com/redis/redis-py/pull/1656.diff", "patch_url": "https://github.com/redis/redis-py/pull/1656.patch", "merged_at": "2021-10-27T12:10:31Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nI noticed that in your latest release candidate version 4.0.0b3 the Python 2.7 support has been removed but your forgot to add the `python_requires` check that will prevent users with Python 2.7 from downloading a sdist version that they cannot build on Python 2.7. \r\n\r\nNote: supporting python_requires requires setuptools>=24.2.0 and pip>=9.0.0 to benefit from it.\r\nDetails here: https://packaging.python.org/guides/distributing-packages-using-setuptools/#python-requires\r\n\r\nI open this MR in order to merge the python_requires before releasing the official version because if the official version will not have this check, the Python 2 users will not be able to build the sdist and in the end that new version should be yanked and release a new version with the python_requires check. \r\n\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1656/reactions", "total_count": 2, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 1, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1656/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1645", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1645/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1645/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1645/events", "html_url": "https://github.com/redis/redis-py/issues/1645", "id": 1036043515, "node_id": "I_kwDOAAWKjs49wMT7", "number": 1645, "title": "redis.commands module missing in pypi release 4.0.0b2", "user": {"login": "guigarfr", "id": 3531331, "node_id": "MDQ6VXNlcjM1MzEzMzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3531331?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guigarfr", "html_url": "https://github.com/guigarfr", "followers_url": "https://api.github.com/users/guigarfr/followers", "following_url": "https://api.github.com/users/guigarfr/following{/other_user}", "gists_url": "https://api.github.com/users/guigarfr/gists{/gist_id}", "starred_url": "https://api.github.com/users/guigarfr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guigarfr/subscriptions", "organizations_url": "https://api.github.com/users/guigarfr/orgs", "repos_url": "https://api.github.com/users/guigarfr/repos", "events_url": "https://api.github.com/users/guigarfr/events{/privacy}", "received_events_url": "https://api.github.com/users/guigarfr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2021-10-26T09:14:47Z", "updated_at": "2021-10-26T11:13:21Z", "closed_at": "2021-10-26T11:13:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "`client.py` is trying to import from the `redis.commands` module, and this import raises `ModuleNotFoundError: No module named 'redis.commands'`\r\n\r\n```\r\n.../site-packages/redis/client.py:9: in <module>\r\n    from redis.commands import CoreCommands, RedisModuleCommands, list_or_args\r\n    E   ModuleNotFoundError: No module named 'redis.commands'\r\n```\r\n\r\n\r\n**Version**: 4.0.0b2\r\n\r\n**Platform**: Ubuntu\r\n\r\n**Description**:\r\n\r\nI'm getting the error `ModuleNotFoundError: No module named 'redis.commands'` after installing redis version 4.0.0b2\r\n\r\nAccording to github, the tag 4.0.0b2 has a [module named commands](https://github.com/redis/redis-py/blob/v4.0.0b2/redis/commands/__init__.py).\r\nWhen downloading the [tar.gz from pypi](https://files.pythonhosted.org/packages/55/bc/f482cb78c9dae1561d45a3532de34cd15f7cbebc8777146a60d185830d26/redis-4.0.0b2.tar.gz), the module is not there.\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1645/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1645/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1641", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1641/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1641/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1641/events", "html_url": "https://github.com/redis/redis-py/pull/1641", "id": 1034963307, "node_id": "PR_kwDOAAWKjs4tnd-0", "number": 1641, "title": "Pre 6.2 redis should default to None for script flush", "user": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-10-25T10:34:04Z", "updated_at": "2021-10-25T11:04:48Z", "closed_at": "2021-10-25T10:41:07Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1641", "html_url": "https://github.com/redis/redis-py/pull/1641", "diff_url": "https://github.com/redis/redis-py/pull/1641.diff", "patch_url": "https://github.com/redis/redis-py/pull/1641.patch", "merged_at": "2021-10-25T10:41:07Z"}, "body": "closes #1639\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1641/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1641/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1639", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1639/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1639/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1639/events", "html_url": "https://github.com/redis/redis-py/issues/1639", "id": 1034939551, "node_id": "I_kwDOAAWKjs49r-yf", "number": 1639, "title": "4.0.0b1 breaks script_flush on pre-6.2 server", "user": {"login": "bmerry", "id": 1963944, "node_id": "MDQ6VXNlcjE5NjM5NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1963944?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bmerry", "html_url": "https://github.com/bmerry", "followers_url": "https://api.github.com/users/bmerry/followers", "following_url": "https://api.github.com/users/bmerry/following{/other_user}", "gists_url": "https://api.github.com/users/bmerry/gists{/gist_id}", "starred_url": "https://api.github.com/users/bmerry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bmerry/subscriptions", "organizations_url": "https://api.github.com/users/bmerry/orgs", "repos_url": "https://api.github.com/users/bmerry/repos", "events_url": "https://api.github.com/users/bmerry/events{/privacy}", "received_events_url": "https://api.github.com/users/bmerry/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-10-25T10:10:36Z", "updated_at": "2021-10-25T10:41:07Z", "closed_at": "2021-10-25T10:41:07Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Version**: redis-py 4.0.0b1, redis 5.0.7\r\n\r\n**Platform**: Python 3.8.10 on Ubunutu 20.04\r\n\r\n**Description**: In 4.0.0b1, the implementation of `script_flush` always calls either `SCRIPT FLUSH SYNC` or `SCRIPT FLUSH ASYNC` on the server. However, the SYNC/ASYNC modifier was only added in Redis 6.2, making it fail on older versions.\r\n\r\nTo reproduce (assuming a Redis server on localhost):\r\n```python\r\nimport redis\r\nr = redis.Redis('localhost')\r\nr.script_flush()\r\n```\r\n\r\nResult: `ResponseError: Unknown subcommand or wrong number of arguments for 'FLUSH'. Try SCRIPT HELP.`\r\n\r\nApart from wanting to support older Redis versions, the [documentation](https://redis.io/commands/script-flush) suggests that providing neither modifier is not simply equivalent to providing SYNC. Rather, it leaves it up to a configuration setting on the server, and I feel like calling `r.script_flush()` should respect that server-side default.", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1639/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1639/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1635", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1635/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1635/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1635/events", "html_url": "https://github.com/redis/redis-py/pull/1635", "id": 1032277417, "node_id": "PR_kwDOAAWKjs4te8lU", "number": 1635, "title": "Enable floating parameters in SET (ex and px)", "user": {"login": "AvitalFineRedis", "id": 79420960, "node_id": "MDQ6VXNlcjc5NDIwOTYw", "avatar_url": "https://avatars.githubusercontent.com/u/79420960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AvitalFineRedis", "html_url": "https://github.com/AvitalFineRedis", "followers_url": "https://api.github.com/users/AvitalFineRedis/followers", "following_url": "https://api.github.com/users/AvitalFineRedis/following{/other_user}", "gists_url": "https://api.github.com/users/AvitalFineRedis/gists{/gist_id}", "starred_url": "https://api.github.com/users/AvitalFineRedis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AvitalFineRedis/subscriptions", "organizations_url": "https://api.github.com/users/AvitalFineRedis/orgs", "repos_url": "https://api.github.com/users/AvitalFineRedis/repos", "events_url": "https://api.github.com/users/AvitalFineRedis/events{/privacy}", "received_events_url": "https://api.github.com/users/AvitalFineRedis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-10-21T09:40:32Z", "updated_at": "2021-10-21T14:23:34Z", "closed_at": "2021-10-21T14:23:33Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1635", "html_url": "https://github.com/redis/redis-py/pull/1635", "diff_url": "https://github.com/redis/redis-py/pull/1635.diff", "patch_url": "https://github.com/redis/redis-py/pull/1635.patch", "merged_at": "2021-10-21T14:23:33Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [x] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nCloses #1576 \r\nNow it is possible to use floating numbers without getting an error.\r\nOne thing I have in mind - If the floating number is not rounded, i.e., 10.5, the command will use the integer 10.\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1635/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1635/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1626", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1626/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1626/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1626/events", "html_url": "https://github.com/redis/redis-py/pull/1626", "id": 1029917371, "node_id": "PR_kwDOAAWKjs4tXaDt", "number": 1626, "title": "Removing packaging dependency", "user": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-10-19T06:40:13Z", "updated_at": "2021-10-19T10:05:12Z", "closed_at": "2021-10-19T10:05:10Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1626", "html_url": "https://github.com/redis/redis-py/pull/1626", "diff_url": "https://github.com/redis/redis-py/pull/1626.diff", "patch_url": "https://github.com/redis/redis-py/pull/1626.patch", "merged_at": "2021-10-19T10:05:10Z"}, "body": "distutils is built-in.\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1626/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1626/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1621", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1621/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1621/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1621/events", "html_url": "https://github.com/redis/redis-py/pull/1621", "id": 1028317480, "node_id": "PR_kwDOAAWKjs4tSiBL", "number": 1621, "title": "Add warning when hiredis not installed. Recommend installation.", "user": {"login": "adiamzn", "id": 92513900, "node_id": "U_kgDOBYOmbA", "avatar_url": "https://avatars.githubusercontent.com/u/92513900?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adiamzn", "html_url": "https://github.com/adiamzn", "followers_url": "https://api.github.com/users/adiamzn/followers", "following_url": "https://api.github.com/users/adiamzn/following{/other_user}", "gists_url": "https://api.github.com/users/adiamzn/gists{/gist_id}", "starred_url": "https://api.github.com/users/adiamzn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adiamzn/subscriptions", "organizations_url": "https://api.github.com/users/adiamzn/orgs", "repos_url": "https://api.github.com/users/adiamzn/repos", "events_url": "https://api.github.com/users/adiamzn/events{/privacy}", "received_events_url": "https://api.github.com/users/adiamzn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-10-17T13:01:44Z", "updated_at": "2021-10-19T10:14:49Z", "closed_at": "2021-10-19T10:14:49Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1621", "html_url": "https://github.com/redis/redis-py/pull/1621", "diff_url": "https://github.com/redis/redis-py/pull/1621.diff", "patch_url": "https://github.com/redis/redis-py/pull/1621.patch", "merged_at": "2021-10-19T10:14:49Z"}, "body": "### Description of change\r\nAdds warning when hiredis parser not available. Recommends installing it.\r\n\r\n### Why the change?\r\nredispy works best with the hiredis parser.\r\nCurrently, if an out-of-date hiredis parser is installed a warning is given (the warning recommends upgrading the hiredis parser)\r\nSurprisingly, when no version of the hiredis parser is available, redispy silently defaults to a native python parser with much poorer performance.\r\n\r\nInstead of silently defaulting to a native python parser, this change warns the potentially unaware user and recommends installing the hiredis parser.", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1621/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1621/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1602", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1602/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1602/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1602/events", "html_url": "https://github.com/redis/redis-py/pull/1602", "id": 1024926344, "node_id": "PR_kwDOAAWKjs4tIPFm", "number": 1602, "title": "Add support to consumername in `xpending_range` ", "user": {"login": "AvitalFineRedis", "id": 79420960, "node_id": "MDQ6VXNlcjc5NDIwOTYw", "avatar_url": "https://avatars.githubusercontent.com/u/79420960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AvitalFineRedis", "html_url": "https://github.com/AvitalFineRedis", "followers_url": "https://api.github.com/users/AvitalFineRedis/followers", "following_url": "https://api.github.com/users/AvitalFineRedis/following{/other_user}", "gists_url": "https://api.github.com/users/AvitalFineRedis/gists{/gist_id}", "starred_url": "https://api.github.com/users/AvitalFineRedis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AvitalFineRedis/subscriptions", "organizations_url": "https://api.github.com/users/AvitalFineRedis/orgs", "repos_url": "https://api.github.com/users/AvitalFineRedis/repos", "events_url": "https://api.github.com/users/AvitalFineRedis/events{/privacy}", "received_events_url": "https://api.github.com/users/AvitalFineRedis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": {"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "chayim", "id": 1333958, "node_id": "MDQ6VXNlcjEzMzM5NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1333958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chayim", "html_url": "https://github.com/chayim", "followers_url": "https://api.github.com/users/chayim/followers", "following_url": "https://api.github.com/users/chayim/following{/other_user}", "gists_url": "https://api.github.com/users/chayim/gists{/gist_id}", "starred_url": "https://api.github.com/users/chayim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chayim/subscriptions", "organizations_url": "https://api.github.com/users/chayim/orgs", "repos_url": "https://api.github.com/users/chayim/repos", "events_url": "https://api.github.com/users/chayim/events{/privacy}", "received_events_url": "https://api.github.com/users/chayim/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-10-13T08:06:22Z", "updated_at": "2021-10-19T12:37:03Z", "closed_at": "2021-10-19T10:04:47Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1602", "html_url": "https://github.com/redis/redis-py/pull/1602", "diff_url": "https://github.com/redis/redis-py/pull/1602.diff", "patch_url": "https://github.com/redis/redis-py/pull/1602.patch", "merged_at": "2021-10-19T10:04:46Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [x] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n\r\n_NOTE: these things are not required to open a PR and can be done\r\nafterwards / while the PR is open._\r\n\r\n### Description of change\r\n\r\nAdd support to consumername parameter in `xpending_range` . Closes #1592 ", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1602/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1602/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1583", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1583/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1583/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1583/events", "html_url": "https://github.com/redis/redis-py/issues/1583", "id": 1012949629, "node_id": "I_kwDOAAWKjs48YGJ9", "number": 1583, "title": "Redis-py deadlocks during garbage collection", "user": {"login": "emorozov", "id": 365658, "node_id": "MDQ6VXNlcjM2NTY1OA==", "avatar_url": "https://avatars.githubusercontent.com/u/365658?v=4", "gravatar_id": "", "url": "https://api.github.com/users/emorozov", "html_url": "https://github.com/emorozov", "followers_url": "https://api.github.com/users/emorozov/followers", "following_url": "https://api.github.com/users/emorozov/following{/other_user}", "gists_url": "https://api.github.com/users/emorozov/gists{/gist_id}", "starred_url": "https://api.github.com/users/emorozov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/emorozov/subscriptions", "organizations_url": "https://api.github.com/users/emorozov/orgs", "repos_url": "https://api.github.com/users/emorozov/repos", "events_url": "https://api.github.com/users/emorozov/events{/privacy}", "received_events_url": "https://api.github.com/users/emorozov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-10-01T06:25:34Z", "updated_at": "2021-11-15T07:10:58Z", "closed_at": "2021-11-15T07:10:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Problem is pretty serious and it seems that there're lots of people affected, including almost all (!) users of Celery, because it would attempt to connect to Redis even if you simply enabled Redis backend, and this will cause mysterious hangs several times a week.\r\n\r\nMore detailed description and tracebacks are in the pull request and related Celery pull request (initially I thought that the problem is caused by Celery code):\r\nhttps://github.com/andymccurdy/redis-py/pull/1578\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1583/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1583/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1578", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1578/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1578/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1578/events", "html_url": "https://github.com/redis/redis-py/pull/1578", "id": 1008188018, "node_id": "PR_kwDOAAWKjs4sUM8B", "number": 1578, "title": "Fix garbage collection deadlock", "user": {"login": "emorozov", "id": 365658, "node_id": "MDQ6VXNlcjM2NTY1OA==", "avatar_url": "https://avatars.githubusercontent.com/u/365658?v=4", "gravatar_id": "", "url": "https://api.github.com/users/emorozov", "html_url": "https://github.com/emorozov", "followers_url": "https://api.github.com/users/emorozov/followers", "following_url": "https://api.github.com/users/emorozov/following{/other_user}", "gists_url": "https://api.github.com/users/emorozov/gists{/gist_id}", "starred_url": "https://api.github.com/users/emorozov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/emorozov/subscriptions", "organizations_url": "https://api.github.com/users/emorozov/orgs", "repos_url": "https://api.github.com/users/emorozov/repos", "events_url": "https://api.github.com/users/emorozov/events{/privacy}", "received_events_url": "https://api.github.com/users/emorozov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 2217880629, "node_id": "MDU6TGFiZWwyMjE3ODgwNjI5", "url": "https://api.github.com/repos/redis/redis-py/labels/help-wanted", "name": "help-wanted", "color": "017501", "default": false, "description": ""}, {"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2021-09-27T13:59:36Z", "updated_at": "2021-11-08T06:59:14Z", "closed_at": "2021-11-08T06:59:14Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/redis/redis-py/pulls/1578", "html_url": "https://github.com/redis/redis-py/pull/1578", "diff_url": "https://github.com/redis/redis-py/pull/1578.diff", "patch_url": "https://github.com/redis/redis-py/pull/1578.patch", "merged_at": "2021-11-08T06:59:14Z"}, "body": "### Pull Request check-list\r\n\r\n_Please make sure to review and check all of these items:_\r\n\r\n- [x] Does `$ tox` pass with this change (including linting)?\r\n- [x] Do the CI tests pass with this change (enable it first in your forked repo and wait for the github action build to finish)?\r\n- [x] Is the new or changed code fully tested?\r\n- [ ] Is a documentation update included (if this change modifies existing APIs, or introduces new ones)?\r\n\r\nFor a long time we experienced weird lockups of the Celery package when using Redis backend (even when using redis backend only for results).\r\n\r\nAfter weeks of debugging, I've found a culprit: `PubSub` objects create a circular reference to self via `connection.register_connect_callback`. This means that `PubSub` objects are not garbage collected immediately, when their refcount decreases to zero, they're collected asynchronously using generational GC.\r\n\r\nAlso, `PubSub` defines a destructor that releases a connection from pool. Pool uses threading.Lock when managing connections. If some pool method grabs the lock and at the same time `PubSub` object is garbage collected (which is pretty likely as our celery instances lock up at least once a week), `PubSub` destructor deadlocks forever waiting for a lock that will be never released.\r\n\r\nI've decided that the only solution to this problem is to avoid creating circular references to `PubSub` objects.\r\n\r\nTest look weird and I'm worried that it is a bit fragile, but I failed to devise a scheme that would cause Python garbage collector to run at exact moment in time when the pool is inside critical section. So the test run enough cycles to cause a problem. But different interpreters/different gc settings may cause a test to finish without locking up. I don't know how to solve that.\r\n\r\nIt runs on CPython 3.9 though: without weakref changes, the test will hang forever until pytest-timeout will cancel it.\r\n", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1578/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1578/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/redis/redis-py/issues/1576", "repository_url": "https://api.github.com/repos/redis/redis-py", "labels_url": "https://api.github.com/repos/redis/redis-py/issues/1576/labels{/name}", "comments_url": "https://api.github.com/repos/redis/redis-py/issues/1576/comments", "events_url": "https://api.github.com/repos/redis/redis-py/issues/1576/events", "html_url": "https://github.com/redis/redis-py/issues/1576", "id": 998664679, "node_id": "I_kwDOAAWKjs47hmnn", "number": 1576, "title": "error in set when ex is a float is confusing", "user": {"login": "AntiCompositeNumber", "id": 10331574, "node_id": "MDQ6VXNlcjEwMzMxNTc0", "avatar_url": "https://avatars.githubusercontent.com/u/10331574?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AntiCompositeNumber", "html_url": "https://github.com/AntiCompositeNumber", "followers_url": "https://api.github.com/users/AntiCompositeNumber/followers", "following_url": "https://api.github.com/users/AntiCompositeNumber/following{/other_user}", "gists_url": "https://api.github.com/users/AntiCompositeNumber/gists{/gist_id}", "starred_url": "https://api.github.com/users/AntiCompositeNumber/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AntiCompositeNumber/subscriptions", "organizations_url": "https://api.github.com/users/AntiCompositeNumber/orgs", "repos_url": "https://api.github.com/users/AntiCompositeNumber/repos", "events_url": "https://api.github.com/users/AntiCompositeNumber/events{/privacy}", "received_events_url": "https://api.github.com/users/AntiCompositeNumber/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 2217881398, "node_id": "MDU6TGFiZWwyMjE3ODgxMzk4", "url": "https://api.github.com/repos/redis/redis-py/labels/good%20first%20issue", "name": "good first issue", "color": "149154", "default": true, "description": ""}, {"id": 3458817995, "node_id": "LA_kwDOAAWKjs7OKV_L", "url": "https://api.github.com/repos/redis/redis-py/labels/bug", "name": "bug", "color": "1F3D73", "default": true, "description": "Bug"}], "state": "closed", "locked": false, "assignee": {"login": "AvitalFineRedis", "id": 79420960, "node_id": "MDQ6VXNlcjc5NDIwOTYw", "avatar_url": "https://avatars.githubusercontent.com/u/79420960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AvitalFineRedis", "html_url": "https://github.com/AvitalFineRedis", "followers_url": "https://api.github.com/users/AvitalFineRedis/followers", "following_url": "https://api.github.com/users/AvitalFineRedis/following{/other_user}", "gists_url": "https://api.github.com/users/AvitalFineRedis/gists{/gist_id}", "starred_url": "https://api.github.com/users/AvitalFineRedis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AvitalFineRedis/subscriptions", "organizations_url": "https://api.github.com/users/AvitalFineRedis/orgs", "repos_url": "https://api.github.com/users/AvitalFineRedis/repos", "events_url": "https://api.github.com/users/AvitalFineRedis/events{/privacy}", "received_events_url": "https://api.github.com/users/AvitalFineRedis/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "AvitalFineRedis", "id": 79420960, "node_id": "MDQ6VXNlcjc5NDIwOTYw", "avatar_url": "https://avatars.githubusercontent.com/u/79420960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AvitalFineRedis", "html_url": "https://github.com/AvitalFineRedis", "followers_url": "https://api.github.com/users/AvitalFineRedis/followers", "following_url": "https://api.github.com/users/AvitalFineRedis/following{/other_user}", "gists_url": "https://api.github.com/users/AvitalFineRedis/gists{/gist_id}", "starred_url": "https://api.github.com/users/AvitalFineRedis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AvitalFineRedis/subscriptions", "organizations_url": "https://api.github.com/users/AvitalFineRedis/orgs", "repos_url": "https://api.github.com/users/AvitalFineRedis/repos", "events_url": "https://api.github.com/users/AvitalFineRedis/events{/privacy}", "received_events_url": "https://api.github.com/users/AvitalFineRedis/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-09-16T21:42:15Z", "updated_at": "2021-10-21T14:23:33Z", "closed_at": "2021-10-21T14:23:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Version**: redis-py 3.5.3\r\n\r\n**Platform**: Python 3.7.3 (default, Jan 22 2021, 20:04:44) [GCC 8.3.0] on linux\r\n\r\n**Description**:\r\n```py\r\n>>> import redis\r\n>>> r = redis.Redis(host='localhost', port=6379, db=0)\r\n>>> r.set('foo', 'bar', ex=10.0)\r\nTraceback (most recent call last):\r\n  File \"/redis/client.py\", line 1801, in set\r\n    return self.execute_command('SET', *pieces)\r\n  File \"/redis/client.py\", line 901, in execute_command\r\n    return self.parse_response(conn, command_name, **options)\r\n  File \"/redis/client.py\", line 915, in parse_response\r\n    response = connection.read_response()\r\n  File \"/redis/connection.py\", line 756, in read_response\r\n    raise response\r\nredis.exceptions.ResponseError: value is not an integer or out of range\r\n```\r\nThis exception is confusing, because it doesn't specify which value is supposed to be an integer. There is a parameter to set called \"value\", but that's not what caused the exception. It would be better to validate that ex is an integer and raise something like `TypeError: ex must be int or timedelta, not \"float\"`.", "reactions": {"url": "https://api.github.com/repos/redis/redis-py/issues/1576/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/redis/redis-py/issues/1576/timeline", "performed_via_github_app": null, "state_reason": "completed"}]