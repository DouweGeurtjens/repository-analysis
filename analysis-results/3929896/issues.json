[{"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1455", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1455/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1455/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1455/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/1455", "id": 635421125, "node_id": "MDU6SXNzdWU2MzU0MjExMjU=", "number": 1455, "title": "Wrong metagraph defninitions", "user": {"login": "Adblu", "id": 34426707, "node_id": "MDQ6VXNlcjM0NDI2NzA3", "avatar_url": "https://avatars.githubusercontent.com/u/34426707?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Adblu", "html_url": "https://github.com/Adblu", "followers_url": "https://api.github.com/users/Adblu/followers", "following_url": "https://api.github.com/users/Adblu/following{/other_user}", "gists_url": "https://api.github.com/users/Adblu/gists{/gist_id}", "starred_url": "https://api.github.com/users/Adblu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Adblu/subscriptions", "organizations_url": "https://api.github.com/users/Adblu/orgs", "repos_url": "https://api.github.com/users/Adblu/repos", "events_url": "https://api.github.com/users/Adblu/events{/privacy}", "received_events_url": "https://api.github.com/users/Adblu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-06-09T13:16:51Z", "updated_at": "2020-06-26T17:49:07Z", "closed_at": "2020-06-09T17:48:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "This is how my metagraph definition looks like:\r\n\r\n```\r\nMetaGraphDef with tag-set: 's, e, r, v, e' contains the following SignatureDefs:\r\n\r\nsignature_def['serving_default']:\r\n  The given SavedModel SignatureDef contains the following input(s):\r\n    inputs['image:0'] tensor_info:\r\n        dtype: DT_FLOAT\r\n        shape: (-1, -1, 3)\r\n        name: image:0\r\n  The given SavedModel SignatureDef contains the following output(s):\r\n    outputs['output/boxes:0'] tensor_info:\r\n        dtype: DT_FLOAT\r\n        shape: (-1, 4)\r\n        name: output/boxes:0\r\n    outputs['output/labels:0'] tensor_info:\r\n        dtype: DT_INT64\r\n        shape: (-1)\r\n        name: output/labels:0\r\n    outputs['output/masks:0'] tensor_info:\r\n        dtype: DT_FLOAT\r\n        shape: (-1, 28, 28)\r\n        name: output/masks:0\r\n    outputs['output/scores:0'] tensor_info:\r\n        dtype: DT_FLOAT\r\n        shape: (-1)\r\n        name: output/scores:0\r\n  Method name is: tensorflow/serving/predict\r\n```\r\nI dont think \" 's, e, r, v, e' \" is normal.\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1455/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1455/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1252", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1252/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1252/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1252/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/1252", "id": 463791510, "node_id": "MDU6SXNzdWU0NjM3OTE1MTA=", "number": 1252, "title": "Nested argscopes behave weird", "user": {"login": "TomoshibiAkira", "id": 3897907, "node_id": "MDQ6VXNlcjM4OTc5MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/3897907?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TomoshibiAkira", "html_url": "https://github.com/TomoshibiAkira", "followers_url": "https://api.github.com/users/TomoshibiAkira/followers", "following_url": "https://api.github.com/users/TomoshibiAkira/following{/other_user}", "gists_url": "https://api.github.com/users/TomoshibiAkira/gists{/gist_id}", "starred_url": "https://api.github.com/users/TomoshibiAkira/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TomoshibiAkira/subscriptions", "organizations_url": "https://api.github.com/users/TomoshibiAkira/orgs", "repos_url": "https://api.github.com/users/TomoshibiAkira/repos", "events_url": "https://api.github.com/users/TomoshibiAkira/events{/privacy}", "received_events_url": "https://api.github.com/users/TomoshibiAkira/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-07-03T14:38:47Z", "updated_at": "2019-07-03T16:19:19Z", "closed_at": "2019-07-03T16:18:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm using tensorpack 0.9.4. It seems like argscope behaves weird when nested.\r\n\r\n```\r\nfrom tensorpack.tfutils import argscope, get_arg_scope\r\nfrom tensorpack.models import BatchNorm\r\n\r\nwith argscope(BatchNorm, data_format='NCHW', epsilon=1e-5):\r\n    print (get_arg_scope())\r\n    with argscope(BatchNorm, training=False, epsilon=1e-3):\r\n        print (get_arg_scope())\r\n    print (get_arg_scope())\r\n```\r\n\r\nResult:\r\n```\r\ndefaultdict(<class 'dict'>, {'BatchNorm': {'data_format': 'NCHW', 'epsilon': 1e-05}})\r\ndefaultdict(<class 'dict'>, {'BatchNorm': {'data_format': 'NCHW', 'epsilon': 0.001, 'training': False}})\r\ndefaultdict(<class 'dict'>, {'BatchNorm': {'data_format': 'NCHW', 'epsilon': 0.001, 'training': False}})\r\n```\r\nThe third output should be the same as the first.\r\nI believe the reason is here: https://github.com/tensorpack/tensorpack/blob/master/tensorpack/tfutils/argscope.py#L52\r\n\r\nIt should be `deepcopy` instead of `copy`.", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1252/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1252/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1229", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1229/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1229/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1229/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/1229", "id": 453291071, "node_id": "MDU6SXNzdWU0NTMyOTEwNzE=", "number": 1229, "title": "RandomCropRandomShape does not use max_aspect_ratio parameter", "user": {"login": "stooloveu", "id": 10916384, "node_id": "MDQ6VXNlcjEwOTE2Mzg0", "avatar_url": "https://avatars.githubusercontent.com/u/10916384?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stooloveu", "html_url": "https://github.com/stooloveu", "followers_url": "https://api.github.com/users/stooloveu/followers", "following_url": "https://api.github.com/users/stooloveu/following{/other_user}", "gists_url": "https://api.github.com/users/stooloveu/gists{/gist_id}", "starred_url": "https://api.github.com/users/stooloveu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stooloveu/subscriptions", "organizations_url": "https://api.github.com/users/stooloveu/orgs", "repos_url": "https://api.github.com/users/stooloveu/repos", "events_url": "https://api.github.com/users/stooloveu/events{/privacy}", "received_events_url": "https://api.github.com/users/stooloveu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-06-07T00:19:56Z", "updated_at": "2019-06-07T01:04:21Z", "closed_at": "2019-06-07T01:04:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "The method [RandomCropRandomShape](https://github.com/tensorpack/tensorpack/blob/1e4dee8b026ed3d2a1c70cfd3e371f443a1d7d99/tensorpack/dataflow/imgaug/crop.py#L58) does not actually use` max_aspect_ratio `param I think", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1229/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1229/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1182", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1182/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1182/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1182/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/1182", "id": 442859179, "node_id": "MDU6SXNzdWU0NDI4NTkxNzk=", "number": 1182, "title": "Keras example crashing on single gpu training", "user": {"login": "dps42", "id": 50238499, "node_id": "MDQ6VXNlcjUwMjM4NDk5", "avatar_url": "https://avatars.githubusercontent.com/u/50238499?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dps42", "html_url": "https://github.com/dps42", "followers_url": "https://api.github.com/users/dps42/followers", "following_url": "https://api.github.com/users/dps42/following{/other_user}", "gists_url": "https://api.github.com/users/dps42/gists{/gist_id}", "starred_url": "https://api.github.com/users/dps42/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dps42/subscriptions", "organizations_url": "https://api.github.com/users/dps42/orgs", "repos_url": "https://api.github.com/users/dps42/repos", "events_url": "https://api.github.com/users/dps42/events{/privacy}", "received_events_url": "https://api.github.com/users/dps42/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2019-05-10T19:15:28Z", "updated_at": "2019-05-22T21:42:55Z", "closed_at": "2019-05-10T19:22:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "If you're asking about an unexpected problem which you do not know the root cause,\r\nuse this template. __PLEASE DO NOT DELETE THIS TEMPLATE, FILL IT__:\r\n\r\nIf you already know the root cause to your problem,\r\nfeel free to delete everything in this template.\r\n\r\n### 1. What you did:\r\n\r\n(1) **If you're using examples, what's the command you run:**\r\n\r\n      python mnist-keras.py\r\n\r\n(2) **If you're using examples, have you made any changes to the examples? Paste `git status; git diff` here:**\r\n      Delete line 101: if get_num_gpu() <= 1:, and the else statement.\r\n      Sorry git was not used at the time..\r\n\r\n(3) **If not using examples, tell us what you did:**\r\n      I just wanted to compare the speedup between single GPU training and multiple GPU training on the keras example. Just deleted the if else statement at line 101 to run the single GPU example.\r\n      # single GPU:\r\n    launch_train_with_config(cfg, QueueInputTrainer())\r\n\r\n   It crashed with the error message described in section 3.\r\n\r\n   But  the multi-GPU code worked fine. \r\n          launch_train_with_config(cfg, SyncMultiGPUTrainerParameterServer(2))\r\n \r\n\r\n  It's always better to copy-paste what you did than to describe them.\r\n\r\n  Please try to provide enough information to let other __reproduce__ your issues. \r\n  Without reproducing the issue, we may not be able to investigate it.\r\n\r\n### 2. What you observed:\r\n\r\n(1) **Include the ENTIRE logs here:**\r\n\u001b[32m[0510 15:05:05 @logger.py:90]\u001b[0m Argv: mnist-keras.py\r\n\u001b[32m[0510 15:05:05 @fs.py:101]\u001b[0m \u001b[5m\u001b[31mWRN\u001b[0m Env var $TENSORPACK_DATASET not set, using C:\\Users\\dps42\\tensorpack_data for datasets.\r\n\u001b[32m[0510 15:05:05 @interface.py:31]\u001b[0m Automatically applying QueueInput on the DataFlow.\r\n\u001b[32m[0510 15:05:05 @input_source.py:223]\u001b[0m Setting up the queue 'QueueInput/input_queue' for CPU prefetching ...\r\n\u001b[32m[0510 15:05:05 @trainers.py:47]\u001b[0m Building graph for a single training tower ...\r\n\r\nIt's always better to copy-paste what you observed instead of describing them.\r\n\r\nIt's always better to paste **as much as possible**, although sometimes a partial log is OK.\r\n\r\nTensorpack typically saves stdout to its training log.\r\nIf stderr is relevant, you can run a command with `CMD 2>&1 | tee logs.txt`\r\nto save both stdout and stderr to one file.\r\n\r\n(2) **Other observations, if any:**\r\nFor example, CPU/GPU utilization, output images, tensorboard curves, if relevant to your issue.\r\n\r\n### 3. What you expected, if not obvious.\r\n\r\nI had the following error message:\r\n\r\n(dps42_dev) C:\\Users\\dps42\\Desktop\\dps42\\tensorpack\\examples\\keras>python mnist-keras.py\r\n[0510 14:42:45 @logger.py:125] WRN Log directory train_log\\mnist-keras exists! Use 'd' to delete it.\r\n[0510 14:42:45 @logger.py:128] WRN If you're resuming from a previous run, you can choose to keep it.\r\nPress any other key to exit.\r\nSelect Action: k (keep) / d (delete) / q (quit):d\r\n[0510 14:42:49 @logger.py:90] Argv: mnist-keras.py\r\n[0510 14:42:49 @fs.py:101] WRN Env var $TENSORPACK_DATASET not set, using C:\\Users\\dps42\\tensorpack_data for datasets.\r\n[0510 14:42:49 @interface.py:31] Automatically applying QueueInput on the DataFlow.\r\n[0510 14:42:49 @input_source.py:223] Setting up the queue 'QueueInput/input_queue' for CPU prefetching ...\r\n[0510 14:42:49 @trainers.py:47] Building graph for a single training tower ...\r\nTraceback (most recent call last):\r\n  File \"mnist-keras.py\", line 100, in <module>\r\n    launch_train_with_config(cfg, QueueInputTrainer())\r\n  File \"C:\\Users\\dps42\\AppData\\Local\\Continuum\\miniconda3\\envs\\dps42_dev\\lib\\site-packages\\tensorpack\\train\\interface.py\", line 91, in launch_train_with_config\r\n    model.build_graph, model.get_optimizer)\r\n  File \"C:\\Users\\dps42\\AppData\\Local\\Continuum\\miniconda3\\envs\\dps42_dev\\lib\\site-packages\\tensorpack\\utils\\argtools.py\", line 176, in wrapper\r\n    return func(*args, **kwargs)\r\n  File \"C:\\Users\\dps42\\AppData\\Local\\Continuum\\miniconda3\\envs\\dps42_dev\\lib\\site-packages\\tensorpack\\train\\tower.py\", line 224, in setup_graph\r\n    train_callbacks = self._setup_graph(input, get_cost_fn, get_opt_fn)\r\n  File \"C:\\Users\\dps42\\AppData\\Local\\Continuum\\miniconda3\\envs\\dps42_dev\\lib\\site-packages\\tensorpack\\train\\trainers.py\", line 71, in _setup_graph\r\n    return super(QueueInputTrainer, self)._setup_graph(input, get_cost_fn, get_opt_fn)\r\n  File \"C:\\Users\\dps42\\AppData\\Local\\Continuum\\miniconda3\\envs\\dps42_dev\\lib\\site-packages\\tensorpack\\train\\trainers.py\", line 49, in _setup_graph\r\n    grads = self._make_get_grad_fn(input, get_cost_fn, get_opt_fn)()\r\n  File \"C:\\Users\\dps42\\AppData\\Local\\Continuum\\miniconda3\\envs\\dps42_dev\\lib\\site-packages\\tensorpack\\train\\tower.py\", line 280, in get_grad_fn\r\n    return compute_grad_from_inputs(*inputs)\r\n  File \"C:\\Users\\dps42\\AppData\\Local\\Continuum\\miniconda3\\envs\\dps42_dev\\lib\\site-packages\\tensorpack\\train\\tower.py\", line 255, in compute_grad_from_inputs\r\n    cost = get_cost_fn(*inputs)\r\n  File \"C:\\Users\\dps42\\AppData\\Local\\Continuum\\miniconda3\\envs\\dps42_dev\\lib\\site-packages\\tensorpack\\tfutils\\tower.py\", line 290, in __call__\r\n    output = self._tower_fn(*args)\r\n  File \"mnist-keras.py\", line 52, in build_graph\r\n    M = get_keras_model()\r\n  File \"mnist-keras.py\", line 29, in get_keras_model\r\n    with tf.name_scope('/'):\r\n  File \"C:\\Users\\dps42\\AppData\\Local\\Continuum\\miniconda3\\envs\\dps42_dev\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 5775, in __enter__\r\n    return self._name_scope.__enter__()\r\n  File \"C:\\Users\\dps42\\AppData\\Local\\Continuum\\miniconda3\\envs\\dps42_dev\\lib\\contextlib.py\", line 59, in __enter__\r\n    return next(self.gen)\r\n  File \"C:\\Users\\dps42\\AppData\\Local\\Continuum\\miniconda3\\envs\\dps42_dev\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 3851, in name_scope\r\n    raise ValueError(\"'%s' is not a valid scope name\" % name)\r\nValueError: '/' is not a valid scope name\r\n\r\n\r\nIf you expect higher speed, please read\r\nhttp://tensorpack.readthedocs.io/tutorial/performance-tuning.html \r\nbefore posting.\r\n\r\nIf you expect certain accuracy, only in one of the two conditions can we help with it:\r\n(1) You're unable to reproduce the accuracy documented in tensorpack examples.\r\n(2) It appears to be a tensorpack bug.\r\n\r\nOtherwise, how to train a model to certain accuracy is a machine learning question.\r\nWe do not answer machine learning questions and it is your responsibility to \r\nfigure out how to make your models more accurate.\r\n\r\n### 4. Your environment:\r\n  + Paste the output of this command: `python3 -c 'import tensorpack.tfutils as u; print(u.collect_env_info())'`\r\n    If this command failed, tell us your version of Python/TF/tensorpack.\r\n  + You can install Tensorpack master by `pip install -U git+https://github.com/ppwwyyxx/tensorpack.git`\r\n    and see if your issue is already solved.\r\n  + If you're not using tensorpack under a normal command line shell (e.g.,\r\n    using an IDE or jupyter notebook), please retry under a normal command line shell. \r\n  + Include relevant hardware information, e.g. number of GPUs used for training, amount of RAM.\r\n\r\nsys.platform          win32\r\nPython                3.5.2 | packaged by conda-forge | (default, Jan 19 2017, 15:41:23) [MSC v.1900 64 bit (AMD64)]\r\nTensorpack            v0.9.4-50-g6926d22a-dirty\r\nNumpy                 1.13.3\r\nTensorFlow            1.10.0/b'unknown'\r\nTF Compiler Version   MSVC 190024215\r\nTF CUDA support       True\r\nTF MKL support        False\r\nNvidia Driver\r\nCUDA\r\nCUDNN\r\nNCCL\r\nCUDA_VISIBLE_DEVICES  None\r\nGPU                   Not found with NVML\r\nFree RAM              121.50/127.67 GB\r\nCPU Count             20\r\ncv2                   4.1.0\r\nmsgpack               0.5.6\r\npython-prctl          False\r\n\r\nI have 4 NVIDIA RTX 2080 Ti GPUs, but I set a single gpu training mode.\r\nI also have another single GPU desktop (Quadro P5000), but when I ran the same code it produced the same error message.  Both on Windows 10, CUDA 9.0\r\n\r\nYou may often want to provide extra information related to your issue, but\r\nat the minimum please try to provide the above information __accurately__ to save effort in the investigation.\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1182/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1182/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1078", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1078/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1078/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1078/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/1078", "id": 409171312, "node_id": "MDU6SXNzdWU0MDkxNzEzMTI=", "number": 1078, "title": "training gets stuck with sync bn", "user": {"login": "jiang1st", "id": 5435138, "node_id": "MDQ6VXNlcjU0MzUxMzg=", "avatar_url": "https://avatars.githubusercontent.com/u/5435138?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jiang1st", "html_url": "https://github.com/jiang1st", "followers_url": "https://api.github.com/users/jiang1st/followers", "following_url": "https://api.github.com/users/jiang1st/following{/other_user}", "gists_url": "https://api.github.com/users/jiang1st/gists{/gist_id}", "starred_url": "https://api.github.com/users/jiang1st/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jiang1st/subscriptions", "organizations_url": "https://api.github.com/users/jiang1st/orgs", "repos_url": "https://api.github.com/users/jiang1st/repos", "events_url": "https://api.github.com/users/jiang1st/events{/privacy}", "received_events_url": "https://api.github.com/users/jiang1st/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 15, "created_at": "2019-02-12T08:13:58Z", "updated_at": "2019-04-13T07:26:36Z", "closed_at": "2019-02-13T03:30:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, I am replacing standard batch norm with sync batch norm in my network. I am using 8 P100 on centos 7.0.  I have installed nccl 2.4.2 + cuda9.0. The backbone is mobilenet v2. Here is my problem:\r\n\r\nWhen I set:   `with argscope(BatchNorm, momentum=0.997, epsilon=0.001, training=True, sync_statistics='nccl')` , after building the graph, the training phase gets stuck at:\r\n\r\n  0%|                                                                                                                              |0/300[00:00<?,?it/s][0212 15:59:37 @input_source.py:551] Pre-filling StagingArea ...\r\n[0212 15:59:39 @input_source.py:555] 1 element was put into StagingArea on each tower.\r\n\r\nBut when I set with `argscope(BatchNorm, momentum=0.997, epsilon=0.001, training=True)` , then the training phase goes successfully.\r\n\r\nI guess there is something wrong with my sync batch norm. What could be the reason? Thank you.", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1078/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1078/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1077", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1077/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1077/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1077/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/1077", "id": 408775375, "node_id": "MDU6SXNzdWU0MDg3NzUzNzU=", "number": 1077, "title": "'TrainConfig' object has no attribute 'nr_tower' (A3C)", "user": {"login": "JamesBrightman", "id": 35103224, "node_id": "MDQ6VXNlcjM1MTAzMjI0", "avatar_url": "https://avatars.githubusercontent.com/u/35103224?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JamesBrightman", "html_url": "https://github.com/JamesBrightman", "followers_url": "https://api.github.com/users/JamesBrightman/followers", "following_url": "https://api.github.com/users/JamesBrightman/following{/other_user}", "gists_url": "https://api.github.com/users/JamesBrightman/gists{/gist_id}", "starred_url": "https://api.github.com/users/JamesBrightman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JamesBrightman/subscriptions", "organizations_url": "https://api.github.com/users/JamesBrightman/orgs", "repos_url": "https://api.github.com/users/JamesBrightman/repos", "events_url": "https://api.github.com/users/JamesBrightman/events{/privacy}", "received_events_url": "https://api.github.com/users/JamesBrightman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2019-02-11T13:13:30Z", "updated_at": "2019-02-11T19:23:46Z", "closed_at": "2019-02-11T17:16:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n### 1. What I did:\r\n\r\nI'm trying to train Breakout on google colab using the A3C implementation. Whenever I run \r\n`!python train-atari.py --env Breakout-v0 --gpu 0`\r\nIt causes an error;\r\n\r\nTraceback (most recent call last):\r\n  File \"train-atari.py\", line 301, in <module>\r\n    train()\r\n  File \"train-atari.py\", line 262, in train\r\n    trainer = SimpleTrainer() if config.nr_tower == 1 else AsyncMultiGPUTrainer(train_tower)\r\nAttributeError: 'TrainConfig' object has no attribute 'nr_tower'\r\n\r\nIt doesn't matter what Colab settings I use - normal, GPU enhanced or TPU enhanced, it happens on all.\r\n\r\nAny ideas of a fix/ workaround? Previously I commented out from '# == 1 else AsyncMultiGPUTrainer(train_tower)' but as my epochs are taking hours to run and should apparently take ~20 mins, I feel this may be a problem.\r\n\r\nThanks.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1077/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1077/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1057", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1057/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1057/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1057/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/1057", "id": 400931491, "node_id": "MDU6SXNzdWU0MDA5MzE0OTE=", "number": 1057, "title": "Please review the following two lines.", "user": {"login": "Remember2018", "id": 43327429, "node_id": "MDQ6VXNlcjQzMzI3NDI5", "avatar_url": "https://avatars.githubusercontent.com/u/43327429?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Remember2018", "html_url": "https://github.com/Remember2018", "followers_url": "https://api.github.com/users/Remember2018/followers", "following_url": "https://api.github.com/users/Remember2018/following{/other_user}", "gists_url": "https://api.github.com/users/Remember2018/gists{/gist_id}", "starred_url": "https://api.github.com/users/Remember2018/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Remember2018/subscriptions", "organizations_url": "https://api.github.com/users/Remember2018/orgs", "repos_url": "https://api.github.com/users/Remember2018/repos", "events_url": "https://api.github.com/users/Remember2018/events{/privacy}", "received_events_url": "https://api.github.com/users/Remember2018/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-01-18T23:53:09Z", "updated_at": "2019-01-19T00:04:41Z", "closed_at": "2019-01-19T00:03:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, the `result` in line 164 should be a `dict` and `k` in line 166 is not defined:\r\nhttps://github.com/tensorpack/tensorpack/blob/3ad0ed00a183f13563eb9b2568a8de57c148cbd3/tensorpack/dataflow/common.py#L163-L171", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1057/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1057/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1046", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1046/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1046/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1046/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/1046", "id": 398537055, "node_id": "MDU6SXNzdWUzOTg1MzcwNTU=", "number": 1046, "title": "Bug report: add_tensor_summary()'s main_tower_only parameter is useless", "user": {"login": "TomoshibiAkira", "id": 3897907, "node_id": "MDQ6VXNlcjM4OTc5MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/3897907?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TomoshibiAkira", "html_url": "https://github.com/TomoshibiAkira", "followers_url": "https://api.github.com/users/TomoshibiAkira/followers", "following_url": "https://api.github.com/users/TomoshibiAkira/following{/other_user}", "gists_url": "https://api.github.com/users/TomoshibiAkira/gists{/gist_id}", "starred_url": "https://api.github.com/users/TomoshibiAkira/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TomoshibiAkira/subscriptions", "organizations_url": "https://api.github.com/users/TomoshibiAkira/orgs", "repos_url": "https://api.github.com/users/TomoshibiAkira/repos", "events_url": "https://api.github.com/users/TomoshibiAkira/events{/privacy}", "received_events_url": "https://api.github.com/users/TomoshibiAkira/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-01-12T09:12:44Z", "updated_at": "2019-01-12T09:39:49Z", "closed_at": "2019-01-12T09:39:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "In add_tensor_summary(), there's no check on `main_tower_only` parameter, makes this parameter useless.\r\nhttps://github.com/tensorpack/tensorpack/blob/8566797f474092293a4dc2f2134a42d532c30799/tensorpack/tfutils/summary.py#L117-L122", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1046/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1046/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1040", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1040/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1040/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1040/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/1040", "id": 397317373, "node_id": "MDU6SXNzdWUzOTczMTczNzM=", "number": 1040, "title": "Bug Report: BilinearUpSample() only works when channels=1", "user": {"login": "TomoshibiAkira", "id": 3897907, "node_id": "MDQ6VXNlcjM4OTc5MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/3897907?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TomoshibiAkira", "html_url": "https://github.com/TomoshibiAkira", "followers_url": "https://api.github.com/users/TomoshibiAkira/followers", "following_url": "https://api.github.com/users/TomoshibiAkira/following{/other_user}", "gists_url": "https://api.github.com/users/TomoshibiAkira/gists{/gist_id}", "starred_url": "https://api.github.com/users/TomoshibiAkira/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TomoshibiAkira/subscriptions", "organizations_url": "https://api.github.com/users/TomoshibiAkira/orgs", "repos_url": "https://api.github.com/users/TomoshibiAkira/repos", "events_url": "https://api.github.com/users/TomoshibiAkira/events{/privacy}", "received_events_url": "https://api.github.com/users/TomoshibiAkira/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-01-09T10:57:57Z", "updated_at": "2019-01-10T07:05:48Z", "closed_at": "2019-01-10T07:05:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "### 1. What you did:\r\n\r\nI wrote a piece of code to test the behavior of BilinearUpSample() layer:\r\n[https://gist.github.com/elmirador/4816836ca5b35481a43b07109f6dae63](https://gist.github.com/elmirador/4816836ca5b35481a43b07109f6dae63)\r\n\r\nThe layer's code is directly copied from models/pool.py from [https://github.com/tensorpack/tensorpack/blob/7bf5581a07b79ae072901b4bc8c1469dd7370a80/tensorpack/models/pool.py#L145-L196](https://github.com/tensorpack/tensorpack/blob/7bf5581a07b79ae072901b4bc8c1469dd7370a80/tensorpack/models/pool.py#L145-L196)\r\n\r\n### 2. What you observed:\r\n\r\nOriginal Image:\r\n![lenna_color](https://user-images.githubusercontent.com/3897907/50889932-2437c380-1434-11e9-92ff-25babf24f31d.png)\r\n\r\nUpsampled Image (in color):\r\n![color_up](https://user-images.githubusercontent.com/3897907/50890247-c6f04200-1434-11e9-983c-5db985f61fdd.png)\r\n\r\nRead the original image as grayscale, then upsample:\r\n![grayscale_up](https://user-images.githubusercontent.com/3897907/50890657-9230ba80-1435-11e9-870d-ce8c59c4b9f0.png)\r\n\r\nThe reason for this behavior is that conv2d_tranpose() is a convolution. It convolutes on all channels instead of one single channel while bilinear upsampling is a channel-wise operation. To fix it just apply the convolution channel-wise.\r\n\r\nI do think it's a good idea to use Caffe's version of bilinear upsampling instead of the one in TF. Sad to see it's going to be deprecated.\r\n\r\nThe CaffeBilinearUpSample() in the HED example should also be corrected.\r\n\r\n### 3. Your environment:\r\n  + Python version: 3.5\r\n  + TF version: 1.4.0\r\n  + Tensorpack version: 0.9.0.1-master (ac9ac2a)", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1040/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1040/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1002", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1002/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1002/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1002/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/1002", "id": 388272462, "node_id": "MDU6SXNzdWUzODgyNzI0NjI=", "number": 1002, "title": "Assert fails on machine with more than 8 GPUs", "user": {"login": "clampert", "id": 8297131, "node_id": "MDQ6VXNlcjgyOTcxMzE=", "avatar_url": "https://avatars.githubusercontent.com/u/8297131?v=4", "gravatar_id": "", "url": "https://api.github.com/users/clampert", "html_url": "https://github.com/clampert", "followers_url": "https://api.github.com/users/clampert/followers", "following_url": "https://api.github.com/users/clampert/following{/other_user}", "gists_url": "https://api.github.com/users/clampert/gists{/gist_id}", "starred_url": "https://api.github.com/users/clampert/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/clampert/subscriptions", "organizations_url": "https://api.github.com/users/clampert/orgs", "repos_url": "https://api.github.com/users/clampert/repos", "events_url": "https://api.github.com/users/clampert/events{/privacy}", "received_events_url": "https://api.github.com/users/clampert/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-12-06T15:45:25Z", "updated_at": "2018-12-06T16:58:30Z", "closed_at": "2018-12-06T16:57:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm describing a problem of version 0.9.0.1-24-gef334e31, hash 'ef334e31c34bab909d2c7469d3905347a0d5137a' on machines with more than 8 GPUs. \r\n\r\nI ran the imagenet-resnet.py example with unmodified source on a 10 GPU machine:\r\n\r\n**python3 mygit/tensorpack/examples/ResNet/imagenet-resnet.py --data /localhome/chl/ILSVRC2012/ -d 50 --batch 320**\r\n\r\nThe code fails, and with good reason: \r\n\r\nThe class *SyncMultiGPUTrainerReplicated* will activate hierarchical mode for **8 GPUs or more**:\r\n\r\n<pre>train/trainers.py:176      mode = 'hierarchical' if len(gpus) >= 8 else 'nccl'</pre>\r\n\r\nAfterwards, in the routine *allreduce_grads_hierarchical* will fail because an assert allows only **exactly 8 GPUs**:\r\n\r\n<pre>graph_builder/utils.py:187     assert num_gpu == 8, num_gpu</pre>\r\n\r\n-------------------------------------------------------------------------------------------------\r\nlog of /dev/stderr\r\n-------------------------------------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"mygit/tensorpack/examples/ResNet/imagenet-resnet.py\", line 148, in <module>\r\n    launch_train_with_config(config, trainer)\r\n  File \"/nfs/scistore12/chlgrp/chl/.local/lib/python3.5/site-packages/tensorpack/train/interface.py\", line 87, in launch_train_with_config\r\n    model._build_graph_get_cost, model.get_optimizer)\r\n  File \"/nfs/scistore12/chlgrp/chl/.local/lib/python3.5/site-packages/tensorpack/utils/argtools.py\", line 176, in wrapper\r\n    return func(*args, **kwargs)\r\n  File \"/nfs/scistore12/chlgrp/chl/.local/lib/python3.5/site-packages/tensorpack/train/tower.py\", line 204, in setup_graph\r\n    train_callbacks = self._setup_graph(input, get_cost_fn, get_opt_fn)\r\n  File \"/nfs/scistore12/chlgrp/chl/.local/lib/python3.5/site-packages/tensorpack/train/trainers.py\", line 186, in _setup_graph\r\n    self._make_get_grad_fn(input, get_cost_fn, get_opt_fn), get_opt_fn)\r\n  File \"/nfs/scistore12/chlgrp/chl/.local/lib/python3.5/site-packages/tensorpack/graph_builder/training.py\", line 251, in build\r\n    packed_grads, raw_devices, average=self._average)\r\n  File \"/nfs/scistore12/chlgrp/chl/.local/lib/python3.5/site-packages/tensorpack/tfutils/scope_utils.py\", line 94, in wrapper\r\n    return func(*args, **kwargs)\r\n  File \"/nfs/scistore12/chlgrp/chl/.local/lib/python3.5/site-packages/tensorpack/graph_builder/utils.py\", line 187, in allreduce_grads_hierarchical\r\n    assert num_gpu == 8, num_gpu\r\nAssertionError: 10\r\n\r\n-------------------------------------------------------------------------------------------------\r\nlog of /dev/stdout\r\n-------------------------------------------------------------------------------------------------\r\n\u001b[32m[1206 16:21:16 @logger.py:85]\u001b[0m Argv: mygit/tensorpack/examples/ResNet/imagenet-resnet.py --data /localhome/chl/ILSVRC2012/ -d 50 --batch 320\r\n\u001b[32m[1206 16:21:16 @imagenet-resnet.py:64]\u001b[0m Running on 10 towers. Batch size per tower: 32\r\n\u001b[32m[1206 16:21:16 @fs.py:100]\u001b[0m \u001b[5m\u001b[31mWRN\u001b[0m Env var $TENSORPACK_DATASET not set, using /nfs/scistore12/chlgrp/chl/tensorpack_data for datasets.\r\n\u001b[32m[1206 16:21:17 @imagenet_utils.py:106]\u001b[0m \u001b[5m\u001b[31mWRN\u001b[0m DataFlow may become the bottleneck when too few processes are used.\r\n\u001b[32m[1206 16:21:17 @parallel.py:313]\u001b[0m [PrefetchDataZMQ] Will fork a dataflow more than one times. This assumes the datapoints are i.i.d.\r\n\u001b[32m[1206 16:21:17 @ilsvrc.py:128]\u001b[0m [ILSVRC12] Assuming directory /localhome/chl/ILSVRC2012/val has 'original' structure.\r\n\u001b[32m[1206 16:21:18 @training.py:52]\u001b[0m [DataParallel] Training a model of 10 towers.\r\n\u001b[32m[1206 16:21:18 @interface.py:46]\u001b[0m Automatically applying StagingInput on the DataFlow.\r\n\u001b[32m[1206 16:21:18 @input_source.py:219]\u001b[0m Setting up the queue 'QueueInput/input_queue' for CPU prefetching ...\r\n\u001b[32m[1206 16:21:18 @training.py:112]\u001b[0m Building graph for training tower 0 on device /gpu:0 ...\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m conv0 input: [None, 3, 224, 224]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m conv0 output: [None, 64, 112, 112]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m pool0 input: [None, 64, 112, 112]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m pool0 output: [None, 64, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group0/block0/conv1 input: [None, 64, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group0/block0/conv1 output: [None, 64, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group0/block0/conv2 input: [None, 64, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group0/block0/conv2 output: [None, 64, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group0/block0/conv3 input: [None, 64, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group0/block0/conv3 output: [None, 256, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group0/block0/convshortcut input: [None, 64, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group0/block0/convshortcut output: [None, 256, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group0/block1/conv1 input: [None, 256, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group0/block1/conv1 output: [None, 64, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group0/block1/conv2 input: [None, 64, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group0/block1/conv2 output: [None, 64, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group0/block1/conv3 input: [None, 64, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group0/block1/conv3 output: [None, 256, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group0/block2/conv1 input: [None, 256, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group0/block2/conv1 output: [None, 64, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group0/block2/conv2 input: [None, 64, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group0/block2/conv2 output: [None, 64, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group0/block2/conv3 input: [None, 64, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group0/block2/conv3 output: [None, 256, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group1/block0/conv1 input: [None, 256, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group1/block0/conv1 output: [None, 128, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group1/block0/conv2 input: [None, 128, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group1/block0/conv2 output: [None, 128, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group1/block0/conv3 input: [None, 128, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group1/block0/conv3 output: [None, 512, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group1/block0/convshortcut input: [None, 256, 56, 56]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group1/block0/convshortcut output: [None, 512, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group1/block1/conv1 input: [None, 512, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group1/block1/conv1 output: [None, 128, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group1/block1/conv2 input: [None, 128, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group1/block1/conv2 output: [None, 128, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group1/block1/conv3 input: [None, 128, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group1/block1/conv3 output: [None, 512, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group1/block2/conv1 input: [None, 512, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group1/block2/conv1 output: [None, 128, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group1/block2/conv2 input: [None, 128, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group1/block2/conv2 output: [None, 128, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group1/block2/conv3 input: [None, 128, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group1/block2/conv3 output: [None, 512, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group1/block3/conv1 input: [None, 512, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group1/block3/conv1 output: [None, 128, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group1/block3/conv2 input: [None, 128, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group1/block3/conv2 output: [None, 128, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group1/block3/conv3 input: [None, 128, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group1/block3/conv3 output: [None, 512, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group2/block0/conv1 input: [None, 512, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group2/block0/conv1 output: [None, 256, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group2/block0/conv2 input: [None, 256, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group2/block0/conv2 output: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group2/block0/conv3 input: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group2/block0/conv3 output: [None, 1024, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group2/block0/convshortcut input: [None, 512, 28, 28]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group2/block0/convshortcut output: [None, 1024, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group2/block1/conv1 input: [None, 1024, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group2/block1/conv1 output: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group2/block1/conv2 input: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group2/block1/conv2 output: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group2/block1/conv3 input: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group2/block1/conv3 output: [None, 1024, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group2/block2/conv1 input: [None, 1024, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group2/block2/conv1 output: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group2/block2/conv2 input: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group2/block2/conv2 output: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group2/block2/conv3 input: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group2/block2/conv3 output: [None, 1024, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group2/block3/conv1 input: [None, 1024, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group2/block3/conv1 output: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group2/block3/conv2 input: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group2/block3/conv2 output: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group2/block3/conv3 input: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:129]\u001b[0m group2/block3/conv3 output: [None, 1024, 14, 14]\r\n\u001b[32m[1206 16:21:18 @registry.py:121]\u001b[0m group2/block4/conv1 input: [None, 1024, 14, 14]\r\n\u001b[32m[1206 16:21:19 @registry.py:129]\u001b[0m group2/block4/conv1 output: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:19 @registry.py:121]\u001b[0m group2/block4/conv2 input: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:19 @registry.py:129]\u001b[0m group2/block4/conv2 output: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:19 @registry.py:121]\u001b[0m group2/block4/conv3 input: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:19 @registry.py:129]\u001b[0m group2/block4/conv3 output: [None, 1024, 14, 14]\r\n\u001b[32m[1206 16:21:19 @registry.py:121]\u001b[0m group2/block5/conv1 input: [None, 1024, 14, 14]\r\n\u001b[32m[1206 16:21:19 @registry.py:129]\u001b[0m group2/block5/conv1 output: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:19 @registry.py:121]\u001b[0m group2/block5/conv2 input: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:19 @registry.py:129]\u001b[0m group2/block5/conv2 output: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:19 @registry.py:121]\u001b[0m group2/block5/conv3 input: [None, 256, 14, 14]\r\n\u001b[32m[1206 16:21:19 @registry.py:129]\u001b[0m group2/block5/conv3 output: [None, 1024, 14, 14]\r\n\u001b[32m[1206 16:21:19 @registry.py:121]\u001b[0m group3/block0/conv1 input: [None, 1024, 14, 14]\r\n\u001b[32m[1206 16:21:19 @registry.py:129]\u001b[0m group3/block0/conv1 output: [None, 512, 14, 14]\r\n\u001b[32m[1206 16:21:19 @registry.py:121]\u001b[0m group3/block0/conv2 input: [None, 512, 14, 14]\r\n\u001b[32m[1206 16:21:19 @registry.py:129]\u001b[0m group3/block0/conv2 output: [None, 512, 7, 7]\r\n\u001b[32m[1206 16:21:19 @registry.py:121]\u001b[0m group3/block0/conv3 input: [None, 512, 7, 7]\r\n\u001b[32m[1206 16:21:19 @registry.py:129]\u001b[0m group3/block0/conv3 output: [None, 2048, 7, 7]\r\n\u001b[32m[1206 16:21:19 @registry.py:121]\u001b[0m group3/block0/convshortcut input: [None, 1024, 14, 14]\r\n\u001b[32m[1206 16:21:19 @registry.py:129]\u001b[0m group3/block0/convshortcut output: [None, 2048, 7, 7]\r\n\u001b[32m[1206 16:21:19 @registry.py:121]\u001b[0m group3/block1/conv1 input: [None, 2048, 7, 7]\r\n\u001b[32m[1206 16:21:19 @registry.py:129]\u001b[0m group3/block1/conv1 output: [None, 512, 7, 7]\r\n\u001b[32m[1206 16:21:19 @registry.py:121]\u001b[0m group3/block1/conv2 input: [None, 512, 7, 7]\r\n\u001b[32m[1206 16:21:19 @registry.py:129]\u001b[0m group3/block1/conv2 output: [None, 512, 7, 7]\r\n\u001b[32m[1206 16:21:19 @registry.py:121]\u001b[0m group3/block1/conv3 input: [None, 512, 7, 7]\r\n\u001b[32m[1206 16:21:19 @registry.py:129]\u001b[0m group3/block1/conv3 output: [None, 2048, 7, 7]\r\n\u001b[32m[1206 16:21:19 @registry.py:121]\u001b[0m group3/block2/conv1 input: [None, 2048, 7, 7]\r\n\u001b[32m[1206 16:21:19 @registry.py:129]\u001b[0m group3/block2/conv1 output: [None, 512, 7, 7]\r\n\u001b[32m[1206 16:21:19 @registry.py:121]\u001b[0m group3/block2/conv2 input: [None, 512, 7, 7]\r\n\u001b[32m[1206 16:21:19 @registry.py:129]\u001b[0m group3/block2/conv2 output: [None, 512, 7, 7]\r\n\u001b[32m[1206 16:21:19 @registry.py:121]\u001b[0m group3/block2/conv3 input: [None, 512, 7, 7]\r\n\u001b[32m[1206 16:21:19 @registry.py:129]\u001b[0m group3/block2/conv3 output: [None, 2048, 7, 7]\r\n\u001b[32m[1206 16:21:19 @registry.py:121]\u001b[0m gap input: [None, 2048, 7, 7]\r\n\u001b[32m[1206 16:21:19 @registry.py:129]\u001b[0m gap output: [None, 2048]\r\n\u001b[32m[1206 16:21:19 @registry.py:121]\u001b[0m linear input: [None, 2048]\r\n\u001b[32m[1206 16:21:19 @registry.py:129]\u001b[0m linear output: [None, 1000]\r\n\u001b[32m[1206 16:21:19 @regularize.py:90]\u001b[0m regularize_cost() found 54 variables to regularize.\r\n\u001b[32m[1206 16:21:19 @regularize.py:19]\u001b[0m The following tensors will be regularized: conv0/W:0, group0/block0/conv1/W:0, group0/block0/conv2/W:0, group0/block0/conv3/W:0, group0/block0/convshortcut/W:0, group0/block1/conv1/W:0, group0/block1/conv2/W:0, group0/block1/conv3/W:0, group0/block2/conv1/W:0, group0/block2/conv2/W:0, group0/block2/conv3/W:0, group1/block0/conv1/W:0, group1/block0/conv2/W:0, group1/block0/conv3/W:0, group1/block0/convshortcut/W:0, group1/block1/conv1/W:0, group1/block1/conv2/W:0, group1/block1/conv3/W:0, group1/block2/conv1/W:0, group1/block2/conv2/W:0, group1/block2/conv3/W:0, group1/block3/conv1/W:0, group1/block3/conv2/W:0, group1/block3/conv3/W:0, group2/block0/conv1/W:0, group2/block0/conv2/W:0, group2/block0/conv3/W:0, group2/block0/convshortcut/W:0, group2/block1/conv1/W:0, group2/block1/conv2/W:0, group2/block1/conv3/W:0, group2/block2/conv1/W:0, group2/block2/conv2/W:0, group2/block2/conv3/W:0, group2/block3/conv1/W:0, group2/block3/conv2/W:0, group2/block3/conv3/W:0, group2/block4/conv1/W:0, group2/block4/conv2/W:0, group2/block4/conv3/W:0, group2/block5/conv1/W:0, group2/block5/conv2/W:0, group2/block5/conv3/W:0, group3/block0/conv1/W:0, group3/block0/conv2/W:0, group3/block0/conv3/W:0, group3/block0/convshortcut/W:0, group3/block1/conv1/W:0, group3/block1/conv2/W:0, group3/block1/conv3/W:0, group3/block2/conv1/W:0, group3/block2/conv2/W:0, group3/block2/conv3/W:0, linear/W:0\r\n\u001b[32m[1206 16:21:20 @training.py:112]\u001b[0m Building graph for training tower 1 on device /gpu:1 ...\r\n\u001b[32m[1206 16:21:21 @regularize.py:90]\u001b[0m regularize_cost() found 54 variables to regularize.\r\n\u001b[32m[1206 16:21:22 @training.py:112]\u001b[0m Building graph for training tower 2 on device /gpu:2 ...\r\n\u001b[32m[1206 16:21:23 @regularize.py:90]\u001b[0m regularize_cost() found 54 variables to regularize.\r\n\u001b[32m[1206 16:21:24 @training.py:112]\u001b[0m Building graph for training tower 3 on device /gpu:3 ...\r\n\u001b[32m[1206 16:21:25 @regularize.py:90]\u001b[0m regularize_cost() found 54 variables to regularize.\r\n\u001b[32m[1206 16:21:26 @training.py:112]\u001b[0m Building graph for training tower 4 on device /gpu:4 ...\r\n\u001b[32m[1206 16:21:27 @regularize.py:90]\u001b[0m regularize_cost() found 54 variables to regularize.\r\n\u001b[32m[1206 16:21:28 @training.py:112]\u001b[0m Building graph for training tower 5 on device /gpu:5 ...\r\n\u001b[32m[1206 16:21:29 @regularize.py:90]\u001b[0m regularize_cost() found 54 variables to regularize.\r\n\u001b[32m[1206 16:21:30 @training.py:112]\u001b[0m Building graph for training tower 6 on device /gpu:6 ...\r\n\u001b[32m[1206 16:21:31 @regularize.py:90]\u001b[0m regularize_cost() found 54 variables to regularize.\r\n\u001b[32m[1206 16:21:32 @training.py:112]\u001b[0m Building graph for training tower 7 on device /gpu:7 ...\r\n\u001b[32m[1206 16:21:33 @regularize.py:90]\u001b[0m regularize_cost() found 54 variables to regularize.\r\n\u001b[32m[1206 16:21:34 @training.py:112]\u001b[0m Building graph for training tower 8 on device /gpu:8 ...\r\n\u001b[32m[1206 16:21:35 @regularize.py:90]\u001b[0m regularize_cost() found 54 variables to regularize.\r\n\u001b[32m[1206 16:21:36 @training.py:112]\u001b[0m Building graph for training tower 9 on device /gpu:9 ...\r\n\u001b[32m[1206 16:21:37 @regularize.py:90]\u001b[0m regularize_cost() found 54 variables to regularize.\r\n\u001b[32m[1206 16:21:38 @utils.py:360]\u001b[0m Will pack 161 gradients of total dimension=25557032 into 10 splits.\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1002/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/1002/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/969", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/969/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/969/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/969/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/969", "id": 377499881, "node_id": "MDU6SXNzdWUzNzc0OTk4ODE=", "number": 969, "title": "Clean up parallel Dataflow (PrefetchDataZMQ)", "user": {"login": "sytham", "id": 5081109, "node_id": "MDQ6VXNlcjUwODExMDk=", "avatar_url": "https://avatars.githubusercontent.com/u/5081109?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sytham", "html_url": "https://github.com/sytham", "followers_url": "https://api.github.com/users/sytham/followers", "following_url": "https://api.github.com/users/sytham/following{/other_user}", "gists_url": "https://api.github.com/users/sytham/gists{/gist_id}", "starred_url": "https://api.github.com/users/sytham/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sytham/subscriptions", "organizations_url": "https://api.github.com/users/sytham/orgs", "repos_url": "https://api.github.com/users/sytham/repos", "events_url": "https://api.github.com/users/sytham/events{/privacy}", "received_events_url": "https://api.github.com/users/sytham/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2018-11-05T17:17:53Z", "updated_at": "2018-11-06T13:23:42Z", "closed_at": "2018-11-06T09:48:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Problem**\r\nProcesses spawned by `PrefetchDataZMQ` stay alive. I'm doing a hyperparameter search, and since the dataflow is not reentrant, my understanding is I need to create a new one for each hyperparam evaluation. This leads to a very large amount of live processes, eventually causing my machine to run out of memory.\r\nI create my dataflow as:\r\n```\r\ndef create_dataflow(input_data, target_data):\r\n    ds = DataFromList(zip(input_data, target_data), shuffle=True)\r\n    ds = BatchData(ds, BATCH_SIZE)\r\n    ds = PrefetchDataZMQ(ds, nr_proc=NUM_PARALLEL_FETCHERS)\r\n    return ds\r\n```\r\n\r\n**What have I tried**\r\n\r\n- reuse the same dataflow. This leads to the reentrant eror.\r\n- in each hyperparam evaluation, do the following:\r\n```\r\ndataflow_train = create_dataflow(train_inp, train_targ)\r\n<do stuff>\r\ndel dataflow_train\r\ndel model # holds a reference to dataflow_train\r\ngc.collect()\r\n```\r\nSince it seems the `_MultiProcessZMQDataFlow.__del__` method should do the cleanup. However, I never see the \"successfully cleaned-up\" message that this method prints if successful. It seems this could either be because `__del__` isn't called, or because `_MultiProcessZMQDataFlow._reset_done = False` (I wouldn't understand why).\r\n\r\nIn any case, is there a better way to do this?\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/969/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/969/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/966", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/966/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/966/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/966/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/966", "id": 377303021, "node_id": "MDU6SXNzdWUzNzczMDMwMjE=", "number": 966, "title": "MinSaver saves wrong model without warning", "user": {"login": "maciejjaskowski", "id": 562477, "node_id": "MDQ6VXNlcjU2MjQ3Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/562477?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maciejjaskowski", "html_url": "https://github.com/maciejjaskowski", "followers_url": "https://api.github.com/users/maciejjaskowski/followers", "following_url": "https://api.github.com/users/maciejjaskowski/following{/other_user}", "gists_url": "https://api.github.com/users/maciejjaskowski/gists{/gist_id}", "starred_url": "https://api.github.com/users/maciejjaskowski/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maciejjaskowski/subscriptions", "organizations_url": "https://api.github.com/users/maciejjaskowski/orgs", "repos_url": "https://api.github.com/users/maciejjaskowski/repos", "events_url": "https://api.github.com/users/maciejjaskowski/events{/privacy}", "received_events_url": "https://api.github.com/users/maciejjaskowski/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-11-05T08:54:49Z", "updated_at": "2018-11-05T12:17:57Z", "closed_at": "2018-11-05T10:48:06Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "If you're asking about an unexpected problem you met, use this template.\r\n__PLEASE DO NOT DELETE THIS TEMPLATE, FILL IT__:\r\n\r\n### 1. What you did:\r\n\r\n(1) **If you're using examples, what's the command you run:**\r\nRun mnist example https://github.com/tensorpack/tensorpack/blob/master/examples/basics/mnist-convnet.py\r\n\r\n(2) **If you're using examples, have you made any changes to the examples? Paste them here:**\r\nNo changes.\r\n\r\n### 2. What you observed:\r\n\r\n(1) **Include the ENTIRE logs here:**\r\n\r\nThe model saved with MaxSaver is a model from epoch N+1 instead from the epoch N, as expected. Logs show no problem.\r\n\r\n(2) **Other observations, if any:**\r\nN/A\r\n\r\n### 3. What you expected, if not obvious.\r\nThere are two problems:\r\n1. the example is wrong, it should read:\r\n```\r\ncallbacks=[\r\n            ModelSaver(),   # save the model after every epoch\r\n            InferenceRunner(    # run inference(for validation) after every epoch\r\n                dataset_test,   # the DataFlow instance used for validation\r\n                ScalarStats(['cross_entropy_loss', 'accuracy'])),\r\n            MaxSaver('validation_accuracy'),  # save the model with highest accuracy (prefix 'validation_')\r\n           \r\n        ],\r\n```\r\nNote, the order in callbacks. If `InferenceRunner` is run last, as originally in the example, MaxSaver will read `_get_stat` after epoch N but will save model after epoch N+1. \r\n\r\n2. There is no safeguard against the original version. \r\n\r\nIn my case, `_need_save()` could be changed to something like\r\n```\r\n    def _need_save(self):\r\n        v = self._get_stat()\r\n        assert v, \"No InferenceRunner was run before executing MinSaver\"\r\n        return v > self.min if self.reverse else v < self.min\r\n```\r\n\r\nBut I am not sure if it does not have some implications, I don't see.\r\n\r\n3. I didn't find a piece of documentation suggesting that MaxSaver must be after InferenceRunner in callbacks.\r\n\r\n### 4. Your environment:\r\nN/A\r\n\r\nI'll be happy to fix this either way once we settle on a solution.", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/966/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/966/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/929", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/929/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/929/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/929/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/929", "id": 369832269, "node_id": "MDU6SXNzdWUzNjk4MzIyNjk=", "number": 929, "title": "Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available", "user": {"login": "yihui-he", "id": 10027339, "node_id": "MDQ6VXNlcjEwMDI3MzM5", "avatar_url": "https://avatars.githubusercontent.com/u/10027339?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yihui-he", "html_url": "https://github.com/yihui-he", "followers_url": "https://api.github.com/users/yihui-he/followers", "following_url": "https://api.github.com/users/yihui-he/following{/other_user}", "gists_url": "https://api.github.com/users/yihui-he/gists{/gist_id}", "starred_url": "https://api.github.com/users/yihui-he/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yihui-he/subscriptions", "organizations_url": "https://api.github.com/users/yihui-he/orgs", "repos_url": "https://api.github.com/users/yihui-he/repos", "events_url": "https://api.github.com/users/yihui-he/events{/privacy}", "received_events_url": "https://api.github.com/users/yihui-he/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-10-13T19:15:42Z", "updated_at": "2018-11-27T04:19:32Z", "closed_at": "2018-10-13T19:24:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "__PLEASE ALWAYS INCLUDE__:\r\n1. What you did:\r\n  + If you're using examples: \r\n    + What's the command you run: `./shufflenet.py --v2 -r=0.5 --data ~/local/imagenet/`\r\n    + Have you made any changes to the examples? Paste them if any: No\r\n2. What you observed, including but not limited to the __entire__ logs.\r\n`Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available`\r\n[err.log](https://github.com/tensorpack/tensorpack/files/2475746/err.log)\r\n\r\n4. Your environment:\r\n  + Python version. 2.7.15 (conda 4.5.11)\r\n  + TF version:  ('v1.4.0-19-ga52c8d9', '1.4.1') \r\n  + Tensorpack version: 0.8.9\r\n  + Hardware information, 4 GPUs\r\n\r\nAfter adding `session_config=get_default_sess_config()` to TrainConfig in [`shufflenet.py`](https://github.com/tensorpack/tensorpack/blob/master/examples/ImageNetModels/shufflenet.py#L220), I can launch training without the error. ", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/929/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/929/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/914", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/914/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/914/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/914/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/914", "id": 365112725, "node_id": "MDU6SXNzdWUzNjUxMTI3MjU=", "number": 914, "title": "param `last_k` in `StatMonitorParamSetter` is misleading", "user": {"login": "thuzhf", "id": 8064242, "node_id": "MDQ6VXNlcjgwNjQyNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/8064242?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thuzhf", "html_url": "https://github.com/thuzhf", "followers_url": "https://api.github.com/users/thuzhf/followers", "following_url": "https://api.github.com/users/thuzhf/following{/other_user}", "gists_url": "https://api.github.com/users/thuzhf/gists{/gist_id}", "starred_url": "https://api.github.com/users/thuzhf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thuzhf/subscriptions", "organizations_url": "https://api.github.com/users/thuzhf/orgs", "repos_url": "https://api.github.com/users/thuzhf/repos", "events_url": "https://api.github.com/users/thuzhf/events{/privacy}", "received_events_url": "https://api.github.com/users/thuzhf/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-09-29T08:49:26Z", "updated_at": "2018-09-30T07:09:29Z", "closed_at": "2018-09-30T07:09:29Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "https://github.com/tensorpack/tensorpack/blob/da143e0fa8850dfafd068c7e2c9d0f882e6bd5db/tensorpack/callbacks/param.py#L301-L367\r\n\r\n`last_k` in the above class means `the last k epochs`. But L352 only uses the last `k` values in the `hist` (`hist = self.trainer.monitors.get_history(self.stat_name)`) variable. And if you set `period` in the following class to be greater than `0`, the `hist` variable can also be appended values within each epoch together with at the end of each epoch which will lead to that the last `k` values in `hist` doesn't correspond to the last `k` epochs.\r\n\r\nhttps://github.com/tensorpack/tensorpack/blob/da143e0fa8850dfafd068c7e2c9d0f882e6bd5db/tensorpack/callbacks/summary.py#L101\r\n\r\nSince the class `StatMonitorParamSetter ` seems coupling with class `MergeAllSummaries`, I think you can change the `last_k`'s meaning to be the last k `period` which is defined in `MergeAllSummaries`, and also change some epoch-related code in the class `StatMonitorParamSetter`. Otherwise users cannot use this class together with setting `period` to be greater than `0` in `MergeAllSummaries`.", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/914/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/914/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/905", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/905/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/905/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/905/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/905", "id": 362811931, "node_id": "MDU6SXNzdWUzNjI4MTE5MzE=", "number": 905, "title": "InfoGan example error: Size of datapoint and placeholders are different", "user": {"login": "AndyShih12", "id": 11932455, "node_id": "MDQ6VXNlcjExOTMyNDU1", "avatar_url": "https://avatars.githubusercontent.com/u/11932455?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AndyShih12", "html_url": "https://github.com/AndyShih12", "followers_url": "https://api.github.com/users/AndyShih12/followers", "following_url": "https://api.github.com/users/AndyShih12/following{/other_user}", "gists_url": "https://api.github.com/users/AndyShih12/gists{/gist_id}", "starred_url": "https://api.github.com/users/AndyShih12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AndyShih12/subscriptions", "organizations_url": "https://api.github.com/users/AndyShih12/orgs", "repos_url": "https://api.github.com/users/AndyShih12/repos", "events_url": "https://api.github.com/users/AndyShih12/events{/privacy}", "received_events_url": "https://api.github.com/users/AndyShih12/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 676134026, "node_id": "MDU6TGFiZWw2NzYxMzQwMjY=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/examples", "name": "examples", "color": "e99695", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-09-22T00:46:27Z", "updated_at": "2018-11-27T04:23:29Z", "closed_at": "2018-09-22T00:48:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "__PLEASE ALWAYS INCLUDE__:\r\n1. What you did:\r\n  + If you're using examples: Yes\r\n    + What's the command you run: ./examples/GAN/InfoGAN-mnist.py\r\n    + Have you made any changes to code? Paste them if any: None\r\n  + If not, tell us what you did that may be relevant.\r\n    But we may not investigate it if there is no reproducible code.\r\n  + Better to paste what you did instead of describing them.\r\n  Downloaded tensorpack and ran \"./examples/GAN/InfoGAN-mnist.py\"\r\n\r\n2. What you observed, including but not limited to the __entire__ logs.\r\n  + Better to paste what you observed instead of describing them.\r\n\r\n[0921 17:17:33 @logger.py:73] Argv: ./examples/GAN/InfoGAN-mnist.py\r\n[0921 17:17:33 @input_source.py:220] Setting up the queue 'QueueInput/input_queue' for CPU prefetching ...\r\n[0921 17:17:33 @registry.py:121] gen/fc0 input: [None, 74]\r\n[0921 17:17:33 @registry.py:129] gen/fc0 output: [None, 1024]\r\n[0921 17:17:33 @registry.py:121] gen/fc1 input: [None, 1024]\r\n[0921 17:17:33 @registry.py:129] gen/fc1 output: [None, 6272]\r\n[0921 17:17:33 @registry.py:121] gen/deconv1 input: [None, 7, 7, 128]\r\n[0921 17:17:33 @registry.py:129] gen/deconv1 output: [None, 14, 14, 64]\r\n[0921 17:17:33 @registry.py:121] gen/deconv2 input: [None, 14, 14, 64]\r\n[0921 17:17:33 @registry.py:129] gen/deconv2 output: [None, 28, 28, 1]\r\n[0921 17:17:33 @registry.py:121] discrim/conv0 input: [None, 28, 28, 1]\r\n[0921 17:17:33 @registry.py:129] discrim/conv0 output: [None, 14, 14, 64]\r\n[0921 17:17:33 @registry.py:121] discrim/conv1 input: [None, 14, 14, 64]\r\n[0921 17:17:33 @registry.py:129] discrim/conv1 output: [None, 7, 7, 128]\r\n[0921 17:17:33 @registry.py:121] discrim/fc1 input: [None, 7, 7, 128]\r\n[0921 17:17:33 @registry.py:129] discrim/fc1 output: [None, 1024]\r\n[0921 17:17:33 @registry.py:121] discrim/fct input: [None, 1024]\r\n[0921 17:17:33 @registry.py:129] discrim/fct output: [None, 1]\r\n[0921 17:17:33 @registry.py:121] discrim/fce1 input: [None, 1024]\r\n[0921 17:17:33 @registry.py:129] discrim/fce1 output: [None, 128]\r\n[0921 17:17:33 @registry.py:121] discrim/fce-out input: [None, 128]\r\n[0921 17:17:33 @registry.py:129] discrim/fce-out output: [None, 12]\r\n[0921 17:17:34 @gradproc.py:257] Gradient of 'gen/fc0/W' is multipled by 5\r\n[0921 17:17:34 @gradproc.py:257] Gradient of 'gen/fc0/b' is multipled by 5\r\n[0921 17:17:34 @gradproc.py:257] Gradient of 'gen/fc0/bn/gamma' is multipled by 5\r\n[0921 17:17:34 @gradproc.py:257] Gradient of 'gen/fc0/bn/beta' is multipled by 5\r\n[0921 17:17:34 @gradproc.py:257] Gradient of 'gen/fc1/W' is multipled by 5\r\n[0921 17:17:34 @gradproc.py:257] Gradient of 'gen/fc1/b' is multipled by 5\r\n[0921 17:17:34 @gradproc.py:257] Gradient of 'gen/fc1/bn/gamma' is multipled by 5\r\n[0921 17:17:34 @gradproc.py:257] Gradient of 'gen/fc1/bn/beta' is multipled by 5\r\n[0921 17:17:34 @gradproc.py:257] Gradient of 'gen/deconv1/W' is multipled by 5\r\n[0921 17:17:34 @gradproc.py:257] Gradient of 'gen/deconv1/b' is multipled by 5\r\n[0921 17:17:34 @gradproc.py:257] Gradient of 'gen/deconv1/bn/gamma' is multipled by 5\r\n[0921 17:17:34 @gradproc.py:257] Gradient of 'gen/deconv1/bn/beta' is multipled by 5\r\n[0921 17:17:34 @gradproc.py:257] Gradient of 'gen/deconv2/W' is multipled by 5\r\n[0921 17:17:34 @gradproc.py:257] Gradient of 'gen/deconv2/b' is multipled by 5\r\n[0921 17:17:35 @model_utils.py:64] Trainable Variables: \r\nname                    shape                dim\r\n----------------------  ---------------  -------\r\ngen/fc0/W:0             [74, 1024]         75776\r\ngen/fc0/b:0             [1024]              1024\r\ngen/fc0/bn/gamma:0      [1024]              1024\r\ngen/fc0/bn/beta:0       [1024]              1024\r\ngen/fc1/W:0             [1024, 6272]     6422528\r\ngen/fc1/b:0             [6272]              6272\r\ngen/fc1/bn/gamma:0      [6272]              6272\r\ngen/fc1/bn/beta:0       [6272]              6272\r\ngen/deconv1/W:0         [4, 4, 64, 128]   131072\r\ngen/deconv1/b:0         [64]                  64\r\ngen/deconv1/bn/gamma:0  [64]                  64\r\ngen/deconv1/bn/beta:0   [64]                  64\r\ngen/deconv2/W:0         [4, 4, 1, 64]       1024\r\ngen/deconv2/b:0         [1]                    1\r\ndiscrim/conv0/W:0       [4, 4, 1, 64]       1024\r\ndiscrim/conv0/b:0       [64]                  64\r\ndiscrim/conv1/W:0       [4, 4, 64, 128]   131072\r\ndiscrim/conv1/b:0       [128]                128\r\ndiscrim/bn1/gamma:0     [128]                128\r\ndiscrim/bn1/beta:0      [128]                128\r\ndiscrim/fc1/W:0         [6272, 1024]     6422528\r\ndiscrim/fc1/b:0         [1024]              1024\r\ndiscrim/bn2/gamma:0     [1024]              1024\r\ndiscrim/bn2/beta:0      [1024]              1024\r\ndiscrim/fct/W:0         [1024, 1]           1024\r\ndiscrim/fct/b:0         [1]                    1\r\ndiscrim/fce1/W:0        [1024, 128]       131072\r\ndiscrim/fce1/b:0        [128]                128\r\ndiscrim/bne/gamma:0     [128]                128\r\ndiscrim/bne/beta:0      [128]                128\r\ndiscrim/fce-out/W:0     [128, 12]           1536\r\ndiscrim/fce-out/b:0     [12]                  12\r\nTotal #vars=32, #params=13344654, size=50.91MB\r\n[0921 17:17:35 @base.py:187] Setup callbacks graph ...\r\n[0921 17:17:35 @summary.py:38] Maintain moving average summary of 11 tensors in collection MOVING_SUMMARY_OPS.\r\n[0921 17:17:35 @summary.py:75] Summarizing collection 'summaries' of size 15.\r\n[0921 17:17:35 @graph.py:91] Applying collection UPDATE_OPS of 18 ops.\r\n[0921 17:17:36 @base.py:205] Creating the session ...\r\n2018-09-21 17:17:36.207761: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX\r\n[0921 17:17:36 @base.py:211] Initializing the session ...\r\n[0921 17:17:36 @base.py:218] Graph Finalized.\r\n[0921 17:17:36 @concurrency.py:37] Starting EnqueueThread QueueInput/input_queue ...\r\n[0921 17:17:37 @input_source.py:168] ERR Exception in EnqueueThread QueueInput/input_queue:\r\nTraceback (most recent call last):\r\n  File \"/home/usr/tensorflow/local/lib/python2.7/site-packages/tensorpack/input_source/input_source.py\", line 159, in run\r\n    feed = _make_feeds(self.placehdrs, dp)\r\n  File \"/home/usr/tensorflow/local/lib/python2.7/site-packages/tensorpack/input_source/input_source.py\", line 41, in _make_feeds\r\n    len(datapoint), len(placeholders))\r\nAssertionError: Size of datapoint and placeholders are different: 2 != 1\r\n[0921 17:17:37 @input_source.py:174] EnqueueThread QueueInput/input_queue Exited.\r\n[0921 17:17:37 @base.py:250] Start Epoch 1 ...\r\n  0%|                                                                           |0/500[00:00<?,?it/s][0921 17:17:38 @base.py:266] Training was stopped by exception FIFOQueue '_0_QueueInput/input_queue' is closed and has insufficient elements (requested 1, current size 0)\r\n\t [[Node: QueueInput/input_deque = QueueDequeueV2[component_types=[DT_FLOAT], timeout_ms=-1, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](QueueInput/input_queue)]]\r\n\r\nCaused by op u'QueueInput/input_deque', defined at:\r\n  File \"./examples/GAN/InfoGAN-mnist.py\", line 313, in <module>\r\n    Model()).train_with_defaults(\r\n  File \"/home/usr/Desktop/infogan/tensorpack/examples/GAN/GAN.py\", line 99, in __init__\r\n    self.tower_func(*input.get_input_tensors())\r\n  File \"/home/usr/tensorflow/local/lib/python2.7/site-packages/tensorpack/input_source/input_source_base.py\", line 81, in get_input_tensors\r\n    return self._get_input_tensors()\r\n  File \"/home/usr/tensorflow/local/lib/python2.7/site-packages/tensorpack/input_source/input_source.py\", line 267, in _get_input_tensors\r\n    ret = self.queue.dequeue(name='input_deque')\r\n  File \"/home/usr/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/data_flow_ops.py\", line 432, in dequeue\r\n    self._queue_ref, self._dtypes, name=name)\r\n  File \"/home/usr/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/gen_data_flow_ops.py\", line 2630, in _queue_dequeue_v2\r\n    timeout_ms=timeout_ms, name=name)\r\n  File \"/home/usr/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/home/usr/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 3160, in create_op\r\n    op_def=op_def)\r\n  File \"/home/usr/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1625, in __init__\r\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\r\n\r\nOutOfRangeError (see above for traceback): FIFOQueue '_0_QueueInput/input_queue' is closed and has insufficient elements (requested 1, current size 0)\r\n\t [[Node: QueueInput/input_deque = QueueDequeueV2[component_types=[DT_FLOAT], timeout_ms=-1, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](QueueInput/input_queue)]]\r\n.\r\n\r\n\r\n3. What you expected, if not obvious.\r\n4. Your environment: Ubuntu 16.04\r\n  + Python version. 2.7.12\r\n  + TF version: `python -c 'import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)'`. \r\n('v1.5.0-0-g37aa430d84', '1.5.0')\r\n\r\n  + Tensorpack version: `python -c 'import tensorpack; print(tensorpack.__version__)'`.\r\n      You can install Tensorpack master by `pip install -U git+https://github.com/ppwwyyxx/tensorpack.git`.:\r\n0.8.9\r\n  + Hardware information, e.g. number of GPUs used.\r\n0 GPU\r\nAbout efficiency issues, PLEASE first read http://tensorpack.readthedocs.io/en/latest/tutorial/performance-tuning.html\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/905/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/905/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/904", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/904/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/904/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/904/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/904", "id": 362544017, "node_id": "MDU6SXNzdWUzNjI1NDQwMTc=", "number": 904, "title": "AttributeError: 'TrainLoop' object has no attribute 'starting_epoch'", "user": {"login": "thuzhf", "id": 8064242, "node_id": "MDQ6VXNlcjgwNjQyNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/8064242?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thuzhf", "html_url": "https://github.com/thuzhf", "followers_url": "https://api.github.com/users/thuzhf/followers", "following_url": "https://api.github.com/users/thuzhf/following{/other_user}", "gists_url": "https://api.github.com/users/thuzhf/gists{/gist_id}", "starred_url": "https://api.github.com/users/thuzhf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thuzhf/subscriptions", "organizations_url": "https://api.github.com/users/thuzhf/orgs", "repos_url": "https://api.github.com/users/thuzhf/repos", "events_url": "https://api.github.com/users/thuzhf/events{/privacy}", "received_events_url": "https://api.github.com/users/thuzhf/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-09-21T10:04:49Z", "updated_at": "2018-09-21T20:14:52Z", "closed_at": "2018-09-21T20:14:52Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The problem occurred when L318 below is executed if `stats is not None` (e.g. when you restore training from a log dir). The full error message is attached in the end.\r\nhttps://github.com/tensorpack/tensorpack/blob/36b05bb71a498da3ea430c3a109cf9a9dddecbd8/tensorpack/callbacks/monitor.py#L309-L318\r\n\r\nIt can be seen `self.starting_epoch` is defined in L48 below.\r\nhttps://github.com/tensorpack/tensorpack/blob/36b05bb71a498da3ea430c3a109cf9a9dddecbd8/tensorpack/train/base.py#L44-L48\r\n\r\nAnd `config()` is called in L241 below in the `main_loop()` function.\r\nhttps://github.com/tensorpack/tensorpack/blob/36b05bb71a498da3ea430c3a109cf9a9dddecbd8/tensorpack/train/base.py#L233-L241\r\n\r\nAnd `setup_callbacks()` (L289 below) is executed before `main_loop()` (L291 below).\r\nhttps://github.com/tensorpack/tensorpack/blob/36b05bb71a498da3ea430c3a109cf9a9dddecbd8/tensorpack/train/base.py#L274-L291\r\n\r\nAnd L318 in the first file (monitor.py) will be finally executed in the calling of `setup_callbacks()` above. Actually you already have `load_existing_epoch_number ` in L298 below.\r\nhttps://github.com/tensorpack/tensorpack/blob/36b05bb71a498da3ea430c3a109cf9a9dddecbd8/tensorpack/callbacks/monitor.py#L298\r\n\r\nAnd the above function is only called in the following class:\r\nhttps://github.com/tensorpack/tensorpack/blob/36b05bb71a498da3ea430c3a109cf9a9dddecbd8/tensorpack/train/config.py#L177-L240\r\n\r\nEven if I changed `TrainConfig()` to `AutoResumeTrainConfig()`, the same problem still occurred due to the same reason. Although `self.starting_epoch` is also defined below, it is the `config`'s attribute instead of the `train.loop`'s:\r\nhttps://github.com/tensorpack/tensorpack/blob/7b8728f96b76774a5d345390cfb5607c8935d9e3/tensorpack/train/config.py#L146\r\n\r\n I think some easy workarounds will be: \r\n* Defining `starting_epoch` earlier as the `train.loop`'s attribute (that way `AutoResumeTrainConfig()` will probably work).\r\n* Changing L318 in the first file (monitor.py) to use function `load_existing_epoch_number()` (that way maybe will make `AutoResumeTrainConfig()` useless, but this is handy because users can always use `TrainConfig()`).\r\n\r\nHowever, to be consistent with the logic of your `Trainer.train()` function (including 3 functions), it seems it needs more consideration on how to fix this.\r\n\r\nThe following is the full error message:\r\n```\r\nTraceback (most recent call last):\r\n  File \"main.py\", line 307, in <module>\r\n    main()\r\n  File \"main.py\", line 303, in main\r\n    launch_train_with_config(config, trainer)\r\n  File \"/data/fangzhang/anaconda3/lib/python3.6/site-packages/tensorpack/train/interface.py\", line 95, in launch_train_with_config\r\n    extra_callbacks=config.extra_callbacks)\r\n  File \"/data/fangzhang/anaconda3/lib/python3.6/site-packages/tensorpack/train/base.py\", line 319, in train_with_defaults\r\n    steps_per_epoch, starting_epoch, max_epoch)\r\n  File \"/data/fangzhang/anaconda3/lib/python3.6/site-packages/tensorpack/train/base.py\", line 289, in train\r\n    self.setup_callbacks(callbacks, monitors)\r\n  File \"/data/fangzhang/anaconda3/lib/python3.6/site-packages/tensorpack/utils/argtools.py\", line 181, in wrapper\r\n    return func(*args, **kwargs)\r\n  File \"/data/fangzhang/anaconda3/lib/python3.6/site-packages/tensorpack/train/base.py\", line 189, in setup_callbacks\r\n    self._callbacks.setup_graph(weakref.proxy(self))\r\n  File \"/data/fangzhang/anaconda3/lib/python3.6/site-packages/tensorpack/callbacks/base.py\", line 52, in setup_graph\r\n    self._setup_graph()\r\n  File \"/data/fangzhang/anaconda3/lib/python3.6/site-packages/tensorpack/callbacks/group.py\", line 70, in _setup_graph\r\n    cb.setup_graph(self.trainer)\r\n  File \"/data/fangzhang/anaconda3/lib/python3.6/site-packages/tensorpack/callbacks/monitor.py\", line 55, in setup_graph\r\n    self._setup_graph()\r\n  File \"/data/fangzhang/anaconda3/lib/python3.6/site-packages/tensorpack/callbacks/monitor.py\", line 318, in _setup_graph\r\n    starting_epoch = self.trainer.loop.starting_epoch\r\nAttributeError: 'TrainLoop' object has no attribute 'starting_epoch'\r\n```", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/904/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/904/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/897", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/897/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/897/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/897/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/897", "id": 360834667, "node_id": "MDU6SXNzdWUzNjA4MzQ2Njc=", "number": 897, "title": "UnboundLocalError: local variable 'raw_devices' referenced before assignment", "user": {"login": "thuzhf", "id": 8064242, "node_id": "MDQ6VXNlcjgwNjQyNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/8064242?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thuzhf", "html_url": "https://github.com/thuzhf", "followers_url": "https://api.github.com/users/thuzhf/followers", "following_url": "https://api.github.com/users/thuzhf/following{/other_user}", "gists_url": "https://api.github.com/users/thuzhf/gists{/gist_id}", "starred_url": "https://api.github.com/users/thuzhf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thuzhf/subscriptions", "organizations_url": "https://api.github.com/users/thuzhf/orgs", "repos_url": "https://api.github.com/users/thuzhf/repos", "events_url": "https://api.github.com/users/thuzhf/events{/privacy}", "received_events_url": "https://api.github.com/users/thuzhf/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-09-17T11:56:57Z", "updated_at": "2018-09-17T16:28:11Z", "closed_at": "2018-09-17T15:59:37Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "https://github.com/tensorpack/tensorpack/blob/801e29218f299905298b9bf430d2b95b527b04d5/tensorpack/graph_builder/training.py#L350-L355\r\n\r\nI have reviewed this file, and by comparison I think `raw_devices = ['/gpu:{}'.format(k) for k in self.towers]` in line 351 should probably be defined before the `if-else` statement just like line 153-158 in the same file:\r\nhttps://github.com/tensorpack/tensorpack/blob/801e29218f299905298b9bf430d2b95b527b04d5/tensorpack/graph_builder/training.py#L153-L158", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/897/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/897/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/893", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/893/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/893/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/893/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/893", "id": 359962134, "node_id": "MDU6SXNzdWUzNTk5NjIxMzQ=", "number": 893, "title": "Concerns on the uses of `self._init(locals())` in some classes", "user": {"login": "thuzhf", "id": 8064242, "node_id": "MDQ6VXNlcjgwNjQyNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/8064242?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thuzhf", "html_url": "https://github.com/thuzhf", "followers_url": "https://api.github.com/users/thuzhf/followers", "following_url": "https://api.github.com/users/thuzhf/following{/other_user}", "gists_url": "https://api.github.com/users/thuzhf/gists{/gist_id}", "starred_url": "https://api.github.com/users/thuzhf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thuzhf/subscriptions", "organizations_url": "https://api.github.com/users/thuzhf/orgs", "repos_url": "https://api.github.com/users/thuzhf/repos", "events_url": "https://api.github.com/users/thuzhf/events{/privacy}", "received_events_url": "https://api.github.com/users/thuzhf/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-09-13T16:03:23Z", "updated_at": "2018-11-27T04:24:12Z", "closed_at": "2018-09-13T20:26:42Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "1. What you did:\r\n  + If you're using examples: Yes. Actually I notice that you define and call `self._init(locals())` in some classes' `self.__init__()` method. I don't see explanations on this use, but it seems handy and I thought this method could also be used in some other classes. But problems ocurr when I inherit from these classes. The point is that if you inherit from these classes who call `self._init(locals())` inside their `self.__init__()`, the child class's `__class__` will be set to the parent class. In this case, if you override some of the parent class's methods, it won't work; that's to say, when you call these overrided methods inside an instance of the child class, it will still call the parent's corresponding method instead of the child's. I will give a concrete example below.\r\n    + What's the command you run: Please see the pasted code below.\r\n    + Have you made any changes to code? Paste them if any: Please see the pasted code below.\r\n  + Better to paste what you did instead of describing them. Please see the pasted code below.\r\n```python\r\nclass Z:\r\n    pass # do other things\r\n\r\nclass A(Z):\r\n    def __init__(self, x):\r\n        super().__init__()\r\n        self._init(locals())\r\n\r\n    def _init(self, params=None):\r\n        if params:\r\n            for k, v in params.items():\r\n                # if k != 'self' and k != '__class__' and ...:\r\n                if k != 'self':\r\n                    setattr(self, k, v)\r\n\r\n    def f(self):\r\n        print('from A')\r\n\r\nclass B(A):\r\n    def __init__(self, x):\r\n        print('self1: {}'.format(self))\r\n        super().__init__(x)\r\n        print('self2: {}'.format(self))\r\n\r\n    def f(self):\r\n        print('from B')\r\n\r\nb = B(x=3) # self1 and self2 will be different\r\nb.f() # and this will print: 'from A'\r\n###### The output is pasted below:\r\n# self1: <__main__.B object at 0x7fec3562c240>\r\n# self2: <__main__.A object at 0x7fec3562c240>\r\n# from A\r\n######\r\n```\r\n2. What you observed, including but not limited to the __entire__ logs.\r\n  + Better to paste what you observed instead of describing them: Please see below.\r\n```\r\nself1: <__main__.B object at 0x7fec3562c240>\r\nself2: <__main__.A object at 0x7fec3562c240>\r\nfrom A\r\n```\r\n3. What you expected, if not obvious: I expected `self1` and `self2` would be the same, and `b.f()` will print: `'from B'`\r\n4. Your environment:\r\n  + Python version: 3.6.5\r\n  + TF version: `v1.10.1-0-g4dcfddc5d1 1.10.1`.\r\n  + Tensorpack version: `0.8.9`.\r\n\r\nIn this case, it seems people shouldn't inherit from such classes. Because `self._init(locals())` is used in some places in your code and I see no explanation on it, I am not sure whether this is your expected behavior. Is it a possible bug or is this your expected behavior (if it is your expected, would you please give me some explanations on how to use it properly)? Thanks!", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/893/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/893/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/860", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/860/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/860/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/860/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/860", "id": 349898512, "node_id": "MDU6SXNzdWUzNDk4OTg1MTI=", "number": 860, "title": "What is TowerContext error when the code set up the queue##Usage Questions", "user": {"login": "yuyijie1995", "id": 30818917, "node_id": "MDQ6VXNlcjMwODE4OTE3", "avatar_url": "https://avatars.githubusercontent.com/u/30818917?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yuyijie1995", "html_url": "https://github.com/yuyijie1995", "followers_url": "https://api.github.com/users/yuyijie1995/followers", "following_url": "https://api.github.com/users/yuyijie1995/following{/other_user}", "gists_url": "https://api.github.com/users/yuyijie1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/yuyijie1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yuyijie1995/subscriptions", "organizations_url": "https://api.github.com/users/yuyijie1995/orgs", "repos_url": "https://api.github.com/users/yuyijie1995/repos", "events_url": "https://api.github.com/users/yuyijie1995/events{/privacy}", "received_events_url": "https://api.github.com/users/yuyijie1995/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-08-13T06:09:04Z", "updated_at": "2018-08-13T06:49:40Z", "closed_at": "2018-08-13T06:11:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "When I use the FaterRCNN example to train my own data ,there is always a error like below\r\n[0813 14:01:42 @input_source.py:202] Setting up the queue 'QueueInput/input_queue' for CPU prefetching ...\r\nTraceback (most recent call last):\r\n  File \"/home/jsu/yuyijie/tensorpack/tensorpack/examples/FasterRCNN/train.py\", line 628, in <module>\r\n    launch_train_with_config(traincfg, trainer)\r\n  File \"/home/jsu/anaconda3/envs/tensorflow/lib/python3.6/site-packages/tensorpack/train/interface.py\", line 85, in launch_train_with_config\r\n    model._build_graph_get_cost, model.get_optimizer)\r\n  File \"/home/jsu/anaconda3/envs/tensorflow/lib/python3.6/site-packages/tensorpack/utils/argtools.py\", line 181, in wrapper\r\n    return func(*args, **kwargs)\r\n  File \"/home/jsu/anaconda3/envs/tensorflow/lib/python3.6/site-packages/tensorpack/train/tower.py\", line 202, in setup_graph\r\n    input_callbacks = self._setup_input(inputs_desc, input)\r\n  File \"/home/jsu/anaconda3/envs/tensorflow/lib/python3.6/site-packages/tensorpack/train/tower.py\", line 218, in _setup_input\r\n    return input.setup(inputs_desc)\r\n  File \"/home/jsu/anaconda3/envs/tensorflow/lib/python3.6/site-packages/tensorpack/utils/argtools.py\", line 181, in wrapper\r\n    return func(*args, **kwargs)\r\n  File \"/home/jsu/anaconda3/envs/tensorflow/lib/python3.6/site-packages/tensorpack/input_source/input_source_base.py\", line 99, in setup\r\n    return self.get_callbacks()\r\n  File \"/home/jsu/anaconda3/envs/tensorflow/lib/python3.6/site-packages/tensorpack/input_source/input_source_base.py\", line 126, in get_callbacks\r\n    before_train=lambda _: self.reset_state())] + self._get_callbacks()\r\n  File \"/home/jsu/anaconda3/envs/tensorflow/lib/python3.6/site-packages/tensorpack/input_source/input_source.py\", line 245, in _get_callbacks\r\n    return [cb, self._create_ema_callback(), _get_reset_callback(self._inf_ds)]\r\n  File \"/home/jsu/anaconda3/envs/tensorflow/lib/python3.6/site-packages/tensorpack/input_source/input_source.py\", line 235, in _create_ema_callback\r\n    size_ema_op = add_moving_summary(size, collection=None, decay=0.5)[0].op\r\n  File \"/home/jsu/anaconda3/envs/tensorflow/lib/python3.6/site-packages/tensorpack/tfutils/summary.py\", line 222, in add_moving_summary\r\n    ctx = get_current_tower_context()\r\n  File \"/home/jsu/anaconda3/envs/tensorflow/lib/python3.6/site-packages/tensorpack/tfutils/tower.py\", line 222, in get_current_tower_context\r\n    assert _CurrentTowerContext is not None, \"The function is supposed to be called under a TowerContext!\"\r\nAssertionError: The function is supposed to be called under a TowerContext!\r\nI  can not understand what it is mean and how to fix it .\r\nCan you give me some suggestions?Thanks a lot\r\nmy file structure like this \r\n/home/jsu/\u56fe\u7247/2018-08-13 14-08-34\u5c4f\u5e55\u622a\u56fe.png", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/860/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/860/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/847", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/847/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/847/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/847/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/847", "id": 346775125, "node_id": "MDU6SXNzdWUzNDY3NzUxMjU=", "number": 847, "title": "TypeError: unsupported operand type(s) for /: 'float' and 'list'", "user": {"login": "PacteraOliver", "id": 39574990, "node_id": "MDQ6VXNlcjM5NTc0OTkw", "avatar_url": "https://avatars.githubusercontent.com/u/39574990?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PacteraOliver", "html_url": "https://github.com/PacteraOliver", "followers_url": "https://api.github.com/users/PacteraOliver/followers", "following_url": "https://api.github.com/users/PacteraOliver/following{/other_user}", "gists_url": "https://api.github.com/users/PacteraOliver/gists{/gist_id}", "starred_url": "https://api.github.com/users/PacteraOliver/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PacteraOliver/subscriptions", "organizations_url": "https://api.github.com/users/PacteraOliver/orgs", "repos_url": "https://api.github.com/users/PacteraOliver/repos", "events_url": "https://api.github.com/users/PacteraOliver/events{/privacy}", "received_events_url": "https://api.github.com/users/PacteraOliver/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 676134026, "node_id": "MDU6TGFiZWw2NzYxMzQwMjY=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/examples", "name": "examples", "color": "e99695", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-08-01T21:25:30Z", "updated_at": "2018-11-27T04:30:07Z", "closed_at": "2018-08-01T21:27:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "In Faster RCNN, I run the example and it shows the following error.\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 534, in <module>\r\n    output_names=MODEL.get_inference_tensor_names()[1]))\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorpack/predict/base.py\", line 169, in __init__\r\n    config.tower_func(*input.get_input_tensors())\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorpack/tfutils/tower.py\", line 255, in __call__\r\n    output = self._tower_fn(*args)\r\n  File \"train.py\", line 306, in build_graph\r\n    image = self.preprocess(image)     # 1CHW\r\n  File \"train.py\", line 60, in preprocess\r\n    image = image_preprocess(image, bgr=True)\r\n  File \"/home/oliver/Documents/tensorpack/examples/FasterRCNN/basemodel.py\", line 105, in image_preprocess\r\n    image_invstd = tf.constant(1.0 / std, dtype=tf.float32)\r\nTypeError: unsupported operand type(s) for /: 'float' and 'list'\r\n```\r\n\r\nIt happened in this function `image_preprocess`:\r\n\r\n```python\r\ndef image_preprocess(image, bgr=True):\r\n    with tf.name_scope('image_preprocess'):\r\n        if image.dtype.base_dtype != tf.float32:\r\n            image = tf.cast(image, tf.float32)\r\n\r\n        mean = cfg.PREPROC.PIXEL_MEAN\r\n        std = cfg.PREPROC.PIXEL_STD\r\n        if bgr:\r\n            mean = mean[::-1]\r\n            std = std[::-1]\r\n        image_mean = tf.constant(mean, dtype=tf.float32) \r\n        image_invstd = tf.constant(1.0 / std, dtype=tf.float32) # Here\r\n        image = (image - image_mean) * image_invstd\r\n        return image\r\n```\r\n\r\nThank you!", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/847/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/847/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/816", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/816/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/816/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/816/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/816", "id": 339389911, "node_id": "MDU6SXNzdWUzMzkzODk5MTE=", "number": 816, "title": "Type of PyArrow.Lib.Buffer for dump_dataflow_to_tfrecord w/ pyarrow", "user": {"login": "hsienkaikuo", "id": 15683160, "node_id": "MDQ6VXNlcjE1NjgzMTYw", "avatar_url": "https://avatars.githubusercontent.com/u/15683160?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hsienkaikuo", "html_url": "https://github.com/hsienkaikuo", "followers_url": "https://api.github.com/users/hsienkaikuo/followers", "following_url": "https://api.github.com/users/hsienkaikuo/following{/other_user}", "gists_url": "https://api.github.com/users/hsienkaikuo/gists{/gist_id}", "starred_url": "https://api.github.com/users/hsienkaikuo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hsienkaikuo/subscriptions", "organizations_url": "https://api.github.com/users/hsienkaikuo/orgs", "repos_url": "https://api.github.com/users/hsienkaikuo/repos", "events_url": "https://api.github.com/users/hsienkaikuo/events{/privacy}", "received_events_url": "https://api.github.com/users/hsienkaikuo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-07-09T10:20:09Z", "updated_at": "2018-11-27T04:26:35Z", "closed_at": "2018-07-09T18:34:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am trying to dump a dataflow to both LMDB/TFRecord. While dumping LMDB is fine, but TFRecord will hit the following Error:\r\n\r\n====TraceBack====\r\nTraceback (most recent call last):\r\n  File \"RecordIO2TFRecord.py\", line 24, in <module>\r\n    tensorpack.dataflow.dftools.dump_dataflow_to_tfrecord(ds, args.tfrecord)\r\n  File \"/home/hsienkai.kuo/.local/lib/python2.7/site-packages/tensorpack/dataflow/dftools.py\", line 124, in dump_dataflow_to_tfrecord\r\n    writer.write(dumps(dp))\r\n  File \"/home/hsienkai.kuo/.local/lib/python2.7/site-packages/tensorflow/python/lib/io/tf_record.py\", line 128, in write\r\n    self._writer.WriteRecord(record)\r\n  File \"/home/hsienkai.kuo/.local/lib/python2.7/site-packages/tensorflow/python/pywrap_tensorflow_internal.py\", line 503, in WriteRecord\r\n    return _pywrap_tensorflow_internal.PyRecordWriter_WriteRecord(self, record)\r\n**TypeError: expected string or Unicode object, pyarrow.lib.Buffer found**\r\n\r\nAfter a quick check of PyArrow, found a workaround is to add \"to_pybytes()\" a pyarrow.lib.buffer object (utils/serialize.py). The patch is tested w/ dump_dataflow_to_tfrecord.\r\n\r\n```\r\ndef dumps_pyarrow(obj):     \r\n    \"\"\"\r\n    Serialize an object.\r\n\r\n    Returns:\r\n        Implementation-dependent bytes-like object\r\n    \"\"\"    \r\n    return pa.serialize(obj).to_buffer().to_pybytes()\r\n```\r\n\r\nPlease any check/comment if the workaround is reasonable, and if it is good as a patch. Thanks", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/816/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/816/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/804", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/804/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/804/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/804/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/804", "id": 336476121, "node_id": "MDU6SXNzdWUzMzY0NzYxMjE=", "number": 804, "title": "Inference with DoReFa-Net giving high top-1/top-5 error", "user": {"login": "sammhho", "id": 6221054, "node_id": "MDQ6VXNlcjYyMjEwNTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/6221054?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sammhho", "html_url": "https://github.com/sammhho", "followers_url": "https://api.github.com/users/sammhho/followers", "following_url": "https://api.github.com/users/sammhho/following{/other_user}", "gists_url": "https://api.github.com/users/sammhho/gists{/gist_id}", "starred_url": "https://api.github.com/users/sammhho/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sammhho/subscriptions", "organizations_url": "https://api.github.com/users/sammhho/orgs", "repos_url": "https://api.github.com/users/sammhho/repos", "events_url": "https://api.github.com/users/sammhho/events{/privacy}", "received_events_url": "https://api.github.com/users/sammhho/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 676134026, "node_id": "MDU6TGFiZWw2NzYxMzQwMjY=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/examples", "name": "examples", "color": "e99695", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2018-06-28T05:19:25Z", "updated_at": "2018-11-27T04:30:55Z", "closed_at": "2018-06-28T05:47:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, I'm trying to do inference on DoReFa-Net with the ILSVRC2012 validation set as test data\r\n(just to test the setup, not normally a \"correct\" practice I guess, but should give better-than-actual results right?),\r\nand I'm getting really high top-1/top-5 error rate.\r\n\r\nFor the first 100 test data, I'm getting top-1/top-5 error around `0.95` and `0.85`,\r\nwhere the README page says alexnet-126 should give top-1 error of `46.8%`.\r\n\r\nModels used are the `alexnet-126.npz` from the model zoo, and also one trained with `alexnet-dorefa.py` with slightly modified parameters.\r\nReport from training in `log.log` looks fine:\r\n```\r\ntrain-error-top1: 0.41264\r\ntrain-error-top5: 0.19853\r\nval-error-top1: 0.4913\r\nval-error-top5: 0.25514\r\n```\r\n\r\nTried on 2 setups: \r\na) python2.7 + tensorflow-gpu ('v1.4.0-19-ga52c8d9', '1.4.1') + tensorpack 0.8.6 + CUDA8 + Tesla K40c + `dorefa.py` from [here](https://github.com/tensorpack/tensorpack/blob/58529de18e9bdad1bab31aed9c397a8f340e7f94/examples/DoReFa-Net/dorefa.py) for TensorFlow<1.7\r\nb) python3.6 + tensorflow 'v1.8.0-3921-gfb3ce04' 1.9.0-rc0 + Intel MKL(for data_format NCHW on CPU) + tensorpack 0.8.6\r\n\r\nThe inference script was slightly modified from `alexnet-dorefa.py` at the end of the `run_image` function, \r\njust to use the ILSVRC data and also print the top-1/top-5 error, as given below.\r\nDid I do anything silly? Can someone help try this script on your setup?\r\n\r\n```python\r\nimport cv2\r\nimport tensorflow as tf\r\nimport argparse\r\nimport numpy as np\r\nimport os\r\nimport sys\r\n\r\n\r\nfrom tensorpack import *\r\nfrom tensorpack.tfutils.summary import add_param_summary\r\nfrom tensorpack.tfutils.varreplace import remap_variables\r\nfrom tensorpack.dataflow import dataset\r\nfrom tensorpack.utils.gpu import get_nr_gpu\r\n\r\nfrom imagenet_utils import get_imagenet_dataflow, fbresnet_augmentor, ImageNetModel\r\nfrom dorefa import get_dorefa, ternarize\r\n\r\n\r\nBITW = 1\r\nBITA = 2\r\nBITG = 6\r\nTOTAL_BATCH_SIZE = 256\r\nBATCH_SIZE = None\r\n\r\n\r\nclass Model(ImageNetModel):\r\n    weight_decay = 5e-6\r\n    weight_decay_pattern = 'fc.*/W'\r\n\r\n    def get_logits(self, image):\r\n        if BITW == 't':\r\n            fw, fa, fg = get_dorefa(32, 32, 32)\r\n            fw = ternarize\r\n        else:\r\n            fw, fa, fg = get_dorefa(BITW, BITA, BITG)\r\n\r\n        # monkey-patch tf.get_variable to apply fw\r\n        def new_get_variable(v):\r\n            name = v.op.name\r\n            # don't binarize first and last layer\r\n            if not name.endswith('W') or 'conv0' in name or 'fct' in name:\r\n                return v\r\n            else:\r\n                logger.info(\"Quantizing weight {}\".format(v.op.name))\r\n                return fw(v)\r\n\r\n        def nonlin(x):\r\n            if BITA == 32:\r\n                return tf.nn.relu(x)    # still use relu for 32bit cases\r\n            return tf.clip_by_value(x, 0.0, 1.0)\r\n\r\n        def activate(x):\r\n            return fa(nonlin(x))\r\n\r\n        with remap_variables(new_get_variable), \\\r\n                argscope([Conv2D, BatchNorm, MaxPooling], data_format='channels_first'), \\\r\n                argscope(BatchNorm, momentum=0.9, epsilon=1e-4), \\\r\n                argscope(Conv2D, use_bias=False):\r\n            logits = (LinearWrap(image)\r\n                      .Conv2D('conv0', 96, 12, strides=4, padding='VALID', use_bias=True)\r\n                      .apply(activate)\r\n                      .Conv2D('conv1', 256, 5, padding='SAME', split=2)\r\n                      .apply(fg)\r\n                      .BatchNorm('bn1')\r\n                      .MaxPooling('pool1', 3, 2, padding='SAME')\r\n                      .apply(activate)\r\n\r\n                      .Conv2D('conv2', 384, 3)\r\n                      .apply(fg)\r\n                      .BatchNorm('bn2')\r\n                      .MaxPooling('pool2', 3, 2, padding='SAME')\r\n                      .apply(activate)\r\n\r\n                      .Conv2D('conv3', 384, 3, split=2)\r\n                      .apply(fg)\r\n                      .BatchNorm('bn3')\r\n                      .apply(activate)\r\n\r\n                      .Conv2D('conv4', 256, 3, split=2)\r\n                      .apply(fg)\r\n                      .BatchNorm('bn4')\r\n                      .MaxPooling('pool4', 3, 2, padding='VALID')\r\n                      .apply(activate)\r\n\r\n                      .FullyConnected('fc0', 4096)\r\n                      .apply(fg)\r\n                      .BatchNorm('bnfc0')\r\n                      .apply(activate)\r\n\r\n                      .FullyConnected('fc1', 4096, use_bias=False)\r\n                      .apply(fg)\r\n                      .BatchNorm('bnfc1')\r\n                      .apply(nonlin)\r\n                      .FullyConnected('fct', 1000, use_bias=True)())\r\n        add_param_summary(('.*/W', ['histogram', 'rms']))\r\n        tf.nn.softmax(logits, name='output')  # for prediction\r\n        return logits\r\n\r\n    def optimizer(self):\r\n        lr = tf.get_variable('learning_rate', initializer=2e-4, trainable=False)\r\n        return tf.train.AdamOptimizer(lr, epsilon=1e-5)\r\n\r\n\r\ndef run_image(model, sess_init, inputs, inLabels=None):\r\n    pred_config = PredictConfig(\r\n        model=model,\r\n        session_init=sess_init,\r\n        input_names=['input'],\r\n        output_names=['output']\r\n    )\r\n    predictor = OfflinePredictor(pred_config)\r\n    meta = dataset.ILSVRCMeta()\r\n    pp_mean = meta.get_per_pixel_mean()\r\n    pp_mean_224 = pp_mean[16:-16, 16:-16, :]\r\n    words = meta.get_synset_words_1000()\r\n\r\n    def resize_func(im):\r\n        h, w = im.shape[:2]\r\n        scale = 256.0 / min(h, w)\r\n        desSize = map(int, (max(224, min(w, scale * w)),\r\n                            max(224, min(h, scale * h))))\r\n        im = cv2.resize(im, tuple(desSize), interpolation=cv2.INTER_CUBIC)\r\n        return im\r\n    transformers = imgaug.AugmentorList([\r\n        imgaug.MapImage(resize_func),\r\n        imgaug.CenterCrop((224, 224)),\r\n        imgaug.MapImage(lambda x: x - pp_mean_224),\r\n    ])\r\n    top1 = 0\r\n    top5 = 0\r\n    for idx, f in enumerate(inputs):\r\n        assert os.path.isfile(f)\r\n        img = cv2.imread(f).astype('float32')\r\n        assert img is not None\r\n\r\n        img = transformers.augment(img)[np.newaxis, :, :, :]\r\n        outputs = predictor(img)[0]\r\n        prob = outputs[0]\r\n        ret = prob.argsort()[-10:][::-1]\r\n\r\n        names = [words[i] for i in ret]\r\n        print(f + \":\")\r\n        print(list(zip(names, prob[ret])))\r\n        if inLabels is not None:\r\n          label = inLabels[idx]\r\n          if label != ret[0]:\r\n            top1 += 1\r\n            print('top1 failed, label={}, ret[0]={}'.format(label, ret[0]))\r\n          if label not in ret[:5]:\r\n            top5 += 1\r\n            print('top5 failed, ret[:5]={}'.format(ret[:5]))\r\n    print('number of test inputs={}'.format(len(inputs)))\r\n    print('top-5 err rate={}'.format(float(top5) / len(inputs)))\r\n    print('top-1 err rate={}'.format(float(top1) / len(inputs)))\r\n\r\n\r\nif __name__ == '__main__':\r\n  model = './alexnet-126.npz'\r\n  #model = './xAlexnet-126.npz'\r\n  testpath = './ILSVRC2012_img/val/'\r\n  #testset = [f for f in os.listdir(testpath) if os.path.isfile(os.path.join(testpath, f))]\r\n  meta = dataset.ILSVRCMeta()\r\n  testset = [os.path.join(testpath, f) for f, l in meta.get_image_list('val')]\r\n  testlabel = [l for f, l in meta.get_image_list('val')]\r\n\r\n  run_image(Model(), DictRestore(dict(np.load(model))), testset[:100], testlabel[:100])\r\n```", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/804/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/804/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/796", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/796/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/796/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/796/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/796", "id": 333263544, "node_id": "MDU6SXNzdWUzMzMyNjM1NDQ=", "number": 796, "title": "nan occurred when training Alexnet", "user": {"login": "jwook1004", "id": 39837223, "node_id": "MDQ6VXNlcjM5ODM3MjIz", "avatar_url": "https://avatars.githubusercontent.com/u/39837223?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwook1004", "html_url": "https://github.com/jwook1004", "followers_url": "https://api.github.com/users/jwook1004/followers", "following_url": "https://api.github.com/users/jwook1004/following{/other_user}", "gists_url": "https://api.github.com/users/jwook1004/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwook1004/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwook1004/subscriptions", "organizations_url": "https://api.github.com/users/jwook1004/orgs", "repos_url": "https://api.github.com/users/jwook1004/repos", "events_url": "https://api.github.com/users/jwook1004/events{/privacy}", "received_events_url": "https://api.github.com/users/jwook1004/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 676134026, "node_id": "MDU6TGFiZWw2NzYxMzQwMjY=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/examples", "name": "examples", "color": "e99695", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-06-18T13:12:13Z", "updated_at": "2018-11-27T04:30:19Z", "closed_at": "2018-06-18T15:41:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "Issue: Unexpected Problems / Potential Bugs\r\n\r\n1. What you did:\r\nI just git-clone this repository and ran training for Alexnet using the python script in \"https://github.com/tensorpack/tensorpack/blob/master/examples/ImageNetModels/alexnet.py\".\r\nCommand: \r\n`python3 alexnet.py --gpu 0,1 --data /home/choij/Data/ILSVRC2012 --batch 64`\r\n\r\n\r\n2. What you observed, e.g. the entire log:\r\n> [0618 07:42:45 @base.py:242] Start Epoch 1 ...\r\n> [0618 07:42:45 @input_source.py:513] Pre-filling StagingArea ...\r\n> [0618 07:42:45 @input_source.py:517] 1 element was put into StagingArea.\r\n> 100%|#####################################################################################################################################################################|10009/10009[13:44<00:00,12.14it/s]\r\n> [0618 07:56:29 @base.py:252] Epoch 1 (global_step 10009) finished, time:13 minutes 44 seconds.\r\n> [0618 07:56:29 @graph.py:73] Running Op sync_variables/sync_variables_from_main_tower ...\r\n> [0618 07:56:30 @saver.py:84] Model saved to train_log/AlexNet/model-10009.\r\n> [0618 07:56:30 @misc.py:98] Estimated Time Left: 22 hours 41 minutes 38 seconds\r\n> 100%|#########################################################################################################################################################################|782/782[00:15<00:00,49.52it/s]\r\n> [0618 07:56:46 @monitor.py:440] DataParallelInferenceRunner/QueueInput/queue_size: 50\r\n> [0618 07:56:46 @monitor.py:440] GPUUtil/0: 93.674\r\n> [0618 07:56:46 @monitor.py:440] GPUUtil/1: 94.415\r\n> [0618 07:56:46 @monitor.py:440] QueueInput/queue_size: 50\r\n> [0618 07:56:46 @monitor.py:440] l2_regularize_loss: nan\r\n> [0618 07:56:46 @monitor.py:440] learning_rate: 0.1\r\n> [0618 07:56:46 @monitor.py:440] train-error-top1: 1\r\n> [0618 07:56:46 @monitor.py:440] train-error-top5: 1\r\n> [0618 07:56:46 @monitor.py:440] val-error-top1: 1\r\n> [0618 07:56:46 @monitor.py:440] val-error-top5: 1\r\n> [0618 07:56:46 @monitor.py:440] xentropy-loss: nan\r\n> [0618 07:56:46 @group.py:44] Callbacks took 16.977 sec in total. DataParallelInferenceRunner: 16 seconds\r\n\r\n3. What you expected, if not obvious.\r\nAs can be seen above, I got \"[nan](https://en.wikipedia.org/wiki/NaN)\" for l2_regularize_loss and xentropy-loss. I expect valid values for them. Note that I didn't modify any code in the script (i.e., alexnet.py) or other Tensorpack source code.\r\n\r\n4. Your environment:\r\n\t+ Python version.: Python 3.6.5\r\n\t+ TF version: v1.7.0-3-g024aecf414 1.7.0\r\n\t+ Tensorpack version: 0.8.6\r\n\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/796/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/796/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/737", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/737/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/737/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/737/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/737", "id": 317769712, "node_id": "MDU6SXNzdWUzMTc3Njk3MTI=", "number": 737, "title": "error message from running cifar10-resnet.py", "user": {"login": "deeplearningmachine", "id": 13987120, "node_id": "MDQ6VXNlcjEzOTg3MTIw", "avatar_url": "https://avatars.githubusercontent.com/u/13987120?v=4", "gravatar_id": "", "url": "https://api.github.com/users/deeplearningmachine", "html_url": "https://github.com/deeplearningmachine", "followers_url": "https://api.github.com/users/deeplearningmachine/followers", "following_url": "https://api.github.com/users/deeplearningmachine/following{/other_user}", "gists_url": "https://api.github.com/users/deeplearningmachine/gists{/gist_id}", "starred_url": "https://api.github.com/users/deeplearningmachine/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/deeplearningmachine/subscriptions", "organizations_url": "https://api.github.com/users/deeplearningmachine/orgs", "repos_url": "https://api.github.com/users/deeplearningmachine/repos", "events_url": "https://api.github.com/users/deeplearningmachine/events{/privacy}", "received_events_url": "https://api.github.com/users/deeplearningmachine/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-04-25T19:50:44Z", "updated_at": "2018-05-30T20:59:42Z", "closed_at": "2018-04-28T14:40:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "I tried to run cifar10-resnet.py, but got the following message:\r\n\r\n  File \"cifar10-resnet.py\", line 174, in <module>\r\n    launch_train_with_config(config, SyncMultiGPUTrainerParameterServer(nr_gpu))\r\n...\r\ntf.v1.4.0/local/lib/python2.7/site-packages/tensorflow/python/layers/base.py\", line 98, in __init__\r\n    raise TypeError('Keyword argument not understood:', kwarg)\r\nTypeError: ('Keyword argument not understood:', 'virtual_batch_size')\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/737/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/737/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/730", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/730/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/730/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/730/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/730", "id": 314526854, "node_id": "MDU6SXNzdWUzMTQ1MjY4NTQ=", "number": 730, "title": "Is the operation error of this function \"DataParallelOfflinePredictor\" caused by the revision?", "user": {"login": "TKZC0615", "id": 12762328, "node_id": "MDQ6VXNlcjEyNzYyMzI4", "avatar_url": "https://avatars.githubusercontent.com/u/12762328?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TKZC0615", "html_url": "https://github.com/TKZC0615", "followers_url": "https://api.github.com/users/TKZC0615/followers", "following_url": "https://api.github.com/users/TKZC0615/following{/other_user}", "gists_url": "https://api.github.com/users/TKZC0615/gists{/gist_id}", "starred_url": "https://api.github.com/users/TKZC0615/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TKZC0615/subscriptions", "organizations_url": "https://api.github.com/users/TKZC0615/orgs", "repos_url": "https://api.github.com/users/TKZC0615/repos", "events_url": "https://api.github.com/users/TKZC0615/events{/privacy}", "received_events_url": "https://api.github.com/users/TKZC0615/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-04-16T07:13:25Z", "updated_at": "2018-05-30T20:59:41Z", "closed_at": "2018-04-16T18:17:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, I have a error when I run the **DataParallelOfflinePredictor** function. After debugging, I am puzzled by the following statements **if any(k in name for k in [':', '/', ' '])**.\r\n\r\nThe statement\r\n `inputs_desc = [InputDesc(desc.type, desc.shape, tower_name + '/' + desc.name)\r\nfor desc in config.inputs_desc]` \r\nin this function adds the \"/\", but the function  **__new__(cls, type, shape, name)** in the class of **InputDesc**  will report error when it detects \"/\" in the statement \r\n`if any(k in name for k in [':', '/', ' ']):\r\n            raise ValueError(\"Invalid InputDesc name: '{}'\".format(name)).` \r\n\r\nNo example of calling this function was found in the latest version, an I don't know if my idea is right or not.\r\n\r\n**ps: The output is as follows:**\r\n\r\n> Traceback (most recent call last):\r\n  File \"/home/robot/software/sourceCode_install/pycharm-community-2018.1/helpers/pydev/pydevd.py\", line 1664, in <module>\r\n    main()\r\n  File \"/home/robot/software/sourceCode_install/pycharm-community-2018.1/helpers/pydev/pydevd.py\", line 1658, in main\r\n    globals = debugger.run(setup['file'], None, None, is_module)\r\n  File \"/home/robot/software/sourceCode_install/pycharm-community-2018.1/helpers/pydev/pydevd.py\", line 1068, in run\r\n    pydev_imports.execfile(file, globals, locals)  # execute the script\r\n  File \"/home/robot/Desktop/project/Pycharm/Stereo-Pose-Machines/src/main.py\", line 178, in <module>\r\n    stereo_cpm_viewer()\r\n  File \"/home/robot/Desktop/project/Pycharm/Stereo-Pose-Machines/src/main.py\", line 39, in stereo_cpm_viewer\r\n    runner = get_parallel_runner('../data/cpm.npy')\r\n  File \"/home/robot/Desktop/project/Pycharm/Stereo-Pose-Machines/src/runner.py\", line 72, in get_parallel_runner\r\n    predictor = DataParallelOfflinePredictor(cfg, [0,1])\r\n  File \"/home/robot/anaconda3/envs/caffe-tf/lib/python2.7/site-packages/tensorpack/predict/multigpu.py\", line 99, in __init__\r\n    for desc in config.inputs_desc]\r\n  File \"/home/robot/anaconda3/envs/caffe-tf/lib/python2.7/site-packages/tensorpack/graph_builder/model_desc.py\", line 38, in __new__\r\n    raise ValueError(\"Invalid InputDesc name: '{}'\".format(name))\r\nValueError: Invalid InputDesc name: 'tower0/input'\r\n\r\nThank you.", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/730/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/730/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/721", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/721/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/721/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/721/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/721", "id": 310185951, "node_id": "MDU6SXNzdWUzMTAxODU5NTE=", "number": 721, "title": "Possible bug on layers.variables because of calling tf.identity in the end in conv2d and fc", "user": {"login": "EchoWho", "id": 5818120, "node_id": "MDQ6VXNlcjU4MTgxMjA=", "avatar_url": "https://avatars.githubusercontent.com/u/5818120?v=4", "gravatar_id": "", "url": "https://api.github.com/users/EchoWho", "html_url": "https://github.com/EchoWho", "followers_url": "https://api.github.com/users/EchoWho/followers", "following_url": "https://api.github.com/users/EchoWho/following{/other_user}", "gists_url": "https://api.github.com/users/EchoWho/gists{/gist_id}", "starred_url": "https://api.github.com/users/EchoWho/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/EchoWho/subscriptions", "organizations_url": "https://api.github.com/users/EchoWho/orgs", "repos_url": "https://api.github.com/users/EchoWho/repos", "events_url": "https://api.github.com/users/EchoWho/events{/privacy}", "received_events_url": "https://api.github.com/users/EchoWho/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-03-30T22:47:10Z", "updated_at": "2018-05-30T20:59:41Z", "closed_at": "2018-03-31T03:08:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "https://github.com/ppwwyyxx/tensorpack/blob/a8e474704fd8e3ad70a080eccc05f0851b454b08/tensorpack/models/conv2d.py#L174\r\n\r\nhttps://github.com/ppwwyyxx/tensorpack/blob/a8e474704fd8e3ad70a080eccc05f0851b454b08/tensorpack/models/fc.py#L56\r\n\r\nThese two layers are creating the VariableHolder before using the final tf.identity to rename the output. Hence the output Tensor do not have access to the variable holders. \r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/721/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/721/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/685", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/685/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/685/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/685/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/685", "id": 302060709, "node_id": "MDU6SXNzdWUzMDIwNjA3MDk=", "number": 685, "title": "[Bug]Inference runner with TFDataset input don't reset dataset's state", "user": {"login": "TomorrowIsAnOtherDay", "id": 25046619, "node_id": "MDQ6VXNlcjI1MDQ2NjE5", "avatar_url": "https://avatars.githubusercontent.com/u/25046619?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TomorrowIsAnOtherDay", "html_url": "https://github.com/TomorrowIsAnOtherDay", "followers_url": "https://api.github.com/users/TomorrowIsAnOtherDay/followers", "following_url": "https://api.github.com/users/TomorrowIsAnOtherDay/following{/other_user}", "gists_url": "https://api.github.com/users/TomorrowIsAnOtherDay/gists{/gist_id}", "starred_url": "https://api.github.com/users/TomorrowIsAnOtherDay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TomorrowIsAnOtherDay/subscriptions", "organizations_url": "https://api.github.com/users/TomorrowIsAnOtherDay/orgs", "repos_url": "https://api.github.com/users/TomorrowIsAnOtherDay/repos", "events_url": "https://api.github.com/users/TomorrowIsAnOtherDay/events{/privacy}", "received_events_url": "https://api.github.com/users/TomorrowIsAnOtherDay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-03-04T06:08:51Z", "updated_at": "2018-05-30T20:59:39Z", "closed_at": "2018-03-04T06:26:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "![jpg](http://7xl3p7.com1.z0.glb.clouddn.com/18-3-4/83192968.jpg)\r\n \r\nInference runner with TFDataset input don't reset TFDataset's state", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/685/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/685/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/673", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/673/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/673/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/673/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/673", "id": 300070215, "node_id": "MDU6SXNzdWUzMDAwNzAyMTU=", "number": 673, "title": "Infinite loop with MultiProcessMapDataZMQ", "user": {"login": "vfdev-5", "id": 2459423, "node_id": "MDQ6VXNlcjI0NTk0MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/2459423?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vfdev-5", "html_url": "https://github.com/vfdev-5", "followers_url": "https://api.github.com/users/vfdev-5/followers", "following_url": "https://api.github.com/users/vfdev-5/following{/other_user}", "gists_url": "https://api.github.com/users/vfdev-5/gists{/gist_id}", "starred_url": "https://api.github.com/users/vfdev-5/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vfdev-5/subscriptions", "organizations_url": "https://api.github.com/users/vfdev-5/orgs", "repos_url": "https://api.github.com/users/vfdev-5/repos", "events_url": "https://api.github.com/users/vfdev-5/events{/privacy}", "received_events_url": "https://api.github.com/users/vfdev-5/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2018-02-25T22:58:10Z", "updated_at": "2018-05-30T20:59:38Z", "closed_at": "2018-03-02T08:03:23Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "There is an infinite loop with the following code:\r\n```\r\nfrom tensorpack.dataflow import MultiProcessMapDataZMQ, FakeData\r\n\r\nds = FakeData(((50, 50, 3), (1,)))\r\n\r\nimport numpy as np\r\n\r\ndef proc(dp):\r\n    img = np.random.randint(0, 255, size=(1012, 1012, 3))\r\n    img[img < 120] = 0\r\n    return dp\r\n\r\nmp_ds = MultiProcessMapDataZMQ(ds, map_func=proc, nr_proc=10, strict=True)\r\n\r\nmp_ds.reset_state()\r\n\r\nfor i, (_, _) in enumerate(mp_ds.get_data()):\r\n    if i % 100 == 0:\r\n        print(i, end=\" . \", flush=True)\r\n```\r\n\r\nImportant part is `strict=True` and small size of `FakeData`. If change size to (512, 512, 3), then loop ends properly. Probably, there is something with buffer filling and dequeing...\r\nExecution stucks [here](https://github.com/ppwwyyxx/tensorpack/blob/master/tensorpack/dataflow/parallel_map.py#L81).\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/673/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/673/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/671", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/671/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/671/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/671/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/671", "id": 300004325, "node_id": "MDU6SXNzdWUzMDAwMDQzMjU=", "number": 671, "title": "problem encountered when I conduct distributed training", "user": {"login": "anthony123", "id": 4050099, "node_id": "MDQ6VXNlcjQwNTAwOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/4050099?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anthony123", "html_url": "https://github.com/anthony123", "followers_url": "https://api.github.com/users/anthony123/followers", "following_url": "https://api.github.com/users/anthony123/following{/other_user}", "gists_url": "https://api.github.com/users/anthony123/gists{/gist_id}", "starred_url": "https://api.github.com/users/anthony123/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anthony123/subscriptions", "organizations_url": "https://api.github.com/users/anthony123/orgs", "repos_url": "https://api.github.com/users/anthony123/repos", "events_url": "https://api.github.com/users/anthony123/events{/privacy}", "received_events_url": "https://api.github.com/users/anthony123/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-02-25T07:02:46Z", "updated_at": "2018-05-30T20:59:37Z", "closed_at": "2018-02-26T04:32:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "I encountered a problem when  i run my distributed training code, the  error traces are as follows:\r\n\r\n![distributederror](https://user-images.githubusercontent.com/4050099/36638940-cee8895c-1a3b-11e8-801d-dafa56cb3390.png)\r\n\r\nmy code is [here](https://github.com/anthony123/learnit/blob/master/cifar10-sparse-densenet-bc-exp.py)\r\n\r\nI launch my code as:\r\n`python cifar10-sparse-densenet-bc-exp.py --gpu=0,1,2,3 --job worker --task 0`\r\n\r\nwhen I use trainer \r\n```\r\ntrainer = SyncMultiGPUTrainerParameterServer(len(args.gpu.split(',')))\r\nlaunch_train_with_config(config, trainer)\r\n```\r\nthere will be no problem\r\n\r\nAny suggestion is appreciated.", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/671/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/671/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/614", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/614/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/614/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/614/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/614", "id": 292144320, "node_id": "MDU6SXNzdWUyOTIxNDQzMjA=", "number": 614, "title": "imgaug.Saturation", "user": {"login": "dpkingma", "id": 2432243, "node_id": "MDQ6VXNlcjI0MzIyNDM=", "avatar_url": "https://avatars.githubusercontent.com/u/2432243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dpkingma", "html_url": "https://github.com/dpkingma", "followers_url": "https://api.github.com/users/dpkingma/followers", "following_url": "https://api.github.com/users/dpkingma/following{/other_user}", "gists_url": "https://api.github.com/users/dpkingma/gists{/gist_id}", "starred_url": "https://api.github.com/users/dpkingma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dpkingma/subscriptions", "organizations_url": "https://api.github.com/users/dpkingma/orgs", "repos_url": "https://api.github.com/users/dpkingma/repos", "events_url": "https://api.github.com/users/dpkingma/events{/privacy}", "received_events_url": "https://api.github.com/users/dpkingma/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-01-27T19:04:22Z", "updated_at": "2018-05-30T20:59:33Z", "closed_at": "2018-01-27T19:29:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "1. What I did: Use `fbresnet_augmentor` in `tensorpack/examples/Inception/imagenet_utils.py`.\r\n\r\n2. What I observed: when using the `fbresnet_augmentor` in the code, some augmented images contain overly brightly colored artifacts:\r\n\r\n![with_imgaug_saturation](https://user-images.githubusercontent.com/2432243/35475299-b5a259e8-0350-11e8-89ec-821dd006a2d2.png)\r\n\r\nThis is unexpected to me, since the augmented data should resemble natural images.\r\n\r\nWhen I comment out the line `imgaug.Saturation(0.4, rgb=False),` in `fbresnet_augmentor`, then there are no such artifacts:\r\n![without_imgaug_saturation](https://user-images.githubusercontent.com/2432243/35475300-b5b49e78-0350-11e8-93ab-894e8ee5c38c.png)\r\n\r\nThere might be a problem with the `imgaug.Saturation()` function.", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/614/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/614/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/577", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/577/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/577/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/577/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/577", "id": 286229888, "node_id": "MDU6SXNzdWUyODYyMjk4ODg=", "number": 577, "title": "Training Mask RCNN encounter KeyError: 'file_name'", "user": {"login": "trantorrepository", "id": 25002469, "node_id": "MDQ6VXNlcjI1MDAyNDY5", "avatar_url": "https://avatars.githubusercontent.com/u/25002469?v=4", "gravatar_id": "", "url": "https://api.github.com/users/trantorrepository", "html_url": "https://github.com/trantorrepository", "followers_url": "https://api.github.com/users/trantorrepository/followers", "following_url": "https://api.github.com/users/trantorrepository/following{/other_user}", "gists_url": "https://api.github.com/users/trantorrepository/gists{/gist_id}", "starred_url": "https://api.github.com/users/trantorrepository/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/trantorrepository/subscriptions", "organizations_url": "https://api.github.com/users/trantorrepository/orgs", "repos_url": "https://api.github.com/users/trantorrepository/repos", "events_url": "https://api.github.com/users/trantorrepository/events{/privacy}", "received_events_url": "https://api.github.com/users/trantorrepository/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 676134026, "node_id": "MDU6TGFiZWw2NzYxMzQwMjY=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/examples", "name": "examples", "color": "e99695", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-01-05T09:05:03Z", "updated_at": "2018-05-30T20:59:31Z", "closed_at": "2018-01-05T09:54:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "Training Mask RCNN encounter error below:\r\nFile \"./tensorpack/examples/FasterRCNN/data.py\", line 208, in preprocess\r\n    fname, boxes, klass, is_crowd = img['file_name'], img['boxes'], img['class'], img['is_crowd']\r\nKeyError: 'file_name'\r\n\r\nand then the training process get stuck at \"Pre-filling staging area...\u201c\r\n\r\nMy environment: python 3.4, tf 1.4, cuda 8.0.\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/577/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/577/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/565", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/565/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/565/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/565/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/565", "id": 283905318, "node_id": "MDU6SXNzdWUyODM5MDUzMTg=", "number": 565, "title": "Using tf.data.Dataset as InferenceRunner inputsource ", "user": {"login": "TomorrowIsAnOtherDay", "id": 25046619, "node_id": "MDQ6VXNlcjI1MDQ2NjE5", "avatar_url": "https://avatars.githubusercontent.com/u/25046619?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TomorrowIsAnOtherDay", "html_url": "https://github.com/TomorrowIsAnOtherDay", "followers_url": "https://api.github.com/users/TomorrowIsAnOtherDay/followers", "following_url": "https://api.github.com/users/TomorrowIsAnOtherDay/following{/other_user}", "gists_url": "https://api.github.com/users/TomorrowIsAnOtherDay/gists{/gist_id}", "starred_url": "https://api.github.com/users/TomorrowIsAnOtherDay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TomorrowIsAnOtherDay/subscriptions", "organizations_url": "https://api.github.com/users/TomorrowIsAnOtherDay/orgs", "repos_url": "https://api.github.com/users/TomorrowIsAnOtherDay/repos", "events_url": "https://api.github.com/users/TomorrowIsAnOtherDay/events{/privacy}", "received_events_url": "https://api.github.com/users/TomorrowIsAnOtherDay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-12-21T14:51:18Z", "updated_at": "2018-05-30T20:59:30Z", "closed_at": "2017-12-22T02:50:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "https://github.com/ppwwyyxx/tensorpack/blob/7a5b861ab5ff9d018f4700e95bf0985d55c1841c/tensorpack/callbacks/inference_runner.py#L80\r\nShould this line be self._size = np.inf ? \r\nWhen self._size is set as 0, there will be no output in self.stats in ScarStates,\r\nand if it is set as inf, tf.errors.OutOfRange will be raised before the end of dataflow.\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/565/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/565/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/546", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/546/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/546/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/546/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/546", "id": 281239562, "node_id": "MDU6SXNzdWUyODEyMzk1NjI=", "number": 546, "title": "Pre-filling staging area", "user": {"login": "jiang1st", "id": 5435138, "node_id": "MDQ6VXNlcjU0MzUxMzg=", "avatar_url": "https://avatars.githubusercontent.com/u/5435138?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jiang1st", "html_url": "https://github.com/jiang1st", "followers_url": "https://api.github.com/users/jiang1st/followers", "following_url": "https://api.github.com/users/jiang1st/following{/other_user}", "gists_url": "https://api.github.com/users/jiang1st/gists{/gist_id}", "starred_url": "https://api.github.com/users/jiang1st/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jiang1st/subscriptions", "organizations_url": "https://api.github.com/users/jiang1st/orgs", "repos_url": "https://api.github.com/users/jiang1st/repos", "events_url": "https://api.github.com/users/jiang1st/events{/privacy}", "received_events_url": "https://api.github.com/users/jiang1st/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-12-12T02:52:24Z", "updated_at": "2019-04-18T05:31:57Z", "closed_at": "2017-12-12T03:26:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "When I was training Mask RCNN with more than one gpus, the training process got stuck at \"Pre-filling staging area...\". When trained with one gpu, there is no such problem.  What could be the reason? Thank you.", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/546/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/546/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/530", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/530/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/530/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/530/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/530", "id": 278181044, "node_id": "MDU6SXNzdWUyNzgxODEwNDQ=", "number": 530, "title": "FasterRCNN: visualize error", "user": {"login": "sunfanyunn", "id": 16130918, "node_id": "MDQ6VXNlcjE2MTMwOTE4", "avatar_url": "https://avatars.githubusercontent.com/u/16130918?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sunfanyunn", "html_url": "https://github.com/sunfanyunn", "followers_url": "https://api.github.com/users/sunfanyunn/followers", "following_url": "https://api.github.com/users/sunfanyunn/following{/other_user}", "gists_url": "https://api.github.com/users/sunfanyunn/gists{/gist_id}", "starred_url": "https://api.github.com/users/sunfanyunn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sunfanyunn/subscriptions", "organizations_url": "https://api.github.com/users/sunfanyunn/orgs", "repos_url": "https://api.github.com/users/sunfanyunn/repos", "events_url": "https://api.github.com/users/sunfanyunn/events{/privacy}", "received_events_url": "https://api.github.com/users/sunfanyunn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-11-30T16:19:49Z", "updated_at": "2018-05-30T20:59:28Z", "closed_at": "2017-11-30T16:28:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "when I run train.py with the flag --visualize, the following error occurs.\r\n`KeyError: \"The name 'generate_rpn_proposals/probs:0' refers to a Tensor which does not exist. The operation, 'generate_rpn_proposals/probs', do es not exist in the graph.\"`", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/530/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/530/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/528", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/528/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/528/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/528/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/528", "id": 278146724, "node_id": "MDU6SXNzdWUyNzgxNDY3MjQ=", "number": 528, "title": "FasterRCNN: DetectionResult not defined in train.py", "user": {"login": "sunfanyunn", "id": 16130918, "node_id": "MDQ6VXNlcjE2MTMwOTE4", "avatar_url": "https://avatars.githubusercontent.com/u/16130918?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sunfanyunn", "html_url": "https://github.com/sunfanyunn", "followers_url": "https://api.github.com/users/sunfanyunn/followers", "following_url": "https://api.github.com/users/sunfanyunn/following{/other_user}", "gists_url": "https://api.github.com/users/sunfanyunn/gists{/gist_id}", "starred_url": "https://api.github.com/users/sunfanyunn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sunfanyunn/subscriptions", "organizations_url": "https://api.github.com/users/sunfanyunn/orgs", "repos_url": "https://api.github.com/users/sunfanyunn/repos", "events_url": "https://api.github.com/users/sunfanyunn/events{/privacy}", "received_events_url": "https://api.github.com/users/sunfanyunn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-11-30T14:50:30Z", "updated_at": "2018-05-30T20:59:28Z", "closed_at": "2017-11-30T15:01:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm running ./train.py with the flag --visualize.\r\nThere are two errors:\r\n1. DetectionResult undefined in train.py (probably should import it from eval?\r\n2. `KeyError: \"The name 'generate_rpn_proposals/probs:0' refers to a Tensor which does not exist. The operation, 'generate_rpn_proposals/probs', do\r\nes not exist in the graph.\"`", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/528/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/528/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/505", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/505/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/505/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/505/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/505", "id": 275988774, "node_id": "MDU6SXNzdWUyNzU5ODg3NzQ=", "number": 505, "title": "Distributed training failed", "user": {"login": "llidev", "id": 29957883, "node_id": "MDQ6VXNlcjI5OTU3ODgz", "avatar_url": "https://avatars.githubusercontent.com/u/29957883?v=4", "gravatar_id": "", "url": "https://api.github.com/users/llidev", "html_url": "https://github.com/llidev", "followers_url": "https://api.github.com/users/llidev/followers", "following_url": "https://api.github.com/users/llidev/following{/other_user}", "gists_url": "https://api.github.com/users/llidev/gists{/gist_id}", "starred_url": "https://api.github.com/users/llidev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/llidev/subscriptions", "organizations_url": "https://api.github.com/users/llidev/orgs", "repos_url": "https://api.github.com/users/llidev/repos", "events_url": "https://api.github.com/users/llidev/events{/privacy}", "received_events_url": "https://api.github.com/users/llidev/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-11-22T08:56:58Z", "updated_at": "2018-05-30T20:59:26Z", "closed_at": "2017-12-01T18:51:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, \r\nI am trying to start a POC on distributed training, but get stuck at beginning:\r\n\r\ntrainer = DistributedTrainerReplicated(os.getenv('CUDA_VISIBLE_DEVICES'), server)\r\nlaunch_train_with_config(config, trainer)\r\n\r\nresulted in\r\n\r\nAttributeError: 'TrainConfig' object has no attribute 'session_config'\r\n\r\nAlso tried to start training without using launch_train_with_config(...), but got \r\n\r\nAttributeError: 'DistributedTrainerReplicated' object has no attribute '_callbacks'\r\n\r\nPlease help... I am using with tensorflow 1.4.0 docker image.", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/505/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/505/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/465", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/465/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/465/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/465/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/465", "id": 270552316, "node_id": "MDU6SXNzdWUyNzA1NTIzMTY=", "number": 465, "title": "FasterRCNN example single GPU IndexError", "user": {"login": "minogame", "id": 2902665, "node_id": "MDQ6VXNlcjI5MDI2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/2902665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/minogame", "html_url": "https://github.com/minogame", "followers_url": "https://api.github.com/users/minogame/followers", "following_url": "https://api.github.com/users/minogame/following{/other_user}", "gists_url": "https://api.github.com/users/minogame/gists{/gist_id}", "starred_url": "https://api.github.com/users/minogame/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/minogame/subscriptions", "organizations_url": "https://api.github.com/users/minogame/orgs", "repos_url": "https://api.github.com/users/minogame/repos", "events_url": "https://api.github.com/users/minogame/events{/privacy}", "received_events_url": "https://api.github.com/users/minogame/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 676134026, "node_id": "MDU6TGFiZWw2NzYxMzQwMjY=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/examples", "name": "examples", "color": "e99695", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-11-02T06:59:55Z", "updated_at": "2018-11-27T04:31:35Z", "closed_at": "2017-11-02T10:03:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "Bug Reports/Feature Requests/Usage Questions Only:\r\n\r\n> Traceback (most recent call last):\r\n>   File \"train.py\", line 305, in <module>\r\n>     launch_train_with_config(cfg, trainer)\r\n>   File \"/home/$$$$$$$/anaconda3/lib/python3.6/site-packages/tensorpack/train/interface.py\", line 88, in launch_train_with_config\r\n>     model._build_graph_get_cost, model.get_optimizer)\r\n>   File \"/home/$$$$$$$/anaconda3/lib/python3.6/site-packages/tensorpack/utils/argtools.py\", line 165, in wrapper\r\n>     return func(*args, **kwargs)\r\n>   File \"/home/$$$$$$$/anaconda3/lib/python3.6/site-packages/tensorpack/train/tower.py\", line 128, in setup_graph\r\n>     train_callbacks = self._setup_graph(input, get_cost_fn, get_opt_fn)\r\n>   File \"/home/$$$$$$$/anaconda3/lib/python3.6/site-packages/tensorpack/train/trainers.py\", line 127, in _setup_graph\r\n>     self._make_get_grad_fn(input, get_cost_fn, get_opt_fn), get_opt_fn)\r\n>   File \"/home/$$$$$$$/anaconda3/lib/python3.6/site-packages/tensorpack/graph_builder/training.py\", line 196, in build\r\n>     with tf.device(raw_devices[idx]):\r\n> IndexError: list index out of range\r\n\r\nWould run normally when using multiple GPUs, I've fixed this in my local PC, but don't have time to do a PR.\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/465/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/465/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/462", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/462/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/462/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/462/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/462", "id": 270232549, "node_id": "MDU6SXNzdWUyNzAyMzI1NDk=", "number": 462, "title": "Regarding mnist-visualizations.py", "user": {"login": "hukim93", "id": 18064935, "node_id": "MDQ6VXNlcjE4MDY0OTM1", "avatar_url": "https://avatars.githubusercontent.com/u/18064935?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hukim93", "html_url": "https://github.com/hukim93", "followers_url": "https://api.github.com/users/hukim93/followers", "following_url": "https://api.github.com/users/hukim93/following{/other_user}", "gists_url": "https://api.github.com/users/hukim93/gists{/gist_id}", "starred_url": "https://api.github.com/users/hukim93/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hukim93/subscriptions", "organizations_url": "https://api.github.com/users/hukim93/orgs", "repos_url": "https://api.github.com/users/hukim93/repos", "events_url": "https://api.github.com/users/hukim93/events{/privacy}", "received_events_url": "https://api.github.com/users/hukim93/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-11-01T08:28:21Z", "updated_at": "2018-05-30T20:59:22Z", "closed_at": "2017-11-01T11:19:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "I just installed tensorpack, and run several example codes.\r\n\r\nmnist-convnet.py and mnist-keras.py is executed successfully.\r\n\r\nBut when I run mnist-visualizations.py, error shown below occurs.\r\n\r\nInvalidArgumentError (see above for traceback): You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n         [[Node: fc0/W/rms/_243 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_87_fc0/W/rms\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\r\n\r\n\r\n\r\nHere are my logs when running mnist-visualizations.py\r\n\r\nCould you please solve this issue?\r\n\r\n[1101 15:31:03 @base.py:172] Initializing the session ...\r\n[1101 15:31:03 @base.py:179] Graph Finalized.\r\n[1101 15:31:03 @base.py:196] Start Epoch 1 ...\r\n 93%|#########################################################################################################################################################################################9               |433/468[00:03<00:00,52.72it/s]2017-11-01 15:31:08.052607: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.052787: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.053128: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.053237: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.053401: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.053512: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.053594: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.053671: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.053759: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.053833: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.054991: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.055057: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.055120: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.055178: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.055234: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.055298: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.056440: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.056495: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.056532: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.056564: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.056597: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.056628: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.056661: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.056691: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.056954: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.058530: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.058588: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.058821: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.059624: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.059882: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.059988: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.060283: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n2017-11-01 15:31:08.060331: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n100%|#######################################################################################################################################################################################################5|467/468[00:04<00:00,114.30it/s]\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1327, in _do_call\r\n    return fn(*args)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1306, in _run_fn\r\n    status, run_metadata)\r\n  File \"/usr/local/lib/python3.6/contextlib.py\", line 88, in __exit__\r\n    next(self.gen)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py\", line 466, in raise_exception_on_not_ok_status\r\n    pywrap_tensorflow.TF_GetCode(status))\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n         [[Node: fc0/W/rms/_243 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_87_fc0/W/rms\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"mnist-visualizations.py\", line 164, in <module>\r\n    launch_train_with_config(config, SimpleTrainer())\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorpack/trainv1/interface.py\", line 11, in launch_train_with_config\r\n    old_launch(config, trainer)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorpack/train/interface.py\", line 92, in launch_train_with_config\r\n    config.steps_per_epoch, config.starting_epoch, config.max_epoch)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorpack/train/base.py\", line 238, in train\r\n    self.main_loop(steps_per_epoch, starting_epoch, max_epoch)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorpack/utils/argtools.py\", line 165, in wrapper\r\n    return func(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorpack/train/base.py\", line 202, in main_loop\r\n File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 518, in run\r\n    run_metadata=run_metadata)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 862, in run\r\n    run_metadata=run_metadata)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 818, in run\r\n    return self._sess.run(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 972, in run\r\n    run_metadata=run_metadata)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 818, in run\r\n    return self._sess.run(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 895, in run\r\n    run_metadata_ptr)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1124, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1321, in _do_run\r\n    options, run_metadata)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1340, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n         [[Node: fc0/W/rms/_243 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_87_fc0/W/rms\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\r\n\r\nCaused by op 'input_1', defined at:\r\n  File \"mnist-visualizations.py\", line 164, in <module>\r\n    launch_train_with_config(config, SimpleTrainer())\r\n File \"/usr/local/lib/python3.6/site-packages/tensorpack/trainv1/interface.py\", line 11, in launch_train_with_config\r\n    old_launch(config, trainer)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorpack/train/interface.py\", line 92, in launch_train_with_config\r\n    config.steps_per_epoch, config.starting_epoch, config.max_epoch)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorpack/train/base.py\", line 236, in train\r\n    self.setup_callbacks(callbacks, monitors)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorpack/utils/argtools.py\", line 165, in wrapper\r\n    return func(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorpack/train/base.py\", line 154, in setup_callbacks\r\n    self._callbacks.setup_graph(weakref.proxy(self))\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorpack/callbacks/base.py\", line 53, in setup_graph\r\n    self._setup_graph()\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorpack/callbacks/group.py\", line 64, in _setup_graph\r\n    cb.setup_graph(self.trainer)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorpack/callbacks/base.py\", line 53, in setup_graph\r\n    self._setup_graph()\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorpack/callbacks/inference_runner.py\", line 132, in _setup_graph\r\n    input_callbacks = self._input_source.setup(self.trainer.inputs_desc)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorpack/utils/argtools.py\", line 165, in wrapper\r\n    return func(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorpack/input_source/input_source_base.py\", line 97, in setup\r\n    self._setup(inputs_desc)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorpack/input_source/input_source.py\", line 90, in _setup\r\n    self._all_placehdrs = [v.build_placeholder(prefix='') for v in inputs]\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorpack/input_source/input_source.py\", line 90, in <listcomp>\r\n    self._all_placehdrs = [v.build_placeholder(prefix='') for v in inputs]\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorpack/graph_builder/model_desc.py\", line 53, in build_placeholder\r\n    name=prefix + self.name)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py\", line 1548, in placeholder\r\n    return gen_array_ops._placeholder(dtype=dtype, shape=shape, name=name)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 2094, in _placeholder\r\n    name=name)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 767, in apply_op\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 2630, in create_op\r\n    original_op=self._default_original_op, op_def=op_def)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1204, in __init__\r\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\r\n\r\nInvalidArgumentError (see above for traceback): You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,28,28]\r\n         [[Node: input_1 = Placeholder[dtype=DT_FLOAT, shape=[?,28,28], _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n         [[Node: fc0/W/rms/_243 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_87_fc0/W/rms\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\r\n\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/462/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/462/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/461", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/461/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/461/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/461/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/461", "id": 270171632, "node_id": "MDU6SXNzdWUyNzAxNzE2MzI=", "number": 461, "title": "A minor issue with A3C", "user": {"login": "henrykmichalewski", "id": 3290366, "node_id": "MDQ6VXNlcjMyOTAzNjY=", "avatar_url": "https://avatars.githubusercontent.com/u/3290366?v=4", "gravatar_id": "", "url": "https://api.github.com/users/henrykmichalewski", "html_url": "https://github.com/henrykmichalewski", "followers_url": "https://api.github.com/users/henrykmichalewski/followers", "following_url": "https://api.github.com/users/henrykmichalewski/following{/other_user}", "gists_url": "https://api.github.com/users/henrykmichalewski/gists{/gist_id}", "starred_url": "https://api.github.com/users/henrykmichalewski/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/henrykmichalewski/subscriptions", "organizations_url": "https://api.github.com/users/henrykmichalewski/orgs", "repos_url": "https://api.github.com/users/henrykmichalewski/repos", "events_url": "https://api.github.com/users/henrykmichalewski/events{/privacy}", "received_events_url": "https://api.github.com/users/henrykmichalewski/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 676134026, "node_id": "MDU6TGFiZWw2NzYxMzQwMjY=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/examples", "name": "examples", "color": "e99695", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-11-01T02:06:42Z", "updated_at": "2018-11-27T04:31:27Z", "closed_at": "2017-11-01T04:25:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "1. What you did. `python ./train-atari.py --env Seaquest-v0`\r\n2. What you observed. \r\n```\r\nTraceback (most recent call last):\r\n  File \"./train-atari.py\", line 33, in <module>\r\n    from common import (Evaluator, eval_model_multithread,\r\n  File \"/home/henryk.michalewski/stefan/tensorpack/examples/A3C-Gym/common.py\", line 12, in <module>\r\n    from tensorpack.callbacks import Triggerable\r\nImportError: cannot import name 'Triggerable'\r\n```", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/461/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/461/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/449", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/449/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/449/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/449/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/449", "id": 267488639, "node_id": "MDU6SXNzdWUyNjc0ODg2Mzk=", "number": 449, "title": "prediction gives \"Graph is finalized and cannot be modified.\" after recent change", "user": {"login": "eyaler", "id": 4436747, "node_id": "MDQ6VXNlcjQ0MzY3NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4436747?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eyaler", "html_url": "https://github.com/eyaler", "followers_url": "https://api.github.com/users/eyaler/followers", "following_url": "https://api.github.com/users/eyaler/following{/other_user}", "gists_url": "https://api.github.com/users/eyaler/gists{/gist_id}", "starred_url": "https://api.github.com/users/eyaler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eyaler/subscriptions", "organizations_url": "https://api.github.com/users/eyaler/orgs", "repos_url": "https://api.github.com/users/eyaler/repos", "events_url": "https://api.github.com/users/eyaler/events{/privacy}", "received_events_url": "https://api.github.com/users/eyaler/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-10-22T18:47:19Z", "updated_at": "2018-05-30T20:59:21Z", "closed_at": "2017-10-22T22:06:37Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "good: 93a177bf916f717e8b0c122898c9d84e0a5e93a6\r\nbad: c99d013a9d1142e19fe1a7d622cd4d8b9750913c\r\n\r\n....\r\n    pred = SimpleDatasetPredictor(pred, ds)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorpack\\predict\\dataset.py\", line 66, in __init__\r\n    self.predictor = OfflinePredictor(config)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorpack\\predict\\base.py\", line 167, in __init__\r\n    config.session_init.init(sess)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorpack\\tfutils\\sessinit.py\", line 29, in init\r\n    self._setup_graph()\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorpack\\tfutils\\sessinit.py\", line 113, in _setup_graph\r\n    self.saver = tf.train.Saver(var_list=dic, name=str(id(dic)))\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\saver.py\", line 1140, in __init__\r\n    self.build()\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\saver.py\", line 1172, in build\r\n    filename=self._filename)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\saver.py\", line 677, in build\r\n    filename_tensor = constant_op.constant(filename or \"model\")\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\constant_op.py\", line 106, in constant\r\n    attrs={\"value\": tensor_value, \"dtype\": dtype_value}, name=name).outputs[0]\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2582, in create_op\r\n    self._check_not_finalized()\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2290, in _check_not_finalized\r\n    raise RuntimeError(\"Graph is finalized and cannot be modified.\")\r\nRuntimeError: Graph is finalized and cannot be modified.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/449/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/449/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/431", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/431/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/431/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/431/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/431", "id": 260711355, "node_id": "MDU6SXNzdWUyNjA3MTEzNTU=", "number": 431, "title": "Distributed Leaning on ResNet (follow up)", "user": {"login": "chunfuchen", "id": 7079318, "node_id": "MDQ6VXNlcjcwNzkzMTg=", "avatar_url": "https://avatars.githubusercontent.com/u/7079318?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chunfuchen", "html_url": "https://github.com/chunfuchen", "followers_url": "https://api.github.com/users/chunfuchen/followers", "following_url": "https://api.github.com/users/chunfuchen/following{/other_user}", "gists_url": "https://api.github.com/users/chunfuchen/gists{/gist_id}", "starred_url": "https://api.github.com/users/chunfuchen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chunfuchen/subscriptions", "organizations_url": "https://api.github.com/users/chunfuchen/orgs", "repos_url": "https://api.github.com/users/chunfuchen/repos", "events_url": "https://api.github.com/users/chunfuchen/events{/privacy}", "received_events_url": "https://api.github.com/users/chunfuchen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 15, "created_at": "2017-09-26T17:46:06Z", "updated_at": "2018-05-30T20:59:20Z", "closed_at": "2017-10-04T00:26:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "Thanks for your rapid response on #430 .\r\n\r\nAfter I pull changes, I got another error about learning rate setup after graph is built.\r\n\r\nThanks.\r\n\r\nHere is the error log:\r\n\r\n```\r\n[0926 13:42:19 @base.py:167] Setup callbacks graph ...\r\nTraceback (most recent call last):\r\n  File \"examples/ResNet/imagenet-resnet-dist.py\", line 169, in <module>\r\n    DistributedTrainerReplicated(config, server).train()\r\n  File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/train/base.py\", line 135, in train\r\n    self.setup()\r\n  File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/train/base.py\", line 169, in setup\r\n    self._callbacks.setup_graph(weakref.proxy(self))\r\n  File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/callbacks/base.py\", line 54, in setup_graph\r\n    self._setup_graph()\r\n  File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/callbacks/group.py\", line 64, in _setup_graph\r\n    cb.setup_graph(self.trainer)\r\n  File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/callbacks/base.py\", line 54, in setup_graph\r\n    self._setup_graph()\r\n  File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/callbacks/param.py\", line 129, in _setup_graph\r\n    self.param.setup_graph()\r\n  File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/callbacks/param.py\", line 75, in setup_graph\r\n    raise ValueError(\"{} is not a GLOBAL_VARIABLE in the graph!\".format(self.var_name))\r\nValueError: learning_rate:0 is not a GLOBAL_VARIABLE in the graph!\r\nERROR:tensorflow:==================================\r\nObject was never used (type <class 'tensorflow.python.framework.ops.Tensor'>):\r\n<tf.Tensor 'report_uninitialized_variables/boolean_mask/Gather:0' shape=(?,) dtype=string>\r\nIf you want to mark it as used call its \"mark_used()\" method.\r\nIt was originally created here:\r\n['File \"examples/ResNet/imagenet-resnet-dist.py\", line 169, in <module>\\n    DistributedTrainerReplicated(config, server).train()', 'File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/train/distributed.py\", line 91, in __init__\\n    super(DistributedTrainerReplicated, self).__init__(config)', 'File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/train/base.py\", line 93, in __init__\\n    self._setup()   # subclass will setup the graph and InputSource', 'File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/train/distributed.py\", line 242, in _setup\\n    self._set_session_creator()', 'File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/train/distributed.py\", line 254, in _set_session_creator\\n    ready_op = tf.report_uninitialized_variables()', 'File \"/home/chenrich/.tensorflowEnvPy3Alt/lib/python3.6/site-packages/tensorflow/python/util/tf_should_use.py\", line 175, in wrapped\\n    return _add_should_use_warning(fn(*args, **kwargs))', 'File \"/home/chenrich/.tensorflowEnvPy3Alt/lib/python3.6/site-packages/tensorflow/python/util/tf_should_use.py\", line 144, in _add_should_use_warning\\n    wrapped = TFShouldUseWarningWrapper(x)', 'File \"/home/chenrich/.tensorflowEnvPy3Alt/lib/python3.6/site-packages/tensorflow/python/util/tf_should_use.py\", line 101, in __init__\\n    stack = [s.strip() for s in traceback.format_stack()]']\r\n==================================\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/431/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/431/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/430", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/430/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/430/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/430/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/430", "id": 260682829, "node_id": "MDU6SXNzdWUyNjA2ODI4Mjk=", "number": 430, "title": "Distributed Learning on ResNet", "user": {"login": "chunfuchen", "id": 7079318, "node_id": "MDQ6VXNlcjcwNzkzMTg=", "avatar_url": "https://avatars.githubusercontent.com/u/7079318?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chunfuchen", "html_url": "https://github.com/chunfuchen", "followers_url": "https://api.github.com/users/chunfuchen/followers", "following_url": "https://api.github.com/users/chunfuchen/following{/other_user}", "gists_url": "https://api.github.com/users/chunfuchen/gists{/gist_id}", "starred_url": "https://api.github.com/users/chunfuchen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chunfuchen/subscriptions", "organizations_url": "https://api.github.com/users/chunfuchen/orgs", "repos_url": "https://api.github.com/users/chunfuchen/repos", "events_url": "https://api.github.com/users/chunfuchen/events{/privacy}", "received_events_url": "https://api.github.com/users/chunfuchen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-09-26T16:10:09Z", "updated_at": "2018-05-30T20:59:20Z", "closed_at": "2017-09-26T16:26:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "I follow the instruction to setup distributed learning environment and modify the code in imagenet-resnet.py for distribution learning.\r\n\r\nhttp://tensorpack.readthedocs.io/en/latest/modules/train.html#tensorpack.train.DistributedTrainerReplicated\r\n\r\nI encounter the issue when the worker is trying to build the graph model. May I direct use imagenet_resnet_utils.py without modification? Or the changes are needed? (Details are provided below)\r\n\r\nAny suggestion is appreciated.\r\n\r\nHere is error trace:\r\n\r\n```\r\n[0926 11:56:44 @distributed.py:73] My role in the cluster: job=worker, task=0\r\n[0926 11:56:44 @input_source.py:235] Setting up the queue 'QueueInput/input_queue' for CPU prefetching ...\r\n[0926 11:56:44 @multigpu.py:87] Building graph for training tower 0...\r\n[0926 11:56:44 @registry.py:121] tower0/conv0 input: [None, 3, 224, 224]\r\nTraceback (most recent call last):\r\n  File \"examples/ResNet/imagenet-resnet-dist.py\", line 169, in <module>\r\n    DistributedTrainerReplicated(config, server).train()\r\n  File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/train/distributed.py\", line 92, in __init__\r\n    super(DistributedTrainerReplicated, self).__init__(config)\r\n  File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/train/base.py\", line 93, in __init__\r\n    self._setup()   # subclass will setup the graph and InputSource\r\n  File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/train/distributed.py\", line 215, in _setup\r\n    use_vs=[True] * self.config.nr_tower)  # open vs at each tower\r\n  File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/train/multigpu.py\", line 94, in build_on_multi_tower\r\n    ret.append(func())\r\n  File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/train/distributed.py\", line 213, in <lambda>\r\n    self.model, self._input_source),\r\n  File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/train/multigpu.py\", line 113, in _build_graph_get_grads\r\n    model.build_graph(input)\r\n  File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/graph_builder/model_desc.py\", line 122, in build_graph\r\n    self._build_graph(inputs)\r\n  File \"examples/ResNet/imagenet-resnet-dist.py\", line 67, in _build_graph\r\n    preresnet_group if self.preact else resnet_group, self.block_func)\r\n  File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/examples/ResNet/imagenet_resnet_utils.py\", line 204, in resnet_backbone\r\n    .Conv2D('conv0', 64, 7, stride=2, nl=BNReLU)\r\n  File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/models/linearwrap.py\", line 48, in f\r\n    ret = layer(name, self._t, *args, **kwargs)\r\n  File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/models/registry.py\", line 124, in wrapped_func\r\n    outputs = func(*args, **actual_args)\r\n  File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/models/conv2d.py\", line 61, in Conv2D\r\n    W = tf.get_variable('W', filter_shape, initializer=W_init)\r\n  File \"/home/chenrich/.tensorflowEnvPy3Alt/lib/python3.6/site-packages/tensorflow/python/ops/variable_scope.py\", line 1065, in get_variable\r\n    use_resource=use_resource, custom_getter=custom_getter)\r\n  File \"/home/chenrich/.tensorflowEnvPy3Alt/lib/python3.6/site-packages/tensorflow/python/ops/variable_scope.py\", line 962, in get_variable\r\n    use_resource=use_resource, custom_getter=custom_getter)\r\n  File \"/home/chenrich/.tensorflowEnvPy3Alt/lib/python3.6/site-packages/tensorflow/python/ops/variable_scope.py\", line 360, in get_variable\r\n    validate_shape=validate_shape, use_resource=use_resource)\r\n  File \"/home/chenrich/.tensorflowEnvPy3Alt/lib/python3.6/site-packages/tensorflow/python/ops/variable_scope.py\", line 1405, in wrapped_custom_getter\r\n    *args, **kwargs)\r\n  File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/train/utility.py\", line 36, in __call__\r\n    return getter(name, *args, **kwargs)\r\n  File \"/mnt/nvme1/chenrich/Developer/tensorpack-0.5.0/tensorpack/train/utility.py\", line 33, in __call__\r\n    collections.remove(tf.GraphKeys.GLOBAL_VARIABLES)\r\nKeyError: 'variables'\r\n```\r\n\r\nI launch my codes as:\r\n`\r\npython3 examples/ResNet/imagenet-resnet-dist.py --data /PATH/dataset/imagenet -d 18 --gpu 2 --task 0 --job ps\r\n`\r\n`\r\npython3 examples/ResNet/imagenet-resnet-dist.py --data /PATH/dataset/imagenet -d 18 --gpu 2 --task 0 --job worker\r\n...\r\n`\r\nThe modified code is available at\r\nhttps://gist.github.com/chunfuchen/d8f6db7183ba94ac416948029c366387\r\n\r\nThe modifications are:\r\n- TrainCfg: wrapper dataflow into data. (L117)\r\n```python\r\nreturn TrainConfig(\r\n        model=model,\r\n        data=QueueInput(dataset_train),\r\n        # dataflow=dataset_train,\r\n        callbacks=callbacks,\r\n        steps_per_epoch=5000,\r\n        max_epoch=110,\r\n        nr_tower=nr_tower\r\n    )\r\n```\r\n- Setup Distributed Learners. (Line 162)\r\n```python\r\ncluster_spec = tf.train.ClusterSpec({\r\n            'ps': ['localhost:2222', 'localhost:2232'],\r\n            'worker': ['localhost:2223', 'localhost:2233']\r\n        })\r\n        server = tf.train.Server(\r\n            cluster_spec, job_name=args.job, \r\n            task_index=args.task, config=get_default_sess_config())\r\n        DistributedTrainerReplicated(config, server).train()```\r\n```\r\n\r\nNote: I was testing on single machine but eventually I will deploy on a cluster.", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/430/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/430/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/411", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/411/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/411/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/411/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/411", "id": 255853899, "node_id": "MDU6SXNzdWUyNTU4NTM4OTk=", "number": 411, "title": "Running Cycle GAN error after epoch3", "user": {"login": "AkhilSinghRana", "id": 26286854, "node_id": "MDQ6VXNlcjI2Mjg2ODU0", "avatar_url": "https://avatars.githubusercontent.com/u/26286854?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AkhilSinghRana", "html_url": "https://github.com/AkhilSinghRana", "followers_url": "https://api.github.com/users/AkhilSinghRana/followers", "following_url": "https://api.github.com/users/AkhilSinghRana/following{/other_user}", "gists_url": "https://api.github.com/users/AkhilSinghRana/gists{/gist_id}", "starred_url": "https://api.github.com/users/AkhilSinghRana/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AkhilSinghRana/subscriptions", "organizations_url": "https://api.github.com/users/AkhilSinghRana/orgs", "repos_url": "https://api.github.com/users/AkhilSinghRana/repos", "events_url": "https://api.github.com/users/AkhilSinghRana/events{/privacy}", "received_events_url": "https://api.github.com/users/AkhilSinghRana/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-09-07T08:21:35Z", "updated_at": "2018-05-30T20:59:19Z", "closed_at": "2017-09-07T08:26:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi After epoch 3, There is a call to this fuunction \r\n callbacks=[\r\n            ModelSaver(),\r\n            ScheduledHyperParamSetter(\r\n                'learning_rate',\r\n                [(100, 2e-4), (200, 0)], interp='linear'),\r\n            PeriodicTrigger(**VisualizeTestSet(), every_k_epochs=3**), #Value changed from 3 just for training \r\n        ],vvvv\r\nwhich throws error. I am not sure why this error comes, But I am guessing it is because of dataflow function in preprocess.py called  \"PrefetchDataZMQ\" Object has no attribute socket. I am not sure what this really means. I am attaching the error below.\r\n\r\n W tensorflow/core/kernels/queue_base.cc:295] _0_QueueInput/input_queue: Skipping cancelled enqueue attempt with queue not closed\r\nTraceback (most recent call last):\r\n  File \"tensorpack/examples/GAN/CycleGAN.py\", line 234, in <module>\r\n    GANTrainer(config).train()\r\n  File \"/home/NOVA/akhil.singh-rana/MyWorkspace/MyProjects/tensorpack/env/lib/python2.7/site-packages/tensorpack/train/base.py\", line 136, in train\r\n    self.main_loop()\r\n  File \"/home/NOVA/akhil.singh-rana/MyWorkspace/MyProjects/tensorpack/env/lib/python2.7/site-packages/tensorpack/train/base.py\", line 241, in main_loop\r\n    self._callbacks.trigger_epoch()\r\n  File \"/home/NOVA/akhil.singh-rana/MyWorkspace/MyProjects/tensorpack/env/lib/python2.7/site-packages/tensorpack/callbacks/base.py\", line 151, in trigger_epoch\r\n    self._trigger_epoch()\r\n  File \"/home/NOVA/akhil.singh-rana/MyWorkspace/MyProjects/tensorpack/env/lib/python2.7/site-packages/tensorpack/callbacks/group.py\", line 91, in _trigger_epoch\r\n    cb.trigger_epoch()\r\n  File \"/home/NOVA/akhil.singh-rana/MyWorkspace/MyProjects/tensorpack/env/lib/python2.7/site-packages/tensorpack/callbacks/base.py\", line 151, in trigger_epoch\r\n    self._trigger_epoch()\r\n  File \"/home/NOVA/akhil.singh-rana/MyWorkspace/MyProjects/tensorpack/env/lib/python2.7/site-packages/tensorpack/callbacks/trigger.py\", line 43, in _trigger_epoch\r\n    self.cb.trigger()\r\n  File \"/home/NOVA/akhil.singh-rana/MyWorkspace/MyProjects/tensorpack/env/lib/python2.7/site-packages/tensorpack/callbacks/base.py\", line 160, in trigger\r\n    self._trigger()\r\n  File \"tensorpack/examples/GAN/CycleGAN.py\", line 200, in _trigger\r\n    for iA, iB in self.val_ds.get_data():\r\n  File \"/home/NOVA/akhil.singh-rana/MyWorkspace/MyProjects/tensorpack/env/lib/python2.7/site-packages/tensorpack/dataflow/prefetch.py\", line 171, in get_data\r\n    dp = loads(self.socket.recv(copy=False).bytes)\r\nAttributeError: 'PrefetchDataZMQ' object has no attribute 'socket'[0906 17:50:24 @input_source.py:203] EnqueueThread QueueInput/input_queue Exited.\r\n\r\n\r\nI have changed the visualiyation to after epoch 193, Hope that helps me atleast train the model ?", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/411/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/411/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/408", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/408/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/408/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/408/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/408", "id": 254908347, "node_id": "MDU6SXNzdWUyNTQ5MDgzNDc=", "number": 408, "title": "cvtColor will fail after ConstantBackgroundFiller due to wrong type", "user": {"login": "eyaler", "id": 4436747, "node_id": "MDQ6VXNlcjQ0MzY3NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4436747?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eyaler", "html_url": "https://github.com/eyaler", "followers_url": "https://api.github.com/users/eyaler/followers", "following_url": "https://api.github.com/users/eyaler/following{/other_user}", "gists_url": "https://api.github.com/users/eyaler/gists{/gist_id}", "starred_url": "https://api.github.com/users/eyaler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eyaler/subscriptions", "organizations_url": "https://api.github.com/users/eyaler/orgs", "repos_url": "https://api.github.com/users/eyaler/repos", "events_url": "https://api.github.com/users/eyaler/events{/privacy}", "received_events_url": "https://api.github.com/users/eyaler/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-09-03T23:37:16Z", "updated_at": "2018-05-30T20:59:18Z", "closed_at": "2017-09-04T07:36:22Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "need to change:\r\n`return np.zeros(return_shape) + self.value`\r\nto\r\n`return np.zeros(return_shape,dtype=np.uint8) + self.value`\r\notherwise you will get:\r\n`cv2.error: C:\\projects\\opencv-python\\opencv\\modules\\imgproc\\src\\color.cpp:10600: error: (-215) depth == CV_8U || depth == CV_16U || depth == CV_32F in function cv::cvtColor`\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/408/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/408/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/398", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/398/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/398/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/398/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/398", "id": 254104780, "node_id": "MDU6SXNzdWUyNTQxMDQ3ODA=", "number": 398, "title": "Issue with k-folds training (cross-validation)", "user": {"login": "vfdev-5", "id": 2459423, "node_id": "MDQ6VXNlcjI0NTk0MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/2459423?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vfdev-5", "html_url": "https://github.com/vfdev-5", "followers_url": "https://api.github.com/users/vfdev-5/followers", "following_url": "https://api.github.com/users/vfdev-5/following{/other_user}", "gists_url": "https://api.github.com/users/vfdev-5/gists{/gist_id}", "starred_url": "https://api.github.com/users/vfdev-5/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vfdev-5/subscriptions", "organizations_url": "https://api.github.com/users/vfdev-5/orgs", "repos_url": "https://api.github.com/users/vfdev-5/repos", "events_url": "https://api.github.com/users/vfdev-5/events{/privacy}", "received_events_url": "https://api.github.com/users/vfdev-5/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2017-08-30T19:10:06Z", "updated_at": "2019-04-13T17:40:30Z", "closed_at": "2017-08-30T19:28:13Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi,\r\n\r\nI try to train k models on k-folded data. Code is [here](https://gist.github.com/vfdev-5/05648eaf8ffb71a6f2dd0ee932e22dea). Training on the 1st fold runs correctly and on the next fold I have the following error:\r\n```\r\nValueError: Tensor(\"input:0\", shape=(?, 30, 30, 3), dtype=float32) must be from the same graph as Tensor(\"QueueInput/input_queue:0\", shape=(), dtype=resource).\r\n```\r\nCould you suggest how to do such k-folds training within your frame work (probably, I would have a similar graph problem with pure TF).\r\n\r\nThank you\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/398/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/398/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/394", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/394/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/394/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/394/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/394", "id": 252370527, "node_id": "MDU6SXNzdWUyNTIzNzA1Mjc=", "number": 394, "title": "shift and rotation broken due to missing argument", "user": {"login": "eyaler", "id": 4436747, "node_id": "MDQ6VXNlcjQ0MzY3NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4436747?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eyaler", "html_url": "https://github.com/eyaler", "followers_url": "https://api.github.com/users/eyaler/followers", "following_url": "https://api.github.com/users/eyaler/following{/other_user}", "gists_url": "https://api.github.com/users/eyaler/gists{/gist_id}", "starred_url": "https://api.github.com/users/eyaler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eyaler/subscriptions", "organizations_url": "https://api.github.com/users/eyaler/orgs", "repos_url": "https://api.github.com/users/eyaler/repos", "events_url": "https://api.github.com/users/eyaler/events{/privacy}", "received_events_url": "https://api.github.com/users/eyaler/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-08-23T18:13:46Z", "updated_at": "2018-05-30T20:59:18Z", "closed_at": "2017-08-23T18:17:29Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "we need to add interp as the third argument when calling WarpAffineTransform() in shift and rotation\r\nfor rotation we must set self.interp, for shift we can use cv2.INTER_LINEAR or use argument names in the call.\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/394/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/394/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/369", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/369/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/369/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/369/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/369", "id": 248746103, "node_id": "MDU6SXNzdWUyNDg3NDYxMDM=", "number": 369, "title": "Exception at model_desc.py", "user": {"login": "tonyw", "id": 101988, "node_id": "MDQ6VXNlcjEwMTk4OA==", "avatar_url": "https://avatars.githubusercontent.com/u/101988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tonyw", "html_url": "https://github.com/tonyw", "followers_url": "https://api.github.com/users/tonyw/followers", "following_url": "https://api.github.com/users/tonyw/following{/other_user}", "gists_url": "https://api.github.com/users/tonyw/gists{/gist_id}", "starred_url": "https://api.github.com/users/tonyw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tonyw/subscriptions", "organizations_url": "https://api.github.com/users/tonyw/orgs", "repos_url": "https://api.github.com/users/tonyw/repos", "events_url": "https://api.github.com/users/tonyw/events{/privacy}", "received_events_url": "https://api.github.com/users/tonyw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-08-08T15:02:48Z", "updated_at": "2018-05-30T20:59:16Z", "closed_at": "2017-08-08T15:15:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "When I train a model,I meet an exception.After I check the tracestack,I think there may be some bug for tensorpack/graph_builder/model_desc.py line 150\r\n\r\nSome pice of error message:\r\n---------------------------------------------------------------------------------\r\nraise TypeError(\"Using a `tf.Tensor` as a Python `bool` is not allowed. \"\r\nTypeError: Using a `tf.Tensor` as a Python `bool` is not allowed. Use `if t is not None:` instead of `if t:` to test if a tensor is defined, and use TensorFlow ops such as \r\ntf.cond to execute subgraphs conditioned on the value of a tensor.", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/369/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/369/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/368", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/368/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/368/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/368/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/368", "id": 248729532, "node_id": "MDU6SXNzdWUyNDg3Mjk1MzI=", "number": 368, "title": "example codes crashed (ResNet)", "user": {"login": "chunfuchen", "id": 7079318, "node_id": "MDQ6VXNlcjcwNzkzMTg=", "avatar_url": "https://avatars.githubusercontent.com/u/7079318?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chunfuchen", "html_url": "https://github.com/chunfuchen", "followers_url": "https://api.github.com/users/chunfuchen/followers", "following_url": "https://api.github.com/users/chunfuchen/following{/other_user}", "gists_url": "https://api.github.com/users/chunfuchen/gists{/gist_id}", "starred_url": "https://api.github.com/users/chunfuchen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chunfuchen/subscriptions", "organizations_url": "https://api.github.com/users/chunfuchen/orgs", "repos_url": "https://api.github.com/users/chunfuchen/repos", "events_url": "https://api.github.com/users/chunfuchen/events{/privacy}", "received_events_url": "https://api.github.com/users/chunfuchen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-08-08T14:14:15Z", "updated_at": "2018-05-30T20:59:16Z", "closed_at": "2017-08-08T14:50:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "After I updated the newest changes, the training for ResNet 50 is crashed; however, the inference is fine. (I clean install the newest version to avoid my changes in source codes.)\r\nThanks!\r\n\r\nmy command:\r\n\r\n```\r\npython3 examples/ResNet/imagenet-resnet.py --gpu 0,1,2,3 --data /home/chenrich/dataset/imagenet -d 50\r\n```\r\n\r\nHere is log:\r\n```\r\n[0808 10:09:00 @input_source.py:427] Pre-filling staging area ...\r\n[0808 10:09:00 @input_source.py:195] ERR Exception in EnqueueThread:\r\nTraceback (most recent call last):\r\n  File \"~/Developer/temp/tensorpack/tensorpack/graph_builder/input_source.py\", line 186, in run\r\n    self.dataflow.reset_state()\r\n  File \"~/Developer/temp/tensorpack/tensorpack/dataflow/base.py\", line 79, in reset_state\r\n    self.ds.reset_state()\r\n  File \"~/Developer/temp/tensorpack/tensorpack/dataflow/prefetch.py\", line 183, in reset_state\r\n    self.start_processes()\r\n  File \"~/Developer/temp/tensorpack/tensorpack/dataflow/prefetch.py\", line 189, in start_processes\r\n    start_proc_mask_signal(self.procs)\r\n  File \"~/Developer/temp/tensorpack/tensorpack/utils/concurrency.py\", line 188, in start_proc_mask_signal\r\n    with mask_sigint():\r\n  File \"~/tools/Python-3.6.2/lib/python3.6/contextlib.py\", line 81, in __enter__\r\n    return next(self.gen)\r\n  File \"~/Developer/temp/tensorpack/tensorpack/utils/concurrency.py\", line 174, in mask_sigint\r\n    sigint_handler = signal.signal(signal.SIGINT, signal.SIG_IGN)\r\n  File \"~/tools/Python-3.6.2/lib/python3.6/signal.py\", line 47, in signal\r\n    handler = _signal.signal(_enum_to_int(signalnum), _enum_to_int(handler))\r\nValueError: signal only works in main thread\r\n[0808 10:09:00 @input_source.py:201] EnqueueThread Exited.\r\n```", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/368/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/368/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/365", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/365/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/365/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/365/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/365", "id": 248579452, "node_id": "MDU6SXNzdWUyNDg1Nzk0NTI=", "number": 365, "title": "error in DataParallelInferenceRunner", "user": {"login": "chunfuchen", "id": 7079318, "node_id": "MDQ6VXNlcjcwNzkzMTg=", "avatar_url": "https://avatars.githubusercontent.com/u/7079318?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chunfuchen", "html_url": "https://github.com/chunfuchen", "followers_url": "https://api.github.com/users/chunfuchen/followers", "following_url": "https://api.github.com/users/chunfuchen/following{/other_user}", "gists_url": "https://api.github.com/users/chunfuchen/gists{/gist_id}", "starred_url": "https://api.github.com/users/chunfuchen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chunfuchen/subscriptions", "organizations_url": "https://api.github.com/users/chunfuchen/orgs", "repos_url": "https://api.github.com/users/chunfuchen/repos", "events_url": "https://api.github.com/users/chunfuchen/events{/privacy}", "received_events_url": "https://api.github.com/users/chunfuchen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2017-08-08T02:01:03Z", "updated_at": "2018-05-30T20:59:16Z", "closed_at": "2017-08-08T07:22:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "I was using `DataParallelInferenceRunner` without any issue but after I pull your recent changes, it throws an error about undefined attribute.  Do I need to revise the usage of this class? \r\n\r\nThanks for your kindly support.\r\n\r\nHere is my code to use `DataParallelInferenceRunner` (refer to cifar10-resnet.py)\r\n```python\r\nDataParallelInferenceRunner(dataset_test,\r\n  [ScalarStats('cost'), ClassificationError()], [ x for x in range(get_nr_gpu()) ]),\r\n```\r\n\r\nand the log is\r\n \r\n```\r\nraceback (most recent call last):\r\n  File \"examples/ResNet/cifar10-resnet.py\", line 178, in <module>\r\n    SyncMultiGPUTrainerParameterServer(config).train()\r\n  File \"/u/chenrich/Developer/tensorpack/tensorpack/train/base.py\", line 100, in train\r\n    self.setup()\r\n  File \"/u/chenrich/Developer/tensorpack/tensorpack/train/base.py\", line 140, in setup\r\n    self._callbacks.setup_graph(weakref.proxy(self))\r\n  File \"/u/chenrich/Developer/tensorpack/tensorpack/callbacks/base.py\", line 54, in setup_graph\r\n    self._setup_graph()\r\n  File \"/u/chenrich/Developer/tensorpack/tensorpack/callbacks/group.py\", line 64, in _setup_graph\r\n    cb.setup_graph(self.trainer)\r\n  File \"/u/chenrich/Developer/tensorpack/tensorpack/callbacks/base.py\", line 54, in setup_graph\r\n    self._setup_graph()\r\n  File \"/u/chenrich/Developer/tensorpack/tensorpack/callbacks/inference_runner.py\", line 170, in _setup_graph\r\n    cbs = self._input_source.setup(self.trainer.model.get_inputs_desc())\r\n  File \"/u/chenrich/Developer/tensorpack/tensorpack/graph_builder/input_source_base.py\", line 43, in setup\r\n    self._setup(inputs_desc)\r\n  File \"/u/chenrich/Developer/tensorpack/tensorpack/graph_builder/input_source.py\", line 136, in _setup\r\n    self._cb = self._DataParallelFeedCallback(self._repeat_ds, self._placehdrs_per_tower)\r\nAttributeError: 'DataParallelFeedInput' object has no attribute '_repeat_ds'\r\n```", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/365/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/365/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/364", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/364/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/364/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/364/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/364", "id": 248459525, "node_id": "MDU6SXNzdWUyNDg0NTk1MjU=", "number": 364, "title": "global_step number is incorrect after resume", "user": {"login": "chunfuchen", "id": 7079318, "node_id": "MDQ6VXNlcjcwNzkzMTg=", "avatar_url": "https://avatars.githubusercontent.com/u/7079318?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chunfuchen", "html_url": "https://github.com/chunfuchen", "followers_url": "https://api.github.com/users/chunfuchen/followers", "following_url": "https://api.github.com/users/chunfuchen/following{/other_user}", "gists_url": "https://api.github.com/users/chunfuchen/gists{/gist_id}", "starred_url": "https://api.github.com/users/chunfuchen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chunfuchen/subscriptions", "organizations_url": "https://api.github.com/users/chunfuchen/orgs", "repos_url": "https://api.github.com/users/chunfuchen/repos", "events_url": "https://api.github.com/users/chunfuchen/events{/privacy}", "received_events_url": "https://api.github.com/users/chunfuchen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-08-07T16:09:54Z", "updated_at": "2018-05-30T20:59:16Z", "closed_at": "2017-08-07T16:26:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "After resuming a model trained at `global_step=475000`, the next `global_step` jumps to `955000` directly. Here is the log:\r\n\r\n```\r\n[0807 10:55:08 @steps.py:71] Start training with global_step=475000\r\n[0807 10:55:11 @param.py:144] learning_rate at epoch 96 will change to 0.00001000\r\n[0807 10:55:12 @concurrency.py:36] Starting EnqueueThread ...\r\n[0807 10:55:12 @input_source.py:418] Pre-filling staging area ...\r\n[0807 10:55:12 @base.py:200] Start Epoch 96 ...\r\n100%|############################################################################################|5000/5000[51:14<00:00, 0.66it/s]\r\n[0807 11:46:26 @base.py:210] Epoch 96 (global_step 955000) finished, time:3074.13 sec.\r\n```\r\n\r\nIt seems that the global_step is messed after resuming. (955000 = 475000 + 480000, in my training, 5000 iters = 1 epoch); but the learning rate scheduler still wokrs fine and the epoch num is correct. \r\n\r\nDo I need to maintain the global_step by myself?\r\nHere is the command of my execution:\r\n```\r\npython3 examples/ResNet/imagenet-resnet.py -d 50 --gpu 0,1,2,3 --load $SOMEWHERE\r\n```\r\n\r\nThanks.\r\n\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/364/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/364/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/361", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/361/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/361/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/361/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/361", "id": 247833802, "node_id": "MDU6SXNzdWUyNDc4MzM4MDI=", "number": 361, "title": "AssertionError running GAN samples", "user": {"login": "Kukanani", "id": 6893343, "node_id": "MDQ6VXNlcjY4OTMzNDM=", "avatar_url": "https://avatars.githubusercontent.com/u/6893343?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Kukanani", "html_url": "https://github.com/Kukanani", "followers_url": "https://api.github.com/users/Kukanani/followers", "following_url": "https://api.github.com/users/Kukanani/following{/other_user}", "gists_url": "https://api.github.com/users/Kukanani/gists{/gist_id}", "starred_url": "https://api.github.com/users/Kukanani/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Kukanani/subscriptions", "organizations_url": "https://api.github.com/users/Kukanani/orgs", "repos_url": "https://api.github.com/users/Kukanani/repos", "events_url": "https://api.github.com/users/Kukanani/events{/privacy}", "received_events_url": "https://api.github.com/users/Kukanani/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-08-03T20:59:29Z", "updated_at": "2018-05-30T20:59:16Z", "closed_at": "2017-08-03T21:04:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nI'm just beginning with TensorPack, and I was able to install it and run training on the ConditionalGAN-mnist example. Now, when trying to generate samples, I get the following output:\r\n```\r\n$ ./ConditionalGAN-mnist.py --load train_log/ConditionalGAN-mnist/model-2000.data-00000-of-00001 --sample\r\nFailed to load OpenCL runtime (expected version 1.1+)\r\n[0803 15:48:21 @varmanip.py:163] WRN Checkpoint path train_log/ConditionalGAN-mnist/model-2000.data-00000-of-00001 is auto-corrected to train_log/ConditionalGAN-mnist/model-2000.\r\nTraceback (most recent call last):\r\n  File \"./ConditionalGAN-mnist.py\", line 144, in <module>\r\n    sample(args.load)\r\n  File \"./ConditionalGAN-mnist.py\", line 123, in sample\r\n    output_names=['gen/gen'])\r\n  File \"/home/adam/.virtualenvs/cv/local/lib/python2.7/site-packages/tensorpack/predict/config.py\", line 43, in __init__\r\n    assert_type(self.model, ModelDesc)\r\n  File \"/home/adam/.virtualenvs/cv/local/lib/python2.7/site-packages/tensorpack/predict/config.py\", line 41, in assert_type\r\n    assert isinstance(v, tp), v.__class__\r\nAssertionError: <class '__main__.Model'>\r\n```\r\nUnfortunately I'm not a strong Python developer, so I'm having trouble debugging this on my own. I also wonder if this has anything to do with my use of Python2.", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/361/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/361/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/360", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/360/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/360/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/360/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/360", "id": 247607444, "node_id": "MDU6SXNzdWUyNDc2MDc0NDQ=", "number": 360, "title": "Incorrect implementation of Batch Renorm?", "user": {"login": "waleedka", "id": 106472, "node_id": "MDQ6VXNlcjEwNjQ3Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/106472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/waleedka", "html_url": "https://github.com/waleedka", "followers_url": "https://api.github.com/users/waleedka/followers", "following_url": "https://api.github.com/users/waleedka/following{/other_user}", "gists_url": "https://api.github.com/users/waleedka/gists{/gist_id}", "starred_url": "https://api.github.com/users/waleedka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/waleedka/subscriptions", "organizations_url": "https://api.github.com/users/waleedka/orgs", "repos_url": "https://api.github.com/users/waleedka/repos", "events_url": "https://api.github.com/users/waleedka/events{/privacy}", "received_events_url": "https://api.github.com/users/waleedka/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-08-03T06:44:21Z", "updated_at": "2018-05-30T20:59:16Z", "closed_at": "2017-08-03T08:10:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "I've been checking your implementation of Batch Re-Normalization, and I think there is an error that you might want to look into. \r\n\r\nTo set a baseline, this is how the original paper defines batch renormalization:\r\n\r\n```Python\r\nnormed_x = (x - batch_mean) / batch_std    # standard BN\r\nnormed_x = normed_x * r + d                # The batch renorm correction\r\nnormed_x = normed_x * gamma + beta         # final scale and bias\r\n```\r\n\r\nIn other words, apply BN first, then apply the r/d correction, then apply gamma/beta last. But, in batch_norm.py, it applies BN, then the gamma/beta (both operations are done using tf.nn.fused_batch_norm in this line):\r\n\r\nhttps://github.com/ppwwyyxx/tensorpack/blob/master/tensorpack/models/batch_norm.py#L209\r\n\r\nThen it applies the r/d correction last in:\r\nhttps://github.com/ppwwyyxx/tensorpack/blob/master/tensorpack/models/batch_norm.py#L220\r\n\r\nIt's possible that I'm missing something here or misunderstood the paper. If so, please do correct me. ", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/360/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/360/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/351", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/351/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/351/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/351/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/351", "id": 246614438, "node_id": "MDU6SXNzdWUyNDY2MTQ0Mzg=", "number": 351, "title": "Having BNReLU activation inside freeze_variables", "user": {"login": "haamoon", "id": 8838247, "node_id": "MDQ6VXNlcjg4MzgyNDc=", "avatar_url": "https://avatars.githubusercontent.com/u/8838247?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haamoon", "html_url": "https://github.com/haamoon", "followers_url": "https://api.github.com/users/haamoon/followers", "following_url": "https://api.github.com/users/haamoon/following{/other_user}", "gists_url": "https://api.github.com/users/haamoon/gists{/gist_id}", "starred_url": "https://api.github.com/users/haamoon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haamoon/subscriptions", "organizations_url": "https://api.github.com/users/haamoon/orgs", "repos_url": "https://api.github.com/users/haamoon/repos", "events_url": "https://api.github.com/users/haamoon/events{/privacy}", "received_events_url": "https://api.github.com/users/haamoon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-07-30T22:51:27Z", "updated_at": "2018-05-30T20:59:16Z", "closed_at": "2017-07-30T23:56:44Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Apparently, tensorpack does not like to see BNReLU activation when using varreplace.freeze_variables(). Here is a minimal code to reproduce the error:\r\n\r\n```\r\nimport tensorflow as tf\r\nfrom tensorpack import *\r\n\r\nclass Model(ModelDesc):\r\n    def __init__(self, data_format):\r\n        self.data_format = data_format\r\n    def _get_inputs(self):\r\n        return [InputDesc(tf.float32, [1, 224, 224, 3], 'im')]\r\n    def _build_graph(self, inputs):\r\n        image = inputs[0]\r\n        if self.data_format == 'NCHW':\r\n            image = tf.transpose(image, [0, 3, 1, 2])\r\n        with argscope([Conv2D, BatchNorm], data_format=self.data_format):\r\n            with varreplace.freeze_variables():\r\n                fea = Conv2D('conv0', image, 64, 7, stride=2, nl=BNReLU)\r\n    def _get_optimizer(self):\r\n        pass\r\n\r\nif __name__ == '__main__':\r\n    model = Model('NCHW');\r\n    inputs = [tf.placeholder(dtype=inp.type, shape=inp.shape, name=inp.name) for inp in model._get_inputs()]\r\n    with TowerContext('', is_training=True):\r\n          model._build_graph(inputs)\r\n```\r\n\r\nwithout nl=BNReLU or freeze_variables it runs without any problem. Any Idea how to fix it? ", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/351/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/351/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/324", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/324/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/324/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/324/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/324", "id": 240498194, "node_id": "MDU6SXNzdWUyNDA0OTgxOTQ=", "number": 324, "title": "Feature Request: Ability to specify enqueue timeout", "user": {"login": "Skylion007", "id": 2053727, "node_id": "MDQ6VXNlcjIwNTM3Mjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2053727?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Skylion007", "html_url": "https://github.com/Skylion007", "followers_url": "https://api.github.com/users/Skylion007/followers", "following_url": "https://api.github.com/users/Skylion007/following{/other_user}", "gists_url": "https://api.github.com/users/Skylion007/gists{/gist_id}", "starred_url": "https://api.github.com/users/Skylion007/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Skylion007/subscriptions", "organizations_url": "https://api.github.com/users/Skylion007/orgs", "repos_url": "https://api.github.com/users/Skylion007/repos", "events_url": "https://api.github.com/users/Skylion007/events{/privacy}", "received_events_url": "https://api.github.com/users/Skylion007/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-07-04T21:12:00Z", "updated_at": "2018-05-30T20:59:14Z", "closed_at": "2017-07-05T19:14:50Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Since upgrading, I have multiple examples of CycleGAN fail due to enqueue timeout (I think mainly on the test set). There should be  a way to specify the timeout without editing the source code or at the very least the timeout should be increased significantly.", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/324/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/324/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/323", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/323/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/323/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/323/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/323", "id": 240295225, "node_id": "MDU6SXNzdWUyNDAyOTUyMjU=", "number": 323, "title": "Char-RNN sample ", "user": {"login": "luiscarm9", "id": 11293873, "node_id": "MDQ6VXNlcjExMjkzODcz", "avatar_url": "https://avatars.githubusercontent.com/u/11293873?v=4", "gravatar_id": "", "url": "https://api.github.com/users/luiscarm9", "html_url": "https://github.com/luiscarm9", "followers_url": "https://api.github.com/users/luiscarm9/followers", "following_url": "https://api.github.com/users/luiscarm9/following{/other_user}", "gists_url": "https://api.github.com/users/luiscarm9/gists{/gist_id}", "starred_url": "https://api.github.com/users/luiscarm9/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/luiscarm9/subscriptions", "organizations_url": "https://api.github.com/users/luiscarm9/orgs", "repos_url": "https://api.github.com/users/luiscarm9/repos", "events_url": "https://api.github.com/users/luiscarm9/events{/privacy}", "received_events_url": "https://api.github.com/users/luiscarm9/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-07-04T02:17:08Z", "updated_at": "2018-05-30T20:59:14Z", "closed_at": "2017-07-04T06:05:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "When you try to generate a new sample based on a model it fails.\r\n\r\nBut if you change line 146 \r\n`x = np.array([[ds.lut.get_idx(c)]], dtype='int32')`\r\nto\r\n`x = np.array([[ds.chars.index(c)]], dtype='int32')`\r\nAnd line 158 \r\n`x = np.array([[ds.lut.get_idx(c)]], dtype='int32')`\r\nto\r\n`c = ds.chars[pick(prob[0])]`\r\n\r\nIt is the same as you wanted in yout initial version?", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/323/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/323/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/310", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/310/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/310/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/310/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/310", "id": 238023948, "node_id": "MDU6SXNzdWUyMzgwMjM5NDg=", "number": 310, "title": "Multi-GPU training when #GPU>10", "user": {"login": "xingyul", "id": 25826644, "node_id": "MDQ6VXNlcjI1ODI2NjQ0", "avatar_url": "https://avatars.githubusercontent.com/u/25826644?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xingyul", "html_url": "https://github.com/xingyul", "followers_url": "https://api.github.com/users/xingyul/followers", "following_url": "https://api.github.com/users/xingyul/following{/other_user}", "gists_url": "https://api.github.com/users/xingyul/gists{/gist_id}", "starred_url": "https://api.github.com/users/xingyul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xingyul/subscriptions", "organizations_url": "https://api.github.com/users/xingyul/orgs", "repos_url": "https://api.github.com/users/xingyul/repos", "events_url": "https://api.github.com/users/xingyul/events{/privacy}", "received_events_url": "https://api.github.com/users/xingyul/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-06-23T02:26:11Z", "updated_at": "2018-05-30T20:59:13Z", "closed_at": "2017-06-23T02:33:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "When using multi-GPU training and the number of GPU > 10, I encounter problems of variable sharing. When building 11th tower, I have the following error:\r\n`[0623 02:20:52 @multigpu.py:89] Building graph for training tower 10...\r\n...\r\nValueError: Variable XXX/W already exists, disallowed. Did you mean to set reuse=True in VarScope? Originally defined at:\r\n`\r\n\r\nThis error won't happen when #GPU <= 10.\r\nI was using `SyncMultiGPUTrainer(config).train()`", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/310/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/310/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/293", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/293/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/293/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/293/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/293", "id": 233818451, "node_id": "MDU6SXNzdWUyMzM4MTg0NTE=", "number": 293, "title": "Thread objects not properly initialized.", "user": {"login": "chuber1986", "id": 18696575, "node_id": "MDQ6VXNlcjE4Njk2NTc1", "avatar_url": "https://avatars.githubusercontent.com/u/18696575?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chuber1986", "html_url": "https://github.com/chuber1986", "followers_url": "https://api.github.com/users/chuber1986/followers", "following_url": "https://api.github.com/users/chuber1986/following{/other_user}", "gists_url": "https://api.github.com/users/chuber1986/gists{/gist_id}", "starred_url": "https://api.github.com/users/chuber1986/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chuber1986/subscriptions", "organizations_url": "https://api.github.com/users/chuber1986/orgs", "repos_url": "https://api.github.com/users/chuber1986/repos", "events_url": "https://api.github.com/users/chuber1986/events{/privacy}", "received_events_url": "https://api.github.com/users/chuber1986/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-06-06T08:39:20Z", "updated_at": "2018-05-30T20:59:12Z", "closed_at": "2017-06-06T09:06:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi *,\r\nthe tensorpack.dataflow.prefetch.ThreadMapData defines the class WorkerThread which inherits from StroppableThread. Unfortunately, the constructor of WorkerThread does not call it's parent constructor.\r\nTherefore, the constructor if threading.Tread will not be called before the run-method. This leads to an error.\r\nAdding the following line tor the constructor of WorkerThread fixes the problem:\r\n  super(ThreadedMapData.WorkerThread, self).__init__()\r\n\r\nBR Christian", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/293/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/293/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/279", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/279/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/279/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/279/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/279", "id": 230856803, "node_id": "MDU6SXNzdWUyMzA4NTY4MDM=", "number": 279, "title": "Error when using dump-model-params", "user": {"login": "a-maci", "id": 23125439, "node_id": "MDQ6VXNlcjIzMTI1NDM5", "avatar_url": "https://avatars.githubusercontent.com/u/23125439?v=4", "gravatar_id": "", "url": "https://api.github.com/users/a-maci", "html_url": "https://github.com/a-maci", "followers_url": "https://api.github.com/users/a-maci/followers", "following_url": "https://api.github.com/users/a-maci/following{/other_user}", "gists_url": "https://api.github.com/users/a-maci/gists{/gist_id}", "starred_url": "https://api.github.com/users/a-maci/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/a-maci/subscriptions", "organizations_url": "https://api.github.com/users/a-maci/orgs", "repos_url": "https://api.github.com/users/a-maci/repos", "events_url": "https://api.github.com/users/a-maci/events{/privacy}", "received_events_url": "https://api.github.com/users/a-maci/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-05-23T21:47:18Z", "updated_at": "2018-05-30T20:59:11Z", "closed_at": "2017-05-23T21:51:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am using dump-model-params script to extract the weights from a ResNet34 run I had done a while back. I am getting this error:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/Exps/extractWeights/tensorpack/scripts/dump-model-params.py\", line 31, in <module>\r\n    M = ModelFromMetaGraph(args.meta)\r\n  File \"/home/Exps/extractWeights/tensorpack/tensorpack/models/model_desc.py\", line 173, in __init__\r\n    \"Collection {} not found in metagraph!\".format(k)\r\nAssertionError: Collection INPUTS_METAINFO not found in metagraph!\r\n```", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/279/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/279/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/276", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/276/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/276/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/276/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/276", "id": 230248671, "node_id": "MDU6SXNzdWUyMzAyNDg2NzE=", "number": 276, "title": "get_global_step changes seems to have broke examples.", "user": {"login": "Skylion007", "id": 2053727, "node_id": "MDQ6VXNlcjIwNTM3Mjc=", "avatar_url": "https://avatars.githubusercontent.com/u/2053727?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Skylion007", "html_url": "https://github.com/Skylion007", "followers_url": "https://api.github.com/users/Skylion007/followers", "following_url": "https://api.github.com/users/Skylion007/following{/other_user}", "gists_url": "https://api.github.com/users/Skylion007/gists{/gist_id}", "starred_url": "https://api.github.com/users/Skylion007/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Skylion007/subscriptions", "organizations_url": "https://api.github.com/users/Skylion007/orgs", "repos_url": "https://api.github.com/users/Skylion007/repos", "events_url": "https://api.github.com/users/Skylion007/events{/privacy}", "received_events_url": "https://api.github.com/users/Skylion007/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-05-21T21:03:07Z", "updated_at": "2018-05-30T20:59:11Z", "closed_at": "2017-05-22T03:37:04Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The new code for get_global_step_var and such seems to have broken certain examples such as DiscoGAN.  Biggest issue seems to be the dtype is an int64_ref instead of an int64 so functions like piecewise constants do not seem to work. Furthermore, despite ending in the word _var it appears to return a tensor instead? ", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/276/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/276/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/273", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/273/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/273/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/273/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/273", "id": 229594805, "node_id": "MDU6SXNzdWUyMjk1OTQ4MDU=", "number": 273, "title": "error when running training multiple times", "user": {"login": "eyaler", "id": 4436747, "node_id": "MDQ6VXNlcjQ0MzY3NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4436747?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eyaler", "html_url": "https://github.com/eyaler", "followers_url": "https://api.github.com/users/eyaler/followers", "following_url": "https://api.github.com/users/eyaler/following{/other_user}", "gists_url": "https://api.github.com/users/eyaler/gists{/gist_id}", "starred_url": "https://api.github.com/users/eyaler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eyaler/subscriptions", "organizations_url": "https://api.github.com/users/eyaler/orgs", "repos_url": "https://api.github.com/users/eyaler/repos", "events_url": "https://api.github.com/users/eyaler/events{/privacy}", "received_events_url": "https://api.github.com/users/eyaler/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2017-05-18T08:38:15Z", "updated_at": "2018-05-30T20:59:11Z", "closed_at": "2017-05-19T00:09:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "i want to run an example multiple times in a loop, each time from scratch.\r\nto recreate my issue take InfoGAN-mnist.py and after\r\n`GANTrainer(config).train()`\r\nadd:\r\n`tf.reset_default_graph(); config = get_config(); GANTrainer(config).train()`\r\non the second training, i get:\r\nValueError: Tensor(\"EMA/decay:0\", shape=(), dtype=float32) must be from the same graph as Tensor(\"truediv:0\", shape=(), dtype=float32).", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/273/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/273/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/261", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/261/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/261/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/261/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/261", "id": 227391064, "node_id": "MDU6SXNzdWUyMjczOTEwNjQ=", "number": 261, "title": "Python3 generator", "user": {"login": "PatWie", "id": 6756603, "node_id": "MDQ6VXNlcjY3NTY2MDM=", "avatar_url": "https://avatars.githubusercontent.com/u/6756603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PatWie", "html_url": "https://github.com/PatWie", "followers_url": "https://api.github.com/users/PatWie/followers", "following_url": "https://api.github.com/users/PatWie/following{/other_user}", "gists_url": "https://api.github.com/users/PatWie/gists{/gist_id}", "starred_url": "https://api.github.com/users/PatWie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PatWie/subscriptions", "organizations_url": "https://api.github.com/users/PatWie/orgs", "repos_url": "https://api.github.com/users/PatWie/repos", "events_url": "https://api.github.com/users/PatWie/events{/privacy}", "received_events_url": "https://api.github.com/users/PatWie/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-05-09T14:44:44Z", "updated_at": "2018-05-30T20:59:11Z", "closed_at": "2017-05-09T16:01:26Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "In python 3, there is no `.next()` anymore.", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/261/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/261/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/256", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/256/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/256/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/256/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/256", "id": 226986171, "node_id": "MDU6SXNzdWUyMjY5ODYxNzE=", "number": 256, "title": "OfflinePredictor broken on the current master", "user": {"login": "msbauer", "id": 15681485, "node_id": "MDQ6VXNlcjE1NjgxNDg1", "avatar_url": "https://avatars.githubusercontent.com/u/15681485?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msbauer", "html_url": "https://github.com/msbauer", "followers_url": "https://api.github.com/users/msbauer/followers", "following_url": "https://api.github.com/users/msbauer/following{/other_user}", "gists_url": "https://api.github.com/users/msbauer/gists{/gist_id}", "starred_url": "https://api.github.com/users/msbauer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msbauer/subscriptions", "organizations_url": "https://api.github.com/users/msbauer/orgs", "repos_url": "https://api.github.com/users/msbauer/repos", "events_url": "https://api.github.com/users/msbauer/events{/privacy}", "received_events_url": "https://api.github.com/users/msbauer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-05-08T09:19:44Z", "updated_at": "2018-05-30T20:59:10Z", "closed_at": "2017-05-08T16:24:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI don't fully understand what the problem is exactly, so I hope I can describe it in an understandable way.\r\n\r\nBasically, I have a trained network on which I want to run an OfflinePredictor several times (b/c I have several batches of data that I want to predict on). So far, this all worked nicely.\r\n\r\nOn the current master the OfflinePredictor runs once without problems and on the second attempt I get the following error message:\r\n\r\n```[0508 11:02:52 @fs.py:99] WRN $TENSORPACK_DATASET not set, using /is/ei/mrojas/tensorpack_data for dataset.\r\n[0508 11:02:52 @cifar_dataset.py:36] Found cifar100 data in /..../tensorpack_data/cifar100_data.\r\nbefore calling \r\n[0508 11:02:52 @common.py:128] conv1_1 input: [None, 32, 32, 3]\r\n[0508 11:02:52 @common.py:136] conv1_1 output: [None, 32, 32, 64]\r\n[0508 11:02:52 @common.py:128] conv1_2 input: [None, 32, 32, 64]\r\n[0508 11:02:52 @common.py:136] conv1_2 output: [None, 32, 32, 64]\r\n[0508 11:02:52 @common.py:128] pool1 input: [None, 32, 32, 64]\r\n[0508 11:02:52 @common.py:136] pool1 output: [None, 16, 16, 64]\r\n[0508 11:02:52 @common.py:128] conv2_1 input: [None, 16, 16, 64]\r\n[0508 11:02:52 @common.py:136] conv2_1 output: [None, 16, 16, 128]\r\n[0508 11:02:52 @common.py:128] conv2_2 input: [None, 16, 16, 128]\r\n[0508 11:02:52 @common.py:136] conv2_2 output: [None, 16, 16, 128]\r\n[0508 11:02:52 @common.py:128] pool2 input: [None, 16, 16, 128]\r\n[0508 11:02:52 @common.py:136] pool2 output: [None, 8, 8, 128]\r\n[0508 11:02:52 @common.py:128] conv3_1 input: [None, 8, 8, 128]\r\n[0508 11:02:52 @common.py:136] conv3_1 output: [None, 8, 8, 256]\r\n[0508 11:02:52 @common.py:128] conv3_2 input: [None, 8, 8, 256]\r\n[0508 11:02:52 @common.py:136] conv3_2 output: [None, 8, 8, 256]\r\n[0508 11:02:52 @common.py:128] pool3 input: [None, 8, 8, 256]\r\n[0508 11:02:52 @common.py:136] pool3 output: [None, 4, 4, 256]\r\n[0508 11:02:52 @common.py:128] conv4_1 input: [None, 4, 4, 256]\r\n[0508 11:02:52 @common.py:136] conv4_1 output: [None, 4, 4, 512]\r\n[0508 11:02:52 @common.py:128] conv4_2 input: [None, 4, 4, 512]\r\n[0508 11:02:53 @common.py:136] conv4_2 output: [None, 4, 4, 512]\r\n[0508 11:02:53 @common.py:128] pool4 input: [None, 4, 4, 512]\r\n[0508 11:02:53 @common.py:136] pool4 output: [None, 2, 2, 512]\r\n[0508 11:02:53 @common.py:128] fc6 input: [None, 2, 2, 512]\r\n[0508 11:02:53 @common.py:136] fc6 output: [None, 1024]\r\n[0508 11:02:53 @common.py:128] fc7 input: [None, 1024]\r\n[0508 11:02:53 @common.py:136] fc7 output: [None, 512]\r\n[0508 11:02:53 @common.py:128] fc8 input: [None, 512]\r\n[0508 11:02:53 @common.py:136] fc8 output: [None, 90]\r\n[0508 11:02:53 @regularize.py:18] Apply regularizer for fc6/W:0\r\n[0508 11:02:53 @regularize.py:18] Apply regularizer for fc7/W:0\r\n[0508 11:02:53 @regularize.py:18] Apply regularizer for fc8/W:0\r\n2017-05-08 11:02:53.069260: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.\r\n2017-05-08 11:02:53.069280: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.\r\n2017-05-08 11:02:53.069288: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.\r\n2017-05-08 11:02:53.069294: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.\r\n2017-05-08 11:02:53.069300: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.\r\n[0508 11:02:53 @sessinit.py:128] WRN Variable beta1_power:0 in checkpoint not found in the graph!\r\n[0508 11:02:53 @sessinit.py:128] WRN Variable beta2_power:0 in checkpoint not found in the graph!\r\n[0508 11:02:53 @sessinit.py:128] WRN Variable input_queue_size/EMA:0 in checkpoint not found in the graph!\r\n[0508 11:02:53 @sessinit.py:128] WRN Variable learning_rate:0 in checkpoint not found in the graph!\r\n[0508 11:02:53 @sessinit.py:100] Restoring checkpoint from /XXXX/model-39000 ...\r\nINFO:tensorflow:Restoring parameters from /XXXX/model-39000\r\nINFO:tensorflow:Restoring parameters from /XXXX/model-39000\r\nafter calling\r\n(256,)\r\n[0 6 7 7 0 8 2 5 9 3]\r\nbefore calling \r\nTraceback (most recent call last):\r\n  File \"cifar_laplace.py\", line 243, in <module>\r\n    run_experiment(cifar_set_parameters.get_set_parameters(set_id=int(args.set)))\r\n  File \"cifar_laplace.py\", line 108, in run_experiment\r\n    x_train, y_train = utils.get_batch_cifar(checkpoint_file, 100, classes_kshot, 'train', set_id=set_id)\r\n  File \"..../oneshot_code/utils.py\", line 111, in get_batch_cifar\r\n    acts = cifar_convnet.network_activation(dp[0], file_name, n_split=n_split)\r\n  File \"..../cifar_convnet.py\", line 186, in network_activation\r\n    output_names=['fc_activation']\r\n  File \"..../tensorpack/predict/base.py\", line 141, in __init__\r\n    config.model.build_graph(input_placehdrs)\r\n  File \"..../tensorpack/models/model_desc.py\", line 116, in build_graph\r\n    self._build_graph(model_inputs)\r\n  File \"..../cifar_convnet.py\", line 92, in _build_graph\r\n    add_moving_summary(tf.reduce_mean(wrong, name='train_error'))\r\n  File \"..../tensorpack/tfutils/summary.py\", line 162, in add_moving_summary\r\n    avg_maintain_op = averager.apply(v)\r\n  File \"..../tensorflow/python/training/moving_averages.py\", line 387, in apply\r\n    (1.0 + num_updates) / (10.0 + num_updates))\r\n  File \"..../tensorflow/python/ops/gen_math_ops.py\", line 1392, in minimum\r\n    result = _op_def_lib.apply_op(\"Minimum\", x=x, y=y, name=name)\r\n  File \"..../tensorflow/python/framework/op_def_library.py\", line 331, in apply_op\r\n    g = ops._get_graph_from_inputs(_Flatten(keywords.values()))\r\n  File \"..../tensorflow/python/framework/ops.py\", line 3912, in _get_graph_from_inputs\r\n    _assert_same_graph(original_graph_element, graph_element)\r\n  File \"..../tensorflow/python/framework/ops.py\", line 3851, in _assert_same_graph\r\n    \"%s must be from the same graph as %s.\" % (item, original_item))\r\nValueError: Tensor(\"EMA/decay:0\", shape=(), dtype=float32) must be from the same graph as Tensor(\"truediv:0\", shape=(), dtype=float32).\r\n```", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/256/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/256/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/206", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/206/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/206/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/206/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/206", "id": 217139704, "node_id": "MDU6SXNzdWUyMTcxMzk3MDQ=", "number": 206, "title": "summary.add_activation_summary not working?", "user": {"login": "byangderek", "id": 6490289, "node_id": "MDQ6VXNlcjY0OTAyODk=", "avatar_url": "https://avatars.githubusercontent.com/u/6490289?v=4", "gravatar_id": "", "url": "https://api.github.com/users/byangderek", "html_url": "https://github.com/byangderek", "followers_url": "https://api.github.com/users/byangderek/followers", "following_url": "https://api.github.com/users/byangderek/following{/other_user}", "gists_url": "https://api.github.com/users/byangderek/gists{/gist_id}", "starred_url": "https://api.github.com/users/byangderek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/byangderek/subscriptions", "organizations_url": "https://api.github.com/users/byangderek/orgs", "repos_url": "https://api.github.com/users/byangderek/repos", "events_url": "https://api.github.com/users/byangderek/events{/privacy}", "received_events_url": "https://api.github.com/users/byangderek/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-03-27T05:24:19Z", "updated_at": "2018-05-30T20:59:07Z", "closed_at": "2017-03-27T05:50:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "In [mnist-convnet](https://github.com/ppwwyyxx/tensorpack/blob/master/examples/mnist-convnet.py) example, if I want to use summary.add_activation_summary, I simply add\r\n`summary.add_activation_summary(logits)`\r\nat [line96](https://github.com/ppwwyyxx/tensorpack/blob/master/examples/mnist-convnet.py#L96),\r\nbut it raised an error saying that the input placeholders are empty. \r\nSeems like summary.add_activation_summary should be implemented inside the inference_runner but is not?\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/206/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/206/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/194", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/194/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/194/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/194/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/194", "id": 215173711, "node_id": "MDU6SXNzdWUyMTUxNzM3MTE=", "number": 194, "title": "[DQN] Attempt to free invalid pointer ", "user": {"login": "chingyaoc", "id": 14292390, "node_id": "MDQ6VXNlcjE0MjkyMzkw", "avatar_url": "https://avatars.githubusercontent.com/u/14292390?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chingyaoc", "html_url": "https://github.com/chingyaoc", "followers_url": "https://api.github.com/users/chingyaoc/followers", "following_url": "https://api.github.com/users/chingyaoc/following{/other_user}", "gists_url": "https://api.github.com/users/chingyaoc/gists{/gist_id}", "starred_url": "https://api.github.com/users/chingyaoc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chingyaoc/subscriptions", "organizations_url": "https://api.github.com/users/chingyaoc/orgs", "repos_url": "https://api.github.com/users/chingyaoc/repos", "events_url": "https://api.github.com/users/chingyaoc/events{/privacy}", "received_events_url": "https://api.github.com/users/chingyaoc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2017-03-18T07:51:58Z", "updated_at": "2018-05-30T20:59:06Z", "closed_at": "2017-03-19T06:22:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, \r\n\r\nThanks for sharing such a powerful library.\r\nHowever, error occurs when I attempt to run [DeepQNetwork](https://github.com/ppwwyyxx/tensorpack/tree/master/examples/DeepQNetwork) with ```./DQN.py --rom breakout.bin```.\r\n\r\n```\r\n[0318 15:48:49 @logger.py:69] Argv: ./DQN.py --rom breakout.bin\r\nWarning: couldn't load settings file: ./ale.cfg\r\n[0318 15:48:49 @expreplay.py:144] Number of Legal actions: 4\r\ntcmalloc: large alloc 7056007168 bytes == 0x46ce000 @\r\n[0318 15:48:50 @gpu.py:32] Loading local devices by TensorFlow ...\r\nsrc/tcmalloc.cc:277] Attempt to free invalid pointer 0x7f9c1e6f34e8\r\nAborted (core dumped)\r\n```\r\n\r\nIt seems that the program try to release invalid memory area. Any ideas?", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/194/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/194/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/190", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/190/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/190/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/190/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/190", "id": 214741232, "node_id": "MDU6SXNzdWUyMTQ3NDEyMzI=", "number": 190, "title": "cudnn does not support NCHW batch_norm during inference?", "user": {"login": "JesseYang", "id": 499122, "node_id": "MDQ6VXNlcjQ5OTEyMg==", "avatar_url": "https://avatars.githubusercontent.com/u/499122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JesseYang", "html_url": "https://github.com/JesseYang", "followers_url": "https://api.github.com/users/JesseYang/followers", "following_url": "https://api.github.com/users/JesseYang/following{/other_user}", "gists_url": "https://api.github.com/users/JesseYang/gists{/gist_id}", "starred_url": "https://api.github.com/users/JesseYang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JesseYang/subscriptions", "organizations_url": "https://api.github.com/users/JesseYang/orgs", "repos_url": "https://api.github.com/users/JesseYang/repos", "events_url": "https://api.github.com/users/JesseYang/events{/privacy}", "received_events_url": "https://api.github.com/users/JesseYang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-03-16T15:23:01Z", "updated_at": "2018-05-30T20:59:06Z", "closed_at": "2017-03-16T20:12:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "I got the following error:\r\n```\r\ntensorflow.python.framework.errors_impl.InternalError: cuDNN launch failure : input shape ([1032,660,1,1])\r\n\t [[Node: towerp0/rnn/bn.0/FusedBatchNorm = FusedBatchNorm[T=DT_FLOAT, data_format=\"NCHW\", epsilon=1.0000001e-05, is_training=false, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](towerp0/rnn/bn.0/Reshape, rnn/bn.0/gamma/read, rnn/bn.0/beta/read, rnn/bn.0/mean/EMA/read, rnn/bn.0/variance/EMA/read)]]\r\n\t [[Node: towerp0/rnn/bi_rnn.1/bidirectional_rnn/bw/bw/stack/_1425 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_568_towerp0/rnn/bi_rnn.1/bidirectional_rnn/bw/bw/stack\", tensor_type=DT_INT32, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\r\n\r\n```\r\nThe tensor to be batch normalized has dimension of 2. In the source code batch_norm.py, tensors with dimension of 2 are extended to dimension of 4 with NCHW format. I switched the format to NHWC in batch_norm.py as follows:\r\n```\r\n    shape = x.get_shape().as_list()\r\n    assert len(shape) in [2, 4]\r\n    if len(shape) == 2:\r\n        # data_format = 'NCHW'\r\n        data_format = 'NHWC'\r\n    if data_format == 'NCHW':\r\n        n_out = shape[1]\r\n    else:\r\n        n_out = shape[-1]  # channel\r\n    if len(shape) == 2:\r\n        # x = tf.reshape(x, [-1, n_out, 1, 1])\r\n        x = tf.reshape(x, [-1, 1, 1, n_out])\r\n```\r\nIt works fine.", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/190/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/190/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/184", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/184/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/184/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/184/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/184", "id": 213096589, "node_id": "MDU6SXNzdWUyMTMwOTY1ODk=", "number": 184, "title": "some image augmentations fail for single channel", "user": {"login": "eyaler", "id": 4436747, "node_id": "MDQ6VXNlcjQ0MzY3NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4436747?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eyaler", "html_url": "https://github.com/eyaler", "followers_url": "https://api.github.com/users/eyaler/followers", "following_url": "https://api.github.com/users/eyaler/following{/other_user}", "gists_url": "https://api.github.com/users/eyaler/gists{/gist_id}", "starred_url": "https://api.github.com/users/eyaler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eyaler/subscriptions", "organizations_url": "https://api.github.com/users/eyaler/orgs", "repos_url": "https://api.github.com/users/eyaler/repos", "events_url": "https://api.github.com/users/eyaler/events{/privacy}", "received_events_url": "https://api.github.com/users/eyaler/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-03-09T16:46:02Z", "updated_at": "2018-05-30T20:59:05Z", "closed_at": "2017-03-30T05:14:05Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "some image augmentations (eg flip, shift rotate) fail when image is single channel. we need to add:\r\n\r\n`        if img.ndim == 3 and ret.ndim == 2:\r\n            ret = ret[:, :, np.newaxis]\r\n `\r\n\r\nto all image augmentations as it is implemented in resize (perhaps this could be added generically to base)\r\n\r\ni also found a similar code in convert:\r\n`\r\n        if self.keepdims:\r\n            if len(transf.shape) is not len(img.shape):\r\n                transf = transf[..., None]\r\n`", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/184/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/184/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/154", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/154/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/154/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/154/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/154", "id": 208744599, "node_id": "MDU6SXNzdWUyMDg3NDQ1OTk=", "number": 154, "title": "Refactoring of NCWH broke most GAN examples", "user": {"login": "PatWie", "id": 6756603, "node_id": "MDQ6VXNlcjY3NTY2MDM=", "avatar_url": "https://avatars.githubusercontent.com/u/6756603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PatWie", "html_url": "https://github.com/PatWie", "followers_url": "https://api.github.com/users/PatWie/followers", "following_url": "https://api.github.com/users/PatWie/following{/other_user}", "gists_url": "https://api.github.com/users/PatWie/gists{/gist_id}", "starred_url": "https://api.github.com/users/PatWie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PatWie/subscriptions", "organizations_url": "https://api.github.com/users/PatWie/orgs", "repos_url": "https://api.github.com/users/PatWie/repos", "events_url": "https://api.github.com/users/PatWie/events{/privacy}", "received_events_url": "https://api.github.com/users/PatWie/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-02-19T20:40:22Z", "updated_at": "2018-05-30T20:59:03Z", "closed_at": "2017-02-20T01:34:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Just try to run: InfoGan-mnist or ConditionalGAN-mnist. These should be tested as well #153 \r\n````\r\npatwie@desktop~/git/tensorpack/examples/GAN (master) $ python InfoGAN-mnist.py \r\n[0219 21:36:42 @logger.py:69] Argv: InfoGAN-mnist.py\r\n[0219 21:36:43 @common.py:101] gen/fc0 input: [None, 74]\r\n[0219 21:36:43 @common.py:109] gen/fc0 output: [None, 1024]\r\n[0219 21:36:43 @common.py:101] gen/fc1 input: [None, 1024]\r\n[0219 21:36:43 @common.py:109] gen/fc1 output: [None, 6272]\r\n[0219 21:36:43 @common.py:101] gen/deconv1 input: [None, 7, 7, 128]\r\nTraceback (most recent call last):\r\n  File \"InfoGAN-mnist.py\", line 234, in <module>\r\n    GANTrainer(config).train()\r\n  File \"/home/patwie/git/tensorpack/tensorpack/train/base.py\", line 61, in train\r\n    self.setup()\r\n  File \"/home/patwie/git/tensorpack/tensorpack/train/base.py\", line 127, in setup\r\n    self._setup()   # subclass will setup the graph\r\n  File \"/home/patwie/git/tensorpack/examples/GAN/GAN.py\", line 71, in _setup\r\n    self.build_train_tower()\r\n  File \"/home/patwie/git/tensorpack/tensorpack/train/feedfree.py\", line 40, in build_train_tower\r\n    f()\r\n  File \"/home/patwie/git/tensorpack/tensorpack/train/feedfree.py\", line 36, in f\r\n    self.model.build_graph(inputs)\r\n  File \"/home/patwie/git/tensorpack/tensorpack/models/model_desc.py\", line 113, in build_graph\r\n    self._build_graph(model_inputs)\r\n  File \"InfoGAN-mnist.py\", line 97, in _build_graph\r\n    fake_sample = self.generator(z)\r\n  File \"InfoGAN-mnist.py\", line 52, in generator\r\n    l = Deconv2D('deconv1', l, [14, 14, 64], 4, 2, nl=BNReLU)\r\n  File \"/home/patwie/git/tensorpack/tensorpack/models/common.py\", line 104, in wrapped_func\r\n    outputs = func(*args, **actual_args)\r\n  File \"/home/patwie/git/tensorpack/tensorpack/models/conv2d.py\", line 144, in Deconv2D\r\n    out_channel = out_shape[channel_axis]\r\nIndexError: list index out of range\r\n\r\n````\r\n\r\nDid you run them?", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/154/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/154/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/124", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/124/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/124/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/124/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/124", "id": 203816472, "node_id": "MDU6SXNzdWUyMDM4MTY0NzI=", "number": 124, "title": "MultiGPU ResNet training not working with TF after 12.1", "user": {"login": "ppwwyyxx", "id": 1381301, "node_id": "MDQ6VXNlcjEzODEzMDE=", "avatar_url": "https://avatars.githubusercontent.com/u/1381301?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ppwwyyxx", "html_url": "https://github.com/ppwwyyxx", "followers_url": "https://api.github.com/users/ppwwyyxx/followers", "following_url": "https://api.github.com/users/ppwwyyxx/following{/other_user}", "gists_url": "https://api.github.com/users/ppwwyyxx/gists{/gist_id}", "starred_url": "https://api.github.com/users/ppwwyyxx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ppwwyyxx/subscriptions", "organizations_url": "https://api.github.com/users/ppwwyyxx/orgs", "repos_url": "https://api.github.com/users/ppwwyyxx/repos", "events_url": "https://api.github.com/users/ppwwyyxx/events{/privacy}", "received_events_url": "https://api.github.com/users/ppwwyyxx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 965546549, "node_id": "MDU6TGFiZWw5NjU1NDY1NDk=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/upstream%20issue", "name": "upstream issue", "color": "ea6764", "default": false, "description": "issues in other libraries"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 22, "created_at": "2017-01-28T16:38:54Z", "updated_at": "2018-06-15T08:06:32Z", "closed_at": "2017-02-03T01:25:10Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "With TF nightly, `imagenet-resnet.py` on 4 TitanX gives 95% top1 error after the first epoch, but the number was about 75% with TF 12.1 release.\r\nThe final performance is also 10% worse than before.\r\n\r\nMost of the APIs in tensorpack was already adopted to TF 1.0, so it's kind of awkward now. If you need multi-GPU training you can try TF 12.1, but maybe you'll need to check out an older version of tensorpack as well if there is an API issue.\r\n\r\nVery likely this is related to https://github.com/tensorflow/tensorflow/issues/7038. Will do some more tests to figure out.", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/124/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/124/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/122", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/122/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/122/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/122/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/122", "id": 203807975, "node_id": "MDU6SXNzdWUyMDM4MDc5NzU=", "number": 122, "title": "custom layers", "user": {"login": "PatWie", "id": 6756603, "node_id": "MDQ6VXNlcjY3NTY2MDM=", "avatar_url": "https://avatars.githubusercontent.com/u/6756603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PatWie", "html_url": "https://github.com/PatWie", "followers_url": "https://api.github.com/users/PatWie/followers", "following_url": "https://api.github.com/users/PatWie/following{/other_user}", "gists_url": "https://api.github.com/users/PatWie/gists{/gist_id}", "starred_url": "https://api.github.com/users/PatWie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PatWie/subscriptions", "organizations_url": "https://api.github.com/users/PatWie/orgs", "repos_url": "https://api.github.com/users/PatWie/repos", "events_url": "https://api.github.com/users/PatWie/events{/privacy}", "received_events_url": "https://api.github.com/users/PatWie/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-01-28T13:43:22Z", "updated_at": "2018-05-30T20:59:01Z", "closed_at": "2017-01-28T17:23:34Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I am currently testing whether I should switch from tfSlim to your layers. There something I cannot figure out. The minimal example is:\r\n\r\n````python\r\nfrom tensorpack import *\r\nimport tensorflow as tf\r\n\r\ntf.reset_default_graph()\r\n\r\n@layer_register()\r\ndef revReLU(x):\r\n    return -1 * tf.nn.relu(x)\r\n\r\na = tf.Variable(tf.random_normal([8, 224, 224, 3], stddev=0.35), name=\"a\")\r\nb = (LinearWrap(a).Conv2D('b', 8, 7, stride=2, nl=tf.identity))()\r\nc = (LinearWrap(a).Conv2D('c', 8, 7, stride=2, nl=tf.identity).revReLU())()\r\n\r\nsess = tf.InteractiveSession()\r\nsess.run(tf.global_variables_initializer())\r\nprint sess.run(b).shape\r\nprint sess.run(c).shape\r\n````\r\n\r\nWhen I put \"revReLU\" into the modules directory everything works as exected. But when using `layer_register` in the actual script `LinearWrap` cannot use it.\r\n\r\n`revReLU` is just for demonstration.", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/122/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/122/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/119", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/119/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/119/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/119/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/119", "id": 203005973, "node_id": "MDU6SXNzdWUyMDMwMDU5NzM=", "number": 119, "title": "Training on A3C model", "user": {"login": "huihuiqu", "id": 6765315, "node_id": "MDQ6VXNlcjY3NjUzMTU=", "avatar_url": "https://avatars.githubusercontent.com/u/6765315?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huihuiqu", "html_url": "https://github.com/huihuiqu", "followers_url": "https://api.github.com/users/huihuiqu/followers", "following_url": "https://api.github.com/users/huihuiqu/following{/other_user}", "gists_url": "https://api.github.com/users/huihuiqu/gists{/gist_id}", "starred_url": "https://api.github.com/users/huihuiqu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huihuiqu/subscriptions", "organizations_url": "https://api.github.com/users/huihuiqu/orgs", "repos_url": "https://api.github.com/users/huihuiqu/repos", "events_url": "https://api.github.com/users/huihuiqu/events{/privacy}", "received_events_url": "https://api.github.com/users/huihuiqu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-01-25T03:50:21Z", "updated_at": "2018-05-30T20:59:01Z", "closed_at": "2017-01-25T03:55:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "During the training of A3C model on the breakout game \"./train-atari.py --env Breakout-v0 --gpu 0\", It says that it cannot compare a list with an int. I am using AWS g2 instance. Could you please help me to deal with that?\r\n\r\nThank you.\r\n\r\n\r\n^[[32m[0124 21:36:50 @logger.py:70]^[[0m Argv: ./train-atari.py --env Breakout-v0 --gpu 0\r\n^[[32m[0124 21:36:51 @multigpu.py:31]^[[0m Training a model of 1 tower\r\n^[[32m[0124 21:36:51 @multigpu.py:39]^[[0m Building graph for training tower 0...\r\n^[[32m[0124 21:36:51 @common.py:82]^[[0m conv0 input: [None, 84, 84, 12]\r\n^[[32m[0124 21:36:51 @common.py:90]^[[0m conv0 output: [None, 84, 84, 32]\r\n^[[32m[0124 21:36:51 @common.py:82]^[[0m pool0 input: [None, 84, 84, 32]\r\n^[[32m[0124 21:36:51 @common.py:90]^[[0m pool0 output: [None, 42, 42, 32]\r\n^[[32m[0124 21:36:51 @common.py:82]^[[0m conv1 input: [None, 42, 42, 32]\r\n^[[32m[0124 21:36:51 @common.py:90]^[[0m conv1 output: [None, 42, 42, 32]\r\n^[[32m[0124 21:36:51 @common.py:82]^[[0m pool1 input: [None, 42, 42, 32]\r\n^[[32m[0124 21:36:51 @common.py:90]^[[0m pool1 output: [None, 21, 21, 32]\r\n^[[32m[0124 21:36:51 @common.py:82]^[[0m conv2 input: [None, 21, 21, 32]\r\n^[[32m[0124 21:36:51 @common.py:90]^[[0m conv2 output: [None, 21, 21, 64]\r\n^[[32m[0124 21:36:51 @common.py:82]^[[0m pool2 input: [None, 21, 21, 64]\r\n^[[32m[0124 21:36:51 @common.py:90]^[[0m pool2 output: [None, 10, 10, 64]\r\n^[[32m[0124 21:36:51 @common.py:82]^[[0m conv3 input: [None, 10, 10, 64]\r\n^[[32m[0124 21:36:51 @common.py:90]^[[0m conv3 output: [None, 10, 10, 64]\r\n^[[32m[0124 21:36:51 @common.py:82]^[[0m fc0 input: [None, 10, 10, 64]\r\n^[[32m[0124 21:36:51 @common.py:90]^[[0m fc0 output: [None, 512]\r\n^[[32m[0124 21:36:51 @common.py:82]^[[0m fc-pi input: [None, 512]\r\n^[[32m[0124 21:36:51 @common.py:90]^[[0m fc-pi output: [None, 6]\r\n^[[32m[0124 21:36:51 @common.py:82]^[[0m fc-v input: [None, 512]\r\n^[[32m[0124 21:36:51 @common.py:90]^[[0m fc-v output: [None, 1]\r\n^[[32m[0124 21:36:52 @modelutils.py:27]^[[0m ^[[36mModel Parameters: ^[[0m\r\nconv0/W:0: shape=[5, 5, 12, 32], dim=9600\r\nconv0/b:0: shape=[32], dim=32\r\nconv1/W:0: shape=[5, 5, 32, 32], dim=25600\r\nconv1/b:0: shape=[32], dim=32\r\nconv2/W:0: shape=[4, 4, 32, 64], dim=32768\r\nconv2/b:0: shape=[64], dim=64\r\nconv3/W:0: shape=[3, 3, 64, 64], dim=36864\r\nconv3/b:0: shape=[64], dim=64\r\nfc0/W:0: shape=[6400, 512], dim=3276800\r\nfc0/b:0: shape=[512], dim=512\r\nprelu/alpha:0: shape=[], dim=1\r\nfc-pi/W:0: shape=[512, 6], dim=3072\r\nfc-pi/b:0: shape=[6], dim=6\r\nfc-v/W:0: shape=[512, 1], dim=512\r\nfc-v/b:0: shape=[1], dim=1\r\n^[[36mTotal #param=3385928 (12.92 MB assuming all float32)^[[0m\r\n^[[32m[0124 21:36:52 @base.py:148]^[[0m Setup callbacks ...\r\n^[[32m[0124 21:36:52 @base.py:157]^[[0m Building prediction graph for towerid=0 with prefix='' ...\r\n^[[32m[0124 21:36:57 @stats.py:34]^[[0m Found stats at train_log/train-atari/stat.json, will append to it.\r\n^[[32m[0124 21:36:57 @base.py:159]^[[0m Initializing graph variables ...\r\n^[[32m[0124 21:36:58 @concurrency.py:30]^[[0m Starting SimulatorMaster\r\n^[[32m[0124 21:36:58 @concurrency.py:30]^[[0m Starting EnqueueThread\r\n^[[32m[0124 21:36:58 @base.py:182]^[[0m Start Epoch 1 ...\r\n^[[32m[0124 22:14:11 @base.py:194]^[[0m Epoch 1 (global_step 6000) finished, time:2233.17 sec.\r\n^[[32m[0124 22:14:11 @multigpu.py:205]^[[0m ^[[4m^[[5m^[[31mERR^[[0m Cannot log async_global_step\r\nTraceback (most recent call last):\r\n  File \"/home/ubuntu/tensorpack/tensorpack/train/multigpu.py\", line 199, in _trigger_epoch\r\n    if self.config.tower > 1:\r\nTypeError: unorderable types: list() > int()\r\n^[[32m[0124 22:14:16 @saver.py:80]^[[0m Model saved to train_log/train-atari/model-6000.\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m SummaryGradient/conv0/W/rms: 0.00067522\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m SummaryGradient/conv0/b/rms: 0.0084852\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m SummaryGradient/conv1/W/rms: 0.00038924\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m SummaryGradient/conv1/b/rms: 0.0064533\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m SummaryGradient/conv2/W/rms: 0.00028933\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m SummaryGradient/conv2/b/rms: 0.0044036\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m SummaryGradient/conv3/W/rms: 0.00025662\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m SummaryGradient/conv3/b/rms: 0.0051158\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m SummaryGradient/fc-pi/W/rms: 0.00029742\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m SummaryGradient/fc-pi/b/rms: 0.0036213\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m SummaryGradient/fc-v/W/rms: 0.0016729\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m SummaryGradient/fc-v/b/rms: 0.02057\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m SummaryGradient/fc0/W/rms: 3.2691e-05\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m SummaryGradient/fc0/b/rms: 0.00097313\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m SummaryGradient/prelu/alpha/rms: 0.0085771\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m cost: -0.014976\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m input_queue_size: 5.5515e-07\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m learning_rate: 0.001\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m policy_loss: -0.43098\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m predict_reward: 0.63999\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m rms_advantage: 0.10505\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m value_loss: 0.74247\r\n^[[32m[0124 22:14:16 @stats.py:101]^[[0m xentropy_loss: -222.84\r\n^[[32m[0124 22:14:16 @group.py:44]^[[0m Callbacks took 3.978 sec in total. ModelSaver: 3.961sec\r\n^[[32m[0124 22:14:16 @base.py:182]^[[0m Start Epoch 2 ...\r\n^[[32m[0124 22:51:26 @base.py:194]^[[0m Epoch 2 (global_step 12000) finished, time:2230.66 sec.\r\n^[[32m[0124 22:51:26 @multigpu.py:205]^[[0m ^[[4m^[[5m^[[31mERR^[[0m Cannot log async_global_step\r\nTraceback (most recent call last):\r\n  File \"/home/ubuntu/tensorpack/tensorpack/train/multigpu.py\", line 199, in _trigger_epoch\r\n    if self.config.tower > 1:\r\nTypeError: unorderable types: list() > int()\r\n^[[32m[0124 22:51:28 @saver.py:80]^[[0m Model saved to train_log/train-atari/model-12000.", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/119/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/119/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/118", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/118/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/118/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/118/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/118", "id": 203005580, "node_id": "MDU6SXNzdWUyMDMwMDU1ODA=", "number": 118, "title": "Training on DQN breakout game", "user": {"login": "huihuiqu", "id": 6765315, "node_id": "MDQ6VXNlcjY3NjUzMTU=", "avatar_url": "https://avatars.githubusercontent.com/u/6765315?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huihuiqu", "html_url": "https://github.com/huihuiqu", "followers_url": "https://api.github.com/users/huihuiqu/followers", "following_url": "https://api.github.com/users/huihuiqu/following{/other_user}", "gists_url": "https://api.github.com/users/huihuiqu/gists{/gist_id}", "starred_url": "https://api.github.com/users/huihuiqu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huihuiqu/subscriptions", "organizations_url": "https://api.github.com/users/huihuiqu/orgs", "repos_url": "https://api.github.com/users/huihuiqu/repos", "events_url": "https://api.github.com/users/huihuiqu/events{/privacy}", "received_events_url": "https://api.github.com/users/huihuiqu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-01-25T03:47:00Z", "updated_at": "2018-05-30T20:59:01Z", "closed_at": "2017-01-25T03:52:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, I was trying to use DQN to train breakout by \"./DQN.py --rom breakout.bin\". However, I encountered following error. Could you please hint me how to deal with this?\r\n\r\nThanks.\r\n\r\n[0125 00:42:23 @stats.py:101] param-summary/fc0/W-rms: 0.018247\r\n[0125 00:42:23 @stats.py:101] param-summary/fct/W-rms: 0.054118\r\n[0125 00:42:23 @stats.py:101] predict_reward: -0.095098\r\n[0125 00:42:23 @base.py:182] Start Epoch 2 ...\r\n100%|#########################################################################################################|10000/10000[32:17<00:00, 5.17it/s]\r\n[0125 01:14:41 @base.py:194] Epoch 2 (global_step 20000) finished, time:1937.52 sec.\r\n[0125 01:14:41 @saver.py:80] Model saved to train_log/DQN/model-20000.\r\n[0125 01:14:41 @expreplay.py:204] Exploration changed to 0.98\r\n[0125 01:14:41 @stats.py:101] SummaryGradient/conv0/W/rms: 1.7831e-05\r\n[0125 01:14:41 @stats.py:101] SummaryGradient/conv0/alpha/rms: 0.0011199\r\n[0125 01:14:41 @stats.py:101] SummaryGradient/conv0/b/rms: 0.00013539\r\n[0125 01:14:41 @stats.py:101] SummaryGradient/conv1/W/rms: 7.2933e-06\r\n[0125 01:14:41 @stats.py:101] SummaryGradient/conv1/alpha/rms: 0.00094099\r\n[0125 01:14:41 @stats.py:101] SummaryGradient/conv1/b/rms: 0.00022113\r\n[0125 01:14:41 @stats.py:101] SummaryGradient/conv2/W/rms: 8.8745e-06\r\n[0125 01:14:41 @stats.py:101] SummaryGradient/conv2/alpha/rms: 0.0056876\r\n[0125 01:14:41 @stats.py:101] SummaryGradient/conv2/b/rms: 0.0001549\r\n[0125 01:14:41 @stats.py:101] SummaryGradient/conv3/W/rms: 4.5882e-06\r\n[0125 01:14:41 @stats.py:101] SummaryGradient/conv3/alpha/rms: 0.00083669\r\n[0125 01:14:41 @stats.py:101] SummaryGradient/conv3/b/rms: 0.00063492\r\n[0125 01:14:41 @stats.py:101] SummaryGradient/fc0/W/rms: 1.9919e-06\r\n[0125 01:14:41 @stats.py:101] SummaryGradient/fc0/b/rms: 0.00011362\r\n[0125 01:14:41 @stats.py:101] SummaryGradient/fct/W/rms: 0.00010893\r\n[0125 01:14:41 @stats.py:101] SummaryGradient/fct/b/rms: 0.0046374\r\n[0125 01:14:41 @stats.py:101] cost: 0.0032585\r\n[0125 01:14:41 @stats.py:101] expreplay/max_score: 9\r\n[0125 01:14:41 @stats.py:101] expreplay/mean_score: 0.94271\r\n[0125 01:14:41 @stats.py:101] input_queue_size: 50\r\n[0125 01:14:41 @stats.py:101] learning_rate: 0.001\r\n[0125 01:14:41 @stats.py:101] param-summary/conv0/W-rms: 0.13747\r\n[0125 01:14:41 @stats.py:101] param-summary/conv1/W-rms: 0.050279\r\n[0125 01:14:42 @stats.py:101] param-summary/conv2/W-rms: 0.06357\r\n[0125 01:14:42 @stats.py:101] param-summary/conv3/W-rms: 0.061343\r\n[0125 01:14:42 @stats.py:101] param-summary/fc0/W-rms: 0.018249\r\n[0125 01:14:42 @stats.py:101] param-summary/fct/W-rms: 0.054057\r\n[0125 01:14:42 @stats.py:101] predict_reward: -0.053162\r\n[0125 01:14:42 @base.py:182] Start Epoch 3 ...\r\n100%|#########################################################################################################|10000/10000[32:17<00:00, 5.17it/s]\r\n[0125 01:46:59 @base.py:194] Epoch 3 (global_step 30000) finished, time:1937.74 sec.\r\n[0125 01:47:00 @saver.py:80] Model saved to train_log/DQN/model-30000.\r\n[0125 01:47:00 @expreplay.py:204] Exploration changed to 0.97\r\nW tensorflow/core/kernels/queue_base.cc:294] _0_input_queue: Skipping cancelled enqueue attempt with queue not closed\r\nTraceback (most recent call last):\r\n  File \"./DQN.py\", line 229, in <module>\r\n[0125 01:47:00 @input_data.py:114] Enqueue Thread Exited.\r\n    QueueInputTrainer(config).train()\r\n  File \"/home/ubuntu/tensorpack/tensorpack/train/base.py\", line 65, in train\r\n    self.main_loop()\r\n  File \"/home/ubuntu/tensorpack/tensorpack/train/base.py\", line 197, in main_loop\r\n    self.trigger_epoch()\r\n  File \"/home/ubuntu/tensorpack/tensorpack/train/base.py\", line 98, in trigger_epoch\r\n    self.config.callbacks.trigger_epoch()\r\n  File \"/home/ubuntu/tensorpack/tensorpack/callbacks/base.py\", line 94, in trigger_epoch\r\n    self._trigger_epoch()\r\n  File \"/home/ubuntu/tensorpack/tensorpack/callbacks/group.py\", line 122, in _trigger_epoch\r\n    cb.trigger_epoch()\r\n  File \"/home/ubuntu/tensorpack/tensorpack/callbacks/base.py\", line 94, in trigger_epoch\r\n    self._trigger_epoch()\r\n  File \"/home/ubuntu/tensorpack/tensorpack/callbacks/base.py\", line 171, in _trigger_epoch\r\n    self.cb.epoch_num = self.epoch_num - 1\r\nAttributeError: can't set attribute\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/118/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/118/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/114", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/114/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/114/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/114/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/114", "id": 202068770, "node_id": "MDU6SXNzdWUyMDIwNjg3NzA=", "number": 114, "title": "ImportError: No module named freeze", "user": {"login": "nesciemus", "id": 2040533, "node_id": "MDQ6VXNlcjIwNDA1MzM=", "avatar_url": "https://avatars.githubusercontent.com/u/2040533?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nesciemus", "html_url": "https://github.com/nesciemus", "followers_url": "https://api.github.com/users/nesciemus/followers", "following_url": "https://api.github.com/users/nesciemus/following{/other_user}", "gists_url": "https://api.github.com/users/nesciemus/gists{/gist_id}", "starred_url": "https://api.github.com/users/nesciemus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nesciemus/subscriptions", "organizations_url": "https://api.github.com/users/nesciemus/orgs", "repos_url": "https://api.github.com/users/nesciemus/repos", "events_url": "https://api.github.com/users/nesciemus/events{/privacy}", "received_events_url": "https://api.github.com/users/nesciemus/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-01-20T07:10:11Z", "updated_at": "2018-05-30T20:59:01Z", "closed_at": "2017-01-25T09:00:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "Why did I get ImportError: No module named freeze when try to import the tensorpack?", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/114/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/114/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/108", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/108/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/108/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/108/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/108", "id": 201289100, "node_id": "MDU6SXNzdWUyMDEyODkxMDA=", "number": 108, "title": "ValueError in DQN", "user": {"login": "chingyaoc", "id": 14292390, "node_id": "MDQ6VXNlcjE0MjkyMzkw", "avatar_url": "https://avatars.githubusercontent.com/u/14292390?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chingyaoc", "html_url": "https://github.com/chingyaoc", "followers_url": "https://api.github.com/users/chingyaoc/followers", "following_url": "https://api.github.com/users/chingyaoc/following{/other_user}", "gists_url": "https://api.github.com/users/chingyaoc/gists{/gist_id}", "starred_url": "https://api.github.com/users/chingyaoc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chingyaoc/subscriptions", "organizations_url": "https://api.github.com/users/chingyaoc/orgs", "repos_url": "https://api.github.com/users/chingyaoc/repos", "events_url": "https://api.github.com/users/chingyaoc/events{/privacy}", "received_events_url": "https://api.github.com/users/chingyaoc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 676134026, "node_id": "MDU6TGFiZWw2NzYxMzQwMjY=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/examples", "name": "examples", "color": "e99695", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-01-17T13:48:17Z", "updated_at": "2018-11-27T04:32:44Z", "closed_at": "2017-01-17T16:34:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nThanks for sharing such an awesome toolbox.\r\nHowever while I'm running DQN without modifying by \r\n```\r\n./DQN.py --rom breakout.bin\r\n```\r\nFollowing error message occured,\r\n```\r\nTraceback (most recent call last):\r\n  File \"./DQN.py\", line 228, in <module>\r\n    QueueInputTrainer(config).train()\r\n  File \"/data/VSLab/james847286/Work/ITRI/tensorpack/tensorpack/train/base.py\", line 58, in train\r\n    self.setup()\r\n  File \"/data/VSLab/james847286/Work/ITRI/tensorpack/tensorpack/train/base.py\", line 130, in setup\r\n    self._setup()\r\n  File \"/data/VSLab/james847286/Work/ITRI/tensorpack/tensorpack/train/feedfree.py\", line 106, in _setup\r\n    summary_moving_average(), name='train_op')\r\n  File \"/data/VSLab/james847286/.local/lib/python2.7/site-packages/functools32/functools32.py\", line 378, in wrapper\r\n    result = user_function(*args, **kwds)\r\n  File \"/data/VSLab/james847286/Work/ITRI/tensorpack/tensorpack/tfutils/summary.py\", line 140, in summary_moving_average\r\n    avg_maintain_op = averager.apply(tensors)\r\n  File \"/data/VSLab/james847286/anaconda2/envs/tf/lib/python2.7/site-packages/tensorflow/python/training/moving_averages.py\", line 391, in apply\r\n    self._averages[var], var, decay, zero_debias=zero_debias))\r\n  File \"/data/VSLab/james847286/anaconda2/envs/tf/lib/python2.7/site-packages/tensorflow/python/training/moving_averages.py\", line 70, in assign_moving_average\r\n    update_delta = _zero_debias(variable, value, decay)\r\n  File \"/data/VSLab/james847286/anaconda2/envs/tf/lib/python2.7/site-packages/tensorflow/python/training/moving_averages.py\", line 177, in _zero_debias\r\n    trainable=False)\r\n  File \"/data/VSLab/james847286/anaconda2/envs/tf/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 1024, in get_variable\r\n    custom_getter=custom_getter)\r\n  File \"/data/VSLab/james847286/anaconda2/envs/tf/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 850, in get_variable\r\n    custom_getter=custom_getter)\r\n  File \"/data/VSLab/james847286/anaconda2/envs/tf/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 346, in get_variable\r\n    validate_shape=validate_shape)\r\n  File \"/data/VSLab/james847286/anaconda2/envs/tf/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 331, in _true_getter\r\n    caching_device=caching_device, validate_shape=validate_shape)\r\n  File \"/data/VSLab/james847286/anaconda2/envs/tf/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 650, in _get_single_variable\r\n    \"VarScope?\" % name)\r\nValueError: Variable predict_reward/EMA/biased does not exist, or was not created with tf.get_variable(). Did you mean to set reuse=None in VarScope?\r\n```\r\n\r\nIt seems that the variable accidentally being set to reuse in certain variable scope. Any idea?", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/108/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/108/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/96", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/96/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/96/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/96/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/96", "id": 199716883, "node_id": "MDU6SXNzdWUxOTk3MTY4ODM=", "number": 96, "title": "Missing file", "user": {"login": "thadpasce16", "id": 24848713, "node_id": "MDQ6VXNlcjI0ODQ4NzEz", "avatar_url": "https://avatars.githubusercontent.com/u/24848713?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thadpasce16", "html_url": "https://github.com/thadpasce16", "followers_url": "https://api.github.com/users/thadpasce16/followers", "following_url": "https://api.github.com/users/thadpasce16/following{/other_user}", "gists_url": "https://api.github.com/users/thadpasce16/gists{/gist_id}", "starred_url": "https://api.github.com/users/thadpasce16/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thadpasce16/subscriptions", "organizations_url": "https://api.github.com/users/thadpasce16/orgs", "repos_url": "https://api.github.com/users/thadpasce16/repos", "events_url": "https://api.github.com/users/thadpasce16/events{/privacy}", "received_events_url": "https://api.github.com/users/thadpasce16/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-01-10T02:29:04Z", "updated_at": "2018-05-30T20:59:00Z", "closed_at": "2017-01-10T02:37:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "tensorpack/predict/dataset.py gives ImportError in common module\r\n\r\nfrom .common import PredictConfig\r\nImportError: No module named common", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/96/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/96/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/94", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/94/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/94/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/94/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/94", "id": 199558596, "node_id": "MDU6SXNzdWUxOTk1NTg1OTY=", "number": 94, "title": "tensorpack/predict/common.py was delete", "user": {"login": "PatWie", "id": 6756603, "node_id": "MDQ6VXNlcjY3NTY2MDM=", "avatar_url": "https://avatars.githubusercontent.com/u/6756603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PatWie", "html_url": "https://github.com/PatWie", "followers_url": "https://api.github.com/users/PatWie/followers", "following_url": "https://api.github.com/users/PatWie/following{/other_user}", "gists_url": "https://api.github.com/users/PatWie/gists{/gist_id}", "starred_url": "https://api.github.com/users/PatWie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PatWie/subscriptions", "organizations_url": "https://api.github.com/users/PatWie/orgs", "repos_url": "https://api.github.com/users/PatWie/repos", "events_url": "https://api.github.com/users/PatWie/events{/privacy}", "received_events_url": "https://api.github.com/users/PatWie/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-01-09T13:59:37Z", "updated_at": "2018-05-30T20:58:59Z", "closed_at": "2017-01-09T14:01:41Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "There is no `PredictConfig` anymore! The file was deleted in 84790b78f60221fe6819b5b01ed27c65da12e37a", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/94/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/94/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/92", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/92/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/92/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/92/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/92", "id": 199279097, "node_id": "MDU6SXNzdWUxOTkyNzkwOTc=", "number": 92, "title": "symbolic_functions is not defined", "user": {"login": "PatWie", "id": 6756603, "node_id": "MDQ6VXNlcjY3NTY2MDM=", "avatar_url": "https://avatars.githubusercontent.com/u/6756603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PatWie", "html_url": "https://github.com/PatWie", "followers_url": "https://api.github.com/users/PatWie/followers", "following_url": "https://api.github.com/users/PatWie/following{/other_user}", "gists_url": "https://api.github.com/users/PatWie/gists{/gist_id}", "starred_url": "https://api.github.com/users/PatWie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PatWie/subscriptions", "organizations_url": "https://api.github.com/users/PatWie/orgs", "repos_url": "https://api.github.com/users/PatWie/repos", "events_url": "https://api.github.com/users/PatWie/events{/privacy}", "received_events_url": "https://api.github.com/users/PatWie/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-01-06T20:18:59Z", "updated_at": "2018-05-30T20:58:59Z", "closed_at": "2017-01-07T02:04:53Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "````\r\n~/tmp/tensorpack/examples (master) $ python mnist-convnet.py \r\n\r\nTraceback (most recent call last):\r\n  File \"mnist-convnet.py\", line 168, in <module>\r\n    SimpleTrainer(config).train()\r\n  File \"/home/wieschol/git/tensorpack/tensorpack/train/base.py\", line 58, in train\r\n    self.setup()\r\n  File \"/home/wieschol/git/tensorpack/tensorpack/train/base.py\", line 126, in setup\r\n    self._setup()\r\n  File \"/home/wieschol/git/tensorpack/tensorpack/train/trainer.py\", line 83, in _setup\r\n    model.build_graph(self.input_vars)\r\n  File \"/home/wieschol/git/tensorpack/tensorpack/models/model_desc.py\", line 108, in build_graph\r\n    self._build_graph(model_inputs)\r\n  File \"mnist-convnet.py\", line 87, in _build_graph\r\n    wrong = symbolic_functions.prediction_incorrect(logits, label, name='incorrect')\r\nNameError: global name 'symbolic_functions' is not defined\r\n````\r\n\r\npossible bugfix\r\n[bugfix.txt](https://github.com/ppwwyyxx/tensorpack/files/690768/bugfix.txt)\r\n\r\nedit: same for `summary`\r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/92/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/92/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/84", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/84/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/84/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/84/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/84", "id": 198319069, "node_id": "MDU6SXNzdWUxOTgzMTkwNjk=", "number": 84, "title": "MNIST-convnet is not working -- 'dataset' is not defined", "user": {"login": "PatWie", "id": 6756603, "node_id": "MDQ6VXNlcjY3NTY2MDM=", "avatar_url": "https://avatars.githubusercontent.com/u/6756603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PatWie", "html_url": "https://github.com/PatWie", "followers_url": "https://api.github.com/users/PatWie/followers", "following_url": "https://api.github.com/users/PatWie/following{/other_user}", "gists_url": "https://api.github.com/users/PatWie/gists{/gist_id}", "starred_url": "https://api.github.com/users/PatWie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PatWie/subscriptions", "organizations_url": "https://api.github.com/users/PatWie/orgs", "repos_url": "https://api.github.com/users/PatWie/repos", "events_url": "https://api.github.com/users/PatWie/events{/privacy}", "received_events_url": "https://api.github.com/users/PatWie/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-01-02T10:46:47Z", "updated_at": "2018-05-30T20:58:59Z", "closed_at": "2017-01-02T13:13:56Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Commit c3f5307eb96a0efb313f4b4bbff5da18b1d80119 introduces a bug, \r\n\r\n````\r\n[0102 11:45:47 @logger.py:57] Argv: mnist-convnet.py\r\nTraceback (most recent call last):\r\n  File \"mnist-convnet.py\", line 134, in <module>\r\n    config = get_config()\r\n  File \"mnist-convnet.py\", line 95, in get_config\r\n    dataset_train, dataset_test = get_data()\r\n  File \"mnist-convnet.py\", line 87, in get_data\r\n    train = BatchData(dataset.Mnist('train'), 128)\r\nNameError: global name 'dataset' is not defined\r\n\r\n````\r\n\r\nBut 9c42c84fa682ba34110e1e0441ad84290f8e7b7b works fine.\r\n\r\nIt seems that this new commit expect\r\n````python\r\ndataflow.dataset.MNIST\r\n````\r\ninstead of\r\n````python\r\ndataset.MNIST\r\n````\r\n\r\nIs this intended? Then each example using these datasets needs an update.", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/84/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/84/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/78", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/78/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/78/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/78/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/78", "id": 198121454, "node_id": "MDU6SXNzdWUxOTgxMjE0NTQ=", "number": 78, "title": "Gray scale image feed error using 'ImageFromFile' dataflow", "user": {"login": "shuzhangcasia", "id": 16012318, "node_id": "MDQ6VXNlcjE2MDEyMzE4", "avatar_url": "https://avatars.githubusercontent.com/u/16012318?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shuzhangcasia", "html_url": "https://github.com/shuzhangcasia", "followers_url": "https://api.github.com/users/shuzhangcasia/followers", "following_url": "https://api.github.com/users/shuzhangcasia/following{/other_user}", "gists_url": "https://api.github.com/users/shuzhangcasia/gists{/gist_id}", "starred_url": "https://api.github.com/users/shuzhangcasia/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shuzhangcasia/subscriptions", "organizations_url": "https://api.github.com/users/shuzhangcasia/orgs", "repos_url": "https://api.github.com/users/shuzhangcasia/repos", "events_url": "https://api.github.com/users/shuzhangcasia/events{/privacy}", "received_events_url": "https://api.github.com/users/shuzhangcasia/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-12-30T09:00:16Z", "updated_at": "2018-05-30T20:58:58Z", "closed_at": "2016-12-31T06:27:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "Support for gray scale image is buggy as the output data has shape (w,h) instead of (w, h, 1)\r\n\r\nShould add \r\n            if self.channel == 1:\r\n                im = im[:,:,None]\r\non line 39 of tensorpack/dataflow/image.py", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/78/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/78/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/67", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/67/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/67/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/67/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/67", "id": 195742041, "node_id": "MDU6SXNzdWUxOTU3NDIwNDE=", "number": 67, "title": "issue about DoReFA.     AttributeError: 'module' object has no attribute 'fused_batch_norm'?", "user": {"login": "silverlining21", "id": 8264748, "node_id": "MDQ6VXNlcjgyNjQ3NDg=", "avatar_url": "https://avatars.githubusercontent.com/u/8264748?v=4", "gravatar_id": "", "url": "https://api.github.com/users/silverlining21", "html_url": "https://github.com/silverlining21", "followers_url": "https://api.github.com/users/silverlining21/followers", "following_url": "https://api.github.com/users/silverlining21/following{/other_user}", "gists_url": "https://api.github.com/users/silverlining21/gists{/gist_id}", "starred_url": "https://api.github.com/users/silverlining21/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/silverlining21/subscriptions", "organizations_url": "https://api.github.com/users/silverlining21/orgs", "repos_url": "https://api.github.com/users/silverlining21/repos", "events_url": "https://api.github.com/users/silverlining21/events{/privacy}", "received_events_url": "https://api.github.com/users/silverlining21/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-12-15T08:13:35Z", "updated_at": "2018-05-30T20:58:58Z", "closed_at": "2016-12-16T06:56:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "@ppwwyyxx \u4f60\u597d\uff0c\u4f60\u4eec\u7684DoReFa-net\u5f88nice\uff01\r\n\r\n`\u6211\u5728\u91c7\u7528\u4f60\u516c\u5e03\u7684\u4ee3\u7801\u8dd1\u5b9e\u9a8c\u7684\u65f6\u5019\u9047\u5230\u5982\u4e0b\u95ee\u9898\u53d1\u73b0\u3002\u6211\u91c7\u7528\u7684tensorflow\u7248\u672c\u662f**0.11**\uff0c\u4ee3\u7801\u4e2d\u4f60\u5efa\u8bae\u7684\u7248\u672c\u662f>=0.11.\u4e0b\u6765\u6211\u53bb\u67e5\u770b\u4e86tensorflow API \r\n\r\n**r0.11**\u6ca1\u6709\u627e\u5230 fused_batch_norm\r\n[https://www.tensorflow.org/versions/r0.11/api_docs/python/nn.html#neural-network](url)\r\n\r\n**master**\u627e\u5230\u4e86\u51fd\u6570fused_batch_norm\r\n[https://www.tensorflow.org/versions/master/api_docs/python/nn.html#fused_batch_norm](url)\r\n\r\n\u6240\u4ee5\u6211\u60f3\u8bf7\u95ee\u4e00\u4e0b\u4f60\u7684\u4ee3\u7801\u662f\u57fa\u4e8e **master \u5206\u652f**\u6765\u65f6\u5b9e\u73b0\u7684\u5417\uff1f \u9488\u5bf9\u8fd9\u4e2a\u95ee\u9898\u9664\u4e86\u91cd\u88c5TF\uff0c\u6709\u6ca1\u6709\u5176\u4ed6\u7684\u4ec0\u4e48\u89e3\u51b3\u529e\u6cd5\u5462\uff1f \u6253\u6405\u4e86\uff0c\u795d\u597d\uff01\r\n\r\n> \r\n```\r\nnrp@scs4450-SYS-7048GR-TR:~/program/tensorpack/examples/DoReFa-Net$ python idcard-dorefa.py --dorefa 1,2,6 --data /home/nrp/data/idcard --gpu 0\r\n[1215 15:51:54 @idcard-dorefa.py:307] Batch per tower: 128\r\n[1215 15:51:54 @logger.py:69] WRN Directory train_log/idcard-dorefa exists! Please either backup/delete it, or use a new directory.\r\n[1215 15:51:54 @logger.py:71] WRN If you're resuming from a previous run you can choose to keep it.\r\n[1215 15:51:54 @logger.py:72] Select Action: k (keep) / b (backup) / d (delete) / n (new):\r\nd\r\n[1215 15:51:56 @logger.py:57] Argv: idcard-dorefa.py --dorefa 1,2,6 --data /home/nrp/data/idcard --gpu 0\r\n[1215 15:51:56 @utils.py:60] TENSORPACK_DATASET not set, using /home/nrp/program/tensorpack/tensorpack/dataflow/dataset for dataset.\r\n[1215 15:51:59 @multigpu.py:27] Training a model of 1 tower\r\n[1215 15:51:59 @multigpu.py:35] Building graph for training tower 0...\r\n[1215 15:51:59 @_common.py:72] conv0 input: [None, 32, 32, 3]\r\n[1215 15:51:59 @_common.py:80] conv0 output: [None, 6, 6, 96]\r\n[1215 15:51:59 @_common.py:72] conv1 input: [None, 6, 6, 96]\r\n[1215 15:51:59 @idcard-dorefa.py:90] Binarizing weight conv1/W\r\n[1215 15:51:59 @_common.py:80] conv1 output: [None, 6, 6, 256]\r\nTraceback (most recent call last):\r\n  File \"idcard-dorefa.py\", line 314, in <module>\r\n    SyncMultiGPUTrainer(config).train()\r\n  File \"/home/nrp/program/tensorpack/tensorpack/train/base.py\", line 58, in train\r\n    self.setup()\r\n  File \"/home/nrp/program/tensorpack/tensorpack/train/base.py\", line 106, in setup\r\n    self._setup()\r\n  File \"/home/nrp/program/tensorpack/tensorpack/train/multigpu.py\", line 86, in _setup\r\n    self.config.tower, lambda: self._get_cost_and_grad()[1])\r\n  File \"/home/nrp/program/tensorpack/tensorpack/train/multigpu.py\", line 37, in _multi_tower_grads\r\n    grad_list.append(get_tower_grad_func())\r\n  File \"/home/nrp/program/tensorpack/tensorpack/train/multigpu.py\", line 86, in <lambda>\r\n    self.config.tower, lambda: self._get_cost_and_grad()[1])\r\n  File \"/home/nrp/program/tensorpack/tensorpack/train/trainer.py\", line 134, in _get_cost_and_grad\r\n    self.model.build_graph(actual_inputs)\r\n  File \"/home/nrp/program/tensorpack/tensorpack/models/model_desc.py\", line 85, in build_graph\r\n    self._build_graph(model_inputs)\r\n  File \"idcard-dorefa.py\", line 109, in _build_graph\r\n    .BatchNorm('bn1')\r\n  File \"/home/nrp/program/tensorpack/tensorpack/models/__init__.py\", line 56, in f\r\n    ret = layer(name, self._t, *args, **kwargs)\r\n  File \"/home/nrp/program/tensorpack/tensorpack/models/_common.py\", line 75, in wrapped_func\r\n    outputs = func(*args, **actual_args)\r\n  File \"/home/nrp/program/tensorpack/tensorpack/models/batch_norm.py\", line 151, in BatchNormV2\r\n    xn, batch_mean, batch_var = tf.nn.fused_batch_norm(x, gamma, beta,\r\nAttributeError: 'module' object has no attribute 'fused_batch_norm'\r\nPrefetch process exited.\r\nPrefetch process exited.\r\n\r\n```\r\n> ", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/67/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/67/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/48", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/48/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/48/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/48/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/48", "id": 188344959, "node_id": "MDU6SXNzdWUxODgzNDQ5NTk=", "number": 48, "title": "Error with only 1 gpu", "user": {"login": "bigcat77", "id": 7156560, "node_id": "MDQ6VXNlcjcxNTY1NjA=", "avatar_url": "https://avatars.githubusercontent.com/u/7156560?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bigcat77", "html_url": "https://github.com/bigcat77", "followers_url": "https://api.github.com/users/bigcat77/followers", "following_url": "https://api.github.com/users/bigcat77/following{/other_user}", "gists_url": "https://api.github.com/users/bigcat77/gists{/gist_id}", "starred_url": "https://api.github.com/users/bigcat77/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bigcat77/subscriptions", "organizations_url": "https://api.github.com/users/bigcat77/orgs", "repos_url": "https://api.github.com/users/bigcat77/repos", "events_url": "https://api.github.com/users/bigcat77/events{/privacy}", "received_events_url": "https://api.github.com/users/bigcat77/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-11-09T20:30:19Z", "updated_at": "2018-05-30T20:58:56Z", "closed_at": "2016-11-14T03:48:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "I got an error when I tried to train a model with only 1 gpu, not sure if the error goes away with 2 or not.\r\n\r\nHere is the command line \r\npython2.7 train-atari.py --env Breakout-v0 --gpu 0\r\nHere is the error message. \r\nTraceback (most recent call last):\r\n  File \"train-atari.py\", line 258, in <module>\r\n    AsyncMultiGPUTrainer(config, predict_tower=predict_tower).train()\r\nTypeError: Can't instantiate abstract class AsyncMultiGPUTrainer with abstract methods get_predict_func\r\n\r\n\r\nThanks for any help with this. It looks like a great package. I was able to get run_atari.py to run and got good output movies. \r\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/48/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/48/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/23", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/23/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/23/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/23/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/23", "id": 178471855, "node_id": "MDU6SXNzdWUxNzg0NzE4NTU=", "number": 23, "title": "Super class init method not called for some image augmentors", "user": {"login": "sujaynarumanchi", "id": 8192279, "node_id": "MDQ6VXNlcjgxOTIyNzk=", "avatar_url": "https://avatars.githubusercontent.com/u/8192279?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sujaynarumanchi", "html_url": "https://github.com/sujaynarumanchi", "followers_url": "https://api.github.com/users/sujaynarumanchi/followers", "following_url": "https://api.github.com/users/sujaynarumanchi/following{/other_user}", "gists_url": "https://api.github.com/users/sujaynarumanchi/gists{/gist_id}", "starred_url": "https://api.github.com/users/sujaynarumanchi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sujaynarumanchi/subscriptions", "organizations_url": "https://api.github.com/users/sujaynarumanchi/orgs", "repos_url": "https://api.github.com/users/sujaynarumanchi/repos", "events_url": "https://api.github.com/users/sujaynarumanchi/events{/privacy}", "received_events_url": "https://api.github.com/users/sujaynarumanchi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2016-09-21T21:52:27Z", "updated_at": "2018-05-30T20:58:55Z", "closed_at": "2016-09-22T04:22:21Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Several image augmentors (RandomCrop, RandomCropRandomShape ...) do not call super class init method, hence self.rng is not set until reset is explicitly called.\nThis makes usage in standalone mode infeasible with the error self.rng variable is not defined.\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/23/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/23/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/21", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/21/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/21/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/21/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/21", "id": 178112613, "node_id": "MDU6SXNzdWUxNzgxMTI2MTM=", "number": 21, "title": "Bug in inference get_output_tensors method", "user": {"login": "sujaynarumanchi", "id": 8192279, "node_id": "MDQ6VXNlcjgxOTIyNzk=", "avatar_url": "https://avatars.githubusercontent.com/u/8192279?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sujaynarumanchi", "html_url": "https://github.com/sujaynarumanchi", "followers_url": "https://api.github.com/users/sujaynarumanchi/followers", "following_url": "https://api.github.com/users/sujaynarumanchi/following{/other_user}", "gists_url": "https://api.github.com/users/sujaynarumanchi/gists{/gist_id}", "starred_url": "https://api.github.com/users/sujaynarumanchi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sujaynarumanchi/subscriptions", "organizations_url": "https://api.github.com/users/sujaynarumanchi/orgs", "repos_url": "https://api.github.com/users/sujaynarumanchi/repos", "events_url": "https://api.github.com/users/sujaynarumanchi/events{/privacy}", "received_events_url": "https://api.github.com/users/sujaynarumanchi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-09-20T16:40:36Z", "updated_at": "2018-05-30T20:58:54Z", "closed_at": "2016-09-20T16:50:17Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "1. _get_output_vars method is not defined, should be _get_output_tensors. \n2. InferenceRunner should call \"vc.get_output_tensors()\" as opposed to \"vc._get_output_tensors()\" in line 94. \n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/21/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/21/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/4", "repository_url": "https://api.github.com/repos/tensorpack/tensorpack", "labels_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/4/labels{/name}", "comments_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/4/comments", "events_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/4/events", "html_url": "https://github.com/tensorpack/tensorpack/issues/4", "id": 151013956, "node_id": "MDU6SXNzdWUxNTEwMTM5NTY=", "number": 4, "title": "Run cifar-10 residual net?", "user": {"login": "yihui-he", "id": 10027339, "node_id": "MDQ6VXNlcjEwMDI3MzM5", "avatar_url": "https://avatars.githubusercontent.com/u/10027339?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yihui-he", "html_url": "https://github.com/yihui-he", "followers_url": "https://api.github.com/users/yihui-he/followers", "following_url": "https://api.github.com/users/yihui-he/following{/other_user}", "gists_url": "https://api.github.com/users/yihui-he/gists{/gist_id}", "starred_url": "https://api.github.com/users/yihui-he/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yihui-he/subscriptions", "organizations_url": "https://api.github.com/users/yihui-he/orgs", "repos_url": "https://api.github.com/users/yihui-he/repos", "events_url": "https://api.github.com/users/yihui-he/events{/privacy}", "received_events_url": "https://api.github.com/users/yihui-he/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303824353, "node_id": "MDU6TGFiZWwzMDM4MjQzNTM=", "url": "https://api.github.com/repos/tensorpack/tensorpack/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-04-26T00:39:03Z", "updated_at": "2018-05-30T20:58:53Z", "closed_at": "2016-04-26T03:29:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "> [25 17:32:54 28@cifar10.py:tensorpack] Found cifar10 data in /home/eli/Downloads/tensorpack-master/tensorpack/dataflow/dataset/cifar10_data.\n> [25 17:32:55 28@cifar10.py:tensorpack] Found cifar10 data in /home/eli/Downloads/tensorpack-master/tensorpack/dataflow/dataset/cifar10_data.\n> Traceback (most recent call last):\n>   File \"cifar10-resnet.py\", line 196, in <module>\n>     QueueInputTrainer(config).train()\n>   File \"/home/eli/Downloads/tensorpack-master/tensorpack/train/trainer.py\", line 185, in train\n>     grads = self._single_tower_grad()\n>   File \"/home/eli/Downloads/tensorpack-master/tensorpack/train/trainer.py\", line 134, in _single_tower_grad\n>     cost_var = self.model.get_cost(model_inputs, is_training=True)\n>   File \"/home/eli/Downloads/tensorpack-master/tensorpack/models/model_desc.py\", line 53, in get_cost\n>     return self._get_cost(input_vars, is_training)\n>   File \"cifar10-resnet.py\", line 83, in _get_cost\n>     l = conv('conv0', image, 16, 1)\n>   File \"cifar10-resnet.py\", line 52, in conv\n>     W_init=tf.random_normal_initializer(stddev=np.sqrt(2.0/9/channel)))\n>   File \"<decorator-gen-4>\", line 2, in Conv2D\n> TypeError: wrapper() takes exactly 1 argument (11 given)\n> [25 17:32:56 59@prefetch.py:tensorpack] Prefetch process exiting...\n> [25 17:32:56 63@prefetch.py:tensorpack] Prefetch process exited.\n", "reactions": {"url": "https://api.github.com/repos/tensorpack/tensorpack/issues/4/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tensorpack/tensorpack/issues/4/timeline", "performed_via_github_app": null, "state_reason": "completed"}]